import{p as V}from"./index-0.0.0-dataease.js";import"./el-radio-group-0.0.0-dataease.js";import{E as W,a as P}from"./el-radio-0.0.0-dataease.js";import{j as D}from"./index-0.0.0-dataease2.js";import F from"./ApiVariable-0.0.0-dataease.js";import{_ as A}from"./CodeEdit.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{Q as b,n as $,R as J,S as L,D as U,T as K,U as X}from"./lodash-0.0.0-dataease.js";import{B as _,K as Y}from"./ApiTestModel-0.0.0-dataease.js";import{d as G,t as H,w as Q,al as q,f as g,M as w,k as m,i as j,j as i,a6 as S,a7 as R,a0 as C}from"./vue-0.0.0-dataease.js";import{_ as z}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./library-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./user-0.0.0-dataease.js";import"./el-row-0.0.0-dataease.js";import"./row-0.0.0-dataease.js";import"./el-col-0.0.0-dataease.js";import"./el-popper-0.0.0-dataease.js";import"./el-tag-0.0.0-dataease.js";import"./el-select-0.0.0-dataease.js";import"./index-0.0.0-dataease4.js";import"./index-0.0.0-dataease14.js";import"./strings-0.0.0-dataease.js";import"./index-0.0.0-dataease5.js";import"./icon_drag_outlined-0.0.0-dataease.js";import"./icon_delete-trash_outlined-0.0.0-dataease.js";import"./icon_add_outlined-0.0.0-dataease.js";import"./util-0.0.0-dataease.js";import"./vuedraggable-es-0.0.0-dataease.js";const k=Array.isArray;class Z{constructor(){this._option={$id:"http://example.com/root.json",$schema:"http://json-schema.org/draft-07/schema#"},this._object=null}format(a,d={}){if(!b(a))throw new TypeError("传入参数只能是对象或数组");this._option=Object.assign(this._option,d),this._object=a;let n;return k(a)?n=this._arrayToSchema():n=this._objectToSchema(),this._object=null,n}_arrayToSchema(){const a=this._value2object(this._object,this._option.$id,"",!0);if(this._object.length>0){const d=[];for(let n=0;n<this._object.length;n++){const l=this._object[n];let o=this._value2object(l,"#/items","items");if(b(l)&&!$(l)){const u=this._json2schema(l,"#/items");o=Object.assign(o,u)}d.push(o)}a.items=d}return a}_objectToSchema(){let a=this._value2object(this._object,this._option.$id,"",!0);const d=this._json2schema(this._object);return a=Object.assign(a,d),a}_json2schema(a,d=""){if(!b(a))return;(d===""||d===void 0)&&(d="#");const n={};k(a)?n.items={}:n.properties={};for(const l in a)if(Object.prototype.hasOwnProperty.call(a,l)){const o=a[l];if(o===void 0)continue;const u=`${d}/properties/${l}`;if(!n.properties)continue;if(b(o))if(n.properties[l]=this._value2object(o,u,l),k(o)){if(o.length>0){const t=[];for(let y=0;y<o.length;y++){const h=o[y];let v=this._value2object(h,`${u}/items`,l+"items");b(h)&&!$(h)&&(v=Object.assign(v,this._json2schema(h,`${u}/items`))),t.push(v)}n.properties[l].items=t}}else n.properties[l]=Object.assign(n.properties[l],this._json2schema(o,u));else n.properties&&(n.properties[l]=this._value2object(o,u,l))}return n}_value2object(a,d,n="",l=!1){const o={$id:d,title:`The ${n} Schema`,mock:{mock:a}};return l&&(o.$schema=this._option.$schema,o.title="The Root Schema",o.mock=void 0),J(a)?o.type="boolean":L(a)?o.type="integer":U(a)?o.type="number":K(a)?o.type="string":X(a)?o.type="null":k(a)?(o.type="array",o.mock=void 0):b(a)&&(o.type="object",o.mock=void 0),o}}const ee=Z,te={key:0},se={key:1,class:"ms-body"},oe={key:2,class:"ms-body"},ae={key:3,class:"ms-body"},ie=G({__name:"ApiBody",props:{isReadOnly:V.bool.def(!1),isShowEnable:V.bool.def(!1),body:{type:Object,default:()=>({raw:"",typeChange:"",format:"",jsonSchema:"",type:"",kvs:[]})},headers:{type:Array,default:()=>[]},valueList:{type:Array,default:()=>[]}},emits:["headersChange"],setup(c,{emit:a}){const d=c,{t:n}=D(),l=["text","json","xml","html"],o=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable,{body:t,headers:y}=H(d);Q(()=>t.value.raw,()=>{if(t.value.format!=="JSON-SCHEMA"&&t.value.raw)try{const s=new ee().format(JSON.parse(t.value.raw));t.value.jsonSchema?t.value.jsonSchema=M(s):t.value.jsonSchema=s}catch{t.value.jsonSchema=""}}),q(()=>{t.value.type||(t.value.type=_.FORM_DATA),t.value.kvs&&t.value.kvs.forEach(e=>{e.type||(e.type="text")})});const h=e=>{const s=typeof e;return e!==null&&(s==="object"||s==="function")},v=e=>{if(e!=null)return Object(e)},T=(e,s,r)=>{const p=s[r];p!=null&&(!o.call(e,r)||!h(p)?e[r]=p:e[r]=E(Object(e[r]),s[r]))},E=(e,s)=>{if(e===s)return e;s=Object(s);for(const r in s)o.call(s,r)&&T(e,s,r);if(Object.getOwnPropertySymbols){const r=Object.getOwnPropertySymbols(s);for(let p=0;p<r.length;p++)u.call(s,r[p])&&T(e,s,r[p])}return e},M=function(e){e=v(e);for(let s=1;s<arguments.length;s++)E(e,arguments[s]);return e},O=()=>{switch(t.value.type){case"JSON":x("application/json");break;case"XML":x("text/xml");break;case"WWW_FORM":x("application/x-www-form-urlencoded");break;case"BINARY":x("application/octet-stream");break;default:N();break}},x=e=>{let s=!1;y.value.forEach(r=>{r.name==="Content-Type"&&(r.value=e,s=!0)}),s||y.value.unshift(new Y({name:"Content-Type",value:e}))},N=()=>{for(const e in y.value)if(y.value[e].name==="Content-Type"){y.value.splice(parseInt(e),1),I("headersChange");return}},B=e=>{isNaN(e)?t.value.kvs.push(e):t.value.kvs.splice(e,1)},I=a;return(e,s)=>{const r=W,p=P;return g(),w("div",null,[m(p,{modelValue:i(t).type,"onUpdate:modelValue":s[0]||(s[0]=f=>i(t).type=f)},{default:j(()=>[m(r,{disabled:c.isReadOnly,label:i(_).FORM_DATA,onChange:O},{default:j(()=>[S(R(i(n)("datasource.body_form_data")),1)]),_:1},8,["disabled","label"]),m(r,{disabled:c.isReadOnly,label:i(_).WWW_FORM,onChange:O},{default:j(()=>[S(R(i(n)("datasource.body_x_www_from_urlencoded")),1)]),_:1},8,["disabled","label"]),m(r,{disabled:c.isReadOnly,label:i(_).JSON,onChange:O},{default:j(()=>[S(R(i(n)("datasource.body_json")),1)]),_:1},8,["disabled","label"]),m(r,{disabled:c.isReadOnly,label:i(_).XML,onChange:O},{default:j(()=>[S(R(i(n)("datasource.body_xml")),1)]),_:1},8,["disabled","label"]),m(r,{disabled:c.isReadOnly,label:i(_).RAW,onChange:O},{default:j(()=>[S(R(i(n)("datasource.body_raw")),1)]),_:1},8,["disabled","label"])]),_:1},8,["modelValue"]),i(t).type=="Form_Data"||i(t).type=="WWW_FORM"?(g(),w("div",te,[m(F,{"is-read-only":c.isReadOnly,parameters:i(t).kvs,"is-show-enable":c.isShowEnable,type:"body",onChangeParameters:B,"value-list":c.valueList},null,8,["is-read-only","parameters","is-show-enable","value-list"])])):C("",!0),i(t).type=="JSON"?(g(),w("div",se,[m(A,{ref:"codeEdit","read-only":c.isReadOnly,modelValue:i(t).raw,"onUpdate:modelValue":s[1]||(s[1]=f=>i(t).raw=f),class:"api-body-code",data:i(t).raw,modes:l,mode:"json",height:"200px"},null,8,["read-only","modelValue","data"])])):C("",!0),i(t).type=="XML"?(g(),w("div",oe,[m(A,{ref:"codeEdit","read-only":c.isReadOnly,class:"api-body-code",modelValue:i(t).raw,"onUpdate:modelValue":s[2]||(s[2]=f=>i(t).raw=f),data:i(t).raw,height:"200px",mode:"xml",modes:l},null,8,["read-only","modelValue","data"])])):C("",!0),i(t).type=="Raw"?(g(),w("div",ae,[m(A,{ref:"codeEdit","read-only":c.isReadOnly,modelValue:i(t).raw,"onUpdate:modelValue":s[3]||(s[3]=f=>i(t).raw=f),data:i(t).raw,height:"200px",class:"api-body-code",modes:l},null,8,["read-only","modelValue","data"])])):C("",!0)])}}});const Be=z(ie,[["__scopeId","data-v-f2778fbb"]]);export{Be as default};
