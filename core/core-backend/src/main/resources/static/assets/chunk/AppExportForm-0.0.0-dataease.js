import"./index-0.0.0-dataease.js";import{j as k,n as V,y as d}from"./index-0.0.0-dataease2.js";import{E as F}from"./el-drawer-0.0.0-dataease.js";import"./el-form-0.0.0-dataease.js";import{a as u,E as j}from"./el-form-item-0.0.0-dataease.js";import{t as O}from"./dataVisualization-0.0.0-dataease.js";import{d as B}from"./dvMain-0.0.0-dataease.js";import{d as C,r as S,t as z,_ as L,f as T,g as G,i as p,j as r,N as D,k as t,a6 as y,a7 as J}from"./vue-0.0.0-dataease.js";import{_ as M}from"./_plugin-vue_export-helper-0.0.0-dataease.js";const R={class:"app-export"},W={class:"apply",style:{width:"100%"}},$=C({__name:"AppExportForm",props:{componentData:{type:Object,required:!0},canvasViewInfo:{type:Object,required:!0},dvInfo:{type:Object,required:!0}},emits:["closeDraw","downLoadApp"],setup(b,{expose:x,emit:g}){const{t:m}=k(),w=g,_=S(null);B();const E=b,{componentData:q,canvasViewInfo:f,dvInfo:v}=z(E),a=L({applyDownloadDrawer:!1,form:{appName:null,icon:null,version:null,creator:null,required:"2.8.0",description:null},rule:{appName:[{required:!0,min:2,max:25,message:m("datasource.input_limit_2_25",[2,25]),trigger:"blur"}],creator:[{required:!0,min:2,max:25,message:m("datasource.input_limit_2_25",[2,25]),trigger:"blur"}],required:[{required:!0,min:2,max:25,message:m("datasource.input_limit_2_25",[2,25]),trigger:"blur"}],version:[{required:!0,min:2,max:25,message:m("datasource.input_limit_2_25",[2,25]),trigger:"blur"}]}}),I=l=>{a.applyDownloadDrawer=!0,a.form=l},N=()=>{w("closeDraw"),a.applyDownloadDrawer=!1},h=(l,o)=>{q.value.forEach(e=>{if(e.component==="UserView"&&f.value[e.id]){const s=f.value[e.id],{id:n,tableId:i}=s;l.push(n),o.push(i)}else e.component==="Group"?e.propValue.forEach(s=>{if(s.component==="UserView"){const n=f.value[s.id],{id:i,tableId:c}=n;l.push(i),o.push(c)}}):e.component==="DeTabs"&&e.propValue.forEach(s=>{s.componentData.forEach(n=>{if(n.component==="UserView"){const i=f.value[n.id],{id:c,tableId:U}=i;l.push(c),o.push(U)}})})})},A=()=>{var l;(l=_.value)==null||l.validate(o=>{if(o){const e=[],s=[];h(e,s),O({dvId:v.value.id,viewIds:e,dsIds:s}).then(n=>{const i={...n.data,...a.form,visualizationInfo:JSON.stringify(v.value)};w("downLoadApp",i),a.applyDownloadDrawer=!1})}else return!1})};return x({init:I}),(l,o)=>(T(),G(r(F),{title:"应用导出",modelValue:a.applyDownloadDrawer,"onUpdate:modelValue":o[5]||(o[5]=e=>a.applyDownloadDrawer=e),"custom-class":"de-user-drawer",size:"600px",direction:"rtl"},{footer:p(()=>[D("div",W,[t(r(V),{secondary:"",onClick:N},{default:p(()=>[y(J(l.$t("commons.cancel")),1)]),_:1}),t(r(V),{type:"primary",onClick:A},{default:p(()=>o[6]||(o[6]=[y("导出")])),_:1})])]),default:p(()=>[D("div",R,[t(r(j),{ref_key:"applyDownloadForm",ref:_,model:a.form,rules:a.rule,class:"de-form-item","label-width":"180px","label-position":"top"},{default:p(()=>[t(r(u),{label:"应用名称",prop:"appName"},{default:p(()=>[t(r(d),{modelValue:a.form.appName,"onUpdate:modelValue":o[0]||(o[0]=e=>a.form.appName=e),autocomplete:"off",placeholder:"请输入名称"},null,8,["modelValue"])]),_:1}),t(r(u),{label:"应用版本号",prop:"version"},{default:p(()=>[t(r(d),{modelValue:a.form.version,"onUpdate:modelValue":o[1]||(o[1]=e=>a.form.version=e),autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(r(u),{label:"DataEase最低版本号",prop:"required"},{default:p(()=>[t(r(d),{modelValue:a.form.required,"onUpdate:modelValue":o[2]||(o[2]=e=>a.form.required=e),autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(r(u),{label:"作者",prop:"creator"},{default:p(()=>[t(r(d),{modelValue:a.form.creator,"onUpdate:modelValue":o[3]||(o[3]=e=>a.form.creator=e),autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(r(u),{label:"描述",prop:"description"},{default:p(()=>[t(r(d),{placeholder:"请输入内容","show-word-limit":"",modelValue:a.form.description,"onUpdate:modelValue":o[4]||(o[4]=e=>a.form.description=e),type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])])]),_:1},8,["modelValue"]))}});const ae=M($,[["__scopeId","data-v-b22489ff"]]);export{ae as A};
