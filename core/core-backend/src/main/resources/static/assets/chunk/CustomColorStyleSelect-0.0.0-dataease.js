import{u as Q,P as fe}from"./index-0.0.0-dataease.js";import{E as Ce}from"./el-row-0.0.0-dataease.js";import{j as he,e as _e,y as ye,_ as Se}from"./index-0.0.0-dataease2.js";import{a as be}from"./el-form-item-0.0.0-dataease.js";import{i as ge}from"./icon_admin_outlined-0.0.0-dataease.js";import{E as Y}from"./el-radio-button-0.0.0-dataease.js";import"./el-input-number-0.0.0-dataease.js";import"./el-radio-0.0.0-dataease.js";import"./el-radio-group-0.0.0-dataease.js";import"./el-popper-0.0.0-dataease.js";import{E as ke}from"./el-popover-0.0.0-dataease.js";import{A as we,C as Ie}from"./chart-0.0.0-dataease.js";import Ve from"./GradientColorSelector-0.0.0-dataease.js";import{B as Ee,C as Fe}from"./util-0.0.0-dataease2.js";import{d as xe,c as Pe}from"./dvMain-0.0.0-dataease.js";import{d as Ne,ai as $e,r as x,_ as Be,m as g,w as Ae,o as Re,e as Oe,f as n,M as p,k as v,i as f,g as T,j as C,V as _,a0 as P,N as d,Z as N,aa as O,W as $,a7 as G,a6 as ze,ag as De,n as ee}from"./vue-0.0.0-dataease.js";import{d as oe}from"./lodash-0.0.0-dataease.js";import{_ as Me}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./library-0.0.0-dataease.js";import"./row-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./user-0.0.0-dataease.js";import"./index-0.0.0-dataease4.js";import"./position-0.0.0-dataease.js";import"./index-0.0.0-dataease5.js";import"./index-0.0.0-dataease15.js";import"./dropdown-0.0.0-dataease.js";import"./formatter-0.0.0-dataease.js";import"./el-tabs-0.0.0-dataease.js";import"./strings-0.0.0-dataease.js";import"./chart-0.0.0-dataease2.js";import"./app-0.0.0-dataease.js";import"./dataVisualization-0.0.0-dataease2.js";import"./util-0.0.0-dataease.js";import"./antv-0.0.0-dataease.js";import"./extends-0.0.0-dataease.js";import"./sysParameter-0.0.0-dataease.js";import"./TableTooltip-0.0.0-dataease.js";import"./el-col-0.0.0-dataease.js";import"./_commonjs-dynamic-modules-0.0.0-dataease.js";import"./appearance-0.0.0-dataease.js";import"./font-0.0.0-dataease.js";const Te={class:"custom-color-selector-container"},Ge=["onClick"],Le={style:{float:"left"}},We={class:"cases-list__text"},Ue={key:0,class:"custom-color-extend-setting colors"},je=["onClick"],He={class:"inner-selector"},Xe={key:1,class:"series-color-setting colors"},Ze=["id"],qe=["onClick"],Je=["id"],Ke=["title"],Qe={class:"series-color-picker-wrapper"},Ye=Ne({__name:"CustomColorStyleSelect",props:{themes:{default:"light"},modelValue:{},propertyInner:{},chart:{},sub:{type:Boolean,default:!1}},emits:["update:modelValue","changeBasicStyle"],setup(re,{emit:te}){const{t:z}=he(),s=re,H=xe(),{batchOptStatus:X}=$e(H),Z=te,le=()=>{b.value&&(l.value.basicStyleForm[w.value]="default",j({value:"default"}))},L=x(),a=Be({seriesColor:[],curSeriesColor:{id:"",name:"",color:""},curColorIndex:0,seriesColorPickerId:"body"}),k=x(),y=g(()=>s.sub?"subColors":"colors"),w=g(()=>s.sub?"subColorScheme":"colorScheme"),I=g(()=>s.sub?"subSeriesColor":"seriesColor"),se=g(()=>{var e,o,t,i,u,m;return((t=(o=(e=k.value)==null?void 0:e.propertyInner)==null?void 0:o["basic-style-selector"])==null?void 0:t.includes("seriesColor"))||((m=(u=(i=k.value)==null?void 0:i.propertyInner)==null?void 0:u["dual-basic-style-selector"])==null?void 0:m.includes("seriesColor"))}),ae=g(()=>{var e,o,t;return(t=(o=(e=k.value)==null?void 0:e.propertyInner)==null?void 0:o["dual-basic-style-selector"])==null?void 0:t.includes("subSeriesColor")}),B=()=>{var u,m,S,E,F,r;if(X.value||!s.chart)return;if(k.value=Pe.getChartView(s.chart.render,s.chart.type),s.sub){if(!ae.value)return}else if(!se.value)return;let e=H.getViewOriginData(s.chart.id);if(!e||(s.chart.type.includes("chart-mix")&&(s.sub?e=(m=(u=e.right)==null?void 0:u.data)==null?void 0:m[0]:e=(E=(S=e.left)==null?void 0:S.data)==null?void 0:E[0]),!e))return;const o=s.sub?(F=k.value)==null?void 0:F.setupSubSeriesColor:k.value.setupSeriesColor;if(!o)return;const t=o(s.chart,e.data),i=((r=s.chart.customAttr.basicStyle[I.value])==null?void 0:r.reduce((c,h)=>(c[h.id]=h,c),{}))||{};t==null||t.forEach(c=>{const h=i[c.id];h&&(c.color=h.color)}),a.seriesColor.splice(0,a.seriesColor.length,...t),a.seriesColor.length&&(a.curColorIndex>a.seriesColor.length-1&&(a.curColorIndex=0),a.curSeriesColor=a.seriesColor[a.curColorIndex],ee(()=>{var c;(c=U.value)==null||c.hide(),a.seriesColorPickerId=`#seriesr-picker-slot-${s.sub?1:0}`}))},ce=(e,o)=>{var i;(i=L.value)==null||i.hide(),a.curSeriesColor=oe(e),a.curColorIndex=o;const t=`series-color-picker-${s.sub?1:0}-${o}`;a.seriesColorPickerId=`#${t}`,ee(()=>{var m;document.getElementById(t)&&((m=L.value)==null||m.show())})},ie=()=>{let e=!1;a.seriesColor.forEach(o=>{o.id===a.curSeriesColor.id&&o.color!==a.curSeriesColor.color&&(e=!0,o.color=a.curSeriesColor.color)}),e&&(l.value.basicStyleForm[I.value]=oe(a.seriesColor),R(I.value))};Ae([()=>s.chart,()=>{var e;return(e=s.chart)==null?void 0:e.type},()=>{var e;return(e=s.chart)==null?void 0:e.customAttr.basicStyle.calcTopN},()=>{var e;return(e=s.chart)==null?void 0:e.customAttr.basicStyle.topN},()=>{var e;return(e=s.chart)==null?void 0:e.customAttr.basicStyle.topNLabel}],B,{deep:!1}),Re(()=>{Q({name:"chart-type-change",callback:le}),Q({name:"chart-data-change",callback:B}),B()});const l=g({get(){return s.modelValue},set(e){Z("update:modelValue",e)}}),W=we,q=Ie,A=x(!1),J=x(),U=x();function K(e){var o;l.value.basicStyleForm[w.value]=e.value,R(w.value),(o=J.value)==null||o.hide(),j(e)}const j=e=>{var u,m;const i=(((u=e==null?void 0:e.value)==null?void 0:u.endsWith("_split_gradient"))||b.value?Ee(W):W).filter(S=>S.value===l.value.basicStyleForm[w.value]);i.length>0&&(l.value.basicStyleForm[y.value]=[...i[0].colors],l.value.customColor=l.value.basicStyleForm[y.value][0],l.value.colorIndex=0,(m=l.value.basicStyleForm[I.value])==null||m.forEach((S,E)=>{const F=i[0].colors.length;S.color=i[0].colors[E%F]}),R(),B())},ne=()=>{s.chart.type.includes("map")?j():(l.value.basicStyleForm[I.value]=[],R(I.value),B())},ue=()=>{const{colorIndex:e,customColor:o,basicStyleForm:t}=l.value,i=t[y.value];if(b.value){let u=e===0?o:i[0],m=e===0?i[8]:o;t[y.value]=Fe(u,m,9,1)}else i[e]=o;R()},b=g(()=>l.value.basicStyleForm[w.value].endsWith("_split_gradient")),D=e=>e===0||e===l.value.basicStyleForm[y.value].length-1,me=(e,o)=>{var t;b.value&&!D(e)||(l.value.colorIndex=e,l.value.customColor=o,(t=U.value)==null||t.show())};function R(e=y.value){Z("changeBasicStyle",e)}const M=x(!1);function de(){M.value=!0}function pe(){M.value=!1}const V=e=>{var o;return(o=s.propertyInner)==null?void 0:o.includes(e)},ve=(e,o)=>{const t=o.colorIndex===e;return b.value?D(e)?t?"var(--ed-color-primary)":"rgb(230,230,230)":"rgb(230,230,230,0.01)":t?"var(--ed-color-primary)":""};return(e,o)=>{const t=be,i=Oe("ArrowDown"),u=_e,m=ye,S=fe,E=Se,F=Ce;return n(),p("div",{style:$([{width:"100%"},{"margin-bottom":A.value?"16px":0}])},[v(F,null,{default:f(()=>[V("gradient-color")?(n(),T(t,{key:0,label:C(z)("chart.color_case"),class:_(["form-item","form-item-"+e.themes]),style:{flex:"1","padding-right":"8px","margin-bottom":"16px"}},{default:f(()=>[v(Ve,{modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=r=>l.value=r),themes:e.themes,onSelectColorCase:K},null,8,["modelValue","themes"])]),_:1},8,["label","class"])):P("",!0),V("gradient-color")?P("",!0):(n(),T(t,{key:1,label:C(z)("chart.color_case"),class:_(["form-item","form-item-"+e.themes]),style:{flex:"1","padding-right":"8px","margin-bottom":"16px"}},{default:f(()=>[v(C(ke),{placement:"bottom-start",ref_key:"colorCaseSelectorRef",ref:J,width:"268",offset:4,trigger:"click",persistent:!1,"show-arrow":!1,onShow:de,onHide:pe,"popper-style":{padding:0},effect:e.themes},{reference:f(()=>[v(m,{effect:e.themes,readonly:"",class:"custom-color-selector"},{prefix:f(()=>[d("div",Te,[(n(!0),p(N,null,O(l.value.basicStyleForm[y.value],(r,c)=>(n(),p("div",{key:c,style:$({flex:1,height:"100%",backgroundColor:r})},null,4))),128))])]),suffix:f(()=>[v(u,{class:_(["input-arrow-icon",{reverse:M.value}])},{default:f(()=>[v(i)]),_:1},8,["class"])]),_:1},8,["effect"])]),default:f(()=>[v(S,{"max-height":"274px",class:_(["cases-list",{dark:e.themes==="dark"}])},{default:f(()=>[(n(!0),p(N,null,O(C(W),r=>(n(),p("div",{key:r.value,class:_(["select-color-item",{active:l.value.basicStyleForm[w.value]===r.value}]),onClick:c=>K(r)},[d("div",Le,[(n(!0),p(N,null,O(r.colors,(c,h)=>(n(),p("span",{key:h,style:$({width:"20px",height:"20px",float:"left",backgroundColor:c})},null,4))),128))]),d("span",We,G(r.name),1)],10,Ge))),128))]),_:1},8,["class"])]),_:1},8,["effect"])]),_:1},8,["label","class"])),d("div",null,[d("div",{class:_(["custom-color-setting-btn",{active:A.value,dark:e.themes==="dark"}]),onClick:o[1]||(o[1]=r=>A.value=!A.value)},[v(u,{style:{"font-size":"12px"}},{default:f(()=>[v(E,{name:"icon_admin_outlined"},{default:f(()=>[v(C(ge),{class:"svg-icon"})]),_:1})]),_:1})],2)])]),_:1}),A.value?(n(),p(N,{key:0},[d("div",{class:_(["custom-color-extend-setting",{dark:e.themes==="dark"}])},[ze(G(C(z)("chart.custom_case"))+" ",1),d("span",{style:{color:"var(--ed-color-primary)",cursor:"pointer"},onClick:ne},G(C(z)("chart.reset")),1)],2),!e.sub&&V("seriesColor")||e.sub&&V("subSeriesColor")?P("",!0):(n(),p("div",Ue,[(n(!0),p(N,null,O(l.value.basicStyleForm[y.value],(r,c)=>(n(),p("div",{key:c,class:_([{active:l.value.colorIndex===c,hover:b.value?D(c):!0},"color-item"]),style:$({"border-color":ve(c,l.value)}),onClick:h=>me(c,r)},[d("div",{class:"color-item__inner",style:$({backgroundColor:r})},[b.value&&D(c)?(n(),T(u,{key:0,class:_(["input-arrow-icon",{reverse:M.value}]),style:{color:"white","font-size":"x-small",left:"2px",bottom:"2px"}},{default:f(()=>[v(i)]),_:1},8,["class"])):P("",!0)],4)],14,je))),128)),d("div",He,[v(C(Y),{ref_key:"customColorPickerRef",ref:U,modelValue:l.value.customColor,"onUpdate:modelValue":o[2]||(o[2]=r=>l.value.customColor=r),size:"small",predefine:C(q),onChange:ue},null,8,["modelValue","predefine"])])])),(!e.sub&&V("seriesColor")||e.sub&&V("subSeriesColor"))&&!C(X)?(n(),p("div",Xe,[d("div",{id:`seriesr-picker-slot-${e.sub?1:0}`,style:{overflow:"hidden",transform:"translateX(0)"}},null,8,Ze),(n(!0),p(N,null,O(a.seriesColor,(r,c)=>{var h;return n(),p("div",{key:r.id,class:"color-list-item"},[d("div",{class:_([{active:r.id===((h=a.curSeriesColor)==null?void 0:h.id)},"color-item"]),onClick:eo=>ce(r,c)},[d("div",{class:"color-item__inner",style:$({backgroundColor:r.color})},null,4)],10,qe),d("div",{id:`series-color-picker-${e.sub?1:0}-${c}`},null,8,Je),d("span",{title:r.name,class:_(["color-item-name",e.themes==="dark"?"dark":""])},G(r.name),11,Ke)])}),128))])):P("",!0)],64)):P("",!0),(n(),T(De,{defer:"",to:a.seriesColorPickerId},[d("div",Qe,[v(C(Y),{ref_key:"seriesColorPickerRef",ref:L,modelValue:a.curSeriesColor.color,"onUpdate:modelValue":o[3]||(o[3]=r=>a.curSeriesColor.color=r),size:"small","popper-class":"series-color-picker",teleported:!1,predefine:C(q),onChange:ie},null,8,["modelValue","predefine"])])],8,["to"]))],4)}}});const Ho=Me(Ye,[["__scopeId","data-v-8eccc2bf"]]);export{Ho as default};
