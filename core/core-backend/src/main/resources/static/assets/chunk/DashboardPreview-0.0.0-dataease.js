import{g as y}from"./DePreview-0.0.0-dataease.js";import{i as I,O as S}from"./canvasUtils-0.0.0-dataease.js";import{i as C}from"./interactive-0.0.0-dataease.js";import{a as O,b as D,u as E}from"./index-0.0.0-dataease.js";import{j as M,d as B,w as F,i as V}from"./index-0.0.0-dataease2.js";import{a as x}from"./CrossPermission-0.0.0-dataease.js";import{g as T}from"./outerParams-0.0.0-dataease.js";import{d as j}from"./dvMain-0.0.0-dataease.js";import"./index-0.0.0-dataease24.js";import"./index-0.0.0-dataease54.js";import"./index-0.0.0-dataease27.js";import{E as q}from"./EmptyBackground-0.0.0-dataease.js";import{d as N,r as u,R as G,_ as W,al as z,n as R,f as c,M as v,V as A,k as J,a0 as f,g as L,Z}from"./vue-0.0.0-dataease.js";import{_ as H}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./style-0.0.0-dataease.js";import"./translate-0.0.0-dataease.js";import"./imgUtils-0.0.0-dataease.js";import"./library-0.0.0-dataease.js";import"./util-0.0.0-dataease.js";import"./util-0.0.0-dataease2.js";import"./chart-0.0.0-dataease.js";import"./formatter-0.0.0-dataease.js";import"./chart-0.0.0-dataease2.js";import"./app-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./user-0.0.0-dataease.js";import"./eventBus-0.0.0-dataease.js";import"./Component-0.0.0-dataease16.js";import"./DeShortcutKey-0.0.0-dataease.js";import"./snapshot-0.0.0-dataease.js";import"./dataVisualization-0.0.0-dataease2.js";import"./canvasStyle-0.0.0-dataease.js";import"./dataVisualization-0.0.0-dataease.js";import"./antv-0.0.0-dataease.js";import"./extends-0.0.0-dataease.js";import"./sysParameter-0.0.0-dataease.js";import"./TableTooltip-0.0.0-dataease.js";import"./el-col-0.0.0-dataease.js";import"./row-0.0.0-dataease.js";import"./el-row-0.0.0-dataease.js";import"./_commonjs-dynamic-modules-0.0.0-dataease.js";import"./appearance-0.0.0-dataease.js";import"./font-0.0.0-dataease.js";import"./Component-0.0.0-dataease15.js";import"./el-tooltip-0.0.0-dataease.js";import"./el-popper-0.0.0-dataease.js";import"./icon_edit_outlined-0.0.0-dataease.js";import"./icon_delete-trash_outlined-0.0.0-dataease.js";import"./el-form-0.0.0-dataease.js";import"./el-form-item-0.0.0-dataease.js";import"./el-dialog-0.0.0-dataease.js";import"./use-dialog-0.0.0-dataease.js";import"./refs-0.0.0-dataease.js";import"./el-popover-0.0.0-dataease.js";import"./index-0.0.0-dataease4.js";import"./dropdown-0.0.0-dataease.js";import"./el-tag-0.0.0-dataease.js";import"./el-select-0.0.0-dataease.js";import"./index-0.0.0-dataease14.js";import"./strings-0.0.0-dataease.js";import"./index-0.0.0-dataease5.js";import"./el-tree-0.0.0-dataease.js";import"./index-0.0.0-dataease12.js";import"./el-checkbox-0.0.0-dataease.js";import"./el-tree-select-0.0.0-dataease.js";import"./el-checkbox-group-0.0.0-dataease.js";import"./el-tabs-0.0.0-dataease.js";import"./el-radio-group-0.0.0-dataease.js";import"./el-radio-0.0.0-dataease.js";import"./HandleMore.vue_vue_type_style_index_0_lang-0.0.0-dataease.js";import"./el-dropdown-menu-0.0.0-dataease.js";import"./el-dropdown-item-0.0.0-dataease.js";import"./more_v-0.0.0-dataease.js";import"./icon_add_outlined-0.0.0-dataease.js";import"./icon_drag_outlined-0.0.0-dataease.js";import"./icon_visible_outlined-0.0.0-dataease.js";import"./dv-folder-0.0.0-dataease.js";import"./icon_dataset-0.0.0-dataease.js";import"./icon_warning_filled-0.0.0-dataease.js";import"./icon_info_outlined-0.0.0-dataease.js";import"./time-format-0.0.0-dataease.js";import"./time-format-dayjs-0.0.0-dataease.js";import"./dayjs.min-0.0.0-dataease.js";import"./attr-0.0.0-dataease20.js";import"./dataset-0.0.0-dataease.js";import"./vuedraggable-es-0.0.0-dataease.js";import"./el-time-picker-0.0.0-dataease.js";import"./el-date-picker-0.0.0-dataease.js";import"./arrays-0.0.0-dataease.js";import"./index-0.0.0-dataease15.js";import"./el-input-number-0.0.0-dataease.js";import"./icon_admin_outlined-0.0.0-dataease.js";import"./index-0.0.0-dataease22.js";import"./index-0.0.0-dataease23.js";import"./use-route-0.0.0-dataease.js";import"./index-0.0.0-dataease25.js";import"./index-0.0.0-dataease26.js";import"./el-virtual-list-0.0.0-dataease.js";import"./el-select-v2-0.0.0-dataease.js";import"./fixed-size-list-0.0.0-dataease.js";import"./browser-0.0.0-dataease.js";import"./chart-list-0.0.0-dataease.js";import"./field-list-0.0.0-dataease.js";import"./treeSortUtils-0.0.0-dataease.js";import"./el-empty-0.0.0-dataease.js";import"./none-0.0.0-dataease.js";import"./nothing-tree-0.0.0-dataease.js";import"./Attr-0.0.0-dataease19.js";import"./CommonAttr-0.0.0-dataease.js";import"./el-collapse-item-0.0.0-dataease.js";import"./CommonBorderSetting.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import"./el-upload-0.0.0-dataease.js";import"./el-progress-0.0.0-dataease.js";import"./el-radio-button-0.0.0-dataease.js";import"./position-0.0.0-dataease.js";import"./board-list-0.0.0-dataease.js";import"./ImgViewDialog-0.0.0-dataease.js";import"./el-space-0.0.0-dataease.js";import"./icon_italic_outlined-0.0.0-dataease.js";import"./icon_right-alignment_outlined-0.0.0-dataease.js";import"./CarouselSetting.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import"./CollapseSwitchItem-0.0.0-dataease.js";import"./el-switch-0.0.0-dataease.js";import"./icon_replace_outlined-0.0.0-dataease.js";import"./dv-preview-download-0.0.0-dataease.js";import"./Component.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import"./watermark-0.0.0-dataease2.js";import"./user-0.0.0-dataease2.js";import"./el-divider-0.0.0-dataease.js";import"./ChartComponentS2-0.0.0-dataease.js";import"./ViewTrackBar-0.0.0-dataease.js";import"./el-pagination-0.0.0-dataease.js";import"./ChartError-0.0.0-dataease.js";import"./LinkageSet-0.0.0-dataease.js";import"./el-footer-0.0.0-dataease.js";import"./el-aside-0.0.0-dataease.js";import"./dv-link-target-0.0.0-dataease.js";import"./dv-dashboard-spine-0.0.0-dataease.js";import"./CodeMirror-0.0.0-dataease.js";import"./dv-empty-0.0.0-dataease.js";import"./Attr.vue_vue_type_style_index_0_lang-0.0.0-dataease.js";import"./Component-0.0.0-dataease14.js";import"./index-0.0.0-dataease28.js";import"./ChartComponentG2Plot-0.0.0-dataease.js";import"./PluginComponent.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import"./DrillPath-0.0.0-dataease.js";import"./base64-0.0.0-dataease.js";import"./DeRichTextView-0.0.0-dataease.js";import"./Component-0.0.0-dataease10.js";import"./ChartEmptyInfo-0.0.0-dataease.js";import"./chart-dark-list-0.0.0-dataease.js";import"./Attr.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import"./Component-0.0.0-dataease11.js";import"./Attr-0.0.0-dataease13.js";import"./Attr-0.0.0-dataease.js";import"./Component-0.0.0-dataease3.js";import"./Attr.vue_vue_type_style_index_0_lang-0.0.0-dataease2.js";import"./Attr-0.0.0-dataease7.js";import"./Component-0.0.0-dataease5.js";import"./Attr-0.0.0-dataease5.js";import"./Component-0.0.0-dataease4.js";import"./Attr.vue_vue_type_script_setup_true_lang-0.0.0-dataease2.js";import"./Component-0.0.0-dataease12.js";import"./Attr.vue_vue_type_script_setup_true_lang-0.0.0-dataease3.js";import"./Component.vue_vue_type_script_setup_true_lang-0.0.0-dataease2.js";import"./Attr-0.0.0-dataease8.js";import"./Component-0.0.0-dataease9.js";import"./Attr.vue_vue_type_script_setup_true_lang-0.0.0-dataease4.js";import"./Attr.vue_vue_type_script_setup_true_lang-0.0.0-dataease5.js";import"./Component-0.0.0-dataease8.js";import"./Attr.vue_vue_type_script_setup_true_lang-0.0.0-dataease6.js";import"./Component-0.0.0-dataease6.js";import"./Attr.vue_vue_type_script_setup_true_lang-0.0.0-dataease7.js";import"./Component-0.0.0-dataease13.js";import"./Attr-0.0.0-dataease16.js";import"./Attr.vue_vue_type_script_setup_true_lang-0.0.0-dataease8.js";import"./Attr-0.0.0-dataease12.js";import"./DatasetSelect-0.0.0-dataease.js";import"./icon_done_outlined-0.0.0-dataease.js";import"./Threshold-0.0.0-dataease.js";import"./TableThresholdEdit-0.0.0-dataease.js";import"./icon_info_filled-0.0.0-dataease.js";import"./TextLabelThresholdEdit-0.0.0-dataease.js";import"./TextThresholdEdit-0.0.0-dataease.js";import"./PictureGroupThresholdEdit-0.0.0-dataease.js";import"./Component-0.0.0-dataease2.js";import"./icon_left_outlined-0.0.0-dataease.js";import"./icon_download_outlined-0.0.0-dataease.js";import"./datasource-0.0.0-dataease.js";const K=N({__name:"DashboardPreview",setup(Q){const{wsCache:_}=O(),w=C(),m=D(),d=u(null),a=G("embeddedParams"),o=a!=null&&a.dvId?a:m,{t:P}=M(),t=W({canvasDataPreview:null,canvasStylePreview:null,canvasViewInfoPreview:null,dvInfo:null,curPreviewGap:0,initState:!0}),p=j(),b=async s=>{if(!window.DataEaseBi||!s)return!0;const i={busiFlag:o.busiFlag};await w.setInteractive(i);const e=o.busiFlag==="dataV"?"screen-weight":"panel-weight";return x(_.get(e),s,1)},n=u(!0);return z(async()=>{if(!await b(o.dvId))return;let i=null;if(m.getToken&&!Object.keys(i=m.getTokenInfo).length){const r=await B.get({url:"/embedded/getTokenArgs"});m.setTokenInfo(r.data),i=m.getTokenInfo}let e;if(await T(o.dvId).then(r=>{p.setNowPanelOuterParamsInfo(r.data)}),o.outerParams)try{const r=JSON.parse(o.outerParams);e=r.attachParams,p.setEmbeddedCallBack(r.callBackFlag||"no")}catch(r){console.error(r),F.error(P("visualization.outer_param_decode_error"));return}i&&Object.keys(i).length&&(e=Object.assign({},e,i)),n.value=!V(),(n.value?I:S)(o.dvId,o.busiFlag,function({canvasDataResult:r,canvasStyleResult:g,dvInfo:l,canvasViewInfoPreview:h,curPreviewGap:k}){if(!n.value)if(l.mobileLayout)p.setMobileInPc(!0),p.setInMobile(!0);else{E().emitter.emit("changeCurrentComponent","DashboardEmpty");return}t.canvasDataPreview=r,t.canvasStylePreview=g,t.canvasViewInfoPreview=h,t.dvInfo=l,t.curPreviewGap=k,R(()=>{d.value.restore()}),t.initState=!1,p.addOuterParamsFilter(e,r,"outer"),t.initState=!0})}),(s,i)=>{const e=y;return c(),v(Z,null,[t.canvasStylePreview&&t.initState?(c(),v("div",{key:0,class:A(n.value?"dashboard-preview":"dv-common-layout-mobile_embedded")},[J(e,{ref_key:"dashboardPreview",ref:d,"dv-info":t.dvInfo,"cur-gap":t.curPreviewGap,"component-data":t.canvasDataPreview,"canvas-style-data":t.canvasStylePreview,"canvas-view-info":t.canvasViewInfoPreview,"show-position":"preview"},null,8,["dv-info","cur-gap","component-data","canvas-style-data","canvas-view-info"])],2)):f("",!0),t.initState?f("",!0):(c(),L(q,{key:1,description:"参数不能为空","img-type":"noneWhite"}))],64)}}});const Di=H(K,[["__scopeId","data-v-fb7db21e"]]);export{Di as default};
