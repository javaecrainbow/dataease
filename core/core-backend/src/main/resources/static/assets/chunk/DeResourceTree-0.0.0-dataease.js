import{p as G,a as Qe,b as Ye,u as J,P as et}from"./index-0.0.0-dataease.js";import{E as tt}from"./el-tree-0.0.0-dataease.js";import"./el-checkbox-0.0.0-dataease.js";import{_ as h,e as V,r as ot,j as nt,y as rt,k as at,x as st,w as lt}from"./index-0.0.0-dataease2.js";import{E as Se,a as xe,b as He}from"./el-dropdown-menu-0.0.0-dataease.js";import"./el-popper-0.0.0-dataease.js";import"./el-dropdown-item-0.0.0-dataease.js";import"./el-tooltip-0.0.0-dataease.js";import{f as l,M as g,N as y,d as Me,m as L,r as C,k as n,i as r,g as p,a0 as k,Z as B,aa as De,j as o,q as Y,a6 as Q,a7 as P,V as ee,ac as Ee,ai as it,t as dt,_ as ct,w as ut,o as mt,ab as pt,U as ge,X as ft,n as we}from"./vue-0.0.0-dataease.js";import{d as vt}from"./dv-dashboard-spine-mobile-0.0.0-dataease.js";import{i as _t}from"./icon_add_outlined-0.0.0-dataease.js";import{d as ye}from"./dv-rename-0.0.0-dataease.js";import{d as be}from"./dv-dashboard-spine-0.0.0-dataease.js";import{d as Ct,i as ht}from"./icon_file-add_outlined-0.0.0-dataease.js";import{i as gt}from"./icon_search-outline_outlined-0.0.0-dataease.js";import{d as wt,a as yt}from"./dv-sort-desc-0.0.0-dataease.js";import{d as Ve}from"./dv-folder-0.0.0-dataease.js";import{i as bt}from"./icon_operation-analysis_outlined-0.0.0-dataease.js";import{i as Vt}from"./icon_edit_outlined-0.0.0-dataease.js";import{q as kt,p as Tt,o as Lt}from"./dataVisualization-0.0.0-dataease.js";import{i as St,_ as xt}from"./HandleMore.vue_vue_type_style_index_0_lang-0.0.0-dataease.js";import Ht from"./DeResourceGroupOpt-0.0.0-dataease.js";import{d as Mt}from"./dvMain-0.0.0-dataease.js";import{useAppStoreWithOut as Dt}from"./app-0.0.0-dataease.js";import Et from"./ShareHandler-0.0.0-dataease.js";import{u as Ne}from"./share-0.0.0-dataease.js";import{i as Nt}from"./interactive-0.0.0-dataease.js";import{_ as X}from"./lodash-0.0.0-dataease.js";import{_ as It}from"./DeResourceCreateOptV2.vue_vue_type_style_index_0_lang-0.0.0-dataease.js";import{K as $t}from"./canvasUtils-0.0.0-dataease.js";import{t as Rt}from"./treeSortUtils-0.0.0-dataease.js";import{E as Ot}from"./index-0.0.0-dataease4.js";import{_ as Zt}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./library-0.0.0-dataease.js";import"./index-0.0.0-dataease12.js";import"./axios-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./user-0.0.0-dataease.js";import"./dropdown-0.0.0-dataease.js";import"./refs-0.0.0-dataease.js";import"./el-dialog-0.0.0-dataease.js";import"./use-dialog-0.0.0-dataease.js";import"./el-form-0.0.0-dataease.js";import"./el-tag-0.0.0-dataease.js";import"./el-select-0.0.0-dataease.js";import"./index-0.0.0-dataease14.js";import"./strings-0.0.0-dataease.js";import"./index-0.0.0-dataease5.js";import"./el-tree-select-0.0.0-dataease.js";import"./el-form-item-0.0.0-dataease.js";import"./nothing-tree-0.0.0-dataease.js";import"./chart-0.0.0-dataease.js";import"./formatter-0.0.0-dataease.js";import"./dataVisualization-0.0.0-dataease2.js";import"./util-0.0.0-dataease.js";import"./util-0.0.0-dataease2.js";import"./chart-0.0.0-dataease2.js";import"./antv-0.0.0-dataease.js";import"./extends-0.0.0-dataease.js";import"./sysParameter-0.0.0-dataease.js";import"./TableTooltip-0.0.0-dataease.js";import"./el-col-0.0.0-dataease.js";import"./row-0.0.0-dataease.js";import"./el-row-0.0.0-dataease.js";import"./_commonjs-dynamic-modules-0.0.0-dataease.js";import"./appearance-0.0.0-dataease.js";import"./font-0.0.0-dataease.js";import"./el-date-picker-0.0.0-dataease.js";import"./dayjs.min-0.0.0-dataease.js";import"./arrays-0.0.0-dataease.js";import"./index-0.0.0-dataease15.js";import"./el-switch-0.0.0-dataease.js";import"./icon_admin_outlined-0.0.0-dataease.js";import"./ShareTicket-0.0.0-dataease.js";import"./el-table-column-0.0.0-dataease.js";import"./icon_left_outlined-0.0.0-dataease.js";import"./de-copy-0.0.0-dataease.js";import"./icon_refresh_outlined-0.0.0-dataease.js";import"./dv-info-0.0.0-dataease.js";import"./icon_delete-trash_outlined-0.0.0-dataease.js";import"./index-0.0.0-dataease16.js";import"./dataset-0.0.0-dataease.js";import"./datasource-0.0.0-dataease.js";import"./index-0.0.0-dataease17.js";import"./el-divider-0.0.0-dataease.js";import"./templateMarket-0.0.0-dataease.js";import"./MarketPreviewV2-0.0.0-dataease.js";import"./el-collapse-item-0.0.0-dataease.js";import"./TemplateMarketPreviewItem-0.0.0-dataease.js";import"./imgUtils-0.0.0-dataease.js";import"./CategoryTemplateV2-0.0.0-dataease.js";import"./TemplateMarketV2Item-0.0.0-dataease.js";import"./base64-0.0.0-dataease.js";import"./eventBus-0.0.0-dataease.js";import"./snapshot-0.0.0-dataease.js";const Pt={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function Bt(w,c){return l(),g("svg",Pt,c[0]||(c[0]=[y("path",{d:"M3.33333 5.33398V13.334H10V5.33398H3.33333ZM11.3333 4.66732V14.0747C11.3333 14.402 11.0548 14.6673 10.7111 14.6673H2.62222C2.27858 14.6673 2 14.402 2 14.0747V4.59324C2 4.26596 2.27858 4.00065 2.62222 4.00065H10.6667C11.0349 4.00065 11.3333 4.29913 11.3333 4.66732ZM13.8047 1.52925C13.9254 1.64989 14 1.81656 14 2.00065V10.334C14 10.5181 13.8508 10.6673 13.6667 10.6673H13C12.8159 10.6673 12.6667 10.5181 12.6667 10.334V2.66732H6.33333C6.14924 2.66732 6 2.51808 6 2.33398V1.66732C6 1.48322 6.14924 1.33398 6.33333 1.33398H13.3333C13.5174 1.33398 13.6841 1.4086 13.8047 1.52925Z",fill:"#646A73"},null,-1)]))}const Ft={render:Bt},At={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function qt(w,c){return l(),g("svg",At,c[0]||(c[0]=[y("path",{d:"M5.33301 2.66732V2.00065C5.33301 1.63246 5.63148 1.33398 5.99967 1.33398H9.99967C10.3679 1.33398 10.6663 1.63246 10.6663 2.00065V2.66732H14.239C14.3876 2.66732 14.4415 2.68279 14.4958 2.71184C14.5501 2.74089 14.5928 2.78352 14.6218 2.83784C14.6509 2.89216 14.6663 2.94605 14.6663 3.09463V3.57334C14.6663 3.72192 14.6509 3.7758 14.6218 3.83013C14.5928 3.88445 14.5501 3.92708 14.4958 3.95613C14.4415 3.98518 14.3876 4.00065 14.239 4.00065H13.333V14.0007C13.333 14.3688 13.0345 14.6673 12.6663 14.6673H3.33301C2.96482 14.6673 2.66634 14.3688 2.66634 14.0007V4.00065H1.76032C1.61174 4.00065 1.55785 3.98518 1.50353 3.95613C1.44921 3.92708 1.40658 3.88445 1.37753 3.83013C1.34848 3.7758 1.33301 3.72192 1.33301 3.57334V3.09463C1.33301 2.94605 1.34848 2.89216 1.37753 2.83784C1.40658 2.78352 1.44921 2.74089 1.50353 2.71184C1.55785 2.68279 1.61174 2.66732 1.76032 2.66732H5.33301ZM3.99967 4.00065V13.334H11.9997V4.00065H3.99967ZM6.33301 5.33398H6.99967C7.18377 5.33398 7.33301 5.48322 7.33301 5.66732V11.6673C7.33301 11.8514 7.18377 12.0007 6.99967 12.0007H6.33301C6.14891 12.0007 5.99967 11.8514 5.99967 11.6673V5.66732C5.99967 5.48322 6.14891 5.33398 6.33301 5.33398ZM8.99967 5.33398H9.66634C9.85044 5.33398 9.99967 5.48322 9.99967 5.66732V11.6673C9.99967 11.8514 9.85044 12.0007 9.66634 12.0007H8.99967C8.81558 12.0007 8.66634 11.8514 8.66634 11.6673V5.66732C8.66634 5.48322 8.81558 5.33398 8.99967 5.33398Z",fill:"#646A73"},null,-1)]))}const ke={render:qt},Wt={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function zt(w,c){return l(),g("svg",Wt,c[0]||(c[0]=[y("path",{d:"M14.0021 1.77734C14.3396 1.77734 14.6186 2.02815 14.6627 2.35355L14.6688 2.44401V13.5614C14.6688 13.8989 14.418 14.1779 14.0926 14.222L14.0021 14.2281H9.89167C9.73059 14.2281 9.59619 14.1138 9.56511 13.962L9.55834 13.8948V13.2281C9.55834 13.067 9.6726 12.9326 9.82449 12.9015L9.89167 12.8948H13.3355V3.11068H4.40563L4.40652 6.11325C4.40652 6.29735 4.25728 6.44659 4.07319 6.44659H3.40652C3.22243 6.44659 3.07319 6.29735 3.07319 6.11325V2.11068C3.07319 1.94959 3.18745 1.8152 3.33934 1.78412L3.40652 1.77734H14.0021ZM6.64113 7.59282C6.73925 7.59282 6.83418 7.6276 6.90908 7.69097L9.70393 10.0559C9.87882 10.2038 9.90063 10.4656 9.75265 10.6405C9.73779 10.658 9.72149 10.6743 9.70393 10.6892L6.90908 13.0541C6.73419 13.202 6.47245 13.1802 6.32447 13.0053C6.26109 12.9304 6.22632 12.8355 6.22632 12.7374L6.22681 11.1164L2.11165 11.1164C1.92756 11.1164 1.77832 10.9672 1.77832 10.7831V10.1164C1.77832 9.93231 1.92756 9.78307 2.11165 9.78307L6.22681 9.78305L6.22632 8.00764C6.22632 7.77854 6.41204 7.59282 6.64113 7.59282Z",fill:"#646A73"},null,-1)]))}const Te={render:zt},Ut={width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function Kt(w,c){return l(),g("svg",Ut,c[0]||(c[0]=[y("path",{d:"M0 3C0 1.34315 1.59845 0 3.57025 0H14.4298C16.4015 0 18 1.34315 18 3V15C18 16.6569 16.4015 18 14.4298 18H3.57025C1.59845 18 0 16.6569 0 15V3Z",fill:"#00d6b9"},null,-1),y("path",{d:"M13.25 4.5C13.3826 4.5 13.5098 4.55268 13.6036 4.64645C13.6973 4.74021 13.75 4.86739 13.75 5V11C13.75 11.1326 13.6973 11.2598 13.6036 11.3536C13.5098 11.4473 13.3826 11.5 13.25 11.5H10.0337L11.5822 12.8762L10.9177 13.6237L9 11.9187L7.08225 13.6237L6.41775 12.8762L7.966 11.5H4.75C4.61739 11.5 4.49021 11.4473 4.39645 11.3536C4.30268 11.2598 4.25 11.1326 4.25 11V5C4.25 4.86739 4.30268 4.74021 4.39645 4.64645C4.49021 4.55268 4.61739 4.5 4.75 4.5H13.25ZM12.75 5.5H5.25V10.5H12.75V5.5ZM10.7192 6.3965L11.4262 7.1035L9.05875 9.471L7.90425 8.31675L7.1035 9.11775L6.3965 8.4105L7.90425 6.90275L9.0585 8.057L10.7192 6.3965Z",fill:"white"},null,-1)]))}const jt={render:Kt},Gt={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function Jt(w,c){return l(),g("svg",Gt,c[0]||(c[0]=[y("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M17.0855 1.00006H4C3.73478 1.00006 3.48043 1.10542 3.29289 1.29295C3.10536 1.48049 3 1.73484 3 2.00006V22.0001C3 22.2653 3.10536 22.5196 3.29289 22.7072C3.48043 22.8947 3.73478 23.0001 4 23.0001H20C20.2652 23.0001 20.5196 22.8947 20.7071 22.7072C20.8946 22.5196 21 22.2653 21 22.0001V4.91556C21.0001 4.65044 20.8949 4.39614 20.7075 4.20856L17.793 1.29306C17.7001 1.20014 17.5898 1.12643 17.4684 1.07616C17.347 1.02588 17.2169 1.00002 17.0855 1.00006ZM7 8.5C7 8.22386 7.22386 8 7.5 8H16.5C16.7761 8 17 8.22386 17 8.5V9.5C17 9.77614 16.7761 10 16.5 10H7.5C7.22386 10 7 9.77614 7 9.5V8.5ZM11 12.5C11 12.2239 11.2239 12 11.5 12H16.5C16.7761 12 17 12.2239 17 12.5V17.5C17 17.7761 16.7761 18 16.5 18H11.5C11.2239 18 11 17.7761 11 17.5V12.5ZM7 12.5C7 12.2239 7.22386 12 7.5 12H8.5C8.77614 12 9 12.2239 9 12.5V17.5C9 17.7761 8.77614 18 8.5 18H7.5C7.22386 18 7 17.7761 7 17.5V12.5Z",fill:"#FF8800"},null,-1)]))}const Le={render:Jt},Xt=Me({__name:"DvHandleMore",props:{menuList:{type:Array},placement:{type:String,default:"bottom-end"},iconName:G.string.def(""),inTable:G.bool.def(!1),resourceType:G.string.def("dashboard"),node:{type:Object,default(){return{}}},anyManage:G.bool.def(!1)},emits:["handleCommand"],setup(w,{emit:c}){const te=Ne(),T=w,H=L(()=>te.getShareDisable),M=C(null),D=C([...T.menuList.map(m=>(!T.anyManage&&(m.command==="copy"||m.command==="move")&&(m.hidden=!0),m))]),F=m=>{if(m==="share"){M.value.execute();return}N("handleCommand",m)},u=m=>{var S;H.value||T.node.leaf&&((S=T.node)==null?void 0:S.weight)>=7&&(D.value[0].divided=!0,D.value.splice(0,0,m))},N=c;return(m,S)=>{const A=V,q=xe,I=He,W=Se;return l(),g(B,null,[n(W,{"popper-class":"menu-more-dv_popper",placement:w.placement,trigger:"click",onCommand:F},{dropdown:r(()=>[n(I,null,{default:r(()=>[(l(!0),g(B,null,De(D.value,a=>(l(),p(q,{divided:a.divided,command:a.command,key:a.label,disabled:a.disabled,class:ee({"de-hidden-drop-item":a.hidden})},{default:r(()=>[a.svgName?(l(),p(A,{key:0,class:"handle-icon"},{default:r(()=>[n(o(h),null,{default:r(()=>[(l(),p(Y(a.svgName),{class:"svg-icon"}))]),_:2},1024)]),_:2},1024)):k("",!0),Q(" "+P(a.label),1)]),_:2},1032,["divided","command","disabled","class"]))),128))]),_:1})]),default:r(()=>[n(A,{class:ee(["hover-icon",w.inTable&&"hover-icon-in-table"]),onClick:S[0]||(S[0]=Ee(()=>{},["stop"]))},{default:r(()=>[n(o(h),null,{default:r(()=>[(l(),p(Y(w.iconName||o(St)),{class:"svg-icon"}))]),_:1})]),_:1},8,["class"])]),_:1},8,["placement"]),H.value?k("",!0):(l(),p(Et,{key:0,ref_key:"shareComponent",ref:M,"resource-id":T.node.id,"resource-type":T.resourceType,weight:w.node.weight,onLoaded:u},null,8,["resource-id","resource-type","weight"]))],64)}}});const Qt={class:"resource-tree"},Yt={class:"tree-header"},eo={class:"icon-methods"},to={class:"title"},oo={key:0,class:"flex-align-center"},no={key:0,class:"ed-dropdown-menu__item--divided"},ro={class:"custom-tree-node"},ao=["title"],so={key:3,class:"icon-more flex-align-center"},lo=Me({__name:"DeResourceTree",props:{curCanvasType:{type:String,required:!0},showPosition:{required:!1,type:String,default:"preview"}},emits:["nodeClick"],setup(w,{expose:c,emit:te}){const T=Ne(),H=Nt(),{wsCache:M}=Qe(),D=Mt(),F=Dt(),u=Ye(),{dvInfo:N}=it(D),{t:m}=nt(),S=w,A={children:"children",label:"name"},q=C(!1),I=C(!1),W=C(!1),{curCanvasType:a,showPosition:z}=dt(S),oe=a.value==="dataV"?m("work_branch.big_data_screen"):m("work_branch.dashboard"),Ie="新建"+oe,x=C(null),U=C(null),$=C([]),R=C(),ne=C(),ce=C(),re=C(!1),d=ct({curSortType:"time_desc",resourceTree:[],originResourceTree:[],folderMenuList:[{label:"移动到",command:"move",svgName:Te},{label:"重命名",command:"rename",svgName:ye},{label:"删除",command:"delete",svgName:ke,divided:!0}],sortType:[{label:"按时间升序",value:"time_asc"},{label:"按时间降序",value:"time_desc"},{label:"按名称升序",value:"name_asc"},{label:"按名称降序",value:"time_asc"}],templateCreatePid:0}),ue=L(()=>a.value==="dashboard"?be:jt),K=L(()=>F.getIsDataEaseBi||F.getIsIframe),$e=L(()=>[{label:"空白新建",svgName:ue.value,command:"newLeaf"},{label:m("work_branch.new_using_template"),svgName:Le,command:"newFromTemplate"},{label:"新建文件夹",divided:!0,svgName:Ve,command:"newFolder"}]),Re=L(()=>[{label:"复制",command:"copy",svgName:Ft},{label:"移动到",command:"move",svgName:Te},{label:"重命名",command:"rename",svgName:ye},{label:"删除",command:"delete",svgName:ke,divided:!0}]),me=u.dvId||ot.currentRoute.value.query.dvId;me&&z.value==="preview"&&(x.value=me,re.value=!0);const Oe=e=>{e.id&&$.value.push(e.id)},Ze=e=>{e.id&&$.value.splice($.value.indexOf(e.id),1)},Pe=(e,t)=>{var s;return e?(s=t.name)==null?void 0:s.toLocaleLowerCase().includes(e.toLocaleLowerCase()):!0},Be=e=>{x.value=e.id,e.leaf?qe("nodeClick",e):R.value.setCurrentKey(null)},ae=async()=>{const e={busiFlag:a.value},t=a.value=="dashboard";await H.setInteractive(e);const s=t?H.getPanel:H.getScreen,i=s.treeNodes;if(I.value=s.rootManage,W.value=s.anyManage,N.value&&N.value.id&&!JSON.stringify(i).includes(N.value.id)&&z.value!=="multiplexing"&&D.resetDvInfo(),i.length&&i[0].id==="0"&&i[0].name==="root"){d.originResourceTree=i[0].children||[],le(d.curSortType),fe();return}d.originResourceTree=i,le(d.curSortType),fe()},Fe=L(()=>X.filter(pe(d.resourceTree),e=>e.leaf)),Ae=L(()=>Fe.value.length>0);function pe(e){let t=X.cloneDeep(e);return X.forEach(e,s=>{s.children&&s.children.length>0&&(t=X.union(t,pe(s.children)))}),t}const fe=()=>{q.value=!0,x.value&&re.value&&($.value=je(),re.value=!1),we(()=>{R.value.setCurrentKey(x.value),we(()=>{if(x.value){const e=document.querySelector(".is-current");e&&e.click()}}),R.value.filter(U.value)})},se=C(!1),qe=te,We=(e,t,s)=>{if(e==="delete"){const i=t.leaf?"":"删除后，此文件夹下的所有资源都会被删除，请谨慎操作。";st.confirm(t.leaf?"确定删除该"+oe+"吗？":"确定删除该文件夹吗？",{confirmButtonType:"danger",type:"warning",tip:i,autofocus:!1,showClose:!1}).then(()=>{Tt(t.id,a.value).then(()=>{lt.success("删除成功"),ae()})})}else if(e==="edit")ve(t.id);else if(e==="copy"){const i=$t(d.resourceTree,t.id),f={nodeType:s,name:t.name+"-copy",type:a.value,id:t.id,pid:i||"0"};se.value=!0,Lt(f).then(v=>{const ie=a.value==="dataV"?`#/dvCanvas?opt=copy&pid=${f.pid}&dvId=${v.data}`:`#/dashboard?opt=copy&pid=${f.pid}&resourceId=${v.data}`;if(K.value){u.clearState(),u.setPid(f.pid),u.setOpt("copy"),a.value==="dataV"?u.setDvId(v.data):u.setResourceId(v.data),J().emitter.emit("changeCurrentComponent",a.value==="dataV"?"VisualizationEditor":"DashboardEditor");return}const de=window.open(ie,"_blank");j(de)}).finally(()=>{se.value=!1})}else ne.value.optInit(s,t,e,["copy"].includes(e))},E=(e,t,s,i)=>{if(e==="newLeaf"){const f=a.value==="dataV"?"#/dvCanvas?opt=create":"#/dashboard?opt=create";let v=null;if(K.value){u.clearState(),u.setOpt("create"),t!=null&&t.id&&u.setPid(t==null?void 0:t.id),J().emitter.emit("changeCurrentComponent",a.value==="dataV"?"VisualizationEditor":"DashboardEditor");return}t!=null&&t.id?v=window.open(f+`&pid=${t.id}`,"_blank"):v=window.open(f,"_blank"),j(v)}else if(e==="newFromTemplate"){const f={curPosition:"create",pid:t==null?void 0:t.id,templateType:a.value==="dataV"?"SCREEN":"PANEL"};ce.value.optInit(f)}else ne.value.optInit(s,t||{},e,i)};function ze(){return E("newLeaf",null,"leaf",!0)}const ve=e=>{const t=a.value==="dataV"?"#/dvCanvas?dvId=":"#/dashboard?resourceId=";if(K.value){u.clearState(),a.value==="dataV"?u.setDvId(e):u.setResourceId(e),J().emitter.emit("changeCurrentComponent",a.value==="dataV"?"VisualizationEditor":"DashboardEditor");return}const s=window.open(t+e,"_blank");j(s)},Ue=()=>{ae()},Ke=e=>{M.set("de-template-data",JSON.stringify(e));const t=a.value==="dataV"?"#/dvCanvas?opt=create&createType=template":"#/dashboard?opt=create&createType=template";let s=null;if(K.value){u.clearState(),u.setOpt("create"),u.setCreateType("template"),d.templateCreatePid&&u.setPid(d.templateCreatePid),J().emitter.emit("changeCurrentComponent",a.value==="dataV"?"VisualizationEditor":"DashboardEditor");return}d.templateCreatePid?s=window.open(t+`&pid=${d.templateCreatePid}`,"_blank"):s=window.open(t,"_blank"),j(s)},_e=(e,t,s=[])=>{for(const i of e){if(i.id===t)return s;if(i.children){const f=[...s,i.id],v=_e(i.children,t,f);if(v)return v}}return null},je=()=>{const e=_e(d.resourceTree,x.value);return e?[x.value,...e]:[]},Ce=[{name:"按创建时间升序",value:"time_asc"},{name:"按创建时间降序",value:"time_desc",divided:!0},{name:"按照名称升序",value:"name_asc"},{name:"按照名称降序",value:"name_desc"}],he=L(()=>Ce.find(e=>e.value===d.curSortType).name),le=e=>{d.resourceTree=Rt(d.originResourceTree,e),d.curSortType=e,M.set("TreeSort-"+a.value,d.curSortType)};ut(U,e=>{R.value.filter(e)});const O=C(null),j=e=>{if(O!=null&&O.value){const t={methodName:"initOpenHandler",args:e};O.value.invokeMethod(t)}},Ge=()=>{const e=M.get("TreeSort-"+a.value);e&&(d.curSortType=e)},Je=()=>{kt().then(e=>{var s,i;const t={shareDisable:(s=e.data)==null?void 0:s.disable,sharePeRequire:(i=e.data)==null?void 0:i.peRequire};T.setData(t)})};return mt(()=>{Ge(),ae(),Je()}),c({rootManage:I,hasData:Ae,createNewObject:ze,mounted:q}),(e,t)=>{const s=Ot,i=xe,f=He,v=Se,ie=rt,de=tt,Xe=pt("loading");return l(),g(B,null,[y("div",Qt,[y("div",Yt,[ge(y("div",eo,[y("span",to,P(o(oe)),1),I.value?(l(),g("div",oo,[n(s,{content:"新建文件夹",placement:"top",effect:"dark"},{default:r(()=>[n(o(V),{class:"custom-icon btn",style:{"margin-right":"20px"},onClick:t[0]||(t[0]=_=>E("newFolder",null,"folder"))},{default:r(()=>[n(o(h),{name:"dv-new-folder"},{default:r(()=>[n(o(Ct),{class:"svg-icon"})]),_:1})]),_:1})]),_:1}),n(s,{content:Ie,placement:"top",effect:"dark"},{default:r(()=>[n(v,{"popper-class":"menu-outer-dv_popper",trigger:"hover"},{dropdown:r(()=>[n(f,null,{default:r(()=>[n(i,{onClick:t[2]||(t[2]=_=>E("newLeaf",null,"leaf",!0))},{default:r(()=>[n(o(V),{class:ee(`handle-icon color-${o(a)}`)},{default:r(()=>[n(o(h),null,{default:r(()=>[(l(),p(Y(ue.value),{class:"svg-icon"}))]),_:1})]),_:1},8,["class"]),t[6]||(t[6]=Q(" 空白新建 "))]),_:1}),n(i,{onClick:t[3]||(t[3]=_=>E("newFromTemplate",null,"leaf",!0))},{default:r(()=>[n(o(V),{class:"handle-icon"},{default:r(()=>[n(o(h),{name:"dv-use-template"},{default:r(()=>[n(o(Le),{class:"svg-icon"})]),_:1})]),_:1}),Q(" "+P(o(m)("work_branch.new_using_template")),1)]),_:1})]),_:1})]),default:r(()=>[n(o(V),{class:"custom-icon btn",onClick:t[1]||(t[1]=_=>E("newLeaf",null,"leaf",!0))},{default:r(()=>[n(o(h),{name:"icon_file-add_outlined"},{default:r(()=>[n(o(ht),{class:"svg-icon"})]),_:1})]),_:1})]),_:1})]),_:1})])):k("",!0)],512),[[ft,o(z)==="preview"]]),n(ie,{placeholder:o(m)("commons.search"),modelValue:U.value,"onUpdate:modelValue":t[4]||(t[4]=_=>U.value=_),clearable:"",class:"search-bar"},{prefix:r(()=>[n(o(V),null,{default:r(()=>[n(o(h),{name:"icon_search-outline_outlined"},{default:r(()=>[n(o(gt),{class:"svg-icon"})]),_:1})]),_:1})]),_:1},8,["placeholder","modelValue"]),n(v,{onCommand:le,trigger:"click"},{dropdown:r(()=>[n(f,{style:{width:"246px"}},{default:r(()=>[(l(),g(B,null,De(Ce,_=>(l(),g(B,{key:_.value},[n(i,{class:ee(["ed-select-dropdown__item",_.value===d.curSortType&&"selected"]),command:_.value},{default:r(()=>[Q(P(_.name),1)]),_:2},1032,["class","command"]),_.divided?(l(),g("li",no)):k("",!0)],64))),64))]),_:1})]),default:r(()=>[n(o(V),{class:"filter-icon-span"},{default:r(()=>[n(s,{offset:16,effect:"dark",content:he.value,placement:"top"},{default:r(()=>[d.curSortType.includes("asc")?(l(),p(o(h),{key:0,name:"dv-sort-asc",class:"opt-icon"},{default:r(()=>[n(o(wt),{class:"svg-icon opt-icon"})]),_:1})):k("",!0)]),_:1},8,["content"]),n(s,{offset:16,effect:"dark",content:he.value,placement:"top"},{default:r(()=>[d.curSortType.includes("desc")?(l(),p(o(h),{key:0,name:"dv-sort-desc",class:"opt-icon"},{default:r(()=>[n(o(yt),{class:"svg-icon opt-icon"})]),_:1})):k("",!0)]),_:1},8,["content"])]),_:1})]),_:1})]),ge((l(),p(o(et),{class:"custom-tree"},{default:r(()=>[n(de,{menu:"",ref_key:"resourceListTree",ref:R,"default-expanded-keys":$.value,data:d.resourceTree,props:A,"node-key":"id","highlight-current":"","expand-on-click-node":!0,"filter-node-method":Pe,onNodeExpand:Oe,onNodeCollapse:Ze,onNodeClick:Be},{default:r(({node:_,data:b})=>[y("span",ro,[b.leaf?o(a)==="dashboard"?(l(),p(o(V),{key:1,style:{"font-size":"18px"}},{default:r(()=>[n(o(h),null,{default:r(()=>[(l(),p(Y(b.extraFlag?o(vt):o(be))))]),_:2},1024)]),_:2},1024)):(l(),p(o(V),{key:2,class:"icon-screen-new color-dataV",style:{"font-size":"18px"}},{default:r(()=>[n(o(h),{name:"icon_operation-analysis_outlined"},{default:r(()=>[n(o(bt),{class:"svg-icon"})]),_:1})]),_:1})):(l(),p(o(V),{key:0,style:{"font-size":"18px"}},{default:r(()=>[n(o(h),{name:"dv-folder"},{default:r(()=>[n(o(Ve),{class:"svg-icon"})]),_:1})]),_:1})),y("span",{title:_.label,class:"label-tooltip"},P(_.label),9,ao),b.weight>=7&&o(z)==="preview"?(l(),g("div",so,[b.leaf?(l(),p(o(V),{key:0,onClick:[t[5]||(t[5]=Ee(()=>{},["stop"])),Z=>ve(b.id)],class:"hover-icon"},{default:r(()=>[n(o(h),{name:"icon_edit_outlined"},{default:r(()=>[n(o(Vt),{class:"svg-icon"})]),_:1})]),_:2},1032,["onClick"])):k("",!0),b.leaf?k("",!0):(l(),p(o(xt),{key:1,onHandleCommand:Z=>E(Z,b,Z==="newFolder"?"folder":"leaf"),"menu-list":$e.value,"icon-name":o(_t),placement:"bottom-start"},null,8,["onHandleCommand","menu-list","icon-name"])),n(Xt,{onHandleCommand:Z=>We(Z,b,b.leaf?"leaf":"folder"),node:b,"any-manage":W.value,"resource-type":o(a),"menu-list":b.leaf?Re.value:d.folderMenuList},null,8,["onHandleCommand","node","any-manage","resource-type","menu-list"])])):k("",!0)])]),_:1},8,["default-expanded-keys","data"]),n(Ht,{"cur-canvas-type":o(a),onFinish:Ue,ref_key:"resourceGroupOpt",ref:ne},null,8,["cur-canvas-type"]),n(It,{"cur-canvas-type":o(a),ref_key:"resourceCreateOpt",ref:ce,onFinish:Ke},null,8,["cur-canvas-type"])]),_:1})),[[Xe,se.value]])]),n(o(at),{ref_key:"openHandler",ref:O,jsname:"L2NvbXBvbmVudC9lbWJlZGRlZC1pZnJhbWUvT3BlbkhhbmRsZXI="},null,512)],64)}}});const Qn=Zt(lo,[["__scopeId","data-v-5c4af24c"]]);export{Qn as default};
