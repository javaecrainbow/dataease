import{au as Q}from"./index-0.0.0-dataease.js";import{E as W}from"./el-drawer-0.0.0-dataease.js";import{j as X,d as C,w as I,y as Y,_ as ee,e as oe,n as ae}from"./index-0.0.0-dataease2.js";import"./el-form-0.0.0-dataease.js";import{E as te}from"./el-row-0.0.0-dataease.js";import{E as le}from"./el-col-0.0.0-dataease.js";import{E as re}from"./el-input-number-0.0.0-dataease.js";import{a as ie,E as ne}from"./el-form-item-0.0.0-dataease.js";import"./el-tag-0.0.0-dataease.js";import{E as se,a as ue}from"./el-select-0.0.0-dataease.js";import"./el-popper-0.0.0-dataease.js";import{i as me}from"./icon_down_outlined-1-0.0.0-dataease.js";import{i as de}from"./icon_down_outlined-0.0.0-dataease.js";import{d as pe}from"./option-0.0.0-dataease.js";import{g as ce}from"./datasource-0.0.0-dataease.js";import{_ as fe}from"./CustomPassword.vue_vue_type_script_setup_true_lang-0.0.0-dataease.js";import{g as O}from"./base64-0.0.0-dataease.js";import{d as v}from"./lodash-0.0.0-dataease.js";import{d as ge,r as x,_ as _e,f as g,g as N,i,N as $,k as t,a6 as E,a7 as z,j as o,M as F,Z as J,aa as be,q as ye,a0 as Ve}from"./vue-0.0.0-dataease.js";import{_ as ve}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./library-0.0.0-dataease.js";import"./use-dialog-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./user-0.0.0-dataease.js";import"./row-0.0.0-dataease.js";import"./index-0.0.0-dataease15.js";import"./index-0.0.0-dataease4.js";import"./index-0.0.0-dataease14.js";import"./strings-0.0.0-dataease.js";import"./index-0.0.0-dataease5.js";import"./icon_visible_outlined-0.0.0-dataease.js";import"./icon_invisible_outlined-0.0.0-dataease.js";const xe={class:"dialog-footer"},Ee=ge({__name:"EngineEdit",emits:["saved"],setup(ze,{expose:D,emit:j}){const{t:e}=X(),_=x(!1),h=x(null),L={name:[{required:!0,message:e("datasource.input_name"),trigger:"blur"},{min:2,max:64,message:e("datasource.input_limit_2_25",[2,64]),trigger:"blur"}]},R={"configuration.dataBase":[{required:!0,message:e("datasource.please_input_data_base"),trigger:"blur"}],"configuration.username":[{required:!0,message:e("datasource.please_input_user_name"),trigger:"blur"}],"configuration.password":[{required:!0,message:e("datasource.please_input_password"),trigger:"blur"}],"configuration.host":[{required:!0,message:e("datasource._ip_address"),trigger:"blur"}],"configuration.extraParams":[{required:!1,message:e("datasource.please_input_url"),trigger:"blur"}],"configuration.port":[{required:!0,message:e("datasource.please_input_port"),trigger:"blur"}],"configuration.initialPoolSize":[{required:!0,message:e("common.inputText")+e("datasource.initial_pool_size"),trigger:"blur"}],"configuration.minPoolSize":[{required:!0,message:e("common.inputText")+e("datasource.min_pool_size"),trigger:"blur"}],"configuration.maxPoolSize":[{required:!0,message:e("common.inputText")+e("datasource.max_pool_size"),trigger:"blur"}],"configuration.queryTimeout":[{required:!0,message:e("common.inputText")+e("datasource.query_timeout"),trigger:"blur"}]},M={...v(R),...v(L)},Z=j,B=()=>{_.value=!1,Object.assign(r,v(U))},A=()=>{B()},k=()=>{h.value=Q.service({target:".basic-param-drawer"})},b=()=>{var n;(n=h.value)==null||n.close()},y=x(!1),U={name:"",createBy:"",creator:"",createTime:"",description:"",id:0,size:0,nodeType:"",type:"",fileName:"",configuration:{host:"",port:8081,dataBase:"",username:"",password:"",extraParams:"",initialPoolSize:5,minPoolSize:5,maxPoolSize:5,queryTimeout:30},syncSetting:null,apiConfiguration:[],weight:0},r=_e(v(U)),G=()=>{ce().then(n=>{let{name:a,createBy:u,id:w,createTime:s,creator:d,type:m,pid:T,configuration:p,syncSetting:c,fileName:V,size:q,description:f,lastSyncTime:P}=n.data;p&&(p=JSON.parse(p)),Object.assign(r,{name:a,pid:T,description:f,fileName:V,size:q,createTime:s,creator:d,createBy:u,id:w,type:m,configuration:p,syncSetting:c,lastSyncTime:P})}).finally(()=>{_.value=!0})},S=x(),H=async()=>{let n=JSON.parse(JSON.stringify(r));n.configuration=O.encode(JSON.stringify(n.configuration)),S.value.validate(a=>{a&&(k(),C.post({url:"/engine/save",data:n}).then(u=>{u!==void 0&&(I.success(e("common.save_success")),Z("saved"),A()),b()}).catch(()=>{b()}))})},K=async()=>{let n=JSON.parse(JSON.stringify(r));n.configuration=O.encode(JSON.stringify(n.configuration)),S.value.validate(a=>{a&&(k(),C.post({url:"/engine/validate",data:n}).then(u=>{u!==void 0&&I.success(e("datasource.validate_success")),b()}).catch(()=>{b()}))})};return D({edit:G}),(n,a)=>{const u=se,w=ue,s=ie,d=Y,m=re,T=ee,p=oe,c=le,V=te,q=ne,f=ae,P=W;return g(),N(P,{title:o(e)("system.engine_settings"),modelValue:_.value,"onUpdate:modelValue":a[15]||(a[15]=l=>_.value=l),"custom-class":"basic-param-drawer",size:"600px",direction:"rtl"},{footer:i(()=>[$("span",xe,[t(f,{secondary:"",onClick:a[12]||(a[12]=l=>B())},{default:i(()=>[E(z(o(e)("common.cancel")),1)]),_:1}),t(f,{secondary:"",onClick:a[13]||(a[13]=l=>K())},{default:i(()=>[E(z(o(e)("datasource.validate")),1)]),_:1}),t(f,{type:"primary",onClick:a[14]||(a[14]=l=>H())},{default:i(()=>[E(z(o(e)("commons.save")),1)]),_:1})])]),default:i(()=>[t(q,{ref_key:"basicForm",ref:S,"require-asterisk-position":"right",model:r,rules:M,"label-width":"80px","label-position":"top"},{default:i(()=>[t(s,{label:o(e)("datasource.type")},{default:i(()=>[t(w,{modelValue:r.type,"onUpdate:modelValue":a[0]||(a[0]=l=>r.type=l),class:"de-select",disabled:""},{default:i(()=>[(g(!0),F(J,null,be(o(pe),l=>(g(),N(u,{key:l.type,label:l.name,value:l.type},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(s,{label:o(e)("datasource.host"),prop:"configuration.host"},{default:i(()=>[t(d,{modelValue:r.configuration.host,"onUpdate:modelValue":a[1]||(a[1]=l=>r.configuration.host=l),placeholder:o(e)("datasource._ip_address"),autocomplete:"off"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),t(s,{label:o(e)("datasource.port"),prop:"configuration.port"},{default:i(()=>[t(m,{modelValue:r.configuration.port,"onUpdate:modelValue":a[2]||(a[2]=l=>r.configuration.port=l),autocomplete:"off","step-strictly":"",class:"text-left",min:0,placeholder:o(e)("common.inputText")+o(e)("datasource.port"),"controls-position":"right",type:"number"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),t(s,{label:o(e)("datasource.data_base"),prop:"configuration.dataBase"},{default:i(()=>[t(d,{modelValue:r.configuration.dataBase,"onUpdate:modelValue":a[3]||(a[3]=l=>r.configuration.dataBase=l),placeholder:o(e)("datasource.please_input_data_base"),autocomplete:"off"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),t(s,{label:o(e)("datasource.user_name")},{default:i(()=>[t(d,{placeholder:o(e)("common.inputText")+o(e)("datasource.user_name"),modelValue:r.configuration.username,"onUpdate:modelValue":a[4]||(a[4]=l=>r.configuration.username=l),autocomplete:"off"},null,8,["placeholder","modelValue"])]),_:1},8,["label"]),t(s,{label:o(e)("datasource.password")},{default:i(()=>[t(o(fe),{placeholder:o(e)("common.inputText")+o(e)("datasource.password"),"show-password":"",type:"password",modelValue:r.configuration.password,"onUpdate:modelValue":a[5]||(a[5]=l=>r.configuration.password=l)},null,8,["placeholder","modelValue"])]),_:1},8,["label"]),t(s,{label:o(e)("datasource.extra_params")},{default:i(()=>[t(d,{placeholder:o(e)("common.inputText")+o(e)("datasource.extra_params"),modelValue:r.configuration.extraParams,"onUpdate:modelValue":a[6]||(a[6]=l=>r.configuration.extraParams=l),autocomplete:"off"},null,8,["placeholder","modelValue"])]),_:1},8,["label"]),$("span",{class:"de-expand",onClick:a[7]||(a[7]=l=>y.value=!y.value)},[E(z(o(e)("datasource.priority"))+" ",1),t(p,null,{default:i(()=>[t(T,null,{default:i(()=>[(g(),N(ye(y.value?o(de):o(me)),{class:"svg-icon"}))]),_:1})]),_:1})]),y.value?(g(),F(J,{key:0},[t(V,{gutter:24,class:"mb16"},{default:i(()=>[t(c,{span:12},{default:i(()=>[t(s,{label:o(e)("datasource.initial_pool_size"),prop:"configuration.initialPoolSize"},{default:i(()=>[t(m,{modelValue:r.configuration.initialPoolSize,"onUpdate:modelValue":a[8]||(a[8]=l=>r.configuration.initialPoolSize=l),"controls-position":"right",autocomplete:"off",placeholder:o(e)("common.inputText")+o(e)("datasource.initial_pool_size"),type:"number",min:0},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),t(c,{span:12},{default:i(()=>[t(s,{label:o(e)("datasource.min_pool_size"),prop:"configuration.minPoolSize"},{default:i(()=>[t(m,{modelValue:r.configuration.minPoolSize,"onUpdate:modelValue":a[9]||(a[9]=l=>r.configuration.minPoolSize=l),"controls-position":"right",autocomplete:"off",placeholder:o(e)("common.inputText")+o(e)("datasource.min_pool_size"),type:"number",min:0},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1}),t(V,{gutter:24},{default:i(()=>[t(c,{span:12},{default:i(()=>[t(s,{label:o(e)("datasource.max_pool_size"),prop:"configuration.maxPoolSize"},{default:i(()=>[t(m,{modelValue:r.configuration.maxPoolSize,"onUpdate:modelValue":a[10]||(a[10]=l=>r.configuration.maxPoolSize=l),"controls-position":"right",autocomplete:"off",placeholder:o(e)("common.inputText")+o(e)("datasource.max_pool_size"),type:"number",min:0},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),t(c,{span:12},{default:i(()=>[t(s,{label:`${o(e)("datasource.query_timeout")}(${o(e)("common.second")})`,prop:"configuration.queryTimeout"},{default:i(()=>[t(m,{modelValue:r.configuration.queryTimeout,"onUpdate:modelValue":a[11]||(a[11]=l=>r.configuration.queryTimeout=l),"controls-position":"right",autocomplete:"off",placeholder:o(e)("common.inputText")+o(e)("datasource.query_timeout"),type:"number",min:0},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})],64)):Ve("",!0)]),_:1},8,["model"])]),_:1},8,["title","modelValue"])}}});const lo=ve(Ee,[["__scopeId","data-v-00fcb8ea"]]);export{lo as default};
