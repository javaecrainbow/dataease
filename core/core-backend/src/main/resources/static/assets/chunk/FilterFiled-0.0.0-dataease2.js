import"./index-0.0.0-dataease.js";import"./el-popper-0.0.0-dataease.js";import{E as ge}from"./el-popover-0.0.0-dataease.js";import"./el-tooltip-0.0.0-dataease.js";import{E as be}from"./el-input-number-0.0.0-dataease.js";import{j as xe,y as Ce,_ as Te,e as Ie}from"./index-0.0.0-dataease2.js";import"./el-tag-0.0.0-dataease.js";import{E as Ee,a as Fe}from"./el-select-0.0.0-dataease.js";import{b as ze,E as De}from"./el-dropdown-menu-0.0.0-dataease.js";import{d as Pe,r as v,t as Ue,R as Y,m as y,w as Z,al as $e,f as u,M as p,N as n,a7 as f,j as t,k as o,i,ac as Me,Z as _,aa as V,W as M,g as h,q as Ne,V as Oe,a0 as I,a6 as G,Y as Le,U as je,aj as Se}from"./vue-0.0.0-dataease.js";import{i as Be}from"./icon_search-outline_outlined-0.0.0-dataease.js";import{i as N}from"./icon_delete-trash_outlined-0.0.0-dataease.js";import{E as Ae}from"./dataset-0.0.0-dataease.js";import{s as Re,t as We,a as Ke,d as qe,v as Ye,f as H}from"./options-0.0.0-dataease.js";import{i as Ze}from"./field-list-0.0.0-dataease.js";import{E as Ge}from"./index-0.0.0-dataease4.js";import{_ as He}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./library-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./dropdown-0.0.0-dataease.js";import"./index-0.0.0-dataease15.js";import"./axios-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./user-0.0.0-dataease.js";import"./index-0.0.0-dataease14.js";import"./strings-0.0.0-dataease.js";import"./index-0.0.0-dataease5.js";import"./refs-0.0.0-dataease.js";const Je={class:"white-nowrap"},Qe={class:"filed-title"},Xe={class:"dimension"},el=["onClick"],ll={key:0,class:"white-nowrap flex-align-center",style:{position:"relative"}},tl={class:"filed-title"},al={class:"filed-title"},nl={class:"de-panel clearfix"},sl={class:"mod-left"},ol={class:"infinite-list autochecker-list",style:{height:"231px",overflow:"auto"}},ul=["onClick"],il={class:"mod-left right-de"},rl={class:"right-top clearfix"},dl={class:"right-btn"},cl={key:0,class:"de-el-dropdown-menu-manu"},ml={class:"text-area"},pl=["placeholder"],vl={class:"text-area-btn"},fl={class:"infinite-list autochecker-list",style:{overflow:"auto"}},_l={class:"right-menu-foot"},yl={class:"footer-right"},hl=Pe({__name:"FilterFiled",props:{index:{default:0},item:{default:()=>({term:"",fieldId:"",filterType:"",deType:0,enumValue:"",name:"",value:null})}},emits:["update:item","del"],setup(J,{emit:Q}){const X=J,{t:r}=xe(),O=v(),ee=v(),E=v(!1),b=v(""),x=v(""),C=v(""),F=v([]),w=v(),L=v(!1),c=v([]),T=v([]),z=v(""),{item:s}=Ue(X),D=Y("getAuthTargetType"),le=Y("filedList"),j=y(()=>C.value?F.value.filter(a=>a.includes(C.value)):F.value),S=y(()=>c.value.join(",")),te=y(()=>{const{term:a,fieldId:e,filterType:d}=s.value,m=["null","empty","not_null","not_empty"].includes(a)&&d==="logic";return{width:e?m?"670px":"750px":"270px"}}),ae=y(()=>["in","not in"].includes(s.value.term)?[{value:"${sysParams.roles}",label:r("auth.sysParams_type.role")}]:Re),ne=y(()=>{const{deType:a}=s.value;return k.value==="sysParams"?We:[0,5].includes(a)?Ke:a===1?qe:Ye}),se=y(()=>b.value?B.value.filter(a=>a.name.includes(b.value)):B.value),B=y(()=>Object.values(le.value||{}));Z(S,()=>{R()});const k=v("");Z(()=>D==null?void 0:D.authTargetType,a=>{k.value===a||!a||(k.value=a)},{immediate:!0}),$e(()=>{ue(),K(s.value.deType)});const oe=()=>{O.value.$el.click()},ue=()=>{const{name:a,enumValue:e,fieldId:d}=s.value,m=e.trim()?e.split(","):[];!a&&d&&(c.value=m),!(!a&&!d)&&(A(),x.value=s.value.name,c.value=m)},ie=()=>{!w.value&&!L.value&&(L.value=!0),w.value=!0},re=()=>{s.value.term="",s.value.value=null,A()},A=()=>{if(k.value==="sysParams")return;const{deType:a,filterType:e,fieldId:d}=s.value;e==="enum"&&[0,5].includes(a)&&Ae({fieldIds:[d]}).then(m=>{F.value=de(m.data)})},de=a=>a?a.filter(e=>!!e):null,ce=()=>{s.value.name=x.value||""},R=()=>{s.value.enumValue=S.value||""},W=a=>{c.value.splice(a,1)},me=({name:a,id:e,deType:d})=>{x.value=a,Object.assign(s.value,{fieldId:e,name:a,deType:d,filterType:"logic",enumValue:"",value:"",term:""}),K(d),c.value=[]},K=a=>{T.value=[{value:"logic",label:r("deDataset.logic_filter")},{value:"enum",label:r("deDataset.enum_filter")}],(k.value==="sysParams"||[1,2,3].includes(a))&&(T.value=[T.value[0]])},q=()=>{c.value=[]},pe=()=>{j.value.forEach(a=>{c.value.includes(a)||c.value.push(a)})},ve=()=>{const a=z.value.split(`
`).reduce((e,d)=>{const m=d.trim();return m&&e.add(m),e},new Set([]));a.size&&(c.value=[...new Set([...c.value,...Array.from(a)])]),w.value=!1},fe=a=>{const e=c.value.findIndex(d=>d===a);e===-1?c.value.push(a):W(e)},_e=Q;return(a,e)=>{const d=Ce,m=Te,g=Ie,ye=ze,he=De,P=Ee,U=Fe,ke=be,Ve=Ge,we=ge;return u(),p("div",Je,[n("div",{class:"filed",style:M(te.value),onMouseover:e[13]||(e[13]=l=>E.value=!0),onMouseleave:e[14]||(e[14]=l=>E.value=!1)},[n("span",Qe,f(t(r)("auth.filter_fields")),1),o(he,{trigger:"click","hide-on-click":!1},{dropdown:i(()=>[o(ye,{class:"de-el-dropdown-menu"},{default:i(()=>[o(d,{onKeydown:e[1]||(e[1]=Me(()=>{},["stop"])),placeholder:t(r)("auth.enter_keywords"),size:"small",modelValue:b.value,"onUpdate:modelValue":e[2]||(e[2]=l=>b.value=l)},{prefix:i(()=>[o(g,null,{default:i(()=>[o(m,{name:"icon_search-outline_outlined"},{default:i(()=>[o(t(Be),{class:"svg-icon"})]),_:1})]),_:1})]),_:1},8,["placeholder","modelValue"]),n("ul",Xe,[(u(!0),p(_,null,V(se.value,l=>(u(),p("li",{onClick:$=>me(l),style:M({backgroundColor:x.value===l.name?"#f0f7ff":""}),key:l.id},[o(g,null,{default:i(()=>[o(m,null,{default:i(()=>[(u(),h(Ne(t(Ze)[t(H)[l.deType]]),{class:Oe(["svg-icon",`field-icon-${t(H)[l.deType]}`])},null,8,["class"]))]),_:2},1024)]),_:2},1024),n("span",null,f(l.name),1)],12,el))),128))])]),_:1})]),default:i(()=>[o(d,{placeholder:t(r)("auth.select_filter_fields"),modelValue:t(s).name,"onUpdate:modelValue":e[0]||(e[0]=l=>t(s).name=l),size:"small",onInput:ce},null,8,["placeholder","modelValue"])]),_:1}),t(s).fieldId?(u(),p("div",ll,[n("span",tl,f(t(r)("auth.screen_method")),1),o(U,{size:"small",onChange:re,modelValue:t(s).filterType,"onUpdate:modelValue":e[3]||(e[3]=l=>t(s).filterType=l),placeholder:t(r)("auth.select")},{default:i(()=>[(u(!0),p(_,null,V(T.value,l=>(u(),h(P,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"]),n("span",al,f(t(r)("auth.fixed_value")),1),t(s).filterType==="logic"?(u(),p(_,{key:0},[o(U,{class:"w100",size:"small",modelValue:t(s).term,"onUpdate:modelValue":e[4]||(e[4]=l=>t(s).term=l),placeholder:t(r)("auth.default_method")},{default:i(()=>[(u(!0),p(_,null,V(ne.value,l=>(u(),h(P,{key:l.value,label:t(r)(l.label),value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"]),k.value==="sysParams"?(u(),h(U,{key:0,class:"w70 mar5",size:"small",modelValue:t(s).value,"onUpdate:modelValue":e[5]||(e[5]=l=>t(s).value=l)},{default:i(()=>[(u(!0),p(_,null,V(ae.value,l=>(u(),h(P,{key:l.value,label:t(r)(l.label),value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):[2,3].includes(t(s).deType)&&!["null","empty","not_null","not_empty"].includes(t(s).term)?(u(),p(_,{key:1},[o(ke,{class:"w70 mar5",size:"small",effect:"plain",modelValue:t(s).value,"onUpdate:modelValue":e[6]||(e[6]=l=>t(s).value=l),"controls-position":"right"},null,8,["modelValue"]),e[15]||(e[15]=n("div",{class:"bottom-line"},null,-1))],64)):["null","empty","not_null","not_empty"].includes(t(s).term)?I("",!0):(u(),p(_,{key:2},[o(d,{class:"w70 mar5",size:"small",modelValue:t(s).value,"onUpdate:modelValue":e[7]||(e[7]=l=>t(s).value=l)},null,8,["modelValue"]),e[16]||(e[16]=n("div",{class:"bottom-line"},null,-1))],64))],64)):(u(),h(we,{key:1,"popper-class":"de-el-dropdown-menu-fixed",width:"360px",trigger:"click",ref_key:"deElDropdownMenuFixed",ref:ee,"hide-on-click":!1},{reference:i(()=>[o(d,{modelValue:t(s).enumValue,"onUpdate:modelValue":e[8]||(e[8]=l=>t(s).enumValue=l),ref_key:"enumInput",ref:O,size:"small",onInput:R,clearable:"",onClear:q},null,8,["modelValue"])]),default:i(()=>[n("div",nl,[n("div",sl,[o(d,{placeholder:t(r)("auth.enter_keywords"),modelValue:C.value,"onUpdate:modelValue":e[9]||(e[9]=l=>C.value=l)},null,8,["placeholder","modelValue"]),n("ul",ol,[(u(!0),p(_,null,V(j.value,l=>(u(),p("li",{key:l,class:"infinite-list-item",onClick:$=>fe(l)},[n("i",{class:"el-icon-check",style:M({opacity:c.value.includes(l)?1:0})},null,4),n("label",null,f(l),1),e[17]||(e[17]=n("span",null,"+",-1))],8,ul))),128))]),n("button",{class:"select-all",onClick:pe},f(t(r)("auth.select_all")),1)]),n("div",il,[n("div",rl,[G(f(t(r)("auth.added"))+f(c.value.length)+" ",1),n("div",dl,[n("span",{onClick:ie},[e[18]||(e[18]=n("i",{class:"el-icon-edit"},null,-1)),G(" "+f(t(r)("auth.manual_input")),1)]),o(Le,{name:"el-zoom-in-top"},{default:i(()=>[w.value?(u(),p("div",cl,[n("div",ml,[je(n("textarea",{placeholder:t(r)("auth.please_fill"),class:"input","onUpdate:modelValue":e[10]||(e[10]=l=>z.value=l)},null,8,pl),[[Se,z.value]]),n("div",vl,[n("button",{type:"button",onClick:e[11]||(e[11]=l=>w.value=!1),class:"btn"},[n("span",null,f(t(r)("auth.close")),1)]),n("button",{type:"button",onClick:ve,class:"btn right-add"},[n("span",null,f(t(r)("auth.add")),1)])])])])):I("",!0)]),_:1})])]),n("ul",fl,[(u(!0),p(_,null,V(c.value,(l,$)=>(u(),p("li",{key:l,class:"infinite-list-item"},[o(Ve,{class:"item",effect:"light",content:l,placement:"top","open-delay":1e3},{default:i(()=>[n("label",null,f(l),1)]),_:2},1032,["content"]),o(g,{onClick:kl=>W($),style:{opacity:"1"}},{default:i(()=>[o(m,{name:"icon_delete-trash_outlined"},{default:i(()=>[o(t(N),{class:"svg-icon"})]),_:1})]),_:2},1032,["onClick"])]))),128))]),n("div",_l,[e[19]||(e[19]=n("div",{class:"footer-left"},"Â ",-1)),n("div",{class:"confirm-btn",onClick:oe},f(t(r)("auth.sure")),1),n("div",yl,[o(g,{onClick:q},{default:i(()=>[o(m,{name:"icon_delete-trash_outlined"},{default:i(()=>[o(t(N),{class:"svg-icon"})]),_:1})]),_:1})])])])])]),_:1},512))])):I("",!0),E.value?(u(),h(g,{key:1,class:"font12",onClick:e[12]||(e[12]=l=>_e("del"))},{default:i(()=>[o(m,{name:"icon_delete-trash_outlined"},{default:i(()=>[o(t(N),{class:"svg-icon"})]),_:1})]),_:1})):I("",!0)],36)])}}});const Gl=He(hl,[["__scopeId","data-v-6337dd8b"]]);export{Gl as default};
