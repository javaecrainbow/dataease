import{a as R,P as S}from"./index-0.0.0-dataease.js";import"./el-footer-0.0.0-dataease.js";import{a as $,b as j,c as H}from"./el-aside-0.0.0-dataease.js";import{E as z}from"./el-tree-0.0.0-dataease.js";import"./el-checkbox-0.0.0-dataease.js";import"./el-tooltip-0.0.0-dataease.js";import"./el-popper-0.0.0-dataease.js";import{j as F,x as O,d as W,w as q,aE as A,_ as P,e as U,y as Z}from"./index-0.0.0-dataease2.js";import{d as K,r as _,f as u,M as g,k as t,i as n,N as e,a7 as d,j as c,V as Q,g as X,ac as Y,a0 as x,Z as ee}from"./vue-0.0.0-dataease.js";import{i as oe}from"./icon_add_outlined-0.0.0-dataease.js";import{i as te}from"./icon_search-outline_outlined-0.0.0-dataease.js";import{i as se}from"./icon_delete-trash_outlined-0.0.0-dataease.js";import{j as ne,z as ae}from"./util-0.0.0-dataease2.js";import{E as le}from"./EmptyBackground-0.0.0-dataease.js";import re from"./GeometryEdit-0.0.0-dataease.js";import{d as ie}from"./lodash-0.0.0-dataease.js";import{E as ce}from"./index-0.0.0-dataease4.js";import{_ as de}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./library-0.0.0-dataease.js";import"./index-0.0.0-dataease12.js";import"./axios-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./user-0.0.0-dataease.js";import"./chart-0.0.0-dataease.js";import"./formatter-0.0.0-dataease.js";import"./chart-0.0.0-dataease2.js";import"./app-0.0.0-dataease.js";import"./el-empty-0.0.0-dataease.js";import"./none-0.0.0-dataease.js";import"./nothing-tree-0.0.0-dataease.js";import"./el-drawer-0.0.0-dataease.js";import"./use-dialog-0.0.0-dataease.js";import"./el-form-0.0.0-dataease.js";import"./el-upload-0.0.0-dataease.js";import"./el-progress-0.0.0-dataease.js";import"./el-form-item-0.0.0-dataease.js";import"./el-tag-0.0.0-dataease.js";import"./el-select-0.0.0-dataease.js";import"./index-0.0.0-dataease14.js";import"./strings-0.0.0-dataease.js";import"./index-0.0.0-dataease5.js";import"./el-tree-select-0.0.0-dataease.js";import"./dv-info-0.0.0-dataease.js";import"./icon_upload_outlined-0.0.0-dataease.js";const me={class:"geo-title"},_e={class:"geo-search"},pe={class:"map-tree-container"},ue=["title","innerHTML"],fe={class:"geo-operate-container"},ve={key:0,class:"geo-content-container"},ge={key:1,class:"geo-content-container"},he={class:"geo-content-top"},ye={class:"geo-content-middle"},ke={class:"geo-area"},Ce={class:"area-label"},Ee={class:"area-content"},Ne={class:"geo-area"},xe={class:"area-label"},Te={class:"area-content"},be={key:0,class:"area-secondary"},we={class:"geo-content-bottom"},Be={class:"area-label"},Me=K({__name:"Geometry",setup(Ve){const{wsCache:E}=R(),{t:r}=F(),h=_(""),f=_([]),v=_(),y=_(null),T=_(!1),a=_(null),b=async s=>{a.value=s;const o=ie(await ne(s.id));a.value.geoJson=JSON.stringify(o);const l=s.pid;if(l){const i=y.value.getNode(l);i&&(a.value.parentName=i.data.name)}},w=s=>{O.confirm(r("system.delete_this_node"),{confirmButtonType:"danger",type:"warning",confirmButtonText:r("common.delete"),cancelButtonText:r("dataset.cancel"),autofocus:!1,showClose:!1}).then(()=>{const o="/geometry/delete/"+s.id;W.post({url:o}).then(()=>{var l;((l=a.value)==null?void 0:l.id)===s.id&&(a.value=null),q.success(r("common.delete_success")),k(!1)})}).catch(()=>{T.value=!1})},B=s=>{var o;(o=y.value)==null||o.filter(s)},M=(s,o)=>(A(o,s),s?o.name.toLocaleLowerCase().includes(s.toLocaleLowerCase()):!0),k=s=>{const o="de-area-tree",l=E.get(o);if(l&&s){f.value=l;return}ae().then(i=>{const C=i.data;f.value=[C],E.set(o,f.value)}).catch(i=>{console.error(i)})},V=s=>{v==null||v.value.edit(s)};return k(!0),(s,o)=>{const l=P,i=U,C=Z,L=ce,D=z,N=S,G=$,I=j,J=H;return u(),g(ee,null,[t(J,{class:"geometry-container"},{default:n(()=>[t(G,{class:"geonetry-aside"},{default:n(()=>[e("div",me,[e("span",null,d(c(r)("online_map.geometry")),1),e("span",{class:"add-icon-span",onClick:o[0]||(o[0]=p=>V())},[t(i,null,{default:n(()=>[t(l,{name:"icon_add_outlined"},{default:n(()=>[t(c(oe),{class:"svg-icon"})]),_:1})]),_:1})])]),e("div",_e,[t(C,{class:"m16 w100",modelValue:h.value,"onUpdate:modelValue":o[1]||(o[1]=p=>h.value=p),clearable:"",placeholder:c(r)("commons.search"),onChange:B},{prefix:n(()=>[t(i,null,{default:n(()=>[t(l,{name:"icon_search-outline_outlined"},{default:n(()=>[t(c(te),{class:"svg-icon"})]),_:1})]),_:1})]),_:1},8,["modelValue","placeholder"])]),e("div",pe,[t(N,{class:"menu-tree"},{default:n(()=>[t(D,{menu:"",ref_key:"areaTreeRef",ref:y,"node-key":"id",data:f.value,onNodeClick:b,"highlight-current":!0,"expand-on-click-node":!1,"default-expand-all":!1,"filter-node-method":M},{default:n(({node:p,data:m})=>[e("span",{class:Q(["custom-tree-node",{"is-disabled":p.disabled||m.root}])},[e("span",{class:"geo-name-span",title:m.name,innerHTML:m.colorName&&h.value?m.colorName:m.name},null,8,ue),e("span",fe,[m.custom?(u(),X(L,{key:0,class:"box-item",effect:"dark",content:c(r)("common.delete"),placement:"top"},{default:n(()=>[t(i,{onClick:Y(Le=>w(m),["stop"]),class:"hover-icon"},{default:n(()=>[t(l,{name:"icon_delete-trash_outlined"},{default:n(()=>[t(c(se),{class:"svg-icon"})]),_:1})]),_:2},1032,["onClick"])]),_:2},1032,["content"])):x("",!0)])],2)]),_:1},8,["data"])]),_:1})])]),_:1}),t(I,{class:"geometry-main"},{default:n(()=>[a.value?(u(),g("div",ge,[e("div",he,[e("span",null,d(a.value.name),1)]),e("div",ye,[e("div",ke,[e("div",Ce,[e("span",null,d(c(r)("system.region_code")),1)]),e("div",Ee,[e("span",null,d(a.value.id),1)])]),e("div",Ne,[e("div",xe,[e("span",null,d(c(r)("system.superior_region")),1)]),e("div",Te,[e("span",null,d(a.value.parentName||"-"),1),a.value.pid?(u(),g("span",be,d("("+a.value.pid+")"),1)):x("",!0)])])]),e("div",we,[e("div",Be,[e("span",null,d(c(r)("system.coordinate_file")),1)]),t(N,{class:"area-content-geo"},{default:n(()=>[e("span",null,d(a.value.geoJson),1)]),_:1})])])):(u(),g("div",ve,[t(le,{"img-type":"noneWhite",description:c(r)("system.on_the_left")},null,8,["description"])]))]),_:1})]),_:1}),t(re,{ref_key:"editor",ref:v,onSaved:o[2]||(o[2]=p=>k(!1))},null,512)],64)}}});const xo=de(Me,[["__scopeId","data-v-1f87a114"]]);export{xo as default};
