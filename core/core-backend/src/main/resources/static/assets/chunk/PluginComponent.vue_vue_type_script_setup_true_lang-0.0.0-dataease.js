import{a as j,u as C,ab as b,_ as S}from"./index-0.0.0-dataease.js";import{d as A,r as p,ah as D,o as F,v as K,av as R,aK as q,ab as B,U as I,f as O,g as E,a5 as J,j as h,q as H}from"./vue-0.0.0-dataease.js";import{ao as T,ap as x,d as U,aq as V,ar as z,as as G,at as r,au as L}from"./index-0.0.0-dataease2.js";import{a as Q}from"./axios-0.0.0-dataease.js";const ae=A({__name:"PluginComponent",emits:["loadFail"],setup(W,{expose:_,emit:y}){const{wsCache:s}=j(),i=p(),n=p(!1),l=D(),f=()=>{i.value=G,n.value=!1},k=a=>{const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let e="";for(var o=0;o<a;o++)e+=t.charAt(Math.floor(Math.random()*t.length));return e},v=a=>{S(Object.assign({}),`../../../../../../../extensions/${r(a[8])}/${r(a[9])}/${r(a[10])}/${r(a[11])}/${r(a[12])}.vue`).then(e=>{i.value=e.default}).catch(e=>{console.error(e),f()})},d=()=>window.atob(l.jsname.toString()).split("/")[0],P=()=>{const a=d();n.value=!0;const t=s.get(`de-plugin-proxy-${a}`);if(t){v(JSON.parse(t)),n.value=!1;return}const e=k(L()),o=window.btoa(a),u=`${e},${o}`;V(u).then(m=>{let M=m.data;const g=z(M,e);N(g),v(g)}).catch(()=>{w("loadFail"),f()}).finally(()=>{n.value=!1})},N=a=>{const t=[];a.forEach(o=>{t.push([...o])});const e=d();s.set(`de-plugin-proxy-${e}`,JSON.stringify(t))},c=p(null),$=a=>{var t,e;c.value.invokeMethod?c.value.invokeMethod(a):(e=(t=c.value)[a.methodName])==null||e.call(t,...a.args)};F(async()=>{const a="xpack-model-distributed";let t=!1;if(s.get(a)===null){const e=await T();s.set("xpack-model-distributed",x(e.data)?"null":e.data),t=e.data}else t=s.get(a);if(x(t)){setTimeout(()=>{w("loadFail"),n.value=!1},1e3);return}if(t){const e=d();if(window[e]){const o=await window[e].mapping[l.jsname];i.value=o.default}else{window.Vue=K,window.Axios=Q,window.Pinia=R,window.vueRouter=q,window.MittAll=C().emitter.all,window.I18n=b;const o=`/xpackComponent/pluginStaticInfo/${e}`;U.get({url:o}).then(async u=>{new Function(u.data||u)();const m=await window[e].mapping[l.jsname];i.value=m.default})}}else P()});const w=y;return _({invokeMethod:$}),(a,t)=>{const e=B("loading");return I((O(),E(H(i.value),J({key:h(l).jsname,ref_key:"pluginProxy",ref:c},h(l)),null,16)),[[e,n.value]])}}});export{ae as _};
