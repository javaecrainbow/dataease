import{g as aa,c as Cm,a as r7,r as n7,i as Jht}from"./lodash-0.0.0-dataease.js";import{_ as nM}from"./library-0.0.0-dataease.js";const WR=Object.freeze(Object.defineProperty({__proto__:null,get Base(){return Zd},get Circle(){return aHt},get Ellipse(){return oHt},get Image(){return sHt},get Line(){return lHt},get Marker(){return _Ht},get Path(){return q4},get Polygon(){return THt},get Polyline(){return AHt},get Rect(){return IHt},get Text(){return LHt}},Symbol.toStringTag,{value:"Module"})),XR=Object.freeze(Object.defineProperty({__proto__:null,get Base(){return ed},get Circle(){return e1e},get Dom(){return r1e},get Ellipse(){return n1e},get Image(){return i1e},get Line(){return a1e},get Marker(){return o1e},get Path(){return s1e},get Polygon(){return l1e},get Polyline(){return u1e},get Rect(){return h1e},get Text(){return v1e}},Symbol.toStringTag,{value:"Module"}));var GP=function(e,t){return GP=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},GP(e,t)};function Ut(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");GP(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var U=function(){return U=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},U.apply(this,arguments)};function hi(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function fZ(e,t,r,n){var i=arguments.length,a=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function dZ(e,t){return function(r,n){t(r,n,e)}}function pZ(e,t,r,n,i,a){function o(S){if(S!==void 0&&typeof S!="function")throw new TypeError("Function expected");return S}for(var s=n.kind,l=s==="getter"?"get":s==="setter"?"set":"value",u=!t&&e?n.static?e:e.prototype:null,c=t||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),f,d=!1,v=r.length-1;v>=0;v--){var g={};for(var x in n)g[x]=x==="access"?{}:n[x];for(var x in n.access)g.access[x]=n.access[x];g.addInitializer=function(S){if(d)throw new TypeError("Cannot add initializers after decoration has completed");a.push(o(S||null))};var w=(0,r[v])(s==="accessor"?{get:c.get,set:c.set}:c[l],g);if(s==="accessor"){if(w===void 0)continue;if(w===null||typeof w!="object")throw new TypeError("Object expected");(f=o(w.get))&&(c.get=f),(f=o(w.set))&&(c.set=f),(f=o(w.init))&&i.unshift(f)}else(f=o(w))&&(s==="field"?i.unshift(f):c[l]=f)}u&&Object.defineProperty(u,n.name,c),d=!0}function vZ(e,t,r){for(var n=arguments.length>2,i=0;i<t.length;i++)r=n?t[i].call(e,r):t[i].call(e);return n?r:void 0}function gZ(e){return typeof e=="symbol"?e:"".concat(e)}function mZ(e,t,r){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function yZ(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function au(e,t,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function s(c){try{u(n.next(c))}catch(f){o(f)}}function l(c){try{u(n.throw(c))}catch(f){o(f)}}function u(c){c.done?a(c.value):i(c.value).then(s,l)}u((n=n.apply(e,t||[])).next())})}function Lh(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(u){return function(c){return l([u,c])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(r=0)),r;)try{if(n=1,i&&(a=u[0]&2?i.return:u[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,u[1])).done)return a;switch(i=0,a&&(u=[u[0]&2,a.value]),u[0]){case 0:case 1:a=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,i=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!a||u[1]>a[0]&&u[1]<a[3])){r.label=u[1];break}if(u[0]===6&&r.label<a[1]){r.label=a[1],a=u;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(u);break}a[2]&&r.ops.pop(),r.trys.pop();continue}u=t.call(e,r)}catch(c){u=[6,c],i=0}finally{n=a=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}var jR=Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]};function _Z(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&jR(t,e,r)}function mi(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Lr(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,a=[],o;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a}function xZ(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Lr(arguments[t]));return e}function Wy(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var a=arguments[t],o=0,s=a.length;o<s;o++,i++)n[i]=a[o];return n}function an(e,t,r){if(r||arguments.length===2)for(var n=0,i=t.length,a;n<i;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}function Mx(e){return this instanceof Mx?(this.v=e,this):new Mx(e)}function bZ(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),i,a=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),s("next"),s("throw"),s("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(v){return function(g){return Promise.resolve(g).then(v,f)}}function s(v,g){n[v]&&(i[v]=function(x){return new Promise(function(w,S){a.push([v,x,w,S])>1||l(v,x)})},g&&(i[v]=g(i[v])))}function l(v,g){try{u(n[v](g))}catch(x){d(a[0][3],x)}}function u(v){v.value instanceof Mx?Promise.resolve(v.value.v).then(c,f):d(a[0][2],v)}function c(v){l("next",v)}function f(v){l("throw",v)}function d(v,g){v(g),a.shift(),a.length&&l(a[0][0],a[0][1])}}function EZ(e){var t,r;return t={},n("next"),n("throw",function(i){throw i}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(i,a){t[i]=e[i]?function(o){return(r=!r)?{value:Mx(e[i](o)),done:!1}:a?a(o):o}:a}}function wZ(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof mi=="function"?mi(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(a){r[a]=e[a]&&function(o){return new Promise(function(s,l){o=e[a](o),i(s,l,o.done,o.value)})}}function i(a,o,s,l){Promise.resolve(l).then(function(u){a({value:u,done:s})},o)}}function CZ(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var tft=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},WP=function(e){return WP=Object.getOwnPropertyNames||function(t){var r=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[r.length]=n);return r},WP(e)};function SZ(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r=WP(e),n=0;n<r.length;n++)r[n]!=="default"&&jR(t,e,r[n]);return tft(t,e),t}function TZ(e){return e&&e.__esModule?e:{default:e}}function AZ(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)}function MZ(e,t,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(e,r):i?i.value=r:t.set(e,r),r}function RZ(e,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof e=="function"?t===e:e.has(t)}function IZ(e,t,r){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var n,i;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose],r&&(i=n)}if(typeof n!="function")throw new TypeError("Object not disposable.");i&&(n=function(){try{i.call(this)}catch(a){return Promise.reject(a)}}),e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var eft=typeof SuppressedError=="function"?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function LZ(e){function t(a){e.error=e.hasError?new eft(a,e.error,"An error was suppressed during disposal."):a,e.hasError=!0}var r,n=0;function i(){for(;r=e.stack.pop();)try{if(!r.async&&n===1)return n=0,e.stack.push(r),Promise.resolve().then(i);if(r.dispose){var a=r.dispose.call(r.value);if(r.async)return n|=2,Promise.resolve(a).then(i,function(o){return t(o),i()})}else n|=1}catch(o){t(o)}if(n===1)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}return i()}function OZ(e,t){return typeof e=="string"&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,n,i,a,o){return n?t?".jsx":".js":i&&(!a||!o)?r:i+a+"."+o.toLowerCase()+"js"}):e}const rft={__extends:Ut,__assign:U,__rest:hi,__decorate:fZ,__param:dZ,__esDecorate:pZ,__runInitializers:vZ,__propKey:gZ,__setFunctionName:mZ,__metadata:yZ,__awaiter:au,__generator:Lh,__createBinding:jR,__exportStar:_Z,__values:mi,__read:Lr,__spread:xZ,__spreadArrays:Wy,__spreadArray:an,__await:Mx,__asyncGenerator:bZ,__asyncDelegator:EZ,__asyncValues:wZ,__makeTemplateObject:CZ,__importStar:SZ,__importDefault:TZ,__classPrivateFieldGet:AZ,__classPrivateFieldSet:MZ,__classPrivateFieldIn:RZ,__addDisposableResource:IZ,__disposeResources:LZ,__rewriteRelativeImportExtension:OZ},x3e=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:IZ,get __assign(){return U},__asyncDelegator:EZ,__asyncGenerator:bZ,__asyncValues:wZ,__await:Mx,__awaiter:au,__classPrivateFieldGet:AZ,__classPrivateFieldIn:RZ,__classPrivateFieldSet:MZ,__createBinding:jR,__decorate:fZ,__disposeResources:LZ,__esDecorate:pZ,__exportStar:_Z,__extends:Ut,__generator:Lh,__importDefault:TZ,__importStar:SZ,__makeTemplateObject:CZ,__metadata:yZ,__param:dZ,__propKey:gZ,__read:Lr,__rest:hi,__rewriteRelativeImportExtension:OZ,__runInitializers:vZ,__setFunctionName:mZ,__spread:xZ,__spreadArray:an,__spreadArrays:Wy,__values:mi,default:rft},Symbol.toStringTag,{value:"Module"}));function nft(e,t){if(nM(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nM(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function PZ(e){var t=nft(e,"string");return nM(t)=="symbol"?t:t+""}function z(e,t,r){return(t=PZ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var aw,$L,DZ,XP;function ift(){aw=document.createElement("table"),$L=document.createElement("tr"),DZ=/^\s*<(\w+|!)[^>]*>/,XP={tr:document.createElement("tbody"),tbody:aw,thead:aw,tfoot:aw,td:$L,th:$L,"*":document.createElement("div")}}function eg(e){aw||ift();var t=DZ.test(e)&&RegExp.$1;(!t||!(t in XP))&&(t="*");var r=XP[t];e=typeof e=="string"?e.replace(/(^\s*)|(\s*$)/g,""):e,r.innerHTML=""+e;var n=r.childNodes[0];return n&&r.contains(n)&&r.removeChild(n),n}const g5="l7plot-legend l7plot-legend__category",m5="l7plot-legend__title",y5="l7plot-legend__category-list",FZ="l7plot-legend__list-item",BZ="l7plot-legend__category-marker",NZ="l7plot-legend__category-value",aft=`<div class="${g5}">
  <div class="${m5}"></div>
  <ul class="${y5}"></ul>
</div>`,i7=`<li class="${FZ}" data-index={index}>
  <span class="${BZ}" style="background:{color}"></span>
  <span class="${NZ}">{value}</span>
</li>`;function dS(e,t){return!e||!t?e:e.replace(/\\?\{([^{}]+)\}/g,function(r,n){return r.charAt(0)==="\\"?r.slice(1):t[n]===void 0?"":t[n]})}var kZ={},zZ={},a7=e=>zZ[e],Vh=(e,t)=>{zZ[e]=t},oft=e=>kZ[e],fb=(e,t)=>{kZ[e]=t},o7={},HL={},VL=34,bE=10,GL=13;function UZ(e){return new Function("d","return {"+e.map(function(t,r){return JSON.stringify(t)+": d["+r+'] || ""'}).join(",")+"}")}function sft(e,t){var r=UZ(e);return function(n,i){return t(r(n),i,e)}}function s7(e){var t=Object.create(null),r=[];return e.forEach(function(n){for(var i in n)i in t||r.push(t[i]=i)}),r}function Pc(e,t){var r=e+"",n=r.length;return n<t?new Array(t-n+1).join(0)+r:r}function lft(e){return e<0?"-"+Pc(-e,6):e>9999?"+"+Pc(e,6):Pc(e,4)}function uft(e){var t=e.getUTCHours(),r=e.getUTCMinutes(),n=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":lft(e.getUTCFullYear())+"-"+Pc(e.getUTCMonth()+1,2)+"-"+Pc(e.getUTCDate(),2)+(i?"T"+Pc(t,2)+":"+Pc(r,2)+":"+Pc(n,2)+"."+Pc(i,3)+"Z":n?"T"+Pc(t,2)+":"+Pc(r,2)+":"+Pc(n,2)+"Z":r||t?"T"+Pc(t,2)+":"+Pc(r,2)+"Z":"")}function cft(e){var t=new RegExp('["'+e+`
\r]`),r=e.charCodeAt(0);function n(f,d){var v,g,x=i(f,function(w,S){if(v)return v(w,S-1);g=w,v=d?sft(w,d):UZ(w)});return x.columns=g||[],x}function i(f,d){var v=[],g=f.length,x=0,w=0,S,A=g<=0,M=!1;f.charCodeAt(g-1)===bE&&--g,f.charCodeAt(g-1)===GL&&--g;function R(){if(A)return HL;if(M)return M=!1,o7;var N,k=x,V;if(f.charCodeAt(k)===VL){for(;x++<g&&f.charCodeAt(x)!==VL||f.charCodeAt(++x)===VL;);return(N=x)>=g?A=!0:(V=f.charCodeAt(x++))===bE?M=!0:V===GL&&(M=!0,f.charCodeAt(x)===bE&&++x),f.slice(k+1,N-1).replace(/""/g,'"')}for(;x<g;){if((V=f.charCodeAt(N=x++))===bE)M=!0;else if(V===GL)M=!0,f.charCodeAt(x)===bE&&++x;else if(V!==r)continue;return f.slice(k,N)}return A=!0,f.slice(k,g)}for(;(S=R())!==HL;){for(var O=[];S!==o7&&S!==HL;)O.push(S),S=R();d&&(O=d(O,w++))==null||v.push(O)}return v}function a(f,d){return f.map(function(v){return d.map(function(g){return c(v[g])}).join(e)})}function o(f,d){return d==null&&(d=s7(f)),[d.map(c).join(e)].concat(a(f,d)).join(`
`)}function s(f,d){return d==null&&(d=s7(f)),a(f,d).join(`
`)}function l(f){return f.map(u).join(`
`)}function u(f){return f.map(c).join(e)}function c(f){return f==null?"":f instanceof Date?uft(f):t.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:n,parseRows:i,format:o,formatBody:s,formatRows:l,formatRow:u,formatValue:c}}var hft=cft(","),fft=hft.parse,Ic=63710088e-1,dft={centimeters:Ic*100,centimetres:Ic*100,degrees:Ic/111325,feet:Ic*3.28084,inches:Ic*39.37,kilometers:Ic/1e3,kilometres:Ic/1e3,meters:Ic,metres:Ic,miles:Ic/1609.344,millimeters:Ic*1e3,millimetres:Ic*1e3,nauticalmiles:Ic/1852,radians:1,yards:Ic*1.0936};function eC(e,t,r){r===void 0&&(r={});var n={type:"Feature"};return(r.id===0||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=t||{},n.geometry=e,n}function _5(e,t,r){r===void 0&&(r={});for(var n=0,i=e;n<i.length;n++){var a=i[n];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var o=0;o<a[a.length-1].length;o++)if(a[a.length-1][o]!==a[0][o])throw new Error("First and last Position are not equivalent.")}var s={type:"Polygon",coordinates:e};return eC(s,t,r)}function pft(e,t,r){if(r===void 0&&(r={}),e.length<2)throw new Error("coordinates must be an array of two or more positions");var n={type:"LineString",coordinates:e};return eC(n,t,r)}function vft(e,t){t===void 0&&(t={});var r={type:"FeatureCollection"};return t.id&&(r.id=t.id),t.bbox&&(r.bbox=t.bbox),r.features=e,r}function gft(e,t,r){r===void 0&&(r={});var n={type:"MultiPolygon",coordinates:e};return eC(n,t,r)}function mft(e,t){t===void 0&&(t="kilometers");var r=dft[t];if(!r)throw new Error(t+" units is invalid");return e*r}function G2(e){var t=e%360;return t*Math.PI/180}function $Z(e){if(Array.isArray(e))return e;if(e.type==="Feature"){if(e.geometry!==null)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function l7(e){return e.type==="Feature"?e.geometry:e}function HZ(e,t,r){if(e!==null)for(var n,i,a,o,s,l,u,c=0,f=0,d,v=e.type,g=v==="FeatureCollection",x=v==="Feature",w=g?e.features.length:1,S=0;S<w;S++){u=g?e.features[S].geometry:x?e.geometry:e,d=u?u.type==="GeometryCollection":!1,s=d?u.geometries.length:1;for(var A=0;A<s;A++){var M=0,R=0;if(o=d?u.geometries[A]:u,o!==null){l=o.coordinates;var O=o.type;switch(c=r&&(O==="Polygon"||O==="MultiPolygon")?1:0,O){case null:break;case"Point":if(t(l,f,S,M,R)===!1)return!1;f++,M++;break;case"LineString":case"MultiPoint":for(n=0;n<l.length;n++){if(t(l[n],f,S,M,R)===!1)return!1;f++,O==="MultiPoint"&&M++}O==="LineString"&&M++;break;case"Polygon":case"MultiLineString":for(n=0;n<l.length;n++){for(i=0;i<l[n].length-c;i++){if(t(l[n][i],f,S,M,R)===!1)return!1;f++}O==="MultiLineString"&&M++,O==="Polygon"&&R++}O==="Polygon"&&M++;break;case"MultiPolygon":for(n=0;n<l.length;n++){for(R=0,i=0;i<l[n].length;i++){for(a=0;a<l[n][i].length-c;a++){if(t(l[n][i][a],f,S,M,R)===!1)return!1;f++}R++}M++}break;case"GeometryCollection":for(n=0;n<o.geometries.length;n++)if(HZ(o.geometries[n],t,r)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function yft(e,t){var r,n,i,a,o,s,l,u,c,f,d=0,v=e.type==="FeatureCollection",g=e.type==="Feature",x=v?e.features.length:1;for(r=0;r<x;r++){for(s=v?e.features[r].geometry:g?e.geometry:e,u=v?e.features[r].properties:g?e.properties:{},c=v?e.features[r].bbox:g?e.bbox:void 0,f=v?e.features[r].id:g?e.id:void 0,l=s?s.type==="GeometryCollection":!1,o=l?s.geometries.length:1,i=0;i<o;i++){if(a=l?s.geometries[i]:s,a===null){if(t(null,d,u,c,f)===!1)return!1;continue}switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(t(a,d,u,c,f)===!1)return!1;break}case"GeometryCollection":{for(n=0;n<a.geometries.length;n++)if(t(a.geometries[n],d,u,c,f)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}d++}}function VZ(e,t){yft(e,function(r,n,i,a,o){var s=r===null?null:r.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return t(eC(r,i,{bbox:a,id:o}),n,0)===!1?!1:void 0}var l;switch(s){case"MultiPoint":l="Point";break;case"MultiLineString":l="LineString";break;case"MultiPolygon":l="Polygon";break}for(var u=0;u<r.coordinates.length;u++){var c=r.coordinates[u],f={type:l,coordinates:c};if(t(eC(f,i),n,u)===!1)return!1}})}var xA={REGISTERED_PROTOCOLS:{}},_ft=Object.defineProperty,xft=Object.defineProperties,bft=Object.getOwnPropertyDescriptors,u7=Object.getOwnPropertySymbols,Eft=Object.prototype.hasOwnProperty,wft=Object.prototype.propertyIsEnumerable,c7=(e,t,r)=>t in e?_ft(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,x5=(e,t)=>{for(var r in t||(t={}))Eft.call(t,r)&&c7(e,r,t[r]);if(u7)for(var r of u7(t))wft.call(t,r)&&c7(e,r,t[r]);return e},b5=(e,t)=>xft(e,bft(t)),E5=e=>xA.REGISTERED_PROTOCOLS[e.substring(0,e.indexOf("://"))],Cft=class extends Error{constructor(e,t,r,n){super(`AJAXError: ${t} (${e}): ${r}`),this.status=e,this.statusText=t,this.url=r,this.body=n}};function GZ(e,t){const r=new XMLHttpRequest,n=Array.isArray(e.url)?e.url[0]:e.url;r.open(e.method||"GET",n,!0),e.type==="arrayBuffer"&&(r.responseType="arraybuffer");for(const i in e.headers)e.headers.hasOwnProperty(i)&&r.setRequestHeader(i,e.headers[i]);return e.type==="json"&&(r.responseType="text",r.setRequestHeader("Accept","application/json")),r.withCredentials=e.credentials==="include",r.onerror=()=>{t(new Error(r.statusText))},r.onload=()=>{if((r.status>=200&&r.status<300||r.status===0)&&r.response!==null){let i=r.response;if(e.type==="json")try{i=JSON.parse(r.response)}catch(a){return t(a)}t(null,i,r.getResponseHeader("Cache-Control"),r.getResponseHeader("Expires"),r)}else{const i=new Blob([r.response],{type:r.getResponseHeader("Content-Type")});t(new Cft(r.status,r.statusText,n.toString(),i))}},r.cancel=r.abort,r.send(e.body),r}function Sft(e){return new Promise((t,r)=>{GZ(e,(n,i,a,o,s)=>{n?r({err:n,data:null,xhr:s}):t({err:null,data:i,cacheControl:a,expires:o,xhr:s})})})}function w5(e,t){return GZ(e,t)}var Tft=(e,t)=>(E5(e.url)||w5)(b5(x5({},e),{type:"json"}),t),C5=(e,t)=>(E5(e.url)||w5)(b5(x5({},e),{type:"arrayBuffer"}),t),Aft=(e,t)=>w5(b5(x5({},e),{method:"GET"}),t),h7="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function WZ(e,t){const r=new window.Image,n=window.URL||window.webkitURL;r.crossOrigin="anonymous",r.onload=()=>{t(null,r),n.revokeObjectURL(r.src),r.onload=null,window.requestAnimationFrame(()=>{r.src=h7})},r.onerror=()=>t(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const i=new Blob([new Uint8Array(e)],{type:"image/png"});r.src=e.byteLength?n.createObjectURL(i):h7}function XZ(e,t){const r=new Blob([new Uint8Array(e)],{type:"image/png"});createImageBitmap(r).then(n=>{t(null,n)}).catch(n=>{t(new Error(`Could not load image because of ${n.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}var jP=(e,t,r)=>{const n=(i,a)=>{if(i)t(i);else if(a){const o=typeof createImageBitmap=="function",s=r?r(a):a;o?XZ(s,t):WZ(s,t)}};return e.type==="json"?Tft(e,n):C5(e,n)},Mft=(e,t)=>{typeof createImageBitmap=="function"?XZ(e,t):WZ(e,t)},YR=(e=>(e.CENTER="center",e.TOP="top",e["TOP-LEFT"]="top-left",e["TOP-RIGHT"]="top-right",e.BOTTOM="bottom",e["BOTTOM-LEFT"]="bottom-left",e["BOTTOM-RIGHT"]="bottom-right",e.LEFT="left",e.RIGHT="right",e))(YR||{}),iM={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function jZ(e,t,r){const n=e.classList;for(const i in iM)iM.hasOwnProperty(i)&&n.remove(`l7-${r}-anchor-${i}`);n.add(`l7-${r}-anchor-${t}`)}function S5(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function YZ(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function pS(){}var rC=.7,aM=1/rC,ax="\\s*([+-]?\\d+)\\s*",nC="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",kp="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Rft=/^#([0-9a-f]{3,8})$/,Ift=new RegExp("^rgb\\("+[ax,ax,ax]+"\\)$"),Lft=new RegExp("^rgb\\("+[kp,kp,kp]+"\\)$"),Oft=new RegExp("^rgba\\("+[ax,ax,ax,nC]+"\\)$"),Pft=new RegExp("^rgba\\("+[kp,kp,kp,nC]+"\\)$"),Dft=new RegExp("^hsl\\("+[nC,kp,kp]+"\\)$"),Fft=new RegExp("^hsla\\("+[nC,kp,kp,nC]+"\\)$"),f7={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};S5(pS,Vm,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:d7,formatHex:d7,formatHsl:Bft,formatRgb:p7,toString:p7});function d7(){return this.rgb().formatHex()}function Bft(){return ZZ(this).formatHsl()}function p7(){return this.rgb().formatRgb()}function Vm(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=Rft.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?v7(t):r===3?new Rh(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?W2(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?W2(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Ift.exec(e))?new Rh(t[1],t[2],t[3],1):(t=Lft.exec(e))?new Rh(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Oft.exec(e))?W2(t[1],t[2],t[3],t[4]):(t=Pft.exec(e))?W2(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Dft.exec(e))?y7(t[1],t[2]/100,t[3]/100,1):(t=Fft.exec(e))?y7(t[1],t[2]/100,t[3]/100,t[4]):f7.hasOwnProperty(e)?v7(f7[e]):e==="transparent"?new Rh(NaN,NaN,NaN,0):null}function v7(e){return new Rh(e>>16&255,e>>8&255,e&255,1)}function W2(e,t,r,n){return n<=0&&(e=t=r=NaN),new Rh(e,t,r,n)}function Nft(e){return e instanceof pS||(e=Vm(e)),e?(e=e.rgb(),new Rh(e.r,e.g,e.b,e.opacity)):new Rh}function Gm(e,t,r,n){return arguments.length===1?Nft(e):new Rh(e,t,r,n??1)}function Rh(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}S5(Rh,Gm,YZ(pS,{brighter:function(e){return e=e==null?aM:Math.pow(aM,e),new Rh(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?rC:Math.pow(rC,e),new Rh(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:g7,formatHex:g7,formatRgb:m7,toString:m7}));function g7(){return"#"+WL(this.r)+WL(this.g)+WL(this.b)}function m7(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function WL(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function y7(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Ip(e,t,r,n)}function ZZ(e){if(e instanceof Ip)return new Ip(e.h,e.s,e.l,e.opacity);if(e instanceof pS||(e=Vm(e)),!e)return new Ip;if(e instanceof Ip)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),a=Math.max(t,r,n),o=NaN,s=a-i,l=(a+i)/2;return s?(t===a?o=(r-n)/s+(r<n)*6:r===a?o=(n-t)/s+2:o=(t-r)/s+4,s/=l<.5?a+i:2-a-i,o*=60):s=l>0&&l<1?0:o,new Ip(o,s,l,e.opacity)}function kft(e,t,r,n){return arguments.length===1?ZZ(e):new Ip(e,t,r,n??1)}function Ip(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}S5(Ip,kft,YZ(pS,{brighter:function(e){return e=e==null?aM:Math.pow(aM,e),new Ip(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?rC:Math.pow(rC,e),new Ip(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new Rh(XL(e>=240?e-240:e+120,i,n),XL(e,i,n),XL(e<120?e+240:e-120,i,n),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function XL(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}function Qa(e){const t=Vm(e),r=[0,0,0,0];return t!=null&&(r[0]=t.r/255,r[1]=t.g/255,r[2]=t.b/255,r[3]=t.opacity),r}function Oy(e){const t=e&&e[0],r=e&&e[1],n=e&&e[2];return t+r*256+n*65536-1}function Rx(e){return[e+1&255,e+1>>8&255,e+1>>8>>8&255]}function qZ(e){let t=window.document.createElement("canvas"),r=t.getContext("2d");t.width=256,t.height=1;let n=null;const i=r.createLinearGradient(0,0,256,1),a=e.positions[0],o=e.positions[e.positions.length-1];for(let s=0;s<e.colors.length;++s){const l=(e.positions[s]-a)/(o-a);i.addColorStop(l,e.colors[s])}return r.fillStyle=i,r.fillRect(0,0,256,1),n=new Uint8ClampedArray(r.getImageData(0,0,256,1).data),t=null,r=null,{data:n,width:256,height:1}}function zft(e,t){let r=window.document.createElement("canvas"),n=r.getContext("2d");r.width=256,r.height=1;const i=n.createLinearGradient(0,0,256,1),a=t[1]-t[0];for(let l=0;l<e.colors.length;++l){const u=Math.max((e.positions[l]-t[0])/a,0);i.addColorStop(u,e.colors[l])}n.fillStyle=i,n.fillRect(0,0,256,1);const o=n.getImageData(0,0,256,1).data,s=T5(n,o);return r=null,n=null,s}function Uft(e){let t=window.document.createElement("canvas"),r=t.getContext("2d");t.width=256,t.height=1;const n=r.createImageData(256,1);return n.data.fill(0),e.positions.forEach((i,a)=>{const o=Qa(e.colors[a]);n.data[i*4+0]=o[0]*255,n.data[i*4+1]=o[1]*255,n.data[i*4+2]=o[2]*255,n.data[i*4+3]=o[3]*255}),t=null,r=null,n}function $ft(e){let t=window.document.createElement("canvas"),r=t.getContext("2d");r.globalAlpha=1,t.width=256,t.height=1;const n=256/e.colors.length;for(let o=0;o<e.colors.length;o++)r.beginPath(),r.lineWidth=2,r.strokeStyle=e.colors[o],r.moveTo(o*n,0),r.lineTo((o+1)*n,0),r.stroke();const i=r.getImageData(0,0,256,1).data,a=T5(r,i);return t=null,r=null,a}function Hft(e,t){let r=window.document.createElement("canvas"),n=r.getContext("2d");n.globalAlpha=1,r.width=256,r.height=1;const i=t[1]-t[0];e.positions.length-e.colors.length!==1&&console.warn("positions 的数字个数应当比 colors 的样式多一个,poisitions 的首尾值一般为数据的最大最新值");for(let s=0;s<e.colors.length;s++)n.beginPath(),n.lineWidth=2,n.strokeStyle=e.colors[s],n.moveTo((e.positions[s]-t[0])/i*255,0),n.lineTo((e.positions[s+1]-t[0])/i*255,0),n.stroke();const a=n.getImageData(0,0,256,1).data,o=T5(n,a);return r=null,n=null,o}function T5(e,t){const r=e.createImageData(256,1);for(let n=0;n<r.data.length;n+=4)r.data[n+0]=t[n+0],r.data[n+1]=t[n+1],r.data[n+2]=t[n+2],r.data[n+3]=t[n+3];return r}function A5(e){switch(e==null?void 0:e.type){case"cat":return[0,255];default:return[0,1]}}function Vft(e,t,r){return e===e&&(r!==void 0&&(e=e<=r?e:r),t!==void 0&&(e=e>=t?e:t)),e}var Gft=Vft,Wft=/\s/;function Xft(e){for(var t=e.length;t--&&Wft.test(e.charAt(t)););return t}var jft=Xft,Yft=jft,Zft=/^\s+/;function qft(e){return e&&e.slice(0,Yft(e)+1).replace(Zft,"")}var Kft=qft;function Qft(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var qf=Qft;const Jft=aa(qf);var tdt=typeof Cm=="object"&&Cm&&Cm.Object===Object&&Cm,KZ=tdt,edt=KZ,rdt=typeof self=="object"&&self&&self.Object===Object&&self,ndt=edt||rdt||Function("return this")(),jd=ndt,idt=jd,adt=idt.Symbol,vS=adt,_7=vS,QZ=Object.prototype,odt=QZ.hasOwnProperty,sdt=QZ.toString,EE=_7?_7.toStringTag:void 0;function ldt(e){var t=odt.call(e,EE),r=e[EE];try{e[EE]=void 0;var n=!0}catch{}var i=sdt.call(e);return n&&(t?e[EE]=r:delete e[EE]),i}var udt=ldt,cdt=Object.prototype,hdt=cdt.toString;function fdt(e){return hdt.call(e)}var ddt=fdt,x7=vS,pdt=udt,vdt=ddt,gdt="[object Null]",mdt="[object Undefined]",b7=x7?x7.toStringTag:void 0;function ydt(e){return e==null?e===void 0?mdt:gdt:b7&&b7 in Object(e)?pdt(e):vdt(e)}var dg=ydt;function _dt(e){return e!=null&&typeof e=="object"}var Kf=_dt,xdt=dg,bdt=Kf,Edt="[object Symbol]";function wdt(e){return typeof e=="symbol"||bdt(e)&&xdt(e)==Edt}var ZR=wdt,Cdt=Kft,E7=qf,Sdt=ZR,w7=0/0,Tdt=/^[-+]0x[0-9a-f]+$/i,Adt=/^0b[01]+$/i,Mdt=/^0o[0-7]+$/i,Rdt=parseInt;function Idt(e){if(typeof e=="number")return e;if(Sdt(e))return w7;if(E7(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=E7(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Cdt(e);var r=Adt.test(e);return r||Mdt.test(e)?Rdt(e.slice(2),r?2:8):Tdt.test(e)?w7:+e}var JZ=Idt,Ldt=Gft,jL=JZ;function Odt(e,t,r){return r===void 0&&(r=t,t=void 0),r!==void 0&&(r=jL(r),r=r===r?r:0),t!==void 0&&(t=jL(t),t=t===t?t:0),Ldt(jL(e),t,r)}var Pdt=Odt;const Ddt=aa(Pdt);function Fdt(){this.__data__=[],this.size=0}var Bdt=Fdt;function Ndt(e,t){return e===t||e!==e&&t!==t}var gS=Ndt,kdt=gS;function zdt(e,t){for(var r=e.length;r--;)if(kdt(e[r][0],t))return r;return-1}var qR=zdt,Udt=qR,$dt=Array.prototype,Hdt=$dt.splice;function Vdt(e){var t=this.__data__,r=Udt(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():Hdt.call(t,r,1),--this.size,!0}var Gdt=Vdt,Wdt=qR;function Xdt(e){var t=this.__data__,r=Wdt(t,e);return r<0?void 0:t[r][1]}var jdt=Xdt,Ydt=qR;function Zdt(e){return Ydt(this.__data__,e)>-1}var qdt=Zdt,Kdt=qR;function Qdt(e,t){var r=this.__data__,n=Kdt(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var Jdt=Qdt,tpt=Bdt,ept=Gdt,rpt=jdt,npt=qdt,ipt=Jdt;function db(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}db.prototype.clear=tpt;db.prototype.delete=ept;db.prototype.get=rpt;db.prototype.has=npt;db.prototype.set=ipt;var KR=db,apt=KR;function opt(){this.__data__=new apt,this.size=0}var spt=opt;function lpt(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var upt=lpt;function cpt(e){return this.__data__.get(e)}var hpt=cpt;function fpt(e){return this.__data__.has(e)}var dpt=fpt,ppt=dg,vpt=qf,gpt="[object AsyncFunction]",mpt="[object Function]",ypt="[object GeneratorFunction]",_pt="[object Proxy]";function xpt(e){if(!vpt(e))return!1;var t=ppt(e);return t==mpt||t==ypt||t==gpt||t==_pt}var QR=xpt;const bpt=aa(QR);var Ept=jd,wpt=Ept["__core-js_shared__"],Cpt=wpt,YL=Cpt,C7=function(){var e=/[^.]+$/.exec(YL&&YL.keys&&YL.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function Spt(e){return!!C7&&C7 in e}var Tpt=Spt,Apt=Function.prototype,Mpt=Apt.toString;function Rpt(e){if(e!=null){try{return Mpt.call(e)}catch{}try{return e+""}catch{}}return""}var tq=Rpt,Ipt=QR,Lpt=Tpt,Opt=qf,Ppt=tq,Dpt=/[\\^$.*+?()[\]{}|]/g,Fpt=/^\[object .+?Constructor\]$/,Bpt=Function.prototype,Npt=Object.prototype,kpt=Bpt.toString,zpt=Npt.hasOwnProperty,Upt=RegExp("^"+kpt.call(zpt).replace(Dpt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function $pt(e){if(!Opt(e)||Lpt(e))return!1;var t=Ipt(e)?Upt:Fpt;return t.test(Ppt(e))}var Hpt=$pt;function Vpt(e,t){return e==null?void 0:e[t]}var Gpt=Vpt,Wpt=Hpt,Xpt=Gpt;function jpt(e,t){var r=Xpt(e,t);return Wpt(r)?r:void 0}var y_=jpt,Ypt=y_,Zpt=jd,qpt=Ypt(Zpt,"Map"),M5=qpt,Kpt=y_,Qpt=Kpt(Object,"create"),JR=Qpt,S7=JR;function Jpt(){this.__data__=S7?S7(null):{},this.size=0}var tvt=Jpt;function evt(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var rvt=evt,nvt=JR,ivt="__lodash_hash_undefined__",avt=Object.prototype,ovt=avt.hasOwnProperty;function svt(e){var t=this.__data__;if(nvt){var r=t[e];return r===ivt?void 0:r}return ovt.call(t,e)?t[e]:void 0}var lvt=svt,uvt=JR,cvt=Object.prototype,hvt=cvt.hasOwnProperty;function fvt(e){var t=this.__data__;return uvt?t[e]!==void 0:hvt.call(t,e)}var dvt=fvt,pvt=JR,vvt="__lodash_hash_undefined__";function gvt(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=pvt&&t===void 0?vvt:t,this}var mvt=gvt,yvt=tvt,_vt=rvt,xvt=lvt,bvt=dvt,Evt=mvt;function pb(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}pb.prototype.clear=yvt;pb.prototype.delete=_vt;pb.prototype.get=xvt;pb.prototype.has=bvt;pb.prototype.set=Evt;var wvt=pb,T7=wvt,Cvt=KR,Svt=M5;function Tvt(){this.size=0,this.__data__={hash:new T7,map:new(Svt||Cvt),string:new T7}}var Avt=Tvt;function Mvt(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var Rvt=Mvt,Ivt=Rvt;function Lvt(e,t){var r=e.__data__;return Ivt(t)?r[typeof t=="string"?"string":"hash"]:r.map}var tI=Lvt,Ovt=tI;function Pvt(e){var t=Ovt(this,e).delete(e);return this.size-=t?1:0,t}var Dvt=Pvt,Fvt=tI;function Bvt(e){return Fvt(this,e).get(e)}var Nvt=Bvt,kvt=tI;function zvt(e){return kvt(this,e).has(e)}var Uvt=zvt,$vt=tI;function Hvt(e,t){var r=$vt(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var Vvt=Hvt,Gvt=Avt,Wvt=Dvt,Xvt=Nvt,jvt=Uvt,Yvt=Vvt;function vb(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}vb.prototype.clear=Gvt;vb.prototype.delete=Wvt;vb.prototype.get=Xvt;vb.prototype.has=jvt;vb.prototype.set=Yvt;var R5=vb,Zvt=KR,qvt=M5,Kvt=R5,Qvt=200;function Jvt(e,t){var r=this.__data__;if(r instanceof Zvt){var n=r.__data__;if(!qvt||n.length<Qvt-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Kvt(n)}return r.set(e,t),this.size=r.size,this}var tgt=Jvt,egt=KR,rgt=spt,ngt=upt,igt=hpt,agt=dpt,ogt=tgt;function gb(e){var t=this.__data__=new egt(e);this.size=t.size}gb.prototype.clear=rgt;gb.prototype.delete=ngt;gb.prototype.get=igt;gb.prototype.has=agt;gb.prototype.set=ogt;var I5=gb;function sgt(e,t){for(var r=-1,n=e==null?0:e.length;++r<n&&t(e[r],r,e)!==!1;);return e}var lgt=sgt,ugt=y_,cgt=function(){try{var e=ugt(Object,"defineProperty");return e({},"",{}),e}catch{}}(),eq=cgt,A7=eq;function hgt(e,t,r){t=="__proto__"&&A7?A7(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var L5=hgt,fgt=L5,dgt=gS,pgt=Object.prototype,vgt=pgt.hasOwnProperty;function ggt(e,t,r){var n=e[t];(!(vgt.call(e,t)&&dgt(n,r))||r===void 0&&!(t in e))&&fgt(e,t,r)}var rq=ggt,mgt=rq,ygt=L5;function _gt(e,t,r,n){var i=!r;r||(r={});for(var a=-1,o=t.length;++a<o;){var s=t[a],l=n?n(r[s],e[s],s,r,e):void 0;l===void 0&&(l=e[s]),i?ygt(r,s,l):mgt(r,s,l)}return r}var mS=_gt;function xgt(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var bgt=xgt,Egt=dg,wgt=Kf,Cgt="[object Arguments]";function Sgt(e){return wgt(e)&&Egt(e)==Cgt}var Tgt=Sgt,M7=Tgt,Agt=Kf,nq=Object.prototype,Mgt=nq.hasOwnProperty,Rgt=nq.propertyIsEnumerable,Igt=M7(function(){return arguments}())?M7:function(e){return Agt(e)&&Mgt.call(e,"callee")&&!Rgt.call(e,"callee")},iq=Igt,Lgt=Array.isArray,pg=Lgt,oM={exports:{}};function Ogt(){return!1}var Pgt=Ogt;oM.exports;(function(e,t){var r=jd,n=Pgt,i=t&&!t.nodeType&&t,a=i&&!0&&e&&!e.nodeType&&e,o=a&&a.exports===i,s=o?r.Buffer:void 0,l=s?s.isBuffer:void 0,u=l||n;e.exports=u})(oM,oM.exports);var eI=oM.exports,Dgt=9007199254740991,Fgt=/^(?:0|[1-9]\d*)$/;function Bgt(e,t){var r=typeof e;return t=t??Dgt,!!t&&(r=="number"||r!="symbol"&&Fgt.test(e))&&e>-1&&e%1==0&&e<t}var aq=Bgt,Ngt=9007199254740991;function kgt(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Ngt}var oq=kgt,zgt=dg,Ugt=oq,$gt=Kf,Hgt="[object Arguments]",Vgt="[object Array]",Ggt="[object Boolean]",Wgt="[object Date]",Xgt="[object Error]",jgt="[object Function]",Ygt="[object Map]",Zgt="[object Number]",qgt="[object Object]",Kgt="[object RegExp]",Qgt="[object Set]",Jgt="[object String]",tmt="[object WeakMap]",emt="[object ArrayBuffer]",rmt="[object DataView]",nmt="[object Float32Array]",imt="[object Float64Array]",amt="[object Int8Array]",omt="[object Int16Array]",smt="[object Int32Array]",lmt="[object Uint8Array]",umt="[object Uint8ClampedArray]",cmt="[object Uint16Array]",hmt="[object Uint32Array]",No={};No[nmt]=No[imt]=No[amt]=No[omt]=No[smt]=No[lmt]=No[umt]=No[cmt]=No[hmt]=!0;No[Hgt]=No[Vgt]=No[emt]=No[Ggt]=No[rmt]=No[Wgt]=No[Xgt]=No[jgt]=No[Ygt]=No[Zgt]=No[qgt]=No[Kgt]=No[Qgt]=No[Jgt]=No[tmt]=!1;function fmt(e){return $gt(e)&&Ugt(e.length)&&!!No[zgt(e)]}var dmt=fmt;function pmt(e){return function(t){return e(t)}}var rI=pmt,sM={exports:{}};sM.exports;(function(e,t){var r=KZ,n=t&&!t.nodeType&&t,i=n&&!0&&e&&!e.nodeType&&e,a=i&&i.exports===n,o=a&&r.process,s=function(){try{var l=i&&i.require&&i.require("util").types;return l||o&&o.binding&&o.binding("util")}catch{}}();e.exports=s})(sM,sM.exports);var O5=sM.exports,vmt=dmt,gmt=rI,R7=O5,I7=R7&&R7.isTypedArray,mmt=I7?gmt(I7):vmt,nI=mmt;const ymt=aa(nI);var _mt=bgt,xmt=iq,bmt=pg,Emt=eI,wmt=aq,Cmt=nI,Smt=Object.prototype,Tmt=Smt.hasOwnProperty;function Amt(e,t){var r=bmt(e),n=!r&&xmt(e),i=!r&&!n&&Emt(e),a=!r&&!n&&!i&&Cmt(e),o=r||n||i||a,s=o?_mt(e.length,String):[],l=s.length;for(var u in e)(t||Tmt.call(e,u))&&!(o&&(u=="length"||i&&(u=="offset"||u=="parent")||a&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||wmt(u,l)))&&s.push(u);return s}var sq=Amt,Mmt=Object.prototype;function Rmt(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||Mmt;return e===r}var P5=Rmt;function Imt(e,t){return function(r){return e(t(r))}}var lq=Imt,Lmt=lq,Omt=Lmt(Object.keys,Object),Pmt=Omt,Dmt=P5,Fmt=Pmt,Bmt=Object.prototype,Nmt=Bmt.hasOwnProperty;function kmt(e){if(!Dmt(e))return Fmt(e);var t=[];for(var r in Object(e))Nmt.call(e,r)&&r!="constructor"&&t.push(r);return t}var zmt=kmt,Umt=QR,$mt=oq;function Hmt(e){return e!=null&&$mt(e.length)&&!Umt(e)}var iI=Hmt,Vmt=sq,Gmt=zmt,Wmt=iI;function Xmt(e){return Wmt(e)?Vmt(e):Gmt(e)}var D5=Xmt,jmt=mS,Ymt=D5;function Zmt(e,t){return e&&jmt(t,Ymt(t),e)}var qmt=Zmt;function Kmt(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var Qmt=Kmt,Jmt=qf,t0t=P5,e0t=Qmt,r0t=Object.prototype,n0t=r0t.hasOwnProperty;function i0t(e){if(!Jmt(e))return e0t(e);var t=t0t(e),r=[];for(var n in e)n=="constructor"&&(t||!n0t.call(e,n))||r.push(n);return r}var a0t=i0t,o0t=sq,s0t=a0t,l0t=iI;function u0t(e){return l0t(e)?o0t(e,!0):s0t(e)}var yS=u0t,c0t=mS,h0t=yS;function f0t(e,t){return e&&c0t(t,h0t(t),e)}var d0t=f0t,lM={exports:{}};lM.exports;(function(e,t){var r=jd,n=t&&!t.nodeType&&t,i=n&&!0&&e&&!e.nodeType&&e,a=i&&i.exports===n,o=a?r.Buffer:void 0,s=o?o.allocUnsafe:void 0;function l(u,c){if(c)return u.slice();var f=u.length,d=s?s(f):new u.constructor(f);return u.copy(d),d}e.exports=l})(lM,lM.exports);var uq=lM.exports;function p0t(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}var F5=p0t;function v0t(e,t){for(var r=-1,n=e==null?0:e.length,i=0,a=[];++r<n;){var o=e[r];t(o,r,e)&&(a[i++]=o)}return a}var g0t=v0t;function m0t(){return[]}var cq=m0t,y0t=g0t,_0t=cq,x0t=Object.prototype,b0t=x0t.propertyIsEnumerable,L7=Object.getOwnPropertySymbols,E0t=L7?function(e){return e==null?[]:(e=Object(e),y0t(L7(e),function(t){return b0t.call(e,t)}))}:_0t,B5=E0t,w0t=mS,C0t=B5;function S0t(e,t){return w0t(e,C0t(e),t)}var T0t=S0t;function A0t(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}var hq=A0t,M0t=lq,R0t=M0t(Object.getPrototypeOf,Object),N5=R0t,I0t=hq,L0t=N5,O0t=B5,P0t=cq,D0t=Object.getOwnPropertySymbols,F0t=D0t?function(e){for(var t=[];e;)I0t(t,O0t(e)),e=L0t(e);return t}:P0t,fq=F0t,B0t=mS,N0t=fq;function k0t(e,t){return B0t(e,N0t(e),t)}var z0t=k0t,U0t=hq,$0t=pg;function H0t(e,t,r){var n=t(e);return $0t(e)?n:U0t(n,r(e))}var dq=H0t,V0t=dq,G0t=B5,W0t=D5;function X0t(e){return V0t(e,W0t,G0t)}var pq=X0t,j0t=dq,Y0t=fq,Z0t=yS;function q0t(e){return j0t(e,Z0t,Y0t)}var K0t=q0t,Q0t=y_,J0t=jd,tyt=Q0t(J0t,"DataView"),eyt=tyt,ryt=y_,nyt=jd,iyt=ryt(nyt,"Promise"),ayt=iyt,oyt=y_,syt=jd,lyt=oyt(syt,"Set"),vq=lyt,uyt=y_,cyt=jd,hyt=uyt(cyt,"WeakMap"),fyt=hyt,YP=eyt,ZP=M5,qP=ayt,KP=vq,QP=fyt,gq=dg,mb=tq,O7="[object Map]",dyt="[object Object]",P7="[object Promise]",D7="[object Set]",F7="[object WeakMap]",B7="[object DataView]",pyt=mb(YP),vyt=mb(ZP),gyt=mb(qP),myt=mb(KP),yyt=mb(QP),cy=gq;(YP&&cy(new YP(new ArrayBuffer(1)))!=B7||ZP&&cy(new ZP)!=O7||qP&&cy(qP.resolve())!=P7||KP&&cy(new KP)!=D7||QP&&cy(new QP)!=F7)&&(cy=function(e){var t=gq(e),r=t==dyt?e.constructor:void 0,n=r?mb(r):"";if(n)switch(n){case pyt:return B7;case vyt:return O7;case gyt:return P7;case myt:return D7;case yyt:return F7}return t});var aI=cy,_yt=Object.prototype,xyt=_yt.hasOwnProperty;function byt(e){var t=e.length,r=new e.constructor(t);return t&&typeof e[0]=="string"&&xyt.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var Eyt=byt,wyt=jd,Cyt=wyt.Uint8Array,mq=Cyt,N7=mq;function Syt(e){var t=new e.constructor(e.byteLength);return new N7(t).set(new N7(e)),t}var k5=Syt,Tyt=k5;function Ayt(e,t){var r=t?Tyt(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var Myt=Ayt,Ryt=/\w*$/;function Iyt(e){var t=new e.constructor(e.source,Ryt.exec(e));return t.lastIndex=e.lastIndex,t}var Lyt=Iyt,k7=vS,z7=k7?k7.prototype:void 0,U7=z7?z7.valueOf:void 0;function Oyt(e){return U7?Object(U7.call(e)):{}}var Pyt=Oyt,Dyt=k5;function Fyt(e,t){var r=t?Dyt(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var yq=Fyt,Byt=k5,Nyt=Myt,kyt=Lyt,zyt=Pyt,Uyt=yq,$yt="[object Boolean]",Hyt="[object Date]",Vyt="[object Map]",Gyt="[object Number]",Wyt="[object RegExp]",Xyt="[object Set]",jyt="[object String]",Yyt="[object Symbol]",Zyt="[object ArrayBuffer]",qyt="[object DataView]",Kyt="[object Float32Array]",Qyt="[object Float64Array]",Jyt="[object Int8Array]",t_t="[object Int16Array]",e_t="[object Int32Array]",r_t="[object Uint8Array]",n_t="[object Uint8ClampedArray]",i_t="[object Uint16Array]",a_t="[object Uint32Array]";function o_t(e,t,r){var n=e.constructor;switch(t){case Zyt:return Byt(e);case $yt:case Hyt:return new n(+e);case qyt:return Nyt(e,r);case Kyt:case Qyt:case Jyt:case t_t:case e_t:case r_t:case n_t:case i_t:case a_t:return Uyt(e,r);case Vyt:return new n;case Gyt:case jyt:return new n(e);case Wyt:return kyt(e);case Xyt:return new n;case Yyt:return zyt(e)}}var s_t=o_t,l_t=qf,$7=Object.create,u_t=function(){function e(){}return function(t){if(!l_t(t))return{};if($7)return $7(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),c_t=u_t,h_t=c_t,f_t=N5,d_t=P5;function p_t(e){return typeof e.constructor=="function"&&!d_t(e)?h_t(f_t(e)):{}}var _q=p_t,v_t=aI,g_t=Kf,m_t="[object Map]";function y_t(e){return g_t(e)&&v_t(e)==m_t}var __t=y_t,x_t=__t,b_t=rI,H7=O5,V7=H7&&H7.isMap,E_t=V7?b_t(V7):x_t,w_t=E_t,C_t=aI,S_t=Kf,T_t="[object Set]";function A_t(e){return S_t(e)&&C_t(e)==T_t}var M_t=A_t,R_t=M_t,I_t=rI,G7=O5,W7=G7&&G7.isSet,L_t=W7?I_t(W7):R_t,O_t=L_t,P_t=I5,D_t=lgt,F_t=rq,B_t=qmt,N_t=d0t,k_t=uq,z_t=F5,U_t=T0t,$_t=z0t,H_t=pq,V_t=K0t,G_t=aI,W_t=Eyt,X_t=s_t,j_t=_q,Y_t=pg,Z_t=eI,q_t=w_t,K_t=qf,Q_t=O_t,J_t=D5,t1t=yS,e1t=1,r1t=2,n1t=4,xq="[object Arguments]",i1t="[object Array]",a1t="[object Boolean]",o1t="[object Date]",s1t="[object Error]",bq="[object Function]",l1t="[object GeneratorFunction]",u1t="[object Map]",c1t="[object Number]",Eq="[object Object]",h1t="[object RegExp]",f1t="[object Set]",d1t="[object String]",p1t="[object Symbol]",v1t="[object WeakMap]",g1t="[object ArrayBuffer]",m1t="[object DataView]",y1t="[object Float32Array]",_1t="[object Float64Array]",x1t="[object Int8Array]",b1t="[object Int16Array]",E1t="[object Int32Array]",w1t="[object Uint8Array]",C1t="[object Uint8ClampedArray]",S1t="[object Uint16Array]",T1t="[object Uint32Array]",wo={};wo[xq]=wo[i1t]=wo[g1t]=wo[m1t]=wo[a1t]=wo[o1t]=wo[y1t]=wo[_1t]=wo[x1t]=wo[b1t]=wo[E1t]=wo[u1t]=wo[c1t]=wo[Eq]=wo[h1t]=wo[f1t]=wo[d1t]=wo[p1t]=wo[w1t]=wo[C1t]=wo[S1t]=wo[T1t]=!0;wo[s1t]=wo[bq]=wo[v1t]=!1;function bA(e,t,r,n,i,a){var o,s=t&e1t,l=t&r1t,u=t&n1t;if(r&&(o=i?r(e,n,i,a):r(e)),o!==void 0)return o;if(!K_t(e))return e;var c=Y_t(e);if(c){if(o=W_t(e),!s)return z_t(e,o)}else{var f=G_t(e),d=f==bq||f==l1t;if(Z_t(e))return k_t(e,s);if(f==Eq||f==xq||d&&!i){if(o=l||d?{}:j_t(e),!s)return l?$_t(e,N_t(o,e)):U_t(e,B_t(o,e))}else{if(!wo[f])return i?e:{};o=X_t(e,f,s)}}a||(a=new P_t);var v=a.get(e);if(v)return v;a.set(e,o),Q_t(e)?e.forEach(function(w){o.add(bA(w,t,r,w,e,a))}):q_t(e)&&e.forEach(function(w,S){o.set(S,bA(w,t,r,S,e,a))});var g=u?l?V_t:H_t:l?t1t:J_t,x=c?void 0:g(e);return D_t(x||e,function(w,S){x&&(S=w,w=e[S]),F_t(o,S,bA(w,t,r,S,e,a))}),o}var A1t=bA,M1t=A1t,R1t=1,I1t=4;function L1t(e){return M1t(e,R1t|I1t)}var O1t=L1t;const P1t=aa(O1t);var D1t=jd,F1t=function(){return D1t.Date.now()},B1t=F1t,N1t=qf,ZL=B1t,X7=JZ,k1t="Expected a function",z1t=Math.max,U1t=Math.min;function $1t(e,t,r){var n,i,a,o,s,l,u=0,c=!1,f=!1,d=!0;if(typeof e!="function")throw new TypeError(k1t);t=X7(t)||0,N1t(r)&&(c=!!r.leading,f="maxWait"in r,a=f?z1t(X7(r.maxWait)||0,t):a,d="trailing"in r?!!r.trailing:d);function v(N){var k=n,V=i;return n=i=void 0,u=N,o=e.apply(V,k),o}function g(N){return u=N,s=setTimeout(S,t),c?v(N):o}function x(N){var k=N-l,V=N-u,Q=t-k;return f?U1t(Q,a-V):Q}function w(N){var k=N-l,V=N-u;return l===void 0||k>=t||k<0||f&&V>=a}function S(){var N=ZL();if(w(N))return A(N);s=setTimeout(S,x(N))}function A(N){return s=void 0,d&&n?v(N):(n=i=void 0,o)}function M(){s!==void 0&&clearTimeout(s),u=0,n=l=i=s=void 0}function R(){return s===void 0?o:A(ZL())}function O(){var N=ZL(),k=w(N);if(n=arguments,i=this,l=N,k){if(s===void 0)return g(l);if(f)return clearTimeout(s),s=setTimeout(S,t),v(l)}return s===void 0&&(s=setTimeout(S,t)),o}return O.cancel=M,O.flush=R,O}var wq=$1t;const H1t=aa(wq);var V1t=pg,G1t=ZR,W1t=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,X1t=/^\w*$/;function j1t(e,t){if(V1t(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||G1t(e)?!0:X1t.test(e)||!W1t.test(e)||t!=null&&e in Object(t)}var Y1t=j1t,Cq=R5,Z1t="Expected a function";function z5(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(Z1t);var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],a=r.cache;if(a.has(i))return a.get(i);var o=e.apply(this,n);return r.cache=a.set(i,o)||a,o};return r.cache=new(z5.Cache||Cq),r}z5.Cache=Cq;var q1t=z5,K1t=q1t,Q1t=500;function J1t(e){var t=K1t(e,function(n){return r.size===Q1t&&r.clear(),n}),r=t.cache;return t}var txt=J1t,ext=txt,rxt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,nxt=/\\(\\)?/g,ixt=ext(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(rxt,function(r,n,i,a){t.push(i?a.replace(nxt,"$1"):n||r)}),t}),axt=ixt;function oxt(e,t){for(var r=-1,n=e==null?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}var Sq=oxt,j7=vS,sxt=Sq,lxt=pg,uxt=ZR,cxt=1/0,Y7=j7?j7.prototype:void 0,Z7=Y7?Y7.toString:void 0;function Tq(e){if(typeof e=="string")return e;if(lxt(e))return sxt(e,Tq)+"";if(uxt(e))return Z7?Z7.call(e):"";var t=e+"";return t=="0"&&1/e==-cxt?"-0":t}var hxt=Tq,fxt=hxt;function dxt(e){return e==null?"":fxt(e)}var yb=dxt,pxt=pg,vxt=Y1t,gxt=axt,mxt=yb;function yxt(e,t){return pxt(e)?e:vxt(e,t)?[e]:gxt(mxt(e))}var _xt=yxt,xxt=ZR,bxt=1/0;function Ext(e){if(typeof e=="string"||xxt(e))return e;var t=e+"";return t=="0"&&1/e==-bxt?"-0":t}var wxt=Ext,Cxt=_xt,Sxt=wxt;function Txt(e,t){t=Cxt(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[Sxt(t[r++])];return r&&r==n?e:void 0}var Axt=Txt,Mxt=Axt;function Rxt(e,t,r){var n=e==null?void 0:Mxt(e,t);return n===void 0?r:n}var Ixt=Rxt;const Lxt=aa(Ixt);var Oxt=dg,Pxt=Kf,Dxt="[object Boolean]";function Fxt(e){return e===!0||e===!1||Pxt(e)&&Oxt(e)==Dxt}var Bxt=Fxt;const Nxt=aa(Bxt);var kxt="__lodash_hash_undefined__";function zxt(e){return this.__data__.set(e,kxt),this}var Uxt=zxt;function $xt(e){return this.__data__.has(e)}var Hxt=$xt,Vxt=R5,Gxt=Uxt,Wxt=Hxt;function uM(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new Vxt;++t<r;)this.add(e[t])}uM.prototype.add=uM.prototype.push=Gxt;uM.prototype.has=Wxt;var Aq=uM;function Xxt(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var jxt=Xxt;function Yxt(e,t){return e.has(t)}var Mq=Yxt,Zxt=Aq,qxt=jxt,Kxt=Mq,Qxt=1,Jxt=2;function tbt(e,t,r,n,i,a){var o=r&Qxt,s=e.length,l=t.length;if(s!=l&&!(o&&l>s))return!1;var u=a.get(e),c=a.get(t);if(u&&c)return u==t&&c==e;var f=-1,d=!0,v=r&Jxt?new Zxt:void 0;for(a.set(e,t),a.set(t,e);++f<s;){var g=e[f],x=t[f];if(n)var w=o?n(x,g,f,t,e,a):n(g,x,f,e,t,a);if(w!==void 0){if(w)continue;d=!1;break}if(v){if(!qxt(t,function(S,A){if(!Kxt(v,A)&&(g===S||i(g,S,r,n,a)))return v.push(A)})){d=!1;break}}else if(!(g===x||i(g,x,r,n,a))){d=!1;break}}return a.delete(e),a.delete(t),d}var Rq=tbt;function ebt(e){var t=-1,r=Array(e.size);return e.forEach(function(n,i){r[++t]=[i,n]}),r}var rbt=ebt;function nbt(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var U5=nbt,q7=vS,K7=mq,ibt=gS,abt=Rq,obt=rbt,sbt=U5,lbt=1,ubt=2,cbt="[object Boolean]",hbt="[object Date]",fbt="[object Error]",dbt="[object Map]",pbt="[object Number]",vbt="[object RegExp]",gbt="[object Set]",mbt="[object String]",ybt="[object Symbol]",_bt="[object ArrayBuffer]",xbt="[object DataView]",Q7=q7?q7.prototype:void 0,qL=Q7?Q7.valueOf:void 0;function bbt(e,t,r,n,i,a,o){switch(r){case xbt:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case _bt:return!(e.byteLength!=t.byteLength||!a(new K7(e),new K7(t)));case cbt:case hbt:case pbt:return ibt(+e,+t);case fbt:return e.name==t.name&&e.message==t.message;case vbt:case mbt:return e==t+"";case dbt:var s=obt;case gbt:var l=n&lbt;if(s||(s=sbt),e.size!=t.size&&!l)return!1;var u=o.get(e);if(u)return u==t;n|=ubt,o.set(e,t);var c=abt(s(e),s(t),n,i,a,o);return o.delete(e),c;case ybt:if(qL)return qL.call(e)==qL.call(t)}return!1}var Ebt=bbt,J7=pq,wbt=1,Cbt=Object.prototype,Sbt=Cbt.hasOwnProperty;function Tbt(e,t,r,n,i,a){var o=r&wbt,s=J7(e),l=s.length,u=J7(t),c=u.length;if(l!=c&&!o)return!1;for(var f=l;f--;){var d=s[f];if(!(o?d in t:Sbt.call(t,d)))return!1}var v=a.get(e),g=a.get(t);if(v&&g)return v==t&&g==e;var x=!0;a.set(e,t),a.set(t,e);for(var w=o;++f<l;){d=s[f];var S=e[d],A=t[d];if(n)var M=o?n(A,S,d,t,e,a):n(S,A,d,e,t,a);if(!(M===void 0?S===A||i(S,A,r,n,a):M)){x=!1;break}w||(w=d=="constructor")}if(x&&!w){var R=e.constructor,O=t.constructor;R!=O&&"constructor"in e&&"constructor"in t&&!(typeof R=="function"&&R instanceof R&&typeof O=="function"&&O instanceof O)&&(x=!1)}return a.delete(e),a.delete(t),x}var Abt=Tbt,KL=I5,Mbt=Rq,Rbt=Ebt,Ibt=Abt,tz=aI,ez=pg,rz=eI,Lbt=nI,Obt=1,nz="[object Arguments]",iz="[object Array]",X2="[object Object]",Pbt=Object.prototype,az=Pbt.hasOwnProperty;function Dbt(e,t,r,n,i,a){var o=ez(e),s=ez(t),l=o?iz:tz(e),u=s?iz:tz(t);l=l==nz?X2:l,u=u==nz?X2:u;var c=l==X2,f=u==X2,d=l==u;if(d&&rz(e)){if(!rz(t))return!1;o=!0,c=!1}if(d&&!c)return a||(a=new KL),o||Lbt(e)?Mbt(e,t,r,n,i,a):Rbt(e,t,l,r,n,i,a);if(!(r&Obt)){var v=c&&az.call(e,"__wrapped__"),g=f&&az.call(t,"__wrapped__");if(v||g){var x=v?e.value():e,w=g?t.value():t;return a||(a=new KL),i(x,w,r,n,a)}}return d?(a||(a=new KL),Ibt(e,t,r,n,i,a)):!1}var Fbt=Dbt,Bbt=Fbt,oz=Kf;function Iq(e,t,r,n,i){return e===t?!0:e==null||t==null||!oz(e)&&!oz(t)?e!==e&&t!==t:Bbt(e,t,r,n,Iq,i)}var Nbt=Iq,kbt=Nbt;function zbt(e,t){return kbt(e,t)}var Ubt=zbt;const $bt=aa(Ubt);function Hbt(e){return e==null}var Vbt=Hbt;const Gbt=aa(Vbt);var Wbt=dg,Xbt=Kf,jbt="[object Number]";function Ybt(e){return typeof e=="number"||Xbt(e)&&Wbt(e)==jbt}var Zbt=Ybt;const qbt=aa(Zbt);var Kbt=dg,Qbt=N5,Jbt=Kf,tEt="[object Object]",eEt=Function.prototype,rEt=Object.prototype,Lq=eEt.toString,nEt=rEt.hasOwnProperty,iEt=Lq.call(Object);function aEt(e){if(!Jbt(e)||Kbt(e)!=tEt)return!1;var t=Qbt(e);if(t===null)return!0;var r=nEt.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&Lq.call(r)==iEt}var Oq=aEt;const oEt=aa(Oq);var sEt=dg,lEt=pg,uEt=Kf,cEt="[object String]";function hEt(e){return typeof e=="string"||!lEt(e)&&uEt(e)&&sEt(e)==cEt}var fEt=hEt;const dEt=aa(fEt);var pEt=L5,vEt=gS;function gEt(e,t,r){(r!==void 0&&!vEt(e[t],r)||r===void 0&&!(t in e))&&pEt(e,t,r)}var Pq=gEt;function mEt(e){return function(t,r,n){for(var i=-1,a=Object(t),o=n(t),s=o.length;s--;){var l=o[e?s:++i];if(r(a[l],l,a)===!1)break}return t}}var yEt=mEt,_Et=yEt,xEt=_Et(),bEt=xEt,EEt=iI,wEt=Kf;function CEt(e){return wEt(e)&&EEt(e)}var SEt=CEt;function TEt(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var Dq=TEt,AEt=mS,MEt=yS;function REt(e){return AEt(e,MEt(e))}var IEt=REt,sz=Pq,LEt=uq,OEt=yq,PEt=F5,DEt=_q,lz=iq,uz=pg,FEt=SEt,BEt=eI,NEt=QR,kEt=qf,zEt=Oq,UEt=nI,cz=Dq,$Et=IEt;function HEt(e,t,r,n,i,a,o){var s=cz(e,r),l=cz(t,r),u=o.get(l);if(u){sz(e,r,u);return}var c=a?a(s,l,r+"",e,t,o):void 0,f=c===void 0;if(f){var d=uz(l),v=!d&&BEt(l),g=!d&&!v&&UEt(l);c=l,d||v||g?uz(s)?c=s:FEt(s)?c=PEt(s):v?(f=!1,c=LEt(l,!0)):g?(f=!1,c=OEt(l,!0)):c=[]:zEt(l)||lz(l)?(c=s,lz(s)?c=$Et(s):(!kEt(s)||NEt(s))&&(c=DEt(l))):f=!1}f&&(o.set(l,c),i(c,l,n,a,o),o.delete(l)),sz(e,r,c)}var VEt=HEt,GEt=I5,WEt=Pq,XEt=bEt,jEt=VEt,YEt=qf,ZEt=yS,qEt=Dq;function Fq(e,t,r,n,i){e!==t&&XEt(t,function(a,o){if(i||(i=new GEt),YEt(a))jEt(e,t,o,r,Fq,n,i);else{var s=n?n(qEt(e,o),a,o+"",e,t,i):void 0;s===void 0&&(s=a),WEt(e,o,s)}},ZEt)}var Bq=Fq;function KEt(e){return e}var Nq=KEt;function QEt(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var JEt=QEt,twt=JEt,hz=Math.max;function ewt(e,t,r){return t=hz(t===void 0?e.length-1:t,0),function(){for(var n=arguments,i=-1,a=hz(n.length-t,0),o=Array(a);++i<a;)o[i]=n[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=n[i];return s[t]=r(o),twt(e,this,s)}}var rwt=ewt;function nwt(e){return function(){return e}}var iwt=nwt,awt=iwt,fz=eq,owt=Nq,swt=fz?function(e,t){return fz(e,"toString",{configurable:!0,enumerable:!1,value:awt(t),writable:!0})}:owt,lwt=swt,uwt=800,cwt=16,hwt=Date.now;function fwt(e){var t=0,r=0;return function(){var n=hwt(),i=cwt-(n-r);if(r=n,i>0){if(++t>=uwt)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var dwt=fwt,pwt=lwt,vwt=dwt,gwt=vwt(pwt),mwt=gwt,ywt=Nq,_wt=rwt,xwt=mwt;function bwt(e,t){return xwt(_wt(e,t,ywt),e+"")}var kq=bwt,Ewt=gS,wwt=iI,Cwt=aq,Swt=qf;function Twt(e,t,r){if(!Swt(r))return!1;var n=typeof t;return(n=="number"?wwt(r)&&Cwt(t,r.length):n=="string"&&t in r)?Ewt(r[t],e):!1}var Awt=Twt,Mwt=kq,Rwt=Awt;function Iwt(e){return Mwt(function(t,r){var n=-1,i=r.length,a=i>1?r[i-1]:void 0,o=i>2?r[2]:void 0;for(a=e.length>3&&typeof a=="function"?(i--,a):void 0,o&&Rwt(r[0],r[1],o)&&(a=i<3?void 0:a,i=1),t=Object(t);++n<i;){var s=r[n];s&&e(t,s,n,a)}return t})}var zq=Iwt,Lwt=Bq,Owt=zq,Pwt=Owt(function(e,t,r){Lwt(e,t,r)}),Dwt=Pwt;const Fwt=aa(Dwt);var Bwt=Bq,Nwt=zq,kwt=Nwt(function(e,t,r,n){Bwt(e,t,r,n)}),zwt=kwt;const Uwt=aa(zwt);function $wt(e,t,r,n){for(var i=e.length,a=r+(n?1:-1);n?a--:++a<i;)if(t(e[a],a,e))return a;return-1}var Hwt=$wt;function Vwt(e){return e!==e}var Gwt=Vwt;function Wwt(e,t,r){for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1}var Xwt=Wwt,jwt=Hwt,Ywt=Gwt,Zwt=Xwt;function qwt(e,t,r){return t===t?Zwt(e,t,r):jwt(e,Ywt,r)}var Uq=qwt;function Kwt(e,t,r,n){for(var i=r-1,a=e.length;++i<a;)if(n(e[i],t))return i;return-1}var Qwt=Kwt,Jwt=Sq,tCt=Uq,eCt=Qwt,rCt=rI,nCt=F5,iCt=Array.prototype,dz=iCt.splice;function aCt(e,t,r,n){var i=n?eCt:tCt,a=-1,o=t.length,s=e;for(e===t&&(t=nCt(t)),r&&(s=Jwt(e,rCt(r)));++a<o;)for(var l=0,u=t[a],c=r?r(u):u;(l=i(s,c,l,n))>-1;)s!==e&&dz.call(s,l,1),dz.call(e,l,1);return e}var oCt=aCt,sCt=oCt;function lCt(e,t){return e&&e.length&&t&&t.length?sCt(e,t):e}var uCt=lCt,cCt=kq,hCt=uCt,fCt=cCt(hCt),dCt=fCt;const pCt=aa(dCt);var vCt=wq,gCt=qf,mCt="Expected a function";function yCt(e,t,r){var n=!0,i=!0;if(typeof e!="function")throw new TypeError(mCt);return gCt(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),vCt(e,t,{leading:n,maxWait:t,trailing:i})}var _Ct=yCt;const xCt=aa(_Ct);var bCt=Uq;function ECt(e,t){var r=e==null?0:e.length;return!!r&&bCt(e,t,0)>-1}var wCt=ECt;function CCt(e,t,r){for(var n=-1,i=e==null?0:e.length;++n<i;)if(r(t,e[n]))return!0;return!1}var SCt=CCt;function TCt(){}var ACt=TCt,QL=vq,MCt=ACt,RCt=U5,ICt=1/0,LCt=QL&&1/RCt(new QL([,-0]))[1]==ICt?function(e){return new QL(e)}:MCt,OCt=LCt,PCt=Aq,DCt=wCt,FCt=SCt,BCt=Mq,NCt=OCt,kCt=U5,zCt=200;function UCt(e,t,r){var n=-1,i=DCt,a=e.length,o=!0,s=[],l=s;if(r)o=!1,i=FCt;else if(a>=zCt){var u=t?null:NCt(e);if(u)return kCt(u);o=!1,i=BCt,l=new PCt}else l=t?[]:s;t:for(;++n<a;){var c=e[n],f=t?t(c):c;if(c=r||c!==0?c:0,o&&f===f){for(var d=l.length;d--;)if(l[d]===f)continue t;t&&l.push(f),s.push(c)}else i(l,f,r)||(l!==s&&l.push(f),s.push(c))}return s}var $Ct=UCt,HCt=$Ct;function VCt(e){return e&&e.length?HCt(e):[]}var GCt=VCt;const WCt=aa(GCt);function XCt(e,t,r){var n=-1,i=e.length;t<0&&(t=-t>i?0:i+t),r=r>i?i:r,r<0&&(r+=i),i=t>r?0:r-t>>>0,t>>>=0;for(var a=Array(i);++n<i;)a[n]=e[n+t];return a}var jCt=XCt,YCt=jCt;function ZCt(e,t,r){var n=e.length;return r=r===void 0?n:r,!t&&r>=n?e:YCt(e,t,r)}var qCt=ZCt,KCt="\\ud800-\\udfff",QCt="\\u0300-\\u036f",JCt="\\ufe20-\\ufe2f",tSt="\\u20d0-\\u20ff",eSt=QCt+JCt+tSt,rSt="\\ufe0e\\ufe0f",nSt="\\u200d",iSt=RegExp("["+nSt+KCt+eSt+rSt+"]");function aSt(e){return iSt.test(e)}var $q=aSt;function oSt(e){return e.split("")}var sSt=oSt,Hq="\\ud800-\\udfff",lSt="\\u0300-\\u036f",uSt="\\ufe20-\\ufe2f",cSt="\\u20d0-\\u20ff",hSt=lSt+uSt+cSt,fSt="\\ufe0e\\ufe0f",dSt="["+Hq+"]",JP="["+hSt+"]",tD="\\ud83c[\\udffb-\\udfff]",pSt="(?:"+JP+"|"+tD+")",Vq="[^"+Hq+"]",Gq="(?:\\ud83c[\\udde6-\\uddff]){2}",Wq="[\\ud800-\\udbff][\\udc00-\\udfff]",vSt="\\u200d",Xq=pSt+"?",jq="["+fSt+"]?",gSt="(?:"+vSt+"(?:"+[Vq,Gq,Wq].join("|")+")"+jq+Xq+")*",mSt=jq+Xq+gSt,ySt="(?:"+[Vq+JP+"?",JP,Gq,Wq,dSt].join("|")+")",_St=RegExp(tD+"(?="+tD+")|"+ySt+mSt,"g");function xSt(e){return e.match(_St)||[]}var bSt=xSt,ESt=sSt,wSt=$q,CSt=bSt;function SSt(e){return wSt(e)?CSt(e):ESt(e)}var TSt=SSt,ASt=qCt,MSt=$q,RSt=TSt,ISt=yb;function LSt(e){return function(t){t=ISt(t);var r=MSt(t)?RSt(t):void 0,n=r?r[0]:t.charAt(0),i=r?ASt(r,1).join(""):t.slice(1);return n[e]()+i}}var OSt=LSt,PSt=OSt,DSt=PSt("toUpperCase"),Yq=DSt;const FSt=aa(Yq);function BSt(e){return e===void 0}var NSt=BSt;const kSt=aa(NSt);var zSt=yb,USt=Yq;function $St(e){return USt(zSt(e).toLowerCase())}var HSt=$St;function VSt(e,t,r,n){var i=-1,a=e==null?0:e.length;for(n&&a&&(r=e[++i]);++i<a;)r=t(r,e[i],i,e);return r}var GSt=VSt;function WSt(e){return function(t){return e==null?void 0:e[t]}}var XSt=WSt,jSt=XSt,YSt={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},ZSt=jSt(YSt),qSt=ZSt,KSt=qSt,QSt=yb,JSt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,t2t="\\u0300-\\u036f",e2t="\\ufe20-\\ufe2f",r2t="\\u20d0-\\u20ff",n2t=t2t+e2t+r2t,i2t="["+n2t+"]",a2t=RegExp(i2t,"g");function o2t(e){return e=QSt(e),e&&e.replace(JSt,KSt).replace(a2t,"")}var s2t=o2t,l2t=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function u2t(e){return e.match(l2t)||[]}var c2t=u2t,h2t=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function f2t(e){return h2t.test(e)}var d2t=f2t,Zq="\\ud800-\\udfff",p2t="\\u0300-\\u036f",v2t="\\ufe20-\\ufe2f",g2t="\\u20d0-\\u20ff",m2t=p2t+v2t+g2t,qq="\\u2700-\\u27bf",Kq="a-z\\xdf-\\xf6\\xf8-\\xff",y2t="\\xac\\xb1\\xd7\\xf7",_2t="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",x2t="\\u2000-\\u206f",b2t=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Qq="A-Z\\xc0-\\xd6\\xd8-\\xde",E2t="\\ufe0e\\ufe0f",Jq=y2t+_2t+x2t+b2t,tK="['’]",pz="["+Jq+"]",w2t="["+m2t+"]",eK="\\d+",C2t="["+qq+"]",rK="["+Kq+"]",nK="[^"+Zq+Jq+eK+qq+Kq+Qq+"]",S2t="\\ud83c[\\udffb-\\udfff]",T2t="(?:"+w2t+"|"+S2t+")",A2t="[^"+Zq+"]",iK="(?:\\ud83c[\\udde6-\\uddff]){2}",aK="[\\ud800-\\udbff][\\udc00-\\udfff]",N1="["+Qq+"]",M2t="\\u200d",vz="(?:"+rK+"|"+nK+")",R2t="(?:"+N1+"|"+nK+")",gz="(?:"+tK+"(?:d|ll|m|re|s|t|ve))?",mz="(?:"+tK+"(?:D|LL|M|RE|S|T|VE))?",oK=T2t+"?",sK="["+E2t+"]?",I2t="(?:"+M2t+"(?:"+[A2t,iK,aK].join("|")+")"+sK+oK+")*",L2t="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",O2t="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",P2t=sK+oK+I2t,D2t="(?:"+[C2t,iK,aK].join("|")+")"+P2t,F2t=RegExp([N1+"?"+rK+"+"+gz+"(?="+[pz,N1,"$"].join("|")+")",R2t+"+"+mz+"(?="+[pz,N1+vz,"$"].join("|")+")",N1+"?"+vz+"+"+gz,N1+"+"+mz,O2t,L2t,eK,D2t].join("|"),"g");function B2t(e){return e.match(F2t)||[]}var N2t=B2t,k2t=c2t,z2t=d2t,U2t=yb,$2t=N2t;function H2t(e,t,r){return e=U2t(e),t=r?void 0:t,t===void 0?z2t(e)?$2t(e):k2t(e):e.match(t)||[]}var V2t=H2t,G2t=GSt,W2t=s2t,X2t=V2t,j2t="['’]",Y2t=RegExp(j2t,"g");function Z2t(e){return function(t){return G2t(X2t(W2t(t).replace(Y2t,"")),e,"")}}var q2t=Z2t,K2t=HSt,Q2t=q2t,J2t=Q2t(function(e,t,r){return t=t.toLowerCase(),e+(r?K2t(t):t)}),tTt=J2t;const eTt=aa(tTt);var rTt=yb,nTt=0;function iTt(e){var t=++nTt;return rTt(e)+t}var aTt=iTt;const oTt=aa(aTt);var is={isNil:Gbt,merge:Fwt,throttle:xCt,isString:dEt,debounce:H1t,pull:pCt,isTypedArray:ymt,isPlainObject:oEt,isNumber:qbt,isBoolean:Nxt,isEqual:$bt,cloneDeep:P1t,uniq:WCt,clamp:Ddt,upperFirst:FSt,get:Lxt,mergeWith:Uwt,isFunction:bpt,isObject:Jft,isUndefined:kSt,camelCase:eTt,uniqueId:oTt};function sTt(e){let t=e;return typeof e=="string"&&(t=window.document.getElementById(e)),t}function lK(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function uK(e){return lK(e).split(/\s+/)}function lTt(e){var t;const r=(t=document==null?void 0:document.documentElement)==null?void 0:t.style;if(!r)return e[0];for(const n in e)if(e[n]&&e[n]in r)return e[n];return e[0]}function uo(e,t,r){const n=window.document.createElement(e);return t&&(n.className=t||""),r&&r.appendChild(n),n}function Td(e){const t=e.parentNode;t&&t.removeChild(e)}function Pm(e,t){if(e.classList!==void 0){const r=uK(t);for(let n=0,i=r.length;n<i;n++)e.classList.add(r[n])}else if(!uTt(e,t)){const r=$5(e);cK(e,(r?r+" ":"")+t)}}function cM(e,t){e.classList!==void 0?uK(t).forEach(n=>{e.classList.remove(n)}):cK(e,lK((" "+$5(e)+" ").replace(" "+t+" "," ")))}function uTt(e,t){if(e.classList!==void 0)return e.classList.contains(t);const r=$5(e);return r.length>0&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(r)}function cK(e,t){e instanceof HTMLElement?e.className=t:e.className.baseVal=t}function $5(e){return e instanceof SVGElement&&(e=e.correspondingElement),e.className.baseVal===void 0?e.className:e.className.baseVal}var cTt=lTt(["transform","WebkitTransform"]);function hK(e,t){e.style[cTt]=t}function hTt(){var e;const t=window.document.querySelector('meta[name="viewport"]');if(!t)return 1;const n=((e=t.content)==null?void 0:e.split(",")).find(i=>{const[a]=i.split("=");return a==="initial-scale"});return n?n.split("=")[1]*1:1}var Fc=hTt()<1?1:window.devicePixelRatio;function H5(e,t){e.setAttribute("style",`${e.style.cssText}${t}`)}function fTt(e){return Object.entries(e).map(([t,r])=>`${t}: ${r}`).join(";")}function dTt(e,t){return{left:e.left-t.left,top:e.top-t.top,right:t.left+t.width-e.left-e.width,bottom:t.top+t.height-e.top-e.height}}function _S(e){e.innerHTML=""}function pTt(e){e.setAttribute("draggable","false")}function gy(e,t){if(typeof t=="string"){const r=document.createElement("div");for(r.innerHTML=t;r.firstChild;)e.append(r.firstChild)}else Array.isArray(t)?e.append(...t):e.append(t)}function vTt(e,t){var r;const n=Array.isArray(t)?t:[t];let i=e;for(;i instanceof Element&&i!==window.document.body;){if(n.find(a=>i==null?void 0:i.matches(a)))return i;i=(r=i==null?void 0:i.parentElement)!=null?r:null}}function gTt(e){return typeof ImageBitmap<"u"&&e instanceof ImageBitmap}var hM=navigator==null?void 0:navigator.userAgent;hM.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);hM.indexOf("Android")>-1||hM.indexOf("Adr")>-1;function mTt(){const e=hM,t=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"];let r=!0;for(const n of t)if(e.indexOf(n)>0){r=!1;break}return r}function yTt(e,t){e.forEach(r=>{t[r]&&(t[r]=t[r].bind(t))})}function eD(e){var t=[1/0,1/0,-1/0,-1/0];return HZ(e,function(r){t[0]>r[0]&&(t[0]=r[0]),t[1]>r[1]&&(t[1]=r[1]),t[2]<r[0]&&(t[2]=r[0]),t[3]<r[1]&&(t[3]=r[1])}),t}eD.default=eD;function JL(e){return typeof e=="number"}function rl(e){return e-Math.fround(e)}var yz=2*Math.PI*6378137/2;function _Tt(e,t){const[r,n,i,a]=t;return e.lng>r&&e.lng<=i&&e.lat>n&&e.lat<=a}function xTt(e){const t=[1/0,1/0,-1/0,-1/0];return e.forEach(r=>{const{coordinates:n}=r;fK(t,n)}),t}function fK(e,t){return Array.isArray(t[0])?t.forEach(r=>{fK(e,r)}):(e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])),e}function EA(e,t=!0,r={enable:!0,decimal:1}){e=wTt(e,t);const n=e[0],i=e[1];let a=n*yz/180,o=Math.log(Math.tan((90+i)*Math.PI/360))/(Math.PI/180);return o=o*yz/180,r.enable&&(a=Number(a.toFixed(r.decimal)),o=Number(o.toFixed(r.decimal))),e.length===3?[a,o,e[2]]:[a,o]}function bTt(e){if(e==null)throw new Error("lng is required");return(e>180||e<-180)&&(e=e%360,e>180&&(e=-360+e),e<-180&&(e=360+e),e===0&&(e=0)),e}function ETt(e){if(e==null)throw new Error("lat is required");return(e>90||e<-90)&&(e=e%180,e>90&&(e=-180+e),e<-90&&(e=180+e),e===0&&(e=0)),e}function wTt(e,t){if(t===!1)return e;const r=bTt(e[0]);let n=ETt(e[1]);return n>85&&(n=85),n<-85&&(n=-85),e.length===3?[r,n,e[2]]:[r,n]}function If(e){const t=85.0511287798,r=Math.max(Math.min(t,e[1]),-t),n=256<<20;let i=Math.PI/180,a=e[0]*i,o=r*i;o=Math.log(Math.tan(Math.PI/4+o/2));const s=.5/Math.PI,l=.5,u=-.5/Math.PI;return i=.5,a=n*(s*a+l),o=n*(u*o+i),[Math.floor(a),Math.floor(o)]}function tO(e,t){const r=85.0511287798,n=Math.PI/180,i=6378137;return t=Math.max(Math.min(r,t),-r),e*=n,t*=n,t=Math.log(Math.tan(Math.PI/4+t/2)),[e*i,t*i]}function CTt(e,t,r){const n=G2(t[1]-e[1]),i=G2(t[0]-e[0]),a=G2(e[1]),o=G2(t[1]),s=Math.pow(Math.sin(n/2),2)+Math.pow(Math.sin(i/2),2)*Math.cos(a)*Math.cos(o);return mft(2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s)),"meters")}function V5(e,t){const r=Math.abs(e[1][1]-e[0][1])*t,n=Math.abs(e[1][0]-e[0][0])*t;return[[e[0][0]-n,e[0][1]-r],[e[1][0]+n,e[1][1]+r]]}function dK(e,t){return e[0][0]<=t[0][0]&&e[0][1]<=t[0][1]&&e[1][0]>=t[1][0]&&e[1][1]>=t[1][1]}function fM(e){return[[e[0],e[1]],[e[2],e[3]]]}function STt(e){const t=TTt(e,[0,0]);return[e[0]/t,e[1]/t]}function TTt(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2))}function Xy(e){if(JL(e[0]))return e;if(JL(e[0][0]))throw new Error("当前数据不支持标注");if(JL(e[0][0][0])){const t=e;let r=0,n=0,i=0;return t.forEach(a=>{a.forEach(o=>{r+=o[0],n+=o[1],i++})}),[r/i,n/i,0]}else throw new Error("当前数据不支持标注")}function ATt(e){let t=e[0],r=e[1],n=e[0],i=e[1],a=0,o=0,s=0;for(let l=0;l<e.length;l+=2){const u=e[l],c=e[l+1];u&&c&&(t=Math.max(u,t),r=Math.max(c,r),n=Math.min(u,n),i=Math.min(c,i),a+=u,o+=c,s++)}return{center:[a/s,o/s],radius:Math.sqrt(Math.pow(t-n,2)+Math.pow(r-i,2))/2}}function MTt(e){return eD(vft([pft(e)]))}function RTt(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}var ITt=class{constructor(e=50,t){this.limit=e,this.destroy=t||this.defaultDestroy,this.order=[],this.clear()}clear(){this.order.forEach(e=>{this.delete(e)}),this.cache={},this.order=[]}get(e){const t=this.cache[e];return t&&(this.deleteOrder(e),this.appendOrder(e)),t}set(e,t){this.cache[e]?(this.delete(e),this.cache[e]=t,this.appendOrder(e)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[e]=t,this.appendOrder(e))}delete(e){const t=this.cache[e];t&&(this.deleteCache(e),this.deleteOrder(e),this.destroy(t,e))}deleteCache(e){delete this.cache[e]}deleteOrder(e){const t=this.order.findIndex(r=>r===e);t>=0&&this.order.splice(t,1)}appendOrder(e){this.order.push(e)}defaultDestroy(e,t){return null}};function LTt(e){if(e.length===0)throw new Error("max requires at least one data point");let t=e[0];for(let r=1;r<e.length;r++)e[r]>t&&(t=e[r]);return t*1}function OTt(e){if(e.length===0)throw new Error("min requires at least one data point");let t=e[0];for(let r=1;r<e.length;r++)e[r]<t&&(t=e[r]);return t*1}function pK(e){if(e.length===0)return 0;let t=e[0]*1;for(let r=1;r<e.length;r++)t+=e[r]*1;return t}function PTt(e){if(e.length===0)throw new Error("mean requires at least one data point");return pK(e)/e.length}function DTt(e){if(e.length===0)throw new Error("mean requires at least one data point");if(e.length<3)return e[0];e.sort();let t=e[0],r=NaN,n=0,i=1;for(let a=1;a<e.length+1;a++)e[a]!==t?(i>n&&(n=i,r=t),i=1,t=e[a]):i++;return r*1}var vK={min:OTt,max:LTt,mean:PTt,sum:pK,mode:DTt};function gK(e,t){return e.map(r=>r[t])}function FTt(e,t){t===void 0&&(t={});var r=Number(e[0]),n=Number(e[1]),i=Number(e[2]),a=Number(e[3]);if(e.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var o=[r,n],s=[r,a],l=[i,a],u=[i,n];return _5([[o,u,l,s,o]],t.properties,{bbox:e,id:t.id})}var mK={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function i(l,u,c){this.fn=l,this.context=u,this.once=c||!1}function a(l,u,c,f,d){if(typeof c!="function")throw new TypeError("The listener must be a function");var v=new i(c,f||l,d),g=r?r+u:u;return l._events[g]?l._events[g].fn?l._events[g]=[l._events[g],v]:l._events[g].push(v):(l._events[g]=v,l._eventsCount++),l}function o(l,u){--l._eventsCount===0?l._events=new n:delete l._events[u]}function s(){this._events=new n,this._eventsCount=0}s.prototype.eventNames=function(){var u=[],c,f;if(this._eventsCount===0)return u;for(f in c=this._events)t.call(c,f)&&u.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(c)):u},s.prototype.listeners=function(u){var c=r?r+u:u,f=this._events[c];if(!f)return[];if(f.fn)return[f.fn];for(var d=0,v=f.length,g=new Array(v);d<v;d++)g[d]=f[d].fn;return g},s.prototype.listenerCount=function(u){var c=r?r+u:u,f=this._events[c];return f?f.fn?1:f.length:0},s.prototype.emit=function(u,c,f,d,v,g){var x=r?r+u:u;if(!this._events[x])return!1;var w=this._events[x],S=arguments.length,A,M;if(w.fn){switch(w.once&&this.removeListener(u,w.fn,void 0,!0),S){case 1:return w.fn.call(w.context),!0;case 2:return w.fn.call(w.context,c),!0;case 3:return w.fn.call(w.context,c,f),!0;case 4:return w.fn.call(w.context,c,f,d),!0;case 5:return w.fn.call(w.context,c,f,d,v),!0;case 6:return w.fn.call(w.context,c,f,d,v,g),!0}for(M=1,A=new Array(S-1);M<S;M++)A[M-1]=arguments[M];w.fn.apply(w.context,A)}else{var R=w.length,O;for(M=0;M<R;M++)switch(w[M].once&&this.removeListener(u,w[M].fn,void 0,!0),S){case 1:w[M].fn.call(w[M].context);break;case 2:w[M].fn.call(w[M].context,c);break;case 3:w[M].fn.call(w[M].context,c,f);break;case 4:w[M].fn.call(w[M].context,c,f,d);break;default:if(!A)for(O=1,A=new Array(S-1);O<S;O++)A[O-1]=arguments[O];w[M].fn.apply(w[M].context,A)}}return!0},s.prototype.on=function(u,c,f){return a(this,u,c,f,!1)},s.prototype.once=function(u,c,f){return a(this,u,c,f,!0)},s.prototype.removeListener=function(u,c,f,d){var v=r?r+u:u;if(!this._events[v])return this;if(!c)return o(this,v),this;var g=this._events[v];if(g.fn)g.fn===c&&(!d||g.once)&&(!f||g.context===f)&&o(this,v);else{for(var x=0,w=[],S=g.length;x<S;x++)(g[x].fn!==c||d&&!g[x].once||f&&g[x].context!==f)&&w.push(g[x]);w.length?this._events[v]=w.length===1?w[0]:w:o(this,v)}return this},s.prototype.removeAllListeners=function(u){var c;return u?(c=r?r+u:u,this._events[c]&&o(this,c)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,e.exports=s})(mK);var $u=mK.exports;const G5=aa($u);var Iw=(e=>(e.Realtime="realtime",e.Overlap="overlap",e.Replace="replace",e))(Iw||{}),wf=(e=>(e.Loading="Loading",e.Loaded="Loaded",e.Failure="Failure",e.Cancelled="Cancelled",e))(wf||{}),yK=0,_z=1,oI=2;function BTt(e){e.forEach(t=>{t.isCurrent&&(t.isVisible=t.isLoaded)})}function NTt(e){e.forEach(t=>{t.properties.state=yK}),e.forEach(t=>{t.isCurrent&&!_K(t)&&W5(t)}),e.forEach(t=>{t.isVisible=!!(t.properties.state&oI)})}function kTt(e){e.forEach(r=>{r.properties.state=yK}),e.forEach(r=>{r.isCurrent&&_K(r)}),e.slice().sort((r,n)=>r.z-n.z).forEach(r=>{r.isVisible=!!(r.properties.state&oI),r.children.length&&(r.isVisible||r.properties.state&_z)?r.children.forEach(n=>{n.properties.state=_z}):r.isCurrent&&W5(r)})}function _K(e){for(;e;){if(e.isLoaded)return e.properties.state|=oI,!0;e=e.parent}return!1}function W5(e){e.children.forEach(t=>{t.isLoaded?t.properties.state|=oI:W5(t)})}var xK=[-1/0,-1/0,1/0,1/0],zTt=.2,UTt=5,$Tt={[Iw.Realtime]:BTt,[Iw.Overlap]:NTt,[Iw.Replace]:kTt},HTt=()=>{};function rD(e,t,r){const n=Math.floor((e+180)/360*Math.pow(2,r)),i=Math.floor((1-Math.log(Math.tan(t*Math.PI/180)+1/Math.cos(t*Math.PI/180))/Math.PI)/2*Math.pow(2,r));return[n,i]}function xz(e,t,r){const n=e/Math.pow(2,r)*360-180,i=Math.PI-2*Math.PI*t/Math.pow(2,r),a=180/Math.PI*Math.atan(.5*(Math.exp(i)-Math.exp(-i)));return[n,a]}var bK=(e,t,r)=>{const[n,i]=xz(e,t,r),[a,o]=xz(e+1,t+1,r);return[n,o,a,i]};function VTt({zoom:e,latLonBounds:t,maxZoom:r=1/0,minZoom:n=0,zoomOffset:i=0,extent:a=xK}){let o=Math.ceil(e)+i;if(Number.isFinite(n)&&o<n)return[];Number.isFinite(r)&&o>r&&(o=r);const[s,l,u,c]=t,f=[Math.max(s,a[0]),Math.max(l,a[1]),Math.min(u,a[2]),Math.min(c,a[3])],d=[],[v,g]=rD(f[0],f[1],o),[x,w]=rD(f[2],f[3],o);for(let R=v;R<=x;R++)for(let O=w;O<=g;O++)d.push({x:R,y:O,z:o});const S=(x+v)/2,A=(g+w)/2,M=(R,O)=>Math.abs(R-S)+Math.abs(O-A);return d.sort((R,O)=>M(R.x,R.y)-M(O.x,O.y)),d}var GTt=(e,t,r,n=!0)=>{const i=Math.pow(2,r),a=i-1,o=i;let s=e;const l=t;return n&&(s<0?s=s+o:s>a&&(s=s%o)),{warpX:s,warpY:l}},WTt=(e,t,r)=>new Promise((n,i)=>{var a=l=>{try{s(r.next(l))}catch(u){i(u)}},o=l=>{try{s(r.throw(l))}catch(u){i(u)}},s=l=>l.done?n(l.value):Promise.resolve(l.value).then(a,o);s((r=r.apply(e,t)).next())}),XTt=class extends $u.EventEmitter{constructor(e){super(),this.tileSize=256,this.isVisible=!1,this.isCurrent=!1,this.isVisibleChange=!1,this.loadedLayers=0,this.isLayerLoaded=!1,this.isLoad=!1,this.isChildLoad=!1,this.parent=null,this.children=[],this.data=null,this.properties={},this.loadDataId=0;const{x:t,y:r,z:n,tileSize:i,warp:a=!0}=e;this.x=t,this.y=r,this.z=n,this.warp=a||!0,this.tileSize=i}get isLoading(){return this.loadStatus===wf.Loading}get isLoaded(){return this.loadStatus===wf.Loaded}get isFailure(){return this.loadStatus===wf.Failure}setTileLayerLoaded(){this.isLayerLoaded=!0}get isCancelled(){return this.loadStatus===wf.Cancelled}get isDone(){return[wf.Loaded,wf.Cancelled,wf.Failure].includes(this.loadStatus)}get bounds(){return bK(this.x,this.y,this.z)}get bboxPolygon(){const[e,t,r,n]=this.bounds,i=[(r-e)/2,(n-t)/2];return FTt(this.bounds,{properties:{key:this.key,id:this.key,bbox:this.bounds,center:i,meta:`
      ${this.key}
      `}})}get key(){return`${this.x}_${this.y}_${this.z}`}layerLoad(){this.loadedLayers++,this.emit("layerLoaded")}loadData(e){return WTt(this,arguments,function*({getData:t,onLoad:r,onError:n}){this.loadDataId++;const i=this.loadDataId;this.isLoading&&this.abortLoad(),this.abortController=new AbortController,this.loadStatus=wf.Loading;let a=null,o;try{const{x:s,y:l,z:u,bounds:c,tileSize:f,warp:d}=this,{warpX:v,warpY:g}=GTt(s,l,u,d),{signal:x}=this.abortController;a=yield t({x:v,y:g,z:u,bounds:c,tileSize:f,signal:x,warp:d},this)}catch(s){o=s}if(i===this.loadDataId&&!(this.isCancelled&&!a)){if(o||!a){this.loadStatus=wf.Failure,n(o,this);return}this.loadStatus=wf.Loaded,this.data=a,r(this)}})}reloadData(e){this.isLoading&&this.abortLoad(),this.loadData(e)}abortLoad(){this.isLoaded||this.isCancelled||(this.loadStatus=wf.Cancelled,this.abortController.abort(),this.xhrCancel&&this.xhrCancel())}},jTt=(e,t)=>{const r=fM(e),n=V5(r,t),i=360*3-180,a=85.0511287798065;return[Math.max(n[0][0],-i),Math.max(n[0][1],-a),Math.min(n[1][0],i),Math.min(n[1][1],a)]},YTt=(e,t)=>{const r=fM(e),n=fM(t);return dK(r,n)},ZTt=Object.defineProperty,qTt=Object.defineProperties,KTt=Object.getOwnPropertyDescriptors,bz=Object.getOwnPropertySymbols,QTt=Object.prototype.hasOwnProperty,JTt=Object.prototype.propertyIsEnumerable,Ez=(e,t,r)=>t in e?ZTt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,wz=(e,t)=>{for(var r in t||(t={}))QTt.call(t,r)&&Ez(e,r,t[r]);if(bz)for(var r of bz(t))JTt.call(t,r)&&Ez(e,r,t[r]);return e},tAt=(e,t)=>qTt(e,KTt(t)),{throttle:eAt}=is,rAt=class extends G5{constructor(e){super(),this.currentTiles=[],this.cacheTiles=new Map,this.throttleUpdate=eAt((t,r)=>{this.update(t,r)},16),this.onTileLoad=t=>{this.emit("tile-loaded",t),this.updateTileVisible(),this.loadFinished()},this.onTileError=(t,r)=>{this.emit("tile-error",{error:t,tile:r}),this.updateTileVisible(),this.loadFinished()},this.onTileUnload=t=>{this.emit("tile-unload",t),this.loadFinished()},this.options={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,extent:xK,getTileData:HTt,warp:!0,updateStrategy:Iw.Replace},this.updateOptions(e)}get isLoaded(){return this.currentTiles.every(e=>e.isDone)}get tiles(){return Array.from(this.cacheTiles.values()).sort((t,r)=>t.z-r.z)}updateOptions(e){const t=e.minZoom===void 0?this.options.minZoom:Math.ceil(e.minZoom),r=e.maxZoom===void 0?this.options.maxZoom:Math.floor(e.maxZoom);this.options=tAt(wz(wz({},this.options),e),{minZoom:t,maxZoom:r})}update(e,t){const r=Math.max(0,Math.ceil(e));if(this.lastViewStates&&this.lastViewStates.zoom===r&&YTt(this.lastViewStates.latLonBoundsBuffer,t))return;const n=jTt(t,zTt);this.lastViewStates={zoom:r,latLonBounds:t,latLonBoundsBuffer:n},this.currentZoom=r;let i=!1;const a=this.getTileIndices(r,n).filter(o=>this.options.warp||o.x>=0&&o.x<Math.pow(2,r));this.emit("tiles-load-start"),this.currentTiles=a.map(({x:o,y:s,z:l})=>{let u=this.getTile(o,s,l);return u?(((u==null?void 0:u.isFailure)||(u==null?void 0:u.isCancelled))&&u.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}),u):(u=this.createTile(o,s,l),i=!0,u)}),i&&this.resizeCacheTiles(),this.updateTileVisible(),this.pruneRequests()}reloadAll(){for(const[e,t]of this.cacheTiles){if(!this.currentTiles.includes(t)){this.cacheTiles.delete(e),this.onTileUnload(t);return}this.onTileUnload(t),t.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError})}}reloadTileById(e,t,r){const n=this.cacheTiles.get(`${t},${r},${e}`);n&&(this.onTileUnload(n),n.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}))}reloadTileByLnglat(e,t,r){const n=this.getTileByLngLat(e,t,r);n&&this.reloadTileById(n.z,n.x,n.y)}reloadTileByExtent(e,t){this.getTileIndices(t,e).forEach(n=>{this.reloadTileById(n.z,n.x,n.y)})}pruneRequests(){const e=[];for(const t of this.cacheTiles.values())t.isLoading&&!t.isCurrent&&!t.isVisible&&e.push(t);for(;e.length>0;)e.shift().abortLoad()}getTileByLngLat(e,t,r){const{zoomOffset:n}=this.options,i=Math.ceil(r)+n,a=rD(e,t,i);return this.tiles.filter(s=>s.key===`${a[0]}_${a[1]}_${i}`)[0]}getTileExtent(e,t){return this.getTileIndices(t,e)}getTileByZXY(e,t,r){return this.tiles.filter(i=>i.key===`${t}_${r}_${e}`)[0]}clear(){for(const e of this.cacheTiles.values())e.isLoading?e.abortLoad():this.onTileUnload(e);this.lastViewStates=void 0,this.cacheTiles.clear(),this.currentTiles=[]}destroy(){this.clear(),this.removeAllListeners()}updateTileVisible(){const e=this.options.updateStrategy,t=new Map;for(const i of this.cacheTiles.values())t.set(i.key,i.isVisible),i.isCurrent=!1,i.isVisible=!1;for(const i of this.currentTiles)i.isCurrent=!0,i.isVisible=!0;const r=Array.from(this.cacheTiles.values());typeof e=="function"?e(r):$Tt[e](r);let n=!1;Array.from(this.cacheTiles.values()).forEach(i=>{i.isVisible!==t.get(i.key)?(i.isVisibleChange=!0,n=!0):i.isVisibleChange=!1}),n&&this.emit("tile-update")}getTileIndices(e,t){const{tileSize:r,extent:n,zoomOffset:i}=this.options,a=Math.floor(this.options.maxZoom),o=Math.ceil(this.options.minZoom);return VTt({maxZoom:a,minZoom:o,zoomOffset:i,tileSize:r,zoom:e,latLonBounds:t,extent:n})}getTileId(e,t,r){return`${e},${t},${r}`}loadFinished(){const e=!this.currentTiles.some(t=>!t.isDone);return e&&this.emit("tiles-load-finished"),e}getTile(e,t,r){const n=this.getTileId(e,t,r);return this.cacheTiles.get(n)}createTile(e,t,r){const n=this.getTileId(e,t,r),i=new XTt({x:e,y:t,z:r,tileSize:this.options.tileSize,warp:this.options.warp});return this.cacheTiles.set(n,i),i.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}),i}resizeCacheTiles(){const e=UTt*this.currentTiles.length;if(this.cacheTiles.size>e){for(const[r,n]of this.cacheTiles)if(!n.isVisible&&!this.currentTiles.includes(n)&&(this.cacheTiles.delete(r),this.onTileUnload(n)),this.cacheTiles.size<=e)break}this.rebuildTileTree()}rebuildTileTree(){for(const e of this.cacheTiles.values())e.parent=null,e.children.length=0;for(const e of this.cacheTiles.values()){const t=this.getNearestAncestor(e.x,e.y,e.z);e.parent=t,t!=null&&t.children&&t.children.push(e)}}getNearestAncestor(e,t,r){for(;r>this.options.minZoom;){e=Math.floor(e/2),t=Math.floor(t/2),r=r-1;const n=this.getTile(e,t,r);if(n)return n}return null}};function EK(e){const t=[];let r=/\{([a-z])-([a-z])\}/.exec(e);if(r){const n=r[1].charCodeAt(0),i=r[2].charCodeAt(0);let a;for(a=n;a<=i;++a)t.push(e.replace(r[0],String.fromCharCode(a)));return t}if(r=/\{(\d+)-(\d+)\}/.exec(e),r){const n=parseInt(r[2],10);for(let i=parseInt(r[1],10);i<=n;i++)t.push(e.replace(r[0],i.toString()));return t}return t.push(e),t}function ox(e,t){if(!e||!e.length)throw new Error("url is not allowed to be empty");const{x:r,y:n,z:i}=t,a=EK(e),o=Math.abs(r+n)%a.length;return(E5(a[o])?`${a[o]}/{z}/{x}/{y}`:a[o]).replace(/\{x\}/g,r.toString()).replace(/\{y\}/g,n.toString()).replace(/\{z\}/g,i.toString()).replace(/\{bbox\}/g,bK(r,n,i).join(",")).replace(/\{-y\}/g,(Math.pow(2,i)-n-1).toString())}function nAt(e,t){const{x:r,y:n,z:i,layer:a,version:o="1.0.0",style:s="default",format:l,service:u="WMTS",tileMatrixset:c}=t,f=EK(e),d=Math.abs(r+n)%f.length;return`${f[d]}&SERVICE=${u}&REQUEST=GetTile&VERSION=${o}&LAYER=${a}&STYLE=${s}&TILEMATRIXSET=${c}&FORMAT=${l}&TILECOL=${r}&TILEROW=${n}&TILEMATRIX=${i}`}function wE(e,t){return e??t}var iAt=wA;function wA(e,t){var r=e&&e.type,n;if(r==="FeatureCollection")for(n=0;n<e.features.length;n++)wA(e.features[n],t);else if(r==="GeometryCollection")for(n=0;n<e.geometries.length;n++)wA(e.geometries[n],t);else if(r==="Feature")wA(e.geometry,t);else if(r==="Polygon")Cz(e.coordinates,t);else if(r==="MultiPolygon")for(n=0;n<e.coordinates.length;n++)Cz(e.coordinates[n],t);return e}function Cz(e,t){if(e.length!==0){Sz(e[0],t);for(var r=1;r<e.length;r++)Sz(e[r],!t)}}function Sz(e,t){for(var r=0,n=0,i=0,a=e.length,o=a-1;i<a;o=i++){var s=(e[i][0]-e[o][0])*(e[o][1]+e[i][1]),l=r+s;n+=Math.abs(r)>=Math.abs(s)?r-l+s:s-l+r,r=l}r+n>=0!=!!t&&e.reverse()}const aAt=aa(iAt);function oAt(e,t){return e.map(r=>r[t]*1)}function wK(e){return Array.isArray(e)?e.length===0||typeof e[0]=="number":!1}function nD(e){const t=Object.isFrozen(e)?is.cloneDeep(e):e;return aAt(t,!0),t}function _b(e,t){return e||[[t[0],t[3]],[t[2],t[3]],[t[2],t[1]],[t[0],t[1]]]}var sAt=Object.defineProperty,lAt=Object.defineProperties,uAt=Object.getOwnPropertyDescriptors,Tz=Object.getOwnPropertySymbols,cAt=Object.prototype.hasOwnProperty,hAt=Object.prototype.propertyIsEnumerable,Az=(e,t,r)=>t in e?sAt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Mz=(e,t)=>{for(var r in t||(t={}))cAt.call(t,r)&&Az(e,r,t[r]);if(Tz)for(var r of Tz(t))hAt.call(t,r)&&Az(e,r,t[r]);return e},Rz=(e,t)=>lAt(e,uAt(t));function CK(e,t){const{x:r,y:n,x1:i,y1:a,coordinates:o,geometry:s}=t,l=[];if(!Array.isArray(e))return{dataArray:[]};if(s)return e.filter(u=>u[s]&&u[s].type&&u[s].coordinates&&u[s].coordinates.length>0).forEach((u,c)=>{const f=nD(u[s]);VZ(f,d=>{const v=$Z(d),g=Rz(Mz({},u),{_id:c,coordinates:v});l.push(g)})}),{dataArray:l};for(let u=0;u<e.length;u++){const c=e[u];let f=[];if(o){let v="Polygon";Array.isArray(o[0])||(v="Point"),Array.isArray(o[0])&&!Array.isArray(o[0][0])&&(v="LineString"),f=nD({type:v,coordinates:c[o]}).coordinates}else if(r&&n&&i&&a){const v=[parseFloat(c[r]),parseFloat(c[n])],g=[parseFloat(c[i]),parseFloat(c[a])];f=[v,g]}else r&&n&&(f=[parseFloat(c[r]),parseFloat(c[n])]);const d=Rz(Mz({},c),{_id:u,coordinates:f});l.push(d)}return{dataArray:l}}function fAt(e,t){const r=fft(e);return CK(r,t)}var dAt=Object.defineProperty,pAt=Object.defineProperties,vAt=Object.getOwnPropertyDescriptors,Iz=Object.getOwnPropertySymbols,gAt=Object.prototype.hasOwnProperty,mAt=Object.prototype.propertyIsEnumerable,Lz=(e,t,r)=>t in e?dAt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,yAt=(e,t)=>{for(var r in t||(t={}))gAt.call(t,r)&&Lz(e,r,t[r]);if(Iz)for(var r of Iz(t))mAt.call(t,r)&&Lz(e,r,t[r]);return e},_At=(e,t)=>pAt(e,vAt(t));function xAt(e){const t=e.toString();let r=5381,n=t.length;for(;n;)r=r*33^t.charCodeAt(--n);return r>>>0}function bAt(e,t){return t===void 0?null:typeof(e.properties[t]*1)=="number"?e.properties[t]*1:e.properties&&e.properties[t]?xAt(e.properties[t]+"")%1000019:null}function EAt(e,t){const r=[],n={};return e.features?(e.features=e.features.filter(i=>{const a=i.geometry;return i!=null&&a&&a.type&&a.coordinates&&a.coordinates.length>0}),e=nD(e),e.features.length===0?{dataArray:[],featureKeys:n}:(VZ(e,(i,a)=>{let o=bAt(i,t==null?void 0:t.featureId);o===null&&(o=a);const s=o,l=$Z(i),u=_At(yAt({},i.properties),{coordinates:l,_id:s});r.push(u)}),{dataArray:r,featureKeys:n})):(e.features=[],{dataArray:[]})}function iD(e,t,r,n){for(var i=n,a=r-t>>1,o=r-t,s,l=e[t],u=e[t+1],c=e[r],f=e[r+1],d=t+3;d<r;d+=3){var v=wAt(e[d],e[d+1],l,u,c,f);if(v>i)s=d,i=v;else if(v===i){var g=Math.abs(d-a);g<o&&(s=d,o=g)}}i>n&&(s-t>3&&iD(e,t,s,n),e[s+2]=i,r-s>3&&iD(e,s,r,n))}function wAt(e,t,r,n,i,a){var o=i-r,s=a-n;if(o!==0||s!==0){var l=((e-r)*o+(t-n)*s)/(o*o+s*s);l>1?(r=i,n=a):l>0&&(r+=o*l,n+=s*l)}return o=e-r,s=t-n,o*o+s*s}function iC(e,t,r,n){var i={id:typeof e>"u"?null:e,type:t,geometry:r,tags:n,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return CAt(i),i}function CAt(e){var t=e.geometry,r=e.type;if(r==="Point"||r==="MultiPoint"||r==="LineString")eO(e,t);else if(r==="Polygon"||r==="MultiLineString")for(var n=0;n<t.length;n++)eO(e,t[n]);else if(r==="MultiPolygon")for(n=0;n<t.length;n++)for(var i=0;i<t[n].length;i++)eO(e,t[n][i])}function eO(e,t){for(var r=0;r<t.length;r+=3)e.minX=Math.min(e.minX,t[r]),e.minY=Math.min(e.minY,t[r+1]),e.maxX=Math.max(e.maxX,t[r]),e.maxY=Math.max(e.maxY,t[r+1])}function SAt(e,t){var r=[];if(e.type==="FeatureCollection")for(var n=0;n<e.features.length;n++)CA(r,e.features[n],t,n);else e.type==="Feature"?CA(r,e,t):CA(r,{geometry:e},t);return r}function CA(e,t,r,n){if(t.geometry){var i=t.geometry.coordinates,a=t.geometry.type,o=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2),s=[],l=t.id;if(r.promoteId?l=t.properties[r.promoteId]:r.generateId&&(l=n||0),a==="Point")Oz(i,s);else if(a==="MultiPoint")for(var u=0;u<i.length;u++)Oz(i[u],s);else if(a==="LineString")aD(i,s,o,!1);else if(a==="MultiLineString")if(r.lineMetrics){for(u=0;u<i.length;u++)s=[],aD(i[u],s,o,!1),e.push(iC(l,"LineString",s,t.properties));return}else rO(i,s,o,!1);else if(a==="Polygon")rO(i,s,o,!0);else if(a==="MultiPolygon")for(u=0;u<i.length;u++){var c=[];rO(i[u],c,o,!0),s.push(c)}else if(a==="GeometryCollection"){for(u=0;u<t.geometry.geometries.length;u++)CA(e,{id:l,geometry:t.geometry.geometries[u],properties:t.properties},r,n);return}else throw new Error("Input data is not a valid GeoJSON object.");e.push(iC(l,a,s,t.properties))}}function Oz(e,t){t.push(SK(e[0])),t.push(TK(e[1])),t.push(0)}function aD(e,t,r,n){for(var i,a,o=0,s=0;s<e.length;s++){var l=SK(e[s][0]),u=TK(e[s][1]);t.push(l),t.push(u),t.push(0),s>0&&(n?o+=(i*u-l*a)/2:o+=Math.sqrt(Math.pow(l-i,2)+Math.pow(u-a,2))),i=l,a=u}var c=t.length-3;t[2]=1,iD(t,0,c,r),t[c+2]=1,t.size=Math.abs(o),t.start=0,t.end=t.size}function rO(e,t,r,n){for(var i=0;i<e.length;i++){var a=[];aD(e[i],a,r,n),t.push(a)}}function SK(e){return e/360+.5}function TK(e){var t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function Vv(e,t,r,n,i,a,o,s){if(r/=t,n/=t,a>=r&&o<n)return e;if(o<r||a>=n)return null;for(var l=[],u=0;u<e.length;u++){var c=e[u],f=c.geometry,d=c.type,v=i===0?c.minX:c.minY,g=i===0?c.maxX:c.maxY;if(v>=r&&g<n){l.push(c);continue}else if(g<r||v>=n)continue;var x=[];if(d==="Point"||d==="MultiPoint")TAt(f,x,r,n,i);else if(d==="LineString")AK(f,x,r,n,i,!1,s.lineMetrics);else if(d==="MultiLineString")nO(f,x,r,n,i,!1);else if(d==="Polygon")nO(f,x,r,n,i,!0);else if(d==="MultiPolygon")for(var w=0;w<f.length;w++){var S=[];nO(f[w],S,r,n,i,!0),S.length&&x.push(S)}if(x.length){if(s.lineMetrics&&d==="LineString"){for(w=0;w<x.length;w++)l.push(iC(c.id,d,x[w],c.tags));continue}(d==="LineString"||d==="MultiLineString")&&(x.length===1?(d="LineString",x=x[0]):d="MultiLineString"),(d==="Point"||d==="MultiPoint")&&(d=x.length===3?"Point":"MultiPoint"),l.push(iC(c.id,d,x,c.tags))}}return l.length?l:null}function TAt(e,t,r,n,i){for(var a=0;a<e.length;a+=3){var o=e[a+i];o>=r&&o<=n&&(t.push(e[a]),t.push(e[a+1]),t.push(e[a+2]))}}function AK(e,t,r,n,i,a,o){for(var s=Pz(e),l=i===0?AAt:MAt,u=e.start,c,f,d=0;d<e.length-3;d+=3){var v=e[d],g=e[d+1],x=e[d+2],w=e[d+3],S=e[d+4],A=i===0?v:g,M=i===0?w:S,R=!1;o&&(c=Math.sqrt(Math.pow(v-w,2)+Math.pow(g-S,2))),A<r?M>r&&(f=l(s,v,g,w,S,r),o&&(s.start=u+c*f)):A>n?M<n&&(f=l(s,v,g,w,S,n),o&&(s.start=u+c*f)):iO(s,v,g,x),M<r&&A>=r&&(f=l(s,v,g,w,S,r),R=!0),M>n&&A<=n&&(f=l(s,v,g,w,S,n),R=!0),!a&&R&&(o&&(s.end=u+c*f),t.push(s),s=Pz(e)),o&&(u+=c)}var O=e.length-3;v=e[O],g=e[O+1],x=e[O+2],A=i===0?v:g,A>=r&&A<=n&&iO(s,v,g,x),O=s.length-3,a&&O>=3&&(s[O]!==s[0]||s[O+1]!==s[1])&&iO(s,s[0],s[1],s[2]),s.length&&t.push(s)}function Pz(e){var t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function nO(e,t,r,n,i,a){for(var o=0;o<e.length;o++)AK(e[o],t,r,n,i,a,!1)}function iO(e,t,r,n){e.push(t),e.push(r),e.push(n)}function AAt(e,t,r,n,i,a){var o=(a-t)/(n-t);return e.push(a),e.push(r+(i-r)*o),e.push(1),o}function MAt(e,t,r,n,i,a){var o=(a-r)/(i-r);return e.push(t+(n-t)*o),e.push(a),e.push(1),o}function RAt(e,t){var r=t.buffer/t.extent,n=e,i=Vv(e,1,-1-r,r,0,-1,2,t),a=Vv(e,1,1-r,2+r,0,-1,2,t);return(i||a)&&(n=Vv(e,1,-r,1+r,0,-1,2,t)||[],i&&(n=Dz(i,1).concat(n)),a&&(n=n.concat(Dz(a,-1)))),n}function Dz(e,t){for(var r=[],n=0;n<e.length;n++){var i=e[n],a=i.type,o;if(a==="Point"||a==="MultiPoint"||a==="LineString")o=aO(i.geometry,t);else if(a==="MultiLineString"||a==="Polygon"){o=[];for(var s=0;s<i.geometry.length;s++)o.push(aO(i.geometry[s],t))}else if(a==="MultiPolygon")for(o=[],s=0;s<i.geometry.length;s++){for(var l=[],u=0;u<i.geometry[s].length;u++)l.push(aO(i.geometry[s][u],t));o.push(l)}r.push(iC(i.id,a,o,i.tags))}return r}function aO(e,t){var r=[];r.size=e.size,e.start!==void 0&&(r.start=e.start,r.end=e.end);for(var n=0;n<e.length;n+=3)r.push(e[n]+t,e[n+1],e[n+2]);return r}function Fz(e,t){if(e.transformed)return e;var r=1<<e.z,n=e.x,i=e.y,a,o,s;for(a=0;a<e.features.length;a++){var l=e.features[a],u=l.geometry,c=l.type;if(l.geometry=[],c===1)for(o=0;o<u.length;o+=2)l.geometry.push(Bz(u[o],u[o+1],t,r,n,i));else for(o=0;o<u.length;o++){var f=[];for(s=0;s<u[o].length;s+=2)f.push(Bz(u[o][s],u[o][s+1],t,r,n,i));l.geometry.push(f)}}return e.transformed=!0,e}function Bz(e,t,r,n,i,a){return[Math.round(r*(e*n-i)),Math.round(r*(t*n-a))]}function IAt(e,t,r,n,i){for(var a=t===i.maxZoom?0:i.tolerance/((1<<t)*i.extent),o={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:r,y:n,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<e.length;s++){o.numFeatures++,LAt(o,e[s],a,i);var l=e[s].minX,u=e[s].minY,c=e[s].maxX,f=e[s].maxY;l<o.minX&&(o.minX=l),u<o.minY&&(o.minY=u),c>o.maxX&&(o.maxX=c),f>o.maxY&&(o.maxY=f)}return o}function LAt(e,t,r,n){var i=t.geometry,a=t.type,o=[];if(a==="Point"||a==="MultiPoint")for(var s=0;s<i.length;s+=3)o.push(i[s]),o.push(i[s+1]),e.numPoints++,e.numSimplified++;else if(a==="LineString")oO(o,i,e,r,!1,!1);else if(a==="MultiLineString"||a==="Polygon")for(s=0;s<i.length;s++)oO(o,i[s],e,r,a==="Polygon",s===0);else if(a==="MultiPolygon")for(var l=0;l<i.length;l++){var u=i[l];for(s=0;s<u.length;s++)oO(o,u[s],e,r,!0,s===0)}if(o.length){var c=t.tags||null;if(a==="LineString"&&n.lineMetrics){c={};for(var f in t.tags)c[f]=t.tags[f];c.mapbox_clip_start=i.start/i.size,c.mapbox_clip_end=i.end/i.size}var d={geometry:o,type:a==="Polygon"||a==="MultiPolygon"?3:a==="LineString"||a==="MultiLineString"?2:1,tags:c};t.id!==null&&(d.id=t.id),e.features.push(d)}}function oO(e,t,r,n,i,a){var o=n*n;if(n>0&&t.size<(i?o:n)){r.numPoints+=t.length/3;return}for(var s=[],l=0;l<t.length;l+=3)(n===0||t[l+2]>o)&&(r.numSimplified++,s.push(t[l]),s.push(t[l+1])),r.numPoints++;i&&OAt(s,a),e.push(s)}function OAt(e,t){for(var r=0,n=0,i=e.length,a=i-2;n<i;a=n,n+=2)r+=(e[n]-e[a])*(e[n+1]+e[a+1]);if(r>0===t)for(n=0,i=e.length;n<i/2;n+=2){var o=e[n],s=e[n+1];e[n]=e[i-2-n],e[n+1]=e[i-1-n],e[i-2-n]=o,e[i-1-n]=s}}function PAt(e,t){return new sI(e,t)}function sI(e,t){t=this.options=DAt(Object.create(this.options),t);var r=t.debug;if(r&&console.time("preprocess data"),t.maxZoom<0||t.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(t.promoteId&&t.generateId)throw new Error("promoteId and generateId cannot be used together.");var n=SAt(e,t);this.tiles={},this.tileCoords=[],r&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),n=RAt(n,t),n.length&&this.splitTile(n,0,0,0),r&&(n.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}sI.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};sI.prototype.splitTile=function(e,t,r,n,i,a,o){for(var s=[e,t,r,n],l=this.options,u=l.debug;s.length;){n=s.pop(),r=s.pop(),t=s.pop(),e=s.pop();var c=1<<t,f=oD(t,r,n),d=this.tiles[f];if(!d&&(u>1&&console.time("creation"),d=this.tiles[f]=IAt(e,t,r,n,l),this.tileCoords.push({z:t,x:r,y:n}),u)){u>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,r,n,d.numFeatures,d.numPoints,d.numSimplified),console.timeEnd("creation"));var v="z"+t;this.stats[v]=(this.stats[v]||0)+1,this.total++}if(d.source=e,i){if(t===l.maxZoom||t===i)continue;var g=1<<i-t;if(r!==Math.floor(a/g)||n!==Math.floor(o/g))continue}else if(t===l.indexMaxZoom||d.numPoints<=l.indexMaxPoints)continue;if(d.source=null,e.length!==0){u>1&&console.time("clipping");var x=.5*l.buffer/l.extent,w=.5-x,S=.5+x,A=1+x,M,R,O,N,k,V;M=R=O=N=null,k=Vv(e,c,r-x,r+S,0,d.minX,d.maxX,l),V=Vv(e,c,r+w,r+A,0,d.minX,d.maxX,l),e=null,k&&(M=Vv(k,c,n-x,n+S,1,d.minY,d.maxY,l),R=Vv(k,c,n+w,n+A,1,d.minY,d.maxY,l),k=null),V&&(O=Vv(V,c,n-x,n+S,1,d.minY,d.maxY,l),N=Vv(V,c,n+w,n+A,1,d.minY,d.maxY,l),V=null),u>1&&console.timeEnd("clipping"),s.push(M||[],t+1,r*2,n*2),s.push(R||[],t+1,r*2,n*2+1),s.push(O||[],t+1,r*2+1,n*2),s.push(N||[],t+1,r*2+1,n*2+1)}}};sI.prototype.getTile=function(e,t,r){var n=this.options,i=n.extent,a=n.debug;if(e<0||e>24)return null;var o=1<<e;t=(t%o+o)%o;var s=oD(e,t,r);if(this.tiles[s])return Fz(this.tiles[s],i);a>1&&console.log("drilling down to z%d-%d-%d",e,t,r);for(var l=e,u=t,c=r,f;!f&&l>0;)l--,u=Math.floor(u/2),c=Math.floor(c/2),f=this.tiles[oD(l,u,c)];return!f||!f.source?null:(a>1&&console.log("found parent tile z%d-%d-%d",l,u,c),a>1&&console.time("drilling down"),this.splitTile(f.source,l,u,c,e,t,r),a>1&&console.timeEnd("drilling down"),this.tiles[s]?Fz(this.tiles[s],i):null)};function oD(e,t,r){return((1<<e)*r+t)*32+e}function DAt(e,t){for(var r in t)e[r]=t[r];return e}var ow=class{constructor(t,r,n,i){this.vectorLayerCache={},this.x=r,this.y=n,this.z=i,this.vectorTile=t}getTileData(t){return!t||!this.vectorTile.layers[t]?[]:this.vectorLayerCache[t]?this.vectorLayerCache[t]:this.vectorTile.layers[t].features}getFeatureById(){throw new Error("Method not implemented.")}},FAt=Object.defineProperty,BAt=Object.defineProperties,NAt=Object.getOwnPropertyDescriptors,Nz=Object.getOwnPropertySymbols,kAt=Object.prototype.hasOwnProperty,zAt=Object.prototype.propertyIsEnumerable,kz=(e,t,r)=>t in e?FAt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,dM=(e,t)=>{for(var r in t||(t={}))kAt.call(t,r)&&kz(e,r,t[r]);if(Nz)for(var r of Nz(t))zAt.call(t,r)&&kz(e,r,t[r]);return e},UAt=(e,t)=>BAt(e,NAt(t)),$At=(e,t,r)=>new Promise((n,i)=>{var a=l=>{try{s(r.next(l))}catch(u){i(u)}},o=l=>{try{s(r.throw(l))}catch(u){i(u)}},s=l=>l.done?n(l.value):Promise.resolve(l.value).then(a,o);s((r=r.apply(e,t)).next())}),HAt={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0};function VAt(e){let t=0;for(let r=0,n=e.length,i=n-1,a,o;r<n;i=r++)a=e[r],o=e[i],t+=(o.x-a.x)*(a.y+o.y);return t}function GAt(e){const t=e.length;if(t<=1)return[e];const r=[];let n,i;for(let a=0;a<t;a++){const o=VAt(e[a]);o!==0&&(i===void 0&&(i=o<0),i===o<0?(n&&r.push(n),n=[e[a]]):n.push(e[a]))}return n&&r.push(n),r}var WAt=["Unknown","Point","LineString","Polygon"];function XAt(e,t,r,n,i){let a=i.geometry;const o=i.type,s=i.tags,l=i.id,u=e*Math.pow(2,n),c=e*t,f=e*r;let d=WAt[o],v,g;function x(S){for(let A=0;A<S.length;A++){const M=S[A];if(M[3])break;const R=180-(M[1]+f)*360/u,O=(M[0]+c)*360/u-180,N=360/Math.PI*Math.atan(Math.exp(R*Math.PI/180))-90;S[A]=[O,N,0,1]}}switch(o){case 1:const S=[];for(v=0;v<a.length;v++)S[v]=a[v][0];a=S,x(a);break;case 2:for(v=0;v<a.length;v++)x(a[v]);break;case 3:for(a=GAt(a),v=0;v<a.length;v++)for(g=0;g<a[v].length;g++)x(a[v][g]);break}return a.length===1?a=a[0]:d="Multi"+d,{type:"Feature",geometry:{type:d,coordinates:a},properties:s,id:l,tileOrigin:[0,0],coord:""}}var jAt=(e,t,r,n)=>$At(void 0,null,function*(){return new Promise(i=>{const a=t.getTile(e.z,e.x,e.y),s={layers:{defaultLayer:{features:a?a.features.map(u=>XAt(n,r.x,r.y,r.z,u)):[]}}},l=new ow(s,e.x,e.y,e.z);i(l)})});function YAt(e){const t={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!0,debug:0};return e===void 0||typeof e.geojsonvtOptions>"u"?t:dM(dM({},t),e.geojsonvtOptions)}function ZAt(e,t){const r=YAt(t),n=r.extent||4096,i=PAt(e,r),a=(s,l)=>jAt(l,i,s,n),o=UAt(dM(dM({},HAt),t),{getTileData:a});return{data:e,dataArray:[],tilesetOptions:o,isTile:!0}}var qAt=Object.defineProperty,KAt=Object.defineProperties,QAt=Object.getOwnPropertyDescriptors,zz=Object.getOwnPropertySymbols,JAt=Object.prototype.hasOwnProperty,tMt=Object.prototype.propertyIsEnumerable,Uz=(e,t,r)=>t in e?qAt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,$z=(e,t)=>{for(var r in t||(t={}))JAt.call(t,r)&&Uz(e,r,t[r]);if(zz)for(var r of zz(t))tMt.call(t,r)&&Uz(e,r,t[r]);return e},Hz=(e,t)=>KAt(e,QAt(t));function MK(e,t){const{extent:r=[121.168,30.2828,121.384,30.4219],coordinates:n,requestParameters:i={}}=t,a=new Promise(l=>{e instanceof HTMLImageElement||gTt(e)?l([e]):eMt(e,i,u=>{l(u)})}),o=_b(n,r);return{originData:e,images:a,_id:1,dataArray:[{_id:0,coordinates:o}]}}function eMt(e,t,r){const n=[];if(typeof e=="string")jP(Hz($z({},t),{url:e}),(i,a)=>{a&&(n.push(a),r(n))});else{const i=e.length;let a=0;e.forEach(o=>{jP(Hz($z({},t),{url:o}),(s,l)=>{a++,l&&n.push(l),a===i&&r(n)})})}return MK}var rMt=Object.defineProperty,nMt=Object.defineProperties,iMt=Object.getOwnPropertyDescriptors,Vz=Object.getOwnPropertySymbols,aMt=Object.prototype.hasOwnProperty,oMt=Object.prototype.propertyIsEnumerable,Gz=(e,t,r)=>t in e?rMt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,RK=(e,t)=>{for(var r in t||(t={}))aMt.call(t,r)&&Gz(e,r,t[r]);if(Vz)for(var r of Vz(t))oMt.call(t,r)&&Gz(e,r,t[r]);return e},IK=(e,t)=>nMt(e,iMt(t)),sMt=(e,t,r)=>new Promise((n,i)=>{var a=l=>{try{s(r.next(l))}catch(u){i(u)}},o=l=>{try{s(r.throw(l))}catch(u){i(u)}},s=l=>l.done?n(l.value):Promise.resolve(l.value).then(a,o);s((r=r.apply(e,t)).next())}),lMt=(e,t,r,n)=>sMt(void 0,null,function*(){const i={x:t.x,y:t.y,z:t.z},a=ox(e,i);return new Promise(o=>{n?n(i,(s,l)=>{if(s||!l){const u={layers:{defaultLayer:{features:[]}}},c=new ow(u,t.x,t.y,t.z);o(c)}else{const u={layers:{defaultLayer:{features:l.features}}},c=new ow(u,t.x,t.y,t.z);o(c)}}):Aft(IK(RK({},r),{url:a}),(s,l)=>{if(s||!l){const u={layers:{defaultLayer:{features:[]}}},c=new ow(u,t.x,t.y,t.z);o(c)}else{const c={layers:{defaultLayer:{features:JSON.parse(l)}}},f=new ow(c,t.x,t.y,t.z);o(f)}})})});function uMt(e,t){const r=(i,a)=>lMt(e,a,t==null?void 0:t.requestParameters,t.getCustomData),n=IK(RK({},t),{getTileData:r});return{dataArray:[],tilesetOptions:n,isTile:!0}}var LK=sx;function sx(e,t){this.x=e,this.y=t}sx.prototype={clone:function(){return new sx(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[0]*this.x+e[1]*this.y,r=e[2]*this.x+e[3]*this.y;return this.x=t,this.y=r,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),r=Math.sin(e),n=t*this.x-r*this.y,i=r*this.x+t*this.y;return this.x=n,this.y=i,this},_rotateAround:function(e,t){var r=Math.cos(e),n=Math.sin(e),i=t.x+r*(this.x-t.x)-n*(this.y-t.y),a=t.y+n*(this.x-t.x)+r*(this.y-t.y);return this.x=i,this.y=a,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}};sx.convert=function(e){return e instanceof sx?e:Array.isArray(e)?new sx(e[0],e[1]):e};const la=aa(LK);var cMt=LK,hMt=Ix;function Ix(e,t,r,n,i){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=n,this._values=i,e.readFields(fMt,this,t)}function fMt(e,t,r){e==1?t.id=r.readVarint():e==2?dMt(r,t):e==3?t.type=r.readVarint():e==4&&(t._geometry=r.pos)}function dMt(e,t){for(var r=e.readVarint()+e.pos;e.pos<r;){var n=t._keys[e.readVarint()],i=t._values[e.readVarint()];t.properties[n]=i}}Ix.types=["Unknown","Point","LineString","Polygon"];Ix.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,n=0,i=0,a=0,o=[],s;e.pos<t;){if(n<=0){var l=e.readVarint();r=l&7,n=l>>3}if(n--,r===1||r===2)i+=e.readSVarint(),a+=e.readSVarint(),r===1&&(s&&o.push(s),s=[]),s.push(new cMt(i,a));else if(r===7)s&&s.push(s[0].clone());else throw new Error("unknown command "+r)}return s&&o.push(s),o};Ix.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,n=0,i=0,a=0,o=1/0,s=-1/0,l=1/0,u=-1/0;e.pos<t;){if(n<=0){var c=e.readVarint();r=c&7,n=c>>3}if(n--,r===1||r===2)i+=e.readSVarint(),a+=e.readSVarint(),i<o&&(o=i),i>s&&(s=i),a<l&&(l=a),a>u&&(u=a);else if(r!==7)throw new Error("unknown command "+r)}return[o,l,s,u]};Ix.prototype.toGeoJSON=function(e,t,r){var n=this.extent*Math.pow(2,r),i=this.extent*e,a=this.extent*t,o=this.loadGeometry(),s=Ix.types[this.type],l,u;function c(v){for(var g=0;g<v.length;g++){var x=v[g],w=180-(x.y+a)*360/n;v[g]=[(x.x+i)*360/n-180,360/Math.PI*Math.atan(Math.exp(w*Math.PI/180))-90]}}switch(this.type){case 1:var f=[];for(l=0;l<o.length;l++)f[l]=o[l][0];o=f,c(o);break;case 2:for(l=0;l<o.length;l++)c(o[l]);break;case 3:for(o=pMt(o),l=0;l<o.length;l++)for(u=0;u<o[l].length;u++)c(o[l][u]);break}o.length===1?o=o[0]:s="Multi"+s;var d={type:"Feature",geometry:{type:s,coordinates:o},properties:this.properties};return"id"in this&&(d.id=this.id),d};function pMt(e){var t=e.length;if(t<=1)return[e];for(var r=[],n,i,a=0;a<t;a++){var o=vMt(e[a]);o!==0&&(i===void 0&&(i=o<0),i===o<0?(n&&r.push(n),n=[e[a]]):n.push(e[a]))}return n&&r.push(n),r}function vMt(e){for(var t=0,r=0,n=e.length,i=n-1,a,o;r<n;i=r++)a=e[r],o=e[i],t+=(o.x-a.x)*(a.y+o.y);return t}var gMt=hMt,mMt=OK;function OK(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(yMt,this,t),this.length=this._features.length}function yMt(e,t,r){e===15?t.version=r.readVarint():e===1?t.name=r.readString():e===5?t.extent=r.readVarint():e===2?t._features.push(r.pos):e===3?t._keys.push(r.readString()):e===4&&t._values.push(_Mt(r))}function _Mt(e){for(var t=null,r=e.readVarint()+e.pos;e.pos<r;){var n=e.readVarint()>>3;t=n===1?e.readString():n===2?e.readFloat():n===3?e.readDouble():n===4?e.readVarint64():n===5?e.readVarint():n===6?e.readSVarint():n===7?e.readBoolean():null}return t}OK.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new gMt(this._pbf,t,this.extent,this._keys,this._values)};var xMt=mMt,bMt=EMt;function EMt(e,t){this.layers=e.readFields(wMt,{},t)}function wMt(e,t,r){if(e===3){var n=new xMt(r,r.readVarint()+r.pos);n.length&&(t[n.name]=n)}}var CMt=bMt,X5={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */X5.read=function(e,t,r,n,i){var a,o,s=i*8-n-1,l=(1<<s)-1,u=l>>1,c=-7,f=r?i-1:0,d=r?-1:1,v=e[t+f];for(f+=d,a=v&(1<<-c)-1,v>>=-c,c+=s;c>0;a=a*256+e[t+f],f+=d,c-=8);for(o=a&(1<<-c)-1,a>>=-c,c+=n;c>0;o=o*256+e[t+f],f+=d,c-=8);if(a===0)a=1-u;else{if(a===l)return o?NaN:(v?-1:1)*(1/0);o=o+Math.pow(2,n),a=a-u}return(v?-1:1)*o*Math.pow(2,a-n)};X5.write=function(e,t,r,n,i,a){var o,s,l,u=a*8-i-1,c=(1<<u)-1,f=c>>1,d=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,v=n?0:a-1,g=n?1:-1,x=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=c):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),o+f>=1?t+=d/l:t+=d*Math.pow(2,1-f),t*l>=2&&(o++,l/=2),o+f>=c?(s=0,o=c):o+f>=1?(s=(t*l-1)*Math.pow(2,i),o=o+f):(s=t*Math.pow(2,f-1)*Math.pow(2,i),o=0));i>=8;e[r+v]=s&255,v+=g,s/=256,i-=8);for(o=o<<i|s,u+=i;u>0;e[r+v]=o&255,v+=g,o/=256,u-=8);e[r+v-g]|=x*128};var SMt=Fa,j2=X5;function Fa(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}Fa.Varint=0;Fa.Fixed64=1;Fa.Bytes=2;Fa.Fixed32=5;var sD=65536*65536,Wz=1/sD,TMt=12,PK=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");Fa.prototype={destroy:function(){this.buf=null},readFields:function(e,t,r){for(r=r||this.length;this.pos<r;){var n=this.readVarint(),i=n>>3,a=this.pos;this.type=n&7,e(i,t,this),this.pos===a&&this.skip(n)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=Y2(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=jz(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=Y2(this.buf,this.pos)+Y2(this.buf,this.pos+4)*sD;return this.pos+=8,e},readSFixed64:function(){var e=Y2(this.buf,this.pos)+jz(this.buf,this.pos+4)*sD;return this.pos+=8,e},readFloat:function(){var e=j2.read(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=j2.read(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t=this.buf,r,n;return n=t[this.pos++],r=n&127,n<128||(n=t[this.pos++],r|=(n&127)<<7,n<128)||(n=t[this.pos++],r|=(n&127)<<14,n<128)||(n=t[this.pos++],r|=(n&127)<<21,n<128)?r:(n=t[this.pos],r|=(n&15)<<28,AMt(r,e,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2===1?(e+1)/-2:e/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=TMt&&PK?$Mt(this.buf,t,e):UMt(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==Fa.Bytes)return e.push(this.readVarint(t));var r=kv(this);for(e=e||[];this.pos<r;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==Fa.Bytes)return e.push(this.readSVarint());var t=kv(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==Fa.Bytes)return e.push(this.readBoolean());var t=kv(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==Fa.Bytes)return e.push(this.readFloat());var t=kv(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==Fa.Bytes)return e.push(this.readDouble());var t=kv(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==Fa.Bytes)return e.push(this.readFixed32());var t=kv(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==Fa.Bytes)return e.push(this.readSFixed32());var t=kv(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==Fa.Bytes)return e.push(this.readFixed64());var t=kv(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==Fa.Bytes)return e.push(this.readSFixed64());var t=kv(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=e&7;if(t===Fa.Varint)for(;this.buf[this.pos++]>127;);else if(t===Fa.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Fa.Fixed32)this.pos+=4;else if(t===Fa.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+t)},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var r=new Uint8Array(t);r.set(this.buf),this.buf=r,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),E1(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),E1(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),E1(this.buf,e&-1,this.pos),E1(this.buf,Math.floor(e*Wz),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),E1(this.buf,e&-1,this.pos),E1(this.buf,Math.floor(e*Wz),this.pos+4),this.pos+=8},writeVarint:function(e){if(e=+e||0,e>268435455||e<0){MMt(e,this);return}this.realloc(4),this.buf[this.pos++]=e&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=e>>>7&127)))},writeSVarint:function(e){this.writeVarint(e<0?-e*2-1:e*2)},writeBoolean:function(e){this.writeVarint(!!e)},writeString:function(e){e=String(e),this.realloc(e.length*4),this.pos++;var t=this.pos;this.pos=HMt(this.buf,e,this.pos);var r=this.pos-t;r>=128&&Xz(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r},writeFloat:function(e){this.realloc(4),j2.write(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),j2.write(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var r=0;r<t;r++)this.buf[this.pos++]=e[r]},writeRawMessage:function(e,t){this.pos++;var r=this.pos;e(t,this);var n=this.pos-r;n>=128&&Xz(r,n,this),this.pos=r-1,this.writeVarint(n),this.pos+=n},writeMessage:function(e,t,r){this.writeTag(e,Fa.Bytes),this.writeRawMessage(t,r)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,LMt,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,OMt,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,FMt,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,PMt,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,DMt,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,BMt,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,NMt,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,kMt,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,zMt,t)},writeBytesField:function(e,t){this.writeTag(e,Fa.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,Fa.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,Fa.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,Fa.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,Fa.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,Fa.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,Fa.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,Fa.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,Fa.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,Fa.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,!!t)}};function AMt(e,t,r){var n=r.buf,i,a;if(a=n[r.pos++],i=(a&112)>>4,a<128||(a=n[r.pos++],i|=(a&127)<<3,a<128)||(a=n[r.pos++],i|=(a&127)<<10,a<128)||(a=n[r.pos++],i|=(a&127)<<17,a<128)||(a=n[r.pos++],i|=(a&127)<<24,a<128)||(a=n[r.pos++],i|=(a&1)<<31,a<128))return b1(e,i,t);throw new Error("Expected varint not more than 10 bytes")}function kv(e){return e.type===Fa.Bytes?e.readVarint()+e.pos:e.pos+1}function b1(e,t,r){return r?t*4294967296+(e>>>0):(t>>>0)*4294967296+(e>>>0)}function MMt(e,t){var r,n;if(e>=0?(r=e%4294967296|0,n=e/4294967296|0):(r=~(-e%4294967296),n=~(-e/4294967296),r^4294967295?r=r+1|0:(r=0,n=n+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),RMt(r,n,t),IMt(n,t)}function RMt(e,t,r){r.buf[r.pos++]=e&127|128,e>>>=7,r.buf[r.pos++]=e&127|128,e>>>=7,r.buf[r.pos++]=e&127|128,e>>>=7,r.buf[r.pos++]=e&127|128,e>>>=7,r.buf[r.pos]=e&127}function IMt(e,t){var r=(e&7)<<4;t.buf[t.pos++]|=r|((e>>>=3)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127)))))}function Xz(e,t,r){var n=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(Math.LN2*7));r.realloc(n);for(var i=r.pos-1;i>=e;i--)r.buf[i+n]=r.buf[i]}function LMt(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function OMt(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function PMt(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function DMt(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function FMt(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function BMt(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function NMt(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function kMt(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function zMt(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function Y2(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+e[t+3]*16777216}function E1(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function jz(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function UMt(e,t,r){for(var n="",i=t;i<r;){var a=e[i],o=null,s=a>239?4:a>223?3:a>191?2:1;if(i+s>r)break;var l,u,c;s===1?a<128&&(o=a):s===2?(l=e[i+1],(l&192)===128&&(o=(a&31)<<6|l&63,o<=127&&(o=null))):s===3?(l=e[i+1],u=e[i+2],(l&192)===128&&(u&192)===128&&(o=(a&15)<<12|(l&63)<<6|u&63,(o<=2047||o>=55296&&o<=57343)&&(o=null))):s===4&&(l=e[i+1],u=e[i+2],c=e[i+3],(l&192)===128&&(u&192)===128&&(c&192)===128&&(o=(a&15)<<18|(l&63)<<12|(u&63)<<6|c&63,(o<=65535||o>=1114112)&&(o=null))),o===null?(o=65533,s=1):o>65535&&(o-=65536,n+=String.fromCharCode(o>>>10&1023|55296),o=56320|o&1023),n+=String.fromCharCode(o),i+=s}return n}function $Mt(e,t,r){return PK.decode(e.subarray(t,r))}function HMt(e,t,r){for(var n=0,i,a;n<t.length;n++){if(i=t.charCodeAt(n),i>55295&&i<57344)if(a)if(i<56320){e[r++]=239,e[r++]=191,e[r++]=189,a=i;continue}else i=a-55296<<10|i-56320|65536,a=null;else{i>56319||n+1===t.length?(e[r++]=239,e[r++]=191,e[r++]=189):a=i;continue}else a&&(e[r++]=239,e[r++]=191,e[r++]=189,a=null);i<128?e[r++]=i:(i<2048?e[r++]=i>>6|192:(i<65536?e[r++]=i>>12|224:(e[r++]=i>>18|240,e[r++]=i>>12&63|128),e[r++]=i>>6&63|128),e[r++]=i&63|128)}return r}const VMt=aa(SMt);var GMt=Object.defineProperty,WMt=Object.defineProperties,XMt=Object.getOwnPropertyDescriptors,Yz=Object.getOwnPropertySymbols,jMt=Object.prototype.hasOwnProperty,YMt=Object.prototype.propertyIsEnumerable,Zz=(e,t,r)=>t in e?GMt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,qz=(e,t)=>{for(var r in t||(t={}))jMt.call(t,r)&&Zz(e,r,t[r]);if(Yz)for(var r of Yz(t))YMt.call(t,r)&&Zz(e,r,t[r]);return e},ZMt=(e,t)=>WMt(e,XMt(t)),Kz=class{constructor(e,t,r,n){this.vectorLayerCache={},this.x=t,this.y=r,this.z=n,this.vectorTile=new CMt(new VMt(e))}getTileData(e){if(!e||!this.vectorTile.layers[e])return[];if(this.vectorLayerCache[e])return this.vectorLayerCache[e];const t=this.vectorTile.layers[e];if(Array.isArray(t.features))return this.vectorLayerCache[e]=t.features,t.features;const r=[];for(let n=0;n<t.length;n++){const a=t.feature(n).toGeoJSON(this.x,this.y,this.z);r.push(ZMt(qz({},a),{properties:qz({id:a.id},a.properties)}))}return this.vectorLayerCache[e]=r,r}getFeatureById(){throw new Error("Method not implemented.")}},qMt=Object.defineProperty,KMt=Object.defineProperties,QMt=Object.getOwnPropertyDescriptors,Qz=Object.getOwnPropertySymbols,JMt=Object.prototype.hasOwnProperty,tRt=Object.prototype.propertyIsEnumerable,Jz=(e,t,r)=>t in e?qMt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,lD=(e,t)=>{for(var r in t||(t={}))JMt.call(t,r)&&Jz(e,r,t[r]);if(Qz)for(var r of Qz(t))tRt.call(t,r)&&Jz(e,r,t[r]);return e},DK=(e,t)=>KMt(e,QMt(t)),eRt=(e,t,r)=>new Promise((n,i)=>{var a=l=>{try{s(r.next(l))}catch(u){i(u)}},o=l=>{try{s(r.throw(l))}catch(u){i(u)}},s=l=>l.done?n(l.value):Promise.resolve(l.value).then(a,o);s((r=r.apply(e,t)).next())}),rRt={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0},nRt=(e,t,r,n,i)=>eRt(void 0,null,function*(){const a=ox(e,t);return new Promise(o=>{if(i)i({x:r.x,y:r.y,z:r.z},(s,l)=>{if(s||!l)o(void 0);else{const u=new Kz(l,r.x,r.y,r.z);o(u)}});else{const s=C5(DK(lD({},n),{url:a}),(l,u)=>{if(l||!u)o(void 0);else{const c=new Kz(u,r.x,r.y,r.z);o(c)}});r.xhrCancel=()=>s.cancel()}})});function iRt(e,t){const r=Array.isArray(e)?e[0]:e,n=(a,o)=>nRt(r,a,o,t==null?void 0:t.requestParameters,t==null?void 0:t.getCustomData),i=DK(lD(lD({},rRt),t),{getTileData:n});return{data:r,dataArray:[],tilesetOptions:i,isTile:!0}}function aRt(e,t,r){switch(e){case"+":return t+r;case"-":return t-r;case"*":return t*r;case"/":return t/r;case"%":return t%r;case"^":return Math.pow(t,r);case"abs":return Math.abs(t);case"floor":return Math.floor(t);case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"sin":return Math.sin(t);case"cos":return Math.cos(t);case"atan":return r===-1?Math.atan(t):Math.atan2(t,r);case"min":return Math.min(t,r);case"max":return Math.max(t,r);case"log10":return Math.log(t);case"log2":return Math.log2(t);default:return console.warn("Calculate symbol err! Return default 0"),0}}function Lw(e,t){const{width:r,height:n}=t[0],i=t.map(l=>l.rasterData),a=r*n,o=[],s=JSON.stringify(e);for(let l=0;l<a;l++){const u=JSON.parse(s),c=FK(u,i,l);if(typeof c=="number")o.push(c);else{const f=uD(u);o.push(f)}}return o}function FK(e,t,r){if(e.length===2&&e[0]==="band"&&typeof e[1]=="number")try{return t[e[1]][r]}catch{return console.warn("Raster Data err!"),0}e.map((n,i)=>{if(Array.isArray(n)&&n.length>0)switch(n[0]){case"band":try{e[i]=t[n[1]][r]}catch{console.warn("Raster Data err!"),e[i]=0}break;default:FK(n,t,r)}})}function oRt(e){const[t,r=-1,n=-1]=e;return t===void 0?(console.warn("Express err!"),["+",0,0]):[t.replace(/\s+/g,""),r,n]}function uD(e){const t=oRt(e),r=t[0];let n=t[1],i=t[2];return Array.isArray(n)&&(n=uD(e[1])),Array.isArray(i)&&(i=uD(e[2])),aRt(r,n,i)}var sRt={nd:{type:"operation",expression:["/",["-",["band",1],["band",0]],["+",["band",1],["band",0]]]},rgb:{type:"function",method:lRt}};function lRt(e,t){const r=e[0].rasterData,n=e[1].rasterData,i=e[2].rasterData,a=[],[o,s]=(t==null?void 0:t.countCut)||[2,98],l=(t==null?void 0:t.RMinMax)||lx(r,o,s),u=(t==null?void 0:t.GMinMax)||lx(n,o,s),c=(t==null?void 0:t.BMinMax)||lx(i,o,s);for(let f=0;f<r.length;f++)a.push(Math.max(0,r[f]-l[0])),a.push(Math.max(0,n[f]-u[0])),a.push(Math.max(0,i[f]-c[0]));return{rasterData:a,rMinMax:l,gMinMax:u,bMinMax:c}}function lx(e,t,r){const n=e.slice().sort((s,l)=>s-l),i=n.length,a=n[Math.ceil(i*t/100)],o=n[Math.ceil(i*r/100)];return[a,o]}var uRt=Object.defineProperty,cRt=Object.defineProperties,hRt=Object.getOwnPropertyDescriptors,tU=Object.getOwnPropertySymbols,fRt=Object.prototype.hasOwnProperty,dRt=Object.prototype.propertyIsEnumerable,eU=(e,t,r)=>t in e?uRt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,pRt=(e,t)=>{for(var r in t||(t={}))fRt.call(t,r)&&eU(e,r,t[r]);if(tU)for(var r of tU(t))dRt.call(t,r)&&eU(e,r,t[r]);return e},vRt=(e,t)=>cRt(e,hRt(t)),BK=(e,t,r)=>new Promise((n,i)=>{var a=l=>{try{s(r.next(l))}catch(u){i(u)}},o=l=>{try{s(r.throw(l))}catch(u){i(u)}},s=l=>l.done?n(l.value):Promise.resolve(l.value).then(a,o);s((r=r.apply(e,t)).next())});function j5(e,t,r){return BK(this,null,function*(){if(e.length===0)return{rasterData:[0],width:1,heigh:1};const n=yield Promise.all(e.map(({data:l,bands:u=[0]})=>t(l,u))),i=[];n.forEach(l=>{Array.isArray(l)?i.push(...l):i.push(l)});const{width:a,height:o}=i[0];let s;switch(typeof r){case"function":s=r(i);break;case"object":Array.isArray(r)?s={rasterData:Lw(r,i)}:s=gRt(r,i);break;default:s={rasterData:i[0].rasterData}}return vRt(pRt({},s),{width:a,height:o})})}function gRt(e,t){const r=sRt[e.type];if(r.type==="function")return r.method(t,e==null?void 0:e.options);if(r.type==="operation")return e.type==="rgb"?mRt(r.expression,t):{rasterData:Lw(r.expression,t)}}function mRt(e,t){e.r===void 0&&console.warn("Channel R lost in Operation! Use band[0] to fill!"),e.g===void 0&&console.warn("Channel G lost in Operation! Use band[0] to fill!"),e.b===void 0&&console.warn("Channel B lost in Operation! Use band[0] to fill!");const r=Lw(e.r||["band",0],t),n=Lw(e.g||["band",0],t),i=Lw(e.b||["band",0],t);return[r,n,i]}function cD(e,t,r,n){return BK(this,null,function*(){const i=yield j5(e,t,r);n(null,{data:i})})}function yRt(e,t){const{extent:r=[121.168,30.2828,121.384,30.4219],coordinates:n,width:i,height:a,min:o,max:s,format:l,operation:u}=t;let c,f,d;if(l===void 0||wK(e))c=Array.from(e),f=i,d=a;else{const x=Array.isArray(e)?e:[e];c=j5(x,l,u)}const v=_b(n,r);return{_id:1,dataArray:[{_id:1,data:c,width:f,height:d,min:o,max:s,coordinates:v}]}}function rU(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ce(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rU(Object(r),!0).forEach(function(n){z(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rU(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}let xS=function(e){return e.Normal="normal",e.PostProcessing="post-processing",e}({}),q=function(e){return e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.BLEND_EQUATION=32777]="BLEND_EQUATION",e[e.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",e[e.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",e[e.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",e[e.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",e[e.MAX_EXT=32776]="MAX_EXT",e[e.MIN_EXT=32775]="MIN_EXT",e[e.BLEND_DST_RGB=32968]="BLEND_DST_RGB",e[e.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",e[e.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",e[e.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.BLEND_COLOR=32773]="BLEND_COLOR",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",e[e.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.BUFFER_SIZE=34660]="BUFFER_SIZE",e[e.BUFFER_USAGE=34661]="BUFFER_USAGE",e[e.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.CULL_FACE=2884]="CULL_FACE",e[e.BLEND=3042]="BLEND",e[e.DITHER=3024]="DITHER",e[e.STENCIL_TEST=2960]="STENCIL_TEST",e[e.DEPTH_TEST=2929]="DEPTH_TEST",e[e.SCISSOR_TEST=3089]="SCISSOR_TEST",e[e.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",e[e.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.CW=2304]="CW",e[e.CCW=2305]="CCW",e[e.LINE_WIDTH=2849]="LINE_WIDTH",e[e.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",e[e.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",e[e.CULL_FACE_MODE=2885]="CULL_FACE_MODE",e[e.FRONT_FACE=2886]="FRONT_FACE",e[e.DEPTH_RANGE=2928]="DEPTH_RANGE",e[e.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",e[e.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",e[e.DEPTH_FUNC=2932]="DEPTH_FUNC",e[e.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",e[e.STENCIL_FUNC=2962]="STENCIL_FUNC",e[e.STENCIL_FAIL=2964]="STENCIL_FAIL",e[e.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",e[e.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",e[e.STENCIL_REF=2967]="STENCIL_REF",e[e.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",e[e.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",e[e.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",e[e.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",e[e.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",e[e.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",e[e.VIEWPORT=2978]="VIEWPORT",e[e.SCISSOR_BOX=3088]="SCISSOR_BOX",e[e.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",e[e.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",e[e.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",e[e.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e[e.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",e[e.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",e[e.RED_BITS=3410]="RED_BITS",e[e.GREEN_BITS=3411]="GREEN_BITS",e[e.BLUE_BITS=3412]="BLUE_BITS",e[e.ALPHA_BITS=3413]="ALPHA_BITS",e[e.DEPTH_BITS=3414]="DEPTH_BITS",e[e.STENCIL_BITS=3415]="STENCIL_BITS",e[e.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",e[e.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",e[e.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",e[e.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",e[e.SAMPLES=32937]="SAMPLES",e[e.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",e[e.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",e[e.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",e[e.DONT_CARE=4352]="DONT_CARE",e[e.FASTEST=4353]="FASTEST",e[e.NICEST=4354]="NICEST",e[e.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.RED=6403]="RED",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER",e[e.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",e[e.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",e[e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e.SHADER_TYPE=35663]="SHADER_TYPE",e[e.DELETE_STATUS=35712]="DELETE_STATUS",e[e.LINK_STATUS=35714]="LINK_STATUS",e[e.VALIDATE_STATUS=35715]="VALIDATE_STATUS",e[e.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",e[e.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",e[e.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",e[e.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",e[e.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP",e[e.VENDOR=7936]="VENDOR",e[e.RENDERER=7937]="RENDERER",e[e.VERSION=7938]="VERSION",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e[e.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",e[e.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE=5890]="TEXTURE",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e.TEXTURE0=33984]="TEXTURE0",e[e.TEXTURE1=33985]="TEXTURE1",e[e.TEXTURE2=33986]="TEXTURE2",e[e.TEXTURE3=33987]="TEXTURE3",e[e.TEXTURE4=33988]="TEXTURE4",e[e.TEXTURE5=33989]="TEXTURE5",e[e.TEXTURE6=33990]="TEXTURE6",e[e.TEXTURE7=33991]="TEXTURE7",e[e.TEXTURE8=33992]="TEXTURE8",e[e.TEXTURE9=33993]="TEXTURE9",e[e.TEXTURE10=33994]="TEXTURE10",e[e.TEXTURE11=33995]="TEXTURE11",e[e.TEXTURE12=33996]="TEXTURE12",e[e.TEXTURE13=33997]="TEXTURE13",e[e.TEXTURE14=33998]="TEXTURE14",e[e.TEXTURE15=33999]="TEXTURE15",e[e.TEXTURE16=34e3]="TEXTURE16",e[e.TEXTURE17=34001]="TEXTURE17",e[e.TEXTURE18=34002]="TEXTURE18",e[e.TEXTURE19=34003]="TEXTURE19",e[e.TEXTURE20=34004]="TEXTURE20",e[e.TEXTURE21=34005]="TEXTURE21",e[e.TEXTURE22=34006]="TEXTURE22",e[e.TEXTURE23=34007]="TEXTURE23",e[e.TEXTURE24=34008]="TEXTURE24",e[e.TEXTURE25=34009]="TEXTURE25",e[e.TEXTURE26=34010]="TEXTURE26",e[e.TEXTURE27=34011]="TEXTURE27",e[e.TEXTURE28=34012]="TEXTURE28",e[e.TEXTURE29=34013]="TEXTURE29",e[e.TEXTURE30=34014]="TEXTURE30",e[e.TEXTURE31=34015]="TEXTURE31",e[e.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e.COMPILE_STATUS=35713]="COMPILE_STATUS",e[e.LOW_FLOAT=36336]="LOW_FLOAT",e[e.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",e[e.HIGH_FLOAT=36338]="HIGH_FLOAT",e[e.LOW_INT=36339]="LOW_INT",e[e.MEDIUM_INT=36340]="MEDIUM_INT",e[e.HIGH_INT=36341]="HIGH_INT",e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.RENDERBUFFER=36161]="RENDERBUFFER",e[e.RGBA4=32854]="RGBA4",e[e.RGB5_A1=32855]="RGB5_A1",e[e.RGB565=36194]="RGB565",e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX=6401]="STENCIL_INDEX",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",e[e.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",e[e.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",e[e.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",e[e.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",e[e.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",e[e.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",e[e.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",e[e.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",e[e.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",e[e.NONE=0]="NONE",e[e.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",e[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",e[e.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",e[e.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",e[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e[e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",e}({});const _Rt=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,{camelCase:xRt,isNil:bRt,upperFirst:ERt}=is;class vg{constructor(){z(this,"shaderModuleService",void 0),z(this,"rendererService",void 0),z(this,"config",void 0),z(this,"quad",_Rt),z(this,"enabled",!0),z(this,"renderToScreen",!1),z(this,"model",void 0),z(this,"name",void 0),z(this,"optionsToUpdate",{})}getName(){return this.name}setName(t){this.name=t}getType(){return xS.PostProcessing}init(t,r){this.config=r,this.rendererService=t.getContainer().rendererService,this.shaderModuleService=t.getContainer().shaderModuleService;const{createAttribute:n,createBuffer:i,createModel:a}=this.rendererService,{vs:o,fs:s,uniforms:l}=this.setupShaders();this.model=a({vs:o,fs:s,attributes:{a_Position:n({buffer:i({data:[-4,-4,4,-4,0,4],type:q.FLOAT}),size:2})},uniforms:Ce(Ce({u_Texture:null},l),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:this.getName()==="copy"}})}render(t,r){const n=t.multiPassRenderer.getPostProcessor(),{useFramebuffer:i,getViewportSize:a,clear:o}=this.rendererService,{width:s,height:l}=a();i(this.renderToScreen?null:n.getWriteFBO(),()=>{o({framebuffer:n.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0});const u=Ce({u_BloomFinal:0,u_Texture:n.getReadFBO(),u_ViewportSize:[s,l]},this.convertOptionsToUniforms(this.optionsToUpdate));r&&(u.u_BloomFinal=1,u.u_Texture2=r),this.model.draw({uniforms:u})})}isEnabled(){return this.enabled}setEnabled(t){this.enabled=t}setRenderToScreen(t){this.renderToScreen=t}updateOptions(t){this.optionsToUpdate=Ce(Ce({},this.optionsToUpdate),t)}setupShaders(){throw new Error("Method not implemented.")}convertOptionsToUniforms(t){const r={};return Object.keys(t).forEach(n=>{bRt(t[n])||(r[`u_${ERt(xRt(n))}`]=t[n])}),r}}function wRt(e){let t=0;switch(e){case"vec2":case"ivec2":t=2;break;case"vec3":case"ivec3":t=3;break;case"vec4":case"ivec4":case"mat2":t=4;break;case"mat3":t=9;break;case"mat4":t=16;break}return t}const NK=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function nU(e,t=!1){const r={};return e=e.replace(NK,(n,i,a)=>{const o=a.split(":"),s=o[0].trim();let l="";switch(o.length>1&&(l=o[1].trim()),i){case"bool":l=l==="true";break;case"float":case"int":l=Number(l);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":l?l=l.replace("[","").replace("]","").split(",").reduce((u,c)=>(u.push(Number(c.trim())),u),[]):l=new Array(wRt(i)).fill(0);break}return r[s]=l,`${t?"uniform ":""}${i} ${s};
`}),{content:e,uniforms:r}}function sO(e){let{content:t,uniforms:r}=nU(e,!0);return t=t.replace(/(\s*uniform\s*.*\s*){((?:\s*.*\s*)*?)};/g,(n,i,a)=>{a=a.trim().replace(/^.*$/gm,l=>`uniform ${l}`);const{content:o,uniforms:s}=nU(a);return Object.assign(r,s),`${i}{
${o}
};`}),{content:t,uniforms:r}}function iU(e){const t={};return e.replace(NK,(r,n,i)=>{const a=i.trim();return t[a]?"":(t[a]=!0,`uniform ${n} ${a};
`)})}const ey={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"};let Lx=function(e){return e.TOPRIGHT="topright",e.TOPLEFT="topleft",e.BOTTOMRIGHT="bottomright",e.BOTTOMLEFT="bottomleft",e.TOPCENTER="topcenter",e.BOTTOMCENTER="bottomcenter",e.LEFTCENTER="leftcenter",e.RIGHTCENTER="rightcenter",e.LEFTTOP="lefttop",e.RIGHTTOP="righttop",e.LEFTBOTTOM="leftbottom",e.RIGHTBOTTOM="rightbottom",e}({}),Ox=function(e){return e[e.LNGLAT=1]="LNGLAT",e[e.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",e[e.VECTOR_TILE=3]="VECTOR_TILE",e[e.IDENTITY=4]="IDENTITY",e[e.METER_OFFSET=5]="METER_OFFSET",e}({});const w1={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter"};var yl={MapInitStart:"mapInitStart",LayerInitStart:"layerInitStart",LayerInitEnd:"layerInitEnd",SourceInitStart:"sourceInitStart",SourceInitEnd:"sourceInitEnd",ScaleInitStart:"scaleInitStart",ScaleInitEnd:"scaleInitEnd",MappingStart:"mappingStart",MappingEnd:"mappingEnd",BuildModelStart:"buildModelStart",BuildModelEnd:"buildModelEnd"};let Bc=function(e){return e.Hover="hover",e.Click="click",e.Select="select",e.Active="active",e.Drag="drag",e}({}),pm=function(e){return e.normal="normal",e.additive="additive",e.subtractive="subtractive",e.min="min",e.max="max",e.none="none",e}({}),by=function(e){return e.MULTIPLE="MULTIPLE",e.SINGLE="SINGLE",e}({}),lI=function(e){return e.AND="and",e.OR="or",e}({}),ou=function(e){return e.INIT="init",e.UPDATE="update",e}({}),Ba=function(e){return e.LINEAR="linear",e.SEQUENTIAL="sequential",e.POWER="power",e.LOG="log",e.IDENTITY="identity",e.TIME="time",e.QUANTILE="quantile",e.QUANTIZE="quantize",e.THRESHOLD="threshold",e.CAT="cat",e.DIVERGING="diverging",e.CUSTOM="threshold",e}({}),C1=function(e){return e.CONSTANT="constant",e.VARIABLE="variable",e}({}),Qr=function(e){return e[e.Attribute=0]="Attribute",e[e.InstancedAttribute=1]="InstancedAttribute",e[e.Uniform=2]="Uniform",e}({});const hD=["mapload","mapchange","mapAfterFrameChange"];var Y5={exports:{}};Y5.exports=bS;Y5.exports.default=bS;var ux=1e20;function bS(e,t,r,n,i,a){this.fontSize=e||24,this.buffer=t===void 0?3:t,this.cutoff=n||.25,this.fontFamily=i||"sans-serif",this.fontWeight=a||"normal",this.radius=r||8;var o=this.size=this.fontSize+this.buffer*2,s=o+this.buffer*2;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=o,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(s*s),this.gridInner=new Float64Array(s*s),this.f=new Float64Array(s),this.z=new Float64Array(s+1),this.v=new Uint16Array(s),this.useMetrics=this.ctx.measureText("A").actualBoundingBoxLeft!==void 0,this.middle=Math.round(o/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function CRt(e,t,r,n,i,a,o){a.fill(ux,0,t*r),o.fill(0,0,t*r);for(var s=(t-n)/2,l=0;l<i;l++)for(var u=0;u<n;u++){var c=(l+s)*t+u+s,f=e.data[4*(l*n+u)+3]/255;if(f===1)a[c]=0,o[c]=ux;else if(f===0)a[c]=ux,o[c]=0;else{var d=Math.max(0,.5-f),v=Math.max(0,f-.5);a[c]=d*d,o[c]=v*v}}}function SRt(e,t,r,n,i,a,o){for(var s=0;s<t*r;s++){var l=Math.sqrt(n[s])-Math.sqrt(i[s]);e[s]=Math.round(255-255*(l/a+o))}}bS.prototype._draw=function(e,t){var r=this.ctx.measureText(e),n=r.width,i=2*this.buffer,a,o,s,l,u,c,f,d;t&&this.useMetrics?(u=Math.floor(r.actualBoundingBoxAscent),d=this.buffer+Math.ceil(r.actualBoundingBoxAscent),c=this.buffer,f=this.buffer,o=Math.min(this.size,Math.ceil(r.actualBoundingBoxRight-r.actualBoundingBoxLeft)),l=Math.min(this.size-c,Math.ceil(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)),a=o+i,s=l+i,this.ctx.textBaseline="alphabetic"):(a=o=this.size,s=l=this.size,u=19*this.fontSize/24,c=f=0,d=this.middle,this.ctx.textBaseline="middle");var v;o&&l&&(this.ctx.clearRect(f,c,o,l),this.ctx.fillText(e,this.buffer,d),v=this.ctx.getImageData(f,c,o,l));var g=new Uint8ClampedArray(a*s);return CRt(v,a,s,o,l,this.gridOuter,this.gridInner),aU(this.gridOuter,a,s,this.f,this.v,this.z),aU(this.gridInner,a,s,this.f,this.v,this.z),SRt(g,a,s,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:g,metrics:{width:o,height:l,sdfWidth:a,sdfHeight:s,top:u,left:0,advance:n}}};bS.prototype.draw=function(e){return this._draw(e,!1).data};bS.prototype.drawWithMetrics=function(e){return this._draw(e,!0)};function aU(e,t,r,n,i,a){for(var o=0;o<t;o++)oU(e,o,t,r,n,i,a);for(var s=0;s<r;s++)oU(e,s*t,1,t,n,i,a)}function oU(e,t,r,n,i,a,o){var s,l,u,c;for(a[0]=0,o[0]=-ux,o[1]=ux,s=0;s<n;s++)i[s]=e[t+s*r];for(s=1,l=0,u=0;s<n;s++){do c=a[l],u=(i[s]-i[c]+s*s-c*c)/(s-c)/2;while(u<=o[l]&&--l>-1);l++,a[l]=s,o[l]=u,o[l+1]=ux}for(s=0,l=0;s<n;s++){for(;o[l+1]<s;)l++;c=a[l],e[t+s*r]=i[c]+(s-c)*(s-c)}}var TRt=Y5.exports;const ARt=aa(TRt),CE=30;function MRt({characterSet:e,getFontWidth:t,fontHeight:r,buffer:n,maxCanvasWidth:i,mapping:a={},xOffset:o=0,yOffset:s=0}){let l=0,u=o;Array.from(e).forEach((f,d)=>{if(!a[f]){const v=t(f,d);u+CE>i&&(u=0,l++),a[f]={x:u,y:s+l*CE,width:CE,height:CE,advance:v},u+=CE}});const c=r+n*2;return{mapping:a,xOffset:u,yOffset:s+l*c,canvasHeight:kK(s+(l+1)*c)}}function RRt(e,t,r){let n=0,i=0,a=0,o=[];const s={};for(const u of e)if(!s[u.id]){const{size:c}=u;n+c+t>r&&(sU(s,o,i),n=0,i=a+i+t,a=0,o=[]),o.push({icon:u,xOffset:n}),n=n+c+t,a=Math.max(a,c)}o.length>0&&sU(s,o,i);const l=kK(a+i+t);return{mapping:s,canvasHeight:l}}function sU(e,t,r){for(const n of t){const{icon:i,xOffset:a}=n;e[i.id]=Ce(Ce({},i),{},{x:a,y:r,image:i.image,width:i.width,height:i.height})}}function kK(e){return Math.pow(2,Math.ceil(Math.log2(e)))}const IRt=zRt(),LRt="sans-serif",ORt="normal",PRt=24,DRt=3,FRt=.25,BRt=8,lU=1024,NRt=1,uU=1,kRt=3;function zRt(){const e=[];for(let t=32;t<128;t++)e.push(String.fromCharCode(t));return e}function cU(e,t,r,n){e.font=`${n} ${r}px ${t}`,e.fillStyle="black",e.textBaseline="middle"}function hU(e,t){for(let r=0;r<e.length;r++)t.data[4*r+3]=e[r]}class URt extends $u.EventEmitter{constructor(...t){super(...t),z(this,"fontAtlas",void 0),z(this,"iconFontMap",void 0),z(this,"iconFontGlyphs",{}),z(this,"fontOptions",void 0),z(this,"key",void 0),z(this,"cache",new ITt(kRt))}get scale(){return uU}get canvas(){const t=this.cache.get(this.key);return t&&t.data}get mapping(){const t=this.cache.get(this.key);return t&&t.mapping||{}}getCanvasByKey(t){const r=this.cache.get(t);return r&&r.data}getMappingByKey(t){const r=this.cache.get(t);return r&&r.mapping||{}}init(){this.cache.clear(),this.fontOptions={fontFamily:LRt,fontWeight:ORt,characterSet:IRt,fontSize:PRt,buffer:DRt,sdf:!0,cutoff:FRt,radius:BRt,iconfont:!1},this.key="",this.iconFontMap=new Map}addIconGlyphs(t){t.forEach(r=>{this.iconFontGlyphs[r.name]=r.unicode})}addIconFont(t,r){this.iconFontMap.set(t,r)}getIconFontKey(t){return this.iconFontMap.get(t)||t}getGlyph(t){return this.iconFontGlyphs[t]?String.fromCharCode(parseInt(this.iconFontGlyphs[t],16)):""}setFontOptions(t){this.fontOptions=Ce(Ce({},this.fontOptions),t),this.key=this.getKey();const r=this.getNewChars(this.key,this.fontOptions.characterSet),n=this.cache.get(this.key);if(n&&r.length===0)return;const i=this.generateFontAtlas(this.key,r,n);this.fontAtlas=i,this.cache.set(this.key,i)}addFontFace(t,r){const n=document.createElement("style");n.type="text/css",n.innerText=`
        @font-face{
            font-family: '${t}';
            src: url('${r}') format('woff2'),
            url('${r}') format('woff'),
            url('${r}') format('truetype');
        }`,n.onload=()=>{if(document.fonts)try{document.fonts.load(`24px ${t}`,"L7text"),document.fonts.ready.then(()=>{this.emit("fontloaded",{fontFamily:t})})}catch(i){console.warn("当前环境不支持 document.fonts !"),console.warn("当前环境不支持 iconfont !"),console.warn(i)}},document.getElementsByTagName("head")[0].appendChild(n)}destroy(){this.cache.clear(),this.iconFontMap.clear()}generateFontAtlas(t,r,n){const{fontFamily:i,fontWeight:a,fontSize:o,buffer:s,sdf:l,radius:u,cutoff:c,iconfont:f}=this.fontOptions;let d=n&&n.data;d||(d=window.document.createElement("canvas"),d.width=lU);const v=d.getContext("2d",{willReadFrequently:!0});cU(v,i,o,a);const{mapping:g,canvasHeight:x,xOffset:w,yOffset:S}=MRt(Ce({getFontWidth:M=>v.measureText(M).width,fontHeight:o*uU,buffer:s,characterSet:r,maxCanvasWidth:lU},n&&{mapping:n.mapping,xOffset:n.xOffset,yOffset:n.yOffset})),A=v.getImageData(0,0,d.width,d.height);if(d.height=x,v.putImageData(A,0,0),cU(v,i,o,a),l){const M=new ARt(o,s,u,c,i,a),R=v.getImageData(0,0,M.size,M.size);for(const O of r){if(f){const N=String.fromCharCode(parseInt(O.replace("&#x","").replace(";",""),16)),k=M.draw(N);hU(k,R)}else hU(M.draw(O),R);v.putImageData(R,g[O].x,g[O].y)}}else for(const M of r)v.fillText(M,g[M].x,g[M].y+o*NRt);return{xOffset:w,yOffset:S,mapping:g,data:d,width:d.width,height:d.height}}getKey(){const{fontFamily:t,fontWeight:r}=this.fontOptions;return`${t}_${r}`}getNewChars(t,r){const n=this.cache.get(t);if(!n)return r;const i=[],a=n.mapping,o=new Set(Object.keys(a));return new Set(r).forEach(l=>{o.has(l)||i.push(l)}),i}}function fU(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(u){return void r(u)}s.done?t(l):Promise.resolve(l).then(n,i)}function Pe(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var a=e.apply(t,r);function o(l){fU(a,n,i,o,s,"next",l)}function s(l){fU(a,n,i,o,s,"throw",l)}o(void 0)})}}const $Rt=3,dU=1024,SE=64;class HRt extends $u.EventEmitter{constructor(...t){super(...t),z(this,"canvasHeight",128),z(this,"texture",void 0),z(this,"canvas",void 0),z(this,"iconData",void 0),z(this,"iconMap",void 0),z(this,"ctx",void 0),z(this,"loadingImageCount",0)}isLoading(){return this.loadingImageCount===0}init(){this.iconData=[],this.iconMap={},this.canvas=window.document.createElement("canvas"),this.canvas.width=128,this.canvas.height=128,this.ctx=this.canvas.getContext("2d")}addImage(t,r){var n=this;return Pe(function*(){let i=new Image;n.loadingImageCount++,n.hasImage(t)?console.warn("Image Id already exists"):n.iconData.push({id:t,size:SE}),n.updateIconMap(),i=yield n.loadImage(r);const a=n.iconData.find(o=>o.id===t);a&&(a.image=i,a.width=i.width,a.height=i.height),n.update()})()}addImageMini(t,r,n){const i=n.getSceneConfig().canvas;let a=i.createImage();if(this.loadingImageCount++,this.hasImage(t))throw new Error("Image Id already exists");this.iconData.push({id:t,size:SE}),this.updateIconMap(),this.loadImageMini(r,i).then(o=>{a=o;const s=this.iconData.find(l=>l.id===t);s&&(s.image=a,s.width=a.width,s.height=a.height),this.update()})}getTexture(){return this.texture}getIconMap(){return this.iconMap}getCanvas(){return this.canvas}hasImage(t){return this.iconMap.hasOwnProperty(t)}removeImage(t){this.hasImage(t)&&(this.iconData=this.iconData.filter(r=>r.id!==t),delete this.iconMap[t],this.update())}destroy(){this.removeAllListeners("imageUpdate"),this.iconData=[],this.iconMap={}}loadImage(t){return new Promise((r,n)=>{if(t instanceof HTMLImageElement){r(t);return}const i=new Image;i.crossOrigin="anonymous",i.onload=()=>{r(i)},i.onerror=()=>{n(new Error("Could not load image at "+t))},i.src=t instanceof File?URL.createObjectURL(t):t})}update(){this.updateIconMap(),this.updateIconAtlas(),this.loadingImageCount--,this.loadingImageCount===0&&this.emit("imageUpdate")}updateIconAtlas(){this.canvas.width=dU,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach(t=>{const{x:r,y:n,image:i,width:a=64,height:o=64}=this.iconMap[t],l=Math.max(a,o)/SE,u=o/l,c=a/l;i&&this.ctx.drawImage(i,r+(SE-c)/2,n+(SE-u)/2,c,u)})}updateIconMap(){const{mapping:t,canvasHeight:r}=RRt(this.iconData,$Rt,dU);this.iconMap=t,this.canvasHeight=r}loadImageMini(t,r){return new Promise((n,i)=>{const a=r.createImage();a.crossOrigin="anonymous",a.onload=()=>{n(a)},a.onerror=()=>{i(new Error("Could not load image at "+t))},a.src=t})}}var Mu=1e-6,qc=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});function VRt(){var e=new qc(4);return qc!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e}function GRt(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),l=Math.cos(r);return e[0]=n*l+a*s,e[1]=i*l+o*s,e[2]=n*-s+a*l,e[3]=i*-s+o*l,e}function WRt(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],f=c*o-s*u,d=-c*a+s*l,v=u*a-o*l,g=r*f+n*d+i*v;return g?(g=1/g,e[0]=f*g,e[1]=(-c*n+i*u)*g,e[2]=(s*n-i*o)*g,e[3]=d*g,e[4]=(c*r-i*l)*g,e[5]=(-s*r+i*a)*g,e[6]=v*g,e[7]=(-u*r+n*l)*g,e[8]=(o*r-n*a)*g,e):null}function uI(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],f=t[8],d=r[0],v=r[1],g=r[2],x=r[3],w=r[4],S=r[5],A=r[6],M=r[7],R=r[8];return e[0]=d*n+v*o+g*u,e[1]=d*i+v*s+g*c,e[2]=d*a+v*l+g*f,e[3]=x*n+w*o+S*u,e[4]=x*i+w*s+S*c,e[5]=x*a+w*l+S*f,e[6]=A*n+M*o+R*u,e[7]=A*i+M*s+R*c,e[8]=A*a+M*l+R*f,e}function XRt(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e}function jRt(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=-r,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function YRt(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function xb(){var e=new qc(16);return qc!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function ZRt(e,t,r,n,i,a,o,s,l,u,c,f,d,v,g,x){var w=new qc(16);return w[0]=e,w[1]=t,w[2]=r,w[3]=n,w[4]=i,w[5]=a,w[6]=o,w[7]=s,w[8]=l,w[9]=u,w[10]=c,w[11]=f,w[12]=d,w[13]=v,w[14]=g,w[15]=x,w}function pU(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function aC(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],f=t[9],d=t[10],v=t[11],g=t[12],x=t[13],w=t[14],S=t[15],A=r*s-n*o,M=r*l-i*o,R=r*u-a*o,O=n*l-i*s,N=n*u-a*s,k=i*u-a*l,V=c*x-f*g,Q=c*w-d*g,Y=c*S-v*g,X=f*w-d*x,tt=f*S-v*x,it=d*S-v*w,Et=A*it-M*tt+R*X+O*Y-N*Q+k*V;return Et?(Et=1/Et,e[0]=(s*it-l*tt+u*X)*Et,e[1]=(i*tt-n*it-a*X)*Et,e[2]=(x*k-w*N+S*O)*Et,e[3]=(d*N-f*k-v*O)*Et,e[4]=(l*Y-o*it-u*Q)*Et,e[5]=(r*it-i*Y+a*Q)*Et,e[6]=(w*R-g*k-S*M)*Et,e[7]=(c*k-d*R+v*M)*Et,e[8]=(o*tt-s*Y+u*V)*Et,e[9]=(n*Y-r*tt-a*V)*Et,e[10]=(g*N-x*R+S*A)*Et,e[11]=(f*R-c*N-v*A)*Et,e[12]=(s*Q-o*X-l*V)*Et,e[13]=(r*X-n*Q+i*V)*Et,e[14]=(x*M-g*O-w*A)*Et,e[15]=(c*O-f*M+d*A)*Et,e):null}function Dm(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],f=t[8],d=t[9],v=t[10],g=t[11],x=t[12],w=t[13],S=t[14],A=t[15],M=r[0],R=r[1],O=r[2],N=r[3];return e[0]=M*n+R*s+O*f+N*x,e[1]=M*i+R*l+O*d+N*w,e[2]=M*a+R*u+O*v+N*S,e[3]=M*o+R*c+O*g+N*A,M=r[4],R=r[5],O=r[6],N=r[7],e[4]=M*n+R*s+O*f+N*x,e[5]=M*i+R*l+O*d+N*w,e[6]=M*a+R*u+O*v+N*S,e[7]=M*o+R*c+O*g+N*A,M=r[8],R=r[9],O=r[10],N=r[11],e[8]=M*n+R*s+O*f+N*x,e[9]=M*i+R*l+O*d+N*w,e[10]=M*a+R*u+O*v+N*S,e[11]=M*o+R*c+O*g+N*A,M=r[12],R=r[13],O=r[14],N=r[15],e[12]=M*n+R*s+O*f+N*x,e[13]=M*i+R*l+O*d+N*w,e[14]=M*a+R*u+O*v+N*S,e[15]=M*o+R*c+O*g+N*A,e}function Lf(e,t,r){var n=r[0],i=r[1],a=r[2],o,s,l,u,c,f,d,v,g,x,w,S;return t===e?(e[12]=t[0]*n+t[4]*i+t[8]*a+t[12],e[13]=t[1]*n+t[5]*i+t[9]*a+t[13],e[14]=t[2]*n+t[6]*i+t[10]*a+t[14],e[15]=t[3]*n+t[7]*i+t[11]*a+t[15]):(o=t[0],s=t[1],l=t[2],u=t[3],c=t[4],f=t[5],d=t[6],v=t[7],g=t[8],x=t[9],w=t[10],S=t[11],e[0]=o,e[1]=s,e[2]=l,e[3]=u,e[4]=c,e[5]=f,e[6]=d,e[7]=v,e[8]=g,e[9]=x,e[10]=w,e[11]=S,e[12]=o*n+c*i+g*a+t[12],e[13]=s*n+f*i+x*a+t[13],e[14]=l*n+d*i+w*a+t[14],e[15]=u*n+v*i+S*a+t[15]),e}function Of(e,t,r){var n=r[0],i=r[1],a=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function bb(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[4],o=t[5],s=t[6],l=t[7],u=t[8],c=t[9],f=t[10],d=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*i+u*n,e[5]=o*i+c*n,e[6]=s*i+f*n,e[7]=l*i+d*n,e[8]=u*i-a*n,e[9]=c*i-o*n,e[10]=f*i-s*n,e[11]=d*i-l*n,e}function cI(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],s=t[2],l=t[3],u=t[8],c=t[9],f=t[10],d=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i-u*n,e[1]=o*i-c*n,e[2]=s*i-f*n,e[3]=l*i-d*n,e[8]=a*n+u*i,e[9]=o*n+c*i,e[10]=s*n+f*i,e[11]=l*n+d*i,e}function ES(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],s=t[2],l=t[3],u=t[4],c=t[5],f=t[6],d=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i+u*n,e[1]=o*i+c*n,e[2]=s*i+f*n,e[3]=l*i+d*n,e[4]=u*i-a*n,e[5]=c*i-o*n,e[6]=f*i-s*n,e[7]=d*i-l*n,e}function qRt(e,t,r,n,i){var a=1/Math.tan(t/2),o;return e[0]=a/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==1/0?(o=1/(n-i),e[10]=(i+n)*o,e[14]=2*i*n*o):(e[10]=-1,e[14]=-2*n),e}var zK=qRt;function vU(e,t){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],f=e[9],d=e[10],v=e[11],g=e[12],x=e[13],w=e[14],S=e[15],A=t[0],M=t[1],R=t[2],O=t[3],N=t[4],k=t[5],V=t[6],Q=t[7],Y=t[8],X=t[9],tt=t[10],it=t[11],Et=t[12],Tt=t[13],pt=t[14],kt=t[15];return Math.abs(r-A)<=Mu*Math.max(1,Math.abs(r),Math.abs(A))&&Math.abs(n-M)<=Mu*Math.max(1,Math.abs(n),Math.abs(M))&&Math.abs(i-R)<=Mu*Math.max(1,Math.abs(i),Math.abs(R))&&Math.abs(a-O)<=Mu*Math.max(1,Math.abs(a),Math.abs(O))&&Math.abs(o-N)<=Mu*Math.max(1,Math.abs(o),Math.abs(N))&&Math.abs(s-k)<=Mu*Math.max(1,Math.abs(s),Math.abs(k))&&Math.abs(l-V)<=Mu*Math.max(1,Math.abs(l),Math.abs(V))&&Math.abs(u-Q)<=Mu*Math.max(1,Math.abs(u),Math.abs(Q))&&Math.abs(c-Y)<=Mu*Math.max(1,Math.abs(c),Math.abs(Y))&&Math.abs(f-X)<=Mu*Math.max(1,Math.abs(f),Math.abs(X))&&Math.abs(d-tt)<=Mu*Math.max(1,Math.abs(d),Math.abs(tt))&&Math.abs(v-it)<=Mu*Math.max(1,Math.abs(v),Math.abs(it))&&Math.abs(g-Et)<=Mu*Math.max(1,Math.abs(g),Math.abs(Et))&&Math.abs(x-Tt)<=Mu*Math.max(1,Math.abs(x),Math.abs(Tt))&&Math.abs(w-pt)<=Mu*Math.max(1,Math.abs(w),Math.abs(pt))&&Math.abs(S-kt)<=Mu*Math.max(1,Math.abs(S),Math.abs(kt))}function sw(){var e=new qc(3);return qc!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function ec(e,t,r){var n=new qc(3);return n[0]=e,n[1]=t,n[2]=r,n}function KRt(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function QRt(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function lw(e,t){var r=t[0],n=t[1],i=t[2],a=r*r+n*n+i*i;return a>0&&(a=1/Math.sqrt(a)),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e}function JRt(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function tIt(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],s=r[1],l=r[2];return e[0]=i*l-a*s,e[1]=a*o-n*l,e[2]=n*s-i*o,e}function Z2(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[3]*n+r[7]*i+r[11]*a+r[15];return o=o||1,e[0]=(r[0]*n+r[4]*i+r[8]*a+r[12])/o,e[1]=(r[1]*n+r[5]*i+r[9]*a+r[13])/o,e[2]=(r[2]*n+r[6]*i+r[10]*a+r[14])/o,e}function oC(e,t,r){var n=t[0],i=t[1],a=t[2];return e[0]=n*r[0]+i*r[3]+a*r[6],e[1]=n*r[1]+i*r[4]+a*r[7],e[2]=n*r[2]+i*r[5]+a*r[8],e}function gU(e,t){var r=e[0],n=e[1],i=e[2],a=t[0],o=t[1],s=t[2],l=Math.sqrt(r*r+n*n+i*i),u=Math.sqrt(a*a+o*o+s*s),c=l*u,f=c&&JRt(e,t)/c;return Math.acos(Math.min(Math.max(f,-1),1))}var mU=KRt;(function(){var e=sw();return function(t,r,n,i,a,o){var s,l;for(r||(r=3),n||(n=0),i?l=Math.min(i*r+n,t.length):l=t.length,s=n;s<l;s+=r)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],a(e,e,o),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2];return t}})();function UK(){var e=new qc(4);return qc!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function eIt(e,t,r,n){var i=new qc(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i}function rIt(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function bm(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*a+r[12]*o,e[1]=r[1]*n+r[5]*i+r[9]*a+r[13]*o,e[2]=r[2]*n+r[6]*i+r[10]*a+r[14]*o,e[3]=r[3]*n+r[7]*i+r[11]*a+r[15]*o,e}(function(){var e=UK();return function(t,r,n,i,a,o){var s,l;for(r||(r=4),n||(n=0),i?l=Math.min(i*r+n,t.length):l=t.length,s=n;s<l;s+=r)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],e[3]=t[s+3],a(e,e,o),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2],t[s+3]=e[3];return t}})();function kc(){var e=new qc(2);return qc!=Float32Array&&(e[0]=0,e[1]=0),e}function fD(e,t){var r=new qc(2);return r[0]=e,r[1]=t,r}function lO(e,t){return e[0]=t[0],e[1]=t[1],e}function nIt(e,t,r){return e[0]=t,e[1]=r,e}function zl(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function pM(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function Nl(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e}function kl(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e}function ic(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e}function Px(e,t){var r=t[0]-e[0],n=t[1]-e[1];return Math.hypot(r,n)}function W1(e){var t=e[0],r=e[1];return Math.hypot(t,r)}function iIt(e,t){return e[0]=-t[0],e[1]=-t[1],e}function Dx(e,t){var r=t[0],n=t[1],i=r*r+n*n;return i>0&&(i=1/Math.sqrt(i)),e[0]=t[0]*i,e[1]=t[1]*i,e}function vM(e,t){return e[0]*t[0]+e[1]*t[1]}function aIt(e,t,r,n){var i=t[0],a=t[1];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e}function oIt(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[3]*i+r[6],e[1]=r[1]*n+r[4]*i+r[7],e}function dD(e,t){var r=e[0],n=e[1],i=t[0],a=t[1],o=Math.sqrt(r*r+n*n)*Math.sqrt(i*i+a*a),s=o&&(r*i+n*a)/o;return Math.acos(Math.min(Math.max(s,-1),1))}function sIt(e,t){return e[0]===t[0]&&e[1]===t[1]}var rg=pM;(function(){var e=kc();return function(t,r,n,i,a,o){var s,l;for(r||(r=2),n||(n=0),i?l=Math.min(i*r+n,t.length):l=t.length,s=n;s<l;s+=r)e[0]=t[s],e[1]=t[s+1],a(e,e,o),t[s]=e[0],t[s+1]=e[1];return t}})();class lIt{constructor(){z(this,"viewport",void 0),z(this,"overridedViewProjectionMatrix",void 0),z(this,"viewMatrixInverse",void 0),z(this,"cameraPosition",void 0)}init(){}update(t){this.viewport=t,this.viewMatrixInverse=xb(),aC(this.viewMatrixInverse,t.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}getProjectionMatrix(){return this.viewport.getProjectionMatrix()}getModelMatrix(){return this.viewport.getModelMatrix()}getViewMatrix(){return this.viewport.getViewMatrix()}getViewMatrixUncentered(){return this.viewport.getViewMatrixUncentered()}getViewProjectionMatrixUncentered(){return this.viewport.getViewProjectionMatrixUncentered()}getViewProjectionMatrix(){return this.overridedViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}getZoom(){return this.viewport.getZoom()}getZoomScale(){return this.viewport.getZoomScale()}getCenter(){const[t,r]=this.viewport.getCenter();return[t,r]}getFocalDistance(){return this.viewport.getFocalDistance()}getCameraPosition(){return this.cameraPosition}projectFlat(t,r){return this.viewport.projectFlat(t,r)}setViewProjectionMatrix(t){this.overridedViewProjectionMatrix=t}}const uIt={topleft:"column",topright:"column",bottomright:"column",bottomleft:"column",leftcenter:"column",rightcenter:"column",topcenter:"row",bottomcenter:"row",lefttop:"row",righttop:"row",leftbottom:"row",rightbottom:"row"};class cIt{constructor(){z(this,"container",void 0),z(this,"controlCorners",void 0),z(this,"controlContainer",void 0),z(this,"scene",void 0),z(this,"mapsService",void 0),z(this,"controls",[]),z(this,"unAddControls",[])}init(t,r){this.container=t.container,this.scene=r,this.mapsService=r.mapService,this.initControlPos()}addControl(t,r){r.mapService.map?(t.addTo(this.scene),this.controls.push(t)):this.unAddControls.push(t)}getControlByName(t){return this.controls.find(r=>r.controlOption.name===t)}removeControl(t){const r=this.controls.indexOf(t);return r>-1&&this.controls.splice(r,1),t.remove(),this}addControls(){this.unAddControls.forEach(t=>{t.addTo(this.scene),this.controls.push(t)}),this.unAddControls=[]}destroy(){for(const t of this.controls)t.remove();this.controls=[],this.clearControlPos()}initControlPos(){const t=this.controlCorners={},r="l7-",n=this.controlContainer=uo("div",r+"control-container",this.container);function i(o=[]){const s=o.map(l=>r+l).join(" ");t[o.filter(l=>!["row","column"].includes(l)).join("")]=uo("div",s,n)}function a(o){return[...o.replace(/^(top|bottom|left|right|center)/,"$1-").split("-"),uIt[o]]}Object.values(Lx).forEach(o=>{i(a(o))}),this.checkCornerOverlap()}clearControlPos(){for(const t in this.controlCorners)this.controlCorners[t]&&Td(this.controlCorners[t]);this.controlContainer&&Td(this.controlContainer)}checkCornerOverlap(){const t=window.MutationObserver;if(t)for(const r of Object.keys(this.controlCorners)){const n=r.match(/^(top|bottom)(left|right)$/);if(n){const[,i,a]=n,o=this.controlCorners[`${i}${a}`];new t(([{target:l}])=>{o&&(o.style[i]=l.clientHeight+"px")}).observe(this.controlCorners[`${a}${i}`],{childList:!0,attributes:!0})}}}}class hIt{constructor(){z(this,"container",void 0),z(this,"scene",void 0),z(this,"mapsService",void 0),z(this,"markers",[]),z(this,"markerLayers",[]),z(this,"unAddMarkers",[]),z(this,"unAddMarkerLayers",[])}addMarkerLayer(t){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(t),t.addTo(this.scene)):this.unAddMarkerLayers.push(t)}removeMarkerLayer(t){t.destroy(),this.markerLayers.indexOf(t);const r=this.markerLayers.indexOf(t);r>-1&&this.markerLayers.splice(r,1)}addMarker(t){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(t),t.addTo(this.scene)):this.unAddMarkers.push(t)}addMarkers(){this.unAddMarkers.forEach(t=>{t.addTo(this.scene),this.markers.push(t)}),this.unAddMarkers=[]}addMarkerLayers(){this.unAddMarkerLayers.forEach(t=>{this.markerLayers.push(t),t.addTo(this.scene)}),this.unAddMarkers=[]}removeMarker(t){t.remove(),this.markers.indexOf(t);const r=this.markers.indexOf(t);r>-1&&this.markers.splice(r,1)}removeAllMarkers(){this.destroy()}init(t){this.scene=t,this.mapsService=t.mapService}destroy(){this.markers.forEach(t=>{t.remove()}),this.markers=[],this.markerLayers.forEach(t=>{t.destroy()}),this.markerLayers=[]}removeMakerLayerMarker(t){t.destroy()}}class fIt{constructor(){z(this,"scene",void 0),z(this,"mapsService",void 0),z(this,"popups",[]),z(this,"unAddPopups",[])}get isMarkerReady(){return this.mapsService.map&&this.mapsService.getMarkerContainer()}removePopup(t){t!=null&&t.isOpen()&&t.remove();const r=this.popups.indexOf(t);r>-1&&this.popups.splice(r,1);const n=this.unAddPopups.indexOf(t);n>-1&&this.unAddPopups.splice(n,1)}destroy(){this.popups.forEach(t=>t.remove())}addPopup(t){t&&t.getOptions().autoClose&&[...this.popups,...this.unAddPopups].forEach(r=>{r.getOptions().autoClose&&this.removePopup(r)}),this.isMarkerReady?(t.addTo(this.scene),this.popups.push(t)):this.unAddPopups.push(t),t.on("close",()=>{this.removePopup(t)})}initPopup(){this.unAddPopups.length&&this.unAddPopups.forEach(t=>{this.addPopup(t),this.unAddPopups=[]})}init(t){this.scene=t,this.mapsService=t.mapService}}const dIt={MapToken:"您正在使用 Demo 测试 Token, 生产环境务必自行注册 Token 确保服务稳定 高德地图申请地址 https://lbs.amap.com/api/javascript-api/guide/abc/prepare  Mapbox地图申请地址 https://docs.mapbox.com/help/glossary/access-token/",SDK:"请确认引入了mapbox-gl api且在L7之前引入"},{merge:pIt}=is,vIt={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,stencil:!0,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},gIt={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",maskLayers:[],enableMask:!0,maskOperation:lI.AND,pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",activeMix:0,selectColor:"blue",selectMix:0,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15},forward:!0};class mIt{constructor(){z(this,"sceneConfigCache",{}),z(this,"layerConfigCache",{}),z(this,"layerAttributeConfigCache",{})}getSceneConfig(t){return this.sceneConfigCache[t]}getSceneWarninfo(t){return dIt[t]}setSceneConfig(t,r){this.sceneConfigCache[t]=Ce(Ce({},vIt),r)}getLayerConfig(t){return this.layerConfigCache[t]}setLayerConfig(t,r,n){this.layerConfigCache[r]=Ce({},pIt({},this.sceneConfigCache[t],gIt,n))}getAttributeConfig(t){return this.layerAttributeConfigCache[t]}setAttributeConfig(t,r){this.layerAttributeConfigCache[t]=Ce(Ce({},this.layerAttributeConfigCache[t]),r)}clean(){this.sceneConfigCache={},this.layerConfigCache={}}}const uO=Math.PI/180,yIt=512,yU=4003e4;function _U({latitude:e=0,zoom:t=0,scale:r,highPrecision:n=!1,flipY:i=!1}){r=r!==void 0?r:Math.pow(2,t);const a={},o=yIt*r,s=Math.cos(e*uO),l=o/360,u=l/s,c=o/yU/s;if(a.pixelsPerMeter=[c,-c,c],a.metersPerPixel=[1/c,-1/c,1/c],a.pixelsPerDegree=[l,-u,c],a.degreesPerPixel=[1/l,-1/u,1/c],n){const f=uO*Math.tan(e*uO)/s,d=l*f/2,v=o/yU*f,g=v/u*c;a.pixelsPerDegree2=[0,-d,v],a.pixelsPerMeter2=[g,0,g],i&&(a.pixelsPerDegree2[1]=-a.pixelsPerDegree2[1],a.pixelsPerMeter2[1]=-a.pixelsPerMeter2[1])}return i&&(a.pixelsPerMeter[1]=-a.pixelsPerMeter[1],a.metersPerPixel[1]=-a.metersPerPixel[1],a.pixelsPerDegree[1]=-a.pixelsPerDegree[1],a.degreesPerPixel[1]=-a.degreesPerPixel[1]),a}const _It=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];class xIt{constructor(t){z(this,"needRefresh",!0),z(this,"coordinateSystem",void 0),z(this,"viewportCenter",void 0),z(this,"viewportCenterProjection",void 0),z(this,"pixelsPerDegree",void 0),z(this,"pixelsPerDegree2",void 0),z(this,"pixelsPerMeter",void 0),this.cameraService=t}refresh(t){const r=this.cameraService.getZoom(),n=t||this.cameraService.getCenter(),{pixelsPerMeter:i,pixelsPerDegree:a}=_U({latitude:n[1],zoom:r});this.viewportCenter=n,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=i,this.pixelsPerDegree=a,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===Ox.LNGLAT?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===Ox.LNGLAT_OFFSET&&this.calculateLnglatOffset(n,r),this.needRefresh=!1}getCoordinateSystem(){return this.coordinateSystem}setCoordinateSystem(t){this.coordinateSystem=t}getViewportCenter(){return this.viewportCenter}getViewportCenterProjection(){return this.viewportCenterProjection}getPixelsPerDegree(){return this.pixelsPerDegree}getPixelsPerDegree2(){return this.pixelsPerDegree2}getPixelsPerMeter(){return this.pixelsPerMeter}calculateLnglatOffset(t,r,n,i){const{pixelsPerMeter:a,pixelsPerDegree:o,pixelsPerDegree2:s}=_U({latitude:t[1],zoom:r,scale:n,flipY:i,highPrecision:!0});let l=this.cameraService.getViewMatrix();const u=this.cameraService.getProjectionMatrix();let c=Dm([],u,l);const f=this.cameraService.projectFlat([Math.fround(t[0]),Math.fround(t[1])],Math.pow(2,r));this.viewportCenterProjection=bm([],[f[0],f[1],0,1],c),l=this.cameraService.getViewMatrixUncentered()||l,c=Dm([],u,l),c=Dm([],c,_It),this.cameraService.setViewProjectionMatrix(c),this.pixelsPerMeter=a,this.pixelsPerDegree=o,this.pixelsPerDegree2=s}}class bIt extends $u.EventEmitter{constructor(...t){super(...t),z(this,"renderMap",new Map),z(this,"enable",!1),z(this,"renderEnable",!1),z(this,"cacheLogs",{})}setEnable(t){this.enable=!!t}log(t,r){if(!this.enable)return;const n=t.split(".");let i=null;n.forEach((a,o)=>{i!==null?(i[a]||(i[a]={}),o!==n.length-1&&(i=i[a])):(this.cacheLogs[a]||(this.cacheLogs[a]={}),o!==n.length-1&&(i=this.cacheLogs[a])),o===n.length-1&&(i[a]=Ce(Ce({time:Date.now()},i[a]),r))})}getLog(t){switch(typeof t){case"string":return this.cacheLogs[t];case"object":return t.map(r=>this.cacheLogs[r]).filter(r=>r!==void 0);case"undefined":return this.cacheLogs}}removeLog(t){delete this.cacheLogs[t]}generateRenderUid(){return this.renderEnable?RTt():""}renderDebug(t){this.renderEnable=t}renderStart(t){if(!this.renderEnable||!this.enable)return;const r=this.renderMap.get(t)||{};this.renderMap.set(t,Ce(Ce({},r),{},{renderUid:t,renderStart:Date.now()}))}renderEnd(t){if(!this.renderEnable||!this.enable)return;const r=this.renderMap.get(t);if(r){const n=r.renderStart,i=Date.now();this.emit("renderEnd",Ce(Ce({},r),{},{renderEnd:i,renderDuration:i-n})),this.renderMap.delete(t)}}destroy(){this.cacheLogs=null,this.renderMap.clear()}}var $K={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(e){(function(t,r,n,i){var a=["","webkit","Moz","MS","ms","o"],o=r.createElement("div"),s="function",l=Math.round,u=Math.abs,c=Date.now;function f(ot,vt,Vt){return setTimeout(M(ot,Vt),vt)}function d(ot,vt,Vt){return Array.isArray(ot)?(v(ot,Vt[vt],Vt),!0):!1}function v(ot,vt,Vt){var me;if(ot)if(ot.forEach)ot.forEach(vt,Vt);else if(ot.length!==i)for(me=0;me<ot.length;)vt.call(Vt,ot[me],me,ot),me++;else for(me in ot)ot.hasOwnProperty(me)&&vt.call(Vt,ot[me],me,ot)}function g(ot,vt,Vt){var me="DEPRECATED METHOD: "+vt+`
`+Vt+` AT 
`;return function(){var ur=new Error("get-stack-trace"),rn=ur&&ur.stack?ur.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Ri=t.console&&(t.console.warn||t.console.log);return Ri&&Ri.call(t.console,me,rn),ot.apply(this,arguments)}}var x;typeof Object.assign!="function"?x=function(vt){if(vt===i||vt===null)throw new TypeError("Cannot convert undefined or null to object");for(var Vt=Object(vt),me=1;me<arguments.length;me++){var ur=arguments[me];if(ur!==i&&ur!==null)for(var rn in ur)ur.hasOwnProperty(rn)&&(Vt[rn]=ur[rn])}return Vt}:x=Object.assign;var w=g(function(vt,Vt,me){for(var ur=Object.keys(Vt),rn=0;rn<ur.length;)(!me||me&&vt[ur[rn]]===i)&&(vt[ur[rn]]=Vt[ur[rn]]),rn++;return vt},"extend","Use `assign`."),S=g(function(vt,Vt){return w(vt,Vt,!0)},"merge","Use `assign`.");function A(ot,vt,Vt){var me=vt.prototype,ur;ur=ot.prototype=Object.create(me),ur.constructor=ot,ur._super=me,Vt&&x(ur,Vt)}function M(ot,vt){return function(){return ot.apply(vt,arguments)}}function R(ot,vt){return typeof ot==s?ot.apply(vt&&vt[0]||i,vt):ot}function O(ot,vt){return ot===i?vt:ot}function N(ot,vt,Vt){v(Y(vt),function(me){ot.addEventListener(me,Vt,!1)})}function k(ot,vt,Vt){v(Y(vt),function(me){ot.removeEventListener(me,Vt,!1)})}function V(ot,vt){for(;ot;){if(ot==vt)return!0;ot=ot.parentNode}return!1}function Q(ot,vt){return ot.indexOf(vt)>-1}function Y(ot){return ot.trim().split(/\s+/g)}function X(ot,vt,Vt){if(ot.indexOf&&!Vt)return ot.indexOf(vt);for(var me=0;me<ot.length;){if(Vt&&ot[me][Vt]==vt||!Vt&&ot[me]===vt)return me;me++}return-1}function tt(ot){return Array.prototype.slice.call(ot,0)}function it(ot,vt,Vt){for(var me=[],ur=[],rn=0;rn<ot.length;){var Ri=vt?ot[rn][vt]:ot[rn];X(ur,Ri)<0&&me.push(ot[rn]),ur[rn]=Ri,rn++}return Vt&&(vt?me=me.sort(function(cs,Vo){return cs[vt]>Vo[vt]}):me=me.sort()),me}function Et(ot,vt){for(var Vt,me,ur=vt[0].toUpperCase()+vt.slice(1),rn=0;rn<a.length;){if(Vt=a[rn],me=Vt?Vt+ur:vt,me in ot)return me;rn++}return i}var Tt=1;function pt(){return Tt++}function kt(ot){var vt=ot.ownerDocument||ot;return vt.defaultView||vt.parentWindow||t}var ae=/mobile|tablet|ip(ad|hone|od)|android/i,Kt="ontouchstart"in t,re=Et(t,"PointerEvent")!==i,fe=Kt&&ae.test(navigator.userAgent),Oe="touch",Ye="pen",Be="mouse",De="kinect",Yr=25,Gr=1,Mn=2,ee=4,rr=8,Nr=1,Fe=2,Hr=4,_n=8,Kn=16,vn=Fe|Hr,xn=_n|Kn,ui=vn|xn,Ao=["x","y"],ta=["clientX","clientY"];function oa(ot,vt){var Vt=this;this.manager=ot,this.callback=vt,this.element=ot.element,this.target=ot.options.inputTarget,this.domHandler=function(me){R(ot.options.enable,[ot])&&Vt.handler(me)},this.init()}oa.prototype={handler:function(){},init:function(){this.evEl&&N(this.element,this.evEl,this.domHandler),this.evTarget&&N(this.target,this.evTarget,this.domHandler),this.evWin&&N(kt(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&k(this.element,this.evEl,this.domHandler),this.evTarget&&k(this.target,this.evTarget,this.domHandler),this.evWin&&k(kt(this.element),this.evWin,this.domHandler)}};function as(ot){var vt,Vt=ot.options.inputClass;return Vt?vt=Vt:re?vt=pc:fe?vt=Xt:Kt?vt=oe:vt=sh,new vt(ot,bt)}function bt(ot,vt,Vt){var me=Vt.pointers.length,ur=Vt.changedPointers.length,rn=vt&Gr&&me-ur===0,Ri=vt&(ee|rr)&&me-ur===0;Vt.isFirst=!!rn,Vt.isFinal=!!Ri,rn&&(ot.session={}),Vt.eventType=vt,os(ot,Vt),ot.emit("hammer.input",Vt),ot.recognize(Vt),ot.session.prevInput=Vt}function os(ot,vt){var Vt=ot.session,me=vt.pointers,ur=me.length;Vt.firstInput||(Vt.firstInput=Vu(vt)),ur>1&&!Vt.firstMultiple?Vt.firstMultiple=Vu(vt):ur===1&&(Vt.firstMultiple=!1);var rn=Vt.firstInput,Ri=Vt.firstMultiple,xo=Ri?Ri.center:rn.center,cs=vt.center=va(me);vt.timeStamp=c(),vt.deltaTime=vt.timeStamp-rn.timeStamp,vt.angle=dc(xo,cs),vt.distance=us(xo,cs),gu(Vt,vt),vt.offsetDirection=il(vt.deltaX,vt.deltaY);var Vo=ls(vt.deltaTime,vt.deltaX,vt.deltaY);vt.overallVelocityX=Vo.x,vt.overallVelocityY=Vo.y,vt.overallVelocity=u(Vo.x)>u(Vo.y)?Vo.x:Vo.y,vt.scale=Ri?Gu(Ri.pointers,me):1,vt.rotation=Ri?fo(Ri.pointers,me):0,vt.maxPointers=Vt.prevInput?vt.pointers.length>Vt.prevInput.maxPointers?vt.pointers.length:Vt.prevInput.maxPointers:vt.pointers.length,ss(Vt,vt);var yu=ot.element;V(vt.srcEvent.target,yu)&&(yu=vt.srcEvent.target),vt.target=yu}function gu(ot,vt){var Vt=vt.center,me=ot.offsetDelta||{},ur=ot.prevDelta||{},rn=ot.prevInput||{};(vt.eventType===Gr||rn.eventType===ee)&&(ur=ot.prevDelta={x:rn.deltaX||0,y:rn.deltaY||0},me=ot.offsetDelta={x:Vt.x,y:Vt.y}),vt.deltaX=ur.x+(Vt.x-me.x),vt.deltaY=ur.y+(Vt.y-me.y)}function ss(ot,vt){var Vt=ot.lastInterval||vt,me=vt.timeStamp-Vt.timeStamp,ur,rn,Ri,xo;if(vt.eventType!=rr&&(me>Yr||Vt.velocity===i)){var cs=vt.deltaX-Vt.deltaX,Vo=vt.deltaY-Vt.deltaY,yu=ls(me,cs,Vo);rn=yu.x,Ri=yu.y,ur=u(yu.x)>u(yu.y)?yu.x:yu.y,xo=il(cs,Vo),ot.lastInterval=vt}else ur=Vt.velocity,rn=Vt.velocityX,Ri=Vt.velocityY,xo=Vt.direction;vt.velocity=ur,vt.velocityX=rn,vt.velocityY=Ri,vt.direction=xo}function Vu(ot){for(var vt=[],Vt=0;Vt<ot.pointers.length;)vt[Vt]={clientX:l(ot.pointers[Vt].clientX),clientY:l(ot.pointers[Vt].clientY)},Vt++;return{timeStamp:c(),pointers:vt,center:va(vt),deltaX:ot.deltaX,deltaY:ot.deltaY}}function va(ot){var vt=ot.length;if(vt===1)return{x:l(ot[0].clientX),y:l(ot[0].clientY)};for(var Vt=0,me=0,ur=0;ur<vt;)Vt+=ot[ur].clientX,me+=ot[ur].clientY,ur++;return{x:l(Vt/vt),y:l(me/vt)}}function ls(ot,vt,Vt){return{x:vt/ot||0,y:Vt/ot||0}}function il(ot,vt){return ot===vt?Nr:u(ot)>=u(vt)?ot<0?Fe:Hr:vt<0?_n:Kn}function us(ot,vt,Vt){Vt||(Vt=Ao);var me=vt[Vt[0]]-ot[Vt[0]],ur=vt[Vt[1]]-ot[Vt[1]];return Math.sqrt(me*me+ur*ur)}function dc(ot,vt,Vt){Vt||(Vt=Ao);var me=vt[Vt[0]]-ot[Vt[0]],ur=vt[Vt[1]]-ot[Vt[1]];return Math.atan2(ur,me)*180/Math.PI}function fo(ot,vt){return dc(vt[1],vt[0],ta)+dc(ot[1],ot[0],ta)}function Gu(ot,vt){return us(vt[0],vt[1],ta)/us(ot[0],ot[1],ta)}var Cl={mousedown:Gr,mousemove:Mn,mouseup:ee},oh="mousedown",nd="mousemove mouseup";function sh(){this.evEl=oh,this.evWin=nd,this.pressed=!1,oa.apply(this,arguments)}A(sh,oa,{handler:function(vt){var Vt=Cl[vt.type];Vt&Gr&&vt.button===0&&(this.pressed=!0),Vt&Mn&&vt.which!==1&&(Vt=ee),this.pressed&&(Vt&ee&&(this.pressed=!1),this.callback(this.manager,Vt,{pointers:[vt],changedPointers:[vt],pointerType:Be,srcEvent:vt}))}});var Jd={pointerdown:Gr,pointermove:Mn,pointerup:ee,pointercancel:rr,pointerout:rr},lh={2:Oe,3:Ye,4:Be,5:De},jl="pointerdown",Yl="pointermove pointerup pointercancel";t.MSPointerEvent&&!t.PointerEvent&&(jl="MSPointerDown",Yl="MSPointerMove MSPointerUp MSPointerCancel");function pc(){this.evEl=jl,this.evWin=Yl,oa.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}A(pc,oa,{handler:function(vt){var Vt=this.store,me=!1,ur=vt.type.toLowerCase().replace("ms",""),rn=Jd[ur],Ri=lh[vt.pointerType]||vt.pointerType,xo=Ri==Oe,cs=X(Vt,vt.pointerId,"pointerId");rn&Gr&&(vt.button===0||xo)?cs<0&&(Vt.push(vt),cs=Vt.length-1):rn&(ee|rr)&&(me=!0),!(cs<0)&&(Vt[cs]=vt,this.callback(this.manager,rn,{pointers:Vt,changedPointers:[vt],pointerType:Ri,srcEvent:vt}),me&&Vt.splice(cs,1))}});var id={touchstart:Gr,touchmove:Mn,touchend:ee,touchcancel:rr},$i="touchstart",J="touchstart touchmove touchend touchcancel";function rt(){this.evTarget=$i,this.evWin=J,this.started=!1,oa.apply(this,arguments)}A(rt,oa,{handler:function(vt){var Vt=id[vt.type];if(Vt===Gr&&(this.started=!0),!!this.started){var me=at.call(this,vt,Vt);Vt&(ee|rr)&&me[0].length-me[1].length===0&&(this.started=!1),this.callback(this.manager,Vt,{pointers:me[0],changedPointers:me[1],pointerType:Oe,srcEvent:vt})}}});function at(ot,vt){var Vt=tt(ot.touches),me=tt(ot.changedTouches);return vt&(ee|rr)&&(Vt=it(Vt.concat(me),"identifier",!0)),[Vt,me]}var mt={touchstart:Gr,touchmove:Mn,touchend:ee,touchcancel:rr},Mt="touchstart touchmove touchend touchcancel";function Xt(){this.evTarget=Mt,this.targetIds={},oa.apply(this,arguments)}A(Xt,oa,{handler:function(vt){var Vt=mt[vt.type],me=Qt.call(this,vt,Vt);me&&this.callback(this.manager,Vt,{pointers:me[0],changedPointers:me[1],pointerType:Oe,srcEvent:vt})}});function Qt(ot,vt){var Vt=tt(ot.touches),me=this.targetIds;if(vt&(Gr|Mn)&&Vt.length===1)return me[Vt[0].identifier]=!0,[Vt,Vt];var ur,rn,Ri=tt(ot.changedTouches),xo=[],cs=this.target;if(rn=Vt.filter(function(Vo){return V(Vo.target,cs)}),vt===Gr)for(ur=0;ur<rn.length;)me[rn[ur].identifier]=!0,ur++;for(ur=0;ur<Ri.length;)me[Ri[ur].identifier]&&xo.push(Ri[ur]),vt&(ee|rr)&&delete me[Ri[ur].identifier],ur++;if(xo.length)return[it(rn.concat(xo),"identifier",!0),xo]}var ct=2500,Pt=25;function oe(){oa.apply(this,arguments);var ot=M(this.handler,this);this.touch=new Xt(this.manager,ot),this.mouse=new sh(this.manager,ot),this.primaryTouch=null,this.lastTouches=[]}A(oe,oa,{handler:function(vt,Vt,me){var ur=me.pointerType==Oe,rn=me.pointerType==Be;if(!(rn&&me.sourceCapabilities&&me.sourceCapabilities.firesTouchEvents)){if(ur)Le.call(this,Vt,me);else if(rn&&Te.call(this,me))return;this.callback(vt,Vt,me)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function Le(ot,vt){ot&Gr?(this.primaryTouch=vt.changedPointers[0].identifier,tr.call(this,vt)):ot&(ee|rr)&&tr.call(this,vt)}function tr(ot){var vt=ot.changedPointers[0];if(vt.identifier===this.primaryTouch){var Vt={x:vt.clientX,y:vt.clientY};this.lastTouches.push(Vt);var me=this.lastTouches,ur=function(){var rn=me.indexOf(Vt);rn>-1&&me.splice(rn,1)};setTimeout(ur,ct)}}function Te(ot){for(var vt=ot.srcEvent.clientX,Vt=ot.srcEvent.clientY,me=0;me<this.lastTouches.length;me++){var ur=this.lastTouches[me],rn=Math.abs(vt-ur.x),Ri=Math.abs(Vt-ur.y);if(rn<=Pt&&Ri<=Pt)return!0}return!1}var Ze=Et(o.style,"touchAction"),jr=Ze!==i,Ur="compute",Re="auto",Ar="manipulation",dr="none",gr="pan-x",kn="pan-y",wr=ai();function ci(ot,vt){this.manager=ot,this.set(vt)}ci.prototype={set:function(ot){ot==Ur&&(ot=this.compute()),jr&&this.manager.element.style&&wr[ot]&&(this.manager.element.style[Ze]=ot),this.actions=ot.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var ot=[];return v(this.manager.recognizers,function(vt){R(vt.options.enable,[vt])&&(ot=ot.concat(vt.getTouchAction()))}),ea(ot.join(" "))},preventDefaults:function(ot){var vt=ot.srcEvent,Vt=ot.offsetDirection;if(this.manager.session.prevented){vt.preventDefault();return}var me=this.actions,ur=Q(me,dr)&&!wr[dr],rn=Q(me,kn)&&!wr[kn],Ri=Q(me,gr)&&!wr[gr];if(ur){var xo=ot.pointers.length===1,cs=ot.distance<2,Vo=ot.deltaTime<250;if(xo&&cs&&Vo)return}if(!(Ri&&rn)&&(ur||rn&&Vt&vn||Ri&&Vt&xn))return this.preventSrc(vt)},preventSrc:function(ot){this.manager.session.prevented=!0,ot.preventDefault()}};function ea(ot){if(Q(ot,dr))return dr;var vt=Q(ot,gr),Vt=Q(ot,kn);return vt&&Vt?dr:vt||Vt?vt?gr:kn:Q(ot,Ar)?Ar:Re}function ai(){if(!jr)return!1;var ot={},vt=t.CSS&&t.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Vt){ot[Vt]=vt?t.CSS.supports("touch-action",Vt):!0}),ot}var wi=1,zn=2,po=4,pi=8,ra=pi,Di=16,Un=32;function oi(ot){this.options=x({},this.defaults,ot||{}),this.id=pt(),this.manager=null,this.options.enable=O(this.options.enable,!0),this.state=wi,this.simultaneous={},this.requireFail=[]}oi.prototype={defaults:{},set:function(ot){return x(this.options,ot),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(ot){if(d(ot,"recognizeWith",this))return this;var vt=this.simultaneous;return ot=eo(ot,this),vt[ot.id]||(vt[ot.id]=ot,ot.recognizeWith(this)),this},dropRecognizeWith:function(ot){return d(ot,"dropRecognizeWith",this)?this:(ot=eo(ot,this),delete this.simultaneous[ot.id],this)},requireFailure:function(ot){if(d(ot,"requireFailure",this))return this;var vt=this.requireFail;return ot=eo(ot,this),X(vt,ot)===-1&&(vt.push(ot),ot.requireFailure(this)),this},dropRequireFailure:function(ot){if(d(ot,"dropRequireFailure",this))return this;ot=eo(ot,this);var vt=X(this.requireFail,ot);return vt>-1&&this.requireFail.splice(vt,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(ot){return!!this.simultaneous[ot.id]},emit:function(ot){var vt=this,Vt=this.state;function me(ur){vt.manager.emit(ur,ot)}Vt<pi&&me(vt.options.event+Es(Vt)),me(vt.options.event),ot.additionalEvent&&me(ot.additionalEvent),Vt>=pi&&me(vt.options.event+Es(Vt))},tryEmit:function(ot){if(this.canEmit())return this.emit(ot);this.state=Un},canEmit:function(){for(var ot=0;ot<this.requireFail.length;){if(!(this.requireFail[ot].state&(Un|wi)))return!1;ot++}return!0},recognize:function(ot){var vt=x({},ot);if(!R(this.options.enable,[this,vt])){this.reset(),this.state=Un;return}this.state&(ra|Di|Un)&&(this.state=wi),this.state=this.process(vt),this.state&(zn|po|pi|Di)&&this.tryEmit(vt)},process:function(ot){},getTouchAction:function(){},reset:function(){}};function Es(ot){return ot&Di?"cancel":ot&pi?"end":ot&po?"move":ot&zn?"start":""}function qh(ot){return ot==Kn?"down":ot==_n?"up":ot==Fe?"left":ot==Hr?"right":""}function eo(ot,vt){var Vt=vt.manager;return Vt?Vt.get(ot):ot}function Da(){oi.apply(this,arguments)}A(Da,oi,{defaults:{pointers:1},attrTest:function(ot){var vt=this.options.pointers;return vt===0||ot.pointers.length===vt},process:function(ot){var vt=this.state,Vt=ot.eventType,me=vt&(zn|po),ur=this.attrTest(ot);return me&&(Vt&rr||!ur)?vt|Di:me||ur?Vt&ee?vt|pi:vt&zn?vt|po:zn:Un}});function Kh(){Da.apply(this,arguments),this.pX=null,this.pY=null}A(Kh,Da,{defaults:{event:"pan",threshold:10,pointers:1,direction:ui},getTouchAction:function(){var ot=this.options.direction,vt=[];return ot&vn&&vt.push(kn),ot&xn&&vt.push(gr),vt},directionTest:function(ot){var vt=this.options,Vt=!0,me=ot.distance,ur=ot.direction,rn=ot.deltaX,Ri=ot.deltaY;return ur&vt.direction||(vt.direction&vn?(ur=rn===0?Nr:rn<0?Fe:Hr,Vt=rn!=this.pX,me=Math.abs(ot.deltaX)):(ur=Ri===0?Nr:Ri<0?_n:Kn,Vt=Ri!=this.pY,me=Math.abs(ot.deltaY))),ot.direction=ur,Vt&&me>vt.threshold&&ur&vt.direction},attrTest:function(ot){return Da.prototype.attrTest.call(this,ot)&&(this.state&zn||!(this.state&zn)&&this.directionTest(ot))},emit:function(ot){this.pX=ot.deltaX,this.pY=ot.deltaY;var vt=qh(ot.direction);vt&&(ot.additionalEvent=this.options.event+vt),this._super.emit.call(this,ot)}});function mu(){Da.apply(this,arguments)}A(mu,Da,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[dr]},attrTest:function(ot){return this._super.attrTest.call(this,ot)&&(Math.abs(ot.scale-1)>this.options.threshold||this.state&zn)},emit:function(ot){if(ot.scale!==1){var vt=ot.scale<1?"in":"out";ot.additionalEvent=this.options.event+vt}this._super.emit.call(this,ot)}});function Ma(){oi.apply(this,arguments),this._timer=null,this._input=null}A(Ma,oi,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Re]},process:function(ot){var vt=this.options,Vt=ot.pointers.length===vt.pointers,me=ot.distance<vt.threshold,ur=ot.deltaTime>vt.time;if(this._input=ot,!me||!Vt||ot.eventType&(ee|rr)&&!ur)this.reset();else if(ot.eventType&Gr)this.reset(),this._timer=f(function(){this.state=ra,this.tryEmit()},vt.time,this);else if(ot.eventType&ee)return ra;return Un},reset:function(){clearTimeout(this._timer)},emit:function(ot){this.state===ra&&(ot&&ot.eventType&ee?this.manager.emit(this.options.event+"up",ot):(this._input.timeStamp=c(),this.manager.emit(this.options.event,this._input)))}});function uh(){Da.apply(this,arguments)}A(uh,Da,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[dr]},attrTest:function(ot){return this._super.attrTest.call(this,ot)&&(Math.abs(ot.rotation)>this.options.threshold||this.state&zn)}});function Ho(){Da.apply(this,arguments)}A(Ho,Da,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:vn|xn,pointers:1},getTouchAction:function(){return Kh.prototype.getTouchAction.call(this)},attrTest:function(ot){var vt=this.options.direction,Vt;return vt&(vn|xn)?Vt=ot.overallVelocity:vt&vn?Vt=ot.overallVelocityX:vt&xn&&(Vt=ot.overallVelocityY),this._super.attrTest.call(this,ot)&&vt&ot.offsetDirection&&ot.distance>this.options.threshold&&ot.maxPointers==this.options.pointers&&u(Vt)>this.options.velocity&&ot.eventType&ee},emit:function(ot){var vt=qh(ot.offsetDirection);vt&&this.manager.emit(this.options.event+vt,ot),this.manager.emit(this.options.event,ot)}});function Ra(){oi.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}A(Ra,oi,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Ar]},process:function(ot){var vt=this.options,Vt=ot.pointers.length===vt.pointers,me=ot.distance<vt.threshold,ur=ot.deltaTime<vt.time;if(this.reset(),ot.eventType&Gr&&this.count===0)return this.failTimeout();if(me&&ur&&Vt){if(ot.eventType!=ee)return this.failTimeout();var rn=this.pTime?ot.timeStamp-this.pTime<vt.interval:!0,Ri=!this.pCenter||us(this.pCenter,ot.center)<vt.posThreshold;this.pTime=ot.timeStamp,this.pCenter=ot.center,!Ri||!rn?this.count=1:this.count+=1,this._input=ot;var xo=this.count%vt.taps;if(xo===0)return this.hasRequireFailures()?(this._timer=f(function(){this.state=ra,this.tryEmit()},vt.interval,this),zn):ra}return Un},failTimeout:function(){return this._timer=f(function(){this.state=Un},this.options.interval,this),Un},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==ra&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function ro(ot,vt){return vt=vt||{},vt.recognizers=O(vt.recognizers,ro.defaults.preset),new Ds(ot,vt)}ro.VERSION="2.0.7",ro.defaults={domEvents:!1,touchAction:Ur,enable:!0,inputTarget:null,inputClass:null,preset:[[uh,{enable:!1}],[mu,{enable:!1},["rotate"]],[Ho,{direction:vn}],[Kh,{direction:vn},["swipe"]],[Ra],[Ra,{event:"doubletap",taps:2},["tap"]],[Ma]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var ga=1,Xs=2;function Ds(ot,vt){this.options=x({},ro.defaults,vt||{}),this.options.inputTarget=this.options.inputTarget||ot,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=ot,this.input=as(this),this.touchAction=new ci(this,this.options.touchAction),uv(this,!0),v(this.options.recognizers,function(Vt){var me=this.add(new Vt[0](Vt[1]));Vt[2]&&me.recognizeWith(Vt[2]),Vt[3]&&me.requireFailure(Vt[3])},this)}Ds.prototype={set:function(ot){return x(this.options,ot),ot.touchAction&&this.touchAction.update(),ot.inputTarget&&(this.input.destroy(),this.input.target=ot.inputTarget,this.input.init()),this},stop:function(ot){this.session.stopped=ot?Xs:ga},recognize:function(ot){var vt=this.session;if(!vt.stopped){this.touchAction.preventDefaults(ot);var Vt,me=this.recognizers,ur=vt.curRecognizer;(!ur||ur&&ur.state&ra)&&(ur=vt.curRecognizer=null);for(var rn=0;rn<me.length;)Vt=me[rn],vt.stopped!==Xs&&(!ur||Vt==ur||Vt.canRecognizeWith(ur))?Vt.recognize(ot):Vt.reset(),!ur&&Vt.state&(zn|po|pi)&&(ur=vt.curRecognizer=Vt),rn++}},get:function(ot){if(ot instanceof oi)return ot;for(var vt=this.recognizers,Vt=0;Vt<vt.length;Vt++)if(vt[Vt].options.event==ot)return vt[Vt];return null},add:function(ot){if(d(ot,"add",this))return this;var vt=this.get(ot.options.event);return vt&&this.remove(vt),this.recognizers.push(ot),ot.manager=this,this.touchAction.update(),ot},remove:function(ot){if(d(ot,"remove",this))return this;if(ot=this.get(ot),ot){var vt=this.recognizers,Vt=X(vt,ot);Vt!==-1&&(vt.splice(Vt,1),this.touchAction.update())}return this},on:function(ot,vt){if(ot!==i&&vt!==i){var Vt=this.handlers;return v(Y(ot),function(me){Vt[me]=Vt[me]||[],Vt[me].push(vt)}),this}},off:function(ot,vt){if(ot!==i){var Vt=this.handlers;return v(Y(ot),function(me){vt?Vt[me]&&Vt[me].splice(X(Vt[me],vt),1):delete Vt[me]}),this}},emit:function(ot,vt){this.options.domEvents&&Sl(ot,vt);var Vt=this.handlers[ot]&&this.handlers[ot].slice();if(!(!Vt||!Vt.length)){vt.type=ot,vt.preventDefault=function(){vt.srcEvent.preventDefault()};for(var me=0;me<Vt.length;)Vt[me](vt),me++}},destroy:function(){this.element&&uv(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function uv(ot,vt){var Vt=ot.element;if(Vt.style){var me;v(ot.options.cssProps,function(ur,rn){me=Et(Vt.style,rn),vt?(ot.oldCssProps[me]=Vt.style[me],Vt.style[me]=ur):Vt.style[me]=ot.oldCssProps[me]||""}),vt||(ot.oldCssProps={})}}function Sl(ot,vt){var Vt=r.createEvent("Event");Vt.initEvent(ot,!0,!0),Vt.gesture=vt,vt.target.dispatchEvent(Vt)}x(ro,{INPUT_START:Gr,INPUT_MOVE:Mn,INPUT_END:ee,INPUT_CANCEL:rr,STATE_POSSIBLE:wi,STATE_BEGAN:zn,STATE_CHANGED:po,STATE_ENDED:pi,STATE_RECOGNIZED:ra,STATE_CANCELLED:Di,STATE_FAILED:Un,DIRECTION_NONE:Nr,DIRECTION_LEFT:Fe,DIRECTION_RIGHT:Hr,DIRECTION_UP:_n,DIRECTION_DOWN:Kn,DIRECTION_HORIZONTAL:vn,DIRECTION_VERTICAL:xn,DIRECTION_ALL:ui,Manager:Ds,Input:oa,TouchAction:ci,TouchInput:Xt,MouseInput:sh,PointerEventInput:pc,TouchMouseInput:oe,SingleTouchInput:rt,Recognizer:oi,AttrRecognizer:Da,Tap:Ra,Pan:Kh,Swipe:Ho,Pinch:mu,Rotate:uh,Press:Ma,on:N,off:k,each:v,merge:S,extend:w,assign:x,inherit:A,bindFn:M,prefixed:Et});var C0=typeof t<"u"?t:typeof self<"u"?self:{};C0.Hammer=ro,typeof i=="function"&&i.amd?i(function(){return ro}):e.exports?e.exports=ro:t[n]=ro})(window,document,"Hammer")})($K);var EIt=$K.exports;const TE=aa(EIt),wIt={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancel"};class CIt extends G5{get mapService(){return this.container.mapService}constructor(t){super(),z(this,"indragging",!1),z(this,"hammertime",void 0),z(this,"lastClickTime",0),z(this,"lastClickXY",[-1,-1]),z(this,"clickTimer",void 0),z(this,"$containter",void 0),z(this,"onDrag",r=>{const n=this.interactionEvent(r);n.type=wIt[n.type],n.type==="dragging"?this.indragging=!0:this.indragging=!1,this.emit(Bc.Drag,n)}),z(this,"onHammer",r=>{r.srcEvent.stopPropagation();const n=this.interactionEvent(r);this.emit(Bc.Hover,n)}),z(this,"onTouch",r=>{const n=r.touches[0];this.onHover({clientX:n.clientX,clientY:n.clientY,type:"touchstart"})}),z(this,"onTouchEnd",r=>{if(r.changedTouches.length>0){const n=r.changedTouches[0];this.onHover({clientX:n.clientX,clientY:n.clientY,type:"touchend"})}}),z(this,"onTouchMove",r=>{const n=r.changedTouches[0];this.onHover({clientX:n.clientX,clientY:n.clientY,type:"touchmove"})}),z(this,"onHover",r=>{const{clientX:n,clientY:i}=r;let a=n,o=i;const s=r.type,l=this.mapService.getMapContainer();if(l){const{top:c,left:f}=l.getBoundingClientRect();a=a-f-l.clientLeft,o=o-c-l.clientTop}const u=this.mapService.containerToLngLat([a,o]);if(s==="click"){this.isDoubleTap(a,o,u);return}if(s==="touch"){this.isDoubleTap(a,o,u);return}s!=="click"&&s!=="dblclick"&&this.emit(Bc.Hover,{x:a,y:o,lngLat:u,type:s,target:r})}),this.container=t}init(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}destroy(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(Bc.Hover)}triggerHover({x:t,y:r}){this.emit(Bc.Hover,{x:t,y:r})}triggerSelect(t){this.emit(Bc.Select,{featureId:t})}triggerActive(t){this.emit(Bc.Active,{featureId:t})}addEventListenerOnMap(){const t=this.mapService.getMapContainer();if(t){const r=new TE.Manager(t);r.add(new TE.Tap({event:"dblclick",taps:2})),r.add(new TE.Tap({event:"click"})),r.add(new TE.Pan({threshold:0,pointers:0})),r.add(new TE.Press({})),r.on("dblclick click",this.onHammer),r.on("panstart panmove panend pancancel",this.onDrag),t.addEventListener("touchstart",this.onTouch),t.addEventListener("touchend",this.onTouchEnd),t.addEventListener("mousemove",this.onHover),t.addEventListener("touchmove",this.onTouchMove),t.addEventListener("mousedown",this.onHover,!0),t.addEventListener("mouseup",this.onHover),t.addEventListener("contextmenu",this.onHover),this.hammertime=r}}removeEventListenerOnMap(){const t=this.mapService.getMapContainer();t&&(t.removeEventListener("mousemove",this.onHover),this.hammertime.off("dblclick click",this.onHammer),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),t.removeEventListener("touchstart",this.onTouch),t.removeEventListener("touchend",this.onTouchEnd),t.removeEventListener("mousedown",this.onHover),t.removeEventListener("mouseup",this.onHover),t.removeEventListener("contextmenu",this.onHover))}interactionEvent(t){const{type:r,pointerType:n}=t;let i,a;n==="touch"?(a=Math.floor(t.pointers[0].clientY),i=Math.floor(t.pointers[0].clientX)):(a=Math.floor(t.srcEvent.y),i=Math.floor(t.srcEvent.x));const o=this.mapService.getMapContainer();if(o){const{top:l,left:u}=o.getBoundingClientRect();i-=u,a-=l}const s=this.mapService.containerToLngLat([i,a]);return{x:i,y:a,lngLat:s,type:r,target:t.srcEvent}}isDoubleTap(t,r,n){const i=new Date().getTime();let a="click";i-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-t)<10&&Math.abs(this.lastClickXY[1]-r)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),a="dblclick",this.emit(Bc.Hover,{x:t,y:r,lngLat:n,type:a})):(this.lastClickTime=i,this.lastClickXY=[t,r],this.clickTimer=setTimeout(()=>{a="click",this.emit(Bc.Hover,{x:t,y:r,lngLat:n,type:a})},400))}}let SIt=0;function TIt(e){let t=e;if(typeof e=="string"&&(t=document.getElementById(e)),t){const r=document.createElement("div");return r.style.cssText+=`
      position: absolute;
      z-index:2;
      height: 100%;
      width: 100%;
      pointer-events: none;
    `,r.id=`l7-scene-${SIt++}`,r.classList.add("l7-scene"),t.appendChild(r),r}return null}function AIt(e){var t;let r=!0;if((e==null||(t=e.target)===null||t===void 0?void 0:t.target)instanceof HTMLElement){var n;let a=e==null||(n=e.target)===null||n===void 0?void 0:n.target;for(;a;){var i;const o=Array.from(a.classList);if(o.includes("l7-marker")||o.includes("l7-popup")){r=!1;break}a=(i=a)===null||i===void 0?void 0:i.parentElement}}return r}let jy=function(e){return e[e.SAMPLED=0]="SAMPLED",e[e.RENDER_TARGET=1]="RENDER_TARGET",e}({});class MIt{constructor(t){var r=this;z(this,"pickedColors",void 0),z(this,"pickedTileLayers",[]),z(this,"pickingFBO",void 0),z(this,"width",0),z(this,"height",0),z(this,"alreadyInPicking",!1),z(this,"pickBufferScale",1),z(this,"pickFromPickingFBO",function(){var n=Pe(function*(i,{x:a,y:o,lngLat:s,type:l,target:u}){var c;let f=!1;const{readPixels:d,readPixelsAsync:v,getViewportSize:g,queryVerdorInfo:x}=r.rendererService,{width:w,height:S}=g(),{enableHighlight:A,enableSelect:M}=i.getLayerConfig(),R=a*Fc,O=o*Fc;if(R>w-1*Fc||R<0||O>S-1*Fc||O<0)return!1;let N;if(x()==="WebGPU"?N=yield v({x:Math.floor(R/r.pickBufferScale),y:Math.floor((S-(o+1)*Fc)/r.pickBufferScale),width:1,height:1,data:new Uint8Array(4),framebuffer:r.pickingFBO}):N=d({x:Math.floor(R/r.pickBufferScale),y:Math.floor((S-(o+1)*Fc)/r.pickBufferScale),width:1,height:1,data:new Uint8Array(4),framebuffer:r.pickingFBO}),r.pickedColors=N,N[0]!==0||N[1]!==0||N[2]!==0){const V=Oy(N),Q=i.layerPickService.getFeatureById(V);V!==i.getCurrentPickId()&&l==="mousemove"&&(l="mouseenter");const Y={x:a,y:o,type:l,lngLat:s,featureId:V,feature:Q,target:u};Q&&(f=!0,i.setCurrentPickId(V),r.triggerHoverOnLayer(i,Y))}else{const V={x:a,y:o,lngLat:s,type:i.getCurrentPickId()!==null&&l==="mousemove"?"mouseout":"un"+l,featureId:null,target:u,feature:null};r.triggerHoverOnLayer(i,Ce(Ce({},V),{},{type:"unpick"})),r.triggerHoverOnLayer(i,V),i.setCurrentPickId(null)}if(A&&i.layerPickService.highlightPickedFeature(N),M&&l==="click"&&((c=N)===null||c===void 0?void 0:c.toString())!==[0,0,0,0].toString()){const V=Oy(N);i.getCurrentSelectedId()===null||V!==i.getCurrentSelectedId()?(i.layerPickService.selectFeature(N),i.setCurrentSelectedId(V)):(i.layerPickService.selectFeature(new Uint8Array([0,0,0,0])),i.setCurrentSelectedId(null))}return f});return function(i,a){return n.apply(this,arguments)}}()),this.container=t}get mapService(){return this.container.mapService}get rendererService(){return this.container.rendererService}get configService(){return this.container.globalConfigService}get interactionService(){return this.container.interactionService}get layerService(){return this.container.layerService}init(t){const{createTexture2D:r,createFramebuffer:n,getViewportSize:i}=this.rendererService;let{width:a,height:o}=i();this.pickBufferScale=this.configService.getSceneConfig(t).pickBufferScale||1,a=Math.round(a/this.pickBufferScale),o=Math.round(o/this.pickBufferScale);const s=r({width:a,height:o,usage:jy.RENDER_TARGET,label:"Picking Texture"});this.pickingFBO=n({color:s,depth:!0,width:a,height:o}),this.interactionService.on(Bc.Hover,this.pickingAllLayer.bind(this))}boxPickLayer(t,r,n){var i=this;return Pe(function*(){const{useFramebufferAsync:a,clear:o}=i.rendererService;i.resizePickingFBO(),t.hooks.beforePickingEncode.call(),yield a(i.pickingFBO,Pe(function*(){o({framebuffer:i.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),t.renderModels({ispick:!0})})),t.hooks.afterPickingEncode.call();const s=yield i.pickBox(t,r);n(s)})()}pickBox(t,r){var n=this;return Pe(function*(){const[i,a,o,s]=r.map(S=>{const A=S<0?0:S;return Math.floor(A*Fc/n.pickBufferScale)}),{readPixelsAsync:l,getViewportSize:u}=n.rendererService,{width:c,height:f}=u();if(i>(c-1)*Fc/n.pickBufferScale||o<0||a>(f-1)*Fc/n.pickBufferScale||s<0)return[];const d=Math.min(c/n.pickBufferScale,o)-i,v=Math.min(f/n.pickBufferScale,s)-a,g=yield l({x:i,y:Math.floor(f/n.pickBufferScale-(s+1)),width:d,height:v,data:new Uint8Array(d*v*4),framebuffer:n.pickingFBO}),x=[],w={};for(let S=0;S<g.length/4;S=S+1){const A=g.slice(S*4,S*4+4),M=Oy(A);if(M!==-1&&!w[M]){const R=t.layerPickService.getFeatureById(M);x.push(Ce(Ce({},R),{},{pickedFeatureIdx:M})),w[M]=!0}}return x})()}handleCursor(t,r){const{cursor:n="",cursorEnabled:i}=t.getLayerConfig();if(i){const o=this.mapService.getType()==="amap"?this.mapService.getMapContainer():this.mapService.getMarkerContainer(),s=o==null?void 0:o.style.getPropertyValue("cursor");r==="unmousemove"&&s!==""?o==null||o.style.setProperty("cursor",""):r==="mousemove"&&(o==null||o.style.setProperty("cursor",n))}}destroy(){this.pickingFBO.destroy(),this.pickingFBO=null}pickingAllLayer(t){var r=this;return Pe(function*(){!r.layerService.needPick(t.type)||!r.isPickingAllLayer()||(r.alreadyInPicking=!0,yield r.pickingLayers(t),r.layerService.renderLayers(),r.alreadyInPicking=!1)})()}isPickingAllLayer(){return!(this.alreadyInPicking||this.layerService.alreadyInRendering||this.interactionService.indragging||!this.layerService.getShaderPickStat())}resizePickingFBO(){const{getViewportSize:t}=this.rendererService,{width:r,height:n}=t();(this.width!==r||this.height!==n)&&(this.pickingFBO.resize({width:Math.round(r/this.pickBufferScale),height:Math.round(n/this.pickBufferScale)}),this.width=r,this.height=n)}pickingLayers(t){var r=this;return Pe(function*(){const{clear:n,useFramebufferAsync:i}=r.rendererService;r.resizePickingFBO();const a=r.layerService.getRenderList();for(const o of a.filter(s=>s.needPick(t.type)).reverse()){yield i(r.pickingFBO,Pe(function*(){n({framebuffer:r.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),o.layerPickService.pickRender(t)}));const s=yield r.pickFromPickingFBO(o,t);if(r.layerService.pickedLayerId=s?+o.id:-1,s&&!o.getLayerConfig().enablePropagation)break}})()}triggerHoverOnLayer(t,r){AIt(r)&&(this.handleCursor(t,r.type),t.emit(r.type,r))}}class RIt{constructor(t=!0){z(this,"autoStart",void 0),z(this,"startTime",0),z(this,"oldTime",0),z(this,"running",!1),z(this,"elapsedTime",0),this.autoStart=t}start(){this.startTime=(typeof performance>"u"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const r=(typeof performance>"u"?Date:performance).now();t=(r-this.oldTime)/1e3,this.oldTime=r,this.elapsedTime+=t}return t}}const{throttle:xU}=is;class IIt extends $u.EventEmitter{get renderService(){return this.container.rendererService}get mapService(){return this.container.mapService}get debugService(){return this.container.debugService}constructor(t){super(),z(this,"pickedLayerId",-1),z(this,"clock",new RIt),z(this,"alreadyInRendering",!1),z(this,"layers",[]),z(this,"layerList",[]),z(this,"layerRenderID",void 0),z(this,"sceneInited",!1),z(this,"animateInstanceCount",0),z(this,"shaderPicking",!0),z(this,"enableRender",!0),z(this,"reRender",xU(()=>{this.renderLayers()},32)),z(this,"throttleRenderLayers",xU(()=>{this.renderLayers()},16)),this.container=t}needPick(t){return this.updateLayerRenderList(),this.layerList.some(r=>r.needPick(t))}add(t){this.layers.push(t),this.sceneInited&&t.init().then(()=>{this.renderLayers()})}addMask(t){this.sceneInited&&t.init().then(()=>{this.renderLayers()})}initLayers(){var t=this;return Pe(function*(){t.sceneInited=!0,t.layers.forEach(function(){var r=Pe(function*(n){n.startInit||(yield n.init(),t.updateLayerRenderList())});return function(n){return r.apply(this,arguments)}}())})()}getSceneInited(){return this.sceneInited}getRenderList(){return this.layerList}getLayers(){return this.layers}getLayer(t){return this.layers.find(r=>r.id===t)}getLayerByName(t){return this.layers.find(r=>r.name===t)}remove(t,r){var n=this;return Pe(function*(){r?r.layerChildren=r.layerChildren.filter(i=>i!==t):n.layers=n.layers.filter(i=>i!==t),t.destroy(),n.reRender(),n.emit("layerChange",n.layers)})()}removeAllLayers(){var t=this;return Pe(function*(){t.destroy(),t.reRender()})()}setEnableRender(t){this.enableRender=t}renderLayers(){var t=this;return Pe(function*(){if(t.alreadyInRendering||!t.enableRender)return;t.updateLayerRenderList();const r=t.debugService.generateRenderUid();t.debugService.renderStart(r),t.alreadyInRendering=!0,t.clear();for(const n of t.layerList)n.prerender();t.renderService.beginFrame();for(const n of t.layerList){const{enableMask:i}=n.getLayerConfig();n.masks.filter(a=>a.inited).length>0&&i&&t.renderMask(n.masks),n.getLayerConfig().enableMultiPassRenderer?yield n.renderMultiPass():n.render()}t.renderService.endFrame(),t.debugService.renderEnd(r),t.alreadyInRendering=!1})()}renderMask(t){let r=0;this.renderService.clear({stencil:0,depth:1,framebuffer:null});const n=t.length>1?by.MULTIPLE:by.SINGLE;for(const i of t)i.render({isStencil:!0,stencilType:n,stencilIndex:r++})}beforeRenderData(t){var r=this;return Pe(function*(){(yield t.hooks.beforeRenderData.promise())&&r.renderLayers()})()}renderTileLayerMask(t){let r=0;const{enableMask:n=!0}=t.getLayerConfig();let i=t.tileMask?1:0;const a=t.masks.filter(s=>s.inited);i=i+(n?a.length:1);const o=i>1?by.MULTIPLE:by.SINGLE;if((t.tileMask||a.length&&n)&&this.renderService.clear({stencil:0,depth:1,framebuffer:null}),a.length&&n)for(const s of a)s.render({isStencil:!0,stencilType:o,stencilIndex:r++});t.tileMask&&t.tileMask.render({isStencil:!0,stencilType:o,stencilIndex:r++,stencilOperation:lI.OR})}renderTileLayer(t){var r=this;return Pe(function*(){r.renderTileLayerMask(t),t.getLayerConfig().enableMultiPassRenderer?yield t.renderMultiPass():yield t.render()})()}updateLayerRenderList(){this.layerList=[],this.layers.filter(t=>t.inited).filter(t=>t.isVisible()).sort((t,r)=>t.zIndex-r.zIndex).forEach(t=>{this.layerList.push(t)})}destroy(){this.layers.forEach(t=>{t.destroy()}),this.layers=[],this.layerList=[],this.emit("layerChange",this.layers)}startAnimate(){this.animateInstanceCount++===0&&(this.clock.start(),this.runRender())}stopAnimate(){--this.animateInstanceCount===0&&(this.stopRender(),this.clock.stop())}getOESTextureFloat(){return this.renderService.extensionObject.OES_texture_float}enableShaderPick(){this.shaderPicking=!0}disableShaderPick(){this.shaderPicking=!1}getShaderPickStat(){return this.shaderPicking}clear(){const t=Qa(this.mapService.bgColor);this.renderService.clear({color:t,depth:1,stencil:0,framebuffer:null})}runRender(){this.renderLayers(),this.layerRenderID=window.requestAnimationFrame(this.runRender.bind(this))}stopRender(){window.cancelAnimationFrame(this.layerRenderID)}}function LIt(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.includes(n))continue;r[n]=e[n]}return r}function Hf(e,t){if(e==null)return{};var r,n,i=LIt(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.includes(r)||{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}const{isNil:OIt}=is;class PIt{constructor(t){z(this,"name",void 0),z(this,"type",void 0),z(this,"scale",void 0),z(this,"descriptor",void 0),z(this,"featureBufferLayout",[]),z(this,"needRescale",!1),z(this,"needRemapping",!1),z(this,"needRegenerateVertices",!1),z(this,"featureRange",{startIndex:0,endIndex:1/0}),z(this,"vertexAttribute",void 0),z(this,"defaultCallback",r=>{if(r.length===0){var n;return((n=this.scale)===null||n===void 0?void 0:n.defaultValues)||[]}return r.map((i,a)=>{var o;return((o=this.scale)===null||o===void 0?void 0:o.scalers[a].func)(i)})}),this.setProps(t)}setProps(t){Object.assign(this,t)}mapping(t){var r;if((r=this.scale)!==null&&r!==void 0&&r.callback){var n;const i=(n=this.scale)===null||n===void 0?void 0:n.callback(...t);if(!OIt(i))return[i]}return this.defaultCallback(t)}resetDescriptor(){this.descriptor&&(this.descriptor.buffer.data=[])}}const DIt=["buffer","update","name"],FIt=["buffer","update","name"],BIt={[q.FLOAT]:4,[q.UNSIGNED_BYTE]:1,[q.UNSIGNED_SHORT]:2};class NIt{constructor(t){z(this,"attributesAndIndices",void 0),z(this,"attributes",[]),z(this,"triangulation",void 0),z(this,"featureLayout",{sizePerElement:0,elements:[]}),this.rendererService=t}registerStyleAttribute(t){let r=this.getLayerStyleAttribute(t.name||"");return r?r.setProps(t):(r=new PIt(t),this.attributes.push(r)),r}unRegisterStyleAttribute(t){const r=this.attributes.findIndex(n=>n.name===t);r>-1&&this.attributes.splice(r,1)}updateScaleAttribute(t){this.attributes.forEach(r=>{var n;const i=r.name,a=(n=r.scale)===null||n===void 0?void 0:n.field;(t[i]||a&&t[a])&&(r.needRescale=!0,r.needRemapping=!0,r.needRegenerateVertices=!0)})}updateStyleAttribute(t,r,n){let i=this.getLayerStyleAttribute(t);i||(i=this.registerStyleAttribute(Ce(Ce({},r),{},{name:t})));const{scale:a}=r;a&&i&&(i.scale=a,i.needRescale=!0,i.needRemapping=!0,i.needRegenerateVertices=!0,n&&n.featureRange&&(i.featureRange=n.featureRange))}getLayerStyleAttributes(){return this.attributes}getLayerStyleAttribute(t){return this.attributes.find(r=>r.name===t)}getLayerAttributeScale(t){var r;const n=this.getLayerStyleAttribute(t),i=n==null||(r=n.scale)===null||r===void 0?void 0:r.scalers;return i&&i[0]?i[0].func:null}updateAttributeByFeatureRange(t,r,n=0,i,a){const o=this.attributes.find(s=>s.name===t);if(o&&o.descriptor){const{descriptor:s}=o,{update:l,buffer:u,size:c=0}=s,f=BIt[u.type||q.FLOAT];if(l){const{elements:d,sizePerElement:v}=this.featureLayout,g=d.slice(n,i);if(!g.length)return;const{offset:x}=g[0],w=x*c*f,S=g.map(({featureIdx:A,vertices:M,normals:R},O)=>{const N=M.length/v,k=[];for(let V=0;V<N;V++){const Q=R?R.slice(V*3,V*3+3):[];k.push(...l(r[A],A,M.slice(V*v,V*v+v),O,Q))}return k}).flat();o.vertexAttribute.updateBuffer({data:S,offset:w}),a==null||a.emit(`legend:${t}`,a.getLegend(t))}}}createAttributesAndIndices(t,r,n,i){this.featureLayout={sizePerElement:0,elements:[]},r&&(this.triangulation=r);const a=this.attributes.map(x=>(x.resetDescriptor(),x.descriptor));let o=0,s=0;const l=[];let u=3;t.forEach((x,w)=>{const{indices:S,vertices:A,normals:M,size:R,indexes:O,count:N}=this.triangulation(x,n);typeof N=="number"&&(s+=N),S.forEach(V=>{l.push(V+o)}),u=R;const k=A.length/R;this.featureLayout.sizePerElement=u,this.featureLayout.elements.push({featureIdx:w,vertices:A,normals:M,offset:o}),o+=k;for(let V=0;V<k;V++){const Q=(M==null?void 0:M.slice(V*3,V*3+3))||[],Y=A.slice(V*R,V*R+R);let X=0;O&&O[V]!==void 0&&(X=O[V]),a.forEach((tt,it)=>{tt&&tt.update&&tt.buffer.data.push(...tt.update(x,w,Y,V,Q,X))})}});const{createAttribute:c,createBuffer:f,createElements:d}=this.rendererService,v={};a.forEach((x,w)=>{if(x){const{buffer:S,update:A,name:M}=x,R=Hf(x,DIt),O=c(Ce({buffer:f(S)},R));v[x.name||""]=O,this.attributes[w].vertexAttribute=O}});const g=d({data:l,type:q.UNSIGNED_INT,count:l.length});return this.attributesAndIndices={attributes:v,elements:g,count:s},Object.values(this.attributes).filter(x=>x.scale).forEach(x=>{const w=x.name;i==null||i.emit(`legend:${w}`,i.getLegend(w))}),this.attributesAndIndices}createAttributes(t,r){this.featureLayout={sizePerElement:0,elements:[]},r&&(this.triangulation=r);const n=this.attributes.map(u=>(u.resetDescriptor(),u.descriptor));let i=0,a=3;t.forEach((u,c)=>{const{indices:f,vertices:d,normals:v,size:g,indexes:x}=this.triangulation(u);f.forEach(S=>{}),a=g;const w=d.length/g;this.featureLayout.sizePerElement=a,this.featureLayout.elements.push({featureIdx:c,vertices:d,normals:v,offset:i}),i+=w;for(let S=0;S<w;S++){const A=(v==null?void 0:v.slice(S*3,S*3+3))||[],M=d.slice(S*g,S*g+g);let R=0;x&&x[S]!==void 0&&(R=x[S]),n.forEach((O,N)=>{O&&O.update&&O.buffer.data.push(...O.update(u,c,M,S,A,R))})}});const{createAttribute:o,createBuffer:s}=this.rendererService,l={};return n.forEach((u,c)=>{if(u){const{buffer:f,update:d,name:v}=u,g=Hf(u,FIt),x=o(Ce({buffer:s(f)},g));l[u.name||""]=x,this.attributes[c].vertexAttribute=x}}),{attributes:l}}clearAllAttributes(){var t;this.attributes.forEach(r=>{r.vertexAttribute&&r.vertexAttribute.destroy()}),(t=this.attributesAndIndices)===null||t===void 0||t.elements.destroy(),this.attributes=[]}}function HK(e,t,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function s(c){try{u(n.next(c))}catch(f){o(f)}}function l(c){try{u(n.throw(c))}catch(f){o(f)}}function u(c){c.done?a(c.value):i(c.value).then(s,l)}u((n=n.apply(e,t||[])).next())})}function VK(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(u){return function(c){return l([u,c])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(a=u[0]&2?i.return:u[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,u[1])).done)return a;switch(i=0,a&&(u=[u[0]&2,a.value]),u[0]){case 0:case 1:a=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,i=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!a||u[1]>a[0]&&u[1]<a[3])){r.label=u[1];break}if(u[0]===6&&r.label<a[1]){r.label=a[1],a=u;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(u);break}a[2]&&r.ops.pop(),r.trys.pop();continue}u=t.call(e,r)}catch(c){u=[6,c],i=0}finally{n=a=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function Z5(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,a=[],o;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a}function q5(e,t,r){if(r||arguments.length===2)for(var n=0,i=t.length,a;n<i;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}function GK(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var pD={exports:{}},gM={exports:{}},sC={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(n){return n&&typeof n.length=="number"&&n.length>=0&&n.length%1===0}e.exports=t.default})(sC,sC.exports);var Yc={},vD={exports:{}},gD={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(r){return function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];var a=n.pop();return r.call(this,n,a)}},e.exports=t.default})(gD,gD.exports);var h0={};Object.defineProperty(h0,"__esModule",{value:!0});h0.fallback=WK;h0.wrap=XK;var kIt=h0.hasQueueMicrotask=typeof queueMicrotask=="function"&&queueMicrotask,zIt=h0.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,UIt=h0.hasNextTick=typeof process=="object"&&typeof process.nextTick=="function";function WK(e){setTimeout(e,0)}function XK(e){return function(t){for(var r=[],n=arguments.length-1;n-- >0;)r[n]=arguments[n+1];return e(function(){return t.apply(void 0,r)})}}var uw;kIt?uw=queueMicrotask:zIt?uw=setImmediate:UIt?uw=process.nextTick:uw=WK;h0.default=XK(uw);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=l;var r=gD.exports,n=s(r),i=h0,a=s(i),o=Yc;function s(f){return f&&f.__esModule?f:{default:f}}function l(f){return(0,o.isAsync)(f)?function(){for(var d=[],v=arguments.length;v--;)d[v]=arguments[v];var g=d.pop(),x=f.apply(this,d);return u(x,g)}:(0,n.default)(function(d,v){var g;try{g=f.apply(this,d)}catch(x){return v(x)}if(g&&typeof g.then=="function")return u(g,v);v(null,g)})}function u(f,d){return f.then(function(v){c(d,null,v)},function(v){c(d,v&&v.message?v:new Error(v))})}function c(f,d,v){try{f(d,v)}catch(g){(0,a.default)(function(x){throw x},g)}}e.exports=t.default})(vD,vD.exports);Object.defineProperty(Yc,"__esModule",{value:!0});Yc.isAsyncIterable=Yc.isAsyncGenerator=Yc.isAsync=void 0;var $It=vD.exports,HIt=VIt($It);function VIt(e){return e&&e.__esModule?e:{default:e}}function jK(e){return e[Symbol.toStringTag]==="AsyncFunction"}function GIt(e){return e[Symbol.toStringTag]==="AsyncGenerator"}function WIt(e){return typeof e[Symbol.asyncIterator]=="function"}function XIt(e){if(typeof e!="function")throw new Error("expected a function");return jK(e)?(0,HIt.default)(e):e}Yc.default=XIt;Yc.isAsync=jK;Yc.isAsyncGenerator=GIt;Yc.isAsyncIterable=WIt;var Yy={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(n,i){if(i===void 0&&(i=n.length),!i)throw new Error("arity is undefined");function a(){for(var o=this,s=[],l=arguments.length;l--;)s[l]=arguments[l];return typeof s[i-1]=="function"?n.apply(this,s):new Promise(function(u,c){s[i-1]=function(f){for(var d=[],v=arguments.length-1;v-- >0;)d[v]=arguments[v+1];if(f)return c(f);u(d.length>1?d:d[0])},n.apply(o,s)})}return a}e.exports=t.default})(Yy,Yy.exports);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=sC.exports,n=l(r),i=Yc,a=l(i),o=Yy.exports,s=l(o);function l(u){return u&&u.__esModule?u:{default:u}}t.default=(0,s.default)(function(u,c,f){var d=(0,n.default)(c)?[]:{};u(c,function(v,g,x){(0,a.default)(v)(function(w){for(var S,A=[],M=arguments.length-1;M-- >0;)A[M]=arguments[M+1];A.length<2&&(S=A,A=S[0]),d[g]=A,x(w)})},function(v){return f(v,d)})},3),e.exports=t.default})(gM,gM.exports);var mD={exports:{}},mM={exports:{}},yD={exports:{}},lC={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(n){function i(){for(var a=[],o=arguments.length;o--;)a[o]=arguments[o];if(n!==null){var s=n;n=null,s.apply(this,a)}}return Object.assign(i,n),i}e.exports=t.default})(lC,lC.exports);var _D={exports:{}},xD={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(r){return r[Symbol.iterator]&&r[Symbol.iterator]()},e.exports=t.default})(xD,xD.exports);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=c;var r=sC.exports,n=o(r),i=xD.exports,a=o(i);function o(f){return f&&f.__esModule?f:{default:f}}function s(f){var d=-1,v=f.length;return function(){return++d<v?{value:f[d],key:d}:null}}function l(f){var d=-1;return function(){var g=f.next();return g.done?null:(d++,{value:g.value,key:d})}}function u(f){var d=f?Object.keys(f):[],v=-1,g=d.length;return function x(){var w=d[++v];return w==="__proto__"?x():v<g?{value:f[w],key:w}:null}}function c(f){if((0,n.default)(f))return s(f);var d=(0,a.default)(f);return d?l(d):u(f)}e.exports=t.default})(_D,_D.exports);var uC={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(n){return function(){for(var i=[],a=arguments.length;a--;)i[a]=arguments[a];if(n===null)throw new Error("Callback was already called.");var o=n;n=null,o.apply(this,i)}}e.exports=t.default})(uC,uC.exports);var bD={exports:{}},cC={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r={};t.default=r,e.exports=t.default})(cC,cC.exports);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var r=cC.exports,n=i(r);function i(o){return o&&o.__esModule?o:{default:o}}function a(o,s,l,u){var c=!1,f=!1,d=!1,v=0,g=0;function x(){v>=s||d||c||(d=!0,o.next().then(function(A){var M=A.value,R=A.done;if(!(f||c)){if(d=!1,R){c=!0,v<=0&&u(null);return}v++,l(M,g,w),g++,x()}}).catch(S))}function w(A,M){if(v-=1,!f){if(A)return S(A);if(A===!1){c=!0,f=!0;return}if(M===n.default||c&&v<=0)return c=!0,u(null);x()}}function S(A){f||(d=!1,c=!0,u(A))}x()}e.exports=t.default})(bD,bD.exports);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=lC.exports,n=v(r),i=_D.exports,a=v(i),o=uC.exports,s=v(o),l=Yc,u=bD.exports,c=v(u),f=cC.exports,d=v(f);function v(g){return g&&g.__esModule?g:{default:g}}t.default=function(g){return function(x,w,S){if(S=(0,n.default)(S),g<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!x)return S(null);if((0,l.isAsyncGenerator)(x))return(0,c.default)(x,g,w,S);if((0,l.isAsyncIterable)(x))return(0,c.default)(x[Symbol.asyncIterator](),g,w,S);var A=(0,a.default)(x),M=!1,R=!1,O=0,N=!1;function k(Q,Y){if(!R)if(O-=1,Q)M=!0,S(Q);else if(Q===!1)M=!0,R=!0;else{if(Y===d.default||M&&O<=0)return M=!0,S(null);N||V()}}function V(){for(N=!0;O<g&&!M;){var Q=A();if(Q===null){M=!0,O<=0&&S(null);return}O+=1,w(Q.value,Q.key,(0,s.default)(k))}N=!1}V()}},e.exports=t.default})(yD,yD.exports);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=yD.exports,n=l(r),i=Yc,a=l(i),o=Yy.exports,s=l(o);function l(c){return c&&c.__esModule?c:{default:c}}function u(c,f,d,v){return(0,n.default)(f)(c,(0,a.default)(d),v)}t.default=(0,s.default)(u,4),e.exports=t.default})(mM,mM.exports);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=mM.exports,n=o(r),i=Yy.exports,a=o(i);function o(l){return l&&l.__esModule?l:{default:l}}function s(l,u,c){return(0,n.default)(l,1,u,c)}t.default=(0,a.default)(s,3),e.exports=t.default})(mD,mD.exports);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var r=gM.exports,n=o(r),i=mD.exports,a=o(i);function o(l){return l&&l.__esModule?l:{default:l}}function s(l,u){return(0,n.default)(a.default,l,u)}e.exports=t.default})(pD,pD.exports);var hI=GK(pD.exports),Tp=function(){function e(){this.args=[],this.tasks=[]}return e.prototype.call=function(){for(var t=arguments,r=[],n=0;n<arguments.length;n++)r[n]=t[n];return this.args=r,hI(this.tasks)},e.prototype.tap=function(t,r){var n=this;this.tasks.push(function(i){r.apply(void 0,q5([],Z5(n.args),!1)),i(null,t)})},e}(),bU={exports:{}},ED={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=sC.exports,n=w(r),i=cC.exports,a=w(i),o=mM.exports,s=w(o),l=lC.exports,u=w(l),c=uC.exports,f=w(c),d=Yc,v=w(d),g=Yy.exports,x=w(g);function w(R){return R&&R.__esModule?R:{default:R}}function S(R,O,N){N=(0,u.default)(N);var k=0,V=0,Q=R.length,Y=!1;Q===0&&N(null);function X(tt,it){tt===!1&&(Y=!0),Y!==!0&&(tt?N(tt):(++V===Q||it===a.default)&&N(null))}for(;k<Q;k++)O(R[k],k,(0,f.default)(X))}function A(R,O,N){return(0,s.default)(R,1/0,O,N)}function M(R,O,N){var k=(0,n.default)(R)?S:A;return k(R,(0,v.default)(O),N)}t.default=(0,x.default)(M,3),e.exports=t.default})(ED,ED.exports);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var r=ED.exports,n=o(r),i=gM.exports,a=o(i);function o(l){return l&&l.__esModule?l:{default:l}}function s(l,u){return(0,a.default)(n.default,l,u)}e.exports=t.default})(bU,bU.exports);var wD={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=lC.exports,n=c(r),i=uC.exports,a=c(i),o=Yc,s=c(o),l=Yy.exports,u=c(l);function c(d){return d&&d.__esModule?d:{default:d}}function f(d,v){if(v=(0,n.default)(v),!Array.isArray(d))return v(new Error("First argument to waterfall must be an array of functions"));if(!d.length)return v();var g=0;function x(S){var A=(0,s.default)(d[g++]);A.apply(void 0,S.concat([(0,a.default)(w)]))}function w(S){for(var A=[],M=arguments.length-1;M-- >0;)A[M]=arguments[M+1];if(S!==!1){if(S||g===d.length)return v.apply(void 0,[S].concat(A));x(A)}}x([])}t.default=(0,u.default)(f),e.exports=t.default})(wD,wD.exports);var jIt=GK(wD.exports),EU=function(){function e(){this.tasks=[]}return e.prototype.call=function(){return hI(this.tasks)},e.prototype.tap=function(t,r){this.tasks.push(function(n){var i=r();n(i,t)})},e}(),YIt=function(){function e(){this.args=[],this.tasks=[]}return e.prototype.promise=function(){for(var t=arguments,r=[],n=0;n<arguments.length;n++)r[n]=t[n];return this.args=r,hI(this.tasks)},e.prototype.tapPromise=function(t,r){var n=this;this.tasks.push(function(i){return HK(n,void 0,void 0,function(){return VK(this,function(a){switch(a.label){case 0:return[4,r.apply(void 0,q5([],Z5(this.args),!1))];case 1:return a.sent(),i(null,t),[2]}})})})},e}(),ZIt=function(){function e(){this.args=[],this.tasks=[]}return e.prototype.promise=function(){for(var t=arguments,r=[],n=0;n<arguments.length;n++)r[n]=t[n];return this.args=r,hI(this.tasks)},e.prototype.tapPromise=function(t,r){var n=this;this.tasks.push(function(i){return HK(n,void 0,void 0,function(){var a;return VK(this,function(o){switch(o.label){case 0:return[4,r.apply(void 0,q5([],Z5(this.args),!1))];case 1:return a=o.sent(),i(a,t),[2]}})})})},e}(),qIt=function(){function e(){this.tasks=[]}return e.prototype.promise=function(){return jIt(this.tasks)},e.prototype.tapPromise=function(t,r){this.tasks.length===0?this.tasks.push(function(n){r().then(function(i){n(null,i)})}):this.tasks.push(function(n,i){r(n).then(function(a){i(null,a)})})},e}(),YK={exports:{}},KIt=YK.exports={};KIt.forEach=function(e,t){for(var r=0;r<e.length;r++){var n=t(e[r]);if(n)return n}};var ZK=YK.exports,QIt=function(e){var t=e.stateHandler.getState;function r(o){var s=t(o);return s&&!!s.isDetectable}function n(o){t(o).isDetectable=!0}function i(o){return!!t(o).busy}function a(o,s){t(o).busy=!!s}return{isDetectable:r,markAsDetectable:n,isBusy:i,markBusy:a}},JIt=function(e){var t={};function r(o){var s=e.get(o);return s===void 0?[]:t[s]||[]}function n(o,s){var l=e.get(o);t[l]||(t[l]=[]),t[l].push(s)}function i(o,s){for(var l=r(o),u=0,c=l.length;u<c;++u)if(l[u]===s){l.splice(u,1);break}}function a(o){var s=r(o);s&&(s.length=0)}return{get:r,add:n,removeListener:i,removeAllListeners:a}},t3t=function(){var e=1;function t(){return e++}return{generate:t}},e3t=function(e){var t=e.idGenerator,r=e.stateHandler.getState;function n(a){var o=r(a);return o&&o.id!==void 0?o.id:null}function i(a){var o=r(a);if(!o)throw new Error("setId required the element to have a resize detection state.");var s=t.generate();return o.id=s,s}return{get:n,set:i}},r3t=function(e){function t(){}var r={log:t,warn:t,error:t};if(!e&&window.console){var n=function(i,a){i[a]=function(){var s=console[a];if(s.apply)s.apply(console,arguments);else for(var l=0;l<arguments.length;l++)s(arguments[l])}};n(r,"log"),n(r,"warn"),n(r,"error")}return r},qK={exports:{}},KK=qK.exports={};KK.isIE=function(e){function t(){var n=navigator.userAgent.toLowerCase();return n.indexOf("msie")!==-1||n.indexOf("trident")!==-1||n.indexOf(" edge/")!==-1}if(!t())return!1;if(!e)return!0;var r=function(){var n,i=3,a=document.createElement("div"),o=a.getElementsByTagName("i");do a.innerHTML="<!--[if gt IE "+ ++i+"]><i></i><![endif]-->";while(o[0]);return i>4?i:n}();return e===r};KK.isLegacyOpera=function(){return!!window.opera};var QK=qK.exports,JK={exports:{}},n3t=JK.exports={};n3t.getOption=i3t;function i3t(e,t,r){var n=e[t];return n==null&&r!==void 0?r:n}var a3t=JK.exports,wU=a3t,o3t=function(t){t=t||{};var r=t.reporter,n=wU.getOption(t,"async",!0),i=wU.getOption(t,"auto",!0);i&&!n&&(r&&r.warn("Invalid options combination. auto=true and async=false is invalid. Setting async=true."),n=!0);var a=CU(),o,s=!1;function l(g,x){!s&&i&&n&&a.size()===0&&f(),a.add(g,x)}function u(){for(s=!0;a.size();){var g=a;a=CU(),g.process()}s=!1}function c(g){s||(g===void 0&&(g=n),o&&(d(o),o=null),g?f():u())}function f(){o=v(u)}function d(g){var x=clearTimeout;return x(g)}function v(g){var x=function(w){return setTimeout(w,0)};return x(g)}return{add:l,force:c}};function CU(){var e={},t=0,r=0,n=0;function i(s,l){l||(l=s,s=0),s>r?r=s:s<n&&(n=s),e[s]||(e[s]=[]),e[s].push(l),t++}function a(){for(var s=n;s<=r;s++)for(var l=e[s],u=0;u<l.length;u++){var c=l[u];c()}}function o(){return t}return{add:i,process:a,size:o}}var K5="_erd";function s3t(e){return e[K5]={},tQ(e)}function tQ(e){return e[K5]}function l3t(e){delete e[K5]}var u3t={initState:s3t,getState:tQ,cleanState:l3t},AE=QK,c3t=function(e){e=e||{};var t=e.reporter,r=e.batchProcessor,n=e.stateHandler.getState;if(!t)throw new Error("Missing required dependency: reporter.");function i(u,c){function f(){c(u)}if(AE.isIE(8))n(u).object={proxy:f},u.attachEvent("onresize",f);else{var d=s(u);if(!d)throw new Error("Element is not detectable by this strategy.");d.contentDocument.defaultView.addEventListener("resize",f)}}function a(u){var c=e.important?" !important; ":"; ";return(u.join(c)+c).trim()}function o(u,c,f){f||(f=c,c=u,u=null),u=u||{},u.debug;function d(v,g){var x=a(["display: block","position: absolute","top: 0","left: 0","width: 100%","height: 100%","border: none","padding: 0","margin: 0","opacity: 0","z-index: -1000","pointer-events: none"]),w=!1,S=window.getComputedStyle(v),A=v.offsetWidth,M=v.offsetHeight;n(v).startSize={width:A,height:M};function R(){function O(){if(S.position==="static"){v.style.setProperty("position","relative",u.important?"important":"");var V=function(Q,Y,X,tt){function it(Tt){return Tt.replace(/[^-\d\.]/g,"")}var Et=X[tt];Et!=="auto"&&it(Et)!=="0"&&(Q.warn("An element that is positioned static has style."+tt+"="+Et+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+tt+" will be set to 0. Element: ",Y),Y.style.setProperty(tt,"0",u.important?"important":""))};V(t,v,S,"top"),V(t,v,S,"right"),V(t,v,S,"bottom"),V(t,v,S,"left")}}function N(){w||O();function V(Y,X){if(!Y.contentDocument){var tt=n(Y);tt.checkForObjectDocumentTimeoutId&&window.clearTimeout(tt.checkForObjectDocumentTimeoutId),tt.checkForObjectDocumentTimeoutId=setTimeout(function(){tt.checkForObjectDocumentTimeoutId=0,V(Y,X)},100);return}X(Y.contentDocument)}var Q=this;V(Q,function(X){g(v)})}S.position!==""&&(O(),w=!0);var k=document.createElement("object");k.style.cssText=x,k.tabIndex=-1,k.type="text/html",k.setAttribute("aria-hidden","true"),k.onload=N,AE.isIE()||(k.data="about:blank"),n(v)&&(v.appendChild(k),n(v).object=k,AE.isIE()&&(k.data="about:blank"))}r?r.add(R):R()}AE.isIE(8)?f(c):d(c,f)}function s(u){return n(u).object}function l(u){if(n(u)){var c=s(u);c&&(AE.isIE(8)?u.detachEvent("onresize",c.proxy):u.removeChild(c),n(u).checkForObjectDocumentTimeoutId&&window.clearTimeout(n(u).checkForObjectDocumentTimeoutId),delete n(u).object)}}return{makeDetectable:o,addListener:i,uninstall:l}},h3t=ZK.forEach,f3t=function(e){e=e||{};var t=e.reporter,r=e.batchProcessor,n=e.stateHandler.getState;e.stateHandler.hasState;var i=e.idHandler;if(!r)throw new Error("Missing required dependency: batchProcessor");if(!t)throw new Error("Missing required dependency: reporter.");var a=c(),o="erd_scroll_detection_scrollbar_style",s="erd_scroll_detection_container";function l(R){f(R,o,s)}l(window.document);function u(R){var O=e.important?" !important; ":"; ";return(R.join(O)+O).trim()}function c(){var R=500,O=500,N=document.createElement("div");N.style.cssText=u(["position: absolute","width: "+R*2+"px","height: "+O*2+"px","visibility: hidden","margin: 0","padding: 0"]);var k=document.createElement("div");k.style.cssText=u(["position: absolute","width: "+R+"px","height: "+O+"px","overflow: scroll","visibility: none","top: "+-R*3+"px","left: "+-O*3+"px","visibility: hidden","margin: 0","padding: 0"]),k.appendChild(N),document.body.insertBefore(k,document.body.firstChild);var V=R-k.clientWidth,Q=O-k.clientHeight;return document.body.removeChild(k),{width:V,height:Q}}function f(R,O,N){function k(X,tt){tt=tt||function(Et){R.head.appendChild(Et)};var it=R.createElement("style");return it.innerHTML=X,it.id=O,tt(it),it}if(!R.getElementById(O)){var V=N+"_animation",Q=N+"_animation_active",Y=`/* Created by the element-resize-detector library. */
`;Y+="."+N+" > div::-webkit-scrollbar { "+u(["display: none"])+` }

`,Y+="."+Q+" { "+u(["-webkit-animation-duration: 0.1s","animation-duration: 0.1s","-webkit-animation-name: "+V,"animation-name: "+V])+` }
`,Y+="@-webkit-keyframes "+V+` { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }
`,Y+="@keyframes "+V+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }",k(Y)}}function d(R){R.className+=" "+s+"_animation_active"}function v(R,O,N){if(R.addEventListener)R.addEventListener(O,N);else if(R.attachEvent)R.attachEvent("on"+O,N);else return t.error("[scroll] Don't know how to add event listeners.")}function g(R,O,N){if(R.removeEventListener)R.removeEventListener(O,N);else if(R.detachEvent)R.detachEvent("on"+O,N);else return t.error("[scroll] Don't know how to remove event listeners.")}function x(R){return n(R).container.childNodes[0].childNodes[0].childNodes[0]}function w(R){return n(R).container.childNodes[0].childNodes[0].childNodes[1]}function S(R,O){var N=n(R).listeners;if(!N.push)throw new Error("Cannot add listener to an element that is not detectable.");n(R).listeners.push(O)}function A(R,O,N){N||(N=O,O=R,R=null),R=R||{};function k(){if(R.debug){var ee=Array.prototype.slice.call(arguments);if(ee.unshift(i.get(O),"Scroll: "),t.log.apply)t.log.apply(null,ee);else for(var rr=0;rr<ee.length;rr++)t.log(ee[rr])}}function V(ee){function rr(Nr){var Fe=Nr.getRootNode&&Nr.getRootNode().contains(Nr);return Nr===Nr.ownerDocument.body||Nr.ownerDocument.body.contains(Nr)||Fe}return!rr(ee)||window.getComputedStyle(ee)===null}function Q(ee){var rr=n(ee).container.childNodes[0],Nr=window.getComputedStyle(rr);return!Nr.width||Nr.width.indexOf("px")===-1}function Y(){var ee=window.getComputedStyle(O),rr={};return rr.position=ee.position,rr.width=O.offsetWidth,rr.height=O.offsetHeight,rr.top=ee.top,rr.right=ee.right,rr.bottom=ee.bottom,rr.left=ee.left,rr.widthCSS=ee.width,rr.heightCSS=ee.height,rr}function X(){var ee=Y();n(O).startSize={width:ee.width,height:ee.height},k("Element start size",n(O).startSize)}function tt(){n(O).listeners=[]}function it(){if(k("storeStyle invoked."),!n(O)){k("Aborting because element has been uninstalled");return}var ee=Y();n(O).style=ee}function Et(ee,rr,Nr){n(ee).lastWidth=rr,n(ee).lastHeight=Nr}function Tt(ee){return x(ee).childNodes[0]}function pt(){return 2*a.width+1}function kt(){return 2*a.height+1}function ae(ee){return ee+10+pt()}function Kt(ee){return ee+10+kt()}function re(ee){return ee*2+pt()}function fe(ee){return ee*2+kt()}function Oe(ee,rr,Nr){var Fe=x(ee),Hr=w(ee),_n=ae(rr),Kn=Kt(Nr),vn=re(rr),xn=fe(Nr);Fe.scrollLeft=_n,Fe.scrollTop=Kn,Hr.scrollLeft=vn,Hr.scrollTop=xn}function Ye(){var ee=n(O).container;if(!ee){ee=document.createElement("div"),ee.className=s,ee.style.cssText=u(["visibility: hidden","display: inline","width: 0px","height: 0px","z-index: -1","overflow: hidden","margin: 0","padding: 0"]),n(O).container=ee,d(ee),O.appendChild(ee);var rr=function(){n(O).onRendered&&n(O).onRendered()};v(ee,"animationstart",rr),n(O).onAnimationStart=rr}return ee}function Be(){function ee(){var va=n(O).style;if(va.position==="static"){O.style.setProperty("position","relative",R.important?"important":"");var ls=function(il,us,dc,fo){function Gu(oh){return oh.replace(/[^-\d\.]/g,"")}var Cl=dc[fo];Cl!=="auto"&&Gu(Cl)!=="0"&&(il.warn("An element that is positioned static has style."+fo+"="+Cl+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+fo+" will be set to 0. Element: ",us),us.style[fo]=0)};ls(t,O,va,"top"),ls(t,O,va,"right"),ls(t,O,va,"bottom"),ls(t,O,va,"left")}}function rr(va,ls,il,us){return va=va?va+"px":"0",ls=ls?ls+"px":"0",il=il?il+"px":"0",us=us?us+"px":"0",["left: "+va,"top: "+ls,"right: "+us,"bottom: "+il]}if(k("Injecting elements"),!n(O)){k("Aborting because element has been uninstalled");return}ee();var Nr=n(O).container;Nr||(Nr=Ye());var Fe=a.width,Hr=a.height,_n=u(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden","width: 100%","height: 100%","left: 0px","top: 0px"]),Kn=u(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden"].concat(rr(-(1+Fe),-(1+Hr),-Hr,-Fe))),vn=u(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),xn=u(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),ui=u(["position: absolute","left: 0","top: 0"]),Ao=u(["position: absolute","width: 200%","height: 200%"]),ta=document.createElement("div"),oa=document.createElement("div"),as=document.createElement("div"),bt=document.createElement("div"),os=document.createElement("div"),gu=document.createElement("div");ta.dir="ltr",ta.style.cssText=_n,ta.className=s,oa.className=s,oa.style.cssText=Kn,as.style.cssText=vn,bt.style.cssText=ui,os.style.cssText=xn,gu.style.cssText=Ao,as.appendChild(bt),os.appendChild(gu),oa.appendChild(as),oa.appendChild(os),ta.appendChild(oa),Nr.appendChild(ta);function ss(){var va=n(O);va&&va.onExpand?va.onExpand():k("Aborting expand scroll handler: element has been uninstalled")}function Vu(){var va=n(O);va&&va.onShrink?va.onShrink():k("Aborting shrink scroll handler: element has been uninstalled")}v(as,"scroll",ss),v(os,"scroll",Vu),n(O).onExpandScroll=ss,n(O).onShrinkScroll=Vu}function De(){function ee(vn,xn,ui){var Ao=Tt(vn),ta=ae(xn),oa=Kt(ui);Ao.style.setProperty("width",ta+"px",R.important?"important":""),Ao.style.setProperty("height",oa+"px",R.important?"important":"")}function rr(vn){var xn=O.offsetWidth,ui=O.offsetHeight,Ao=xn!==n(O).lastWidth||ui!==n(O).lastHeight;k("Storing current size",xn,ui),Et(O,xn,ui),r.add(0,function(){if(Ao){if(!n(O)){k("Aborting because element has been uninstalled");return}if(!Nr()){k("Aborting because element container has not been initialized");return}if(R.debug){var oa=O.offsetWidth,as=O.offsetHeight;(oa!==xn||as!==ui)&&t.warn(i.get(O),"Scroll: Size changed before updating detector elements.")}ee(O,xn,ui)}}),r.add(1,function(){if(!n(O)){k("Aborting because element has been uninstalled");return}if(!Nr()){k("Aborting because element container has not been initialized");return}Oe(O,xn,ui)}),Ao&&vn&&r.add(2,function(){if(!n(O)){k("Aborting because element has been uninstalled");return}if(!Nr()){k("Aborting because element container has not been initialized");return}vn()})}function Nr(){return!!n(O).container}function Fe(){function vn(){return n(O).lastNotifiedWidth===void 0}k("notifyListenersIfNeeded invoked");var xn=n(O);if(vn()&&xn.lastWidth===xn.startSize.width&&xn.lastHeight===xn.startSize.height)return k("Not notifying: Size is the same as the start size, and there has been no notification yet.");if(xn.lastWidth===xn.lastNotifiedWidth&&xn.lastHeight===xn.lastNotifiedHeight)return k("Not notifying: Size already notified");k("Current size not notified, notifying..."),xn.lastNotifiedWidth=xn.lastWidth,xn.lastNotifiedHeight=xn.lastHeight,h3t(n(O).listeners,function(ui){ui(O)})}function Hr(){if(k("startanimation triggered."),Q(O)){k("Ignoring since element is still unrendered...");return}k("Element rendered.");var vn=x(O),xn=w(O);(vn.scrollLeft===0||vn.scrollTop===0||xn.scrollLeft===0||xn.scrollTop===0)&&(k("Scrollbars out of sync. Updating detector elements..."),rr(Fe))}function _n(){if(k("Scroll detected."),Q(O)){k("Scroll event fired while unrendered. Ignoring...");return}rr(Fe)}if(k("registerListenersAndPositionElements invoked."),!n(O)){k("Aborting because element has been uninstalled");return}n(O).onRendered=Hr,n(O).onExpand=_n,n(O).onShrink=_n;var Kn=n(O).style;ee(O,Kn.width,Kn.height)}function Yr(){if(k("finalizeDomMutation invoked."),!n(O)){k("Aborting because element has been uninstalled");return}var ee=n(O).style;Et(O,ee.width,ee.height),Oe(O,ee.width,ee.height)}function Gr(){N(O)}function Mn(){k("Installing..."),tt(),X(),r.add(0,it),r.add(1,Be),r.add(2,De),r.add(3,Yr),r.add(4,Gr)}k("Making detectable..."),V(O)?(k("Element is detached"),Ye(),k("Waiting until element is attached..."),n(O).onRendered=function(){k("Element is now attached"),Mn()}):Mn()}function M(R){var O=n(R);O&&(O.onExpandScroll&&g(x(R),"scroll",O.onExpandScroll),O.onShrinkScroll&&g(w(R),"scroll",O.onShrinkScroll),O.onAnimationStart&&g(O.container,"animationstart",O.onAnimationStart),O.container&&R.removeChild(O.container))}return{makeDetectable:A,addListener:S,uninstall:M,initDocument:l}},cw=ZK.forEach,d3t=QIt,p3t=JIt,v3t=t3t,g3t=e3t,m3t=r3t,SU=QK,y3t=o3t,rm=u3t,_3t=c3t,x3t=f3t;function TU(e){return Array.isArray(e)||e.length!==void 0}function AU(e){if(Array.isArray(e))return e;var t=[];return cw(e,function(r){t.push(r)}),t}function MU(e){return e&&e.nodeType===1}var b3t=function(e){e=e||{};var t;if(e.idHandler)t={get:function(A){return e.idHandler.get(A,!0)},set:e.idHandler.set};else{var r=v3t(),n=g3t({idGenerator:r,stateHandler:rm});t=n}var i=e.reporter;if(!i){var a=i===!1;i=m3t(a)}var o=nm(e,"batchProcessor",y3t({reporter:i})),s={};s.callOnAdd=!!nm(e,"callOnAdd",!0),s.debug=!!nm(e,"debug",!1);var l=p3t(t),u=d3t({stateHandler:rm}),c,f=nm(e,"strategy","object"),d=nm(e,"important",!1),v={reporter:i,batchProcessor:o,stateHandler:rm,idHandler:t,important:d};if(f==="scroll"&&(SU.isLegacyOpera()?(i.warn("Scroll strategy is not supported on legacy Opera. Changing to object strategy."),f="object"):SU.isIE(9)&&(i.warn("Scroll strategy is not supported on IE9. Changing to object strategy."),f="object")),f==="scroll")c=x3t(v);else if(f==="object")c=_3t(v);else throw new Error("Invalid strategy name: "+f);var g={};function x(A,M,R){function O(X){var tt=l.get(X);cw(tt,function(Et){Et(X)})}function N(X,tt,it){l.add(tt,it),X&&it(tt)}if(R||(R=M,M=A,A={}),!M)throw new Error("At least one element required.");if(!R)throw new Error("Listener required.");if(MU(M))M=[M];else if(TU(M))M=AU(M);else return i.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");var k=0,V=nm(A,"callOnAdd",s.callOnAdd),Q=nm(A,"onReady",function(){}),Y=nm(A,"debug",s.debug);cw(M,function(tt){rm.getState(tt)||(rm.initState(tt),t.set(tt));var it=t.get(tt);if(Y&&i.log("Attaching listener to element",it,tt),!u.isDetectable(tt)){if(Y&&i.log(it,"Not detectable."),u.isBusy(tt)){Y&&i.log(it,"System busy making it detectable"),N(V,tt,R),g[it]=g[it]||[],g[it].push(function(){k++,k===M.length&&Q()});return}return Y&&i.log(it,"Making detectable..."),u.markBusy(tt,!0),c.makeDetectable({debug:Y,important:d},tt,function(Tt){if(Y&&i.log(it,"onElementDetectable"),rm.getState(Tt)){u.markAsDetectable(Tt),u.markBusy(Tt,!1),c.addListener(Tt,O),N(V,Tt,R);var pt=rm.getState(Tt);if(pt&&pt.startSize){var kt=Tt.offsetWidth,ae=Tt.offsetHeight;(pt.startSize.width!==kt||pt.startSize.height!==ae)&&O(Tt)}g[it]&&cw(g[it],function(Kt){Kt()})}else Y&&i.log(it,"Element uninstalled before being detectable.");delete g[it],k++,k===M.length&&Q()})}Y&&i.log(it,"Already detecable, adding listener."),N(V,tt,R),k++}),k===M.length&&Q()}function w(A){if(!A)return i.error("At least one element is required.");if(MU(A))A=[A];else if(TU(A))A=AU(A);else return i.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");cw(A,function(M){l.removeAllListeners(M),c.uninstall(M),rm.cleanState(M)})}function S(A){c.initDocument&&c.initDocument(A)}return{listenTo:x,removeListener:l.removeListener,removeAllListeners:l.removeAllListeners,uninstall:w,initDocument:S}};function nm(e,t,r){var n=e[t];return n==null&&r!==void 0?r:n}const E3t=aa(b3t);let w3t=class extends $u.EventEmitter{get iconService(){return this.container.iconService}get fontService(){return this.container.fontService}get controlService(){return this.container.controlService}get configService(){return this.container.globalConfigService}get map(){return this.container.mapService}get coordinateSystemService(){return this.container.coordinateSystemService}get rendererService(){return this.container.rendererService}get layerService(){return this.container.layerService}get debugService(){return this.container.debugService}get cameraService(){return this.container.cameraService}get interactionService(){return this.container.interactionService}get pickingService(){return this.container.pickingService}get shaderModuleService(){return this.container.shaderModuleService}get markerService(){return this.container.markerService}get popupService(){return this.container.popupService}constructor(t){super(),z(this,"destroyed",!1),z(this,"loaded",!1),z(this,"id",void 0),z(this,"inited",!1),z(this,"rendering",!1),z(this,"$container",void 0),z(this,"canvas",void 0),z(this,"markerContainer",void 0),z(this,"resizeDetector",void 0),z(this,"hooks",void 0),z(this,"handleWindowResized",()=>{this.emit("resize"),this.$container&&(this.initContainer(),this.coordinateSystemService.needRefresh=!0,this.render())}),z(this,"handleMapCameraChanged",r=>{this.cameraService.update(r),this.render()}),this.container=t,this.hooks={init:new YIt},this.id=t.id}init(t){var r=this;this.configService.setSceneConfig(this.id,t),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.iconService.on("imageUpdate",()=>this.render()),this.fontService.init(),this.hooks.init.tapPromise("initMap",Pe(function*(){r.debugService.log("map.mapInitStart",{type:r.map.version}),yield new Promise(n=>{r.map.onCameraChanged(i=>{r.cameraService.init(),r.cameraService.update(i),n()}),r.map.init()}),r.map.onCameraChanged(r.handleMapCameraChanged),r.map.addMarkerContainer(),r.markerService.addMarkers(),r.markerService.addMarkerLayers(),r.popupService.initPopup(),r.interactionService.init(),r.interactionService.on(Bc.Drag,r.addSceneEvent.bind(r))})),this.hooks.init.tapPromise("initRenderer",Pe(function*(){var n;const i=((n=r.map)===null||n===void 0?void 0:n.getOverlayContainer())||void 0;if(i?r.$container=i:r.$container=TIt(r.configService.getSceneConfig(r.id).id||""),r.$container){const{canvas:o}=t;if(r.canvas=o||uo("canvas","",r.$container),r.setCanvas(),yield r.rendererService.init(r.canvas,r.configService.getSceneConfig(r.id),t.gl),r.registerContextLost(),r.initContainer(),r.resizeDetector=E3t({strategy:"scroll"}),r.resizeDetector.listenTo(r.$container,r.handleWindowResized),window.matchMedia){var a;(a=window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)"))===null||a===void 0||a.addListener(r.handleWindowResized.bind("screen"))}}else console.error("容器 id 不存在");r.pickingService.init(r.id)})),this.render()}registerContextLost(){const t=this.rendererService.getCanvas();t&&t.addEventListener("webglcontextlost",()=>this.emit("webglcontextlost"))}addLayer(t){this.layerService.sceneService=this,this.layerService.add(t)}addMask(t){this.layerService.sceneService=this,this.layerService.addMask(t)}render(){var t=this;return Pe(function*(){t.rendering||t.destroyed||(t.rendering=!0,t.inited?(yield t.layerService.initLayers(),yield t.layerService.renderLayers()):(yield t.hooks.init.promise(),t.destroyed&&t.destroy(),yield t.layerService.initLayers(),t.layerService.renderLayers(),t.controlService.addControls(),t.loaded=!0,t.emit("loaded"),t.inited=!0),t.rendering=!1)})()}addFontFace(t,r){this.fontService.addFontFace(t,r)}getSceneContainer(){return this.$container}exportPng(t){var r=this;return Pe(function*(){var n;const i=(n=r.$container)===null||n===void 0?void 0:n.getElementsByTagName("canvas")[0];return yield r.render(),t==="jpg"?i==null?void 0:i.toDataURL("image/jpeg"):i==null?void 0:i.toDataURL("image/png")})()}getSceneConfig(){return this.configService.getSceneConfig(this.id)}getPointSizeRange(){return this.rendererService.getPointSizeRange()}addMarkerContainer(){const t=this.$container.parentElement;t!==null&&(this.markerContainer=uo("div","l7-marker-container",t))}getMarkerContainer(){return this.markerContainer}destroy(){var t;if(!this.inited){this.destroyed=!0;return}this.resizeDetector.removeListener(this.$container,this.handleWindowResized),this.pickingService.destroy(),this.layerService.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),this.fontService.destroy(),this.iconService.destroy(),this.removeAllListeners(),this.inited=!1,this.map.destroy(),setTimeout(()=>{var r;(r=this.$container)===null||r===void 0||r.removeChild(this.canvas),this.canvas=null,this.rendererService.destroy()}),(t=this.$container)===null||t===void 0||(t=t.parentNode)===null||t===void 0||t.removeChild(this.$container),this.emit("destroy")}initContainer(){var t,r;const n=Fc,i=((t=this.$container)===null||t===void 0?void 0:t.clientWidth)||400,a=((r=this.$container)===null||r===void 0?void 0:r.clientHeight)||300,o=this.canvas;o&&(o.width=i*n,o.height=a*n),this.rendererService.viewport({x:0,y:0,width:n*i,height:n*a})}setCanvas(){var t,r;const n=Fc,i=((t=this.$container)===null||t===void 0?void 0:t.clientWidth)||400,a=((r=this.$container)===null||r===void 0?void 0:r.clientHeight)||300,o=this.canvas;o.width=i*n,o.height=a*n,o.style.width="100%",o.style.height="100%"}addSceneEvent(t){this.emit(t.type,t)}};const{uniq:C3t}=is,RU="#define PI 3.14159265359",S3t=`#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2


float calc_lighting(vec4 pos) {

    vec3 worldPos = vec3(pos * u_ModelMatrix);

    vec3 worldNormal = a_Normal;
      // //cal light weight
    vec3 viewDir = normalize(u_CameraPosition - worldPos);

    vec3 lightDir = normalize(vec3(1, -10.5, 12));

    vec3 halfDir = normalize(viewDir+lightDir);
      // //lambert
    float lambert = dot(worldNormal, lightDir);
        //specular
    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);
        //sum to light weight
    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;

    return lightWeight;
}
`,T3t=`#define SHIFT_RIGHT17 1.0 / 131072.0
#define SHIFT_RIGHT18 1.0 / 262144.0
#define SHIFT_RIGHT19 1.0 / 524288.0
#define SHIFT_RIGHT20 1.0 / 1048576.0
#define SHIFT_RIGHT21 1.0 / 2097152.0
#define SHIFT_RIGHT22 1.0 / 4194304.0
#define SHIFT_RIGHT23 1.0 / 8388608.0
#define SHIFT_RIGHT24 1.0 / 16777216.0

#define SHIFT_LEFT17 131072.0
#define SHIFT_LEFT18 262144.0
#define SHIFT_LEFT19 524288.0
#define SHIFT_LEFT20 1048576.0
#define SHIFT_LEFT21 2097152.0
#define SHIFT_LEFT22 4194304.0
#define SHIFT_LEFT23 8388608.0
#define SHIFT_LEFT24 16777216.0

vec2 unpack_float(float packedValue) {
  int packedIntValue = int(packedValue);
  int v0 = packedIntValue / 256;
  return vec2(v0, packedIntValue - v0 * 256);
}

vec4 decode_color(vec2 encodedColor) {
  return vec4(
    unpack_float(encodedColor[0]) / 255.0,
    unpack_float(encodedColor[1]) / 255.0
  );
}
`,A3t=`// Blinn-Phong model
// apply lighting in vertex shader instead of fragment shader
// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting
uniform float u_Ambient : 1.0;
uniform float u_Diffuse : 1.0;
uniform float u_Specular : 1.0;
uniform int u_NumOfDirectionalLights : 1;
uniform int u_NumOfSpotLights : 0;

#define SHININESS 32.0
#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3
#define MAX_NUM_OF_SPOT_LIGHTS 3

struct DirectionalLight {
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
};

struct SpotLight {
  vec3 position;
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
  float constant;
  float linear;
  float quadratic;
  float angle;
  float blur;
  float exponent;
};

uniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];
uniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];

vec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {
  vec3 lightDir = normalize(light.direction);
  // diffuse shading
  float diff = max(dot(normal, lightDir), 0.0);
  // Blinn-Phong specular shading
  vec3 halfwayDir = normalize(lightDir + viewDir);
  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);

  vec3 ambient = light.ambient * u_Ambient;
  vec3 diffuse = light.diffuse * diff * u_Diffuse;
  vec3 specular = light.specular * spec * u_Specular;

  return ambient + diffuse + specular;
}


vec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {
  vec3 weight = vec3(0.0);
  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {
    if (i >= u_NumOfDirectionalLights) {
      break;
    }
    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);
  }
  return weight;
}
`,M3t=`
in vec4 v_PickingResult;

#pragma include "picking_uniforms"

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define HIGHLIGHT 1.0
#define SELECT 2.0

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color, float weight) {
  float activeType = v_PickingResult.a;
  if(activeType > 0.0) {
    vec4 highLightColor =  activeType > 1.5 ? u_SelectColor : u_HighlightColor;
    highLightColor = highLightColor * COLOR_SCALE;
    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));
    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(mix(resultRGB * weight, color.rgb, u_activeMix), color.a);
  }
  else {
    return color;
  }

  
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  // 过滤多余的 shader 计算
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // 暂时去除 直接取消计算在选中时拖拽地图会有问题
  } else {
    return filterPickingColor(filterHighlightColor(color, 1.0));
  }
  
}

vec4 filterColorAlpha(vec4 color, float alpha) {
  // 过滤多余的 shader 计算
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // 暂时去除 直接取消计算在选中时拖拽地图会有问题
  } else {
    return filterPickingColor(filterHighlightColor(color, alpha));
  }
}

`,R3t=`layout(location = ATTRIBUTE_LOCATION_PICKING_COLOR) in vec3 a_PickingColor;
out vec4 v_PickingResult;

#pragma include "picking_uniforms"

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define NORMAL 0.0
#define HIGHLIGHT 1.0
#define SELECT 2.0

bool isVertexPicked(vec3 vertexColor) {
  return distance(vertexColor,u_PickingColor.rgb) < 0.01;
}

// 判断当前点是否已经被 select 选中
bool isVertexSelected(vec3 vertexColor) {
  return distance(vertexColor,u_CurrentSelectedId.rgb) < 0.01;
}

void setPickingColor(vec3 pickingColor) {
  if(u_shaderPick < 0.5) {
    return;
  }
  // compares only in highlight stage

  if(u_PickingStage == PICKING_HIGHLIGHT) {
    if(isVertexPicked(pickingColor)) {
       v_PickingResult = vec4(pickingColor.rgb * COLOR_SCALE,HIGHLIGHT);
       return;
    }
    if(isVertexSelected(pickingColor)) {
     v_PickingResult = vec4(u_CurrentSelectedId.rgb * COLOR_SCALE,SELECT);
      return;
    }

  } else {
      v_PickingResult= vec4(pickingColor.rgb * COLOR_SCALE,NORMAL);
      return;
  }

  // // v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && (isVertexPicked(pickingColor) || isVertexPicked(u_CurrentSelectedId)));

  // // Stores the picking color so that the fragment shader can render it during picking
  // v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}

float setPickingOrder(float z) {
   bool selected = bool(v_PickingResult.a);
   return selected ? z + 1. : 0.;
}
`,IU=`layout(std140) uniform PickingUniforms {
  vec4 u_HighlightColor;
  vec4 u_SelectColor;
  vec3 u_PickingColor;
  float u_PickingStage;
  vec3 u_CurrentSelectedId;
  float u_PickingThreshold;
  float u_PickingBuffer;
  float u_shaderPick;
  float u_activeMix;
};`,I3t=`
#define E 2.718281828459045
vec2 ProjectFlat(vec2 lnglat){
  float maxs=85.0511287798;
  float lat=max(min(maxs,lnglat.y),-maxs);
  float scale= 268435456.;
  float d=PI/180.;
  float x=lnglat.x*d;
  float y=lat*d;
  y=log(tan((PI/4.)+(y/2.)));

  float a=.5/PI,
  b=.5,
  c=-.5/PI;
  d=.5;
  x=scale*(a*x+b);
  y=scale*(c*y+d);
  return vec2(x,y);
}

vec2 unProjectFlat(vec2 px){
  float a=.5/PI;
  float b=.5;
  float c=-.5/PI;
  float d=.5;
  float scale = 268435456.;
  float x=(px.x/scale-b)/a;
  float y=(px.y/scale-d)/c;
  y=(atan(pow(E,y))-(PI/4.))*2.;
  d=PI/180.;
  float lat=y/d;
  float lng=x/d;
  return vec2(lng,lat);
}

float pixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}

// gaode2.0
vec2 customProject(vec2 lnglat) { // 经纬度 => 平面坐标
  float t = lnglat.x;
  float e = lnglat.y;
  float Sm = 180.0 / PI;
  float Tm = 6378137.0;
  float Rm = PI / 180.0;
  float r = 85.0511287798;
  e = max(min(r, e), -r);
  t *= Rm;
  e *= Rm;
  e = log(tan(PI / 4.0 + e / 2.0));
  return vec2(t * Tm, e * Tm);
}

vec2 unProjCustomCoord(vec2 point) { // 平面坐标 => 经纬度
  float Sm = 57.29577951308232; //180 / Math.PI
  float Tm = 6378137.0;
  float t = point.x;
  float e = point.y;
  return vec2(t / Tm * Sm, (2.0 * atan(exp(e / Tm)) - PI / 2.0) * Sm);
}


float customPixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}`,LU=`#define TILE_SIZE (512.0)
#define PI (3.1415926536)
#define WORLD_SCALE (TILE_SIZE / (PI * 2.0))
#define EARTH_CIRCUMFERENCE (40.03e6)

#define COORDINATE_SYSTEM_LNGLAT (1.0) // mapbox
#define COORDINATE_SYSTEM_LNGLAT_OFFSET (2.0) // mapbox offset
#define COORDINATE_SYSTEM_VECTOR_TILE (3.0)
#define COORDINATE_SYSTEM_IDENTITY (4.0)
#define COORDINATE_SYSTEM_METER_OFFSET (5.0)

#pragma include "scene_uniforms"

const vec2 ZERO_64_XY_LOW = vec2(0.0, 0.0);

// web mercator coords -> world coords
vec2 project_mercator(vec2 lnglat) {
  float x = lnglat.x;
  return vec2(radians(x) + PI, PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5)));
}

float project_scale(float meters) {
  return meters * u_PixelsPerMeter.z;
}

// offset coords -> world coords
vec4 project_offset(vec4 offset) {
  float dy = offset.y;
  dy = clamp(dy, -1.0, 1.0);
  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;
  return vec4(offset.xyz * pixels_per_unit, offset.w);
}

vec3 project_normal(vec3 normal) {
  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);
  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);
}

vec3 project_offset_normal(vec3 vector) {
  if (
    u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 &&
      u_CoordinateSystem > COORDINATE_SYSTEM_LNGLAT - 0.01 ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * u_PixelsPerDegree);
  }
  return project_normal(vector);
}

vec4 project_position(vec4 position, vec2 position64xyLow) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float X = position.x - u_ViewportCenter.x;
    float Y = position.y - u_ViewportCenter.y;
    return project_offset(
      vec4(X + position64xyLow.x, Y + position64xyLow.y, position.z, position.w)
    );
  }
  if (
    u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 &&
    u_CoordinateSystem > COORDINATE_SYSTEM_LNGLAT - 0.01
  ) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }

  return position;
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_XY_LOW);
}

vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;
  return offset * u_FocalDistance;
}

// 适配纹理贴图的等像素大小
float project_pixel_texture(float pixel) {
  // mapbox zoom > 12
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    return pixel * pow(0.5, u_Zoom) * u_FocalDistance;
  }

  return pixel * 2.0 * u_FocalDistance;
}

// 在不论什么底图下需要统一处理的时候使用
float project_float_pixel(float pixel) {
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // mapbox 坐标系下，为了和 Web 墨卡托坐标系统一，zoom 默认减1
    return pixel * pow(2.0, 19.0 - u_Zoom) * u_FocalDistance;
  }

  return pixel * u_FocalDistance;
}

// Project meter into the unit of pixel which used in the camera world space
float project_float_meter(float meter) {
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // Since the zoom level uniform is updated by mapservice and it's alread been subtracted by 1
    // Not sure if we are supposed to do that again
    return meter;
  } else {
    return project_float_pixel(meter);
  }

  // TODO: change the following code to make adaptations for amap
  // return u_FocalDistance * TILE_SIZE * pow(2.0, u_Zoom) * meter / EARTH_CIRCUMFERENCE;

}

float project_pixel(float pixel) {
  return pixel * u_FocalDistance;
}

vec2 project_pixel(vec2 pixel) {
  return pixel * -1.0 * u_FocalDistance;
}

vec3 project_pixel(vec3 pixel) {
  return pixel * -1.0 * u_FocalDistance;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    position.w *= u_PixelsPerMeter.z;
  }

  return viewProjectionMatrix * position + center;
}

// Projects from common space coordinates to clip space
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(
    position,
    u_ViewProjectionMatrix,
    u_ViewportCenterProjection
  );
}

vec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {
  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);

  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    pos.w = pos.w / u_PixelsPerMeter.z;
  }
  return pos;
}

bool isEqual(float a, float b) {
  return a < b + 0.001 && a > b - 0.001;
}

`,L3t=`vec2 rotate_matrix(vec2 v, float a) {
    float b = a / 180.0 * 3.1415926535897932384626433832795;
    float s = sin(b);
    float c = cos(b);
    mat2 m = mat2(c, s, -s, c);
    return m * v;
}`,OU=`layout(std140) uniform SceneUniforms {
  mat4 u_ViewMatrix;
  mat4 u_ProjectionMatrix;
  mat4 u_ViewProjectionMatrix;
  mat4 u_ModelMatrix;
  vec4 u_ViewportCenterProjection;
  vec3 u_PixelsPerDegree;
  float u_Zoom;
  vec3 u_PixelsPerDegree2;
  float u_ZoomScale;
  vec3 u_PixelsPerMeter;
  float u_CoordinateSystem;
  vec3 u_CameraPosition;
  float u_DevicePixelRatio;
  vec2 u_ViewportCenter;
  vec2 u_ViewportSize;
  float u_FocalDistance;
};
`,O3t=`/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0/k;
  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;
  p.x -= clamp( p.x, -2.0, 0.0 );
  return -length(p)*sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p)-b;
  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994,0.587785252,0.726542528);
  p.x = abs(p.x);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);
  return length(p)*sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404,0.5,0.577350269);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );
  p = abs(p);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;
  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);
  return length(p)*sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);
  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );
  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r*r-d*d); // can delay this sqrt
  return ((p.y-b)*d>p.x*b)
          ? length(p-vec2(0.0,b))
          : length(p-vec2(-d,0.0))-r;
}
`,PU=/precision\s+(high|low|medium)p\s+float/,DU=`#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`,P3t=/#pragma include (["^+"]?["[a-zA-Z_0-9](.*)"]*?)/g,D3t=/void\s+main\s*\([^)]*\)\s*\{\n?/;class F3t{constructor(){z(this,"moduleCache",{}),z(this,"rawContentCache",{})}registerBuiltinModules(){this.destroy(),this.registerModule("common",{vs:RU,fs:RU}),this.registerModule("decode",{vs:T3t,fs:""}),this.registerModule("scene_uniforms",{vs:OU,fs:OU}),this.registerModule("picking_uniforms",{vs:IU,fs:IU}),this.registerModule("projection",{vs:LU,fs:LU}),this.registerModule("project",{vs:I3t,fs:""}),this.registerModule("sdf_2d",{vs:"",fs:O3t}),this.registerModule("lighting",{vs:A3t,fs:""}),this.registerModule("light",{vs:S3t,fs:""}),this.registerModule("picking",{vs:R3t,fs:M3t}),this.registerModule("rotation_2d",{vs:L3t,fs:""})}registerModule(t,r){r.vs=r.vs.replace(/\r\n/g,`
`),r.fs=r.fs.replace(/\r\n/g,`
`);const{vs:n,fs:i,uniforms:a,defines:o,inject:s}=r,{content:l,uniforms:u}=sO(n),{content:c,uniforms:f}=sO(i);this.rawContentCache[t]={fs:c,defines:o,inject:s,uniforms:Ce(Ce(Ce({},u),f),a),vs:l}}getModule(t){let r=this.rawContentCache[t].vs,n=this.rawContentCache[t].fs;const{defines:i={},inject:a={}}=this.rawContentCache[t];let o={};a["vs:#decl"]&&(r=a["vs:#decl"]+r,o=sO(a["vs:#decl"]).uniforms),a["vs:#main-start"]&&(r=r.replace(D3t,x=>x+a["vs:#main-start"])),a["fs:#decl"]&&(n=a["fs:#decl"]+n),r=B3t(i)+r;const{content:l,includeList:u}=this.processModule(r,[],"vs"),{content:c,includeList:f}=this.processModule(n,[],"fs"),d=C3t(u.concat(f).concat(t)).reduce((x,w)=>Ce(Ce({},x),this.rawContentCache[w].uniforms),Ce({},o)),v=(PU.test(c)?"":DU)+l,g=(PU.test(c)?"":DU)+c;return this.moduleCache[t]={vs:v.trim(),fs:g.trim(),uniforms:d},this.moduleCache[t]}destroy(){this.moduleCache={},this.rawContentCache={}}processModule(t,r,n){return{content:t.replace(P3t,(a,o)=>{const l=o.split(" ")[0].replace(/"/g,"");if(r.indexOf(l)>-1)return"";const u=this.rawContentCache[l][n];r.push(l);const{content:c}=this.processModule(u,r,n);return c}),includeList:r}}}function B3t(e){return Object.keys(e).reduce((r,n)=>r+`#define ${n.toUpperCase()} ${e[n]}
`,`
`)}class Q5{constructor(){z(this,"shaderModuleService",void 0),z(this,"rendererService",void 0),z(this,"cameraService",void 0),z(this,"mapService",void 0),z(this,"interactionService",void 0),z(this,"layerService",void 0),z(this,"config",void 0)}getName(){return""}getType(){return xS.Normal}init(t,r){this.config=r,this.rendererService=t.getContainer().rendererService,this.cameraService=t.getContainer().cameraService,this.mapService=t.getContainer().mapService,this.interactionService=t.getContainer().interactionService,this.layerService=t.getContainer().layerService,this.shaderModuleService=t.getContainer().shaderModuleService}render(t){}}class N3t extends Q5{getName(){return"clear"}init(t,r){super.init(t,r)}render(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}class k3t{constructor(t){z(this,"passes",[]),z(this,"layer",void 0),z(this,"renderFlag",void 0),z(this,"width",0),z(this,"height",0),this.postProcessor=t}setLayer(t){this.layer=t}setRenderFlag(t){this.renderFlag=t}getRenderFlag(){return this.renderFlag}getPostProcessor(){return this.postProcessor}render(){var t=this;return Pe(function*(){for(const r of t.passes)yield r.render(t.layer);yield t.postProcessor.render(t.layer)})()}resize(t,r){(this.width!==t||this.height!==r)&&(this.postProcessor.resize(t,r),this.width=t,this.height=r)}add(t,r){t.getType()===xS.PostProcessing?this.postProcessor.add(t,this.layer,r):(t.init(this.layer,r),this.passes.push(t))}insert(t,r,n){t.init(this.layer,r),this.passes.splice(n,0,t)}destroy(){this.passes.length=0}}class z3t extends Q5{constructor(...t){var r;super(...t),r=this,z(this,"pickingFBO",void 0),z(this,"layer",void 0),z(this,"width",0),z(this,"height",0),z(this,"alreadyInRendering",!1),z(this,"pickFromPickingFBO",({x:n,y:i,lngLat:a,type:o})=>{if(!this.layer.isVisible()||!this.layer.needPick(o))return;const{getViewportSize:s,readPixelsAsync:l,useFramebuffer:u}=this.rendererService,{width:c,height:f}=s(),{enableHighlight:d,enableSelect:v}=this.layer.getLayerConfig(),g=n*Fc,x=i*Fc;if(g>c||g<0||x>f||x<0)return;let w;u(this.pickingFBO,Pe(function*(){var S;if(w=yield l({x:Math.round(g),y:Math.round(f-(i+1)*Fc),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:r.pickingFBO}),w[0]!==0||w[1]!==0||w[2]!==0){const A=Oy(w),M=r.layer.getSource().getFeatureById(A),R={x:n,y:i,type:o,lngLat:a,featureId:A,feature:M};M&&(r.layer.setCurrentPickId(A),r.triggerHoverOnLayer(R))}else{const A={x:n,y:i,lngLat:a,type:r.layer.getCurrentPickId()===null?"un"+o:"mouseout",featureId:null,feature:null};r.triggerHoverOnLayer(Ce(Ce({},A),{},{type:"unpick"})),r.triggerHoverOnLayer(A),r.layer.setCurrentPickId(null)}d&&r.highlightPickedFeature(w),v&&o==="click"&&((S=w)===null||S===void 0?void 0:S.toString())!==[0,0,0,0].toString()&&r.selectFeature(w)}))})}getType(){return xS.Normal}getName(){return"pixelPicking"}init(t,r){super.init(t,r),this.layer=t;const{createTexture2D:n,createFramebuffer:i,getViewportSize:a}=this.rendererService,{width:o,height:s}=a(),l=n({width:o,height:s,wrapS:q.CLAMP_TO_EDGE,wrapT:q.CLAMP_TO_EDGE,label:"Picking Texture"});this.pickingFBO=i({color:l}),this.interactionService.on(Bc.Hover,this.pickFromPickingFBO),this.interactionService.on(Bc.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(Bc.Active,this.highlightFeatureHandle.bind(this))}render(t){if(this.alreadyInRendering)return;const{getViewportSize:r,useFramebuffer:n,clear:i}=this.rendererService,{width:a,height:o}=r();this.alreadyInRendering=!0,(this.width!==a||this.height!==o)&&(this.pickingFBO.resize({width:a,height:o}),this.width=a,this.height=o),n(this.pickingFBO,()=>{i({framebuffer:this.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});const s=this.layer.multiPassRenderer.getRenderFlag();this.layer.multiPassRenderer.setRenderFlag(!1),t.hooks.beforePickingEncode.call(),t.render(),t.hooks.afterPickingEncode.call(),this.layer.multiPassRenderer.setRenderFlag(s),this.alreadyInRendering=!1})}triggerHoverOnLayer(t){this.layer.emit(t.type,t)}highlightPickedFeature(t){const[r,n,i]=t;this.layer.hooks.beforeHighlight.call([r,n,i]),this.layerService.renderLayers()}selectFeature(t){const[r,n,i]=t;this.layer.hooks.beforeSelect.call([r,n,i]),this.layerService.renderLayers()}selectFeatureHandle({featureId:t}){const r=Rx(t);this.selectFeature(new Uint8Array(r))}highlightFeatureHandle({featureId:t}){const r=Rx(t);this.highlightPickedFeature(new Uint8Array(r))}}class U3t{constructor(t){z(this,"passes",[]),z(this,"readFBO",void 0),z(this,"writeFBO",void 0),this.rendererService=t,this.init()}getReadFBO(){return this.readFBO}getWriteFBO(){return this.writeFBO}getCurrentFBOTex(){const{getViewportSize:t,createTexture2D:r}=this.rendererService,{width:n,height:i}=t();return r({x:0,y:0,width:n,height:i,copy:!0})}getReadFBOTex(){var t=this;const{useFramebuffer:r}=this.rendererService;return new Promise(n=>{r(this.readFBO,Pe(function*(){n(t.getCurrentFBOTex())}))})}renderBloomPass(t,r){var n=this;return Pe(function*(){const i=yield n.getReadFBOTex();let a=0;for(;a<4;)yield r.render(t,i),n.swap(),a++})()}render(t){var r=this;return Pe(function*(){for(let n=0;n<r.passes.length;n++){const i=r.passes[n];i.setRenderToScreen(r.isLastEnabledPass(n)),i.getName()==="bloom"?yield r.renderBloomPass(t,i):(yield i.render(t),n!==r.passes.length-1&&r.swap())}})()}resize(t,r){this.readFBO.resize({width:t,height:r}),this.writeFBO.resize({width:t,height:r})}add(t,r,n){t.init(r,n),this.passes.push(t)}insert(t,r,n,i){t.init(n,i),this.passes.splice(r,0,t)}getPostProcessingPassByName(t){return this.passes.find(r=>r.getName()===t)}init(){const{createFramebuffer:t,createTexture2D:r}=this.rendererService;this.readFBO=t({color:r({width:1,height:1,wrapS:q.CLAMP_TO_EDGE,wrapT:q.CLAMP_TO_EDGE,usage:jy.RENDER_TARGET})}),this.writeFBO=t({color:r({width:1,height:1,wrapS:q.CLAMP_TO_EDGE,wrapT:q.CLAMP_TO_EDGE,usage:jy.RENDER_TARGET})})}isLastEnabledPass(t){for(let r=t+1;r<this.passes.length;r++)if(this.passes[r].isEnabled())return!1;return!0}swap(){const t=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=t}}class $3t extends Q5{getType(){return xS.Normal}getName(){return"render"}init(t,r){super.init(t,r)}render(t){const{useFramebuffer:r,clear:n}=this.rendererService,i=t.multiPassRenderer.getPostProcessor().getReadFBO();r(i,()=>{n({color:[0,0,0,0],depth:1,stencil:0,framebuffer:i}),t.multiPassRenderer.setRenderFlag(!1),t.models.forEach(a=>{a.draw({uniforms:t.layerModel.getUninforms()})}),t.multiPassRenderer.setRenderFlag(!0)})}}const H3t=`varying vec2 v_UV;

uniform float u_BloomFinal: 0.0;
uniform sampler2D u_Texture;
uniform sampler2D u_Texture2;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_radius: 5.0;
uniform float u_intensity: 0.3;
uniform float u_baseRadio: 0.5;

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

float luminance(vec4 color) {
  return  0.2125 * color.r + 0.7154 * color.g + 0.0721 * color.b;
}

void main() {
  // vec4 baseColor = texture2D(u_Texture, v_UV);

  float r = sqrt(u_radius);

  vec4 c1 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(u_radius, 0.0));
  // c1 *= luminance(c1);
  vec4 c2 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(0.0, u_radius));
  // c2 *= luminance(c2);
  vec4 c3 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, r));
  // c3 *= luminance(c3);
  vec4 c4 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, -r));
  // c4 *= luminance(c4);
  vec4 inbloomColor = (c1 + c2 + c3 + c4) * 0.25;

  // float lum = luminance(inbloomColor);
  // inbloomColor.rgb *= lum;

  if(u_BloomFinal > 0.0) {
    vec4 baseColor = texture2D(u_Texture2, v_UV);
    float baselum = luminance(baseColor);
    gl_FragColor = mix(inbloomColor, baseColor, u_baseRadio);
    if(baselum <= 0.2) {
      gl_FragColor = inbloomColor * u_intensity;
    }
  } else {
    gl_FragColor = inbloomColor;
  }
}`,V3t=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,{isNil:cO}=is;class G3t extends vg{setupShaders(){this.shaderModuleService.registerModule("blur-pass",{vs:V3t,fs:H3t});const{vs:t,fs:r,uniforms:n}=this.shaderModuleService.getModule("blur-pass"),{width:i,height:a}=this.rendererService.getViewportSize();return{vs:t,fs:r,uniforms:Ce(Ce({},n),{},{u_ViewportSize:[i,a]})}}convertOptionsToUniforms(t){const r={};return cO(t.bloomRadius)||(r.u_radius=t.bloomRadius),cO(t.bloomIntensity)||(r.u_intensity=t.bloomIntensity),cO(t.bloomBaseRadio)||(r.u_baseRadio=t.bloomBaseRadio),r}}const W3t=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,X3t=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,{isNil:j3t}=is;class Y3t extends vg{setupShaders(){this.shaderModuleService.registerModule("blur-pass",{vs:X3t,fs:W3t});const{vs:t,fs:r,uniforms:n}=this.shaderModuleService.getModule("blur-pass"),{width:i,height:a}=this.rendererService.getViewportSize();return{vs:t,fs:r,uniforms:Ce(Ce({},n),{},{u_ViewportSize:[i,a]})}}convertOptionsToUniforms(t){const r={};return j3t(t.blurRadius)||(r.u_BlurDir=[t.blurRadius,0]),r}}const Z3t=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,q3t=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,{isNil:K3t}=is;class Q3t extends vg{setupShaders(){this.shaderModuleService.registerModule("blur-pass",{vs:q3t,fs:Z3t});const{vs:t,fs:r,uniforms:n}=this.shaderModuleService.getModule("blur-pass"),{width:i,height:a}=this.rendererService.getViewportSize();return{vs:t,fs:r,uniforms:Ce(Ce({},n),{},{u_ViewportSize:[i,a]})}}convertOptionsToUniforms(t){const r={};return K3t(t.blurRadius)||(r.u_BlurDir=[0,t.blurRadius]),r}}const J3t=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Angle : 0;
uniform float u_Size : 8;

#pragma include "common"

float scale = PI / u_Size;

float pattern(float u_Angle, vec2 texSize, vec2 texCoord) {
  float s = sin(u_Angle), c = cos(u_Angle);
  vec2 tex = texCoord * texSize - u_Center * texSize;
  vec2 point = vec2(
    c * tex.x - s * tex.y,
    s * tex.x + c * tex.y
  ) * scale;
  return (sin(point.x) * sin(point.y)) * 4.0;
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js
vec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {
  vec3 cmy = 1.0 - color.rgb;
  float k = min(cmy.x, min(cmy.y, cmy.z));
  cmy = (cmy - k) / (1.0 - k);
  cmy = clamp(
    cmy * 10.0 - 3.0 + vec3(
      pattern(u_Angle + 0.26179, texSize, texCoord),
      pattern(u_Angle + 1.30899, texSize, texCoord),
      pattern(u_Angle, texSize, texCoord)
    ),
    0.0,
    1.0
  );
  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);
  return vec4(1.0 - cmy - k, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);
}`,tLt=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;class eLt extends vg{setupShaders(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:tLt,fs:J3t});const{vs:t,fs:r,uniforms:n}=this.shaderModuleService.getModule("colorhalftone-pass"),{width:i,height:a}=this.rendererService.getViewportSize();return{vs:t,fs:r,uniforms:Ce(Ce({},n),{},{u_ViewportSize:[i,a]})}}}const rLt=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,nLt=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;class iLt extends vg{setupShaders(){return this.shaderModuleService.registerModule("copy-pass",{vs:nLt,fs:rLt}),this.shaderModuleService.getModule("copy-pass")}}const aLt=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Scale : 10;

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js
vec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;
  tex.y /= 0.866025404;
  tex.x -= tex.y * 0.5;
  vec2 a;
  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {
    a = vec2(floor(tex.x), floor(tex.y));
  }
  else a = vec2(ceil(tex.x), ceil(tex.y));
  vec2 b = vec2(ceil(tex.x), floor(tex.y));
  vec2 c = vec2(floor(tex.x), ceil(tex.y));
  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);
  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);
  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);
  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);
  float alen = length(TEX - A);
  float blen = length(TEX - B);
  float clen = length(TEX - C);
  vec2 choice;
  if (alen < blen) {
    if (alen < clen) choice = a;
    else choice = c;
  } else {
    if (blen < clen) choice = b;
    else choice = c;
  }
  choice.x += choice.y * 0.5;
  choice.y *= 0.866025404;
  choice *= u_Scale / texSize;
  return texture2D(texture, choice + u_Center);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,oLt=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;class sLt extends vg{setupShaders(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:oLt,fs:aLt});const{vs:t,fs:r,uniforms:n}=this.shaderModuleService.getModule("hexagonalpixelate-pass"),{width:i,height:a}=this.rendererService.getViewportSize();return{vs:t,fs:r,uniforms:Ce(Ce({},n),{},{u_ViewportSize:[i,a]})}}}const lLt=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_Strength : 0.6;

vec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 dx = vec2(1.0 / texSize.x, 0.0);
  vec2 dy = vec2(0.0, 1.0 / texSize.y);
  vec4 color = texture2D(texture, texCoord);
  float bigTotal = 0.0;
  float smallTotal = 0.0;
  vec3 bigAverage = vec3(0.0);
  vec3 smallAverage = vec3(0.0);
  for (float x = -2.0; x <= 2.0; x += 1.0) {
    for (float y = -2.0; y <= 2.0; y += 1.0) {
      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;
      bigAverage += sample;
      bigTotal += 1.0;
      if (abs(x) + abs(y) < 2.0) {
        smallAverage += sample;
        smallTotal += 1.0;
      }
    }
  }
  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);
  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;
  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,uLt=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;class cLt extends vg{setupShaders(){this.shaderModuleService.registerModule("ink-pass",{vs:uLt,fs:lLt});const{vs:t,fs:r,uniforms:n}=this.shaderModuleService.getModule("ink-pass"),{width:i,height:a}=this.rendererService.getViewportSize();return{vs:t,fs:r,uniforms:Ce(Ce({},n),{},{u_ViewportSize:[i,a]})}}}const hLt=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform float u_Amount : 0.5;

float rand(vec2 co) {
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js
vec4 noise_filterColor(vec4 color, vec2 texCoord) {
  float diff = (rand(texCoord) - 0.5) * u_Amount;
  color.r += diff;
  color.g += diff;
  color.b += diff;
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);
}`,fLt=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;class dLt extends vg{setupShaders(){return this.shaderModuleService.registerModule("noise-pass",{vs:fLt,fs:hLt}),this.shaderModuleService.getModule("noise-pass")}}const pLt=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,vLt=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform float u_Amount : 0.5;

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js
vec4 sepia_filterColor(vec4 color) {
  float r = color.r;
  float g = color.g;
  float b = color.b;
  color.r =
    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));
  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));
  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = sepia_filterColor(gl_FragColor);
}`;class gLt extends vg{setupShaders(){return this.shaderModuleService.registerModule("sepia-pass",{vs:pLt,fs:vLt}),this.shaderModuleService.getModule("sepia-pass")}}const eQ=new mIt;let mLt=0;function yLt(){const e=new F3t,t=new bIt,r=new lIt,n=new xIt(r),i=new URt,a=new HRt,o=new hIt,s=new fIt,l=new cIt,u={id:`${mLt++}`,globalConfigService:eQ,shaderModuleService:e,debugService:t,cameraService:r,coordinateSystemService:n,fontService:i,iconService:a,markerService:o,popupService:s,controlService:l,customRenderService:{}},c=new IIt(u);u.layerService=c;const f=new w3t(u);u.sceneService=f;const d=new CIt(u);u.interactionService=d;const v=new MIt(u);u.pickingService=v;const g={clear:new N3t,pixelPicking:new z3t,render:new $3t};u.normalPassFactory=w=>g[w];const x={copy:new iLt,bloom:new G3t,blurH:new Y3t,blurV:new Q3t,noise:new dLt,sepia:new gLt,colorHalftone:new eLt,hexagonalPixelate:new sLt,ink:new cLt};return u.postProcessingPass=x,u.postProcessingPassFactory=w=>x[w],u}function Ow(e){const t=Ce({},e);return t.postProcessor=new U3t(t.rendererService),t.multiPassRenderer=new k3t(t.postProcessor),t.styleAttributeService=new NIt(t.rendererService),t}const q2=["loaded","fontloaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"];let nu=function(e){return e.IMAGE="image",e.CUSTOMIMAGE="customImage",e.ARRAYBUFFER="arraybuffer",e.RGB="rgb",e.TERRAINRGB="terrainRGB",e.CUSTOMRGB="customRGB",e.CUSTOMARRAYBUFFER="customArrayBuffer",e.CUSTOMTERRAINRGB="customTerrainRGB",e}({});var rQ=(e,t,r)=>new Promise((n,i)=>{var a=l=>{try{s(r.next(l))}catch(u){i(u)}},o=l=>{try{s(r.throw(l))}catch(u){i(u)}},s=l=>l.done?n(l.value):Promise.resolve(l.value).then(a,o);s((r=r.apply(e,t)).next())}),_Lt=(e,t,r,n)=>rQ(void 0,null,function*(){return new Promise((i,a)=>{t({x:e.x,y:e.y,z:e.z},(o,s)=>{if(o||s.length===0){a(o);return}s&&cD([{data:s,bands:[0]}],r,n,(l,u)=>{l?a(l):u&&i(u)})})})}),xLt=(e,t)=>rQ(void 0,null,function*(){return new Promise((r,n)=>{t({x:e.x,y:e.y,z:e.z},(i,a)=>{if(i||!a){n(i);return}a instanceof ArrayBuffer?Mft(a,(o,s)=>{o&&n(o),r(s)}):a instanceof HTMLImageElement?r(a):n(i)})})});function bLt(e,t){return Array.isArray(e)?typeof e[0]=="string"?e.map(r=>ox(r,t)):e.map(r=>({url:ox(r.url,t),bands:r.bands||[0]})):ox(e,t)}function ELt(e){return typeof e=="string"?[{url:e,bands:[0]}]:typeof e[0]=="string"?e.map(t=>({url:t,bands:[0]})):e}function FU(e,t){e.xhrCancel=()=>{t.map(r=>{r.abort()})}}var wLt=Object.defineProperty,CLt=Object.defineProperties,SLt=Object.getOwnPropertyDescriptors,BU=Object.getOwnPropertySymbols,TLt=Object.prototype.hasOwnProperty,ALt=Object.prototype.propertyIsEnumerable,NU=(e,t,r)=>t in e?wLt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,kU=(e,t)=>{for(var r in t||(t={}))TLt.call(t,r)&&NU(e,r,t[r]);if(BU)for(var r of BU(t))ALt.call(t,r)&&NU(e,r,t[r]);return e},zU=(e,t)=>CLt(e,SLt(t)),nQ=(e,t,r)=>new Promise((n,i)=>{var a=l=>{try{s(r.next(l))}catch(u){i(u)}},o=l=>{try{s(r.throw(l))}catch(u){i(u)}},s=l=>l.done?n(l.value):Promise.resolve(l.value).then(a,o);s((r=r.apply(e,t)).next())}),MLt=(e,t,r,n,i)=>nQ(void 0,null,function*(){const a=ELt(t.url);if(a.length>1){const{rasterFiles:o,xhrList:s,errList:l}=yield RLt(a,t);if(FU(e,s),l.length>0){r(l,null);return}cD(o,n,i,r)}else{const o=C5(t,(s,l)=>{if(s)r(s);else if(l){const u=[{data:l,bands:a[0].bands}];cD(u,n,i,r)}});FU(e,[o])}});function RLt(e,t){return nQ(this,null,function*(){const r=[],n=[],i=[];for(let a=0;a<e.length;a++){const o=e[a],s=zU(kU({},t),{url:o.url}),l=o.bands,{err:u,data:c,xhr:f}=yield Sft(zU(kU({},s),{type:"arrayBuffer"}));u&&i.push(u),n.push(f),r.push({data:c,bands:l})}return{rasterFiles:r,xhrList:n,errList:i}})}var ILt=Object.defineProperty,LLt=Object.defineProperties,OLt=Object.getOwnPropertyDescriptors,UU=Object.getOwnPropertySymbols,PLt=Object.prototype.hasOwnProperty,DLt=Object.prototype.propertyIsEnumerable,$U=(e,t,r)=>t in e?ILt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,SA=(e,t)=>{for(var r in t||(t={}))PLt.call(t,r)&&$U(e,r,t[r]);if(UU)for(var r of UU(t))DLt.call(t,r)&&$U(e,r,t[r]);return e},iQ=(e,t)=>LLt(e,OLt(t)),aQ=(e,t,r)=>new Promise((n,i)=>{var a=l=>{try{s(r.next(l))}catch(u){i(u)}},o=l=>{try{s(r.throw(l))}catch(u){i(u)}},s=l=>l.done?n(l.value):Promise.resolve(l.value).then(a,o);s((r=r.apply(e,t)).next())}),FLt=(e,t,r,n)=>aQ(void 0,null,function*(){const{format:i=oQ,operation:a,requestParameters:o={}}=n,s=iQ(SA({},o),{url:bLt(e,t)});return new Promise((l,u)=>{MLt(r,s,(c,f)=>{c?u(c):f&&l(f)},i,a)})}),HU=(e,t,r,n)=>aQ(void 0,null,function*(){let i;const a=Array.isArray(e)?e[0]:e;return n.wmtsOptions?i=((n==null?void 0:n.getURLFromTemplate)||nAt)(a,SA(SA({},t),n.wmtsOptions)):i=((n==null?void 0:n.getURLFromTemplate)||ox)(a,t),new Promise((o,s)=>{var l;const u=jP(iQ(SA({},n==null?void 0:n.requestParameters),{url:i,type:((l=n==null?void 0:n.requestParameters)==null?void 0:l.type)||"arrayBuffer"}),(c,f)=>{c?s(c):f&&o(f)},n.transformResponse);r.xhrCancel=()=>u.cancel()})}),oQ=()=>({rasterData:new Uint8Array([0]),width:1,height:1}),BLt=Object.defineProperty,NLt=Object.defineProperties,kLt=Object.getOwnPropertyDescriptors,VU=Object.getOwnPropertySymbols,zLt=Object.prototype.hasOwnProperty,ULt=Object.prototype.propertyIsEnumerable,GU=(e,t,r)=>t in e?BLt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,WU=(e,t)=>{for(var r in t||(t={}))zLt.call(t,r)&&GU(e,r,t[r]);if(VU)for(var r of VU(t))ULt.call(t,r)&&GU(e,r,t[r]);return e},$Lt=(e,t)=>NLt(e,kLt(t)),HLt={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0};nu.ARRAYBUFFER,nu.RGB;function VLt(e){return!!(Array.isArray(e)&&e.length===0||!Array.isArray(e)&&typeof e!="string")}function GLt(e,t={}){if(VLt(e))throw new Error("tile server url is error");const{extent:r=[1/0,1/0,-1/0,-1/0],coordinates:n}=t;let i=(t==null?void 0:t.dataType)||nu.IMAGE;i===nu.RGB&&(i=nu.ARRAYBUFFER);const a=(l,u)=>{switch(i){case nu.IMAGE:return HU(e,l,u,t);case nu.CUSTOMIMAGE:case nu.CUSTOMTERRAINRGB:return xLt(u,t==null?void 0:t.getCustomData);case nu.ARRAYBUFFER:return FLt(e,l,u,t);case nu.CUSTOMARRAYBUFFER:case nu.CUSTOMRGB:return _Lt(u,t==null?void 0:t.getCustomData,(t==null?void 0:t.format)||oQ,t==null?void 0:t.operation);default:return HU(e,l,u,t)}},o=$Lt(WU(WU({},HLt),t),{getTileData:a}),s=_b(n,r);return{data:e,dataArray:[{_id:1,coordinates:s}],tilesetOptions:o,isTile:!0}}var WLt=Object.defineProperty,XLt=Object.defineProperties,jLt=Object.getOwnPropertyDescriptors,yM=Object.getOwnPropertySymbols,sQ=Object.prototype.hasOwnProperty,lQ=Object.prototype.propertyIsEnumerable,XU=(e,t,r)=>t in e?WLt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,YLt=(e,t)=>{for(var r in t||(t={}))sQ.call(t,r)&&XU(e,r,t[r]);if(yM)for(var r of yM(t))lQ.call(t,r)&&XU(e,r,t[r]);return e},ZLt=(e,t)=>XLt(e,jLt(t)),qLt=(e,t)=>{var r={};for(var n in e)sQ.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&yM)for(var n of yM(e))t.indexOf(n)<0&&lQ.call(e,n)&&(r[n]=e[n]);return r};function KLt(e,t){const r=t,{extent:n=[121.168,30.2828,121.384,30.4219],coordinates:i,width:a,height:o}=r,s=qLt(r,["extent","coordinates","width","height"]);e.length<2&&console.warn("RGB解析需要2个波段的数据");const[l,u]=s.bands||[0,1],c=[e[l],e[u]],f=[];for(let g=0;g<c[0].length;g++)f.push((c[1][g]-c[0][g])/(c[1][g]+c[0][g]));const d=_b(i,n);return{_id:1,dataArray:[ZLt(YLt({_id:1,data:f,width:a,height:o},s),{coordinates:d})]}}var QLt=Object.defineProperty,JLt=Object.defineProperties,tOt=Object.getOwnPropertyDescriptors,_M=Object.getOwnPropertySymbols,uQ=Object.prototype.hasOwnProperty,cQ=Object.prototype.propertyIsEnumerable,jU=(e,t,r)=>t in e?QLt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,eOt=(e,t)=>{for(var r in t||(t={}))uQ.call(t,r)&&jU(e,r,t[r]);if(_M)for(var r of _M(t))cQ.call(t,r)&&jU(e,r,t[r]);return e},rOt=(e,t)=>JLt(e,tOt(t)),nOt=(e,t)=>{var r={};for(var n in e)uQ.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&_M)for(var n of _M(e))t.indexOf(n)<0&&cQ.call(e,n)&&(r[n]=e[n]);return r};function iOt(e,t){const r=t,{extent:n,coordinates:i,width:a,height:o}=r,s=nOt(r,["extent","coordinates","width","height"]);e.length<3&&console.warn("RGB解析需要三个波段的数据");const[l,u,c]=s.bands||[0,1,2],f=[e[l],e[u],e[c]],d=[],[v,g]=(s==null?void 0:s.countCut)||[2,98],x=(s==null?void 0:s.RMinMax)||lx(f[0],v,g),w=(s==null?void 0:s.GMinMax)||lx(f[1],v,g),S=(s==null?void 0:s.BMinMax)||lx(f[2],v,g);for(let R=0;R<f[0].length;R++)d.push(Math.max(0,f[0][R]-x[0])),d.push(Math.max(0,f[1][R]-w[0])),d.push(Math.max(0,f[2][R]-S[0]));const A=_b(i,n);return{_id:1,dataArray:[rOt(eOt({_id:1,data:d,width:a,height:o,rMinMax:x,gMinMax:w,bMinMax:S},s),{coordinates:A})]}}var aOt=Object.defineProperty,oOt=Object.defineProperties,sOt=Object.getOwnPropertyDescriptors,xM=Object.getOwnPropertySymbols,hQ=Object.prototype.hasOwnProperty,fQ=Object.prototype.propertyIsEnumerable,YU=(e,t,r)=>t in e?aOt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,lOt=(e,t)=>{for(var r in t||(t={}))hQ.call(t,r)&&YU(e,r,t[r]);if(xM)for(var r of xM(t))fQ.call(t,r)&&YU(e,r,t[r]);return e},uOt=(e,t)=>oOt(e,sOt(t)),cOt=(e,t)=>{var r={};for(var n in e)hQ.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&xM)for(var n of xM(e))t.indexOf(n)<0&&fQ.call(e,n)&&(r[n]=e[n]);return r};function hOt(e,t){const r=t,{extent:n,coordinates:i,min:a,max:o,width:s,height:l,format:u,operation:c}=r,f=cOt(r,["extent","coordinates","min","max","width","height","format","operation"]);let d;if(u===void 0||wK(e))d=Array.from(e);else{const x=Array.isArray(e)?e:[e];d=j5(x,u,c)}const v=_b(i,n);return{_id:1,dataArray:[uOt(lOt({_id:1,data:d,width:s,height:l},f),{min:a,max:o,coordinates:v})]}}var fOt=Object.defineProperty,dOt=Object.defineProperties,pOt=Object.getOwnPropertyDescriptors,ZU=Object.getOwnPropertySymbols,vOt=Object.prototype.hasOwnProperty,gOt=Object.prototype.propertyIsEnumerable,qU=(e,t,r)=>t in e?fOt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,KU=(e,t)=>{for(var r in t||(t={}))vOt.call(t,r)&&qU(e,r,t[r]);if(ZU)for(var r of ZU(t))gOt.call(t,r)&&qU(e,r,t[r]);return e},mOt=(e,t)=>dOt(e,pOt(t)),yOt=(e,t,r)=>new Promise((n,i)=>{var a=l=>{try{s(r.next(l))}catch(u){i(u)}},o=l=>{try{s(r.throw(l))}catch(u){i(u)}},s=l=>l.done?n(l.value):Promise.resolve(l.value).then(a,o);s((r=r.apply(e,t)).next())}),_Ot={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0},xOt=e=>yOt(void 0,null,function*(){return new Promise(t=>{const[r,n,i,a]=e.bounds,o={layers:{testTile:{features:[{type:"Feature",properties:{key:e.x+"/"+e.y+"/"+e.z,x:(r+i)/2,y:(n+a)/2},geometry:{type:"LineString",coordinates:[[i,a],[i,n],[r,n],[r,n]]}}]}}};t(o)})});function bOt(e,t){const r=i=>xOt(i),n=mOt(KU(KU({},_Ot),t),{getTileData:r});return{data:e,dataArray:[],tilesetOptions:n,isTile:!0}}var dQ={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(Cm,function(){function r(Y,X,tt,it,Et,Tt){if(!(Et-it<=tt)){var pt=it+Et>>1;n(Y,X,pt,it,Et,Tt%2),r(Y,X,tt,it,pt-1,Tt+1),r(Y,X,tt,pt+1,Et,Tt+1)}}function n(Y,X,tt,it,Et,Tt){for(;Et>it;){if(Et-it>600){var pt=Et-it+1,kt=tt-it+1,ae=Math.log(pt),Kt=.5*Math.exp(2*ae/3),re=.5*Math.sqrt(ae*Kt*(pt-Kt)/pt)*(kt-pt/2<0?-1:1),fe=Math.max(it,Math.floor(tt-kt*Kt/pt+re)),Oe=Math.min(Et,Math.floor(tt+(pt-kt)*Kt/pt+re));n(Y,X,tt,fe,Oe,Tt)}var Ye=X[2*tt+Tt],Be=it,De=Et;for(i(Y,X,it,tt),X[2*Et+Tt]>Ye&&i(Y,X,it,Et);Be<De;){for(i(Y,X,Be,De),Be++,De--;X[2*Be+Tt]<Ye;)Be++;for(;X[2*De+Tt]>Ye;)De--}X[2*it+Tt]===Ye?i(Y,X,it,De):(De++,i(Y,X,De,Et)),De<=tt&&(it=De+1),tt<=De&&(Et=De-1)}}function i(Y,X,tt,it){a(Y,tt,it),a(X,2*tt,2*it),a(X,2*tt+1,2*it+1)}function a(Y,X,tt){var it=Y[X];Y[X]=Y[tt],Y[tt]=it}function o(Y,X,tt,it,Et,Tt,pt){for(var kt=[0,Y.length-1,0],ae=[],Kt,re;kt.length;){var fe=kt.pop(),Oe=kt.pop(),Ye=kt.pop();if(Oe-Ye<=pt){for(var Be=Ye;Be<=Oe;Be++)Kt=X[2*Be],re=X[2*Be+1],Kt>=tt&&Kt<=Et&&re>=it&&re<=Tt&&ae.push(Y[Be]);continue}var De=Math.floor((Ye+Oe)/2);Kt=X[2*De],re=X[2*De+1],Kt>=tt&&Kt<=Et&&re>=it&&re<=Tt&&ae.push(Y[De]);var Yr=(fe+1)%2;(fe===0?tt<=Kt:it<=re)&&(kt.push(Ye),kt.push(De-1),kt.push(Yr)),(fe===0?Et>=Kt:Tt>=re)&&(kt.push(De+1),kt.push(Oe),kt.push(Yr))}return ae}function s(Y,X,tt,it,Et,Tt){for(var pt=[0,Y.length-1,0],kt=[],ae=Et*Et;pt.length;){var Kt=pt.pop(),re=pt.pop(),fe=pt.pop();if(re-fe<=Tt){for(var Oe=fe;Oe<=re;Oe++)l(X[2*Oe],X[2*Oe+1],tt,it)<=ae&&kt.push(Y[Oe]);continue}var Ye=Math.floor((fe+re)/2),Be=X[2*Ye],De=X[2*Ye+1];l(Be,De,tt,it)<=ae&&kt.push(Y[Ye]);var Yr=(Kt+1)%2;(Kt===0?tt-Et<=Be:it-Et<=De)&&(pt.push(fe),pt.push(Ye-1),pt.push(Yr)),(Kt===0?tt+Et>=Be:it+Et>=De)&&(pt.push(Ye+1),pt.push(re),pt.push(Yr))}return kt}function l(Y,X,tt,it){var Et=Y-tt,Tt=X-it;return Et*Et+Tt*Tt}var u=function(Y){return Y[0]},c=function(Y){return Y[1]},f=function(X,tt,it,Et,Tt){tt===void 0&&(tt=u),it===void 0&&(it=c),Et===void 0&&(Et=64),Tt===void 0&&(Tt=Float64Array),this.nodeSize=Et,this.points=X;for(var pt=X.length<65536?Uint16Array:Uint32Array,kt=this.ids=new pt(X.length),ae=this.coords=new Tt(X.length*2),Kt=0;Kt<X.length;Kt++)kt[Kt]=Kt,ae[2*Kt]=tt(X[Kt]),ae[2*Kt+1]=it(X[Kt]);r(kt,ae,Et,0,kt.length-1,0)};f.prototype.range=function(X,tt,it,Et){return o(this.ids,this.coords,X,tt,it,Et,this.nodeSize)},f.prototype.within=function(X,tt,it){return s(this.ids,this.coords,X,tt,it,this.nodeSize)};var d={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(Y){return Y}},v=Math.fround||function(Y){return function(X){return Y[0]=+X,Y[0]}}(new Float32Array(1)),g=function(X){this.options=k(Object.create(d),X),this.trees=new Array(this.options.maxZoom+1)};g.prototype.load=function(X){var tt=this.options,it=tt.log,Et=tt.minZoom,Tt=tt.maxZoom,pt=tt.nodeSize;it&&console.time("total time");var kt="prepare "+X.length+" points";it&&console.time(kt),this.points=X;for(var ae=[],Kt=0;Kt<X.length;Kt++)X[Kt].geometry&&ae.push(w(X[Kt],Kt));this.trees[Tt+1]=new f(ae,V,Q,pt,Float32Array),it&&console.timeEnd(kt);for(var re=Tt;re>=Et;re--){var fe=+Date.now();ae=this._cluster(ae,re),this.trees[re]=new f(ae,V,Q,pt,Float32Array),it&&console.log("z%d: %d clusters in %dms",re,ae.length,+Date.now()-fe)}return it&&console.timeEnd("total time"),this},g.prototype.getClusters=function(X,tt){var it=((X[0]+180)%360+360)%360-180,Et=Math.max(-90,Math.min(90,X[1])),Tt=X[2]===180?180:((X[2]+180)%360+360)%360-180,pt=Math.max(-90,Math.min(90,X[3]));if(X[2]-X[0]>=360)it=-180,Tt=180;else if(it>Tt){var kt=this.getClusters([it,Et,180,pt],tt),ae=this.getClusters([-180,Et,Tt,pt],tt);return kt.concat(ae)}for(var Kt=this.trees[this._limitZoom(tt)],re=Kt.range(M(it),R(pt),M(Tt),R(Et)),fe=[],Oe=0,Ye=re;Oe<Ye.length;Oe+=1){var Be=Ye[Oe],De=Kt.points[Be];fe.push(De.numPoints?S(De):this.points[De.index])}return fe},g.prototype.getChildren=function(X){var tt=this._getOriginId(X),it=this._getOriginZoom(X),Et="No cluster with the specified id.",Tt=this.trees[it];if(!Tt)throw new Error(Et);var pt=Tt.points[tt];if(!pt)throw new Error(Et);for(var kt=this.options.radius/(this.options.extent*Math.pow(2,it-1)),ae=Tt.within(pt.x,pt.y,kt),Kt=[],re=0,fe=ae;re<fe.length;re+=1){var Oe=fe[re],Ye=Tt.points[Oe];Ye.parentId===X&&Kt.push(Ye.numPoints?S(Ye):this.points[Ye.index])}if(Kt.length===0)throw new Error(Et);return Kt},g.prototype.getLeaves=function(X,tt,it){tt=tt||10,it=it||0;var Et=[];return this._appendLeaves(Et,X,tt,it,0),Et},g.prototype.getTile=function(X,tt,it){var Et=this.trees[this._limitZoom(X)],Tt=Math.pow(2,X),pt=this.options,kt=pt.extent,ae=pt.radius,Kt=ae/kt,re=(it-Kt)/Tt,fe=(it+1+Kt)/Tt,Oe={features:[]};return this._addTileFeatures(Et.range((tt-Kt)/Tt,re,(tt+1+Kt)/Tt,fe),Et.points,tt,it,Tt,Oe),tt===0&&this._addTileFeatures(Et.range(1-Kt/Tt,re,1,fe),Et.points,Tt,it,Tt,Oe),tt===Tt-1&&this._addTileFeatures(Et.range(0,re,Kt/Tt,fe),Et.points,-1,it,Tt,Oe),Oe.features.length?Oe:null},g.prototype.getClusterExpansionZoom=function(X){for(var tt=this._getOriginZoom(X)-1;tt<=this.options.maxZoom;){var it=this.getChildren(X);if(tt++,it.length!==1)break;X=it[0].properties.cluster_id}return tt},g.prototype._appendLeaves=function(X,tt,it,Et,Tt){for(var pt=this.getChildren(tt),kt=0,ae=pt;kt<ae.length;kt+=1){var Kt=ae[kt],re=Kt.properties;if(re&&re.cluster?Tt+re.point_count<=Et?Tt+=re.point_count:Tt=this._appendLeaves(X,re.cluster_id,it,Et,Tt):Tt<Et?Tt++:X.push(Kt),X.length===it)break}return Tt},g.prototype._addTileFeatures=function(X,tt,it,Et,Tt,pt){for(var kt=0,ae=X;kt<ae.length;kt+=1){var Kt=ae[kt],re=tt[Kt],fe=re.numPoints,Oe=void 0,Ye=void 0,Be=void 0;if(fe)Oe=A(re),Ye=re.x,Be=re.y;else{var De=this.points[re.index];Oe=De.properties,Ye=M(De.geometry.coordinates[0]),Be=R(De.geometry.coordinates[1])}var Yr={type:1,geometry:[[Math.round(this.options.extent*(Ye*Tt-it)),Math.round(this.options.extent*(Be*Tt-Et))]],tags:Oe},Gr=void 0;fe?Gr=re.id:this.options.generateId?Gr=re.index:this.points[re.index].id&&(Gr=this.points[re.index].id),Gr!==void 0&&(Yr.id=Gr),pt.features.push(Yr)}},g.prototype._limitZoom=function(X){return Math.max(this.options.minZoom,Math.min(Math.floor(+X),this.options.maxZoom+1))},g.prototype._cluster=function(X,tt){for(var it=[],Et=this.options,Tt=Et.radius,pt=Et.extent,kt=Et.reduce,ae=Et.minPoints,Kt=Tt/(pt*Math.pow(2,tt)),re=0;re<X.length;re++){var fe=X[re];if(!(fe.zoom<=tt)){fe.zoom=tt;for(var Oe=this.trees[tt+1],Ye=Oe.within(fe.x,fe.y,Kt),Be=fe.numPoints||1,De=Be,Yr=0,Gr=Ye;Yr<Gr.length;Yr+=1){var Mn=Gr[Yr],ee=Oe.points[Mn];ee.zoom>tt&&(De+=ee.numPoints||1)}if(De>Be&&De>=ae){for(var rr=fe.x*Be,Nr=fe.y*Be,Fe=kt&&Be>1?this._map(fe,!0):null,Hr=(re<<5)+(tt+1)+this.points.length,_n=0,Kn=Ye;_n<Kn.length;_n+=1){var vn=Kn[_n],xn=Oe.points[vn];if(!(xn.zoom<=tt)){xn.zoom=tt;var ui=xn.numPoints||1;rr+=xn.x*ui,Nr+=xn.y*ui,xn.parentId=Hr,kt&&(Fe||(Fe=this._map(fe,!0)),kt(Fe,this._map(xn)))}}fe.parentId=Hr,it.push(x(rr/De,Nr/De,Hr,De,Fe))}else if(it.push(fe),De>1)for(var Ao=0,ta=Ye;Ao<ta.length;Ao+=1){var oa=ta[Ao],as=Oe.points[oa];as.zoom<=tt||(as.zoom=tt,it.push(as))}}}return it},g.prototype._getOriginId=function(X){return X-this.points.length>>5},g.prototype._getOriginZoom=function(X){return(X-this.points.length)%32},g.prototype._map=function(X,tt){if(X.numPoints)return tt?k({},X.properties):X.properties;var it=this.points[X.index].properties,Et=this.options.map(it);return tt&&Et===it?k({},Et):Et};function x(Y,X,tt,it,Et){return{x:v(Y),y:v(X),zoom:1/0,id:tt,parentId:-1,numPoints:it,properties:Et}}function w(Y,X){var tt=Y.geometry.coordinates,it=tt[0],Et=tt[1];return{x:v(M(it)),y:v(R(Et)),zoom:1/0,index:X,parentId:-1}}function S(Y){return{type:"Feature",id:Y.id,properties:A(Y),geometry:{type:"Point",coordinates:[O(Y.x),N(Y.y)]}}}function A(Y){var X=Y.numPoints,tt=X>=1e4?Math.round(X/1e3)+"k":X>=1e3?Math.round(X/100)/10+"k":X;return k(k({},Y.properties),{cluster:!0,cluster_id:Y.id,point_count:X,point_count_abbreviated:tt})}function M(Y){return Y/360+.5}function R(Y){var X=Math.sin(Y*Math.PI/180),tt=.5-.25*Math.log((1+X)/(1-X))/Math.PI;return tt<0?0:tt>1?1:tt}function O(Y){return(Y-.5)*360}function N(Y){var X=(180-Y*360)*Math.PI/180;return 360*Math.atan(Math.exp(X))/Math.PI-90}function k(Y,X){for(var tt in X)Y[tt]=X[tt];return Y}function V(Y){return Y.x}function Q(Y){return Y.y}return g})})(dQ);var EOt=dQ.exports;const wOt=aa(EOt);var COt=Object.defineProperty,QU=Object.getOwnPropertySymbols,SOt=Object.prototype.hasOwnProperty,TOt=Object.prototype.propertyIsEnumerable,JU=(e,t,r)=>t in e?COt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,pQ=(e,t)=>{for(var r in t||(t={}))SOt.call(t,r)&&JU(e,r,t[r]);if(QU)for(var r of QU(t))TOt.call(t,r)&&JU(e,r,t[r]);return e};function vQ(e,t){const{radius:r=40,maxZoom:n=18,minZoom:i=0,zoom:a=2}=t;if(e.pointIndex){const l=e.pointIndex.getClusters(e.extent,Math.floor(a));return e.dataArray=AOt(l),e}const o=new wOt({radius:r,minZoom:i,maxZoom:n}),s={type:"FeatureCollection",features:[]};return s.features=e.dataArray.map(l=>({type:"Feature",geometry:{type:"Point",coordinates:l.coordinates},properties:pQ({},l)})),o.load(s.features),o}function AOt(e){return e.map((t,r)=>pQ({coordinates:t.geometry.coordinates,_id:r+1},t.properties))}function MOt(e){if(e.length===0)throw new Error("max requires at least one data point");let t=e[0];for(let r=1;r<e.length;r++)e[r]>t&&(t=e[r]);return t}function ROt(e){if(e.length===0)throw new Error("min requires at least one data point");let t=e[0];for(let r=1;r<e.length;r++)e[r]<t&&(t=e[r]);return t}function gQ(e){if(e.length===0)return 0;let t=e[0],r=0,n;for(let i=1;i<e.length;i++)n=t+e[i]*1,Math.abs(t)>=Math.abs(e[i])?r+=t-n+e[i]:r+=e[i]-n+t,t=n;return t+r*1}function IOt(e){if(e.length===0)throw new Error("mean requires at least one data point");return gQ(e)/e.length}var LOt={min:ROt,max:MOt,mean:IOt,sum:gQ},OOt=Object.defineProperty,t9=Object.getOwnPropertySymbols,POt=Object.prototype.hasOwnProperty,DOt=Object.prototype.propertyIsEnumerable,e9=(e,t,r)=>t in e?OOt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ME=(e,t)=>{for(var r in t||(t={}))POt.call(t,r)&&e9(e,r,t[r]);if(t9)for(var r of t9(t))DOt.call(t,r)&&e9(e,r,t[r]);return e},r9=(e,t,r)=>new Promise((n,i)=>{var a=l=>{try{s(r.next(l))}catch(u){i(u)}},o=l=>{try{s(r.throw(l))}catch(u){i(u)}},s=l=>l.done?n(l.value):Promise.resolve(l.value).then(a,o);s((r=r.apply(e,t)).next())}),{cloneDeep:FOt,isFunction:n9,isString:BOt,mergeWith:NOt}=is;function kOt(e,t){if(Array.isArray(t))return t}var zOt=class extends $u.EventEmitter{constructor(e,t){super(),this.type="source",this.isTile=!1,this.inited=!1,this.hooks={init:new Tp},this.parser={type:"geojson"},this.transforms=[],this.cluster=!1,this.clusterOptions={enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"},this.invalidExtent=!1,this.dataArrayChanged=!1,this.cfg={autoRender:!0},this.originData=e,this.initCfg(t),this.init().then(()=>{this.inited=!0,this.emit("update",{type:"inited"})})}getSourceCfg(){return this.cfg}getClusters(e){return this.clusterIndex.getClusters(this.caculClusterExtent(2),e)}getClustersLeaves(e){return this.clusterIndex.getLeaves(e,1/0)}getParserType(){return this.parser.type}updateClusterData(e){const{method:t="sum",field:r}=this.clusterOptions;let n=this.clusterIndex.getClusters(this.caculClusterExtent(2),Math.floor(e));this.clusterOptions.zoom=e,n.forEach(i=>{i.id||(i.properties.point_count=1)}),(r||n9(t))&&(n=n.map(i=>{const a=i.id;if(a){const s=this.clusterIndex.getLeaves(a,1/0).map(u=>u.properties);let l;if(BOt(t)&&r){const u=oAt(s,r);l=LOt[t](u)}n9(t)&&(l=t(s)),i.properties.stat=l}else i.properties.point_count=1;return i})),this.data=a7("geojson")({type:"FeatureCollection",features:n}),this.executeTrans()}getFeatureById(e){const{type:t="geojson",geometry:r}=this.parser;if(t==="geojson"&&!this.cluster){const n=e<this.originData.features.length?this.originData.features[e]:"null",i=FOt(n);if(i!=null&&i.properties&&(this.transforms.length!==0||this.dataArrayChanged)){const a=this.data.dataArray.find(o=>o._id===e);i.properties=a}return i}else return t==="json"&&r?this.data.dataArray.find(n=>n._id===e):e<this.data.dataArray.length?this.data.dataArray[e]:"null"}updateFeaturePropertiesById(e,t){this.data.dataArray=this.data.dataArray.map(r=>r._id===e?ME(ME({},r),t):r),this.dataArrayChanged=!0,this.emit("update",{type:"update"})}getFeatureId(e,t){const r=this.data.dataArray.find(n=>n[e]===t);return r==null?void 0:r._id}setData(e,t){this.originData=e,this.dataArrayChanged=!1,this.initCfg(t),this.init().then(()=>{this.emit("update",{type:"update"})})}reloadAllTile(){var e;(e=this.tileset)==null||e.reloadAll()}reloadTilebyId(e,t,r){var n;(n=this.tileset)==null||n.reloadTileById(e,t,r)}reloadTileByLnglat(e,t,r){var n;(n=this.tileset)==null||n.reloadTileByLnglat(e,t,r)}getTileExtent(e,t){var r;return(r=this.tileset)==null?void 0:r.getTileExtent(e,t)}getTileByZXY(e,t,r){var n;return(n=this.tileset)==null?void 0:n.getTileByZXY(e,t,r)}reloadTileByExtent(e,t){var r;(r=this.tileset)==null||r.reloadTileByExtent(e,t)}destroy(){var e;this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null,(e=this.tileset)==null||e.destroy()}processData(){return r9(this,null,function*(){return new Promise((e,t)=>{try{this.excuteParser(),this.initCluster(),this.executeTrans(),e({})}catch(r){t(r)}})})}initCfg(e){this.cfg=NOt(this.cfg,e,kOt);const t=this.cfg;t&&(t.parser&&(this.parser=t.parser),t.transforms&&(this.transforms=t.transforms),this.cluster=t.cluster||!1,t.clusterOptions&&(this.cluster=!0,this.clusterOptions=ME(ME({},this.clusterOptions),t.clusterOptions)))}init(){return r9(this,null,function*(){this.inited=!1,yield this.processData(),this.inited=!0})}excuteParser(){const e=this.parser,t=e.type||"geojson",r=a7(t);this.data=r(this.originData,e),this.tileset=this.initTileset(),!e.cancelExtent&&(this.extent=xTt(this.data.dataArray),this.setCenter(this.extent),this.invalidExtent=this.extent[0]===this.extent[2]||this.extent[1]===this.extent[3])}setCenter(e){this.center=[(e[0]+e[2])/2,(e[1]+e[3])/2],(isNaN(this.center[0])||isNaN(this.center[1]))&&(this.center=[108.92361111111111,34.54083333333333])}initTileset(){const{tilesetOptions:e}=this.data;return e?(this.isTile=!0,this.tileset?(this.tileset.updateOptions(e),this.tileset):new rAt(ME({},e))):void 0}executeTrans(){this.transforms.forEach(t=>{const{type:r}=t,n=oft(r)(this.data,t);Object.assign(this.data,n)})}initCluster(){if(!this.cluster)return;const e=this.clusterOptions||{};this.clusterIndex=vQ(this.data,e)}caculClusterExtent(e){let t=[[-1/0,-1/0],[1/0,1/0]];return this.invalidExtent||(t=V5(fM(this.extent),e)),t[0].concat(t[1])}};function UOt(e,t){const{callback:r}=t;return r&&(e.dataArray=e.dataArray.filter(r)),e}var J5=6378e3;function $Ot(e,t){const r=e.dataArray,{size:n=10}=t,i=n/(2*Math.PI*J5)*(256<<20)/2,{gridHash:a,gridOffset:o}=HOt(r,n),s=XOt(a,o,t);return{yOffset:i,xOffset:i,radius:i,type:"grid",dataArray:s}}function HOt(e,t){let r=1/0,n=-1/0,i;for(const l of e)i=l.coordinates[1],Number.isFinite(i)&&(r=i<r?i:r,n=i>n?i:n);const a=(r+n)/2,o=VOt(t,a);if(o.xOffset<=0||o.yOffset<=0)return{gridHash:{},gridOffset:o};const s={};for(const l of e){const u=l.coordinates[1],c=l.coordinates[0];if(Number.isFinite(u)&&Number.isFinite(c)){const f=Math.floor((u+90)/o.yOffset),d=Math.floor((c+180)/o.xOffset),v=`${f}-${d}`;s[v]=s[v]||{count:0,points:[]},s[v].count+=1,s[v].points.push(l)}}return{gridHash:s,gridOffset:o}}function VOt(e,t){const r=GOt(e),n=WOt(t,e);return{yOffset:r,xOffset:n}}function GOt(e){return e/J5*(180/Math.PI)}function WOt(e,t){return t/J5*(180/Math.PI)/Math.cos(e*Math.PI/180)}function XOt(e,t,r){return Object.keys(e).reduce((n,i,a)=>{const o=i.split("-"),s=parseInt(o[0],10),l=parseInt(o[1],10),u={};if(r.field&&r.method){const c=gK(e[i].points,r.field);u[r.method]=vK[r.method](c)}return Object.assign(u,{_id:a,coordinates:If([-180+t.xOffset*(l+.5),-90+t.yOffset*(s+.5)]),rawData:e[i].points,count:e[i].count}),n.push(u),n},[])}var k1=Math.PI/3,jOt=[0,k1,2*k1,3*k1,4*k1,5*k1];function YOt(e){return e[0]}function ZOt(e){return e[1]}function qOt(){var e=0,t=0,r=1,n=1,i=YOt,a=ZOt,o,s,l;function u(f){var d={},v=[],g,x=f.length;for(g=0;g<x;++g)if(!(isNaN(S=+i.call(null,w=f[g],g,f))||isNaN(A=+a.call(null,w,g,f)))){var w,S,A,M=Math.round(A=A/l),R=Math.round(S=S/s-(M&1)/2),O=A-M;if(Math.abs(O)*3>1){var N=S-R,k=R+(S<R?-1:1)/2,V=M+(A<M?-1:1),Q=S-k,Y=A-V;N*N+O*O>Q*Q+Y*Y&&(R=k+(M&1?1:-1)/2,M=V)}var X=R+"-"+M,tt=d[X];tt?tt.push(w):(v.push(tt=d[X]=[w]),tt.x=(R+(M&1)/2)*s,tt.y=M*l)}return v}function c(f){var d=0,v=0;return jOt.map(function(g){var x=Math.sin(g)*f,w=-Math.cos(g)*f,S=x-d,A=w-v;return d=x,v=w,[S,A]})}return u.hexagon=function(f){return"m"+c(f==null?o:+f).join("l")+"z"},u.centers=function(){for(var f=[],d=Math.round(t/l),v=Math.round(e/s),g=d*l;g<n+o;g+=l,++d)for(var x=v*s+(d&1)*s/2;x<r+s/2;x+=s)f.push([x,g]);return f},u.mesh=function(){var f=c(o).slice(0,4).join("l");return u.centers().map(function(d){return"M"+d+"m"+f}).join("")},u.x=function(f){return arguments.length?(i=f,u):i},u.y=function(f){return arguments.length?(a=f,u):a},u.radius=function(f){return arguments.length?(o=+f,s=o*2*Math.sin(k1),l=o*1.5,u):o},u.size=function(f){return arguments.length?(e=t=0,r=+f[0],n=+f[1],u):[r-e,n-t]},u.extent=function(f){return arguments.length?(e=+f[0][0],t=+f[0][1],r=+f[1][0],n=+f[1][1],u):[[e,t],[r,n]]},u.radius(1)}var KOt=Object.defineProperty,QOt=Object.defineProperties,JOt=Object.getOwnPropertyDescriptors,i9=Object.getOwnPropertySymbols,tPt=Object.prototype.hasOwnProperty,ePt=Object.prototype.propertyIsEnumerable,a9=(e,t,r)=>t in e?KOt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,rPt=(e,t)=>{for(var r in t||(t={}))tPt.call(t,r)&&a9(e,r,t[r]);if(i9)for(var r of i9(t))ePt.call(t,r)&&a9(e,r,t[r]);return e},nPt=(e,t)=>QOt(e,JOt(t)),iPt=6378e3;function aPt(e,t){const r=e.dataArray,{size:n=10,method:i="sum"}=t,a=n/(2*Math.PI*iPt)*(256<<20)/2,o=r.map(c=>{const[f,d]=If(c.coordinates);return nPt(rPt({},c),{coordinates:[f,d]})});return{dataArray:qOt().radius(a).x(c=>c.coordinates[0]).y(c=>c.coordinates[1])(o).map((c,f)=>{if(t.field&&i){const d=gK(c,t.field);c[i]=vK[i](d)}return{[t.method]:c[i],count:c.length,rawData:c,coordinates:[c.x,c.y],_id:f}}),radius:a,xOffset:a,yOffset:a,type:"hexagon"}}var oPt=Object.defineProperty,o9=Object.getOwnPropertySymbols,sPt=Object.prototype.hasOwnProperty,lPt=Object.prototype.propertyIsEnumerable,s9=(e,t,r)=>t in e?oPt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,l9=(e,t)=>{for(var r in t||(t={}))sPt.call(t,r)&&s9(e,r,t[r]);if(o9)for(var r of o9(t))lPt.call(t,r)&&s9(e,r,t[r]);return e};function uPt(e,t){const{sourceField:r,targetField:n,data:i}=t,a={};return i.forEach(o=>{a[o[r]]=o}),e.dataArray=e.dataArray.map(o=>{const s=o[n];return l9(l9({},o),a[s])}),e}function cPt(e,t){const{callback:r}=t;return r&&(e.dataArray=e.dataArray.map(r)),e}Vh("rasterTile",GLt);Vh("mvt",iRt);Vh("geojsonvt",ZAt);Vh("testTile",bOt);Vh("geojson",EAt);Vh("jsonTile",uMt);Vh("image",MK);Vh("csv",fAt);Vh("json",CK);Vh("raster",yRt);Vh("rasterRgb",hOt);Vh("rgb",iOt);Vh("ndi",KLt);fb("cluster",vQ);fb("filter",UOt);fb("join",uPt);fb("map",cPt);fb("grid",$Ot);fb("hexagon",aPt);var fI=zOt;let u9=class extends $u.EventEmitter{getMarkerLayerContainerSize(){}constructor(t){super(),z(this,"markerOption",void 0),z(this,"popup",void 0),z(this,"mapsService",void 0),z(this,"lngLat",void 0),z(this,"scene",void 0),z(this,"added",!1),z(this,"preLngLat",{lng:0,lat:0}),z(this,"onMarkerDragStart",r=>{const n=this.mapsService.getContainer();if(!n)return;this.mapsService.setMapStatus({dragEnable:!1,zoomEnable:!1});const{left:i,top:a}=n.getClientRects()[0],{x:o,y:s}=r;this.preLngLat=this.mapsService.containerToLngLat([o-i,s-a]),this.mapsService.on("mousemove",this.onMarkerDragMove),document.addEventListener("mouseup",this.onMarkerDragEnd),this.emit("dragstart",this.lngLat)}),z(this,"onMarkerDragMove",r=>{const n=r.lngLat||r.lnglat,{lng:i,lat:a}=this.preLngLat,{lng:o,lat:s}=n,l={lng:this.lngLat.lng+o-i,lat:this.lngLat.lat+s-a};this.setLnglat(l),this.preLngLat=n,this.emit("dragging",l)}),z(this,"onMarkerDragEnd",()=>{this.mapsService.setMapStatus({dragEnable:!0,zoomEnable:!0}),this.mapsService.off("mousemove",this.onMarkerDragMove),document.removeEventListener("mouseup",this.onMarkerDragEnd),this.emit("dragend",this.lngLat)}),z(this,"eventHandle",r=>{this.polyfillEvent(r),this.emit(r.type,{target:r,data:this.markerOption.extData,lngLat:this.lngLat})}),z(this,"touchStartTime",void 0),this.markerOption=Ce(Ce({},this.getDefault()),t),yTt(["update","onMove","onMapClick","updatePositionWhenZoom"],this),this.init()}getDefault(){return{element:void 0,anchor:YR.BOTTOM,offsets:[0,0],color:"#5B8FF9",draggable:!1,overflowHide:!0}}addTo(t){this.scene=t,this.mapsService=t.mapService;const{element:r}=this.markerOption;return this.mapsService.getMarkerContainer().appendChild(r),this.registerMarkerEvent(r),this.mapsService.on("camerachange",this.update),this.update(),this.updateDraggable(),this.added=!0,this.emit("added"),this}remove(){this.mapsService&&(this.mapsService.off("click",this.onMapClick),this.mapsService.off("move",this.update),this.mapsService.off("moveend",this.update),this.mapsService.off("camerachange",this.update)),this.unRegisterMarkerEvent(),this.removeAllListeners();const{element:t}=this.markerOption;return t&&Td(t),this.popup&&this.popup.remove(),this}setLnglat(t){return this.lngLat=t,Array.isArray(t)&&(this.lngLat={lng:t[0],lat:t[1]}),this.popup&&this.popup.setLnglat(this.lngLat),this.update(),this}getLnglat(){return this.lngLat}getElement(){return this.markerOption.element}setElement(t){if(!this.added)return this.once("added",()=>{this.setElement(t)}),this;const{element:r}=this.markerOption;return r&&Td(r),this.markerOption.element=t,this.init(),this.mapsService.getMarkerContainer().appendChild(t),this.registerMarkerEvent(t),this.updateDraggable(),this.update(),this}openPopup(){if(!this.added)return this.once("added",()=>{this.openPopup()}),this;const t=this.popup;return t?(t.isOpen()||t.addTo(this.scene),this):this}closePopup(){this.added||this.once("added",()=>{this.closePopup()});const t=this.popup;return t&&t.remove(),this}setPopup(t){return this.popup=t,this.lngLat&&this.popup.setLnglat(this.lngLat),this}togglePopup(){const t=this.popup;if(t)t.isOpen()?t.remove():t.addTo(this.scene);else return this;return this}getPopup(){return this.popup}getOffset(){return this.markerOption.offsets}setDraggable(t){this.markerOption.draggable=t,this.updateDraggable()}getDraggable(){return this.markerOption.draggable}getExtData(){return this.markerOption.extData}setExtData(t){this.markerOption.extData=t}update(){if(!this.mapsService)return;const{element:t,anchor:r}=this.markerOption;this.updatePosition(),hK(t,`${iM[r]}`)}updatePositionWhenZoom(t){if(!this.mapsService)return;const{element:r,offsets:n}=this.markerOption,{lng:i,lat:a}=this.lngLat;if(r){r.style.display="block",r.style.whiteSpace="nowrap";const{containerHeight:o,containerWidth:s,bounds:l}=this.getMarkerLayerContainerSize()||this.getCurrentContainerSize();if(!l)return;const u=t.map,c=t.center,f=t.zoom,d=u.DE(this.lngLat,f,c);if(d.x=Math.round(d.x+n[0]),d.y=Math.round(d.y-n[1]),Math.abs(l[0][0])>180||Math.abs(l[1][0])>180){if(d.x>s){const v=this.mapsService.lngLatToContainer([i-360,a]);d.x=v.x}if(d.x<0){const v=this.mapsService.lngLatToContainer([i+360,a]);d.x=v.x}}(d.x>s||d.x<0||d.y>o||d.y<0)&&(r.style.display="none"),r.style.left=d.x+"px",r.style.top=d.y+"px",r.style.transition="left 0.25s cubic-bezier(0,0,0.25,1), top 0.25s cubic-bezier(0,0,0.25,1)"}}onMapClick(t){const{element:r}=this.markerOption;this.popup&&r&&this.togglePopup()}getCurrentContainerSize(){const t=this.mapsService.getContainer();return{containerHeight:(t==null?void 0:t.scrollHeight)||0,containerWidth:(t==null?void 0:t.scrollWidth)||0,bounds:this.mapsService.getBounds()}}updateDraggable(){const{element:t}=this.markerOption;t==null||t.removeEventListener("mousedown",this.onMarkerDragStart),this.mapsService.off("mousemove",this.onMarkerDragMove),document.removeEventListener("mouseup",this.onMarkerDragEnd),this.markerOption.draggable&&(t==null||t.addEventListener("mousedown",this.onMarkerDragStart))}updatePosition(){if(!this.mapsService)return;const{element:t,offsets:r}=this.markerOption,{lng:n,lat:i}=this.lngLat,a=this.mapsService.lngLatToContainer([n,i]);if(t){t.style.display="block",t.style.whiteSpace="nowrap";const{containerHeight:o,containerWidth:s,bounds:l}=this.getMarkerLayerContainerSize()||this.getCurrentContainerSize();if(!l)return;if(Math.abs(l[0][0])>180||Math.abs(l[1][0])>180){if(a.x>s){const u=this.mapsService.lngLatToContainer([n-360,i]);a.x=u.x}if(a.x<0){const u=this.mapsService.lngLatToContainer([n+360,i]);a.x=u.x}}this.markerOption.overflowHide&&(a.x>s||a.x<0||a.y>o||a.y<0)&&(t.style.display="none"),t.style.left=a.x+r[0]+"px",t.style.top=a.y-r[1]+"px"}}init(){let{element:t}=this.markerOption;const{color:r,anchor:n}=this.markerOption;if(!t){t=uo("div"),this.markerOption.element=t;const i=document.createElementNS("http://www.w3.org/2000/svg","svg");i.setAttributeNS(null,"display","block"),i.setAttributeNS(null,"height","48px"),i.setAttributeNS(null,"width","48px"),i.setAttributeNS(null,"viewBox","0 0 1024 1024");const a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttributeNS(null,"d","M512 490.666667C453.12 490.666667 405.333333 442.88 405.333333 384 405.333333 325.12 453.12 277.333333 512 277.333333 570.88 277.333333 618.666667 325.12 618.666667 384 618.666667 442.88 570.88 490.666667 512 490.666667M512 85.333333C346.88 85.333333 213.333333 218.88 213.333333 384 213.333333 608 512 938.666667 512 938.666667 512 938.666667 810.666667 608 810.666667 384 810.666667 218.88 677.12 85.333333 512 85.333333Z"),a.setAttributeNS(null,"fill",r),i.appendChild(a),t.appendChild(i)}Pm(t,"l7-marker"),Object.keys(this.markerOption.style||{}).forEach(i=>{var a,o;const s=((a=this.markerOption)===null||a===void 0?void 0:a.style)&&((o=this.markerOption)===null||o===void 0?void 0:o.style[i]);t&&(t.style[i]=s)}),jZ(t,n,"marker")}registerMarkerEvent(t){t.addEventListener("click",this.onMapClick),t.addEventListener("mousemove",this.eventHandle),t.addEventListener("click",this.eventHandle),t.addEventListener("mousedown",this.eventHandle),t.addEventListener("mouseup",this.eventHandle),t.addEventListener("dblclick",this.eventHandle),t.addEventListener("contextmenu",this.eventHandle),t.addEventListener("mouseover",this.eventHandle),t.addEventListener("mouseout",this.eventHandle),t.addEventListener("touchstart",this.eventHandle),t.addEventListener("touchend",this.eventHandle)}unRegisterMarkerEvent(){const t=this.getElement();t.removeEventListener("click",this.onMapClick),t.removeEventListener("mousemove",this.eventHandle),t.removeEventListener("click",this.eventHandle),t.removeEventListener("mousedown",this.eventHandle),t.removeEventListener("mouseup",this.eventHandle),t.removeEventListener("dblclick",this.eventHandle),t.removeEventListener("contextmenu",this.eventHandle),t.removeEventListener("mouseover",this.eventHandle),t.removeEventListener("mouseout",this.eventHandle),t.removeEventListener("touchstart",this.eventHandle),t.removeEventListener("touchend",this.eventHandle)}polyfillEvent(t){!this.mapsService||this.mapsService.getType()!=="amap"||mTt()||(t.type==="touchstart"&&(this.touchStartTime=Date.now()),t.type==="touchend"&&Date.now()-this.touchStartTime<300&&this.emit("click",{target:t,data:this.markerOption.extData,lngLat:this.lngLat}))}addDragHandler(t){return null}onUp(t){throw new Error("Method not implemented.")}};window._iconfont_svg_string_3580659='<svg><symbol id="l7-icon-area1" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.064889 219.136l38.798223 466.261333a113.777778 113.777778 0 1 1-133.518223 145.237334H279.210667a113.777778 113.777778 0 1 1-60.302223-137.272889L697.856 227.555556A113.777778 113.777778 0 0 1 796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m577.592889-534.072889L269.198222 796.444444c4.152889 7.168 7.509333 14.791111 10.012445 22.812445h465.578666a114.119111 114.119111 0 0 1 65.479111-71.224889l-38.798222-466.261333a112.924444 112.924444 0 0 1-23.210666-7.964445zM796.444444 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-area" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.008 219.136l38.855112 466.261333a113.777778 113.777778 0 0 1-16.497778 224.540445L853.333333 967.111111a113.777778 113.777778 0 0 1-108.544-79.644444H279.210667a113.834667 113.834667 0 0 1-100.067556 79.36L170.666667 967.111111a113.777778 113.777778 0 0 1-17.066667-226.304l30.492444-351.175111a113.777778 113.777778 0 0 1 34.986667-218.680889L227.555556 170.666667a113.777778 113.777778 0 0 1 99.896888 59.221333l355.84-71.395556a113.777778 113.777778 0 0 1 104.675556-101.262222L796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m526.051555-582.314666L340.650667 296.903111a113.891556 113.891556 0 0 1-88.462223 98.645333l-30.947555 355.84c27.477333 13.653333 48.64 38.115556 58.026667 67.754667h465.521777a114.119111 114.119111 0 0 1 65.536-71.168l-38.855111-466.261333a113.948444 113.948444 0 0 1-74.752-56.206222zM227.555556 238.933333a45.511111 45.511111 0 1 0 0 91.022223 45.511111 45.511111 0 0 0 0-91.022223z m568.888888-113.777777a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-delete" viewBox="0 0 1024 1024"><path d="M705.422222 85.333333a34.133333 34.133333 0 0 1 34.133334 34.133334V227.555556h136.533333a34.133333 34.133333 0 0 1 0 68.266666h-25.543111l-24.348445 610.076445a34.133333 34.133333 0 0 1-34.133333 32.768H231.936a34.133333 34.133333 0 0 1-34.076444-32.768L173.340444 295.822222H147.911111a34.133333 34.133333 0 1 1 0-68.266666H284.444444V119.466667a34.133333 34.133333 0 0 1 34.133334-34.133334h386.844444zM241.720889 295.822222l22.983111 574.577778h494.535111l23.04-574.577778H241.720889zM671.288889 153.6H352.711111V227.555556h318.577778V153.6z"  ></path></symbol><symbol id="l7-icon-color" viewBox="0 0 1024 1024"><path d="M512 56.888889c9.841778 0 19.626667 0.341333 29.354667 0.910222 69.176889 4.437333 119.068444 62.577778 124.302222 131.072l0.455111 9.386667c0.739556 44.600889 15.303111 84.935111 44.999111 114.631111 27.022222 27.022222 62.805333 41.528889 102.570667 44.430222l12.060444 0.568889c72.476444 1.194667 135.793778 52.451556 140.458667 124.757333 1.137778 18.261333 1.251556 36.807111 0.170667 55.637334-13.198222 233.585778-211.399111 424.220444-445.326223 428.714666L512 967.111111a455.111111 455.111111 0 0 1-455.054222-464.156444c4.551111-233.927111 195.185778-432.128 428.771555-445.326223C494.535111 57.116444 503.296 56.888889 512 56.888889z m0 68.266667a385.706667 385.706667 0 0 0-22.414222 0.625777C291.726222 136.988444 129.080889 305.948444 125.155556 504.263111c-4.152889 212.366222 163.100444 387.185778 372.508444 394.353778l13.425778 0.227555 8.533333-0.113777c198.371556-3.811556 367.331556-166.456889 378.538667-364.373334a396.174222 396.174222 0 0 0-0.170667-47.331555c-1.991111-31.232-29.127111-56.604444-67.128889-60.472889l-8.248889-0.455111-14.051555-0.682667c-56.547556-4.209778-107.406222-25.884444-145.806222-64.284444-38.855111-38.798222-60.416-90.225778-64.284445-145.749334l-0.910222-21.333333c-2.901333-38.001778-28.785778-66.048-60.302222-68.096A433.891556 433.891556 0 0 0 512 125.155556zM438.044444 682.666667a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m-170.666666-227.555556a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m142.222222-227.555555a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z"  ></path></symbol><symbol id="l7-icon-base-map" viewBox="0 0 1024 1024"><path d="M923.761778 115.029333A34.133333 34.133333 0 0 1 967.111111 147.911111v624.128a34.133333 34.133333 0 0 1-22.186667 32.028445l-278.755555 103.992888a34.133333 34.133333 0 0 1-23.665778 0.056889L381.724444 812.714667a34.133333 34.133333 0 0 0-23.665777 0.113777L102.968889 908.060444a34.133333 34.133333 0 0 1-45.738667-26.965333L56.888889 876.088889V251.960889a34.133333 34.133333 0 0 1 22.186667-32.028445l278.755555-103.992888a34.133333 34.133333 0 0 1 20.992-0.967112l266.183111 72.988445a34.133333 34.133333 0 0 0 18.204445 0zM403.911111 192.625778v555.576889l216.177778 79.075555V251.960889l-216.177778-59.335111z m-68.266667 4.380444L125.155556 275.569778v551.310222l210.432-78.506667V197.006222zM898.844444 192.853333l-210.545777 58.936889v575.089778l210.545777-78.563556V192.853333z"  ></path></symbol><symbol id="l7-icon-dot" viewBox="0 0 1024 1024"><path d="M341.333333 739.555556a113.777778 113.777778 0 0 1 8.533334 227.271111L341.333333 967.111111a113.777778 113.777778 0 0 1-8.533333-227.271111L341.333333 739.555556z m0 68.266666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM910.222222 341.333333a113.777778 113.777778 0 0 1 8.533334 227.271111L910.222222 568.888889a113.777778 113.777778 0 0 1-8.533333-227.271111L910.222222 341.333333z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM227.555556 56.888889a113.777778 113.777778 0 0 1 8.533333 227.271111L227.555556 284.444444a113.777778 113.777778 0 0 1-8.533334-227.271111L227.555556 56.888889z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-display" viewBox="0 0 1024 1024"><path d="M512 170.666667c284.444444 0 455.111111 227.555556 455.111111 341.333333s-170.666667 341.333333-455.111111 341.333333-455.111111-227.555556-455.111111-341.333333 170.666667-341.333333 455.111111-341.333333z m0 68.266666C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 110.762667 178.574222 273.066667 386.844444 273.066667s386.844444-162.304 386.844444-273.066667c0-110.762667-178.574222-273.066667-386.844444-273.066667zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-enlarge" viewBox="0 0 1024 1024"><path d="M546.133333 147.911111l-0.056889 329.955556H876.088889a34.133333 34.133333 0 0 1 0 68.266666H546.076444v329.955556a34.133333 34.133333 0 0 1-68.266666 0V546.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h329.898667V147.911111a34.133333 34.133333 0 0 1 68.266666 0z"  ></path></symbol><symbol id="l7-icon-export-picture" viewBox="0 0 1024 1024"><path d="M883.873684 161.684211a32.336842 32.336842 0 0 1 32.336842 32.336842v582.063158a32.336842 32.336842 0 0 1-32.336842 32.336842H86.231579a32.336842 32.336842 0 0 1-32.336842-32.336842V194.021053a32.336842 32.336842 0 0 1 32.336842-32.336842h797.642105z m-32.336842 64.673684H118.568421v517.389473h170.792421a32.175158 32.175158 0 0 1 0.431158-0.646736l3.772632-4.473264 330.320842-330.374736a32.336842 32.336842 0 0 1 38.588631-5.389474l4.473263 3.018105 184.589474 147.725474V226.357895z m-202.428631 248.131368L379.850105 743.747368H851.536842v-107.304421l-202.428631-161.953684zM323.368421 323.368421a107.789474 107.789474 0 1 1 0 215.578947 107.789474 107.789474 0 0 1 0-215.578947z m0 64.673684a43.115789 43.115789 0 1 0 0 86.231579 43.115789 43.115789 0 0 0 0-86.231579z"  ></path></symbol><symbol id="l7-icon-exit-fullscreen" viewBox="0 0 1024 1024"><path d="M841.955556 591.644444a34.133333 34.133333 0 0 1 5.518222 67.811556l-5.518222 0.455111h-133.745778l192 192.056889a34.133333 34.133333 0 0 1-38.343111 55.182222l-5.176889-2.958222-4.721778-3.982222L659.911111 708.266667V841.955556a34.133333 34.133333 0 0 1-28.615111 33.678222L625.777778 876.088889a34.133333 34.133333 0 0 1-33.678222-28.615111L591.644444 841.955556V625.777778a34.133333 34.133333 0 0 1 28.615112-33.678222L625.777778 591.644444h216.177778z m-443.733334 0a34.133333 34.133333 0 0 1 33.678222 28.615112L432.355556 625.777778v216.177778a34.133333 34.133333 0 0 1-67.811556 5.518222L364.088889 841.955556v-133.745778l-192.056889 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L315.847111 659.911111H182.044444a34.133333 34.133333 0 0 1-33.678222-28.615111L147.911111 625.777778a34.133333 34.133333 0 0 1 28.615111-33.678222L182.044444 591.644444H398.222222zM167.310222 119.808l4.721778 3.982222L364.088889 315.847111V182.044444a34.133333 34.133333 0 0 1 28.615111-33.678222L398.222222 147.911111a34.133333 34.133333 0 0 1 33.678222 28.615111L432.355556 182.044444V398.222222a34.133333 34.133333 0 0 1-28.615112 33.678222L398.222222 432.355556H182.044444a34.133333 34.133333 0 0 1-5.518222-67.811556L182.044444 364.088889h133.802667L123.790222 172.032a34.133333 34.133333 0 0 1 43.52-52.224z m732.899556 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L708.266667 364.088889H841.955556a34.133333 34.133333 0 0 1 33.678222 28.615111L876.088889 398.222222a34.133333 34.133333 0 0 1-28.615111 33.678222L841.955556 432.355556H625.777778a34.133333 34.133333 0 0 1-33.678222-28.615112L591.644444 398.222222V182.044444a34.133333 34.133333 0 0 1 67.811556-5.518222l0.455111 5.518222v133.802667l192.056889-192.056889a34.133333 34.133333 0 0 1 48.241778 0z"  ></path></symbol><symbol id="l7-icon-line" viewBox="0 0 1024 1024"><path d="M853.333333 56.888889a113.777778 113.777778 0 0 1 8.533334 227.271111L853.333333 284.444444c-19.000889 0-36.864-4.664889-52.622222-12.856888l-529.123555 529.066666a113.777778 113.777778 0 0 1-92.387556 166.115556L170.666667 967.111111a113.777778 113.777778 0 0 1-8.533334-227.271111L170.666667 739.555556c19.000889 0 36.864 4.664889 52.622222 12.856888l529.123555-529.066666a113.777778 113.777778 0 0 1 92.387556-166.115556L853.333333 56.888889zM170.666667 807.822222a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m682.666666-682.666666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-layer" viewBox="0 0 1024 1024"><path d="M767.089778 625.777778l180.167111 82.773333a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730667-420.977778 193.422222a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422222a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730667L256.853333 625.777778l81.749334 37.546666L172.771556 739.555556 512 895.374222 851.171556 739.555556l-165.831112-76.231112 81.749334-37.546666z m0-227.555556l180.167111 82.773334a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730666-420.977778 193.422223a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422223a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730666L256.853333 398.222222l81.749334 37.546667-165.831111 76.174222L512 667.818667l339.171556-155.875556-165.831112-76.174222L767.089778 398.222222zM497.720889 60.017778a34.133333 34.133333 0 0 1 28.558222 0l420.977778 193.422222a34.133333 34.133333 0 0 1 0 62.008889l-420.977778 193.422222a34.133333 34.133333 0 0 1-28.558222 0l-420.977778-193.422222a34.133333 34.133333 0 0 1 0-62.008889zM512 128.568889L172.771556 284.387556 512 440.263111l339.171556-155.875555L512 128.568889z"  ></path></symbol><symbol id="l7-icon-narrow" viewBox="0 0 1024 1024"><path d="M910.222222 512a34.133333 34.133333 0 0 1-34.133333 34.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h728.177778a34.133333 34.133333 0 0 1 34.133333 34.133333z"  ></path></symbol><symbol id="l7-icon-fullscreen" viewBox="0 0 1024 1024"><path d="M645.176889 597.674667l4.721778 3.982222L841.955556 793.6l0.056888-133.688889a34.133333 34.133333 0 0 1 28.615112-33.678222L876.088889 625.777778a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 659.911111v216.177778a34.133333 34.133333 0 0 1-28.615111 33.678222L876.088889 910.222222h-216.177778a34.133333 34.133333 0 0 1-5.518222-67.811555l5.518222-0.455111h133.745778l-192-192.056889a34.133333 34.133333 0 0 1 43.52-52.224z m-222.833778 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L230.286222 841.955556H364.088889a34.133333 34.133333 0 0 1 33.678222 28.615111L398.222222 876.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L364.088889 910.222222H147.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 876.088889v-216.177778a34.133333 34.133333 0 0 1 67.811555-5.518222l0.455111 5.518222-0.056888 133.745778 192.113777-192a34.133333 34.133333 0 0 1 48.241778 0zM364.088889 113.777778a34.133333 34.133333 0 0 1 5.518222 67.811555L364.088889 182.044444H230.343111l192 192.056889a34.133333 34.133333 0 0 1-43.52 52.224l-4.721778-3.982222-192.113777-192.056889L182.044444 364.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L147.911111 398.222222a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 364.088889V147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L147.911111 113.777778h216.177778z m512 0a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 147.911111v216.177778a34.133333 34.133333 0 0 1-67.811555 5.518222L841.955556 364.088889l-0.056889-133.745778-192 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L793.6 182.044444H659.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L625.777778 147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L659.911111 113.777778h216.177778z"  ></path></symbol><symbol id="l7-icon-hide" viewBox="0 0 1024 1024"><path d="M875.52 87.836444a34.133333 34.133333 0 0 1 7.281778 43.121778l-3.527111 5.006222-682.666667 796.444445a34.133333 34.133333 0 0 1-55.409778-39.367111l3.527111-5.006222 97.166223-113.379556C123.164444 697.969778 56.888889 582.940444 56.888889 512c0-113.777778 170.666667-341.333333 455.111111-341.333333a496.64 496.64 0 0 1 208.952889 45.112889l106.439111-124.188445a34.133333 34.133333 0 0 1 48.128-3.754667z m-38.684444 202.524445C921.031111 362.951111 967.111111 452.835556 967.111111 512c0 113.777778-170.666667 341.333333-455.111111 341.333333-50.631111 0-97.678222-7.224889-140.8-19.740444l50.232889-58.595556A417.393778 417.393778 0 0 0 512 785.066667c208.270222 0 386.844444-162.304 386.844444-273.066667 0-52.849778-40.675556-117.418667-105.813333-170.496l43.804445-51.2zM512 238.933333C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 66.787556 64.853333 152.291556 162.133333 209.692444L377.173333 616.675556a170.666667 170.666667 0 0 1 217.713778-253.895112l78.620445-91.704888A432.924444 432.924444 0 0 0 512 238.933333z m166.684444 236.088889a170.666667 170.666667 0 0 1-177.664 207.303111l177.607112-207.303111zM512 409.6a102.4 102.4 0 0 0-88.746667 153.486222L548.864 416.426667A102.172444 102.172444 0 0 0 512 409.6z"  ></path></symbol><symbol id="l7-icon-rectangle" viewBox="0 0 1024 1024"><path d="M170.666667 56.888889a113.777778 113.777778 0 0 1 108.544 79.644444H853.333333a34.133333 34.133333 0 0 1 33.678223 28.615111L887.466667 170.666667v574.122666a113.777778 113.777778 0 1 1-142.677334 142.734223L170.666667 887.466667a34.133333 34.133333 0 0 1-33.678223-28.615111L136.533333 853.333333V279.210667A113.777778 113.777778 0 0 1 170.666667 56.888889z m682.666666 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-34.133333-603.022222H279.210667a114.062222 114.062222 0 0 1-74.353778 74.410667L204.8 819.2h539.989333a114.062222 114.062222 0 0 1 74.410667-74.410667V204.8zM170.666667 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-ranging" viewBox="0 0 1024 1024"><path d="M723.171556 50.403556l250.424888 250.424888a31.061333 31.061333 0 0 1 0 43.918223L344.746667 973.596444a31.061333 31.061333 0 0 1-43.918223 0L50.403556 723.171556a31.061333 31.061333 0 0 1 0-43.918223L679.253333 50.403556a31.061333 31.061333 0 0 1 43.918223 0z m-21.959112 74.524444l-39.765333 39.822222 98.986667 98.872889a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222 62.179556 62.122667a34.133333 34.133333 0 0 1-44.088889 51.882667L563.2 387.242667 501.077333 325.063111 437.191111 388.949333l98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222L387.242667 563.2a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.584-62.122667-62.179556-63.886222 63.886222 98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-39.765333 39.822222 197.802667 197.745778 576.284444-576.284444-197.802667-197.745778z"  ></path></symbol><symbol id="l7-icon-reposition" viewBox="0 0 1024 1024"><path d="M512 56.888889a34.133333 34.133333 0 0 1 34.133333 34.133333v24.177778A398.336 398.336 0 0 1 908.856889 477.866667h24.177778a34.133333 34.133333 0 0 1 0 68.266666h-24.177778A398.336 398.336 0 0 1 546.133333 908.856889L546.133333 932.977778a34.133333 34.133333 0 0 1-68.266666 0v-24.177778A398.336 398.336 0 0 1 115.2 546.133333L91.022222 546.133333a34.133333 34.133333 0 1 1 0-68.266666h24.177778A398.336 398.336 0 0 1 477.866667 115.2V91.022222A34.133333 34.133333 0 0 1 512 56.888889z m34.190222 126.862222L546.133333 193.422222a34.133333 34.133333 0 1 1-68.266666 0v-9.671111A330.069333 330.069333 0 0 0 183.751111 477.866667h9.671111a34.133333 34.133333 0 1 1 0 68.266666l-9.671111 0.056889A330.069333 330.069333 0 0 0 477.866667 840.248889V830.577778a34.133333 34.133333 0 0 1 68.266666 0l0.056889 9.671111A330.069333 330.069333 0 0 0 840.248889 546.133333L830.577778 546.133333a34.133333 34.133333 0 0 1 0-68.266666h9.671111A330.069333 330.069333 0 0 0 546.133333 183.751111zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-round" viewBox="0 0 1024 1024"><path d="M512 56.888889a455.111111 455.111111 0 0 1 391.395556 687.502222 113.777778 113.777778 0 0 1-159.061334 158.890667A455.111111 455.111111 0 0 1 120.604444 279.608889 113.777778 113.777778 0 0 1 279.608889 120.604444 452.835556 452.835556 0 0 1 512 56.888889z m0 68.266667a384.910222 384.910222 0 0 0-191.715556 50.744888A113.777778 113.777778 0 0 1 175.957333 320.284444a386.844444 386.844444 0 0 0 527.815111 527.758223 113.777778 113.777778 0 0 1 144.270223-144.440889A386.844444 386.844444 0 0 0 512 125.155556z m299.406222 640.739555a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM212.593778 167.082667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-guanbi" viewBox="0 0 1024 1024"><path d="M576 512l277.333333 277.333333-64 64-277.333333-277.333333L234.666667 853.333333 170.666667 789.333333l277.333333-277.333333L170.666667 234.666667 234.666667 170.666667l277.333333 277.333333L789.333333 170.666667 853.333333 234.666667 576 512z"  ></path></symbol></svg>',function(e){try{let u=function(){s||(s=!0,a())},c=function(){try{o.documentElement.doScroll("left")}catch{return void setTimeout(c,50)}u()};var r=(r=document.getElementsByTagName("script"))[r.length-1],t=r.getAttribute("data-injectcss"),r=r.getAttribute("data-disable-injectsvg");if(!r){var n,i,a,o,s,l=function(f,d){d.parentNode.insertBefore(f,d)};if(t&&!e.__iconfont__svg__cssinject__){e.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(f){console&&console.log(f)}}n=function(){var f,d=document.createElement("div");d.innerHTML=e._iconfont_svg_string_3580659,(d=d.getElementsByTagName("svg")[0])&&(d.setAttribute("aria-hidden","true"),d.style.position="absolute",d.style.width=0,d.style.height=0,d.style.overflow="hidden",d=d,(f=document.body).firstChild?l(d,f.firstChild):f.appendChild(d))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(n,0):(i=function(){document.removeEventListener("DOMContentLoaded",i,!1),n()},document.addEventListener("DOMContentLoaded",i,!1)):document.attachEvent&&(a=n,o=e.document,s=!1,c(),o.onreadystatechange=function(){o.readyState=="complete"&&(o.onreadystatechange=null,u())})}}catch{}}(window);class Wm extends G5{constructor(t){super(),z(this,"controlOption",void 0),z(this,"container",void 0),z(this,"isShow",void 0),z(this,"sceneContainer",void 0),z(this,"scene",void 0),z(this,"mapsService",void 0),z(this,"renderService",void 0),z(this,"layerService",void 0),z(this,"controlService",void 0),z(this,"configService",void 0),Wm.controlCount++,this.controlOption=Ce(Ce({},this.getDefault(t)),t||{})}getOptions(){return this.controlOption}setOptions(t){const r=this.getDefault(t);Object.entries(t).forEach(([n,i])=>{i===void 0&&(t[n]=r[n])}),"position"in t&&this.setPosition(t.position),"className"in t&&this.setClassName(t.className),"style"in t&&this.setStyle(t.style),this.controlOption=Ce(Ce({},this.controlOption),t)}addTo(t){this.mapsService=t.mapService,this.renderService=t.rendererService,this.layerService=t.layerService,this.controlService=t.controlService,this.configService=t.globalConfigService,this.scene=t.sceneService,this.sceneContainer=t,this.isShow=!0,this.container=this.onAdd(),Pm(this.container,"l7-control");const{className:r,style:n}=this.controlOption;return r&&this.setClassName(r),n&&this.setStyle(n),this.insertContainer(),this.emit("add",this),this}remove(){if(!this.mapsService)return this;Td(this.container),this.onRemove(),this.emit("remove",this)}onAdd(){return uo("div")}onRemove(){}show(){const t=this.container;cM(t,"l7-control--hide"),this.isShow=!0,this.emit("show",this)}hide(){const t=this.container;Pm(t,"l7-control--hide"),this.isShow=!1,this.emit("hide",this)}getDefault(t){return{position:Lx.TOPRIGHT,name:`${Wm.controlCount}`}}getContainer(){return this.container}getIsShow(){return this.isShow}_refocusOnMap(t){if(this.mapsService&&t&&t.screenX>0&&t.screenY>0){const r=this.mapsService.getContainer();r!==null&&r.focus()}}setPosition(t=Lx.TOPLEFT){const r=this.controlService;return r&&r.removeControl(this),this.controlOption.position=t,r&&r.addControl(this,this.sceneContainer),this}setClassName(t){const r=this.container,{className:n}=this.controlOption;n&&cM(r,n),t&&Pm(r,t)}setStyle(t){const r=this.container;t?r.setAttribute("style",t):r.removeAttribute("style")}insertContainer(){const t=this.controlOption.position,r=this.container;if(t instanceof Element)t.appendChild(r);else{const n=this.controlService.controlCorners[t];["bottomleft","bottomright","righttop","rightbottom"].includes(t)?n.insertBefore(r,n.firstChild):n.appendChild(r)}}checkUpdateOption(t,r){return r.some(n=>n in t)}}z(Wm,"controlCount",0);class bM extends $u.EventEmitter{get buttonRect(){return this.button.getBoundingClientRect()}constructor(t,r){super(),z(this,"popperDOM",void 0),z(this,"contentDOM",void 0),z(this,"button",void 0),z(this,"option",void 0),z(this,"isShow",!1),z(this,"content",void 0),z(this,"timeout",null),z(this,"show",()=>this.isShow||!this.contentDOM.innerHTML?this:(this.resetPopperPosition(),cM(this.popperDOM,"l7-popper-hide"),this.isShow=!0,this.option.unique&&bM.conflictPopperList.forEach(n=>{n!==this&&n.isShow&&n.hide()}),this.emit("show"),window.addEventListener("pointerdown",this.onPopperUnClick),this)),z(this,"hide",()=>this.isShow?(Pm(this.popperDOM,"l7-popper-hide"),this.isShow=!1,this.emit("hide"),window.removeEventListener("pointerdown",this.onPopperUnClick),this):this),z(this,"setHideTimeout",()=>{this.timeout||(this.timeout=window.setTimeout(()=>{this.isShow&&(this.hide(),this.timeout=null)},300))}),z(this,"clearHideTimeout",()=>{this.timeout&&(window.clearTimeout(this.timeout),this.timeout=null)}),z(this,"onBtnClick",()=>{this.isShow?this.hide():this.show()}),z(this,"onPopperUnClick",n=>{vTt(n.target,[".l7-button-control",".l7-popper-content"])||this.hide()}),z(this,"onBtnMouseLeave",()=>{this.setHideTimeout()}),z(this,"onBtnMouseMove",()=>{this.clearHideTimeout(),!this.isShow&&this.show()}),this.button=t,this.option=r,this.init(),r.unique&&bM.conflictPopperList.push(this)}getPopperDOM(){return this.popperDOM}getIsShow(){return this.isShow}getContent(){return this.content}setContent(t){typeof t=="string"?this.contentDOM.innerHTML=t:t instanceof HTMLElement&&(_S(this.contentDOM),this.contentDOM.appendChild(t)),this.content=t}init(){const{trigger:t}=this.option;this.popperDOM=this.createPopper(),t==="click"?this.button.addEventListener("click",this.onBtnClick):(this.button.addEventListener("mousemove",this.onBtnMouseMove),this.button.addEventListener("mouseleave",this.onBtnMouseLeave),this.popperDOM.addEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.addEventListener("mouseleave",this.onBtnMouseLeave))}destroy(){this.button.removeEventListener("click",this.onBtnClick),this.button.removeEventListener("mousemove",this.onBtnMouseMove),this.button.removeEventListener("mousemove",this.onBtnMouseLeave),this.popperDOM.removeEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.removeEventListener("mouseleave",this.onBtnMouseLeave),Td(this.popperDOM)}resetPopperPosition(){const t={},{container:r,offset:n=[0,0],placement:i}=this.option,[a,o]=n,s=this.button.getBoundingClientRect(),l=r.getBoundingClientRect(),{left:u,right:c,top:f,bottom:d}=dTt(s,l);let v=!1,g=!1;/^(left|right)/.test(i)?(i.includes("left")?t.right=`${s.width+c}px`:i.includes("right")&&(t.left=`${s.width+u}px`),i.includes("start")?t.top=`${f}px`:i.includes("end")?t.bottom=`${d}px`:(t.top=`${f+s.height/2}px`,g=!0,t.transform=`translate(${a}px, calc(${o}px - 50%))`)):/^(top|bottom)/.test(i)&&(i.includes("top")?t.bottom=`${s.height+d}px`:i.includes("bottom")&&(t.top=`${s.height+f}px`),i.includes("start")?t.left=`${u}px`:i.includes("end")?t.right=`${c}px`:(t.left=`${u+s.width/2}px`,v=!0,t.transform=`translate(calc(${a}px - 50%), ${o}px)`)),t.transform=`translate(calc(${a}px - ${v?"50%":"0%"}), calc(${o}px - ${g?"50%":"0%"})`;const x=i.split("-");x.length&&Pm(this.popperDOM,x.map(w=>`l7-popper-${w}`).join(" ")),H5(this.popperDOM,fTt(t))}createPopper(){const{container:t,className:r="",content:n}=this.option,i=uo("div",`l7-popper l7-popper-hide ${r}`),a=uo("div","l7-popper-content"),o=uo("div","l7-popper-arrow");return i.appendChild(a),i.appendChild(o),t.appendChild(i),this.popperDOM=i,this.contentDOM=a,n&&this.setContent(n),i}}z(bM,"conflictPopperList",[]);const CD=e=>{const t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.classList.add("l7-iconfont"),t.setAttribute("aria-hidden","true");const r=document.createElementNS("http://www.w3.org/2000/svg","use");return r.setAttributeNS("http://www.w3.org/1999/xlink","href",`#${e}`),t.appendChild(r),t},c9=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],ng=(()=>{if(typeof document>"u")return!1;const e=c9[0],t={};for(const r of c9)if((r==null?void 0:r[1])in document){for(const[i,a]of r.entries())t[e[i]]=a;return t}return!1})(),h9={change:ng.fullscreenchange,error:ng.fullscreenerror};let Sf={request(e=document.documentElement,t){return new Promise((r,n)=>{const i=()=>{Sf.off("change",i),r()};Sf.on("change",i);const a=e[ng.requestFullscreen](t);a instanceof Promise&&a.then(i).catch(n)})},exit(){return new Promise((e,t)=>{if(!Sf.isFullscreen){e();return}const r=()=>{Sf.off("change",r),e()};Sf.on("change",r);const n=document[ng.exitFullscreen]();n instanceof Promise&&n.then(r).catch(t)})},toggle(e,t){return Sf.isFullscreen?Sf.exit():Sf.request(e,t)},onchange(e){Sf.on("change",e)},onerror(e){Sf.on("error",e)},on(e,t){const r=h9[e];r&&document.addEventListener(r,t,!1)},off(e,t){const r=h9[e];r&&document.removeEventListener(r,t,!1)},raw:ng};Object.defineProperties(Sf,{isFullscreen:{get:()=>!!document[ng.fullscreenElement]},element:{enumerable:!0,get:()=>{var e;return(e=document[ng.fullscreenElement])!==null&&e!==void 0?e:void 0}},isEnabled:{enumerable:!0,get:()=>!!document[ng.fullscreenEnabled]}});ng||(Sf={isEnabled:!1});class hPt extends Wm{getDefault(){return{position:Lx.BOTTOMLEFT,name:"logo",href:"https://l7.antv.antgroup.com/",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*GRb1TKp4HcMAAAAAAAAAAAAAARQnAQ"}}onAdd(){const t=uo("div","l7-control-logo");return this.setLogoContent(t),t}onRemove(){return null}setOptions(t){super.setOptions(t),this.checkUpdateOption(t,["img","href"])&&(_S(this.container),this.setLogoContent(this.container))}setLogoContent(t){const{href:r,img:n}=this.controlOption,i=uo("img");if(i.setAttribute("src",n),i.setAttribute("aria-label","AntV logo"),pTt(i),r){const a=uo("a","l7-control-logo-link");a.target="_blank",a.href=r,a.rel="noopener nofollow",a.setAttribute("rel","noopener nofollow"),a.appendChild(i),t.appendChild(a)}else t.appendChild(i)}}let fPt=class extends Wm{constructor(...t){super(...t),z(this,"mScale",void 0),z(this,"iScale",void 0),z(this,"update",()=>{const r=this.mapsService,{maxWidth:n}=this.controlOption,i=r.getSize()[1]/2,a=r.containerToLngLat([0,i]),o=r.containerToLngLat([n,i]),s=CTt([a.lng,a.lat],[o.lng,o.lat]);this.updateScales(s)})}getDefault(t){return Ce(Ce({},super.getDefault(t)),{},{name:"scale",position:Lx.BOTTOMLEFT,maxWidth:100,metric:!0,updateWhenIdle:!1,imperial:!1,lockWidth:!0})}onAdd(){const r=uo("div","l7-control-scale");this.resetScaleLines(r);const{updateWhenIdle:n}=this.controlOption;return this.mapsService.on(n?"moveend":"mapmove",this.update),this.mapsService.on(n?"zoomend":"zoomchange",this.update),r}onRemove(){const{updateWhenIdle:t}=this.controlOption;this.mapsService.off(t?"zoomend":"zoomchange",this.update),this.mapsService.off(t?"moveend":"mapmove",this.update)}setOptions(t){super.setOptions(t),this.checkUpdateOption(t,["lockWidth","maxWidth","metric","updateWhenIdle","imperial"])&&this.resetScaleLines(this.container)}updateScales(t){const{metric:r,imperial:n}=this.controlOption;r&&t&&this.updateMetric(t),n&&t&&this.updateImperial(t)}resetScaleLines(t){_S(t);const{metric:r,imperial:n,maxWidth:i,lockWidth:a}=this.controlOption;a&&H5(t,`width: ${i}px`),r&&(this.mScale=uo("div","l7-control-scale-line",t)),n&&(this.iScale=uo("div","l7-control-scale-line",t)),this.update()}updateScale(t,r,n){const{maxWidth:i}=this.controlOption;t.style.width=Math.round(i*n)+"px",t.innerHTML=r}getRoundNum(t){const r=Math.pow(10,(Math.floor(t)+"").length-1);let n=t/r;return n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:1,r*n}updateMetric(t){const r=this.getRoundNum(t),n=r<1e3?r+" m":r/1e3+" km";this.updateScale(this.mScale,n,r/t)}updateImperial(t){const r=t*3.2808399;let n,i,a;r>5280?(n=r/5280,i=this.getRoundNum(n),this.updateScale(this.iScale,i+" mi",i/n)):(a=this.getRoundNum(r),this.updateScale(this.iScale,a+" ft",a/r))}};class dPt{constructor(){z(this,"mapService",void 0),z(this,"fontService",void 0)}apply(t,{styleAttributeService:r,mapService:n,fontService:i}){var a=this;this.mapService=n,this.fontService=i,t.hooks.init.tapPromise("DataMappingPlugin",Pe(function*(){t.log(yl.MappingStart,ou.INIT),a.generateMaping(t,{styleAttributeService:r}),t.log(yl.MappingEnd,ou.INIT)})),t.hooks.beforeRenderData.tapPromise("DataMappingPlugin",function(){var o=Pe(function*(s){if(!s)return s;t.dataState.dataMappingNeedUpdate=!1,t.log(yl.MappingStart,ou.UPDATE);const l=a.generateMaping(t,{styleAttributeService:r});return t.log(yl.MappingEnd,ou.UPDATE),l});return function(s){return o.apply(this,arguments)}}()),t.hooks.beforeRender.tap("DataMappingPlugin",()=>{const o=t.getSource();if(t.layerModelNeedUpdate||!o||!o.inited)return;const s=r.getLayerStyleAttributes()||[],l=r.getLayerStyleAttribute("filter"),{dataArray:u}=o.data;if(Array.isArray(u)&&u.length===0)return;const c=s.filter(d=>d.needRemapping);let f=u;if(l!=null&&l.needRemapping&&l!==null&&l!==void 0&&l.scale&&(f=u.filter(d=>this.applyAttributeMapping(l,d)[0])),c.length){const d=this.mapping(t,c,f,t.getEncodedData());t.setEncodedData(d)}})}generateMaping(t,{styleAttributeService:r}){const n=r.getLayerStyleAttributes()||[],i=r.getLayerStyleAttribute("filter"),{dataArray:a}=t.getSource().data;let o=a;i!=null&&i.scale&&(o=a.filter(l=>this.applyAttributeMapping(i,l)[0])),o=t.processData(o);const s=this.mapping(t,n,o,void 0);return t.setEncodedData(s),t.emit("dataUpdate",null),!0}mapping(t,r,n,i){const a=r.filter(s=>s.scale!==void 0).filter(s=>s.name!=="filter"),o=n.map((s,l)=>{const u=i?i[l]:{},c=Ce({id:s._id,coordinates:s.coordinates},u);return a.forEach(f=>{let d=this.applyAttributeMapping(f,s);(f.name==="color"||f.name==="stroke")&&(d=d.map(v=>Qa(v))),c[f.name]=Array.isArray(d)&&d.length===1?d[0]:d,f.name==="shape"&&(c.shape=this.fontService.getIconFontKey(c[f.name]))}),c});return r.forEach(s=>{s.needRemapping=!1}),this.adjustData2SimpleCoordinates(o),o}adjustData2SimpleCoordinates(t){t.length>0&&this.mapService.version==="SIMPLE"&&t.map(r=>{r.simpleCoordinate||(r.coordinates=this.unProjectCoordinates(r.coordinates),r.simpleCoordinate=!0)})}unProjectCoordinates(t){if(typeof t[0]=="number")return this.mapService.simpleMapCoord.unproject(t);if(t[0]&&t[0][0]instanceof Array){const r=[];return t.map(n=>{const i=[];n.map(a=>{i.push(this.mapService.simpleMapCoord.unproject(a))}),r.push(i)}),r}else{const r=[];return t.map(n=>{r.push(this.mapService.simpleMapCoord.unproject(n))}),r}}applyAttributeMapping(t,r){var n;if(!t.scale)return[];const i=(t==null||(n=t.scale)===null||n===void 0?void 0:n.scalers)||[],a=[];return i.forEach(({field:s})=>{var l;(r.hasOwnProperty(s)||((l=t.scale)===null||l===void 0?void 0:l.type)==="variable")&&a.push(r[s])}),t.mapping?t.mapping(a):[]}getArrowPoints(t,r){const n=[r[0]-t[0],r[1]-t[1]],i=STt(n);return[t[0]+i[0]*1e-4,t[1]+i[1]*1e-4]}}class pPt{constructor(){z(this,"mapService",void 0)}apply(t){var r=this;this.mapService=t.getContainer().mapService,t.hooks.init.tapPromise("DataSourcePlugin",Pe(function*(){t.log(yl.SourceInitStart,ou.INIT);let n=t.getSource();if(!n){const{data:i,options:a}=t.sourceOption||t.defaultSourceConfig;n=new fI(i,a),t.setSource(n)}n.inited?(r.updateClusterData(t),t.log(yl.SourceInitEnd,ou.INIT)):yield new Promise(i=>{n.on("update",a=>{a.type==="inited"&&(r.updateClusterData(t),t.log(yl.SourceInitEnd,ou.INIT)),i(null)})})})),t.hooks.beforeRenderData.tapPromise("DataSourcePlugin",Pe(function*(){const n=r.updateClusterData(t),i=t.dataState.dataSourceNeedUpdate;return t.dataState.dataSourceNeedUpdate=!1,n||i}))}updateClusterData(t){if(t.isTileLayer||t.tileLayer||!t.getSource())return!1;const r=t.getSource(),n=r.cluster,{zoom:i=0}=r.clusterOptions,a=this.mapService.getZoom()-1,o=t.dataState.dataSourceNeedUpdate;return n&&o&&r.updateClusterData(Math.floor(a)),n&&Math.abs(t.clusterZoom-a)>=1?(i!==Math.floor(a)&&r.updateClusterData(Math.floor(a)),t.clusterZoom=a,!0):!1}}function f9(e,t){let r,n;if(t===void 0)for(const i of e)i!=null&&(r===void 0?i>=i&&(r=n=i):(r>i&&(r=i),n<i&&(n=i)));else{let i=-1;for(let a of e)(a=t(a,++i,e))!=null&&(r===void 0?a>=a&&(r=n=a):(r>a&&(r=a),n<a&&(n=a)))}return[r,n]}function vPt(e,t,r,n,i){var a=e*e,o=a*e;return((1-3*e+3*a-o)*t+(4-6*a+3*o)*r+(1+3*e+3*a-3*o)*n+o*i)/6}function gPt(e){var t=e.length-1;return function(r){var n=r<=0?r=0:r>=1?(r=1,t-1):Math.floor(r*t),i=e[n],a=e[n+1],o=n>0?e[n-1]:2*i-a,s=n<t-1?e[n+2]:2*a-i;return vPt((r-n/t)*t,o,i,a,s)}}function mQ(e){return function(){return e}}function mPt(e,t){return function(r){return e+r*t}}function yPt(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function _Pt(e){return(e=+e)==1?yQ:function(t,r){return r-t?yPt(t,r,e):mQ(isNaN(t)?r:t)}}function yQ(e,t){var r=t-e;return r?mPt(e,r):mQ(isNaN(e)?t:e)}(function e(t){var r=_Pt(t);function n(i,a){var o=r((i=Gm(i)).r,(a=Gm(a)).r),s=r(i.g,a.g),l=r(i.b,a.b),u=yQ(i.opacity,a.opacity);return function(c){return i.r=o(c),i.g=s(c),i.b=l(c),i.opacity=u(c),i+""}}return n.gamma=e,n})(1);function xPt(e){return function(t){var r=t.length,n=new Array(r),i=new Array(r),a=new Array(r),o,s;for(o=0;o<r;++o)s=Gm(t[o]),n[o]=s.r||0,i[o]=s.g||0,a[o]=s.b||0;return n=e(n),i=e(i),a=e(a),s.opacity=1,function(l){return s.r=n(l),s.g=i(l),s.b=a(l),s+""}}}var bPt=xPt(gPt);function t4(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function _Q(e){return e.length===1&&(e=EPt(e)),{left:function(t,r,n,i){for(n==null&&(n=0),i==null&&(i=t.length);n<i;){var a=n+i>>>1;e(t[a],r)<0?n=a+1:i=a}return n},right:function(t,r,n,i){for(n==null&&(n=0),i==null&&(i=t.length);n<i;){var a=n+i>>>1;e(t[a],r)>0?i=a:n=a+1}return n}}}function EPt(e){return function(t,r){return t4(e(t),r)}}var wPt=_Q(t4),dI=wPt.right;function CPt(e){return e===null?NaN:+e}var SD=Math.sqrt(50),TD=Math.sqrt(10),AD=Math.sqrt(2);function xQ(e,t,r){var n,i=-1,a,o,s;if(t=+t,e=+e,r=+r,e===t&&r>0)return[e];if((n=t<e)&&(a=e,e=t,t=a),(s=TA(e,t,r))===0||!isFinite(s))return[];if(s>0)for(e=Math.ceil(e/s),t=Math.floor(t/s),o=new Array(a=Math.ceil(t-e+1));++i<a;)o[i]=(e+i)*s;else for(e=Math.floor(e*s),t=Math.ceil(t*s),o=new Array(a=Math.ceil(e-t+1));++i<a;)o[i]=(e-i)/s;return n&&o.reverse(),o}function TA(e,t,r){var n=(t-e)/Math.max(0,r),i=Math.floor(Math.log(n)/Math.LN10),a=n/Math.pow(10,i);return i>=0?(a>=SD?10:a>=TD?5:a>=AD?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=SD?10:a>=TD?5:a>=AD?2:1)}function MD(e,t,r){var n=Math.abs(t-e)/Math.max(0,r),i=Math.pow(10,Math.floor(Math.log(n)/Math.LN10)),a=n/i;return a>=SD?i*=10:a>=TD?i*=5:a>=AD&&(i*=2),t<e?-i:i}function SPt(e,t,r){if(r==null&&(r=CPt),!!(n=e.length)){if((t=+t)<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,i=(n-1)*t,a=Math.floor(i),o=+r(e[a],a,e),s=+r(e[a+1],a+1,e);return o+(s-o)*(i-a)}}function f0(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function bQ(e,t){switch(arguments.length){case 0:break;case 1:this.interpolator(e);break;default:this.interpolator(t).domain(e);break}return this}var Cf="$";function EM(){}EM.prototype=wM.prototype={constructor:EM,has:function(e){return Cf+e in this},get:function(e){return this[Cf+e]},set:function(e,t){return this[Cf+e]=t,this},remove:function(e){var t=Cf+e;return t in this&&delete this[t]},clear:function(){for(var e in this)e[0]===Cf&&delete this[e]},keys:function(){var e=[];for(var t in this)t[0]===Cf&&e.push(t.slice(1));return e},values:function(){var e=[];for(var t in this)t[0]===Cf&&e.push(this[t]);return e},entries:function(){var e=[];for(var t in this)t[0]===Cf&&e.push({key:t.slice(1),value:this[t]});return e},size:function(){var e=0;for(var t in this)t[0]===Cf&&++e;return e},empty:function(){for(var e in this)if(e[0]===Cf)return!1;return!0},each:function(e){for(var t in this)t[0]===Cf&&e(this[t],t.slice(1),this)}};function wM(e,t){var r=new EM;if(e instanceof EM)e.each(function(s,l){r.set(l,s)});else if(Array.isArray(e)){var n=-1,i=e.length,a;if(t==null)for(;++n<i;)r.set(n,e[n]);else for(;++n<i;)r.set(t(a=e[n],n,e),a)}else if(e)for(var o in e)r.set(o,e[o]);return r}function d9(){}var ry=wM.prototype;d9.prototype={constructor:d9,has:ry.has,add:function(e){return e+="",this[Cf+e]=e,this},remove:ry.remove,clear:ry.clear,values:ry.keys,size:ry.size,empty:ry.empty,each:ry.each};var EQ=Array.prototype,wQ=EQ.map,Zy=EQ.slice,p9={name:"implicit"};function CM(){var e=wM(),t=[],r=[],n=p9;function i(a){var o=a+"",s=e.get(o);if(!s){if(n!==p9)return n;e.set(o,s=t.push(a))}return r[(s-1)%r.length]}return i.domain=function(a){if(!arguments.length)return t.slice();t=[],e=wM();for(var o=-1,s=a.length,l,u;++o<s;)e.has(u=(l=a[o])+"")||e.set(u,t.push(l));return i},i.range=function(a){return arguments.length?(r=Zy.call(a),i):r.slice()},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return CM(t,r).unknown(n)},f0.apply(i,arguments),i}function e4(e){return function(){return e}}function TPt(e,t){return function(r){return e+r*t}}function APt(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function MPt(e){return(e=+e)==1?CQ:function(t,r){return r-t?APt(t,r,e):e4(isNaN(t)?r:t)}}function CQ(e,t){var r=t-e;return r?TPt(e,r):e4(isNaN(e)?t:e)}const v9=function e(t){var r=MPt(t);function n(i,a){var o=r((i=Gm(i)).r,(a=Gm(a)).r),s=r(i.g,a.g),l=r(i.b,a.b),u=CQ(i.opacity,a.opacity);return function(c){return i.r=o(c),i.g=s(c),i.b=l(c),i.opacity=u(c),i+""}}return n.gamma=e,n}(1);function RPt(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),i;return function(a){for(i=0;i<r;++i)n[i]=e[i]*(1-a)+t[i]*a;return n}}function IPt(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function LPt(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,i=new Array(n),a=new Array(r),o;for(o=0;o<n;++o)i[o]=r4(e[o],t[o]);for(;o<r;++o)a[o]=t[o];return function(s){for(o=0;o<n;++o)a[o]=i[o](s);return a}}function OPt(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function SM(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function PPt(e,t){var r={},n={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?r[i]=r4(e[i],t[i]):n[i]=t[i];return function(a){for(i in r)n[i]=r[i](a);return n}}var RD=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,hO=new RegExp(RD.source,"g");function DPt(e){return function(){return e}}function FPt(e){return function(t){return e(t)+""}}function BPt(e,t){var r=RD.lastIndex=hO.lastIndex=0,n,i,a,o=-1,s=[],l=[];for(e=e+"",t=t+"";(n=RD.exec(e))&&(i=hO.exec(t));)(a=i.index)>r&&(a=t.slice(r,a),s[o]?s[o]+=a:s[++o]=a),(n=n[0])===(i=i[0])?s[o]?s[o]+=i:s[++o]=i:(s[++o]=null,l.push({i:o,x:SM(n,i)})),r=hO.lastIndex;return r<t.length&&(a=t.slice(r),s[o]?s[o]+=a:s[++o]=a),s.length<2?l[0]?FPt(l[0].x):DPt(t):(t=l.length,function(u){for(var c=0,f;c<t;++c)s[(f=l[c]).i]=f.x(u);return s.join("")})}function r4(e,t){var r=typeof t,n;return t==null||r==="boolean"?e4(t):(r==="number"?SM:r==="string"?(n=Vm(t))?(t=n,v9):BPt:t instanceof Vm?v9:t instanceof Date?OPt:IPt(t)?RPt:Array.isArray(t)?LPt:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?PPt:SM)(e,t)}function NPt(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function kPt(e){return function(){return e}}function zPt(e){return+e}var g9=[0,1];function Ou(e){return e}function ID(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:kPt(isNaN(t)?NaN:.5)}function m9(e){var t=e[0],r=e[e.length-1],n;return t>r&&(n=t,t=r,r=n),function(i){return Math.max(t,Math.min(r,i))}}function UPt(e,t,r){var n=e[0],i=e[1],a=t[0],o=t[1];return i<n?(n=ID(i,n),a=r(o,a)):(n=ID(n,i),a=r(a,o)),function(s){return a(n(s))}}function $Pt(e,t,r){var n=Math.min(e.length,t.length)-1,i=new Array(n),a=new Array(n),o=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<n;)i[o]=ID(e[o],e[o+1]),a[o]=r(t[o],t[o+1]);return function(s){var l=dI(e,s,1,n)-1;return a[l](i[l](s))}}function pI(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function n4(){var e=g9,t=g9,r=r4,n,i,a,o=Ou,s,l,u;function c(){return s=Math.min(e.length,t.length)>2?$Pt:UPt,l=u=null,f}function f(d){return isNaN(d=+d)?a:(l||(l=s(e.map(n),t,r)))(n(o(d)))}return f.invert=function(d){return o(i((u||(u=s(t,e.map(n),SM)))(d)))},f.domain=function(d){return arguments.length?(e=wQ.call(d,zPt),o===Ou||(o=m9(e)),c()):e.slice()},f.range=function(d){return arguments.length?(t=Zy.call(d),c()):t.slice()},f.rangeRound=function(d){return t=Zy.call(d),r=NPt,c()},f.clamp=function(d){return arguments.length?(o=d?m9(e):Ou,f):o!==Ou},f.interpolate=function(d){return arguments.length?(r=d,c()):r},f.unknown=function(d){return arguments.length?(a=d,f):a},function(d,v){return n=d,i=v,c()}}function SQ(e,t){return n4()(e,t)}function HPt(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function TM(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Fx(e){return e=TM(Math.abs(e)),e?e[1]:NaN}function VPt(e,t){return function(r,n){for(var i=r.length,a=[],o=0,s=e[0],l=0;i>0&&s>0&&(l+s+1>n&&(s=Math.max(1,n-l)),a.push(r.substring(i-=s,i+s)),!((l+=s+1)>n));)s=e[o=(o+1)%e.length];return a.reverse().join(t)}}function GPt(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var WPt=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function AM(e){if(!(t=WPt.exec(e)))throw new Error("invalid format: "+e);var t;return new i4({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}AM.prototype=i4.prototype;function i4(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}i4.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function XPt(e){t:for(var t=e.length,r=1,n=-1,i;r<t;++r)switch(e[r]){case".":n=i=r;break;case"0":n===0&&(n=r),i=r;break;default:if(!+e[r])break t;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(i+1):e}var TQ;function jPt(e,t){var r=TM(e,t);if(!r)return e+"";var n=r[0],i=r[1],a=i-(TQ=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=n.length;return a===o?n:a>o?n+new Array(a-o+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+TM(e,Math.max(0,t+a-1))[0]}function y9(e,t){var r=TM(e,t);if(!r)return e+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}const _9={"%":function(e,t){return(e*100).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:HPt,e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return y9(e*100,t)},r:y9,s:jPt,X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function x9(e){return e}var b9=Array.prototype.map,E9=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function YPt(e){var t=e.grouping===void 0||e.thousands===void 0?x9:VPt(b9.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",a=e.numerals===void 0?x9:GPt(b9.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"-":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function u(f){f=AM(f);var d=f.fill,v=f.align,g=f.sign,x=f.symbol,w=f.zero,S=f.width,A=f.comma,M=f.precision,R=f.trim,O=f.type;O==="n"?(A=!0,O="g"):_9[O]||(M===void 0&&(M=12),R=!0,O="g"),(w||d==="0"&&v==="=")&&(w=!0,d="0",v="=");var N=x==="$"?r:x==="#"&&/[boxX]/.test(O)?"0"+O.toLowerCase():"",k=x==="$"?n:/[%p]/.test(O)?o:"",V=_9[O],Q=/[defgprs%]/.test(O);M=M===void 0?6:/[gprs]/.test(O)?Math.max(1,Math.min(21,M)):Math.max(0,Math.min(20,M));function Y(X){var tt=N,it=k,Et,Tt,pt;if(O==="c")it=V(X)+it,X="";else{X=+X;var kt=X<0||1/X<0;if(X=isNaN(X)?l:V(Math.abs(X),M),R&&(X=XPt(X)),kt&&+X==0&&g!=="+"&&(kt=!1),tt=(kt?g==="("?g:s:g==="-"||g==="("?"":g)+tt,it=(O==="s"?E9[8+TQ/3]:"")+it+(kt&&g==="("?")":""),Q){for(Et=-1,Tt=X.length;++Et<Tt;)if(pt=X.charCodeAt(Et),48>pt||pt>57){it=(pt===46?i+X.slice(Et+1):X.slice(Et))+it,X=X.slice(0,Et);break}}}A&&!w&&(X=t(X,1/0));var ae=tt.length+X.length+it.length,Kt=ae<S?new Array(S-ae+1).join(d):"";switch(A&&w&&(X=t(Kt+X,Kt.length?S-it.length:1/0),Kt=""),v){case"<":X=tt+X+it+Kt;break;case"=":X=tt+Kt+X+it;break;case"^":X=Kt.slice(0,ae=Kt.length>>1)+tt+X+it+Kt.slice(ae);break;default:X=Kt+tt+X+it;break}return a(X)}return Y.toString=function(){return f+""},Y}function c(f,d){var v=u((f=AM(f),f.type="f",f)),g=Math.max(-8,Math.min(8,Math.floor(Fx(d)/3)))*3,x=Math.pow(10,-g),w=E9[8+g/3];return function(S){return v(x*S)+w}}return{format:u,formatPrefix:c}}var K2,a4,AQ;ZPt({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function ZPt(e){return K2=YPt(e),a4=K2.format,AQ=K2.formatPrefix,K2}function qPt(e){return Math.max(0,-Fx(Math.abs(e)))}function KPt(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Fx(t)/3)))*3-Fx(Math.abs(e)))}function QPt(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Fx(t)-Fx(e))+1}function JPt(e,t,r,n){var i=MD(e,t,r),a;switch(n=AM(n??",f"),n.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(a=KPt(i,o))&&(n.precision=a),AQ(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(a=QPt(i,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=a-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(a=qPt(i))&&(n.precision=a-(n.type==="%")*2);break}}return a4(n)}function wS(e){var t=e.domain;return e.ticks=function(r){var n=t();return xQ(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var i=t();return JPt(i[0],i[i.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),i=0,a=n.length-1,o=n[i],s=n[a],l;return s<o&&(l=o,o=s,s=l,l=i,i=a,a=l),l=TA(o,s,r),l>0?(o=Math.floor(o/l)*l,s=Math.ceil(s/l)*l,l=TA(o,s,r)):l<0&&(o=Math.ceil(o*l)/l,s=Math.floor(s*l)/l,l=TA(o,s,r)),l>0?(n[i]=Math.floor(o/l)*l,n[a]=Math.ceil(s/l)*l,t(n)):l<0&&(n[i]=Math.ceil(o*l)/l,n[a]=Math.floor(s*l)/l,t(n)),e},e}function MQ(){var e=SQ(Ou,Ou);return e.copy=function(){return pI(e,MQ())},f0.apply(e,arguments),wS(e)}function RQ(e,t){e=e.slice();var r=0,n=e.length-1,i=e[r],a=e[n],o;return a<i&&(o=r,r=n,n=o,o=i,i=a,a=o),e[r]=t.floor(i),e[n]=t.ceil(a),e}function w9(e){return Math.log(e)}function C9(e){return Math.exp(e)}function tDt(e){return-Math.log(-e)}function eDt(e){return-Math.exp(-e)}function rDt(e){return isFinite(e)?+("1e"+e):e<0?0:e}function nDt(e){return e===10?rDt:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}function iDt(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}function S9(e){return function(t){return-e(-t)}}function aDt(e){var t=e(w9,C9),r=t.domain,n=10,i,a;function o(){return i=iDt(n),a=nDt(n),r()[0]<0?(i=S9(i),a=S9(a),e(tDt,eDt)):e(w9,C9),t}return t.base=function(s){return arguments.length?(n=+s,o()):n},t.domain=function(s){return arguments.length?(r(s),o()):r()},t.ticks=function(s){var l=r(),u=l[0],c=l[l.length-1],f;(f=c<u)&&(d=u,u=c,c=d);var d=i(u),v=i(c),g,x,w,S=s==null?10:+s,A=[];if(!(n%1)&&v-d<S){if(d=Math.round(d)-1,v=Math.round(v)+1,u>0){for(;d<v;++d)for(x=1,g=a(d);x<n;++x)if(w=g*x,!(w<u)){if(w>c)break;A.push(w)}}else for(;d<v;++d)for(x=n-1,g=a(d);x>=1;--x)if(w=g*x,!(w<u)){if(w>c)break;A.push(w)}}else A=xQ(d,v,Math.min(v-d,S)).map(a);return f?A.reverse():A},t.tickFormat=function(s,l){if(l==null&&(l=n===10?".0e":","),typeof l!="function"&&(l=a4(l)),s===1/0)return l;s==null&&(s=10);var u=Math.max(1,n*s/t.ticks().length);return function(c){var f=c/a(Math.round(i(c)));return f*n<n-.5&&(f*=n),f<=u?l(c):""}},t.nice=function(){return r(RQ(r(),{floor:function(s){return a(Math.floor(i(s)))},ceil:function(s){return a(Math.ceil(i(s)))}}))},t}function IQ(){var e=aDt(n4()).domain([1,10]);return e.copy=function(){return pI(e,IQ()).base(e.base())},f0.apply(e,arguments),e}function T9(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function oDt(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function sDt(e){return e<0?-e*e:e*e}function lDt(e){var t=e(Ou,Ou),r=1;function n(){return r===1?e(Ou,Ou):r===.5?e(oDt,sDt):e(T9(r),T9(1/r))}return t.exponent=function(i){return arguments.length?(r=+i,n()):r},wS(t)}function LQ(){var e=lDt(n4());return e.copy=function(){return pI(e,LQ()).exponent(e.exponent())},f0.apply(e,arguments),e}function OQ(){var e=[],t=[],r=[],n;function i(){var o=0,s=Math.max(1,t.length);for(r=new Array(s-1);++o<s;)r[o-1]=SPt(e,o/s);return a}function a(o){return isNaN(o=+o)?n:t[dI(r,o)]}return a.invertExtent=function(o){var s=t.indexOf(o);return s<0?[NaN,NaN]:[s>0?r[s-1]:e[0],s<r.length?r[s]:e[e.length-1]]},a.domain=function(o){if(!arguments.length)return e.slice();e=[];for(var s=0,l=o.length,u;s<l;++s)u=o[s],u!=null&&!isNaN(u=+u)&&e.push(u);return e.sort(t4),i()},a.range=function(o){return arguments.length?(t=Zy.call(o),i()):t.slice()},a.unknown=function(o){return arguments.length?(n=o,a):n},a.quantiles=function(){return r.slice()},a.copy=function(){return OQ().domain(e).range(t).unknown(n)},f0.apply(a,arguments)}function PQ(){var e=0,t=1,r=1,n=[.5],i=[0,1],a;function o(l){return l<=l?i[dI(n,l,0,r)]:a}function s(){var l=-1;for(n=new Array(r);++l<r;)n[l]=((l+1)*t-(l-r)*e)/(r+1);return o}return o.domain=function(l){return arguments.length?(e=+l[0],t=+l[1],s()):[e,t]},o.range=function(l){return arguments.length?(r=(i=Zy.call(l)).length-1,s()):i.slice()},o.invertExtent=function(l){var u=i.indexOf(l);return u<0?[NaN,NaN]:u<1?[e,n[0]]:u>=r?[n[r-1],t]:[n[u-1],n[u]]},o.unknown=function(l){return arguments.length&&(a=l),o},o.thresholds=function(){return n.slice()},o.copy=function(){return PQ().domain([e,t]).range(i).unknown(a)},f0.apply(wS(o),arguments)}function DQ(){var e=[.5],t=[0,1],r,n=1;function i(a){return a<=a?t[dI(e,a,0,n)]:r}return i.domain=function(a){return arguments.length?(e=Zy.call(a),n=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(a){return arguments.length?(t=Zy.call(a),n=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(a){var o=t.indexOf(a);return[e[o-1],e[o]]},i.unknown=function(a){return arguments.length?(r=a,i):r},i.copy=function(){return DQ().domain(e).range(t).unknown(r)},f0.apply(i,arguments)}var fO=new Date,dO=new Date;function cc(e,t,r,n){function i(a){return e(a=arguments.length===0?new Date:new Date(+a)),a}return i.floor=function(a){return e(a=new Date(+a)),a},i.ceil=function(a){return e(a=new Date(a-1)),t(a,1),e(a),a},i.round=function(a){var o=i(a),s=i.ceil(a);return a-o<s-a?o:s},i.offset=function(a,o){return t(a=new Date(+a),o==null?1:Math.floor(o)),a},i.range=function(a,o,s){var l=[],u;if(a=i.ceil(a),s=s==null?1:Math.floor(s),!(a<o)||!(s>0))return l;do l.push(u=new Date(+a)),t(a,s),e(a);while(u<a&&a<o);return l},i.filter=function(a){return cc(function(o){if(o>=o)for(;e(o),!a(o);)o.setTime(o-1)},function(o,s){if(o>=o)if(s<0)for(;++s<=0;)for(;t(o,-1),!a(o););else for(;--s>=0;)for(;t(o,1),!a(o););})},r&&(i.count=function(a,o){return fO.setTime(+a),dO.setTime(+o),e(fO),e(dO),Math.floor(r(fO,dO))},i.every=function(a){return a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?i.filter(n?function(o){return n(o)%a===0}:function(o){return i.count(0,o)%a===0}):i}),i}var MM=cc(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});MM.every=function(e){return e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?cc(function(t){t.setTime(Math.floor(t/e)*e)},function(t,r){t.setTime(+t+r*e)},function(t,r){return(r-t)/e}):MM};const uDt=MM;MM.range;var RM=1e3,hC=6e4,A9=36e5,FQ=864e5,BQ=6048e5,NQ=cc(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+t*RM)},function(e,t){return(t-e)/RM},function(e){return e.getUTCSeconds()});const cDt=NQ;NQ.range;var kQ=cc(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*RM)},function(e,t){e.setTime(+e+t*hC)},function(e,t){return(t-e)/hC},function(e){return e.getMinutes()});const hDt=kQ;kQ.range;var zQ=cc(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*RM-e.getMinutes()*hC)},function(e,t){e.setTime(+e+t*A9)},function(e,t){return(t-e)/A9},function(e){return e.getHours()});const fDt=zQ;zQ.range;var UQ=cc(function(e){e.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*hC)/FQ},function(e){return e.getDate()-1});const o4=UQ;UQ.range;function __(e){return cc(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,r){t.setDate(t.getDate()+r*7)},function(t,r){return(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*hC)/BQ})}var s4=__(0),IM=__(1),dDt=__(2),pDt=__(3),Bx=__(4),vDt=__(5),gDt=__(6);s4.range;IM.range;dDt.range;pDt.range;Bx.range;vDt.range;gDt.range;var $Q=cc(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12},function(e){return e.getMonth()});const mDt=$Q;$Q.range;var l4=cc(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});l4.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:cc(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,r){t.setFullYear(t.getFullYear()+r*e)})};const Nx=l4;l4.range;var HQ=cc(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/FQ},function(e){return e.getUTCDate()-1});const VQ=HQ;HQ.range;function x_(e){return cc(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,r){t.setUTCDate(t.getUTCDate()+r*7)},function(t,r){return(r-t)/BQ})}var GQ=x_(0),LM=x_(1),yDt=x_(2),_Dt=x_(3),kx=x_(4),xDt=x_(5),bDt=x_(6);GQ.range;LM.range;yDt.range;_Dt.range;kx.range;xDt.range;bDt.range;var u4=cc(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});u4.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:cc(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,r){t.setUTCFullYear(t.getUTCFullYear()+r*e)})};const fC=u4;u4.range;function pO(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function vO(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function RE(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function EDt(e){var t=e.dateTime,r=e.date,n=e.time,i=e.periods,a=e.days,o=e.shortDays,s=e.months,l=e.shortMonths,u=IE(i),c=LE(i),f=IE(a),d=LE(a),v=IE(o),g=LE(o),x=IE(s),w=LE(s),S=IE(l),A=LE(l),M={a:kt,A:ae,b:Kt,B:re,c:null,d:P9,e:P9,f:WDt,g:eFt,G:nFt,H:HDt,I:VDt,j:GDt,L:WQ,m:XDt,M:jDt,p:fe,q:Oe,Q:B9,s:N9,S:YDt,u:ZDt,U:qDt,V:KDt,w:QDt,W:JDt,x:null,X:null,y:tFt,Y:rFt,Z:iFt,"%":F9},R={a:Ye,A:Be,b:De,B:Yr,c:null,d:D9,e:D9,f:lFt,g:yFt,G:xFt,H:aFt,I:oFt,j:sFt,L:jQ,m:uFt,M:cFt,p:Gr,q:Mn,Q:B9,s:N9,S:hFt,u:fFt,U:dFt,V:pFt,w:vFt,W:gFt,x:null,X:null,y:mFt,Y:_Ft,Z:bFt,"%":F9},O={a:Y,A:X,b:tt,B:it,c:Et,d:L9,e:L9,f:kDt,g:I9,G:R9,H:O9,I:O9,j:DDt,L:NDt,m:PDt,M:FDt,p:Q,q:ODt,Q:UDt,s:$Dt,S:BDt,u:ADt,U:MDt,V:RDt,w:TDt,W:IDt,x:Tt,X:pt,y:I9,Y:R9,Z:LDt,"%":zDt};M.x=N(r,M),M.X=N(n,M),M.c=N(t,M),R.x=N(r,R),R.X=N(n,R),R.c=N(t,R);function N(ee,rr){return function(Nr){var Fe=[],Hr=-1,_n=0,Kn=ee.length,vn,xn,ui;for(Nr instanceof Date||(Nr=new Date(+Nr));++Hr<Kn;)ee.charCodeAt(Hr)===37&&(Fe.push(ee.slice(_n,Hr)),(xn=M9[vn=ee.charAt(++Hr)])!=null?vn=ee.charAt(++Hr):xn=vn==="e"?" ":"0",(ui=rr[vn])&&(vn=ui(Nr,xn)),Fe.push(vn),_n=Hr+1);return Fe.push(ee.slice(_n,Hr)),Fe.join("")}}function k(ee,rr){return function(Nr){var Fe=RE(1900,void 0,1),Hr=V(Fe,ee,Nr+="",0),_n,Kn;if(Hr!=Nr.length)return null;if("Q"in Fe)return new Date(Fe.Q);if("s"in Fe)return new Date(Fe.s*1e3+("L"in Fe?Fe.L:0));if(rr&&!("Z"in Fe)&&(Fe.Z=0),"p"in Fe&&(Fe.H=Fe.H%12+Fe.p*12),Fe.m===void 0&&(Fe.m="q"in Fe?Fe.q:0),"V"in Fe){if(Fe.V<1||Fe.V>53)return null;"w"in Fe||(Fe.w=1),"Z"in Fe?(_n=vO(RE(Fe.y,0,1)),Kn=_n.getUTCDay(),_n=Kn>4||Kn===0?LM.ceil(_n):LM(_n),_n=VQ.offset(_n,(Fe.V-1)*7),Fe.y=_n.getUTCFullYear(),Fe.m=_n.getUTCMonth(),Fe.d=_n.getUTCDate()+(Fe.w+6)%7):(_n=pO(RE(Fe.y,0,1)),Kn=_n.getDay(),_n=Kn>4||Kn===0?IM.ceil(_n):IM(_n),_n=o4.offset(_n,(Fe.V-1)*7),Fe.y=_n.getFullYear(),Fe.m=_n.getMonth(),Fe.d=_n.getDate()+(Fe.w+6)%7)}else("W"in Fe||"U"in Fe)&&("w"in Fe||(Fe.w="u"in Fe?Fe.u%7:"W"in Fe?1:0),Kn="Z"in Fe?vO(RE(Fe.y,0,1)).getUTCDay():pO(RE(Fe.y,0,1)).getDay(),Fe.m=0,Fe.d="W"in Fe?(Fe.w+6)%7+Fe.W*7-(Kn+5)%7:Fe.w+Fe.U*7-(Kn+6)%7);return"Z"in Fe?(Fe.H+=Fe.Z/100|0,Fe.M+=Fe.Z%100,vO(Fe)):pO(Fe)}}function V(ee,rr,Nr,Fe){for(var Hr=0,_n=rr.length,Kn=Nr.length,vn,xn;Hr<_n;){if(Fe>=Kn)return-1;if(vn=rr.charCodeAt(Hr++),vn===37){if(vn=rr.charAt(Hr++),xn=O[vn in M9?rr.charAt(Hr++):vn],!xn||(Fe=xn(ee,Nr,Fe))<0)return-1}else if(vn!=Nr.charCodeAt(Fe++))return-1}return Fe}function Q(ee,rr,Nr){var Fe=u.exec(rr.slice(Nr));return Fe?(ee.p=c[Fe[0].toLowerCase()],Nr+Fe[0].length):-1}function Y(ee,rr,Nr){var Fe=v.exec(rr.slice(Nr));return Fe?(ee.w=g[Fe[0].toLowerCase()],Nr+Fe[0].length):-1}function X(ee,rr,Nr){var Fe=f.exec(rr.slice(Nr));return Fe?(ee.w=d[Fe[0].toLowerCase()],Nr+Fe[0].length):-1}function tt(ee,rr,Nr){var Fe=S.exec(rr.slice(Nr));return Fe?(ee.m=A[Fe[0].toLowerCase()],Nr+Fe[0].length):-1}function it(ee,rr,Nr){var Fe=x.exec(rr.slice(Nr));return Fe?(ee.m=w[Fe[0].toLowerCase()],Nr+Fe[0].length):-1}function Et(ee,rr,Nr){return V(ee,t,rr,Nr)}function Tt(ee,rr,Nr){return V(ee,r,rr,Nr)}function pt(ee,rr,Nr){return V(ee,n,rr,Nr)}function kt(ee){return o[ee.getDay()]}function ae(ee){return a[ee.getDay()]}function Kt(ee){return l[ee.getMonth()]}function re(ee){return s[ee.getMonth()]}function fe(ee){return i[+(ee.getHours()>=12)]}function Oe(ee){return 1+~~(ee.getMonth()/3)}function Ye(ee){return o[ee.getUTCDay()]}function Be(ee){return a[ee.getUTCDay()]}function De(ee){return l[ee.getUTCMonth()]}function Yr(ee){return s[ee.getUTCMonth()]}function Gr(ee){return i[+(ee.getUTCHours()>=12)]}function Mn(ee){return 1+~~(ee.getUTCMonth()/3)}return{format:function(ee){var rr=N(ee+="",M);return rr.toString=function(){return ee},rr},parse:function(ee){var rr=k(ee+="",!1);return rr.toString=function(){return ee},rr},utcFormat:function(ee){var rr=N(ee+="",R);return rr.toString=function(){return ee},rr},utcParse:function(ee){var rr=k(ee+="",!0);return rr.toString=function(){return ee},rr}}}var M9={"-":"",_:" ",0:"0"},Gl=/^\s*\d+/,wDt=/^%/,CDt=/[\\^$*+?|[\]().{}]/g;function Pa(e,t,r){var n=e<0?"-":"",i=(n?-e:e)+"",a=i.length;return n+(a<r?new Array(r-a+1).join(t)+i:i)}function SDt(e){return e.replace(CDt,"\\$&")}function IE(e){return new RegExp("^(?:"+e.map(SDt).join("|")+")","i")}function LE(e){for(var t={},r=-1,n=e.length;++r<n;)t[e[r].toLowerCase()]=r;return t}function TDt(e,t,r){var n=Gl.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function ADt(e,t,r){var n=Gl.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function MDt(e,t,r){var n=Gl.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function RDt(e,t,r){var n=Gl.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function IDt(e,t,r){var n=Gl.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function R9(e,t,r){var n=Gl.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function I9(e,t,r){var n=Gl.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function LDt(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function ODt(e,t,r){var n=Gl.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function PDt(e,t,r){var n=Gl.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function L9(e,t,r){var n=Gl.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function DDt(e,t,r){var n=Gl.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function O9(e,t,r){var n=Gl.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function FDt(e,t,r){var n=Gl.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function BDt(e,t,r){var n=Gl.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function NDt(e,t,r){var n=Gl.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function kDt(e,t,r){var n=Gl.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function zDt(e,t,r){var n=wDt.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function UDt(e,t,r){var n=Gl.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function $Dt(e,t,r){var n=Gl.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function P9(e,t){return Pa(e.getDate(),t,2)}function HDt(e,t){return Pa(e.getHours(),t,2)}function VDt(e,t){return Pa(e.getHours()%12||12,t,2)}function GDt(e,t){return Pa(1+o4.count(Nx(e),e),t,3)}function WQ(e,t){return Pa(e.getMilliseconds(),t,3)}function WDt(e,t){return WQ(e,t)+"000"}function XDt(e,t){return Pa(e.getMonth()+1,t,2)}function jDt(e,t){return Pa(e.getMinutes(),t,2)}function YDt(e,t){return Pa(e.getSeconds(),t,2)}function ZDt(e){var t=e.getDay();return t===0?7:t}function qDt(e,t){return Pa(s4.count(Nx(e)-1,e),t,2)}function XQ(e){var t=e.getDay();return t>=4||t===0?Bx(e):Bx.ceil(e)}function KDt(e,t){return e=XQ(e),Pa(Bx.count(Nx(e),e)+(Nx(e).getDay()===4),t,2)}function QDt(e){return e.getDay()}function JDt(e,t){return Pa(IM.count(Nx(e)-1,e),t,2)}function tFt(e,t){return Pa(e.getFullYear()%100,t,2)}function eFt(e,t){return e=XQ(e),Pa(e.getFullYear()%100,t,2)}function rFt(e,t){return Pa(e.getFullYear()%1e4,t,4)}function nFt(e,t){var r=e.getDay();return e=r>=4||r===0?Bx(e):Bx.ceil(e),Pa(e.getFullYear()%1e4,t,4)}function iFt(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Pa(t/60|0,"0",2)+Pa(t%60,"0",2)}function D9(e,t){return Pa(e.getUTCDate(),t,2)}function aFt(e,t){return Pa(e.getUTCHours(),t,2)}function oFt(e,t){return Pa(e.getUTCHours()%12||12,t,2)}function sFt(e,t){return Pa(1+VQ.count(fC(e),e),t,3)}function jQ(e,t){return Pa(e.getUTCMilliseconds(),t,3)}function lFt(e,t){return jQ(e,t)+"000"}function uFt(e,t){return Pa(e.getUTCMonth()+1,t,2)}function cFt(e,t){return Pa(e.getUTCMinutes(),t,2)}function hFt(e,t){return Pa(e.getUTCSeconds(),t,2)}function fFt(e){var t=e.getUTCDay();return t===0?7:t}function dFt(e,t){return Pa(GQ.count(fC(e)-1,e),t,2)}function YQ(e){var t=e.getUTCDay();return t>=4||t===0?kx(e):kx.ceil(e)}function pFt(e,t){return e=YQ(e),Pa(kx.count(fC(e),e)+(fC(e).getUTCDay()===4),t,2)}function vFt(e){return e.getUTCDay()}function gFt(e,t){return Pa(LM.count(fC(e)-1,e),t,2)}function mFt(e,t){return Pa(e.getUTCFullYear()%100,t,2)}function yFt(e,t){return e=YQ(e),Pa(e.getUTCFullYear()%100,t,2)}function _Ft(e,t){return Pa(e.getUTCFullYear()%1e4,t,4)}function xFt(e,t){var r=e.getUTCDay();return e=r>=4||r===0?kx(e):kx.ceil(e),Pa(e.getUTCFullYear()%1e4,t,4)}function bFt(){return"+0000"}function F9(){return"%"}function B9(e){return+e}function N9(e){return Math.floor(+e/1e3)}var S1,ZQ;EFt({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function EFt(e){return S1=EDt(e),ZQ=S1.format,S1.parse,S1.utcFormat,S1.utcParse,S1}var hw=1e3,fw=hw*60,dw=fw*60,dC=dw*24,wFt=dC*7,k9=dC*30,gO=dC*365;function CFt(e){return new Date(e)}function SFt(e){return e instanceof Date?+e:+new Date(+e)}function qQ(e,t,r,n,i,a,o,s,l){var u=SQ(Ou,Ou),c=u.invert,f=u.domain,d=l(".%L"),v=l(":%S"),g=l("%I:%M"),x=l("%I %p"),w=l("%a %d"),S=l("%b %d"),A=l("%B"),M=l("%Y"),R=[[o,1,hw],[o,5,5*hw],[o,15,15*hw],[o,30,30*hw],[a,1,fw],[a,5,5*fw],[a,15,15*fw],[a,30,30*fw],[i,1,dw],[i,3,3*dw],[i,6,6*dw],[i,12,12*dw],[n,1,dC],[n,2,2*dC],[r,1,wFt],[t,1,k9],[t,3,3*k9],[e,1,gO]];function O(k){return(o(k)<k?d:a(k)<k?v:i(k)<k?g:n(k)<k?x:t(k)<k?r(k)<k?w:S:e(k)<k?A:M)(k)}function N(k,V,Q,Y){if(k==null&&(k=10),typeof k=="number"){var X=Math.abs(Q-V)/k,tt=_Q(function(it){return it[2]}).right(R,X);tt===R.length?(Y=MD(V/gO,Q/gO,k),k=e):tt?(tt=R[X/R[tt-1][2]<R[tt][2]/X?tt-1:tt],Y=tt[1],k=tt[0]):(Y=Math.max(MD(V,Q,k),1),k=s)}return Y==null?k:k.every(Y)}return u.invert=function(k){return new Date(c(k))},u.domain=function(k){return arguments.length?f(wQ.call(k,SFt)):f().map(CFt)},u.ticks=function(k,V){var Q=f(),Y=Q[0],X=Q[Q.length-1],tt=X<Y,it;return tt&&(it=Y,Y=X,X=it),it=N(k,Y,X,V),it=it?it.range(Y,X+1):[],tt?it.reverse():it},u.tickFormat=function(k,V){return V==null?O:l(V)},u.nice=function(k,V){var Q=f();return(k=N(k,Q[0],Q[Q.length-1],V))?f(RQ(Q,k)):u},u.copy=function(){return pI(u,qQ(e,t,r,n,i,a,o,s,l))},u}function TFt(){return f0.apply(qQ(Nx,mDt,s4,o4,fDt,hDt,cDt,uDt,ZQ).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function AFt(){var e=0,t=1,r,n,i,a,o=Ou,s=!1,l;function u(c){return isNaN(c=+c)?l:o(i===0?.5:(c=(a(c)-r)*i,s?Math.max(0,Math.min(1,c)):c))}return u.domain=function(c){return arguments.length?(r=a(e=+c[0]),n=a(t=+c[1]),i=r===n?0:1/(n-r),u):[e,t]},u.clamp=function(c){return arguments.length?(s=!!c,u):s},u.interpolator=function(c){return arguments.length?(o=c,u):o},u.unknown=function(c){return arguments.length?(l=c,u):l},function(c){return a=c,r=c(e),n=c(t),i=r===n?0:1/(n-r),u}}function KQ(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function QQ(){var e=wS(AFt()(Ou));return e.copy=function(){return KQ(e,QQ())},bQ.apply(e,arguments)}function MFt(){var e=0,t=.5,r=1,n,i,a,o,s,l=Ou,u,c=!1,f;function d(v){return isNaN(v=+v)?f:(v=.5+((v=+u(v))-i)*(v<i?o:s),l(c?Math.max(0,Math.min(1,v)):v))}return d.domain=function(v){return arguments.length?(n=u(e=+v[0]),i=u(t=+v[1]),a=u(r=+v[2]),o=n===i?0:.5/(i-n),s=i===a?0:.5/(a-i),d):[e,t,r]},d.clamp=function(v){return arguments.length?(c=!!v,d):c},d.interpolator=function(v){return arguments.length?(l=v,d):l},d.unknown=function(v){return arguments.length?(f=v,d):f},function(v){return u=v,n=v(e),i=v(t),a=v(r),o=n===i?0:.5/(i-n),s=i===a?0:.5/(a-i),d}}function JQ(){var e=wS(MFt()(Ou));return e.copy=function(){return KQ(e,JQ())},bQ.apply(e,arguments)}function tJ(e){let t,r=[];function n(i){return i??t}return n.invert=n,n.domain=n.range=i=>i?(r=i,i):r,n.unknown=i=>i?(t=i,i):t,n.copy=()=>tJ().unknown(t),n}const{isNil:mO,isString:RFt,uniq:IFt}=is,LFt=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,OFt={[Ba.LINEAR]:MQ,[Ba.POWER]:LQ,[Ba.LOG]:IQ,[Ba.IDENTITY]:tJ,[Ba.SEQUENTIAL]:QQ,[Ba.TIME]:TFt,[Ba.QUANTILE]:OQ,[Ba.QUANTIZE]:PQ,[Ba.THRESHOLD]:DQ,[Ba.CAT]:CM,[Ba.DIVERGING]:JQ};class PFt{constructor(){z(this,"scaleOptions",{})}apply(t,{styleAttributeService:r}){var n=this;t.hooks.init.tapPromise("FeatureScalePlugin",Pe(function*(){var i;t.log(yl.ScaleInitStart,ou.INIT),n.scaleOptions=t.getScaleOptions();const a=r.getLayerStyleAttributes(),o=(i=t.getSource())===null||i===void 0?void 0:i.data.dataArray;Array.isArray(o)&&o.length===0||(n.caculateScalesForAttributes(a||[],o),t.log(yl.ScaleInitEnd,ou.INIT))})),t.hooks.beforeRenderData.tapPromise("FeatureScalePlugin",function(){var i=Pe(function*(a){if(!a)return a;t.log(yl.ScaleInitStart,ou.UPDATE),n.scaleOptions=t.getScaleOptions();const o=r.getLayerStyleAttributes(),s=t.getSource().data.dataArray;return Array.isArray(s)&&s.length===0||(n.caculateScalesForAttributes(o||[],s),t.log(yl.ScaleInitEnd,ou.UPDATE),t.layerModelNeedUpdate=!0),!0});return function(a){return i.apply(this,arguments)}}()),t.hooks.beforeRender.tap("FeatureScalePlugin",()=>{if(t.layerModelNeedUpdate)return;this.scaleOptions=t.getScaleOptions();const i=r.getLayerStyleAttributes(),a=t.getSource().data.dataArray;if(!(Array.isArray(a)&&a.length===0)&&i){const o=i.filter(s=>s.needRescale);o.length&&this.caculateScalesForAttributes(o,a)}})}isNumber(t){return!isNaN(parseFloat(t))&&isFinite(t)}caculateScalesForAttributes(t,r){t.forEach(n=>{if(n.scale){const i=n.scale,a=n.scale.field;i.names=this.parseFields(mO(a)?[]:a);const o=[];i.names.forEach(s=>{var l;o.push(this.createScale(s,n.name,(l=n.scale)===null||l===void 0?void 0:l.values,r))}),o.some(s=>s.type===C1.VARIABLE)?(i.type=C1.VARIABLE,o.forEach(s=>{if(!i.callback&&i.values!=="text"){var l;switch((l=s.option)===null||l===void 0?void 0:l.type){case Ba.LOG:case Ba.LINEAR:case Ba.POWER:if(i.values&&i.values.length>2){const c=s.scale.ticks(i.values.length);s.scale.domain(c)}i.values?s.scale.range(i.values):s.scale.range(s.option.domain);break;case Ba.QUANTILE:case Ba.QUANTIZE:case Ba.THRESHOLD:s.scale.range(i.values);break;case Ba.IDENTITY:break;case Ba.CAT:i.values?s.scale.range(i.values):s.scale.range(s.option.domain);break;case Ba.DIVERGING:case Ba.SEQUENTIAL:s.scale.interpolator(bPt(i.values));break}}if(i.values==="text"){var u;s.scale.range((u=s.option)===null||u===void 0?void 0:u.domain)}})):(i.type=C1.CONSTANT,i.defaultValues=o.map((s,l)=>s.scale(i.names[l]))),i.scalers=o.map(s=>({field:s.field,func:s.scale,option:s.option})),n.needRescale=!1}})}parseFields(t){return Array.isArray(t)?t:RFt(t)?t.split("*"):[t]}createScale(t,r,n,i){var a,o;const s=this.scaleOptions[r]&&((a=this.scaleOptions[r])===null||a===void 0?void 0:a.field)===t?this.scaleOptions[r]:this.scaleOptions[t],l={field:t,scale:void 0,type:C1.VARIABLE,option:s};if(!i||!i.length)return s&&s.type?l.scale=this.createDefaultScale(s):(l.scale=CM([t]),l.type=C1.CONSTANT),l;const u=(o=i.find(c=>!mO(c[t])))===null||o===void 0?void 0:o[t];if(this.isNumber(t)||mO(u)&&!s)l.scale=CM([t]),l.type=C1.CONSTANT;else{let c=s&&s.type||this.getDefaultType(u);n==="text"&&(c=Ba.CAT),n===void 0&&(c=Ba.IDENTITY);const f=this.createScaleConfig(c,t,s,i);l.scale=this.createDefaultScale(f),l.option=f}return l}getDefaultType(t){let r=Ba.LINEAR;return typeof t=="string"&&(r=LFt.test(t)?Ba.TIME:Ba.CAT),r}createScaleConfig(t,r,n,i){const a={type:t};let o=[];if(t===Ba.QUANTILE){const s=new Map;i==null||i.forEach(l=>{s.set(l._id,l[r])}),o=Array.from(s.values())}else o=(i==null?void 0:i.map(s=>s[r]))||[];if(n!=null&&n.domain)a.domain=n==null?void 0:n.domain;else if(t===Ba.CAT||t===Ba.IDENTITY)a.domain=IFt(o);else if(t===Ba.QUANTILE)a.domain=o;else if(t===Ba.DIVERGING){const s=f9(o),l=(n==null?void 0:n.neutral)!==void 0?n==null?void 0:n.neutral:(s[0]+s[1])/2;a.domain=[s[0],l,s[1]]}else a.domain=f9(o);return Ce(Ce({},a),n)}createDefaultScale({type:t,domain:r,unknown:n,clamp:i,nice:a}){const o=OFt[t]();return r&&o.domain&&o.domain(r),n&&o.unknown(n),i!==void 0&&o.clamp&&o.clamp(i),a!==void 0&&o.nice&&o.nice(a),o}}class DFt{apply(t){t.hooks.beforeRender.tap("LayerAnimateStylePlugin",()=>{t.animateStatus&&t.models.forEach(n=>{n.addUniforms(Ce({},t.layerModel.getAnimateUniforms()))})})}}let FFt=class{apply(t){t.hooks.afterInit.tap("LayerMaskPlugin",()=>{const{maskLayers:r,enableMask:n}=t.getLayerConfig();!t.tileLayer&&r&&r.length>0&&t.updateLayerConfig({mask:n})})}};class BFt{build(t){return Pe(function*(){t.prepareBuildModel(),yield t.buildModels()})()}initLayerModel(t){var r=this;return Pe(function*(){yield r.build(t),t.styleNeedUpdate=!1})()}prepareLayerModel(t){var r=this;return Pe(function*(){yield r.build(t),t.styleNeedUpdate=!1})()}apply(t){var r=this;t.hooks.init.tapPromise("LayerModelPlugin",Pe(function*(){if(t.getSource().isTile){t.prepareBuildModel();return}t.log(yl.BuildModelStart,ou.INIT),yield r.initLayerModel(t),t.log(yl.BuildModelEnd,ou.INIT)})),t.hooks.beforeRenderData.tapPromise("LayerModelPlugin",function(){var n=Pe(function*(i){return!i||t.getSource().isTile?!1:(t.log(yl.BuildModelStart,ou.UPDATE),yield r.prepareLayerModel(t),t.log(yl.BuildModelEnd,ou.UPDATE),!0)});return function(i){return n.apply(this,arguments)}}())}}class NFt{apply(t){t.hooks.afterInit.tap("LayerStylePlugin",()=>{const{autoFit:r,fitBoundsOptions:n}=t.getLayerConfig();r&&t.fitBounds(n),t.styleNeedUpdate=!1})}}const kFt=["type"],z9={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},zFt={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},UFt={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},$Ft={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5};function HFt(e){const t={u_DirectionalLights:new Array(3).fill(Ce({},UFt)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill(Ce({},$Ft)),u_NumOfSpotLights:0};return(!e||!e.length)&&(e=[zFt]),e.forEach(r=>{let{type:n="directional"}=r,i=Hf(r,kFt);const a=z9[n].lights,o=z9[n].num,s=t[o];t[a][s]=Ce(Ce({},t[a][s]),i),t[o]++}),t}class VFt{apply(t){t.hooks.beforeRender.tap("LightingPlugin",()=>{const{enableLighting:r}=t.getLayerConfig();r&&t.models.forEach(n=>n.addUniforms(Ce({},HFt())))})}}function eJ(e){return e.map(t=>(typeof t=="string"&&(t=[t,{}]),t))}function rJ(e,t,r,n){const i=e.multiPassRenderer;return i.add(n("render")),eJ(t).forEach(a=>{const[o,s]=a;i.add(r(o),s)}),i.add(r("copy")),i}class GFt{constructor(){z(this,"enabled",void 0)}apply(t,{rendererService:r,postProcessingPassFactory:n,normalPassFactory:i}){t.hooks.init.tapPromise("MultiPassRendererPlugin",()=>{const{enableMultiPassRenderer:a,passes:o=[]}=t.getLayerConfig();this.enabled=!!a&&t.getLayerConfig().enableMultiPassRenderer!==!1,this.enabled&&(t.multiPassRenderer=rJ(t,o,n,i),t.multiPassRenderer.setRenderFlag(!0))}),t.hooks.beforeRender.tap("MultiPassRendererPlugin",()=>{if(this.enabled){const{width:a,height:o}=r.getViewportSize();t.multiPassRenderer.resize(a,o)}})}}const Sm={POSITION:0,POSITION_64LOW:1,COLOR:2,PICKING_COLOR:3,STROKE:4,OPACITY:5,OFFSETS:6,ROTATION:7,MAX:8};function WFt(e){switch(e){case"rotation":return{name:"Rotation",type:Qr.Attribute,descriptor:{name:"a_Rotation",shaderLocation:Sm.ROTATION,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:1,update:t=>{const{rotation:r=0}=t;return Array.isArray(r)?[r[0]]:[r]}}};case"stroke":return{name:"stroke",type:Qr.Attribute,descriptor:{name:"a_Stroke",shaderLocation:Sm.STROKE,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:4,update:t=>{const{stroke:r=[1,1,1,1]}=t;return r}}};case"opacity":return{name:"opacity",type:Qr.Attribute,descriptor:{name:"a_Opacity",shaderLocation:Sm.OPACITY,buffer:{usage:q.STATIC_DRAW,data:[],type:q.FLOAT},size:1,update:t=>{const{opacity:r=1}=t;return[r]}}};case"offsets":return{name:"offsets",type:Qr.Attribute,descriptor:{name:"a_Offsets",shaderLocation:Sm.OFFSETS,buffer:{usage:q.STATIC_DRAW,data:[],type:q.FLOAT},size:2,update:t=>{const{offsets:r}=t;return r}}};default:return}}const{isNumber:XFt}=is,T1={NONE:0,ENCODE:1,HIGHLIGHT:2};class jFt{constructor(){z(this,"pickingUniformMap",void 0)}pickOption2Array(){const t=[];return this.pickingUniformMap.forEach(r=>{XFt(r)?t.push(r):t.push(...r)}),t}updatePickOption(t,r){Object.keys(t).forEach(o=>{this.pickingUniformMap.set(o,t[o])});const n=r.getLayerConfig().pickingBuffer||0,i=Number(r.getShaderPickStat());this.pickingUniformMap.set("u_PickingBuffer",n),this.pickingUniformMap.set("u_shaderPick",i),r.getPickingUniformBuffer().subData({offset:0,data:this.pickOption2Array()})}apply(t,{styleAttributeService:r}){this.pickingUniformMap=new Map([["u_HighlightColor",[1,0,0,1]],["u_SelectColor",[1,0,0,1]],["u_PickingColor",[0,0,0]],["u_PickingStage",0],["u_CurrentSelectedId",[0,0,0]],["u_PickingThreshold",10],["u_PickingBuffer",0],["u_shaderPick",0],["u_activeMix",0]]),t.hooks.init.tapPromise("PixelPickingPlugin",()=>{const{enablePicking:n}=t.getLayerConfig();r.registerStyleAttribute({name:"pickingColor",type:Qr.Attribute,descriptor:{name:"a_PickingColor",shaderLocation:Sm.PICKING_COLOR,buffer:{data:[],type:q.FLOAT},size:3,update:i=>{const{id:a}=i;return n?Rx(a):[0,0,0]}}})}),t.hooks.beforePickingEncode.tap("PixelPickingPlugin",()=>{const{enablePicking:n}=t.getLayerConfig();n&&t.isVisible()&&(this.updatePickOption({u_PickingStage:T1.ENCODE},t),t.models.forEach(i=>i.addUniforms({u_PickingStage:T1.ENCODE})))}),t.hooks.afterPickingEncode.tap("PixelPickingPlugin",()=>{const{enablePicking:n}=t.getLayerConfig();n&&t.isVisible()&&(this.updatePickOption({u_PickingStage:T1.HIGHLIGHT},t),t.models.forEach(i=>i.addUniforms({u_PickingStage:T1.HIGHLIGHT})))}),t.hooks.beforeHighlight.tap("PixelPickingPlugin",n=>{const{highlightColor:i,activeMix:a=0}=t.getLayerConfig(),o=typeof i=="string"?Qa(i):i||[1,0,0,1];t.updateLayerConfig({pickedFeatureID:Oy(new Uint8Array(n))});const s={u_PickingStage:T1.HIGHLIGHT,u_PickingColor:n,u_HighlightColor:o.map(l=>l*255),u_activeMix:a};this.updatePickOption(s,t),t.models.forEach(l=>l.addUniforms(s))}),t.hooks.beforeSelect.tap("PixelPickingPlugin",n=>{const{selectColor:i,selectMix:a=0}=t.getLayerConfig(),o=typeof i=="string"?Qa(i):i||[1,0,0,1];t.updateLayerConfig({pickedFeatureID:Oy(new Uint8Array(n))});const s={u_PickingStage:T1.HIGHLIGHT,u_PickingColor:n,u_HighlightColor:o.map(l=>l*255),u_activeMix:a,u_CurrentSelectedId:n,u_SelectColor:o.map(l=>l*255)};this.updatePickOption(s,t),t.models.forEach(l=>l.addUniforms(s))})}}const YFt=["mvt","geojsonvt","testTile"];function ZFt(e){const t=e.getSource();return YFt.includes(t.parser.type)}class qFt{apply(t,{styleAttributeService:r}){t.hooks.init.tapPromise("RegisterStyleAttributePlugin",()=>{ZFt(t)||this.registerBuiltinAttributes(r,t)})}registerBuiltinAttributes(t,r){if(r.type==="MaskLayer"){this.registerPositionAttribute(t);return}this.registerPositionAttribute(t),this.registerColorAttribute(t)}registerPositionAttribute(t){t.registerStyleAttribute({name:"position",type:Qr.Attribute,descriptor:{name:"a_Position",shaderLocation:Sm.POSITION,buffer:{data:[],type:q.FLOAT},size:3,update:(r,n,i)=>i.length===2?[i[0],i[1],0]:[i[0],i[1],i[2]]}})}registerColorAttribute(t){t.registerStyleAttribute({name:"color",type:Qr.Attribute,descriptor:{name:"a_Color",shaderLocation:Sm.COLOR,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:4,update:r=>{const{color:n}=r;return!n||!n.length?[1,1,1,1]:n}}})}}class KFt{constructor(){z(this,"cameraService",void 0),z(this,"coordinateSystemService",void 0),z(this,"rendererService",void 0),z(this,"mapService",void 0),z(this,"layerService",void 0)}apply(t,{rendererService:r,mapService:n,layerService:i,coordinateSystemService:a,cameraService:o}){this.rendererService=r,this.mapService=n,this.layerService=i,this.coordinateSystemService=a,this.cameraService=o;let s;this.rendererService.uniformBuffers[0]||(s=this.rendererService.createBuffer({data:new Float32Array(16*4+4*7),isUBO:!0,label:"renderUniformBuffer"}),this.rendererService.uniformBuffers[0]=s),t.hooks.beforeRender.tap("ShaderUniformPlugin",()=>{const l=t.getLayerConfig().tileOrigin;this.coordinateSystemService.refresh(l);const{width:u,height:c}=this.rendererService.getViewportSize(),{data:f,uniforms:d}=this.generateUBO(u,c);this.layerService.alreadyInRendering&&this.rendererService.uniformBuffers[0]&&this.rendererService.uniformBuffers[0].subData({offset:0,data:f}),this.rendererService.queryVerdorInfo()==="WebGL1"&&t.models.forEach(g=>{g.addUniforms(Ce(Ce({},d),{},{u_PickingBuffer:t.getLayerConfig().pickingBuffer||0,u_shaderPick:Number(t.getShaderPickStat())}))})})}generateUBO(t,r){const n=this.cameraService.getProjectionMatrix(),i=this.cameraService.getViewMatrix(),a=this.cameraService.getViewProjectionMatrix(),o=this.cameraService.getModelMatrix(),s=this.coordinateSystemService.getViewportCenterProjection(),l=this.coordinateSystemService.getPixelsPerDegree(),u=this.cameraService.getZoom(),c=this.coordinateSystemService.getPixelsPerDegree2(),f=this.cameraService.getZoomScale(),d=this.coordinateSystemService.getPixelsPerMeter(),v=this.coordinateSystemService.getCoordinateSystem(),g=this.cameraService.getCameraPosition(),x=window.devicePixelRatio,w=this.coordinateSystemService.getViewportCenter(),S=[t,r],A=this.cameraService.getFocalDistance();return{data:[...i,...n,...a,...o,...s,...l,u,...c,f,...d,v,...g,x,...w,...S,A,0,0,0],uniforms:{[ey.ProjectionMatrix]:n,[ey.ViewMatrix]:i,[ey.ViewProjectionMatrix]:a,[ey.Zoom]:u,[ey.ZoomScale]:f,[ey.FocalDistance]:A,[ey.CameraPosition]:g,[w1.CoordinateSystem]:v,[w1.ViewportCenter]:w,[w1.ViewportCenterProjection]:s,[w1.PixelsPerDegree]:l,[w1.PixelsPerDegree2]:c,[w1.PixelsPerMeter]:d,u_ViewportSize:S,u_ModelMatrix:o,u_DevicePixelRatio:x}}}}class QFt{apply(t){t.hooks.beforeRender.tap("UpdateModelPlugin",()=>{t.layerModel&&t.layerModel.needUpdate().then(r=>{r&&t.renderLayers()})}),t.hooks.afterRender.tap("UpdateModelPlugin",()=>{t.layerModelNeedUpdate=!1})}}class JFt{apply(t,{styleAttributeService:r}){t.hooks.init.tapPromise("UpdateStyleAttributePlugin",()=>{this.initStyleAttribute(t,{styleAttributeService:r})}),t.hooks.beforeRender.tap("UpdateStyleAttributePlugin",()=>{t.layerModelNeedUpdate||t.inited&&this.updateStyleAttribute(t,{styleAttributeService:r})})}updateStyleAttribute(t,{styleAttributeService:r}){const n=r.getLayerStyleAttributes()||[],i=r.getLayerStyleAttribute("filter");if(i&&i.needRegenerateVertices){t.layerModelNeedUpdate=!0,n.forEach(a=>a.needRegenerateVertices=!1);return}n.filter(a=>a.needRegenerateVertices).forEach(a=>{r.updateAttributeByFeatureRange(a.name,t.getEncodedData(),a.featureRange.startIndex,a.featureRange.endIndex,t),a.needRegenerateVertices=!1})}initStyleAttribute(t,{styleAttributeService:r}){(r.getLayerStyleAttributes()||[]).filter(i=>i.needRegenerateVertices).forEach(i=>{r.updateAttributeByFeatureRange(i.name,t.getEncodedData(),i.featureRange.startIndex,i.featureRange.endIndex),i.needRegenerateVertices=!1})}}function tBt(){return[new pPt,new qFt,new PFt,new dPt,new NFt,new FFt,new JFt,new QFt,new GFt,new KFt,new DFt,new VFt,new jFt,new BFt]}const nJ={[pm.additive]:{enable:!0,func:{srcRGB:q.ONE,dstRGB:q.ONE,srcAlpha:1,dstAlpha:1}},[pm.none]:{enable:!1},[pm.normal]:{enable:!0,func:{srcRGB:q.SRC_ALPHA,dstRGB:q.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}},[pm.subtractive]:{enable:!0,func:{srcRGB:q.ONE,dstRGB:q.ONE,srcAlpha:q.ZERO,dstAlpha:q.ONE_MINUS_SRC_COLOR},equation:{rgb:q.FUNC_SUBTRACT,alpha:q.FUNC_SUBTRACT}},[pm.max]:{enable:!0,func:{srcRGB:q.ONE,dstRGB:q.ONE},equation:{rgb:q.MAX_EXT}},[pm.min]:{enable:!0,func:{srcRGB:q.ONE,dstRGB:q.ONE},equation:{rgb:q.MIN_EXT}}};class eBt{constructor(t){z(this,"layer",void 0),this.layer=t}pickRender(t){const n=this.layer.getContainer().layerService,i=this.layer;if(i.tileLayer)return i.tileLayer.pickRender(t);i.hooks.beforePickingEncode.call(),n.renderTileLayerMask(i),i.renderModels({ispick:!0}),i.hooks.afterPickingEncode.call()}pick(t,r){var n=this;return Pe(function*(){const a=n.layer.getContainer().pickingService;return t.type==="RasterLayer"?n.pickRasterLayer(t,r):(n.pickRender(r),a.pickFromPickingFBO(t,r))})()}pickRasterLayer(t,r,n){const i=this.layer.getContainer(),a=i.pickingService,o=i.mapService,s=this.layer.getSource().extent,l=_Tt(r.lngLat,s),u={x:r.x,y:r.y,type:r.type,lngLat:r.lngLat,target:r,rasterValue:null},c=n||t;if(l){const f=this.readRasterValue(t,s,o,r.x,r.y);return u.rasterValue=f,a.triggerHoverOnLayer(c,u),!0}else return u.type=r.type==="mousemove"?"mouseout":"un"+r.type,a.triggerHoverOnLayer(c,Ce(Ce({},u),{},{type:"unpick"})),a.triggerHoverOnLayer(c,u),!1}readRasterValue(t,r,n,i,a){const o=t.getSource().data.dataArray[0],[s=0,l=0,u=10,c=-10]=r,f=n.lngLatToContainer([s,l]),d=n.lngLatToContainer([u,c]),v=d.x-f.x,g=f.y-d.y,x=[(i-f.x)/v,(a-d.y)/g],w=o.width||1,S=o.height||1,A=Math.floor(x[0]*w),M=Math.floor(x[1]*S),R=Math.max(0,M-1)*w+A;return o.data[R]}selectFeature(t){const r=this.layer,[n,i,a]=t;r.hooks.beforeSelect.call([n,i,a])}highlightPickedFeature(t){const[r,n,i]=t;this.layer.hooks.beforeHighlight.call([r,n,i])}getFeatureById(t){return this.layer.getSource().getFeatureById(t)}}class rBt{constructor(t){z(this,"layer",void 0),z(this,"rendererService",void 0),z(this,"colorTexture",void 0),z(this,"key",void 0),this.layer=t;const r=this.layer.getContainer();this.rendererService=r.rendererService}getColorTexture(t,r){const n=this.getTextureKey(t,r);return this.key===n?this.colorTexture:(this.createColorTexture(t,r),this.key=n,this.colorTexture)}createColorTexture(t,r){const{createTexture2D:n}=this.rendererService,i=this.getColorRampBar(t,r),a=n({data:new Uint8Array(i.data),width:i.width,height:i.height,flipY:!1,unorm:!0});return this.colorTexture=a,a}setColorTexture(t,r,n){this.key=this.getTextureKey(r,n),this.colorTexture=t}destroy(){var t;(t=this.colorTexture)===null||t===void 0||t.destroy()}getColorRampBar(t,r){switch(t.type){case"cat":return Uft(t);case"quantize":return $ft(t);case"custom":return Hft(t,r);case"linear":return zft(t,r);default:return qZ(t)}}getTextureKey(t,r){var n;return`${t.colors.join("_")}_${t==null||(n=t.positions)===null||n===void 0?void 0:n.join("_")}_${t.type}_${r==null?void 0:r.join("_")}`}}const nBt=["passes"],iBt=["moduleName","vertexShader","fragmentShader","defines","inject","triangulation","styleOption","pickingEnabled"],{isEqual:yO,isFunction:U9,isNumber:$9,isObject:ru,isPlainObject:aBt,isUndefined:oBt}=is;let H9=0;class b_ extends $u.EventEmitter{get shaderModuleService(){return this.container.shaderModuleService}get cameraService(){return this.container.cameraService}get coordinateService(){return this.container.coordinateSystemService}get iconService(){return this.container.iconService}get fontService(){return this.container.fontService}get pickingService(){return this.container.pickingService}get rendererService(){return this.container.rendererService}get layerService(){return this.container.layerService}get debugService(){return this.container.debugService}get interactionService(){return this.container.interactionService}get mapService(){var t;return(t=this.container)===null||t===void 0?void 0:t.mapService}get normalPassFactory(){return this.container.normalPassFactory}constructor(t={}){super(),z(this,"id",`${H9++}`),z(this,"name",`${H9}`),z(this,"parent",void 0),z(this,"coordCenter",void 0),z(this,"type",void 0),z(this,"visible",!0),z(this,"zIndex",0),z(this,"minZoom",void 0),z(this,"maxZoom",void 0),z(this,"inited",!1),z(this,"layerModelNeedUpdate",!1),z(this,"pickedFeatureID",null),z(this,"selectedFeatureID",null),z(this,"styleNeedUpdate",!1),z(this,"rendering",void 0),z(this,"forceRender",!1),z(this,"clusterZoom",0),z(this,"layerType",void 0),z(this,"triangulation",void 0),z(this,"layerPickService",void 0),z(this,"textureService",void 0),z(this,"defaultSourceConfig",{data:[],options:{parser:{type:"json"}}}),z(this,"dataState",{dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1}),z(this,"hooks",{init:new ZIt,afterInit:new EU,beforeRender:new EU,beforeRenderData:new qIt,afterRender:new Tp,beforePickingEncode:new Tp,afterPickingEncode:new Tp,beforeHighlight:new Tp(["pickedColor"]),afterHighlight:new Tp,beforeSelect:new Tp(["pickedColor"]),afterSelect:new Tp,beforeDestroy:new Tp,afterDestroy:new Tp}),z(this,"models",[]),z(this,"multiPassRenderer",void 0),z(this,"plugins",void 0),z(this,"startInit",!1),z(this,"sourceOption",void 0),z(this,"layerModel",void 0),z(this,"shapeOption",void 0),z(this,"tileLayer",void 0),z(this,"layerChildren",[]),z(this,"masks",[]),z(this,"configService",eQ),z(this,"styleAttributeService",void 0),z(this,"layerSource",void 0),z(this,"postProcessingPassFactory",void 0),z(this,"animateOptions",{enable:!1}),z(this,"container",void 0),z(this,"encodedData",void 0),z(this,"currentPickId",null),z(this,"rawConfig",void 0),z(this,"needUpdateConfig",void 0),z(this,"encodeStyleAttribute",{}),z(this,"enableShaderEncodeStyles",[]),z(this,"enableDataEncodeStyles",[]),z(this,"pendingStyleAttributes",[]),z(this,"scaleOptions",{}),z(this,"animateStartTime",void 0),z(this,"animateStatus",!1),z(this,"isDestroyed",!1),z(this,"uniformBuffers",[]),z(this,"encodeDataLength",0),z(this,"sourceEvent",()=>{this.dataState.dataSourceNeedUpdate=!0;const r=this.getLayerConfig();r&&r.autoFit&&this.fitBounds(r.fitBoundsOptions),this.layerSource.getSourceCfg().autoRender&&setTimeout(()=>{this.reRender()},10)}),this.name=t.name||this.id,this.zIndex=t.zIndex||0,this.rawConfig=t,this.masks=t.maskLayers||[]}addMask(t){this.masks.push(t),this.updateLayerConfig({maskLayers:this.masks}),this.enableMask()}removeMask(t){const r=this.masks.indexOf(t);r>-1&&this.masks.splice(r,1),this.updateLayerConfig({maskLayers:this.masks})}disableMask(){this.updateLayerConfig({enableMask:!1})}enableMask(){this.updateLayerConfig({enableMask:!0})}addMaskLayer(t){this.masks.push(t)}removeMaskLayer(t){const r=this.masks.indexOf(t);r>-1&&this.masks.splice(r,1),t.destroy()}getAttribute(t){return this.styleAttributeService.getLayerStyleAttribute(t)}getLayerConfig(){return this.configService.getLayerConfig(this.id)}updateLayerConfig(t){if(Object.keys(t).map(r=>{r in this.rawConfig&&(this.rawConfig[r]=t[r])}),!this.startInit)this.needUpdateConfig=Ce(Ce({},this.needUpdateConfig),t);else{const r=this.container.id;this.configService.setLayerConfig(r,this.id,Ce(Ce(Ce({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),t)),this.needUpdateConfig={}}}setContainer(t){this.container=t}getContainer(){return this.container}addPlugin(t){return this.plugins.push(t),this}init(){var t=this;return Pe(function*(){const r=t.container.id;t.startInit=!0,t.configService.setLayerConfig(r,t.id,t.rawConfig),t.layerType=t.rawConfig.layerType;const{enableMultiPassRenderer:n,passes:i}=t.getLayerConfig();n&&i!==null&&i!==void 0&&i.length&&i.length>0&&t.mapService.on("mapAfterFrameChange",()=>{t.renderLayers()}),t.postProcessingPassFactory=t.container.postProcessingPassFactory,t.styleAttributeService=t.container.styleAttributeService,n&&(t.multiPassRenderer=t.container.multiPassRenderer,t.multiPassRenderer.setLayer(t)),t.pendingStyleAttributes.forEach(({attributeName:a,attributeField:o,attributeValues:s,updateOptions:l})=>{t.styleAttributeService.updateStyleAttribute(a,{scale:Ce({field:o},t.splitValuesAndCallbackInAttribute(s,o?void 0:t.getLayerConfig()[a]))},l)}),t.pendingStyleAttributes=[],t.plugins=tBt();for(const a of t.plugins)a.apply(t,t.container);t.layerPickService=new eBt(t),t.textureService=new rBt(t),t.log(yl.LayerInitStart),yield t.hooks.init.promise(),t.log(yl.LayerInitEnd),t.inited=!0,t.emit("inited",{target:t,type:"inited"}),t.emit("add",{target:t,type:"add"}),t.hooks.afterInit.call()})()}log(t,r="init"){var n;if(this.tileLayer||this.isTileLayer)return;const i=`${this.id}.${r}.${t}`,a={id:this.id,type:this.type};(n=this.debugService)===null||n===void 0||n.log(i,a)}updateModelData(t){t.attributes&&t.elements?this.models.map(r=>{r.updateAttributesAndElements(t.attributes,t.elements)}):console.warn("data error")}setLayerPickService(t){this.layerPickService=t}prepareBuildModel(){Object.keys(this.needUpdateConfig||{}).length!==0&&this.updateLayerConfig({});const{animateOption:t}=this.getLayerConfig();t!=null&&t.enable&&(this.layerService.startAnimate(),this.animateStatus=!0)}color(t,r,n){return this.updateStyleAttribute("color",t,r,n),this}texture(t,r,n){return this.updateStyleAttribute("texture",t,r,n),this}rotate(t,r,n){return this.updateStyleAttribute("rotate",t,r,n),this}size(t,r,n){return this.updateStyleAttribute("size",t,r,n),this}filter(t,r,n){const i=this.updateStyleAttribute("filter",t,r,n);return this.dataState.dataSourceNeedUpdate=i&&this.inited,this}shape(t,r,n){this.shapeOption={field:t,values:r};const i=this.updateStyleAttribute("shape",t,r,n);return this.dataState.dataSourceNeedUpdate=i&&this.inited,this}label(t,r,n){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:t,attributeValues:r,updateOptions:n}),this}animate(t){let r={};return ru(t)?(r.enable=!0,r=Ce(Ce({},r),t)):r.enable=t,this.updateLayerConfig({animateOption:r}),this}source(t,r){return(t==null?void 0:t.type)==="source"?(this.setSource(t),this):(this.sourceOption={data:t,options:r},this.clusterZoom=0,this)}setData(t,r){return this.inited?(this.dataUpdatelog(),this.layerSource.setData(t,r)):this.on("inited",()=>{this.dataUpdatelog(),this.layerSource.setData(t,r)}),this}dataUpdatelog(){this.log(yl.SourceInitStart,ou.UPDATE),this.layerSource.once("update",()=>{this.log(yl.SourceInitEnd,ou.UPDATE)})}style(t){const{passes:r}=t,n=Hf(t,nBt);r&&eJ(r).forEach(a=>{const o=this.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(a[0]);o&&o.updateOptions(a[1])}),n.borderColor&&(n.stroke=n.borderColor),n.borderWidth&&(n.strokeWidth=n.borderWidth);const i=n;return Object.keys(n).forEach(a=>{const o=n[a];Array.isArray(o)&&o.length===2&&!$9(o[0])&&!$9(o[1])&&(i[a]={field:o[0],value:o[1]})}),this.encodeStyle(i),this.updateLayerConfig(i),this}encodeStyle(t){Object.keys(t).forEach(r=>{[...this.enableShaderEncodeStyles,...this.enableDataEncodeStyles].includes(r)&&aBt(t[r])&&(t[r].field||t[r].value)&&!yO(this.encodeStyleAttribute[r],t[r])?(this.encodeStyleAttribute[r]=t[r],this.updateStyleAttribute(r,t[r].field,t[r].value),this.inited&&(this.dataState.dataMappingNeedUpdate=!0)):this.encodeStyleAttribute[r]&&(delete this.encodeStyleAttribute[r],this.dataState.dataSourceNeedUpdate=!0)})}scale(t,r){const n=Ce({},this.scaleOptions);if(ru(t)?this.scaleOptions=Ce(Ce({},this.scaleOptions),t):this.scaleOptions[t]=r,this.styleAttributeService&&!yO(n,this.scaleOptions)){const i=ru(t)?t:{[t]:r};this.styleAttributeService.updateScaleAttribute(i)}return this}renderLayers(){this.rendering=!0,this.layerService.reRender(),this.rendering=!1}prerender(){}render(t={}){return this.tileLayer?(this.tileLayer.render(),this):(this.layerService.beforeRenderData(this),this.encodeDataLength<=0&&!this.forceRender?this:(this.renderModels(t),this))}renderMultiPass(){var t=this;return Pe(function*(){t.encodeDataLength<=0&&!t.forceRender||(t.multiPassRenderer&&t.multiPassRenderer.getRenderFlag()?yield t.multiPassRenderer.render():t.renderModels())})()}active(t){const r={};return r.enableHighlight=ru(t)?!0:t,ru(t)?(r.enableHighlight=!0,t.color&&(r.highlightColor=t.color),t.mix&&(r.activeMix=t.mix)):r.enableHighlight=!!t,this.updateLayerConfig(r),this}setActive(t,r){if(ru(t)){const{x:n=0,y:i=0}=t;this.updateLayerConfig({highlightColor:ru(r)?r.color:this.getLayerConfig().highlightColor,activeMix:ru(r)?r.mix:this.getLayerConfig().activeMix}),this.pick({x:n,y:i})}else this.updateLayerConfig({pickedFeatureID:t,highlightColor:ru(r)?r.color:this.getLayerConfig().highlightColor,activeMix:ru(r)?r.mix:this.getLayerConfig().activeMix}),this.hooks.beforeHighlight.call(Rx(t)).then(()=>{setTimeout(()=>{this.reRender()},1)})}select(t){const r={};return r.enableSelect=ru(t)?!0:t,ru(t)?(r.enableSelect=!0,t.color&&(r.selectColor=t.color),t.mix&&(r.selectMix=t.mix)):r.enableSelect=!!t,this.updateLayerConfig(r),this}setSelect(t,r){if(ru(t)){const{x:n=0,y:i=0}=t;this.updateLayerConfig({selectColor:ru(r)?r.color:this.getLayerConfig().selectColor,selectMix:ru(r)?r.mix:this.getLayerConfig().selectMix}),this.pick({x:n,y:i})}else this.updateLayerConfig({pickedFeatureID:t,selectColor:ru(r)?r.color:this.getLayerConfig().selectColor,selectMix:ru(r)?r.mix:this.getLayerConfig().selectMix}),this.hooks.beforeSelect.call(Rx(t)).then(()=>{setTimeout(()=>{this.reRender()},1)})}setBlend(t){return this.updateLayerConfig({blend:t}),this.reRender(),this}show(){return this.updateLayerConfig({visible:!0}),this.reRender(),this.emit("show"),this}hide(){return this.updateLayerConfig({visible:!1}),this.reRender(),this.emit("hide"),this}setIndex(t){return this.zIndex=t,this.layerService.updateLayerRenderList(),this.layerService.renderLayers(),this}setCurrentPickId(t){this.currentPickId=t}getCurrentPickId(){return this.currentPickId}setCurrentSelectedId(t){this.selectedFeatureID=t}getCurrentSelectedId(){return this.selectedFeatureID}isVisible(){const t=this.mapService.getZoom(),{visible:r,minZoom:n=-1/0,maxZoom:i=1/0}=this.getLayerConfig();return!!r&&t>=n&&t<i}setMultiPass(t,r){if(this.updateLayerConfig({enableMultiPassRenderer:t}),r&&this.updateLayerConfig({passes:r}),t){const{passes:n=[]}=this.getLayerConfig();this.multiPassRenderer=rJ(this,n,this.postProcessingPassFactory,this.normalPassFactory),this.multiPassRenderer.setRenderFlag(!0);const{width:i,height:a}=this.rendererService.getViewportSize();this.multiPassRenderer.resize(i,a)}return this}setMinZoom(t){return this.updateLayerConfig({minZoom:t}),this}getMinZoom(){const{minZoom:t}=this.getLayerConfig();return t}getMaxZoom(){const{maxZoom:t}=this.getLayerConfig();return t}get(t){return this.getLayerConfig()[t]}setMaxZoom(t){return this.updateLayerConfig({maxZoom:t}),this}setAutoFit(t){return this.updateLayerConfig({autoFit:t}),this}fitBounds(t){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;const n=this.getSource().extent;return n.some(a=>Math.abs(a)===1/0)?this:(this.mapService.fitBounds([[n[0],n[1]],[n[2],n[3]]],t),this)}destroy(t=!0){var r,n,i,a,o;if(this.isDestroyed)return;(r=this.layerModel)===null||r===void 0||r.uniformBuffers.forEach(l=>{l.destroy()}),this.layerChildren.map(l=>l.destroy(!1)),this.layerChildren=[];const{maskfence:s}=this.getLayerConfig();s&&(this.masks.map(l=>l.destroy(!1)),this.masks=[]),this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),(n=this.multiPassRenderer)===null||n===void 0||n.destroy(),this.textureService.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),(i=this.layerModel)===null||i===void 0||i.clearModels(t),(a=this.tileLayer)===null||a===void 0||a.destroy(),this.models=[],(o=this.debugService)===null||o===void 0||o.removeLog(this.id),this.emit("remove",{target:this,type:"remove"}),this.emit("destroy",{target:this,type:"destroy"}),this.removeAllListeners(),this.isDestroyed=!0}clear(){this.styleAttributeService.clearAllAttributes()}clearModels(){var t;this.models.forEach(r=>r.destroy()),(t=this.layerModel)===null||t===void 0||t.clearModels(),this.models=[]}isDirty(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter(t=>t.needRescale||t.needRemapping||t.needRegenerateVertices).length}setSource(t){if(this.layerSource&&this.layerSource.off("update",this.sourceEvent),this.layerSource=t,this.clusterZoom=0,this.inited&&this.layerSource.cluster){const r=this.mapService.getZoom();this.layerSource.updateClusterData(r)}this.layerSource.inited&&this.sourceEvent(),this.layerSource.on("update",({type:r})=>{if(this.coordCenter===void 0){const n=this.layerSource.center;this.coordCenter=n}if(r==="update"){if(this.tileLayer){this.tileLayer.reload();return}this.sourceEvent()}})}getSource(){return this.layerSource}getScaleOptions(){return this.scaleOptions}setEncodedData(t){this.encodedData=t,this.encodeDataLength=t.length}getEncodedData(){return this.encodedData}getScale(t){return this.styleAttributeService.getLayerAttributeScale(t)}getLegend(t){var r,n,i;const a=this.styleAttributeService.getLayerStyleAttribute(t);return{type:(n=((a==null||(r=a.scale)===null||r===void 0?void 0:r.scalers)||[])[0])===null||n===void 0||(n=n.option)===null||n===void 0?void 0:n.type,field:a==null||(i=a.scale)===null||i===void 0?void 0:i.field,items:this.getLegendItems(t)}}getLegendItems(t){const r=this.styleAttributeService.getLayerAttributeScale(t);return r?r.invertExtent?r.range().map(i=>({value:r.invertExtent(i),[t]:i})):r.ticks?r.ticks().map(i=>({value:i,[t]:r(i)})):r!=null&&r.domain?r.domain().filter(i=>!oBt(i)).map(i=>({value:i,[t]:r(i)})):[]:[]}pick({x:t,y:r}){this.interactionService.triggerHover({x:t,y:r})}boxSelect(t,r){this.pickingService.boxPickLayer(this,t,r)}buildLayerModel(t){var r=this;return Pe(function*(){const{moduleName:n,vertexShader:i,fragmentShader:a,defines:o,inject:s,triangulation:l,styleOption:u,pickingEnabled:c=!0}=t,f=Hf(t,iBt);r.shaderModuleService.registerModule(n,{vs:i,fs:a,defines:o,inject:s});const{vs:d,fs:v,uniforms:g}=r.shaderModuleService.getModule(n),{createModel:x}=r.rendererService;return new Promise(w=>{const{attributes:S,elements:A,count:M}=r.styleAttributeService.createAttributesAndIndices(r.encodedData,l,u,r),R=[...r.layerModel.uniformBuffers,...r.rendererService.uniformBuffers];c&&R.push(r.getPickingUniformBuffer());const O=Ce({attributes:S,uniforms:g,fs:v,vs:d,elements:A,blend:nJ[pm.normal],uniformBuffers:R,textures:r.layerModel.textures},f);M&&(O.count=M);const N=x(O);w(N)})})()}createAttributes(t){const{triangulation:r}=t,{attributes:n}=this.styleAttributeService.createAttributes(this.encodedData,r);return n}getTime(){return this.layerService.clock.getDelta()}setAnimateStartTime(){this.animateStartTime=this.layerService.clock.getElapsedTime()}stopAnimate(){this.animateStatus&&(this.layerService.stopAnimate(),this.animateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}getLayerAnimateTime(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}needPick(t){const{enableHighlight:r=!0,enableSelect:n=!0}=this.getLayerConfig();let i=this.eventNames().indexOf(t)!==-1||this.eventNames().indexOf("un"+t)!==-1;return(t==="click"||t==="dblclick")&&n&&(i=!0),t==="mousemove"&&(r||this.eventNames().indexOf("mouseenter")!==-1||this.eventNames().indexOf("unmousemove")!==-1||this.eventNames().indexOf("mouseout")!==-1)&&(i=!0),this.isVisible()&&i}buildModels(){return Pe(function*(){throw new Error("Method not implemented.")})()}rebuildModels(){var t=this;return Pe(function*(){yield t.buildModels()})()}renderMulPass(t){return Pe(function*(){yield t.render()})()}renderModels(t={}){return this.encodeDataLength<=0&&!this.forceRender?(this.clearModels(),this):(this.hooks.beforeRender.call(),this.models.forEach(r=>{r.draw({uniforms:this.layerModel.getUninforms(),blend:this.layerModel.getBlend(),stencil:this.layerModel.getStencil(t),textures:this.layerModel.textures},(t==null?void 0:t.ispick)||!1)}),this.hooks.afterRender.call(),this)}updateStyleAttribute(t,r,n,i){const a=this.configService.getAttributeConfig(this.id)||{};return yO(a[t],{field:r,values:n})?!1:(["color","size","texture","rotate","filter","label","shape"].indexOf(t)!==-1&&this.configService.setAttributeConfig(this.id,{[t]:{field:r,values:n}}),this.startInit?this.styleAttributeService.updateStyleAttribute(t,{scale:Ce({field:r},this.splitValuesAndCallbackInAttribute(n,this.getLayerConfig()[r]))},i):this.pendingStyleAttributes.push({attributeName:t,attributeField:r,attributeValues:n,updateOptions:i}),!0)}getLayerAttributeConfig(){return this.configService.getAttributeConfig(this.id)}getShaderPickStat(){return this.layerService.getShaderPickStat()}setEarthTime(t){console.warn("empty fn")}processData(t){return t}getModelType(){throw new Error("Method not implemented.")}getDefaultConfig(){return{}}initLayerModels(){var t=this;return Pe(function*(){t.models.forEach(n=>n.destroy()),t.models=[],t.uniformBuffers.forEach(n=>{n.destroy()}),t.uniformBuffers=[];const r=t.rendererService.createBuffer({data:new Float32Array(20).fill(0),isUBO:!0,label:"pickingUniforms"});t.uniformBuffers.push(r),t.models=yield t.layerModel.initModels()})()}getPickingUniformBuffer(){return this.uniformBuffers[0]}reRender(){this.inited&&this.layerService.reRender()}splitValuesAndCallbackInAttribute(t){return{values:U9(t)?void 0:t,callback:U9(t)?t:void 0}}}function sBt(e,t){return{enable:e,mask:255,func:{cmp:q.EQUAL,ref:t?1:0,mask:1}}}function V9(e){return e.maskOperation===lI.OR?{enable:!0,mask:255,func:{cmp:q.ALWAYS,ref:1,mask:255},opFront:{fail:q.KEEP,zfail:q.REPLACE,zpass:q.REPLACE}}:{enable:!0,mask:255,func:{cmp:e.stencilType===by.SINGLE||e.stencilIndex===0?q.ALWAYS:q.LESS,ref:e.stencilType===by.SINGLE?1:e.stencilIndex===0?2:1,mask:255},opFront:{fail:q.KEEP,zfail:q.REPLACE,zpass:q.REPLACE}}}const lBt={opacity:1,stroke:[1,0,0,1],offsets:[0,0],rotation:0,extrusionBase:0,strokeOpacity:1,thetaOffset:.314},Q2={opacity:"float",stroke:"vec4",offsets:"vec2",textOffset:"vec2",rotation:"float",extrusionBase:"float",strokeOpacity:"float",thetaOffset:"float"};var c4={exports:{}};c4.exports=vI;c4.exports.default=vI;function vI(e,t,r){r=r||2;var n=t&&t.length,i=n?t[0]*r:e.length,a=iJ(e,0,i,r,!0),o=[];if(!a||a.next===a.prev)return o;var s,l,u,c,f,d,v;if(n&&(a=dBt(e,t,a,r)),e.length>80*r){s=u=e[0],l=c=e[1];for(var g=r;g<i;g+=r)f=e[g],d=e[g+1],f<s&&(s=f),d<l&&(l=d),f>u&&(u=f),d>c&&(c=d);v=Math.max(u-s,c-l),v=v!==0?32767/v:0}return pC(a,o,r,s,l,v,0),o}function iJ(e,t,r,n,i){var a,o;if(i===PD(e,t,r,n)>0)for(a=t;a<r;a+=n)o=G9(a,e[a],e[a+1],o);else for(a=r-n;a>=t;a-=n)o=G9(a,e[a],e[a+1],o);return o&&gI(o,o.next)&&(gC(o),o=o.next),o}function qy(e,t){if(!e)return e;t||(t=e);var r=e,n;do if(n=!1,!r.steiner&&(gI(r,r.next)||_s(r.prev,r,r.next)===0)){if(gC(r),r=t=r.prev,r===r.next)break;n=!0}else r=r.next;while(n||r!==t);return t}function pC(e,t,r,n,i,a,o){if(e){!o&&a&&yBt(e,n,i,a);for(var s=e,l,u;e.prev!==e.next;){if(l=e.prev,u=e.next,a?cBt(e,n,i,a):uBt(e)){t.push(l.i/r|0),t.push(e.i/r|0),t.push(u.i/r|0),gC(e),e=u.next,s=u.next;continue}if(e=u,e===s){o?o===1?(e=hBt(qy(e),t,r),pC(e,t,r,n,i,a,2)):o===2&&fBt(e,t,r,n,i,a):pC(qy(e),t,r,n,i,a,1);break}}}}function uBt(e){var t=e.prev,r=e,n=e.next;if(_s(t,r,n)>=0)return!1;for(var i=t.x,a=r.x,o=n.x,s=t.y,l=r.y,u=n.y,c=i<a?i<o?i:o:a<o?a:o,f=s<l?s<u?s:u:l<u?l:u,d=i>a?i>o?i:o:a>o?a:o,v=s>l?s>u?s:u:l>u?l:u,g=n.next;g!==t;){if(g.x>=c&&g.x<=d&&g.y>=f&&g.y<=v&&X1(i,s,a,l,o,u,g.x,g.y)&&_s(g.prev,g,g.next)>=0)return!1;g=g.next}return!0}function cBt(e,t,r,n){var i=e.prev,a=e,o=e.next;if(_s(i,a,o)>=0)return!1;for(var s=i.x,l=a.x,u=o.x,c=i.y,f=a.y,d=o.y,v=s<l?s<u?s:u:l<u?l:u,g=c<f?c<d?c:d:f<d?f:d,x=s>l?s>u?s:u:l>u?l:u,w=c>f?c>d?c:d:f>d?f:d,S=LD(v,g,t,r,n),A=LD(x,w,t,r,n),M=e.prevZ,R=e.nextZ;M&&M.z>=S&&R&&R.z<=A;){if(M.x>=v&&M.x<=x&&M.y>=g&&M.y<=w&&M!==i&&M!==o&&X1(s,c,l,f,u,d,M.x,M.y)&&_s(M.prev,M,M.next)>=0||(M=M.prevZ,R.x>=v&&R.x<=x&&R.y>=g&&R.y<=w&&R!==i&&R!==o&&X1(s,c,l,f,u,d,R.x,R.y)&&_s(R.prev,R,R.next)>=0))return!1;R=R.nextZ}for(;M&&M.z>=S;){if(M.x>=v&&M.x<=x&&M.y>=g&&M.y<=w&&M!==i&&M!==o&&X1(s,c,l,f,u,d,M.x,M.y)&&_s(M.prev,M,M.next)>=0)return!1;M=M.prevZ}for(;R&&R.z<=A;){if(R.x>=v&&R.x<=x&&R.y>=g&&R.y<=w&&R!==i&&R!==o&&X1(s,c,l,f,u,d,R.x,R.y)&&_s(R.prev,R,R.next)>=0)return!1;R=R.nextZ}return!0}function hBt(e,t,r){var n=e;do{var i=n.prev,a=n.next.next;!gI(i,a)&&aJ(i,n,n.next,a)&&vC(i,a)&&vC(a,i)&&(t.push(i.i/r|0),t.push(n.i/r|0),t.push(a.i/r|0),gC(n),gC(n.next),n=e=a),n=n.next}while(n!==e);return qy(n)}function fBt(e,t,r,n,i,a){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&bBt(o,s)){var l=oJ(o,s);o=qy(o,o.next),l=qy(l,l.next),pC(o,t,r,n,i,a,0),pC(l,t,r,n,i,a,0);return}s=s.next}o=o.next}while(o!==e)}function dBt(e,t,r,n){var i=[],a,o,s,l,u;for(a=0,o=t.length;a<o;a++)s=t[a]*n,l=a<o-1?t[a+1]*n:e.length,u=iJ(e,s,l,n,!1),u===u.next&&(u.steiner=!0),i.push(xBt(u));for(i.sort(pBt),a=0;a<i.length;a++)r=vBt(i[a],r);return r}function pBt(e,t){return e.x-t.x}function vBt(e,t){var r=gBt(e,t);if(!r)return t;var n=oJ(r,e);return qy(n,n.next),qy(r,r.next)}function gBt(e,t){var r=t,n=e.x,i=e.y,a=-1/0,o;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var s=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=n&&s>a&&(a=s,o=r.x<r.next.x?r:r.next,s===n))return o}r=r.next}while(r!==t);if(!o)return null;var l=o,u=o.x,c=o.y,f=1/0,d;r=o;do n>=r.x&&r.x>=u&&n!==r.x&&X1(i<c?n:a,i,u,c,i<c?a:n,i,r.x,r.y)&&(d=Math.abs(i-r.y)/(n-r.x),vC(r,e)&&(d<f||d===f&&(r.x>o.x||r.x===o.x&&mBt(o,r)))&&(o=r,f=d)),r=r.next;while(r!==l);return o}function mBt(e,t){return _s(e.prev,e,t.prev)<0&&_s(t.next,e,e.next)<0}function yBt(e,t,r,n){var i=e;do i.z===0&&(i.z=LD(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,_Bt(i)}function _Bt(e){var t,r,n,i,a,o,s,l,u=1;do{for(r=e,e=null,a=null,o=0;r;){for(o++,n=r,s=0,t=0;t<u&&(s++,n=n.nextZ,!!n);t++);for(l=u;s>0||l>0&&n;)s!==0&&(l===0||!n||r.z<=n.z)?(i=r,r=r.nextZ,s--):(i=n,n=n.nextZ,l--),a?a.nextZ=i:e=i,i.prevZ=a,a=i;r=n}a.nextZ=null,u*=2}while(o>1);return e}function LD(e,t,r,n,i){return e=(e-r)*i|0,t=(t-n)*i|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function xBt(e){var t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}function X1(e,t,r,n,i,a,o,s){return(i-o)*(t-s)>=(e-o)*(a-s)&&(e-o)*(n-s)>=(r-o)*(t-s)&&(r-o)*(a-s)>=(i-o)*(n-s)}function bBt(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!EBt(e,t)&&(vC(e,t)&&vC(t,e)&&wBt(e,t)&&(_s(e.prev,e,t.prev)||_s(e,t.prev,t))||gI(e,t)&&_s(e.prev,e,e.next)>0&&_s(t.prev,t,t.next)>0)}function _s(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function gI(e,t){return e.x===t.x&&e.y===t.y}function aJ(e,t,r,n){var i=tT(_s(e,t,r)),a=tT(_s(e,t,n)),o=tT(_s(r,n,e)),s=tT(_s(r,n,t));return!!(i!==a&&o!==s||i===0&&J2(e,r,t)||a===0&&J2(e,n,t)||o===0&&J2(r,e,n)||s===0&&J2(r,t,n))}function J2(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function tT(e){return e>0?1:e<0?-1:0}function EBt(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&aJ(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}function vC(e,t){return _s(e.prev,e,e.next)<0?_s(e,t,e.next)>=0&&_s(e,e.prev,t)>=0:_s(e,t,e.prev)<0||_s(e,e.next,t)<0}function wBt(e,t){var r=e,n=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do r.y>a!=r.next.y>a&&r.next.y!==r.y&&i<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next;while(r!==e);return n}function oJ(e,t){var r=new OD(e.i,e.x,e.y),n=new OD(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,a.next=n,n.prev=a,n}function G9(e,t,r,n){var i=new OD(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function gC(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function OD(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}vI.deviation=function(e,t,r,n){var i=t&&t.length,a=i?t[0]*r:e.length,o=Math.abs(PD(e,0,a,r));if(i)for(var s=0,l=t.length;s<l;s++){var u=t[s]*r,c=s<l-1?t[s+1]*r:e.length;o-=Math.abs(PD(e,u,c,r))}var f=0;for(s=0;s<n.length;s+=3){var d=n[s]*r,v=n[s+1]*r,g=n[s+2]*r;f+=Math.abs((e[d]-e[g])*(e[v+1]-e[d+1])-(e[d]-e[v])*(e[g+1]-e[d+1]))}return o===0&&f===0?0:Math.abs((f-o)/o)};function PD(e,t,r,n){for(var i=0,a=t,o=r-n;a<r;a+=n)i+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return i}vI.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},n=0,i=0;i<e.length;i++){for(var a=0;a<e[i].length;a++)for(var o=0;o<t;o++)r.vertices.push(e[i][a][o]);i>0&&(n+=e[i-1].length,r.holes.push(n))}return r};var CBt=c4.exports;const lg=aa(CBt);function W9(e){return Math.max(Math.ceil(e/4)*4,4)}function sJ(e,t,r,n=!0){const i=r===3;if(n){e=e.slice();const o=[];for(let s=0;s<e.length;s+=r){o[0]=e[s],o[1]=e[s+1],i&&(o[2]=e[s+2]);const l=EA(o,!0,{enable:!1,decimal:1});e[s]=l[0],e[s+1]=l[1],i&&(e[s+2]=l[2])}}return lg(e,t,r)}const lJ="ATTRIBUTE_LOCATION_";class Ua{get attributeLocation(){return Ce({},Sm)}constructor(t){z(this,"triangulation",void 0),z(this,"uniformBuffers",[]),z(this,"textures",[]),z(this,"createTexture2D",void 0),z(this,"preStyleAttribute",{}),z(this,"encodeStyleAttribute",{}),z(this,"layer",void 0),z(this,"dataTexture",void 0),z(this,"DATA_TEXTURE_WIDTH",void 0),z(this,"dataTextureTest",void 0),z(this,"configService",void 0),z(this,"shaderModuleService",void 0),z(this,"rendererService",void 0),z(this,"iconService",void 0),z(this,"fontService",void 0),z(this,"styleAttributeService",void 0),z(this,"mapService",void 0),z(this,"cameraService",void 0),z(this,"layerService",void 0),z(this,"pickingService",void 0),z(this,"attributeUnifoms",void 0),z(this,"commonUnifoms",void 0),this.layer=t,this.configService=t.getContainer().globalConfigService,this.rendererService=t.getContainer().rendererService,this.pickingService=t.getContainer().pickingService,this.shaderModuleService=t.getContainer().shaderModuleService,this.styleAttributeService=t.getContainer().styleAttributeService,this.mapService=t.getContainer().mapService,this.iconService=t.getContainer().iconService,this.fontService=t.getContainer().fontService,this.cameraService=t.getContainer().cameraService,this.layerService=t.getContainer().layerService,this.registerStyleAttribute(),this.registerBuiltinAttributes(),this.startModelAnimate();const{createTexture2D:r}=this.rendererService;this.createTexture2D=r}getBlend(){const{blend:t="normal"}=this.layer.getLayerConfig();return nJ[pm[t]]}getStencil(t){const{mask:r=!1,maskInside:n=!0,enableMask:i,maskOperation:a=lI.AND}=this.layer.getLayerConfig();if(this.layer.type==="MaskLayer")return V9({isStencil:!0,stencilType:by.SINGLE});if(t.isStencil)return V9(Ce(Ce({},t),{},{maskOperation:a}));const o=r||i&&this.layer.masks.length!==0||this.layer.tileMask!==void 0;return sBt(o,n)}getDefaultStyle(){return{}}getUninforms(){const t=this.getCommonUniformsInfo(),r=this.getUniformsBufferInfo(this.getStyleAttribute());this.updateStyleUnifoms();const n=Ce(Ce({},r.uniformsOption),t.uniformsOption);return Object.keys(n).forEach(i=>{typeof n[i]=="boolean"&&(n[i]=n[i]?1:0)}),!this.rendererService.hasOwnProperty("device")&&this.textures&&this.textures.length===1&&(n.u_texture=this.textures[0]),n}getAnimateUniforms(){return{}}needUpdate(){return Pe(function*(){return!1})()}buildModels(){return Pe(function*(){throw new Error("Method not implemented.")})()}initModels(){return Pe(function*(){throw new Error("Method not implemented.")})()}clearModels(t=!0){}getAttribute(){throw new Error("Method not implemented.")}prerender(){}render(t){throw new Error("Method not implemented.")}registerBuiltinAttributes(){throw new Error("Method not implemented.")}animateOption2Array(t){return[t.enable?0:1,t.duration||4,t.interval||.2,t.trailLength||.1]}startModelAnimate(){const{animateOption:t}=this.layer.getLayerConfig();t.enable&&this.layer.setAnimateStartTime()}getInject(){return SBt(this.layer.enableShaderEncodeStyles,this.layer.encodeStyleAttribute)}getDefines(){const t=Object.keys(this.attributeLocation).reduce((r,n)=>{const i=lJ+n;return r[i]=this.attributeLocation[n],r},{});return Ce({},t)}getStyleAttribute(){const t={};return this.layer.enableShaderEncodeStyles.forEach(r=>{if(!this.layer.encodeStyleAttribute[r]){const n=this.layer.getLayerConfig()[r];let i=typeof n>"u"?lBt[r]:n;r==="stroke"&&(i=Qa(i)),t["u_"+r]=i}}),t}registerStyleAttribute(){Object.keys(this.layer.encodeStyleAttribute).forEach(t=>{const r=WFt(t);r&&this.styleAttributeService.registerStyleAttribute(r)})}registerPosition64LowAttribute(t=!0){this.styleAttributeService.registerStyleAttribute({name:"position64Low",type:Qr.Attribute,descriptor:{name:"a_Position64Low",shaderLocation:this.attributeLocation.POSITION_64LOW,buffer:{data:[],type:q.FLOAT},size:2,update:(r,n,i)=>t?[rl(i[0]),rl(i[1])]:[0,0]}})}updateEncodeAttribute(t,r){this.encodeStyleAttribute[t]=r}initUniformsBuffer(){const t=this.getUniformsBufferInfo(this.getStyleAttribute()),r=this.getCommonUniformsInfo();t.uniformsLength!==0&&(this.attributeUnifoms=this.rendererService.createBuffer({data:new Float32Array(W9(t.uniformsLength)).fill(0),isUBO:!0,label:"layerModelAttributeUnifoms"}),this.uniformBuffers.push(this.attributeUnifoms)),r.uniformsLength!==0&&(this.commonUnifoms=this.rendererService.createBuffer({data:new Float32Array(W9(r.uniformsLength)).fill(0),isUBO:!0,label:"layerModelCommonUnifoms"}),this.uniformBuffers.push(this.commonUnifoms))}getUniformsBufferInfo(t){let r=0;const n=[];return Object.values(t).forEach(i=>{Array.isArray(i)?(n.push(...i),r+=i.length):typeof i=="number"?(n.push(i),r+=1):typeof i=="boolean"&&(n.push(Number(i)),r+=1)}),{uniformsOption:t,uniformsLength:r,uniformsArray:n}}getCommonUniformsInfo(){return{uniformsLength:0,uniformsArray:[],uniformsOption:{}}}updateStyleUnifoms(){var t,r;const{uniformsArray:n}=this.getUniformsBufferInfo(this.getStyleAttribute()),{uniformsArray:i}=this.getCommonUniformsInfo();(t=this.attributeUnifoms)===null||t===void 0||t.subData({offset:0,data:new Uint8Array(new Float32Array(n).buffer)}),(r=this.commonUnifoms)===null||r===void 0||r.subData({offset:0,data:new Uint8Array(new Float32Array(i).buffer)})}}function SBt(e,t){const r=[];let n="";e.forEach(o=>{const s=o.replace(/([a-z])([A-Z])/g,"$1_$2").toUpperCase(),l=lJ+s;t[o]?n+=`#define USE_ATTRIBUTE_${s} 0.0 
`:r.push(`  ${Q2[o]} u_${o};`),n+=`
#ifdef USE_ATTRIBUTE_${s}
layout(location = ${l}) in ${Q2[o]} a_${o.charAt(0).toUpperCase()+o.slice(1)};
#endif 
`});const i=r.length?`
layout(std140) uniform AttributeUniforms {
  ${r.join(`
`)}
};
`:"";n+=i;let a="";return e.forEach(o=>{const s=o.replace(/([a-z])([A-Z])/g,"$1_$2").toUpperCase();a+=`
  #ifdef USE_ATTRIBUTE_${s}
    ${Q2[o]} ${o} = a_${o.charAt(0).toUpperCase()+o.slice(1)};
  #else
    ${Q2[o]} ${o} = u_${o};
  #endif
  `}),{"vs:#decl":n,"fs:#decl":i,"vs:#main-start":a}}let X9=function(e){return e.VERTICAL="vertical",e.HORIZONTAL="horizontal",e}({}),TBt=function(e){return e.NORMAL="normal",e.REPLACE="replace",e}({}),h4=function(e){return e[e.pixel=0]="pixel",e[e.meter=1]="meter",e}({});const uJ=100;function j9(e){return e/180*Math.acos(-1)}function cJ(e){const t=j9(e[0])+Math.PI/2,r=j9(e[1]),n=uJ+Math.random()*.4,i=n*Math.cos(r)*Math.cos(t),a=n*Math.cos(r)*Math.sin(t),o=n*Math.sin(r);return[a,o,i]}const Y9=kc();kc();const Ef=kc(),OE=kc(),eT=kc();function Z9(e,t,r,n,i){zl(e,r,n),Dx(e,e),t=fD(-e[1],e[0]);const a=fD(-r[1],r[0]);return[i/vM(t,a),t]}function PE(e,t){return nIt(e,-t[1],t[0])}function rT(e,t,r){return rg(e,t,r),Dx(e,e),e}function q9(e,t){return e[0]===t[0]&&e[1]===t[1]}class ABt{constructor(t={}){z(this,"complex",void 0),z(this,"join",void 0),z(this,"cap",void 0),z(this,"miterLimit",void 0),z(this,"thickness",void 0),z(this,"normal",void 0),z(this,"lastFlip",-1),z(this,"miter",fD(0,0)),z(this,"started",!1),z(this,"dash",!1),z(this,"totalDistance",0),z(this,"currentIndex",0),this.join=t.join||"miter",this.cap=t.cap||"butt",this.miterLimit=t.miterLimit||10,this.thickness=t.thickness||1,this.dash=t.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}simpleExtrude(t){const r=this.complex;if(t.length<=1)return r;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;const n=t.length;let i=r.startIndex;for(let a=1;a<n;a++){const o=t[a-1],s=t[a],l=a<t.length-1?t[a+1]:null,u=this.simpleSegment(r,i,o,s,l);i+=u}if(this.dash)for(let a=0;a<r.positions.length/6;a++)r.positions[a*6+5]=this.totalDistance;return r.startIndex=r.positions.length/6,r}extrude(t){const r=this.complex;if(t.length<=1)return r;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;const n=t.length;let i=r.startIndex;for(let a=1;a<n;a++){const o=t[a-1],s=t[a],l=a<t.length-1?t[a+1]:null,u=this.segment(r,i,o,s,l);i+=u}if(this.dash)for(let a=0;a<r.positions.length/6;a++)r.positions[a*6+5]=this.totalDistance;return r.startIndex=r.positions.length/6,r}simpleSegment(t,r,n,i,a){let o=0;const s=t.indices,l=t.positions,u=t.normals,c=If([i[0],i[1]]),f=If([n[0],n[1]]);rT(Ef,c,f);let d=0;if(this.dash&&(d=this.lineSegmentDistance(c,f),this.totalDistance+=d),this.normal||(this.normal=kc(),PE(this.normal,Ef)),this.started||(this.started=!0,this.extrusions(l,u,n,this.normal,this.thickness,this.totalDistance-d)),s.push(r+0,r+1,r+2),!a)PE(this.normal,Ef),this.extrusions(l,u,i,this.normal,this.thickness,this.totalDistance),s.push(...this.lastFlip===1?[r,r+2,r+3]:[r+2,r+1,r+3]),o+=2;else{const v=If([a[0],a[1]]);q9(c,v)&&zl(v,c,Dx(v,pM(v,c,f))),rT(OE,v,c);const[g,x]=Z9(eT,kc(),Ef,OE,this.thickness);let w=vM(eT,this.normal)<0?-1:1;this.extrusions(l,u,i,x,g,this.totalDistance),s.push(...this.lastFlip===1?[r,r+2,r+3]:[r+2,r+1,r+3]),w=-1,lO(this.normal,x),o+=2,this.lastFlip=w}return o}segment(t,r,n,i,a){let o=0;const s=t.indices,l=t.positions,u=t.normals,c=this.cap==="square",f=this.join==="bevel",d=If([i[0],i[1]]),v=If([n[0],n[1]]);rT(Ef,d,v);let g=0;if(this.dash&&(g=this.lineSegmentDistance(d,v),this.totalDistance+=g),this.normal||(this.normal=kc(),PE(this.normal,Ef)),!this.started)if(this.started=!0,c){const x=kc(),w=kc();zl(x,this.normal,Ef),zl(w,this.normal,Ef),u.push(w[0],w[1],0),u.push(x[0],x[1],0),l.push(n[0],n[1],n[2]|0,this.totalDistance-g,-this.thickness,n[2]|0),this.complex.indexes.push(this.currentIndex),l.push(n[0],n[1],n[2]|0,this.totalDistance-g,this.thickness,n[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(l,u,n,this.normal,this.thickness,this.totalDistance-g);if(s.push(r+0,r+1,r+2),a){const x=If([a[0],a[1]]);q9(d,x)&&zl(x,d,Dx(x,pM(x,d,v))),rT(OE,x,d);const[w,S]=Z9(eT,kc(),Ef,OE,this.thickness);let A=vM(eT,this.normal)<0?-1:1,M=f;!M&&this.join==="miter"&&w>this.miterLimit&&(M=!0),M?(u.push(this.normal[0],this.normal[1],0),u.push(S[0],S[1],0),l.push(i[0],i[1],i[2]|0,this.totalDistance,-this.thickness*A,i[2]|0),this.complex.indexes.push(this.currentIndex),l.push(i[0],i[1],i[2]|0,this.totalDistance,this.thickness*A,i[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,s.push(...this.lastFlip!==-A?[r,r+2,r+3]:[r+2,r+1,r+3]),s.push(r+2,r+3,r+4),PE(Y9,OE),lO(this.normal,Y9),u.push(this.normal[0],this.normal[1],0),l.push(i[0],i[1],i[2]|0,this.totalDistance,-this.thickness*A,i[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,o+=3):(this.extrusions(l,u,i,S,w,this.totalDistance),s.push(...this.lastFlip===1?[r,r+2,r+3]:[r+2,r+1,r+3]),A=-1,lO(this.normal,S),o+=2),this.lastFlip=A}else{if(PE(this.normal,Ef),c){const x=kc(),w=kc();rg(w,Ef,this.normal),zl(x,Ef,this.normal),u.push(w[0],w[1],0),u.push(x[0],x[1],0),l.push(i[0],i[1],i[2]|0,this.totalDistance,this.thickness,i[2]|0),this.complex.indexes.push(this.currentIndex),l.push(i[0],i[1],i[2]|0,this.totalDistance,this.thickness,i[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(l,u,i,this.normal,this.thickness,this.totalDistance);s.push(...this.lastFlip===1?[r,r+2,r+3]:[r+2,r+1,r+3]),o+=2}return o}extrusions(t,r,n,i,a,o){r.push(i[0],i[1],0),r.push(i[0],i[1],0),t.push(n[0],n[1],n[2]|0,o,-a,n[2]|0),this.complex.indexes.push(this.currentIndex),t.push(n[0],n[1],n[2]|0,o,a,n[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}lineSegmentDistance(t,r){const n=r[0]-t[0],i=r[1]-t[1];return Math.sqrt(n*n+i*i)}}let DE=function(e){return e.CYLINDER="cylinder",e.SQUARECOLUMN="squareColumn",e.TRIANGLECOLUMN="triangleColumn",e.HEXAGONCOLUMN="hexagonColumn",e.PENTAGONCOLUMN="pentagonColumn",e}({}),FE=function(e){return e.CIRCLE="circle",e.SQUARE="square",e.TRIANGLE="triangle",e.HEXAGON="hexagon",e.PENTAGON="pentagon",e}({});function CS(e,t=0){const r=Math.PI*2/e,n=[];for(let a=0;a<e;a++)n.push(r*a+t*Math.PI/12);return n.map(a=>{const o=Math.sin(a+Math.PI/4),s=Math.cos(a+Math.PI/4);return[o,s,0]})}function DD(){return CS(30)}function K9(){return CS(4)}function Q9(){return CS(3)}function J9(){return CS(6,1)}function t$(){return CS(5)}const cx={[FE.CIRCLE]:DD,[FE.HEXAGON]:J9,[FE.TRIANGLE]:Q9,[FE.SQUARE]:K9,[FE.PENTAGON]:t$,[DE.CYLINDER]:DD,[DE.HEXAGONCOLUMN]:J9,[DE.TRIANGLECOLUMN]:Q9,[DE.SQUARECOLUMN]:K9,[DE.PENTAGONCOLUMN]:t$};function MBt(e){const t=e[0][0],r=e[0][e[0].length-1];t[0]===r[0]&&t[1]===r[1]&&(e[0]=e[0].slice(0,e[0].length-1));const n=e[0].length,i=lg.flatten(e),{vertices:a,dimensions:o}=i,s=[],l=[];for(let c=0;c<a.length/o;c++)o===2?s.push(a[c*2],a[c*2+1],1):s.push(a[c*3],a[c*3+1],1);const u=lg(i.vertices,i.holes,i.dimensions);l.push(...u);for(let c=0;c<n;c++){const f=i.vertices.slice(c*o,(c+1)*o);let d=i.vertices.slice((c+1)*o,(c+2)*o);d.length===0&&(d=i.vertices.slice(0,o));const v=s.length/3;s.push(f[0],f[1],1,d[0],d[1],1,f[0],f[1],0,d[0],d[1],0),l.push(...[0,2,1,2,3,1].map(g=>g+v))}return{positions:s,index:l}}function RBt(e){const t=lg.flatten(e),r=lg(t.vertices,t.holes,t.dimensions);return{positions:t.vertices,index:r}}function hJ(e,t=!1){const r=e[0][0],n=e[0][e[0].length-1];r[0]===n[0]&&r[1]===n[1]&&(e[0]=e[0].slice(0,e[0].length-1));const i=e[0].length,a=lg.flatten(e),{vertices:o,dimensions:s,holes:l}=a,u=[],c=[],f=[];for(let v=0;v<o.length/s;v++)u.push(o[v*s],o[v*s+1],1,-1,-1),f.push(0,0,1);const d=sJ(o,l,s,t);c.push(...d);for(let v=0;v<i;v++){const g=a.vertices.slice(v*s,(v+1)*s);let x=a.vertices.slice((v+1)*s,(v+2)*s);x.length===0&&(x=a.vertices.slice(0,s));const w=u.length/5;u.push(g[0],g[1],1,0,0,x[0],x[1],1,.1,0,g[0],g[1],0,0,.8,x[0],x[1],0,.1,.8);const S=IBt([x[0],x[1],1],[g[0],g[1],0],[g[0],g[1],1],t);f.push(...S,...S,...S,...S),c.push(...[1,2,0,3,2,1].map(A=>A+w))}return{positions:u,index:c,normals:f}}function IBt(e,t,r,n=!1){const i=sw(),a=sw(),o=sw();n&&(e=EA(e),t=EA(t),r=EA(r));const s=ec(...e),l=ec(...t),u=ec(...r);mU(i,u,l),mU(a,s,l),tIt(o,i,a);const c=sw();return lw(c,o),c}const nT={};function Py(e){const t=Xy(e.coordinates);return{vertices:[...t,...t,...t,...t],indices:[0,1,2,2,3,0],size:t.length}}function e$(e){const t=Xy(e.coordinates),r=cJ(t);return{vertices:[...r,...r,...r,...r],indices:[0,1,2,2,3,0],size:r.length}}function f4(e){const{shape:t}=e,{positions:r,index:n,normals:i}=BBt(t,!1);return{vertices:r,indices:n,normals:i,size:5}}function LBt(e){const t=Xy(e.coordinates);return{vertices:[...t],indices:[0],size:t.length}}function FD(e){const{coordinates:t}=e,r=new ABt({dash:!0,join:"bevel"});let n=t;n[0]&&!Array.isArray(n[0][0])&&(n=[t]),n.forEach(a=>{r.extrude(a)});const i=r.complex;return{vertices:i.positions,indices:i.indices,normals:i.normals,indexes:i.indexes,size:6}}function OBt(e){const{coordinates:t}=e,r=[];if(!Array.isArray(t[0]))return{vertices:[],indices:[],normals:[],size:6,count:0};const{results:n,totalDistance:i}=PBt(t);return n.map(a=>{r.push(a[0],a[1],a[2],a[3],0,i)}),{vertices:r,indices:[],normals:[],size:6,count:n.length}}function r$(e,t){const r=t[0]-e[0],n=t[1]-e[1];return Math.sqrt(r*r+n*n)}function _O(e,t){return e.length<3&&e.push(0),t!==void 0&&e.push(t),e}function PBt(e){let t=e;Array.isArray(t)&&Array.isArray(t[0])&&Array.isArray(t[0][0])&&(t=e.flat());let r=0;if(t.length<2)return{results:t,totalDistance:0};{const n=[],i=_O(t[0],r);n.push(i);for(let o=1;o<t.length-1;o++){const s=r$(If(t[o-1]),If(t[o]));r+=s;const l=_O(t[o],r);n.push(l),n.push(l)}const a=r$(If(t[t.length-2]),If(t[t.length-1]));return r+=a,n.push(_O(t[t.length-1],r)),{results:n,totalDistance:r}}}function SS(e){const{coordinates:t}=e,r=lg.flatten(t),{vertices:n,dimensions:i,holes:a}=r;return{indices:sJ(n,a,i),vertices:n,size:i}}function DBt(e){const{indices:t,vertices:r,size:n}=SS(e);return{indices:t,vertices:FBt(r),size:n+4}}function FBt(e){const t=[],{center:r,radius:n}=ATt(e);for(let i=0;i<e.length;i+=2){const a=e[i],o=e[i+1];t.push(a,o,0,...r,n)}return t}function fJ(e){const t=e.coordinates,{positions:r,index:n,normals:i}=hJ(t,!0);return{vertices:r,indices:n,normals:i,size:5}}function dJ(e){const{shape:t}=e,{positions:r,index:n}=NBt(t);return{vertices:r,indices:n,size:3}}function mI(e){const t=e.coordinates;return{vertices:[...t[0],0,0,0,...t[1],0,1,0,...t[2],0,1,1,...t[3],0,0,1],indices:[0,1,2,0,2,3],size:5}}function d4(e,t){const{segmentNumber:r=30}=t,n=e.coordinates,i=[],a=[];for(let o=0;o<r;o++)i.push(o,1,o,n[0][0],n[0][1],n[1][0],n[1][1],o,-1,o,n[0][0],n[0][1],n[1][0],n[1][1]),o!==r-1&&a.push(...[0,1,2,1,3,2].map(s=>o*2+s));return{vertices:i,indices:a,size:7}}function n$(e){const t=e.coordinates;t.length===2&&t.push(0);const r=iT(-1,1),n=iT(1,1),i=iT(-1,-1),a=iT(1,-1);return{vertices:[...t,...r,...t,...i,...t,...a,...t,...n],indices:[0,1,2,3,0,2],size:5}}function BBt(e,t=!1){if(nT&&nT[e])return nT[e];const r=cx[e]?cx[e]():cx.cylinder(),n=hJ([r],t);return nT[e]=n,n}function NBt(e){const t=["cylinder","triangleColumn","hexagonColumn","squareColumn"],r=cx[e]?cx[e]():cx.circle();return t.indexOf(e)===-1?RBt([r]):MBt([r])}function iT(e,t){const r=(e+1)/2,n=(t+1)/2;return[r,n]}function pJ(e,t){return{type:e.type,field:"value",items:e.positions.map((r,n)=>({[t]:n>=e.colors.length?null:e.colors[n],value:r}))}}const kBt=`in vec4 v_color;

#pragma include "scene_uniforms"
#pragma include "picking"
out vec4 outputColor;
void main() {
  outputColor = v_color;
  outputColor = filterColor(outputColor);
}
`,zBt=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location =  ATTRIBUTE_LOCATION_POS) in vec3 a_Pos;

layout(std140) uniform commonUniforms {
    vec2 u_radius;
    float u_opacity;
    float u_coverage;
    float u_angle;
};

out vec4 v_color;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

void main() {
  v_color = a_Color;
  v_color.a *= u_opacity;

  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));
  vec2 offset = a_Position.xy * u_radius * rotationMatrix * u_coverage;

  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);
  vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));
  gl_Position = project_common_position_to_clipspace(project_pos);

  setPickingColor(a_PickingColor);
}
`;class UBt extends Ua{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,POS:9})}getUninforms(){const t=this.getCommonUniformsInfo(),r=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),Ce(Ce({},t.uniformsOption),r.uniformsOption)}getCommonUniformsInfo(){const{opacity:t,coverage:r,angle:n}=this.layer.getLayerConfig(),i={u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset],u_opacity:t||1,u_coverage:r||.9,u_angle:n||0};return this.getUniformsBufferInfo(i)}initModels(){var t=this;return Pe(function*(){return t.buildModels()})()}buildModels(){var t=this;return Pe(function*(){return t.initUniformsBuffer(),[yield t.layer.buildLayerModel({moduleName:"heatmapGrid",vertexShader:zBt,fragmentShader:kBt,defines:t.getDefines(),triangulation:dJ,primitive:q.TRIANGLES,depth:{enable:!1}})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:Qr.Attribute,descriptor:{shaderLocation:this.attributeLocation.POS,name:"a_Pos",buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:3,update:t=>{const r=t.coordinates;return[r[0],r[1],0]}}})}}const $Bt=`in vec4 v_color;

layout(std140) uniform commonUniforms {
  vec2 u_radius;
  float u_opacity;
  float u_coverage;
  float u_angle;
};

#pragma include "scene_uniforms"
#pragma include "picking"

out vec4 outputColor;
void main() {
  outputColor = v_color;
  outputColor = filterColor(outputColor);
}
`,HBt=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_POS) in vec3 a_Pos;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;

layout(std140) uniform commonUniforms {
  vec2 u_radius;
  float u_opacity;
  float u_coverage;
  float u_angle;
};

out vec4 v_color;

#pragma include "projection"
#pragma include "project"
#pragma include "light"
#pragma include "picking"

void main() {
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));
  vec2 offset = vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage);

  vec2 lnglat = unProjectFlat(a_Pos.xy + offset); // 实际的经纬度
  vec4 project_pos = project_position(vec4(lnglat, a_Position.z * a_Size, 1.0));

  float lightWeight = calc_lighting(project_pos);
  v_color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  gl_Position = project_common_position_to_clipspace(project_pos);

  setPickingColor(a_PickingColor);
}
`;class VBt extends Ua{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,POS:10,NORMAL:11})}getUninforms(){const t=this.getCommonUniformsInfo(),r=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),Ce(Ce({},t.uniformsOption),r.uniformsOption)}getCommonUniformsInfo(){const{opacity:t,coverage:r,angle:n}=this.layer.getLayerConfig(),i={u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset],u_opacity:t||1,u_coverage:r||.9,u_angle:n||0};return this.getUniformsBufferInfo(i)}initModels(){var t=this;return Pe(function*(){return t.buildModels()})()}buildModels(){var t=this;return Pe(function*(){return t.initUniformsBuffer(),[yield t.layer.buildLayerModel({moduleName:"heatmapGrid3d",vertexShader:HBt,fragmentShader:$Bt,defines:t.getDefines(),triangulation:f4,primitive:q.TRIANGLES,depth:{enable:!0}})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Qr.Attribute,descriptor:{shaderLocation:this.attributeLocation.SIZE,name:"a_Size",buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:1,update:t=>{const{size:r}=t;return Array.isArray(r)?[r[0]]:[r]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Qr.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:q.STATIC_DRAW,data:[],type:q.FLOAT},size:3,update:(t,r,n,i,a)=>a}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:Qr.Attribute,descriptor:{name:"a_Pos",shaderLocation:this.attributeLocation.POS,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:3,update:t=>{const r=t.coordinates;return[r[0],r[1],0]}}})}}function GBt(e,t){const r=[],n=[],i=[],a=e+1,o=t+1,s=e/2,l=t/2;for(let u=0;u<o;u++){const c=u-l;for(let f=0;f<a;f++){const d=f-s;n.push(d/s,-c/l,0),i.push(f/e),i.push(1-u/t)}}for(let u=0;u<t;u++)for(let c=0;c<e;c++){const f=c+a*u,d=c+a*(u+1),v=c+1+a*(u+1),g=c+1+a*u;r.push(f,d,g),r.push(d,v,g)}return{vertices:n,indices:r,uvs:i}}const WBt=`layout(std140) uniform commonUniforms {
  mat4 u_ViewProjectionMatrixUncentered;
  mat4 u_InverseViewProjectionMatrix;
  float u_opacity;
  float u_common_uniforms_padding1;
  float u_common_uniforms_padding2;
  float u_common_uniforms_padding3;
};

uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;

in vec2 v_texCoord;
in float v_intensity;
out vec4 outputColor;

void main(){
   
    float intensity = texture(SAMPLER_2D(u_texture), v_texCoord).r;
    vec4 color = texture(SAMPLER_2D(u_colorTexture),vec2(intensity, 0));
    outputColor = color;
    // gl_FragColor.a = color.a * smoothstep(0.1,0.2,intensity)* u_opacity;
   outputColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;
}
`,XBt=`layout(location = 0) in vec3 a_Position;
layout(location = 10) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
  mat4 u_ViewProjectionMatrixUncentered;
  mat4 u_InverseViewProjectionMatrix;
  float u_opacity;
  float u_common_uniforms_padding1;
  float u_common_uniforms_padding2;
  float u_common_uniforms_padding3;
};

uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;

out vec2 v_texCoord;
out float v_intensity;

vec2 toBezier(float t, vec2 P0, vec2 P1, vec2 P2, vec2 P3) {
  float t2 = t * t;
  float one_minus_t = 1.0 - t;
  float one_minus_t2 = one_minus_t * one_minus_t;
  return P0 * one_minus_t2 * one_minus_t +
  P1 * 3.0 * t * one_minus_t2 +
  P2 * 3.0 * t2 * one_minus_t +
  P3 * t2 * t;
}
vec2 toBezier(float t, vec4 p) {
  return toBezier(t, vec2(0.0, 0.0), vec2(p.x, p.y), vec2(p.z, p.w), vec2(1.0, 1.0));
}

#pragma include "projection"
#pragma include "project"

void main() {
  v_texCoord = a_Uv;

  vec2 pos = a_Uv * vec2(2.0) - vec2(1.0); // 将原本 0 -> 1 的 uv 转换为 -1 -> 1 的标准坐标空间（NDC）

  vec4 p1 = vec4(pos, 0.0, 1.0); // x/y 平面上的点（z == 0）可以认为是三维上的点被投影到平面后的点
  vec4 p2 = vec4(pos, 1.0, 1.0); // 平行于x/y平面、z==1 的平面上的点

  vec4 inverseP1 = u_InverseViewProjectionMatrix * p1; // 根据视图投影矩阵的逆矩阵平面上的反算出三维空间中的点（p1平面上的点）
  vec4 inverseP2 = u_InverseViewProjectionMatrix * p2;

  inverseP1 = inverseP1 / inverseP1.w; // 归一化操作（归一化后为世界坐标）
  inverseP2 = inverseP2 / inverseP2.w;

  float zPos = (0.0 - inverseP1.z) / (inverseP2.z - inverseP1.z); // ??
  vec4 position = inverseP1 + zPos * (inverseP2 - inverseP1);

  vec4 b = vec4(0.5, 0.0, 1.0, 0.5);
  float fh;

  v_intensity = texture(SAMPLER_2D(u_texture), v_texCoord).r;
  fh = toBezier(v_intensity, b).y;
  gl_Position = u_ViewProjectionMatrixUncentered * vec4(position.xy, fh * project_pixel(50.0), 1.0);

}
`,jBt=`uniform sampler2D u_texture;        // 热力强度图
uniform sampler2D u_colorTexture;   // 根据强度分布的色带

layout(std140) uniform commonUniforms {
  float u_opacity;
  float u_common_uniforms_padding1;
  float u_common_uniforms_padding2;
  float u_common_uniforms_padding3;
};
in vec2 v_texCoord;
out vec4 outputColor;

#pragma include "scene_uniforms"

float getBlurIndusty() {
    float vW = 2.0/ u_ViewportSize.x;
    float vH = 2.0/ u_ViewportSize.y;
    vec2 vUv = v_texCoord;
    float i11 = texture(SAMPLER_2D(u_texture), vec2( vUv.x - 1.0 * vW, vUv.y + 1.0 * vH) ).r;
    float i12 = texture(SAMPLER_2D(u_texture), vec2( vUv.x - 0.0 * vW, vUv.y + 1.0 * vH) ).r;
    float i13 = texture(SAMPLER_2D(u_texture), vec2( vUv.x + 1.0 * vW, vUv.y + 1.0 * vH) ).r;

    float i21 = texture(SAMPLER_2D(u_texture), vec2( vUv.x - 1.0 * vW, vUv.y) ).r;
    float i22 = texture(SAMPLER_2D(u_texture), vec2( vUv.x , vUv.y) ).r;
    float i23 = texture(SAMPLER_2D(u_texture), vec2( vUv.x + 1.0 * vW, vUv.y) ).r;

    float i31 = texture(SAMPLER_2D(u_texture), vec2( vUv.x - 1.0 * vW, vUv.y-1.0*vH) ).r;
    float i32 = texture(SAMPLER_2D(u_texture), vec2( vUv.x - 0.0 * vW, vUv.y-1.0*vH) ).r;
    float i33 = texture(SAMPLER_2D(u_texture), vec2( vUv.x + 1.0 * vW, vUv.y-1.0*vH) ).r;

    return(
        i11 + 
        i12 + 
        i13 + 
        i21 + 
        i21 + 
        i22 + 
        i23 + 
        i31 + 
        i32 + 
        i33
        )/9.0;
}


void main(){
    // float intensity = texture(u_texture, v_texCoord).r;
    float intensity = getBlurIndusty();
    vec4 color = texture(SAMPLER_2D(u_colorTexture), vec2(intensity, 0.0));
    outputColor = color;
    outputColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;
}
`,YBt=`layout(location = 0) in vec3 a_Position;
layout(location = 10) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
  float u_opacity;
  float u_common_uniforms_padding1;
  float u_common_uniforms_padding2;
  float u_common_uniforms_padding3;
};

#pragma include "scene_uniforms"

out vec2 v_texCoord;
void main() {
  v_texCoord = a_Uv;
  #ifdef VIEWPORT_ORIGIN_TL
  v_texCoord.y = 1.0 - v_texCoord.y;
  #endif

  gl_Position = vec4(a_Position.xy, 0, 1.0);
}
`,ZBt=`layout(std140) uniform commonUniforms {
  float u_radius;
  float u_intensity;
  float u_common_uniforms_padding1;
  float u_common_uniforms_padding2;
};

in vec2 v_extrude;
in float v_weight;
out vec4 outputColor;
#define GAUSS_COEF  0.3989422804014327

void main(){
    float d = -0.5 * 3.0 * 3.0 * dot(v_extrude, v_extrude);
    float val = v_weight * u_intensity * GAUSS_COEF * exp(d);
    outputColor = vec4(val, 1., 1., 1.);
}
`,qBt=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_DIR) in vec2 a_Dir;

layout(std140) uniform commonUniforms {
  float u_radius;
  float u_intensity;
  float u_common_uniforms_padding1;
  float u_common_uniforms_padding2;
};

out vec2 v_extrude;
out float v_weight;

#define GAUSS_COEF (0.3989422804014327)

#pragma include "projection"
#pragma include "picking"

void main() {
  vec3 picking_color_placeholder = u_PickingColor;

  v_weight = a_Size;
  float ZERO = 1.0 / 255.0 / 16.0;
  float extrude_x = a_Dir.x * 2.0 - 1.0;
  float extrude_y = a_Dir.y * 2.0 - 1.0;
  vec2 extrude_dir = normalize(vec2(extrude_x, extrude_y));
  float S = sqrt(-2.0 * log(ZERO / a_Size / u_intensity / GAUSS_COEF)) / 2.5;
  v_extrude = extrude_dir * S;

  vec2 offset = project_pixel(v_extrude * u_radius);
  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

}
`,{isEqual:KBt}=is;class i$ extends Ua{constructor(...t){super(...t),z(this,"texture",void 0),z(this,"colorTexture",void 0),z(this,"heatmapFramerBuffer",void 0),z(this,"heatmapTexture",void 0),z(this,"intensityModel",void 0),z(this,"colorModel",void 0),z(this,"shapeType",void 0),z(this,"preRampColors",void 0),z(this,"colorModelUniformBuffer",[]),z(this,"heat3DModelUniformBuffer",[])}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,UV:10,DIR:11})}prerender(){const{clear:t,useFramebuffer:r}=this.rendererService;r(this.heatmapFramerBuffer,()=>{t({color:[0,0,0,0],depth:1,stencil:0,framebuffer:this.heatmapFramerBuffer}),this.drawIntensityMode()})}render(t){const{rampColors:r}=this.layer.getLayerConfig();KBt(this.preRampColors,r)||this.updateColorTexture(),this.shapeType==="heatmap"?this.drawHeatMap(t):this.draw3DHeatMap(t)}getUninforms(){throw new Error("Method not implemented.")}initModels(){var t=this;return Pe(function*(){var r;const{createFramebuffer:n,getViewportSize:i,createTexture2D:a}=t.rendererService,o=t.styleAttributeService.getLayerStyleAttribute("shape"),s=(o==null||(r=o.scale)===null||r===void 0?void 0:r.field)||"heatmap";t.shapeType=s,t.intensityModel=yield t.buildHeatMapIntensity(),t.colorModel=s==="heatmap"?t.buildHeatmap():t.build3dHeatMap();const{width:l,height:u}=i();return t.heatmapTexture=a({width:Math.floor(l/4),height:Math.floor(u/4),wrapS:q.CLAMP_TO_EDGE,wrapT:q.CLAMP_TO_EDGE,min:q.LINEAR,mag:q.LINEAR,usage:jy.RENDER_TARGET}),t.heatmapFramerBuffer=n({color:t.heatmapTexture,depth:!0,width:Math.floor(l/4),height:Math.floor(u/4)}),t.updateColorTexture(),[t.intensityModel,t.colorModel]})()}buildModels(){var t=this;return Pe(function*(){return t.initModels()})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"dir",type:Qr.Attribute,descriptor:{name:"a_Dir",shaderLocation:this.attributeLocation.DIR,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:2,update:(t,r,n)=>[n[3],n[4]]}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Qr.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:1,update:t=>{const{size:r=1}=t;return[r]}}})}buildHeatMapIntensity(){var t=this;return Pe(function*(){return t.uniformBuffers=[t.rendererService.createBuffer({data:new Float32Array(4).fill(0),isUBO:!0})],t.layer.triangulation=n$,yield t.layer.buildLayerModel({moduleName:"heatmapIntensity",vertexShader:qBt,fragmentShader:ZBt,triangulation:n$,defines:t.getDefines(),depth:{enable:!1},cull:{enable:!0,face:q.FRONT}})})()}buildHeatmap(){this.shaderModuleService.registerModule("heatmapColor",{vs:YBt,fs:jBt}),this.colorModelUniformBuffer=[this.rendererService.createBuffer({data:new Float32Array(4).fill(0),isUBO:!0})];const{vs:t,fs:r,uniforms:n}=this.shaderModuleService.getModule("heatmapColor"),{createAttribute:i,createElements:a,createBuffer:o,createModel:s}=this.rendererService;return s({vs:t,fs:r,uniformBuffers:[...this.colorModelUniformBuffer,...this.rendererService.uniformBuffers],attributes:{a_Position:i({shaderLocation:this.attributeLocation.POSITION,buffer:o({data:[-1,1,0,1,1,0,-1,-1,0,1,-1,0],type:q.FLOAT}),size:3}),a_Uv:i({shaderLocation:this.attributeLocation.UV,buffer:o({data:[0,1,1,1,0,0,1,0],type:q.FLOAT}),size:2})},uniforms:Ce({},n),depth:{enable:!1},elements:a({data:[0,2,1,2,3,1],type:q.UNSIGNED_INT,count:6})})}build3dHeatMap(){const{getViewportSize:t}=this.rendererService,{width:r,height:n}=t(),i=GBt(r/4,n/4);this.shaderModuleService.registerModule("heatmap3dColor",{vs:XBt,fs:WBt}),this.heat3DModelUniformBuffer=[this.rendererService.createBuffer({data:new Float32Array(16*2+4).fill(0),isUBO:!0})];const{vs:a,fs:o,uniforms:s}=this.shaderModuleService.getModule("heatmap3dColor"),{createAttribute:l,createElements:u,createBuffer:c,createModel:f}=this.rendererService;return f({vs:a,fs:o,attributes:{a_Position:l({shaderLocation:this.attributeLocation.POSITION,buffer:c({data:i.vertices,type:q.FLOAT}),size:3}),a_Uv:l({shaderLocation:this.attributeLocation.UV,buffer:c({data:i.uvs,type:q.FLOAT}),size:2})},primitive:q.TRIANGLES,uniformBuffers:[...this.heat3DModelUniformBuffer,...this.rendererService.uniformBuffers],uniforms:Ce({},s),depth:{enable:!0},blend:{enable:!0,func:{srcRGB:q.SRC_ALPHA,srcAlpha:1,dstRGB:q.ONE_MINUS_SRC_ALPHA,dstAlpha:1}},elements:u({data:i.indices,type:q.UNSIGNED_INT,count:i.indices.length})})}drawIntensityMode(){var t;const{intensity:r=10,radius:n=5}=this.layer.getLayerConfig(),i={u_radius:n,u_intensity:r};this.uniformBuffers[0].subData({offset:0,data:[n,r]}),this.layerService.beforeRenderData(this.layer),this.layer.hooks.beforeRender.call(),(t=this.intensityModel)===null||t===void 0||t.draw({uniforms:i,blend:{enable:!0,func:{srcRGB:q.ONE,srcAlpha:1,dstRGB:q.ONE,dstAlpha:1}},stencil:{enable:!1,mask:255,func:{cmp:514,ref:1,mask:255}}}),this.layer.hooks.afterRender.call()}drawHeatMap(t){var r;const{opacity:n=1}=this.layer.getLayerConfig(),i={u_opacity:n,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer},a=[this.heatmapTexture,this.colorTexture];this.colorModelUniformBuffer[0].subData({offset:0,data:[n]}),(r=this.colorModel)===null||r===void 0||r.draw({uniforms:i,textures:a,blend:this.getBlend(),stencil:this.getStencil(t)})}draw3DHeatMap(t){var r;const{opacity:n=1}=this.layer.getLayerConfig(),i=xb();aC(i,this.cameraService.getViewProjectionMatrixUncentered());const a={u_opacity:n,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer,u_ViewProjectionMatrixUncentered:this.cameraService.getViewProjectionMatrixUncentered(),u_InverseViewProjectionMatrix:[...i]};this.heat3DModelUniformBuffer[0].subData({offset:0,data:[...a.u_ViewProjectionMatrixUncentered,...a.u_InverseViewProjectionMatrix,n]});const o=[this.heatmapTexture,this.colorTexture];(r=this.colorModel)===null||r===void 0||r.draw({uniforms:a,textures:o,blend:{enable:!0,func:{srcRGB:q.SRC_ALPHA,srcAlpha:1,dstRGB:q.ONE_MINUS_SRC_ALPHA,dstAlpha:1}},stencil:this.getStencil(t)})}updateColorTexture(){const{createTexture2D:t}=this.rendererService;this.texture&&this.texture.destroy();const{rampColors:r}=this.layer.getLayerConfig(),n=qZ(r);this.colorTexture=t({data:n.data,usage:jy.SAMPLED,width:n.width,height:n.height,wrapS:q.CLAMP_TO_EDGE,wrapT:q.CLAMP_TO_EDGE,min:q.NEAREST,mag:q.NEAREST,flipY:!1,unorm:!0}),this.preRampColors=r}}const QBt=`in vec4 v_color;

#pragma include "picking"
out vec4 outputColor;
void main() {
  outputColor = v_color;
  outputColor = filterColor(outputColor);
}
`,JBt=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_POS) in vec3 a_Pos;

layout(std140) uniform commonUniforms {
  vec2 u_radius;
  float u_opacity;
  float u_coverage;
  float u_angle;
};

out vec4 v_color;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

void main() {
  v_color = a_Color;
  v_color.a *= u_opacity;

  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));
  vec2 offset = vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage);
  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);

  vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));

  setPickingColor(a_PickingColor);
}
`;class t5t extends Ua{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,POS:9})}getUninforms(){const t=this.getCommonUniformsInfo(),r=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),Ce(Ce({},t.uniformsOption),r.uniformsOption)}getCommonUniformsInfo(){const{opacity:t,coverage:r,angle:n}=this.layer.getLayerConfig(),i={u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset],u_opacity:t||1,u_coverage:r||.9,u_angle:n||0};return this.getUniformsBufferInfo(i)}initModels(){var t=this;return Pe(function*(){return t.buildModels()})()}buildModels(){var t=this;return Pe(function*(){return t.initUniformsBuffer(),[yield t.layer.buildLayerModel({moduleName:"heatmapHexagon",vertexShader:JBt,fragmentShader:QBt,defines:t.getDefines(),triangulation:dJ,depth:{enable:!1},primitive:q.TRIANGLES})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:Qr.Attribute,descriptor:{name:"a_Pos",shaderLocation:this.attributeLocation.POS,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:3,update:t=>{const r=t.coordinates;return[r[0],r[1],0]}}})}}const e5t={heatmap:i$,heatmap3d:i$,grid:UBt,grid3d:VBt,hexagon:t5t},r5t=e5t;class T3e extends b_{constructor(...t){super(...t),z(this,"type","HeatMapLayer")}buildModels(){var t=this;return Pe(function*(){const r=t.getModelType();t.layerModel=new r5t[r](t),yield t.initLayerModels()})()}prerender(){this.getModelType()==="heatmap"&&this.layerModel&&this.layerModel.prerender()}renderModels(t={}){return this.getModelType()==="heatmap"?(this.layerModel&&this.layerModel.render(t),this):this.encodeDataLength<=0&&!this.forceRender?this:(this.hooks.beforeRender.call(),this.models.forEach(n=>n.draw({uniforms:this.layerModel.getUninforms(),blend:this.layerModel.getBlend(),stencil:this.layerModel.getStencil(t)})),this.hooks.afterRender.call(),this)}updateModelData(t){t.attributes&&t.elements?this.models[0].updateAttributesAndElements(t.attributes,t.elements):console.warn("data error")}getModelType(){var t;const r=this.styleAttributeService.getLayerStyleAttribute("shape"),{shape3d:n}=this.getLayerConfig(),a=this.getSource().data.type,o=(r==null||(t=r.scale)===null||t===void 0?void 0:t.field)||"heatmap";return o==="heatmap"||o==="heatmap3d"?"heatmap":a==="hexagon"?(n==null?void 0:n.indexOf(o))===-1?"hexagon":"grid3d":a==="grid"?(n==null?void 0:n.indexOf(o))===-1?"grid":"grid3d":"heatmap"}getLegend(t){if(this.getModelType()==="heatmap"){if(t!=="color")return{type:void 0,field:void 0,items:[]};const r=this.getLayerConfig().rampColors;return pJ(r,t)}else return super.getLegend(t)}}const n5t=`uniform sampler2D u_texture;
layout(std140) uniform commonUniforms {
    float u_opacity:1.0;
    float u_brightness:1.0;
    float u_contrast:1.0;
    float u_saturation:1.0;
    float u_gamma:1.0;
};

in vec2 v_texCoord;
out vec4 outputColor;
vec3 setContrast(vec3 rgb, float contrast) {
  vec3 color = mix(vec3(0.5), rgb, contrast);
  color = clamp(color, 0.0, 1.0);
  return color;
}
vec3 setSaturation(vec3 rgb, float adjustment) {
  const vec3 grayVector = vec3(0.2125, 0.7154, 0.0721);
  vec3 intensity = vec3(dot(rgb, grayVector));
  vec3 color = mix(intensity, rgb, adjustment);
  color = clamp(color, 0.0, 1.0);
  return color;
}
void main() {
  vec4 color = texture(SAMPLER_2D(u_texture),vec2(v_texCoord.x,v_texCoord.y));
  //brightness
  color.rgb = mix(vec3(0.0, 0.0, 0.0), color.rgb, u_brightness);
  //contrast
  color.rgb = setContrast(color.rgb, u_contrast);
  // saturation
  color.rgb = setSaturation(color.rgb, u_saturation);
  // gamma
  color.rgb = pow(color.rgb, vec3(u_gamma));
  outputColor = color;
  outputColor.a *= u_opacity;
  if(outputColor.a < 0.01)
    discard;
}
`,i5t=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
    float u_opacity:1.0;
    float u_brightness:1.0;
    float u_contrast:1.0;
    float u_saturation:1.0;
    float u_gamma:1.0;
};

out vec2 v_texCoord;
#pragma include "projection"

void main() {
  v_texCoord = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));
}
`;let a5t=class extends Ua{constructor(...t){super(...t),z(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getCommonUniformsInfo(){const{opacity:t,brightness:r,contrast:n,saturation:i,gamma:a}=this.layer.getLayerConfig(),o={u_opacity:wE(t,1),u_brightness:wE(r,1),u_contrast:wE(n,1),u_saturation:wE(i,1),u_gamma:wE(a,1)};return this.textures=[this.texture],this.getUniformsBufferInfo(o)}initModels(){var t=this;return Pe(function*(){return yield t.loadTexture(),t.buildModels()})()}clearModels(){var t;(t=this.texture)===null||t===void 0||t.destroy()}loadTexture(){var t=this;return Pe(function*(){const{createTexture2D:r}=t.rendererService,i=yield t.layer.getSource().data.images;t.texture=r({data:i[0],width:i[0].width,height:i[0].height,mag:q.LINEAR,min:q.LINEAR})})()}buildModels(){var t=this;return Pe(function*(){return t.initUniformsBuffer(),[yield t.layer.buildLayerModel({moduleName:"rasterImage",vertexShader:i5t,fragmentShader:n5t,defines:t.getDefines(),triangulation:mI,primitive:q.TRIANGLES,blend:{enable:!0},depth:{enable:!1},pickingEnabled:!1})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Qr.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:2,update:(t,r,n)=>[n[3],n[4]]}})}};const o5t={image:a5t},s5t=o5t;class l5t extends b_{constructor(...t){super(...t),z(this,"type","ImageLayer")}buildModels(){var t=this;return Pe(function*(){const r=t.getModelType();t.layerModel=new s5t[r](t),yield t.initLayerModels()})()}getDefaultConfig(){const t=this.getModelType();return{image:{}}[t]}getModelType(){return"image"}}const u5t=`
#define Animate 0.0
#define LineTexture 1.0
uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_lineDir: 1.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_blur : 0.9;
  float u_line_type: 0.0;
  float u_time;
  float u_linearColor: 0.0;
};

in vec4 v_color;
in vec2 v_iconMapUV;
in vec4 v_lineData;
//dash
in vec4 v_dash_array;
in float v_distance_ratio;

out vec4 outputColor;
#pragma include "picking"

void main() {
  if(u_dash_array!=vec4(0.0)){
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(!(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z))) {
      discard;
    };
  }
  float animateSpeed = 0.0; // 运动速度
  outputColor = v_color;
  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_lineData.b, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      outputColor.a *= alpha;
  }

  // 当存在贴图时在底色上贴上贴图
  if(u_line_texture == LineTexture) { // while load texture
    float arcRadio = smoothstep( 0.0, 1.0, (v_lineData.r / segmentNumber));
    // float arcRadio = smoothstep( 0.0, 1.0, d_distance_ratio);

    float count = v_lineData.g; // 贴图在弧线上重复的数量

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);
    float v = v_lineData.a; // 横向 v
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;

    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = filterColor(pattern);
    }
    
  } else {
     outputColor = filterColor(outputColor);
  }
}`,c5t=`#define Animate (0.0)
#define LineTexture (1.0)

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;
layout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_lineDir: 1.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_blur : 0.9;
  float u_line_type: 0.0;
  float u_time;
  float u_linearColor: 0.0;
};

out vec4 v_color;
out vec2 v_iconMapUV;
out vec4 v_lineData;
//dash
out vec4 v_dash_array;
out float v_distance_ratio;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1.0 - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2 * cos(theta2) + source.x, r2 * sin(theta2) + source.y);
  if (u_lineDir == 1.0) {
    // 正向
    return mid;
  } else {
    // 逆向
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
  // dash: index / (segmentNumber - 1.);
  // normal: smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
  //  return index / (segmentNumber - 1.);
}
vec2 interpolate(vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x, t), bezier3(y, t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return dir_screenspace.xy * sign(offset_direction);
}

void main() {
  //vs中计算渐变色
  if (u_linearColor == 1.0) {
    float d_segmentIndex = a_Position.x + 1.0; // 当前顶点在弧线中所处的分段位置
    v_color = mix(u_sourceColor, u_targetColor, d_segmentIndex / segmentNumber);
  } else {
    v_color = a_Color;
  }
  v_color.a = v_color.a * opacity;

  vec2 source_world = a_Instance.rg; // 起始点
  vec2 target_world = a_Instance.ba; // 终点

  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  // 计算 dashArray 和 distanceRatio 输出到片元
  float total_Distance = pixelDistance(source_world, target_world) / 2.0 * PI;
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;
  v_distance_ratio = segmentIndex / segmentNumber;

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  float d_distance_ratio;

  if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
      if(u_lineDir != 1.0) {
        d_distance_ratio = 1.0 - d_distance_ratio;
      }
  }

  v_lineData.b = d_distance_ratio;

  vec4 source = project_position(vec4(source_world, 0, 1.), a_Instance64Low.xy);
  vec4 target = project_position(vec4(target_world, 0, 1.), a_Instance64Low.zw);

  vec2 currPos = interpolate(source.xy, target.xy, segmentRatio, thetaOffset);
  vec2 nextPos = interpolate(source.xy, target.xy, nextSegmentRatio, thetaOffset);

  vec2 offset = project_pixel(
    getExtrusionOffset((nextPos.xy - currPos.xy) * indexDir, a_Position.y)
  );

  float d_segmentIndex = a_Position.x + 1.0; // 当前顶点在弧线中所处的分段位置
  v_lineData.r = d_segmentIndex;

  if(LineTexture == u_line_texture) { // 开启贴图模式
    float arcDistrance = length(source - target); // 起始点和终点的距离
    arcDistrance = project_pixel(arcDistrance);

    v_iconMapUV = a_iconMapUV;

    float pixelLen = project_pixel_texture(u_icon_step); // 贴图沿弧线方向的长度 - 随地图缩放改变
    float texCount = floor(arcDistrance / pixelLen); // 贴图在弧线上重复的数量
    v_lineData.g = texCount;

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // 线横向偏移的距离
    float linePixelSize = project_pixel(a_Size); // 定点位置偏移
    v_lineData.a = lineOffsetWidth / linePixelSize; // 线图层贴图部分的 v 坐标值
  }

  gl_Position = project_common_position_to_clipspace(vec4(currPos.xy + offset, 0, 1.0));

  setPickingColor(a_PickingColor);
}
`,h5t={solid:0,dash:1};class f5t extends Ua{constructor(...t){super(...t),z(this,"texture",void 0),z(this,"updateTexture",()=>{const{createTexture2D:r}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=r({data:this.iconService.getCanvas(),mag:q.NEAREST,min:q.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,UV:12,THETA_OFFSET:13})}getCommonUniformsInfo(){const{sourceColor:t,targetColor:r,textureBlend:n="normal",lineType:i="solid",dashArray:a=[10,5],forward:o=!0,lineTexture:s=!1,iconStep:l=100,segmentNumber:u=30}=this.layer.getLayerConfig(),{animateOption:c}=this.layer.getLayerConfig();let f=a;i!=="dash"&&(f=[0,0]),f.length===2&&f.push(0,0);let d=0,v=[0,0,0,0],g=[0,0,0,0];if(t&&r&&(v=Qa(t),g=Qa(r),d=1),this.rendererService.getDirty()){var x;(x=this.texture)===null||x===void 0||x.bind()}const w={u_animate:this.animateOption2Array(c),u_dash_array:f,u_sourceColor:v,u_targetColor:g,u_textSize:[1024,this.iconService.canvasHeight||128],segmentNumber:u,u_lineDir:o?1:-1,u_icon_step:l,u_line_texture:s?1:0,u_textureBlend:n==="normal"?0:1,u_blur:.9,u_line_type:h5t[i||"solid"],u_time:this.layer.getLayerAnimateTime()||0,u_linearColor:d};return this.getUniformsBufferInfo(w)}initModels(){var t=this;return Pe(function*(){return t.updateTexture(),t.iconService.on("imageUpdate",t.updateTexture),t.buildModels()})()}clearModels(){var t;(t=this.texture)===null||t===void 0||t.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}getShaders(){return{frag:u5t,vert:c5t,type:""}}buildModels(){var t=this;return Pe(function*(){t.initUniformsBuffer();const{segmentNumber:r=30}=t.layer.getLayerConfig(),{frag:n,vert:i,type:a}=t.getShaders();return[yield t.layer.buildLayerModel({moduleName:"lineArc2d"+a,vertexShader:i,fragmentShader:n,defines:t.getDefines(),inject:t.getInject(),triangulation:d4,depth:{enable:!1},styleOption:{segmentNumber:r}})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Qr.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:1,update:t=>{const{size:r=1}=t;return Array.isArray(r)?[r[0]]:[r]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Qr.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:q.STATIC_DRAW,data:[],type:q.FLOAT},size:4,update:(t,r,n)=>[n[3],n[4],n[5],n[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:Qr.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:q.STATIC_DRAW,data:[],type:q.FLOAT},size:4,update:(t,r,n)=>[rl(n[3]),rl(n[4]),rl(n[5]),rl(n[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Qr.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:2,update:t=>{const r=this.iconService.getIconMap(),{texture:n}=t,{x:i,y:a}=r[n]||{x:0,y:0};return[i,a]}}}),this.styleAttributeService.registerStyleAttribute({name:"thetaOffset",type:Qr.Attribute,descriptor:{name:"a_ThetaOffset",shaderLocation:this.attributeLocation.THETA_OFFSET,buffer:{usage:q.STATIC_DRAW,data:[],type:q.FLOAT},size:1,update:t=>{const{thetaOffset:r=1}=t;return[r]}}})}}const d5t=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform sampler2D u_texture;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_globel;
  float u_globel_radius;
  float u_global_height: 10;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0.0;
};

in vec4 v_color;
in vec4 v_dash_array;
in float v_segmentIndex;
in vec2 v_iconMapUV;
in vec4 v_line_data;

out vec4 outputColor;

#pragma include "picking"

void main() {
  float animateSpeed = 0.0; // 运动速度
  float d_distance_ratio = v_line_data.g; // 当前点位距离占线总长的比例
  outputColor = v_color;

  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    outputColor.a *=flag;
  }

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      outputColor.a *= alpha;

      // u_animate
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture
    // float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / segmentNumber));
    float arcRadio = v_segmentIndex / (segmentNumber - 1.0);
    float count = v_line_data.b; // // 贴图在弧线上重复的数量

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);

    float v = v_line_data.a;  // 线图层贴图部分的 v 坐标值
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
          discard;
        } else {
          outputColor = filterColor(pattern);
        }
    }

  } else {
    outputColor = filterColor(outputColor);
  }
}
`,p5t=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;
layout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;


layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_globel;
  float u_globel_radius;
  float u_global_height: 10;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0.0;
};
out vec4 v_color;
out vec4 v_dash_array;
out float v_segmentIndex;
out vec2 v_iconMapUV;
out vec4 v_line_data;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return dir_screenspace.xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 是为了对齐坐标
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // 手动增加一些偏移，减轻面的冲突
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  //vs中计算渐变色
  if(u_linearColor==1.0){
    float d_segmentIndex = a_Position.x + 1.0; // 当前顶点在弧线中所处的分段位置
    v_color = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
  }
  else{
    v_color = a_Color;
  }
  v_color.a = v_color.a * opacity;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0), a_Instance64Low.xy).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0), a_Instance64Low.zw).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    float total_Distance = pixelDistance(source, target) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  v_line_data.g = d_distance_ratio; // 当前点位距离占线总长的比例

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // 开启贴图模式

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    v_line_data.b = floor(arcDistrance/pixelLen); // 贴图在弧线上重复的数量

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // 线横向偏移的距离
    float linePixelSize = project_pixel(a_Size);  // 定点位置偏移，按地图等级缩放后的距离
    v_line_data.a = lineOffsetWidth/linePixelSize;  // 线图层贴图部分的 v 坐标值

    v_iconMapUV = a_iconMapUV;
  }


  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z * thetaOffset, 1.0));

  // 地球模式
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // 线的偏移
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // 计算起始点和终止点的距离
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // 计算飞线各个节点相应的高度
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // 地球点位
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;

    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }


  setPickingColor(a_PickingColor);
}
`,v5t={solid:0,dash:1};class a$ extends Ua{constructor(...t){super(...t),z(this,"texture",void 0),z(this,"updateTexture",()=>{const{createTexture2D:r}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=r({data:this.iconService.getCanvas(),mag:q.NEAREST,min:q.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,UV:12,THETA_OFFSET:13})}getCommonUniformsInfo(){const{sourceColor:t,targetColor:r,textureBlend:n="normal",lineType:i="solid",dashArray:a=[10,5],lineTexture:o=!1,iconStep:s=100,segmentNumber:l=30,globalArcHeight:u=10}=this.layer.getLayerConfig(),{animateOption:c}=this.layer.getLayerConfig();a.length===2&&a.push(0,0);let f=0,d=[0,0,0,0],v=[0,0,0,0];if(t&&r&&(d=Qa(t),v=Qa(r),f=1),this.rendererService.getDirty()){var g;(g=this.texture)===null||g===void 0||g.bind()}const x={u_animate:this.animateOption2Array(c),u_dash_array:a,u_sourceColor:d,u_targetColor:v,u_textSize:[1024,this.iconService.canvasHeight||128],u_globel:this.mapService.version==="GLOBEL"?1:0,u_globel_radius:uJ,u_global_height:u,segmentNumber:l,u_line_type:v5t[i]||0,u_icon_step:s,u_line_texture:o?1:0,u_textureBlend:n==="normal"?0:1,u_time:this.layer.getLayerAnimateTime()||0,u_linearColor:f};return this.getUniformsBufferInfo(x)}initModels(){var t=this;return Pe(function*(){return t.initUniformsBuffer(),t.updateTexture(),t.iconService.on("imageUpdate",t.updateTexture),t.buildModels()})()}clearModels(){var t;(t=this.texture)===null||t===void 0||t.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}getShaders(){return{frag:d5t,vert:p5t,type:""}}buildModels(){var t=this;return Pe(function*(){const{segmentNumber:r=30}=t.layer.getLayerConfig(),{frag:n,vert:i,type:a}=t.getShaders();return[yield t.layer.buildLayerModel({moduleName:"lineArc3d"+a,vertexShader:i,fragmentShader:n,defines:t.getDefines(),inject:t.getInject(),triangulation:d4,styleOption:{segmentNumber:r}})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Qr.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:1,update:t=>{const{size:r=1}=t;return Array.isArray(r)?[r[0]]:[r]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Qr.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:q.STATIC_DRAW,data:[],type:q.FLOAT},size:4,update:(t,r,n)=>[n[3],n[4],n[5],n[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:Qr.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:q.STATIC_DRAW,data:[],type:q.FLOAT},size:4,update:(t,r,n)=>[rl(n[3]),rl(n[4]),rl(n[5]),rl(n[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Qr.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:2,update:t=>{const r=this.iconService.getIconMap(),{texture:n}=t,{x:i,y:a}=r[n]||{x:0,y:0};return[i,a]}}}),this.styleAttributeService.registerStyleAttribute({name:"thetaOffset",type:Qr.Attribute,descriptor:{name:"a_ThetaOffset",shaderLocation:this.attributeLocation.THETA_OFFSET,buffer:{usage:q.STATIC_DRAW,data:[],type:q.FLOAT},size:1,update:t=>{const{thetaOffset:r=1}=t;return[r]}}})}}const o$={circle:2,triangle:2,diamond:4,rect:2,classic:3,halfTriangle:2,none:0},zc=1/2;function g5t(e,t){const{width:r=2,height:n=1}=t;return{vertices:[0,zc*e,1*e*r,-(n+zc)*e,1*e*r,(n-zc)*e,0,zc*e,1*e*r,-(n+zc)*e,1*e*r,(n-zc)*e],indices:[3,4,5],outLineIndices:[0,1,2],normals:[1*e,-2*e,1,-2*e,1.5*e,1,1*e,1.5*e,1,0,0,0,0,0,0,0,0,0],dimensions:2}}function m5t(e,t){const{width:r=2,height:n=3}=t;return{vertices:[0,0,1*e*r,1*n,1*e*r,-1*n,0,0,1*e*r,1*n,1*e*r,-1*n],outLineIndices:[0,1,2],indices:[3,4,5],normals:[0,-1.5*e,1,2,1*e,1,-2,1*e,1,0,0,0,0,0,0,0,0,0],dimensions:2}}function y5t(e,t){const{width:r=2,height:n=2}=t;return{vertices:[0,n/2,e*r*1,n/2,e*r*1,-n/2,0,-n/2,0,n/2,e*r*1,n/2,e*r*1,-n/2,0,-n/2],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-e,1,1,0,1,0,-e,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]}}function _5t(e,t){const{width:r=2,height:n=3}=t;return{vertices:[0,0,1*r*e,.5*n,2*r*e,0,1*r*e,-.5*n,0,0,1*r*e,.5*n,2*r*e,0,1*r*e,-.5*n],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-e,1,1,0,1,0,-e,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]}}function x5t(e,t){const{width:r=2,height:n=3}=t;return{vertices:[0,0,2*e*r,1*n,1.5*e*r,0,2*e*r,-1*n,0,0,2*e*r,1*n,1.5*e*r,0,2*e*r,-1*n],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-e,1,1,0,1,0,-e,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]}}function b5t(e,t){const{width:r=2,height:n=2}=t,i=DD(),a=lg.flatten([i]),o=lg(a.vertices,a.holes,a.dimensions),s=i.map(l=>[l[0]*r*e,l[1]*n]).flat();return{vertices:[...s,...s],dimensions:2,indices:o.map(l=>l+i.length),outLineIndices:o,normals:[...i.map(l=>[l[1]*n,l[0]*r*e,1]).flat(),...new Array(i.length*3).fill(0)]}}function E5t(e,t=0,r){const n=typeof r.source=="object"?r.source.type:r.source,i=typeof r.target=="object"?r.target.type:r.target,{width:a=n?o$[n]:0}=typeof r.source=="object"?r.source:{},{width:o=i?o$[i]:0}=typeof r.target=="object"?r.target:{};return{vertices:[0,zc,1*a,...e,1,zc,-1*o,...e,1,-zc,-1*o,...e,0,-zc,1*a,...e,0,zc,1*a,...e,1,zc,-1*o,...e,1,-zc,-1*o,...e,0,-zc,1*a,...e],outLineIndices:[0,1,2,0,2,3].map(s=>s+t),indices:[4,5,6,4,6,7].map(s=>s+t),normals:[1,-1,1,1,1,1,-1,0,1,-1,0,1,0,0,0,0,0,0,0,0,0,0,0,0],dimensions:2}}function s$(e,t){const r=typeof e=="object"?e.type:e,n=t==="source"?1:-1,i=typeof e=="object"?e:{};switch(r){case"circle":return b5t(n,i);case"triangle":return m5t(n,i);case"diamond":return _5t(n,i);case"rect":return y5t(n,i);case"classic":return x5t(n,i);case"halfTriangle":return g5t(n,i);default:return{vertices:[],indices:[],normals:[],dimensions:2,outLineIndices:[],outLineNormals:[]}}}function w5t(e){const t=e.coordinates.flat(),r=1,n=1;return{vertices:[1,0,0,...t,1,2,-3,...t,1,1,-3,...t,0,1,0,...t,0,0,0,...t,1,0,0,...t,1,2,-3,...t,1,1,-3,...t,0,1,0,...t,0,0,0,...t],normals:[-r,2*n,1,2*n,-n,1,n,-n,1,n,-n,1,-r,-n,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],indices:[0,1,2,0,2,3,0,3,4,5,6,7,5,7,8,5,8,9],size:7}}function C5t(e,t){return t?S5t(e,t):w5t(e)}function S5t(e,t){const r=e.coordinates.flat(),{target:n="classic",source:i="circle"}=t,a=l$(s$(i,"source"),r,0,0),o=E5t(r,a.vertices.length/7,t),s=l$(s$(n,"target"),r,1,a.vertices.length/7+o.vertices.length/7);return{vertices:[...a.vertices,...o.vertices,...s.vertices],indices:[...a.outLineIndices,...o.outLineIndices,...s.outLineIndices,...a.indices,...o.indices,...s.indices],normals:[...a.normals,...o.normals,...s.normals],size:7}}function l$(e,t,r=1,n=0){const i=[],{vertices:a,indices:o,dimensions:s,outLineIndices:l}=e;for(let u=0;u<a.length;u+=s)i.push(r,a[u+1],a[u],...t);return Ce(Ce({},e),{},{vertices:i,indices:o.map(u=>u+n),outLineIndices:l.map(u=>u+n)})}const T5t=`// #extension GL_OES_standard_derivatives : enable

in vec4 v_color;
out vec4 outputColor;


// line texture

#pragma include "picking"

void main() {
  outputColor = v_color;
  outputColor = filterColor(outputColor);
}
`,A5t=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec2 a_Size;
layout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;
layout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;

layout(std140) uniform commonUniorm {
  float u_gap_width: 1.0;
  float u_stroke_width: 1.0;
  float u_stroke_opacity: 1.0;
};

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

out vec4 v_color;

vec2 project_pixel_offset(vec2 offsets) {
  vec2 data = project_pixel(offsets);

  return vec2(data.x, -data.y);
}

vec2 line_dir(vec2 target, vec2 source) {
  return normalize(ProjectFlat(target) - ProjectFlat(source));
}


void main() {
  // 透明度计算
  vec2 source_world = a_Instance.rg; // 起点
  vec2 target_world = a_Instance.ba; // 终点
  vec2 flowlineDir = line_dir(target_world, source_world);
  vec2 perpendicularDir = vec2(-flowlineDir.y, flowlineDir.x);

  vec2 position = mix(source_world, target_world, a_Position.x);
  vec2 position64Low = mix(a_Instance64Low.rg, a_Instance64Low.ba, a_Position.x);

  float lengthCommon = length(
    project_position(vec4(target_world, 0, 1)) - project_position(vec4(source_world, 0, 1))
  );
  vec2 offsetDistances = a_Size.x * project_pixel_offset(vec2(a_Position.y, a_Position.z)); // Mapbox || 高德
  vec2 limitedOffsetDistances = clamp(
    offsetDistances,
    project_pixel(-lengthCommon * 0.2),
    project_pixel(lengthCommon * 0.2)
  );

  float startOffsetCommon = project_pixel(offsets[0]);
  float endOffsetCommon = project_pixel(offsets[1]);
  float endpointOffset = mix(
    clamp(startOffsetCommon, 0.0, lengthCommon * 0.2),
    -clamp(endOffsetCommon, 0.0, lengthCommon * 0.2),
    a_Position.x
  );

  vec2 normalsCommon = u_stroke_width * project_pixel_offset(vec2(a_Normal.x, a_Normal.y));

  float gapCommon = -1. * project_pixel(u_gap_width);
  vec3 offsetCommon = vec3(
    flowlineDir * (limitedOffsetDistances[1] + normalsCommon.y + endpointOffset * 1.05) -
      perpendicularDir * (limitedOffsetDistances[0] + gapCommon + normalsCommon.x),
    0.0
  );

  vec4 project_pos = project_position(vec4(position.xy, 0, 1.0), position64Low);

  vec4 fillColor = vec4(a_Color.rgb, a_Color.a * opacity);
  v_color = mix(fillColor, vec4(u_stroke.xyz, u_stroke.w * fillColor.w * u_stroke_opacity), a_Normal.z);

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy +  offsetCommon.xy, 0., 1.0));

  setPickingColor(a_PickingColor);
}
`;class M5t extends Ua{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,NORMAL:12})}getCommonUniformsInfo(){const{gapWidth:t=2,strokeWidth:r=1,strokeOpacity:n=1}=this.layer.getLayerConfig(),i={u_gap_width:t,u_stroke_width:r,u_stroke_opacity:n};return this.getUniformsBufferInfo(i)}initModels(){var t=this;return Pe(function*(){return t.initUniformsBuffer(),t.buildModels()})()}buildModels(){var t=this;return Pe(function*(){return[yield t.layer.buildLayerModel({moduleName:"flow_line",vertexShader:A5t,fragmentShader:T5t,defines:t.getDefines(),inject:t.getInject(),triangulation:C5t,styleOption:t.layer.getLayerConfig().symbol,primitive:q.TRIANGLES,depth:{enable:!1},pick:!1})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Qr.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:2,update:t=>{const{size:r=1}=t;return Array.isArray(r)?[r[0],r[1]]:[r,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Qr.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:q.STATIC_DRAW,data:[],type:q.FLOAT},size:4,update:(t,r,n)=>[n[3],n[4],n[5],n[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:Qr.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:q.STATIC_DRAW,data:[],type:q.FLOAT},size:4,update:(t,r,n)=>[rl(n[3]),rl(n[4]),rl(n[5]),rl(n[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Qr.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:q.STATIC_DRAW,data:[],type:q.FLOAT},size:3,update:(t,r,n,i,a)=>a}})}}const R5t=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0;
};

in vec4 v_dash_array;
in vec4 v_color;
in vec2 v_iconMapUV;
in vec4 v_line_data;
in float v_distance_ratio;

out vec4 outputColor;
#pragma include "picking"
#pragma include "project"
#pragma include "projection"

void main() {

  float animateSpeed = 0.0;
  float d_segmentIndex = v_line_data.g;

  // 设置弧线的底色
  if(u_linearColor == 1.0) { // 使用渐变颜色
    outputColor = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
    outputColor.a *= v_color.a;
  } else { // 使用 color 方法传入的颜色
    outputColor = v_color;
  }

  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  if(u_line_type == LineTypeDash) {
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      // 实线部分
    } else {
      // 虚线部分
      discard;
    };
  }

  // 设置弧线的动画模式
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      outputColor.a *= alpha;
  }

  // 设置弧线的贴图
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) {
    float arcRadio = smoothstep( 0.0, 1.0, (d_segmentIndex / (segmentNumber - 1.0)));
    // float arcRadio = d_segmentIndex / (segmentNumber - 1.0);
    float count = v_line_data.b; // 贴图在弧线上重复的数量
    float u = fract(arcRadio * count - animateSpeed * count);
    // float u = fract(arcRadio * count - animateSpeed);
    if(u_animate.x == Animate) {
      u = outputColor.a/v_color.a;
    }

    float v = v_line_data.a; // 线图层贴图部分的 v 坐标值

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    // 设置贴图和底色的叠加模式
    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = filterColor(pattern);
    }
  } else {
    outputColor = filterColor(outputColor);
  }

  // gl_FragColor = filterColor(gl_FragColor);
}
`,I5t=`#define LineTypeSolid (0.0)
#define LineTypeDash (1.0)
#define Animate (0.0)
#define LineTexture (1.0)

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;
layout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0;
};

out vec4 v_dash_array;
out vec4 v_color;
out vec2 v_iconMapUV;
out vec4 v_line_data;
out float v_distance_ratio;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps(float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return index / (segmentNumber - 1.0);
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(mix(source, target, segmentRatio), sqrt(max(0.0, vertex_height)));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return dir_screenspace.xy * sign(offset_direction);
}
float getAngularDist(vec2 source, vec2 target) {
  vec2 delta = source - target;
  vec2 sin_half_delta = sin(delta / 2.0);
  float a =
    sin_half_delta.y * sin_half_delta.y +
    cos(source.y) * cos(target.y) * sin_half_delta.x * sin_half_delta.x;
  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));
}

vec2 midPoint(vec2 source, vec2 target) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = 0.314;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2 * cos(theta2) + source.x, r2 * sin(theta2) + source.y);
  return mid;
}
float bezier3(vec3 arr, float t) {
  float ut = 1.0 - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}

vec2 interpolate(vec2 source, vec2 target, float angularDist, float t) {
  if (abs(angularDist - PI) < 0.001) {
    return (1.0 - t) * source + t * target;
  }
  float a = sin((1.0 - t) * angularDist) / sin(angularDist);
  float b = sin(t * angularDist) / sin(angularDist);
  vec2 sin_source = sin(source);
  vec2 cos_source = cos(source);
  vec2 sin_target = sin(target);
  vec2 cos_target = cos(target);
  float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;
  float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;
  float z = a * sin_source.y + b * sin_target.y;
  return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));

}

void main() {
  v_color = a_Color;
  v_color.a = v_color.a * opacity;
  vec2 source = radians(a_Instance.rg);
  vec2 target = radians(a_Instance.ba);
  float angularDist = getAngularDist(source, target);
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  if (u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    float total_Distance = pixelDistance(source, target) / 2.0 * PI;
    total_Distance = total_Distance * 16.0; // total_Distance*16.0 调整默认的效果
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;
  }

  if (u_animate.x == Animate) {
    v_distance_ratio = segmentIndex / segmentNumber;
  }

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  v_distance_ratio = segmentIndex / segmentNumber;

  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0), a_Instance64Low.xy);
  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0), a_Instance64Low.zw);

  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));

  v_line_data.g = a_Position.x; // 该顶点在弧线上的分段排序
  if (LineTexture == u_line_texture) {
    float d_arcDistrance = length(source - target);
    d_arcDistrance = project_pixel(d_arcDistrance);

    float d_pixelLen = project_pixel(u_icon_step) / 8.0;
    v_line_data.b = floor(d_arcDistrance / d_pixelLen); // 贴图在弧线上重复的数量

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // 线横向偏移的距离
    float linePixelSize = project_pixel(a_Size); // 定点位置偏移，按地图等级缩放后的距离
    v_line_data.a = lineOffsetWidth / linePixelSize; // 线图层贴图部分的 v 坐标值

    v_iconMapUV = a_iconMapUV;
  }

  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  setPickingColor(a_PickingColor);
}

`,L5t={solid:0,dash:1};class O5t extends Ua{constructor(...t){super(...t),z(this,"texture",void 0),z(this,"updateTexture",()=>{const{createTexture2D:r}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=r({data:this.iconService.getCanvas(),mag:q.NEAREST,min:q.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,UV:12})}getCommonUniformsInfo(){const{sourceColor:t,targetColor:r,textureBlend:n="normal",lineType:i="solid",dashArray:a=[10,5],lineTexture:o=!1,iconStep:s=100,segmentNumber:l=30}=this.layer.getLayerConfig(),{animateOption:u}=this.layer.getLayerConfig();if(a.length===2&&a.push(0,0),this.rendererService.getDirty()){var c;(c=this.texture)===null||c===void 0||c.bind()}let f=0,d=[0,0,0,0],v=[0,0,0,0];t&&r&&(d=Qa(t),v=Qa(r),f=1);let g=this.layer.getLayerAnimateTime();isNaN(g)&&(g=0);const x={u_animate:this.animateOption2Array(u),u_dash_array:a,u_sourceColor:d,u_targetColor:v,u_textSize:[1024,this.iconService.canvasHeight||128],segmentNumber:l,u_line_type:L5t[i]||0,u_icon_step:s,u_line_texture:o?1:0,u_textureBlend:n==="normal"?0:1,u_time:g,u_linearColor:f};return this.getUniformsBufferInfo(x)}initModels(){var t=this;return Pe(function*(){return t.initUniformsBuffer(),t.updateTexture(),t.iconService.on("imageUpdate",t.updateTexture),t.buildModels()})()}clearModels(){var t;(t=this.texture)===null||t===void 0||t.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}buildModels(){var t=this;return Pe(function*(){const{segmentNumber:r=30}=t.layer.getLayerConfig();return[yield t.layer.buildLayerModel({moduleName:"lineGreatCircle",vertexShader:I5t,fragmentShader:R5t,triangulation:d4,styleOption:{segmentNumber:r},defines:t.getDefines(),inject:t.getInject(),depth:{enable:!1}})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Qr.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:1,update:t=>{const{size:r=1}=t;return Array.isArray(r)?[r[0]]:[r]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Qr.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:q.STATIC_DRAW,data:[],type:q.FLOAT},size:4,update:(t,r,n)=>[n[3],n[4],n[5],n[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:Qr.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:q.STATIC_DRAW,data:[],type:q.FLOAT},size:4,update:(t,r,n)=>[rl(n[3]),rl(n[4]),rl(n[5]),rl(n[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Qr.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:2,update:t=>{const r=this.iconService.getIconMap(),{texture:n}=t,{x:i,y:a}=r[n]||{x:0,y:0};return[i,a]}}})}}const P5t=`// #extension GL_OES_standard_derivatives : enable
#define Animate 0.0
#define LineTexture 1.0

uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_blur;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed: 0.0;
  float u_vertexScale: 1.0;
  float u_raisingHeight: 0.0;
  float u_strokeWidth: 0.0;
  float u_textureBlend;
  float u_line_texture;
  float u_linearDir: 1.0;
  float u_linearColor: 0;
  float u_time;
};

in vec4 v_color;
in vec4 v_stroke;
// dash
in vec4 v_dash_array;
in float v_d_distance_ratio;
in vec2 v_iconMapUV;
in vec4 v_texture_data;

out vec4 outputColor;
#pragma include "picking"

// [animate, duration, interval, trailLength],
void main() {
  if(u_dash_array!=vec4(0.0)){
    float dashLength = mod(v_d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(!(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z))) {
      // 虚线部分
      discard;
    };
  }
  float animateSpeed = 0.0; // 运动速度
  float d_distance_ratio = v_texture_data.r; // 当前点位距离占线总长的比例
  if(u_linearDir < 1.0) {
    d_distance_ratio = v_texture_data.a;
  }
  if(u_linearColor == 1.0) { // 使用渐变颜色
    outputColor = mix(u_sourceColor, u_targetColor, d_distance_ratio);
    outputColor.a *= v_color.a;
  } else { // 使用 color 方法传入的颜色
     outputColor = v_color;
  }
  // anti-alias
  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      outputColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = v_texture_data.g;      // 当前顶点的距离
    float d_texPixelLen = v_texture_data.b;  // 贴图的像素长度，根据地图层级缩放
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = v_texture_data.a;  // 线图层贴图部分的 v 坐标值

    // v = max(smoothstep(0.95, 1.0, v), v);
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
     vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor += pattern;
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = pattern;
    }
  } 

  float v = v_texture_data.a;
  float strokeWidth = min(0.5, u_strokeWidth);
  // 绘制 border
  if(strokeWidth > 0.01) {
    float borderOuterWidth = strokeWidth / 2.0;


    if(v >= 1.0 - strokeWidth || v <= strokeWidth) {
      if(v > strokeWidth) { // 外侧
        float linear = smoothstep(0.0, 1.0, (v - (1.0 - strokeWidth))/strokeWidth);
        //  float linear = step(0.0, (v - (1.0 - borderWidth))/borderWidth);
        outputColor.rgb = mix(outputColor.rgb, v_stroke.rgb, linear);
      } else if(v <= strokeWidth) {
        float linear = smoothstep(0.0, 1.0, v/strokeWidth);
        outputColor.rgb = mix(v_stroke.rgb, outputColor.rgb, linear);
      }
    }

    if(v < borderOuterWidth) {
      outputColor.a = mix(0.0, outputColor.a, v/borderOuterWidth);
    } else if(v > 1.0 - borderOuterWidth) {
      outputColor.a = mix(outputColor.a, 0.0, (v - (1.0 - borderOuterWidth))/borderOuterWidth);
    }
  }

  // blur
  float blurV = v_texture_data.a;
  if(blurV < 0.5) {
    outputColor.a *= mix(u_blur.r, u_blur.g, blurV/0.5);
  } else {
    outputColor.a *= mix(u_blur.g, u_blur.b, (blurV - 0.5)/0.5);
  }
  
  outputColor = filterColor(outputColor);
}
`,D5t=`#define Animate (0.0)

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec2 a_Size;
layout(location = ATTRIBUTE_LOCATION_DISTANCE_INDEX) in vec3 a_DistanceAndIndexAndMiter;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec4 a_Normal_Total_Distance;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_blur;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed: 0.0;
  float u_vertexScale: 1.0;
  float u_raisingHeight: 0.0;
  float u_strokeWidth: 0.0;
  float u_textureBlend;
  float u_line_texture;
  float u_linearDir: 1.0;
  float u_linearColor: 0;
  float u_time;
};

out vec4 v_color;
out vec4 v_stroke;
//dash
out vec4 v_dash_array;
out float v_d_distance_ratio;
// texV 线图层 - 贴图部分的 v 坐标（线的宽度方向）
out vec2 v_iconMapUV;
out vec4 v_texture_data;

#pragma include "projection"
#pragma include "picking"

void main() {
  vec2 a_DistanceAndIndex = a_DistanceAndIndexAndMiter.xy;
  float a_Miter = a_DistanceAndIndexAndMiter.z;
  vec3 a_Normal = a_Normal_Total_Distance.xyz;
  float a_Total_Distance = a_Normal_Total_Distance.w;
  //dash输出
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;
  v_d_distance_ratio = a_DistanceAndIndex.x / a_Total_Distance;

  // cal style mapping - 数据纹理映射部分的计算
  float d_texPixelLen; // 贴图的像素长度，根据地图层级缩放
  v_iconMapUV = a_iconMapUV;
  d_texPixelLen = project_float_pixel(u_icon_step);

  v_color = a_Color;
  v_color.a *= opacity;
  v_stroke = stroke;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * a_Normal;

  vec2 offset = project_pixel(size.xy);

  float lineDistance = a_DistanceAndIndex.x;
  float currentLinePointRatio = lineDistance / a_Total_Distance;

  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // 线横向偏移的距离（向两侧偏移的和）
  float linePixelSize = project_pixel(a_Size.x) * 2.0; // 定点位置偏移，按地图等级缩放后的距离 单侧 * 2
  float texV = lineOffsetWidth / linePixelSize; // 线图层贴图部分的 v 坐标值

  v_texture_data = vec4(currentLinePointRatio, lineDistance, d_texPixelLen, texV);
  // 设置数据集的参数

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0), a_Position64Low);

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // 线顶点的高度 - 兼容不存在第三个数值的情况 vertex height
  float lineHeight = a_Size.y; // size 第二个参数代表的高度 [linewidth, lineheight]

  // 兼容 mapbox 在线高度上的效果表现基本一致
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // mapbox
    // 保持高度相对不变
    float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
    h *= mapboxZoomScale;
    h += u_raisingHeight * mapboxZoomScale;
    if (u_heightfixed > 0.0) {
      lineHeight *= mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(
    vec4(project_pos.xy + offset, lineHeight + h, 1.0)
  );

  setPickingColor(a_PickingColor);
}
`;class vJ extends Ua{constructor(...t){super(...t),z(this,"textureEventFlag",!1),z(this,"texture",this.createTexture2D({data:new Uint8Array([0,0,0,0]),width:1,height:1})),z(this,"updateTexture",()=>{const{createTexture2D:r}=this.rendererService;if(this.textures.length===0&&(this.textures=[this.texture]),this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=r({data:this.iconService.getCanvas(),mag:q.NEAREST,min:q.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128})})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,DISTANCE_INDEX:10,NORMAL:11,UV:12})}getCommonUniformsInfo(){const{sourceColor:t,targetColor:r,textureBlend:n="normal",lineType:i="solid",dashArray:a=[10,5,0,0],lineTexture:o=!1,iconStep:s=100,vertexHeightScale:l=20,strokeWidth:u=0,raisingHeight:c=0,heightfixed:f=!1,linearDir:d=X9.VERTICAL,blur:v=[1,1,1,0]}=this.layer.getLayerConfig();let g=a;if(i!=="dash"&&(g=[0,0,0,0]),g.length===2&&g.push(0,0),this.rendererService.getDirty()&&this.texture){var x;(x=this.texture)===null||x===void 0||x.bind()}const{animateOption:w}=this.layer.getLayerConfig();let S=0,A=[0,0,0,0],M=[0,0,0,0];t&&r&&(A=Qa(t),M=Qa(r),S=1);const R={u_animate:this.animateOption2Array(w),u_dash_array:g,u_blur:v,u_sourceColor:A,u_targetColor:M,u_textSize:[1024,this.iconService.canvasHeight||128],u_icon_step:s,u_heightfixed:Number(f),u_vertexScale:l,u_raisingHeight:Number(c),u_strokeWidth:u,u_textureBlend:n===TBt.NORMAL?0:1,u_line_texture:o?1:0,u_linearDir:d===X9.VERTICAL?1:0,u_linearColor:S,u_time:this.layer.getLayerAnimateTime()||0};return this.getUniformsBufferInfo(R)}initModels(){var t=this;return Pe(function*(){return t.initUniformsBuffer(),t.textureEventFlag||(t.textureEventFlag=!0,t.updateTexture(),t.iconService.on("imageUpdate",t.updateTexture)),t.buildModels()})()}clearModels(){var t;(t=this.texture)===null||t===void 0||t.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}buildModels(){var t=this;return Pe(function*(){const{depth:r=!1}=t.layer.getLayerConfig(),{frag:n,vert:i,type:a}=t.getShaders();return t.layer.triangulation=FD,[yield t.layer.buildLayerModel({moduleName:"line"+a,vertexShader:i,fragmentShader:n,triangulation:FD,defines:t.getDefines(),inject:t.getInject(),depth:{enable:r}})]})()}getShaders(){return{frag:P5t,vert:D5t,type:""}}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:Qr.Attribute,descriptor:{name:"a_DistanceAndIndexAndMiter",shaderLocation:this.attributeLocation.DISTANCE_INDEX,buffer:{usage:q.STATIC_DRAW,data:[],type:q.FLOAT},size:3,update:(t,r,n,i,a,o)=>o===void 0?[n[3],10,n[4]]:[n[3],o,n[4]]}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Qr.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:2,update:t=>{const{size:r=1}=t;return Array.isArray(r)?[r[0],r[1]]:[r,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal_total_distance",type:Qr.Attribute,descriptor:{name:"a_Normal_Total_Distance",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:q.STATIC_DRAW,data:[],type:q.FLOAT},size:4,update:(t,r,n,i,a)=>[...a,n[5]]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Qr.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:2,update:t=>{const r=this.iconService.getIconMap(),{texture:n}=t,{x:i,y:a}=r[n]||{x:0,y:0};return[i,a]}}})}}const F5t=`
layout(std140) uniform commonUniorm {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec4 u_dash_array;
  float u_vertexScale: 1.0;
  float u_linearColor: 0;
};
in float v_distanceScale;
in vec4 v_color;
//dash
in vec4 v_dash_array;

out vec4 outputColor;
void main() {
  if(u_dash_array!=vec4(0.0)){
    float dashLength = mod(v_distanceScale, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(!(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z))) {
      // 虚线部分
      discard;
    };
  }
  if(u_linearColor==1.0){
    outputColor = mix(u_sourceColor, u_targetColor, v_distanceScale);
    outputColor.a *= v_color.a; // 全局透明度
  }
  else{
    outputColor = v_color;
  }
}
`,B5t=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec4 a_SizeDistanceAndTotalDistance;

layout(std140) uniform commonUniorm {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec4 u_dash_array;
  float u_vertexScale: 1.0;
  float u_linearColor: 0;
};

#pragma include "projection"
#pragma include "picking"

out vec4 v_color;
out float v_distanceScale;
out vec4 v_dash_array;

void main() {
  //dash输出
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_SizeDistanceAndTotalDistance.a;

  v_color = a_Color;
  v_distanceScale = a_SizeDistanceAndTotalDistance.b / a_SizeDistanceAndTotalDistance.a;
  v_color.a = v_color.a * opacity;
  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0), a_Position64Low);

  float h = float(a_Position.z) * u_vertexScale; // 线顶点的高度 - 兼容不存在第三个数值的情况

  float lineHeight = a_SizeDistanceAndTotalDistance.y;
  // 兼容 mapbox 在线高度上的效果表现基本一致
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // 保持高度相对不变
    h *= 2.0 / pow(2.0, 20.0 - u_Zoom);
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, lineHeight + h, 1.0));
  gl_PointSize = 10.0;

}
`;class N5t extends Ua{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9})}getCommonUniformsInfo(){const{sourceColor:t,targetColor:r,lineType:n="solid",dashArray:i=[10,5,0,0],vertexHeightScale:a=20}=this.layer.getLayerConfig();let o=i;n!=="dash"&&(o=[0,0,0,0]),o.length===2&&o.push(0,0);let s=0,l=[0,0,0,0],u=[0,0,0,0];t&&r&&(l=Qa(t),u=Qa(r),s=1);const c={u_sourceColor:l,u_targetColor:u,u_dash_array:o,u_vertexScale:a,u_linearColor:s};return this.getUniformsBufferInfo(c)}initModels(){var t=this;return Pe(function*(){return t.buildModels()})()}getShaders(){return{frag:F5t,vert:B5t,type:"lineSimpleNormal"}}buildModels(){var t=this;return Pe(function*(){t.initUniformsBuffer();const{frag:r,vert:n,type:i}=t.getShaders();return[yield t.layer.buildLayerModel({moduleName:i,vertexShader:n,fragmentShader:r,triangulation:OBt,defines:t.getDefines(),inject:t.getInject(),primitive:q.LINES,depth:{enable:!1},pick:!1})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"sizeDistanceAndTotalDistance",type:Qr.Attribute,descriptor:{name:"a_SizeDistanceAndTotalDistance",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:q.STATIC_DRAW,data:[],type:q.FLOAT},size:4,update:(t,r,n)=>{const{size:i=1}=t,a=Array.isArray(i)?[i[0],i[1]]:[i,0];return[a[0],a[1],n[3],n[5]]}}})}}const k5t=`#define Animate 0.0
#define LineTexture 1.0

// line texture

uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed;
  float u_linearColor: 0;
  float u_line_texture;
  float u_textureBlend;
  float u_iconStepCount;
  float u_time;
};


in vec2 v_iconMapUV;
in vec4 v_color;
in float v_blur;
in vec4 v_dataset;

out vec4 outputColor;

#pragma include "picking"

void main() {
  float animateSpeed = 0.0; // 运动速度
  float d_distance_ratio = v_dataset.r; // 当前点位距离占线总长的比例
  float v = v_dataset.a;

  if(u_linearColor == 1.0) { // 使用渐变颜色
    outputColor = mix(u_sourceColor, u_targetColor, v);
  } else { // 使用 color 方法传入的颜色
     outputColor = v_color;
  }

  outputColor.a *= v_color.a; // 全局透明度
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      outputColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = v_dataset.g;      // 当前顶点的距离
    float d_texPixelLen = v_dataset.b;  // 贴图的像素长度，根据地图层级缩放
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = v_dataset.a;  // 线图层贴图部分的 v 坐标值

    // 计算纹理间隔 start
    float flag = 0.0;
    if(u > 1.0/u_iconStepCount) {
      flag = 1.0;
    }
    u = fract(u*u_iconStepCount);
    // 计算纹理间隔 end

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    // Tip: 判断纹理间隔
    if(flag > 0.0) {
      pattern = vec4(0.0);
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = filterColor(pattern);
    }
  }


  // blur - AA
  if(v < v_blur) {
    outputColor.a = mix(0.0, outputColor.a, v/v_blur);
  } else if(v > 1.0 - v_blur) {
    outputColor.a = mix(outputColor.a, 0.0, (v - (1.0 - v_blur))/v_blur);
  }

  outputColor = filterColor(outputColor);
}
`,z5t=`#define Animate 0.0
layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec2 a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;
layout(location = ATTRIBUTE_LOCATION_DISTANCE_MITER_TOTAL) in vec3 a_Distance_Total_Miter;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed;
  float u_linearColor: 0;
  float u_line_texture;
  float u_textureBlend;
  float u_iconStepCount;
  float u_time;
};

// texV 线图层 - 贴图部分的 v 坐标（线的宽度方向）
out vec2 v_iconMapUV;
out vec4 v_color;
out float v_blur;
out vec4 v_dataset;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  float a_Distance = a_Distance_Total_Miter.x;
  float a_Miter = a_Distance_Total_Miter.y;
  float a_Total_Distance = a_Distance_Total_Miter.z;

  float d_distance_ratio; // 当前点位距离占线总长的比例
  float d_texPixelLen; // 贴图的像素长度，根据地图层级缩放

  v_iconMapUV = a_iconMapUV;
  if (u_heightfixed < 1.0) {
    // 高度随 zoom 调整
    d_texPixelLen = project_pixel(u_icon_step);
  } else {
    d_texPixelLen = u_icon_step;
  }

  if (u_animate.x == Animate || u_linearColor == 1.0) {
    d_distance_ratio = a_Distance / a_Total_Distance;
  }

  float miter = (a_Miter + 1.0) / 2.0;
  // 设置数据集的参数
  v_dataset[0] = d_distance_ratio; // 当前点位距离占线总长的比例
  v_dataset[1] = a_Distance; // 当前顶点的距离
  v_dataset[2] = d_texPixelLen; // 贴图的像素长度，根据地图层级缩放
  v_dataset[3] = miter; // 线图层贴图部分的 v 坐标值 0 - 1

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0), a_Position64Low);

  float originSize = a_Size.x; // 固定高度
  if (u_heightfixed < 1.0) {
    originSize = project_float_meter(a_Size.x); // 高度随 zoom 调整
  }

  float wallHeight = originSize * miter;
  float lightWeight = calc_lighting(vec4(project_pos.xy, wallHeight, 1.0));

  v_blur = min(project_float_pixel(2.0) / originSize, 0.05);
  v_color = vec4(a_Color.rgb * lightWeight, a_Color.w * opacity);

  // 兼容 mapbox 在线高度上的效果表现基本一致
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // mapbox
    // 保持高度相对不变
    float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
    if (u_heightfixed > 0.0) {
      wallHeight *= mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, wallHeight, 1.0));

  setPickingColor(a_PickingColor);
}
`;class U5t extends Ua{constructor(...t){super(...t),z(this,"texture",void 0),z(this,"updateTexture",()=>{const{createTexture2D:r}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=r({data:this.iconService.getCanvas(),mag:q.NEAREST,min:q.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,NORMAL:12,UV:13,DISTANCE_MITER_TOTAL:15})}getCommonUniformsInfo(){const{sourceColor:t,targetColor:r,textureBlend:n="normal",heightfixed:i=!1,lineTexture:a=!1,iconStep:o=100,iconStepCount:s=1}=this.layer.getLayerConfig(),{animateOption:l}=this.layer.getLayerConfig();if(this.rendererService.getDirty()){var u;(u=this.texture)===null||u===void 0||u.bind()}let c=0,f=[0,0,0,0],d=[0,0,0,0];t&&r&&(f=Qa(t),d=Qa(r),c=1);const v={u_animate:this.animateOption2Array(l),u_sourceColor:f,u_targetColor:d,u_textSize:[1024,this.iconService.canvasHeight||128],u_icon_step:o,u_heightfixed:Number(i),u_linearColor:c,u_line_texture:a?1:0,u_textureBlend:n==="normal"?0:1,u_iconStepCount:s,u_time:this.layer.getLayerAnimateTime()||0};return this.getUniformsBufferInfo(v)}initModels(){var t=this;return Pe(function*(){return t.initUniformsBuffer(),t.updateTexture(),t.iconService.on("imageUpdate",t.updateTexture),t.buildModels()})()}clearModels(){var t;(t=this.texture)===null||t===void 0||t.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}buildModels(){var t=this;return Pe(function*(){return[yield t.layer.buildLayerModel({moduleName:"lineWall",vertexShader:z5t,fragmentShader:k5t,triangulation:FD,defines:t.getDefines(),inject:t.getInject(),depth:{enable:!1},blend:t.getBlend()})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:Qr.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:2,update:t=>{const{size:r=1}=t;return Array.isArray(r)?[r[0],r[1]]:[r,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Qr.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:q.STATIC_DRAW,data:[],type:q.FLOAT},size:3,update:(t,r,n,i,a)=>a}}),this.styleAttributeService.registerStyleAttribute({name:"distanceAndTotalAndMiter",type:Qr.Attribute,descriptor:{name:"a_Distance_Total_Miter",shaderLocation:this.attributeLocation.DISTANCE_MITER_TOTAL,buffer:{usage:q.STATIC_DRAW,data:[],type:q.FLOAT},size:3,update:(t,r,n)=>[n[3],n[4],n[5]]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Qr.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:2,update:t=>{const r=this.iconService.getIconMap(),{texture:n}=t,{x:i,y:a}=r[n]||{x:0,y:0};return[i,a]}}})}}const $5t={arc:f5t,arc3d:a$,greatcircle:O5t,wall:U5t,line:vJ,simple:N5t,flowline:M5t,earthArc3d:a$},H5t=$5t;class hx extends b_{constructor(...t){super(...t),z(this,"type","LineLayer"),z(this,"enableShaderEncodeStyles",["stroke","offsets","opacity","thetaOffset"]),z(this,"arrowInsertCount",0),z(this,"defaultSourceConfig",{data:[{lng1:100,lat1:30,lng2:130,lat2:30}],options:{parser:{type:"json",x:"lng1",y:"lat1",x1:"lng2",y1:"lat2"}}})}buildModels(){var t=this;return Pe(function*(){const r=t.getModelType();t.layerModel=new H5t[r](t),yield t.initLayerModels()})()}getDefaultConfig(){const t=this.getModelType();return{line:{},linearline:{},simple:{},wall:{},arc3d:{blend:"additive"},arc:{blend:"additive"},greatcircle:{blend:"additive"},tileLine:{},earthArc3d:{},flowline:{},arrow:{}}[t]}getModelType(){var t;if(this.layerType)return this.layerType;const r=this.styleAttributeService.getLayerStyleAttribute("shape");return(r==null||(t=r.scale)===null||t===void 0?void 0:t.field)||"line"}processData(t){if(this.getModelType()!=="simple")return t;const r=[];return t.map(n=>{if(Array.isArray(n.coordinates)&&Array.isArray(n.coordinates[0])&&Array.isArray(n.coordinates[0][0])){const i=Ce({},n);n.coordinates.map(a=>{r.push(Ce(Ce({},i),{},{coordinates:a}))})}else r.push(n)}),r}}const V5t=`
layout(std140) uniform commonUniorm {
  vec4 u_stroke_color;
  float u_additive;
  float u_stroke_opacity;
  float u_stroke_width;
};

in vec4 v_color;
in float v_blur;
in float v_innerRadius;

out vec4 outputColor;

#pragma include "picking"
void main() {
  vec2 center = vec2(0.5);

  // Tip: 片元到中心点的距离 0 - 1
  float fragmengTocenter = distance(center, gl_PointCoord) * 2.0;
  // Tip: 片元的剪切成圆形
  float circleClipOpacity = 1.0 - smoothstep(v_blur, 1.0, fragmengTocenter);


  if(v_innerRadius < 0.99) {
    // 当存在 stroke 且 stroke > 0.01
    float blurWidth = (1.0 - v_blur)/2.0;
    vec4 stroke = vec4(u_stroke_color.rgb, u_stroke_opacity);
    if(fragmengTocenter > v_innerRadius + blurWidth) {
      outputColor = stroke;
    } else if(fragmengTocenter > v_innerRadius - blurWidth){
      float mixR = (fragmengTocenter - (v_innerRadius - blurWidth)) / (blurWidth * 2.0);
      outputColor = mix(v_color, stroke, mixR);
    } else {
      outputColor = v_color;
    }
  } else {
    // 当不存在 stroke 或 stroke <= 0.01
    outputColor = v_color;
  }

  outputColor = filterColor(outputColor);
  
  if(u_additive > 0.0) {
    outputColor *= circleClipOpacity;
  } else {
    outputColor.a *= circleClipOpacity;
  }

}
`,G5t=`
layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;

layout(std140) uniform commonUniorm {
  vec4 u_stroke_color;
  float u_additive;
  float u_stroke_opacity;
  float u_stroke_width;
};

out vec4 v_color;
out float v_blur;
out float v_innerRadius;

#pragma include "projection"
#pragma include "picking"
#pragma include "project"
void main() {
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  v_blur = 1.0 - max(2.0 / a_Size, 0.05);
  v_innerRadius = max((a_Size - u_stroke_width) / a_Size, 0.0);

  vec2 offset = project_pixel(u_offsets);

  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`;function u$(e){const t=e.coordinates;return{vertices:[...t],indices:[0],size:t.length}}class W5t extends Ua{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9})}getDefaultStyle(){return{blend:"additive"}}getCommonUniformsInfo(){const{blend:t,strokeOpacity:r=1,strokeWidth:n=0,stroke:i="#fff"}=this.layer.getLayerConfig(),a={u_stroke_color:Qa(i),u_additive:t==="additive"?1:0,u_stroke_opacity:r,u_stroke_width:n};return this.getUniformsBufferInfo(a)}initModels(){var t=this;return Pe(function*(){return t.buildModels()})()}buildModels(){var t=this;return Pe(function*(){return t.layer.triangulation=u$,t.initUniformsBuffer(),[yield t.layer.buildLayerModel({moduleName:"pointSimple",vertexShader:G5t,fragmentShader:V5t,defines:t.getDefines(),inject:t.getInject(),triangulation:u$,depth:{enable:!1},primitive:q.POINTS})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:Qr.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:1,update:t=>{const{size:r=1}=t;return Array.isArray(r)?[r[0]]:[r]}}})}}const X5t=`precision highp float;
in vec4 v_color;

#pragma include "picking"

layout(std140) uniform commonUniform {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor: 0;
  float u_heightfixed: 0.0; // 默认不固定
  float u_globel;
  float u_r;
  float u_pickLight: 0.0;
  float u_opacitylinear: 0.0;
  float u_opacitylinear_dir: 1.0;
  float u_lightEnable: 1.0;
};
in float v_lightWeight;
in float v_barLinearZ;
out vec4 outputColor;
void main() {

   outputColor = v_color;

  // 开启透明度渐变
  if(u_opacitylinear > 0.0) {
    outputColor.a *= u_opacitylinear_dir > 0.0 ? (1.0 - v_barLinearZ): v_barLinearZ;
  }

  // picking
  if(u_pickLight > 0.0) {
    outputColor = filterColorAlpha(outputColor, v_lightWeight);
  } else {
    outputColor = filterColor(outputColor);
  }
}
`,j5t=`precision highp float;

#define pi 3.1415926535
#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec3 a_Size;
layout(location = ATTRIBUTE_LOCATION_POS) in vec3 a_Pos;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;

layout(std140) uniform commonUniform {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor: 0;
  float u_heightfixed: 0.0; // 默认不固定
  float u_globel;
  float u_r;
  float u_pickLight: 0.0;
  float u_opacitylinear: 0.0;
  float u_opacitylinear_dir: 1.0;
  float u_lightEnable: 1.0;
};

out vec4 v_color;
out float v_lightWeight;
out float v_barLinearZ;
// 用于将在顶点着色器中计算好的样式值传递给片元


#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if(x > 0.0 && z > 0.0) {
    return atan(x/z);
  } else if(x > 0.0 && z <= 0.0){
    return atan(-z/x) + pi/2.0;
  } else if(x <= 0.0 && z <= 0.0) {
    return  pi + atan(x/z); //atan(x/z) +
  } else {
    return atan(z/-x) + pi*3.0/2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y/r);
}

void main() {

  // cal style mapping - 数据纹理映射部分的计算
  vec3 size = a_Size * a_Position;

  // a_Position.z 是在构建网格的时候传入的标准值 0 - 1，在插值器插值可以获取 0～1 线性渐变的值
  v_barLinearZ =  a_Position.z;

  vec3 offset = size; // 控制圆柱体的大小 - 从标准单位圆柱体进行偏移
  if(u_heightfixed < 1.0) { // 圆柱体不固定高度
    //
  } else {// 圆柱体固定高度 （ 处理 mapbox ）
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      offset *= 4.0/pow(2.0, 21.0 - u_Zoom);
    }
  }


  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  // u_r 控制圆柱的生长
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // 圆柱光照效果
  float lightWeight = 1.0;
  if(u_lightEnable > 0.0) { // 取消三元表达式，增强健壮性
    lightWeight = calc_lighting(pos);
  }
  v_lightWeight = lightWeight;
  // 设置圆柱的底色
  if(u_linearColor == 1.0) { // 使用渐变颜色
    v_color = mix(u_sourceColor, u_targetColor, v_barLinearZ);
    v_color.rgb *= lightWeight;
  } else { // 使用 color 方法传入的颜色
     v_color = a_Color;
  }
  v_color.a *= u_opacity;


  // 在地球模式下，将原本垂直于 xy 平面的圆柱调整姿态到适应圆的角度
  //旋转矩阵mx，创建绕x轴旋转矩阵
  float r = sqrt(a_Pos.z*a_Pos.z + a_Pos.x*a_Pos.x);
  float xRadian = getXRadian(a_Pos.y, r);
  float xcos = cos(xRadian);//求解旋转角度余弦值
  float xsin = sin(xRadian);//求解旋转角度正弦值
  mat4 mx = mat4(
    1,0,0,0,
    0,xcos,-xsin,0,
    0,xsin,xcos,0,
    0,0,0,1);

  //旋转矩阵my，创建绕y轴旋转矩阵
  float yRadian = getYRadian(a_Pos.x, a_Pos.z);
  float ycos = cos(yRadian);//求解旋转角度余弦值
  float ysin = sin(yRadian);//求解旋转角度正弦值
  mat4 my = mat4(
    ycos,0,-ysin,0,
    0,1,0,0,
    ysin,0,ycos,0,
    0,0,0,1);

  gl_Position = u_ViewProjectionMatrix * vec4(( my * mx *  vec4(a_Position * a_Size, 1.0)).xyz + a_Pos, 1.0);


  setPickingColor(a_PickingColor);
}
`,{isNumber:Y5t}=is;let Z5t=class extends Ua{constructor(...t){super(...t),z(this,"raiseCount",0),z(this,"raiseRepeat",0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,POS:10,NORMAL:11})}getCommonUniformsInfo(){const{animateOption:t={enable:!1,speed:.01,repeat:!1},opacity:r=1,sourceColor:n,targetColor:i,pickLight:a=!1,heightfixed:o=!0,opacityLinear:s={enable:!1,dir:"up"},lightEnable:l=!0}=this.layer.getLayerConfig();let u=0,c=[0,0,0,0],f=[0,0,0,0];if(n&&i&&(c=Qa(n),f=Qa(i),u=1),this.raiseCount<1&&this.raiseRepeat>0&&t.enable){const{speed:g=.01}=t;this.raiseCount+=g,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}const d={u_sourceColor:c,u_targetColor:f,u_linearColor:u,u_pickLight:Number(a),u_heightfixed:Number(o),u_r:t.enable&&this.raiseRepeat>0?this.raiseCount:1,u_opacity:Y5t(r)?r:1,u_opacitylinear:Number(s.enable),u_opacitylinear_dir:s.dir==="up"?1:0,u_lightEnable:Number(l)};return this.getUniformsBufferInfo(d)}initModels(){var t=this;return Pe(function*(){return t.initUniformsBuffer(),t.buildModels()})()}buildModels(){var t=this;return Pe(function*(){const{animateOption:{repeat:r=1}}=t.layer.getLayerConfig();return t.raiseRepeat=r,[yield t.layer.buildLayerModel({moduleName:"pointEarthExtrude",vertexShader:j5t,fragmentShader:X5t,triangulation:f4,depth:{enable:!0},defines:t.getDefines(),inject:t.getInject(),cull:{enable:!0,face:q.FRONT},blend:t.getBlend()})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Qr.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:3,update:t=>{const{size:r}=t;if(r){let n=[];return Array.isArray(r)&&(n=r.length===2?[r[0],r[0],r[1]]:r),Array.isArray(r)||(n=[r,r,r]),n}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Qr.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:q.STATIC_DRAW,data:[],type:q.FLOAT},size:3,update:(t,r,n,i,a)=>a}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:Qr.Attribute,descriptor:{name:"a_Pos",shaderLocation:this.attributeLocation.POS,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:3,update:t=>{const r=Xy(t.coordinates);return cJ([r[0],r[1]])}}})}};const q5t=`in vec4 v_data;
in vec4 v_color;
in float v_radius;

layout(std140) uniform commonUniform {
  float u_additive;
  float u_stroke_opacity : 1;
  float u_stroke_width : 2;
  float u_blur : 0.0;
};
#pragma include "sdf_2d"
#pragma include "picking"

out vec4 outputColor;

void main() {
  int shape = int(floor(v_data.w + 0.5));

  vec4 strokeColor = u_stroke == vec4(0.0) ? v_color : u_stroke;

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  if(outer_df > antialiasblur + 0.018) discard;

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  if(u_stroke_width < 0.01) {
    outputColor = vec4(v_color.rgb, v_color.a * u_opacity);
  } else {
    outputColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);
  }

  if(u_additive > 0.0) {
    outputColor *= opacity_t;
    outputColor = filterColorAlpha(outputColor, outputColor.a);
  } else {
    outputColor.a *= opacity_t;
    outputColor = filterColor(outputColor);
  }
}
`,K5t=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_SHAPE) in float a_Shape;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;

layout(std140) uniform commonUniform {
  float u_additive;
  float u_stroke_opacity : 1;
  float u_stroke_width : 2;
  float u_blur : 0.0;
};
out vec4 v_data;
out vec4 v_color;
out float v_radius;

#pragma include "projection"
#pragma include "picking"


void main() {
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize 设置拾取大小
  */
  float newSize = setPickingSize(a_Size);
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;

  // unpack color(vec2)
  v_color = a_Color;

  // radius(16-bit)
  v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur);

  // TODP: /abs(extrude.x) 是为了兼容地球模式
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);

  gl_Position = u_ViewProjectionMatrix * vec4(a_Position + extrude * newSize * 0.1 + vec3(u_offsets,0.0), 1.0);

  setPickingColor(a_PickingColor);
}
`;let Q5t=class extends Ua{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,SHAPE:10,EXTRUDE:11})}getCommonUniformsInfo(){const{strokeOpacity:t=1,strokeWidth:r=0,blend:n,blur:i=0}=this.layer.getLayerConfig();this.layer.getLayerConfig();const a={u_additive:n==="additive"?1:0,u_stroke_opacity:t,u_stroke_width:r,u_blur:i};return this.getUniformsBufferInfo(a)}initModels(){var t=this;return Pe(function*(){return t.initUniformsBuffer(),t.buildModels()})()}buildModels(){var t=this;return Pe(function*(){return t.layer.triangulation=e$,[yield t.layer.buildLayerModel({moduleName:"pointEarthFill",vertexShader:K5t,fragmentShader:q5t,triangulation:e$,defines:t.getDefines(),inject:t.getInject(),depth:{enable:!0},blend:t.getBlend()})]})()}animateOption2Array(t){return[t.enable?0:1,t.speed||1,t.rings||3,0]}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Qr.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:3,update:(t,r,n,i)=>{const[a,o,s]=n,l=ec(0,0,1),u=ec(a,0,s),c=a>=0?gU(l,u):Math.PI*2-gU(l,u),f=Math.PI*2-Math.asin(o/100),d=xb();cI(d,d,c),bb(d,d,f);const v=ec(1,1,0);Z2(v,v,d),lw(v,v);const g=ec(-1,1,0);Z2(g,g,d),lw(g,g);const x=ec(-1,-1,0);Z2(x,x,d),lw(x,x);const w=ec(1,-1,0);Z2(w,w,d),lw(w,w);const S=[...v,...g,...x,...w],A=i%4*3;return[S[A],S[A+1],S[A+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Qr.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:1,update:t=>{const{size:r=5}=t;return Array.isArray(r)?[r[0]]:[r]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:Qr.Attribute,descriptor:{name:"a_Shape",shaderLocation:this.attributeLocation.SHAPE,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:1,update:t=>{const{shape:r=2}=t;return[this.layer.getLayerConfig().shape2d.indexOf(r)]}}})}};const J5t=`
in vec4 v_color;
in float v_lightWeight;
out vec4 outputColor;

layout(std140) uniform commonUniforms {
  float u_pickLight;
  float u_heightfixed;
  float u_r;
  float u_linearColor;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_opacitylinear;
  float u_opacitylinear_dir;
  float u_lightEnable;
};

#pragma include "scene_uniforms"
#pragma include "picking"

void main() {

  outputColor = v_color;
  // 开启透明度渐变
  // picking
  if(u_pickLight > 0.0) {
    outputColor = filterColorAlpha(outputColor, v_lightWeight);
  } else {
    outputColor = filterColor(outputColor);
  }
}
`,t4t=`#define pi (3.1415926535)

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec3 a_Size;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec4 a_Extrude;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;

layout(std140) uniform commonUniforms {
  float u_pickLight;
  float u_heightfixed;
  float u_r;
  float u_linearColor;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_opacitylinear;
  float u_opacitylinear_dir;
  float u_lightEnable;
};
out vec4 v_color;
out float v_lightWeight;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if (x > 0.0 && z > 0.0) {
    return atan(x / z);
  } else if (x > 0.0 && z <= 0.0) {
    return atan(-z / x) + pi / 2.0;
  } else if (x <= 0.0 && z <= 0.0) {
    return pi + atan(x / z); //atan(x/z) +
  } else {
    return atan(z / -x) + pi * 3.0 / 2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y / r);
}

void main() {
  vec3 size = a_Size * a_Position;

  vec3 offset = size; // 控制圆柱体的大小 - 从标准单位圆柱体进行偏移

  if (u_heightfixed < 1.0) {
    // 圆柱体不固定高度
  } else {
    // 圆柱体固定高度 （ 处理 mapbox ）
    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      offset *= 4.0 / pow(2.0, 21.0 - u_Zoom);
    }
  }

  vec2 positions = a_Extrude.xy;
  vec2 positions64Low = a_Extrude.zw;
  vec4 project_pos = project_position(vec4(positions, 0.0, 1.0), positions64Low);

  // u_r 控制圆柱的生长
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // // 圆柱光照效果
  float lightWeight = 1.0;

  if (u_lightEnable > 0.0) {
    // 取消三元表达式，增强健壮性
    lightWeight = calc_lighting(pos);
  }

  v_lightWeight = lightWeight;

  v_color = a_Color;

  // 设置圆柱的底色
  if (u_linearColor == 1.0) {
    // 使用渐变颜色
    v_color = mix(u_sourceColor, u_targetColor, a_Position.z);
    v_color.a = v_color.a * opacity;
  } else {
    v_color = vec4(a_Color.rgb * lightWeight, a_Color.w * opacity);
  }

  if (u_opacitylinear > 0.0) {
    v_color.a *= u_opacitylinear_dir > 0.0 ? 1.0 - a_Position.z : a_Position.z;
  }

  gl_Position = project_common_position_to_clipspace(pos);

  setPickingColor(a_PickingColor);
}
`;let gJ=class extends Ua{constructor(...t){super(...t),z(this,"raiseCount",0),z(this,"raiseRepeat",0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,EXTRUDE:10,NORMAL:11})}getCommonUniformsInfo(){const{animateOption:t={enable:!1,speed:.01,repeat:!1},sourceColor:r,targetColor:n,pickLight:i=!1,heightfixed:a=!1,opacityLinear:o={enable:!1,dir:"up"},lightEnable:s=!0}=this.layer.getLayerConfig();let l=0,u=[0,0,0,0],c=[0,0,0,0];if(r&&n&&(u=Qa(r),c=Qa(n),l=1),this.raiseCount<1&&this.raiseRepeat>0&&t.enable){const{speed:v=.01}=t;this.raiseCount+=v,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}const f={u_pickLight:Number(i),u_heightfixed:Number(a),u_r:t.enable&&this.raiseRepeat>0?this.raiseCount:1,u_linearColor:l,u_sourceColor:u,u_targetColor:c,u_opacitylinear:Number(o.enable),u_opacitylinear_dir:o.dir==="up"?1:0,u_lightEnable:Number(s)};return this.getUniformsBufferInfo(f)}initModels(){var t=this;return Pe(function*(){return t.buildModels()})()}buildModels(){var t=this;return Pe(function*(){const{depth:r=!0,animateOption:{repeat:n=1}}=t.layer.getLayerConfig();return t.raiseRepeat=n,t.initUniformsBuffer(),[yield t.layer.buildLayerModel({moduleName:"pointExtrude",vertexShader:t4t,fragmentShader:J5t,triangulation:f4,defines:t.getDefines(),inject:t.getInject(),cull:{enable:!0,face:q.FRONT},depth:{enable:r}})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Qr.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:3,update:t=>{const{size:r}=t;if(r){let n=[];return Array.isArray(r)&&(n=r.length===2?[r[0],r[0],r[1]]:r),Array.isArray(r)||(n=[r,r,r]),n}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Qr.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:q.STATIC_DRAW,data:[],type:q.FLOAT},size:3,update:(t,r,n,i,a)=>a}}),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Qr.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:4,update:t=>{const r=Xy(t.coordinates);return[r[0],r[1],rl(r[0]),rl(r[1])]}}})}};const e4t=`
layout(std140) uniform commonUniforms {
  vec3 u_blur_height_fixed;
  float u_stroke_width;
  float u_additive;
  float u_stroke_opacity;
  float u_size_unit;
  float u_time;
  vec4 u_animate;
};

in vec4 v_color;
in vec4 v_stroke;
in vec4 v_data;
in float v_radius;

#pragma include "scene_uniforms"
#pragma include "sdf_2d"
#pragma include "picking"

out vec4 outputColor;

void main() {
  int shape = int(floor(v_data.w + 0.5));
  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  float PI = 3.14159;
  float N_RINGS = 3.0;
  float FREQ = 1.0;

  if(u_stroke_width < 0.01) {
    outputColor = v_color;
  } else {
    outputColor = mix(v_color, v_stroke * u_stroke_opacity, color_t);
  }
  float intensity = 1.0;
  if(u_time!=-1.0){
    //wave相关逻辑
    float d = length(v_data.xy);
    if(d > 0.5) {
      discard;
    }
    intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_animate.z - u_animate.y * u_time)), 0.0, 1.0);
  }

  if(u_additive > 0.0) {
    outputColor *= opacity_t;
    outputColor *= intensity;//wave
    outputColor = filterColorAlpha(outputColor, outputColor.a);
  } else {
    outputColor.a *= opacity_t;
    outputColor.a *= intensity;//wave 
    outputColor = filterColor(outputColor);
  }
   // 作为 mask 模板时需要丢弃透明的像素
  if(outputColor.a < 0.01) {
    discard;
  } 
}
`,r4t=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_SHAPE) in float a_Shape;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;

layout(std140) uniform commonUniforms {
  vec3 u_blur_height_fixed;
  float u_stroke_width;
  float u_additive;
  float u_stroke_opacity;
  float u_size_unit;
  float u_time;
  vec4 u_animate;
};

out vec4 v_color;
out vec4 v_stroke;
out vec4 v_data;
out float v_radius;

#pragma include "projection"
#pragma include "picking"
#pragma include "rotation_2d"

void main() {
  // 透明度计算
   v_stroke = stroke;
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize 设置拾取大小
  *  u_meter2coord 在等面积大小的时候设置单位
  */
  float newSize = setPickingSize(a_Size);
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;



  // unpack color(vec2)
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);

  if(u_size_unit == 1.0) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }

   v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur_height_fixed.x);

  vec2 offset = (extrude.xy * (newSize + u_stroke_width) + u_offsets);

  offset = project_pixel(offset);
  offset = rotate_matrix(offset,rotation);

  // TODP: /abs(extrude.x) 是为了兼容地球模式
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);

  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0), a_Position64Low);
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));

  float raisingHeight = u_blur_height_fixed.y;

  if(u_blur_height_fixed.z < 1.0) { // false
    raisingHeight = project_pixel(u_blur_height_fixed.y);
  } else {
     if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_blur_height_fixed.y * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));

  setPickingColor(a_PickingColor);
}
`;let mJ=class extends Ua{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,SHAPE:10,EXTRUDE:11})}getCommonUniformsInfo(){const{strokeOpacity:t=1,strokeWidth:r=0,blend:n,blur:i=0,raisingHeight:a=0,heightfixed:o=!1,unit:s="pixel"}=this.layer.getLayerConfig();let l=this.getAnimateUniforms().u_time;isNaN(l)&&(l=-1);const u={u_blur_height_fixed:[i,Number(a),Number(o)],u_stroke_width:r,u_additive:n==="additive"?1:0,u_stroke_opacity:t,u_size_unit:h4[s],u_time:l,u_animate:this.getAnimateUniforms().u_animate};return this.getUniformsBufferInfo(u)}getAnimateUniforms(){const{animateOption:t={enable:!1}}=this.layer.getLayerConfig();return{u_animate:this.animateOption2Array(t),u_time:this.layer.getLayerAnimateTime()}}getAttribute(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Py)}initModels(){var t=this;return Pe(function*(){return t.buildModels()})()}buildModels(){var t=this;return Pe(function*(){const{frag:r,vert:n,type:i}=t.getShaders();return t.layer.triangulation=Py,t.initUniformsBuffer(),[yield t.layer.buildLayerModel({moduleName:i,vertexShader:n,fragmentShader:r,defines:t.getDefines(),inject:t.getInject(),triangulation:Py,depth:{enable:!1}})]})()}getShaders(){return{frag:e4t,vert:r4t,type:"pointFill"}}animateOption2Array(t){return[t.enable?0:1,t.speed||1,t.rings||3,0]}registerBuiltinAttributes(){const t=this.layer.getLayerConfig().shape2d;this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Qr.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:3,update:(r,n,i,a)=>{const o=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],s=a%4*3;return[o[s],o[s+1],o[s+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Qr.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:1,update:r=>{const{size:n=5}=r;return Array.isArray(n)?[n[0]]:[n]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:Qr.Attribute,descriptor:{name:"a_Shape",shaderLocation:this.attributeLocation.SHAPE,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:1,update:r=>{const{shape:n=2}=r;return[t.indexOf(n)]}}})}};const n4t=`in vec2 v_uv;// 本身的 uv 坐标
in vec2 v_Iconuv;
in float v_opacity;
out vec4 outputColor;

uniform sampler2D u_texture;
layout(std140) uniform commonUniform {
  vec2 u_textSize;
  float u_heightfixed: 0.0;
  float u_raisingHeight: 0.0;
  float u_size_unit;
};

#pragma include "scene_uniforms"
#pragma include "sdf_2d"
#pragma include "picking"

void main() {
  vec2 pos = v_Iconuv / u_textSize + v_uv / u_textSize * 64.;
  outputColor = texture(SAMPLER_2D(u_texture), pos);
  outputColor.a *= v_opacity;
  outputColor = filterColor(outputColor);
}
`,i4t=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniform {
  vec2 u_textSize;
  float u_heightfixed;
  float u_raisingHeight;
  float u_size_unit;
};

out vec2 v_uv;
out vec2 v_Iconuv;
out float v_opacity;

#pragma include "projection"
#pragma include "picking"
#pragma include "rotation_2d"

void main() {
  vec3 extrude = a_Extrude;
  v_uv = (a_Extrude.xy + 1.0) / 2.0;
  v_uv.y = 1.0 - v_uv.y;
  v_Iconuv = a_Uv;
  v_opacity = opacity;
  float newSize = a_Size;
  if (u_size_unit == 1.0) {
    newSize = newSize * u_PixelsPerMeter.z;
  }

  // vec2 offset = (u_RotateMatrix * extrude.xy * (a_Size) + textrueOffsets);
  vec2 offset = extrude.xy * newSize + offsets;

  offset = rotate_matrix(offset, rotation);

  offset = project_pixel(offset);

  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

  setPickingColor(a_PickingColor);
}
`;class a4t extends Ua{constructor(...t){super(...t),z(this,"meter2coord",1),z(this,"texture",void 0),z(this,"isMeter",!1),z(this,"radian",0),z(this,"updateTexture",()=>{const{createTexture2D:r}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),this.layerService.throttleRenderLayers();return}this.texture=r({data:this.iconService.getCanvas(),mag:q.LINEAR,min:q.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128,mipmap:!0}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,EXTRUDE:10,UV:11})}getCommonUniformsInfo(){const{raisingHeight:t=0,heightfixed:r=!1,unit:n="pixel"}=this.layer.getLayerConfig();if(this.rendererService.getDirty()){var i;(i=this.texture)===null||i===void 0||i.bind()}const a={u_textSize:[1024,this.iconService.canvasHeight||128],u_heightfixed:Number(r),u_raisingHeight:Number(t),u_size_unit:h4[n]};return this.getUniformsBufferInfo(a)}getAttribute(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Py)}initModels(){var t=this;return Pe(function*(){return t.iconService.on("imageUpdate",t.updateTexture),t.updateTexture(),t.buildModels()})()}buildModels(){var t=this;return Pe(function*(){return t.initUniformsBuffer(),[yield t.layer.buildLayerModel({moduleName:"pointFillImage",vertexShader:i4t,fragmentShader:n4t,triangulation:Py,depth:{enable:!1},defines:t.getDefines(),inject:t.getInject(),cull:{enable:!0,face:q.FRONT}})]})()}clearModels(){var t;this.iconService.off("imageUpdate",this.updateTexture),(t=this.texture)===null||t===void 0||t.destroy()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Qr.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:2,update:t=>{const r=this.iconService.getIconMap(),{shape:n}=t,{x:i,y:a}=r[n]||{x:-64,y:-64};return[i,a]}}}),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Qr.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:3,update:(t,r,n,i)=>{const a=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],o=i%4*3;return[a[o],a[o+1],a[o+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Qr.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:1,update:t=>{const{size:r=5}=t;return Array.isArray(r)?[r[0]]:[r]}}})}}const o4t=`layout(std140) uniform commonUniforms {
  vec2 u_textSize;
  float u_raisingHeight;
  float u_heightfixed;
};

uniform sampler2D u_texture;

in vec4 v_color;
in vec2 v_uv;
in float v_opacity;

#pragma include "picking"

out vec4 outputColor;

void main(){
  vec2 pos = v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
  vec4 textureColor;

  // Y = 0.299R + 0.587G + 0.114B // 亮度提取
  
  textureColor = texture(SAMPLER_2D(u_texture), pos);

  // Tip: 去除边缘部分 mipmap 导致的混合变暗
  float fragmengTocenter = distance(vec2(0.5), gl_PointCoord);
  if(fragmengTocenter >= 0.5) {
        float luma = 0.299 * textureColor.r + 0.587 * textureColor.g + 0.114 * textureColor.b;
        textureColor.a *= luma;
  }
  
  if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
        outputColor= textureColor;
  }else {
        outputColor= step(0.01, textureColor.z) * v_color;
  }
  outputColor.a *= v_opacity;
  if (outputColor.a < 0.01) {
      discard;
  }
  outputColor = filterColor(outputColor);
}
`,s4t=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
  vec2 u_textSize;
  float u_raisingHeight;
  float u_heightfixed;
};

out vec4 v_color;
out vec2 v_uv;
out float v_opacity;

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - 数据纹理映射部分的计算
  v_color = a_Color;
  v_opacity = opacity;
  v_uv = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);

  vec2 offset = project_pixel(offsets);

  float raisingHeight = u_raisingHeight;
  if (u_heightfixed < 1.0) {
    // false
    raisingHeight = project_pixel(u_raisingHeight);
  } else {
    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_raisingHeight * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`;class yJ extends Ua{constructor(...t){super(...t),z(this,"texture",void 0),z(this,"updateTexture",()=>{const{createTexture2D:r}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),setTimeout(()=>{this.layerService.throttleRenderLayers()});return}this.texture=r({data:this.iconService.getCanvas(),mag:q.LINEAR,min:q.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128,mipmap:!0})})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,UV:10})}getUninforms(){if(this.rendererService.getDirty()){var t;(t=this.texture)===null||t===void 0||t.bind()}const r=this.getCommonUniformsInfo(),n=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),Ce(Ce({},r.uniformsOption),n.uniformsOption)}getCommonUniformsInfo(){const{raisingHeight:t=0,heightfixed:r=!1}=this.layer.getLayerConfig(),n={u_textSize:[1024,this.iconService.canvasHeight||128],u_raisingHeight:Number(t),u_heightfixed:Number(r),u_texture:this.texture};return this.textures=[this.texture],this.getUniformsBufferInfo(n)}initModels(){var t=this;return Pe(function*(){return t.iconService.on("imageUpdate",t.updateTexture),t.updateTexture(),t.buildModels()})()}clearModels(){var t;(t=this.texture)===null||t===void 0||t.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}buildModels(){var t=this;return Pe(function*(){return t.initUniformsBuffer(),[yield t.layer.buildLayerModel({moduleName:"pointImage",vertexShader:s4t,fragmentShader:o4t,triangulation:LBt,defines:t.getDefines(),inject:t.getInject(),depth:{enable:!1},primitive:q.POINTS})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:Qr.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:1,update:t=>{const{size:r=5}=t;return Array.isArray(r)?[r[0]]:[r]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Qr.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:2,update:t=>{const r=this.iconService.getIconMap(),{shape:n}=t,{x:i,y:a}=r[n]||{x:-64,y:-64};return[i,a]}}})}}const l4t=`in vec4 v_color;
out vec4 outputColor;
void main() {
  outputColor = v_color;
}`,u4t=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;

layout(std140) uniform u_Common {
  float u_size_scale;
};

out vec4 v_color;

#pragma include "projection"
#pragma include "project"

void main() {
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);

  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(project_pos);

  gl_PointSize = a_Size * u_size_scale * 2.0 * u_DevicePixelRatio;
}
`;function c$(e){const t=e.coordinates;return{vertices:[...t],indices:[0],size:t.length}}class _J extends Ua{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9})}getDefaultStyle(){return{blend:"additive"}}getCommonUniformsInfo(){const t={u_size_scale:.5};return this.getUniformsBufferInfo(t)}initModels(){var t=this;return Pe(function*(){return t.buildModels()})()}buildModels(){var t=this;return Pe(function*(){return t.layer.triangulation=c$,t.initUniformsBuffer(),[yield t.layer.buildLayerModel({moduleName:"pointNormal",vertexShader:u4t,fragmentShader:l4t,triangulation:c$,defines:t.getDefines(),inject:t.getInject(),depth:{enable:!1},primitive:q.POINTS,pick:!1})]})()}clearModels(){}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:Qr.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:1,update:t=>{const{size:r=1}=t;return Array.isArray(r)?[r[0]]:[r]}}})}}const c4t=`
layout(std140) uniform commonUniorm{
  float u_additive;
  float u_size_unit;
  float u_speed: 1.0;
  float u_time;
};
in vec4 v_data;
in vec4 v_color;
in float v_radius;
in vec2 v_extrude;
#pragma include "sdf_2d"
#pragma include "picking"

out vec4 outputColor;

void main() {

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius);

  float outer_df = sdCircle(v_data.xy, 1.0);
  float inner_df = sdCircle(v_data.xy, r);

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  outputColor = vec4(v_color.rgb, v_color.a);

  if(u_additive > 0.0) {
    outputColor *= opacity_t;
  } else {
    outputColor.a *= opacity_t;
  }

  if(outputColor.a > 0.0) {
    outputColor = filterColor(outputColor);
  }

  vec2 extrude =  v_extrude;
  vec2 dir = normalize(extrude);
  vec2 baseDir = vec2(1.0, 0.0);
  float pi = 3.14159265359;
  float flag = sign(dir.y);
  float rades = dot(dir, baseDir);
  float radar_v = (flag - 1.0) * -0.5 * acos(rades)/pi;
  // simple AA
  if(radar_v > 0.99) {
    radar_v = 1.0 - (radar_v - 0.99)/0.01;
  }

  outputColor.a *= radar_v;
}
`,h4t=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;

layout(std140) uniform commonUniorm {
  float u_additive;
  float u_size_unit;
  float u_speed: 1.0;
  float u_time;
};

out vec4 v_data;
out vec4 v_color;
out float v_radius;
out vec2 v_extrude;

#pragma include "projection"
#pragma include "picking"

void main() {
  float newSize = setPickingSize(a_Size);

  float time = u_time * u_speed;
  mat2 rotateMatrix = mat2(
    cos(time), sin(time),
    -sin(time), cos(time)
  );
  v_extrude = rotateMatrix * a_Extrude.xy;

  v_color = a_Color;
  v_color.a *= opacity;

  float blur = 0.0;
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / a_Size, blur);

  if(u_size_unit == 1.) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }
  v_radius = newSize;

  vec2 offset = (a_Extrude.xy * (newSize));

  offset = project_pixel(offset);

  v_data = vec4(a_Extrude.x, a_Extrude.y, antialiasblur, -1.0);

  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));

  setPickingColor(a_PickingColor);
}
`;class f4t extends Ua{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,EXTRUDE:10})}getCommonUniformsInfo(){const{blend:t,speed:r=1,unit:n="pixel"}=this.layer.getLayerConfig(),i={u_additive:t==="additive"?1:0,u_size_unit:h4[n],u_speed:r,u_time:this.layer.getLayerAnimateTime()};return this.getUniformsBufferInfo(i)}getAnimateUniforms(){return{}}getAttribute(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Py)}initModels(){var t=this;return Pe(function*(){return t.buildModels()})()}buildModels(){var t=this;return Pe(function*(){return t.initUniformsBuffer(),[yield t.layer.buildLayerModel({moduleName:"pointRadar",vertexShader:h4t,fragmentShader:c4t,triangulation:Py,defines:t.getDefines(),inject:t.getInject(),depth:{enable:!1}})]})()}animateOption2Array(t){return[t.enable?0:1,t.speed||1,t.rings||3,0]}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Qr.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:3,update:(t,r,n,i)=>{const a=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],o=i%4*3;return[a[o],a[o+1],a[o+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Qr.Attribute,descriptor:{shaderLocation:this.attributeLocation.SIZE,name:"a_Size",buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:1,update:t=>{const{size:r=5}=t;return Array.isArray(r)?[r[0]]:[r]}}})}}class d4t{constructor(t,r,n){z(this,"boxCells",[]),z(this,"xCellCount",void 0),z(this,"yCellCount",void 0),z(this,"boxKeys",void 0),z(this,"bboxes",void 0),z(this,"width",void 0),z(this,"height",void 0),z(this,"xScale",void 0),z(this,"yScale",void 0),z(this,"boxUid",void 0);const i=this.boxCells;this.xCellCount=Math.ceil(t/n),this.yCellCount=Math.ceil(r/n);for(let a=0;a<this.xCellCount*this.yCellCount;a++)i.push([]);this.boxKeys=[],this.bboxes=[],this.width=t,this.height=r,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/r,this.boxUid=0}insert(t,r,n,i,a){this.forEachCell(r,n,i,a,this.insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(a)}query(t,r,n,i,a){return this.queryHitTest(t,r,n,i,!1,a)}hitTest(t,r,n,i,a){return this.queryHitTest(t,r,n,i,!0,a)}insertBoxCell(t,r,n,i,a,o){this.boxCells[a].push(o)}queryHitTest(t,r,n,i,a,o){if(n<0||t>this.width||i<0||r>this.height)return a?!1:[];const s=[];if(t<=0&&r<=0&&this.width<=n&&this.height<=i){if(a)return!0;for(let u=0;u<this.boxKeys.length;u++)s.push({key:this.boxKeys[u],x1:this.bboxes[u*4],y1:this.bboxes[u*4+1],x2:this.bboxes[u*4+2],y2:this.bboxes[u*4+3]});return o?s.filter(o):s}const l={hitTest:a,seenUids:{box:{},circle:{}}};return this.forEachCell(t,r,n,i,this.queryCell,s,l,o),a?s.length>0:s}queryCell(t,r,n,i,a,o,s,l){const u=s.seenUids,c=this.boxCells[a];if(c!==null){const f=this.bboxes;for(const d of c)if(!u.box[d]){u.box[d]=!0;const v=d*4;if(t<=f[v+2]&&r<=f[v+3]&&n>=f[v+0]&&i>=f[v+1]&&(!l||l(this.boxKeys[d]))){if(s.hitTest)return o.push(!0),!0;o.push({key:this.boxKeys[d],x1:f[v],y1:f[v+1],x2:f[v+2],y2:f[v+3]})}}}return!1}forEachCell(t,r,n,i,a,o,s,l){const u=this.convertToXCellCoord(t),c=this.convertToYCellCoord(r),f=this.convertToXCellCoord(n),d=this.convertToYCellCoord(i);for(let v=u;v<=f;v++)for(let g=c;g<=d;g++){const x=this.xCellCount*g+v;if(a.call(this,t,r,n,i,x,o,s,l))return}}convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}}const p4t=d4t;class v4t{constructor(t,r){z(this,"width",void 0),z(this,"height",void 0),z(this,"grid",void 0),z(this,"viewportPadding",100),z(this,"screenRightBoundary",void 0),z(this,"screenBottomBoundary",void 0),z(this,"gridRightBoundary",void 0),z(this,"gridBottomBoundary",void 0),this.width=t,this.height=r,this.viewportPadding=Math.max(t,r),this.grid=new p4t(t+this.viewportPadding,r+this.viewportPadding,25),this.screenRightBoundary=t+this.viewportPadding,this.screenBottomBoundary=r+this.viewportPadding,this.gridRightBoundary=t+2*this.viewportPadding,this.gridBottomBoundary=r+2*this.viewportPadding}placeCollisionBox(t){const r=t.x1+t.anchorPointX+this.viewportPadding,n=t.y1+t.anchorPointY+this.viewportPadding,i=t.x2+t.anchorPointX+this.viewportPadding,a=t.y2+t.anchorPointY+this.viewportPadding;return!this.isInsideGrid(r,n,i,a)||this.grid.hitTest(r,n,i,a)?{box:[]}:{box:[r,n,i,a]}}insertCollisionBox(t,r){const n={featureIndex:r};this.grid.insert(n,t[0],t[1],t[2],t[3])}project(t,r,n){const i=eIt(r,n,0,1),a=UK(),o=ZRt(...t);return bm(a,i,o),{x:(a[0]/a[3]+1)/2*this.width+this.viewportPadding,y:(-a[1]/a[3]+1)/2*this.height+this.viewportPadding}}isInsideGrid(t,r,n,i){return n>=0&&t<this.gridRightBoundary&&i>=0&&r<this.gridBottomBoundary}}function xJ(e){let t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0;break;default:t=.5}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0;break;default:r=.5}return{horizontalAlign:t,verticalAlign:r}}function bJ(e,t,r,n,i){if(!i)return;const a=e[n],o=a.glyph;if(o){const s=t[o].advance*a.scale,l=(e[n].x+s)*i;for(let u=r;u<=n;u++)e[u].x-=l}}function EJ(e,t,r,n,i,a,o){const s=(t-r)*i,l=(-n*o+.5)*a;for(const u of e)u.x+=s,u.y+=l}function g4t(e,t,r,n,i,a,o){let l=0,u=-8,c=0;const f=e.positionedGlyphs,d=a==="right"?1:a==="left"?0:.5,v=f.length;r.forEach(S=>{if(S.split("").forEach(A=>{const M=t[A],R=0;M&&(f.push({glyph:A,x:l,y:u+R,vertical:!1,scale:1,metrics:M}),l+=M.advance+o)}),f.length!==v){const A=l-o;c=Math.max(A,c),bJ(f,t,v,f.length-1,d)}l=0,u-=n+5});const{horizontalAlign:g,verticalAlign:x}=xJ(i);EJ(f,d,g,x,c,n,r.length);const w=u- -8;e.top+=-x*w,e.bottom=e.top-w,e.left+=-g*c,e.right=e.left+c}function m4t(e,t,r,n,i,a,o){let l=0,u=-8,c=0;const f=e.positionedGlyphs,d=a==="right"?1:a==="left"?0:.5,v=f.length;r.forEach(S=>{const A=t[S],M=0;if(A&&(f.push({glyph:S,x:A.advance/2,y:u+M,vertical:!1,scale:1,metrics:A}),l+=A.advance+o),f.length!==v){const R=l-o;c=Math.max(R,c),bJ(f,t,v,f.length-1,d)}l=0,u-=n+5});const{horizontalAlign:g,verticalAlign:x}=xJ(i);EJ(f,d,g,x,c,n,r.length);const w=u- -8;e.top+=-x*w,e.bottom=e.top-w,e.left+=-g*c,e.right=e.left+c}function y4t(e,t,r,n,i,a,o=[0,0],s){const l=e.split(`
`),u=[],c={positionedGlyphs:u,top:o[1],bottom:o[1],left:o[0],right:o[0],lineCount:l.length,text:e};return s?m4t(c,t,l,r,n,i,a):g4t(c,t,l,r,n,i,a),u.length?c:!1}function _4t(e,t=[0,0],r){const{positionedGlyphs:n=[]}=e,i=[];for(const a of n){const o=a.metrics,s=4,l=o.advance*a.scale/2,u=r?[a.x+l,a.y]:[0,0],c=r?[0,0]:[a.x+l+t[0],a.y+t[1]],f=(0-s)*a.scale-l+c[0],d=(0-s)*a.scale+c[1],v=f+o.width*a.scale,g=d+o.height*a.scale,x={x:f,y:d},w={x:v,y:d},S={x:f,y:g},A={x:v,y:g};i.push({tl:x,tr:w,bl:S,br:A,tex:o,glyphOffset:u})}return i}const h$=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0

uniform sampler2D u_sdf_map;
layout(std140) uniform commonUniforms {
  vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
  vec2 u_sdf_map_size;
  float u_raisingHeight: 0.0;
  float u_stroke_width : 2;
  float u_gamma_scale : 0.5;
  float u_halo_blur : 0.5;
};

in vec2 v_uv;
in float v_gamma_scale;
in vec4 v_color;
in vec4 v_stroke_color;
in float v_fontScale;

out vec4 outputColor;

#pragma include "picking"
void main() {
  // get style data mapping

  // get sdf from atlas
  float dist = texture(SAMPLER_2D(u_sdf_map), v_uv).a;

  lowp float buff = (6.0 - u_stroke_width / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);

  outputColor = mix(v_color, v_stroke_color, smoothstep(0., 0.5, 1.- dist));

  outputColor.a *= alpha;
   // 作为 mask 模板时需要丢弃透明的像素
  if (outputColor.a < 0.01) {
    discard;
  }
  outputColor = filterColor(outputColor);
}
`,f$=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 24.0

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_TEXT_OFFSETS) in vec2 a_textOffsets;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_tex;

layout(std140) uniform commonUniforms {
  vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
  vec2 u_sdf_map_size;
  float u_raisingHeight: 0.0;
  float u_stroke_width : 2;
  float u_gamma_scale : 0.5;
  float u_halo_blur : 0.5;
};

out vec2 v_uv;
out float v_gamma_scale;
out vec4 v_color;
out vec4 v_stroke_color;
out float v_fontScale;

#pragma include "projection"
#pragma include "picking"
#pragma include "rotation_2d"

void main() {
  // cal style mapping - 数据纹理映射部分的计算

  v_uv = a_tex / u_sdf_map_size;



  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  v_stroke_color = vec4(u_stroke_color.xyz, u_stroke_color.w * opacity);

  // 文本缩放比例
  float fontScale = a_Size / FONT_SIZE;
  v_fontScale = fontScale;

  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  // vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  vec2 offset = rotate_matrix(a_textOffsets,rotation);

  // gl_Position = vec4(projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);

  float raiseHeight = u_raisingHeight;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    raiseHeight = u_raisingHeight * mapboxZoomScale;
  }

  vec4 projected_position = project_common_position_to_clipspace(vec4(project_pos.xyz + vec3(0.0, 0.0, raiseHeight), 1.0));

  gl_Position = vec4(
    projected_position.xy / projected_position.w + offset * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;
  setPickingColor(a_PickingColor);

}
`,{isEqual:BE}=is;function d$(e){const t=this,r=e.id,n=[],i=[];if(!t.glyphInfoMap||!t.glyphInfoMap[r])return{vertices:[],indices:[],size:7};const a=t.glyphInfoMap[r].centroid,o=a.length===2?[a[0],a[1],0]:a;return t.glyphInfoMap[r].glyphQuads.forEach((s,l)=>{n.push(...o,s.tex.x,s.tex.y+s.tex.height,s.tl.x,s.tl.y,...o,s.tex.x+s.tex.width,s.tex.y+s.tex.height,s.tr.x,s.tr.y,...o,s.tex.x+s.tex.width,s.tex.y,s.br.x,s.br.y,...o,s.tex.x,s.tex.y,s.bl.x,s.bl.y),i.push(0+l*4,1+l*4,2+l*4,2+l*4,3+l*4,0+l*4)}),{vertices:n,indices:i,size:7}}class wJ extends Ua{constructor(...t){var r;super(...t),r=this,z(this,"glyphInfo",void 0),z(this,"glyphInfoMap",{}),z(this,"rawEncodeData",void 0),z(this,"texture",void 0),z(this,"currentZoom",-1),z(this,"extent",void 0),z(this,"textureHeight",0),z(this,"textCount",0),z(this,"preTextStyle",{}),z(this,"mapping",Pe(function*(){r.initGlyph(),r.updateTexture(),yield r.reBuildModel()}))}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,TEXT_OFFSETS:10,UV:11})}getUninforms(){const t=this.getCommonUniformsInfo(),r=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),Ce(Ce(Ce({},t.uniformsOption),r.uniformsOption),{u_sdf_map:this.textures[0]})}getCommonUniformsInfo(){const{stroke:t="#fff",strokeWidth:r=0,halo:n=.5,gamma:i=2,raisingHeight:a=0}=this.layer.getLayerConfig(),o=this.getFontServiceMapping(),s=this.getFontServiceCanvas();o&&Object.keys(o).length!==this.textCount&&s&&(this.updateTexture(),this.textCount=Object.keys(o).length),this.preTextStyle=this.getTextStyle();const l={u_stroke_color:Qa(t),u_sdf_map_size:[(s==null?void 0:s.width)||1,(s==null?void 0:s.height)||1],u_raisingHeight:Number(a),u_stroke_width:r,u_gamma_scale:i,u_halo_blur:n};return this.getUniformsBufferInfo(l)}initModels(){var t=this;return Pe(function*(){return t.bindEvent(),t.extent=t.textExtent(),t.rawEncodeData=t.layer.getEncodedData(),t.preTextStyle=t.getTextStyle(),t.initUniformsBuffer(),t.buildModels()})()}buildModels(){var t=this;return Pe(function*(){const{textAllowOverlap:r=!1}=t.layer.getLayerConfig();return t.initGlyph(),t.updateTexture(),r||t.filterGlyphs(),[yield t.layer.buildLayerModel({moduleName:"pointText",vertexShader:f$,fragmentShader:h$,defines:t.getDefines(),inject:t.getInject(),triangulation:d$.bind(t),depth:{enable:!1}})]})()}needUpdate(){var t=this;return Pe(function*(){const{textAllowOverlap:r=!1,textAnchor:n="center",textOffset:i,padding:a,fontFamily:o,fontWeight:s}=t.getTextStyle();if(!BE(a,t.preTextStyle.padding)||!BE(i,t.preTextStyle.textOffset)||!BE(n,t.preTextStyle.textAnchor)||!BE(o,t.preTextStyle.fontFamily)||!BE(s,t.preTextStyle.fontWeight))return yield t.mapping(),!0;if(r)return!1;const l=t.mapService.getZoom(),u=t.mapService.getBounds(),c=dK(t.extent,u);return Math.abs(t.currentZoom-l)>.5||!c||r!==t.preTextStyle.textAllowOverlap?(yield t.reBuildModel(),!0):!1})()}clearModels(){var t;(t=this.texture)===null||t===void 0||t.destroy(),this.layer.off("remapping",this.mapping)}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:Qr.Attribute,descriptor:{shaderLocation:this.attributeLocation.TEXT_OFFSETS,name:"a_textOffsets",buffer:{usage:q.STATIC_DRAW,data:[],type:q.FLOAT},size:2,update:(t,r,n)=>[n[5],n[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:Qr.Attribute,descriptor:{name:"a_tex",shaderLocation:this.attributeLocation.UV,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:2,update:(t,r,n)=>[n[3],n[4]]}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Qr.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:1,update:t=>{const{size:r=12}=t;return Array.isArray(r)?[r[0]]:[r]}}})}bindEvent(){this.layer.isTileLayer||this.layer.on("remapping",this.mapping)}textExtent(){const t=this.mapService.getBounds();return V5(t,.5)}initTextFont(){const{fontWeight:t,fontFamily:r}=this.getTextStyle(),n=this.rawEncodeData,i=[];n.forEach(a=>{let{shape:o=""}=a;o=o.toString();for(const s of o)i.indexOf(s)===-1&&i.push(s)}),this.fontService.setFontOptions({characterSet:i,fontWeight:t,fontFamily:r,iconfont:!1})}initIconFontTex(){const{fontWeight:t,fontFamily:r}=this.getTextStyle(),n=this.rawEncodeData,i=[];n.forEach(a=>{let{shape:o=""}=a;o=`${o}`,i.indexOf(o)===-1&&i.push(o)}),this.fontService.setFontOptions({characterSet:i,fontWeight:t,fontFamily:r,iconfont:!0})}getTextStyle(){const{fontWeight:t="400",fontFamily:r="sans-serif",textAllowOverlap:n=!1,padding:i=[0,0],textAnchor:a="center",textOffset:o=[0,0],opacity:s=1,strokeOpacity:l=1,strokeWidth:u=0,stroke:c="#000"}=this.layer.getLayerConfig();return{fontWeight:t,fontFamily:r,textAllowOverlap:n,padding:i,textAnchor:a,textOffset:o,opacity:s,strokeOpacity:l,strokeWidth:u,stroke:c}}generateGlyphLayout(t){const r=this.getFontServiceMapping(),{spacing:n=2,textAnchor:i="center",textOffset:a}=this.layer.getLayerConfig(),o=this.rawEncodeData;this.glyphInfo=o.map(s=>{const{shape:l="",id:u,size:c=1}=s,f=s.textOffset?s.textOffset:a||[0,0],d=s.textAnchor?s.textAnchor:i||"center",v=y4t(l.toString(),r,c,d,"left",n,f,t),g=_4t(v,f,!1);return s.shaping=v,s.glyphQuads=g,s.centroid=Xy(s.coordinates),this.glyphInfoMap[u]={shaping:v,glyphQuads:g,centroid:Xy(s.coordinates)},s})}getFontServiceMapping(){const{fontWeight:t="400",fontFamily:r="sans-serif"}=this.layer.getLayerConfig();return this.fontService.getMappingByKey(`${r}_${t}`)}getFontServiceCanvas(){const{fontWeight:t="400",fontFamily:r="sans-serif"}=this.layer.getLayerConfig();return this.fontService.getCanvasByKey(`${r}_${t}`)}filterGlyphs(){const{padding:t=[0,0],textAllowOverlap:r=!1}=this.layer.getLayerConfig();if(r)return;this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();const{width:n,height:i}=this.rendererService.getViewportSize(),a=new v4t(n,i);this.glyphInfo.filter(s=>{const{shaping:l,id:u=0}=s,c=s.centroid,d=s.size/16,v=this.mapService.lngLatToContainer(c),{box:g}=a.placeCollisionBox({x1:l.left*d-t[0],x2:l.right*d+t[0],y1:l.top*d-t[1],y2:l.bottom*d+t[1],anchorPointX:v.x,anchorPointY:v.y});return g&&g.length?(a.insertCollisionBox(g,u),!0):!1}).forEach(s=>{this.glyphInfoMap[s.id]=s})}initGlyph(){const{iconfont:t=!1}=this.layer.getLayerConfig();t?this.initIconFontTex():this.initTextFont(),this.generateGlyphLayout(t)}updateTexture(){const{createTexture2D:t}=this.rendererService,r=this.getFontServiceCanvas();this.textureHeight=r.height,this.texture&&this.texture.destroy(),this.texture=t({data:r,mag:q.LINEAR,min:q.LINEAR,width:r.width,height:r.height}),this.textures=[this.texture]}reBuildModel(){var t=this;return Pe(function*(){t.filterGlyphs();const r=yield t.layer.buildLayerModel({moduleName:"pointText",vertexShader:f$,fragmentShader:h$,triangulation:d$.bind(t),defines:t.getDefines(),inject:t.getInject(),depth:{enable:!1}});t.layer.models=[r]})()}}const x4t={fillImage:a4t,fill:mJ,radar:f4t,image:yJ,normal:_J,simplePoint:W5t,extrude:gJ,text:wJ,earthFill:Q5t,earthExtrude:Z5t},b4t=x4t;class mC extends b_{constructor(...t){super(...t),z(this,"type","PointLayer"),z(this,"enableShaderEncodeStyles",["stroke","offsets","opacity","rotation"]),z(this,"enableDataEncodeStyles",["textOffset","textAnchor"]),z(this,"defaultSourceConfig",{data:[],options:{parser:{type:"json",x:"lng",y:"lat"}}})}buildModels(){var t=this;return Pe(function*(){const r=t.getModelType();t.layerModel&&t.layerModel.clearModels(),t.layerModel=new b4t[r](t),yield t.initLayerModels()})()}rebuildModels(){var t=this;return Pe(function*(){yield t.buildModels()})()}getModelTypeWillEmptyData(){if(this.shapeOption){const{field:t,values:r}=this.shapeOption,{shape2d:n}=this.getLayerConfig(),i=this.iconService.getIconMap();if(t&&(n==null?void 0:n.indexOf(t))!==-1)return"fill";if(r==="text")return"text";if(r&&r instanceof Array){for(const a of r)if(typeof a=="string"&&i.hasOwnProperty(a))return"image"}}return"normal"}getDefaultConfig(){const t=this.getModelType();return{fillImage:{},normal:{blend:"additive"},radar:{},simplePoint:{},fill:{blend:"normal"},extrude:{},image:{},text:{blend:"normal"},tile:{},tileText:{},earthFill:{},earthExtrude:{}}[t]}getModelType(){const t=this.getEncodedData(),{shape2d:r,shape3d:n,billboard:i=!0}=this.getLayerConfig(),a=this.iconService.getIconMap(),o=t.find(s=>s.hasOwnProperty("shape"));if(o){const s=o.shape;return s==="dot"?"normal":s==="simple"?"simplePoint":s==="radar"?"radar":this.layerType==="fillImage"||i===!1?"fillImage":(r==null?void 0:r.indexOf(s))!==-1?this.mapService.version==="GLOBEL"?"earthFill":"fill":(n==null?void 0:n.indexOf(s))!==-1?this.mapService.version==="GLOBEL"?"earthExtrude":"extrude":a.hasOwnProperty(s)?"image":"text"}else return this.getModelTypeWillEmptyData()}}function E4t(e){return BD.apply(this,arguments)}function BD(){return BD=Pe(function*(e){if(window.createImageBitmap){const t=yield fetch(e);return yield createImageBitmap(yield t.blob())}else{const t=new window.Image;return new Promise(r=>{t.onload=()=>r(t),t.src=e,t.crossOrigin="Anonymous"})}}),BD.apply(this,arguments)}const w4t=`layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // 默认不固定
  float u_raisingHeight;
};

in vec4 v_Color;
#pragma include "scene_uniforms"
#pragma include "picking"
out vec4 outputColor;
void main() {

     // top face
    if(u_topsurface < 1.0) {
      discard;
    }

    outputColor = v_Color;
  
  outputColor = filterColor(outputColor);
}
`,C4t=`
layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // 默认不固定
  float u_raisingHeight;
};

in vec4 v_Color;
in vec3 v_uvs;
in vec2 v_texture_data;
out vec4 outputColor;

#pragma include "scene_uniforms"
#pragma include "picking"

void main() {
  float isSide =  v_texture_data.x;
  float sidey = v_uvs[2];
  float lightWeight = v_texture_data.y;

  // Tip: 部分机型 GPU 计算精度兼容
  if(isSide < 0.999) {
    // side face
    if(u_sidesurface < 1.0) {
      discard;
    }
    
    if( u_linearColor == 1.0) {
      // side use linear
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      outputColor = linearColor;
    } else {
      // side notuse linear
       outputColor = v_Color;
    }
  } else {
    // top face
    if(u_topsurface < 1.0) {
      discard;
    }
    outputColor = v_Color;
  }

  outputColor = filterColorAlpha(outputColor, lightWeight);
}
`,S4t=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;
layout(location = ATTRIBUTE_LOCATION_UV) in vec3 a_uvs;

layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // 默认不固定
  float u_raisingHeight;
};

out vec4 v_Color;
out vec3 v_uvs;
out vec2 v_texture_data;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  v_uvs = a_uvs;
  // cal style mapping - 数据纹理映射部分的计算
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos, a_Position64Low);

  if (u_heightfixed > 0.0) {
    // 判断几何体是否固定高度
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;
    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  float lightWeight = calc_lighting(project_pos);
  v_texture_data = vec2(a_Position.z, lightWeight);

  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w * opacity);

  setPickingColor(a_PickingColor);
}
`,T4t=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;
layout(location = ATTRIBUTE_LOCATION_UV) in vec3 a_uvs;

layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // 默认不固定
  float u_raisingHeight;
};

out vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  float isSide = a_Position.z;
  float topU = a_uvs[0];
  float topV = 1.0 - a_uvs[1];
  float sidey = a_uvs[2];

  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);

  vec4 project_pos = project_position(pos, a_Position64Low);
  float lightWeight = calc_lighting(project_pos);

  if (u_heightfixed > 0.0) {
    // 判断几何体是否固定高度
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

 gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  // Tip: 部分机型 GPU 计算精度兼容
  if (isSide < 0.999) {
    // side face
    // if(u_sidesurface < 1.0) {
    //   discard;
    // }

    if (u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      v_Color = linearColor;
    } else {
      v_Color = a_Color;
    }

  } else {
    v_Color = a_Color;
  }

  v_Color = vec4(v_Color.rgb * lightWeight, v_Color.w * opacity);

  setPickingColor(a_PickingColor);
}
`,A4t=`uniform sampler2D u_texture;

layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // 默认不固定
  float u_raisingHeight;
};

in vec4 v_Color;
in vec3 v_uvs;
in vec2 v_texture_data;

#pragma include "scene_uniforms"
#pragma include "picking"

out vec4 outputColor;

void main() {
  float opacity = u_opacity;
  float isSide = v_texture_data.x;
  float lightWeight = v_texture_data.y;
  float topU = v_uvs[0];
  float topV = 1.0 - v_uvs[1];
  float sidey = v_uvs[2];

  outputColor = texture(SAMPLER_2D(u_texture), vec2(topU, topV));
  // Tip: 部分机型 GPU 计算精度兼容
  if (isSide < 0.999) {// 是否是边缘
    // side face
    if (u_sidesurface < 1.0) {
      discard;
    }

    if (u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      outputColor = linearColor;
    } else {
      outputColor = v_Color;
    }
  } else {
     // top face
    if (u_topsurface < 1.0) {
      discard;
    }
  }
  
  outputColor.a *= opacity;
  outputColor = filterColor(outputColor);
}
`,M4t=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;
layout(location = ATTRIBUTE_LOCATION_UV) in vec3 a_uvs;

layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // 默认不固定
  float u_raisingHeight;
};

out vec4 v_Color;
out vec3 v_uvs;
out vec2 v_texture_data;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos, a_Position64Low);
  float lightWeight = calc_lighting(project_pos);
  v_uvs = a_uvs;
  v_Color = a_Color;
  v_Color.a *= opacity;

  v_texture_data = vec2(a_Position.z, lightWeight);

  if (u_heightfixed > 0.0) {
    // 判断几何体是否固定高度
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}
`;class R4t extends Ua{constructor(...t){super(...t),z(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,NORMAL:10,UV:11})}getUninforms(){const t=this.getCommonUniformsInfo(),r=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),Ce(Ce({},t.uniformsOption),r.uniformsOption)}getCommonUniformsInfo(){const{mapTexture:t,heightfixed:r=!1,raisingHeight:n=0,topsurface:i=!0,sidesurface:a=!0,sourceColor:o,targetColor:s}=this.layer.getLayerConfig();let l=0,u=[1,1,1,1],c=[1,1,1,1];o&&s&&(u=Qa(o),c=Qa(s),l=1);const f={u_sourceColor:u,u_targetColor:c,u_linearColor:l,u_topsurface:Number(i),u_sidesurface:Number(a),u_heightfixed:Number(r),u_raisingHeight:Number(n)};return t&&this.texture&&(f.u_texture=this.texture,this.textures=[this.texture]),this.getUniformsBufferInfo(f)}initModels(){var t=this;return Pe(function*(){return yield t.loadTexture(),t.buildModels()})()}buildModels(){var t=this;return Pe(function*(){const{frag:r,vert:n,type:i}=t.getShaders();return t.initUniformsBuffer(),[yield t.layer.buildLayerModel({moduleName:i,vertexShader:n,fragmentShader:r,depth:{enable:!0},defines:t.getDefines(),inject:t.getInject(),triangulation:fJ})]})()}getShaders(){const{pickLight:t,mapTexture:r}=this.layer.getLayerConfig();return r?{frag:A4t,vert:M4t,type:"polygonExtrudeTexture"}:t?{frag:C4t,vert:S4t,type:"polygonExtrudePickLight"}:{frag:w4t,vert:T4t,type:"polygonExtrude"}}clearModels(){var t;(t=this.texture)===null||t===void 0||t.destroy(),this.textures=[]}registerBuiltinAttributes(){const t=this.layer.getSource().extent,r=t[2]-t[0],n=t[3]-t[1];this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uvs",type:Qr.Attribute,descriptor:{name:"a_uvs",shaderLocation:this.attributeLocation.UV,buffer:{usage:q.STATIC_DRAW,data:[],type:q.FLOAT},size:3,update:(i,a,o)=>{const s=o[0],l=o[1];return[(s-t[0])/r,(l-t[1])/n,o[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Qr.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:q.STATIC_DRAW,data:[],type:q.FLOAT},size:3,update:(i,a,o,s,l)=>l}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Qr.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:1,update:i=>{const{size:a=10}=i;return Array.isArray(a)?[a[0]]:[a]}}})}loadTexture(){var t=this;return Pe(function*(){const{mapTexture:r}=t.layer.getLayerConfig(),{createTexture2D:n}=t.rendererService;if(t.texture=n({height:1,width:1}),r){const i=yield E4t(r);t.texture=n({data:i,width:i.width,height:i.height,wrapS:q.CLAMP_TO_EDGE,wrapT:q.CLAMP_TO_EDGE,min:q.LINEAR,mag:q.LINEAR})}})()}}const I4t=`
in vec4 v_Color;
#pragma include "scene_uniforms"
#pragma include "picking"
out vec4 outputColor;
void main() {

  outputColor = v_Color;
  outputColor = filterColor(outputColor);
}
`,L4t=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;

out vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size + (1.0 - a_Position.z) * extrusionBase, 1.0);

  vec4 project_pos = project_position(pos, a_Position64Low);
  float lightWeight = calc_lighting(project_pos);
  v_Color = a_Color;
  v_Color = vec4(v_Color.rgb * lightWeight, v_Color.w * opacity);

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}
`;class O4t extends Ua{constructor(...t){super(...t),z(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,NORMAL:10,EXTRUSION_BASE:11})}getUninforms(){const t=this.getCommonUniformsInfo(),r=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),Ce(Ce({},t.uniformsOption),r.uniformsOption)}getCommonUniformsInfo(){const t={};return this.getUniformsBufferInfo(t)}initModels(){var t=this;return Pe(function*(){return t.buildModels()})()}buildModels(){var t=this;return Pe(function*(){const{frag:r,vert:n,type:i}=t.getShaders();return t.initUniformsBuffer(),[yield t.layer.buildLayerModel({moduleName:i,vertexShader:n,fragmentShader:r,defines:t.getDefines(),inject:t.getInject(),triangulation:fJ,depth:{enable:!0}})]})()}getShaders(){return{frag:I4t,vert:L4t,type:"polygonExtrude"}}clearModels(){var t;(t=this.texture)===null||t===void 0||t.destroy()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Qr.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:q.STATIC_DRAW,data:[],type:q.FLOAT},size:3,update:(t,r,n,i,a)=>a}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Qr.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:1,update:t=>{const{size:r=10}=t;return Array.isArray(r)?[r[0]]:[r]}}}),this.styleAttributeService.registerStyleAttribute({name:"extrusionBase",type:Qr.Attribute,descriptor:{name:"a_ExtrusionBase",shaderLocation:this.attributeLocation.EXTRUSION_BASE,buffer:{usage:q.STATIC_DRAW,data:[],type:q.FLOAT},size:1,update:t=>{const{extrusionBase:r=0}=t;return[r]}}})}}const P4t=`in vec4 v_color;
#pragma include "scene_uniforms"
#pragma include "picking"
out vec4 outputColor;
void main() {
  outputColor = v_color;
  outputColor = filterColor(outputColor);
}
`,D4t=`
layout(std140) uniform commonUniforms {
  float u_raisingHeight;
  float u_opacitylinear;
  float u_dir;
};

in vec4 v_color;
in vec3 v_linear;
in vec2 v_pos;
out vec4 outputColor;
#pragma include "scene_uniforms"
#pragma include "picking"

void main() {
  outputColor = v_color;
  if (u_opacitylinear > 0.0) {
    outputColor.a *= u_dir == 1.0 ? 1.0 - length(v_pos - v_linear.xy)/v_linear.z : length(v_pos - v_linear.xy)/v_linear.z;
  }
  outputColor = filterColor(outputColor);
}
`,F4t=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_LINEAR) in vec3 a_linear;

layout(std140) uniform commonUniforms {
  float u_raisingHeight;
  float u_opacitylinear;
  float u_dir;
};

out vec4 v_color;
out vec3 v_linear;
out vec2 v_pos;

#pragma include "projection"
#pragma include "picking"

void main() {
  if (u_opacitylinear > 0.0) {
    v_linear = a_linear;
    v_pos = a_Position.xy;
  }
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  project_pos.z += u_raisingHeight;

  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  setPickingColor(a_PickingColor);
}
`,B4t=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;

layout(std140) uniform commonUniforms {
  float u_raisingHeight;
};

out vec4 v_color;

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - 数据纹理映射部分的计算

  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);

  project_pos.z += u_raisingHeight;

  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}

`;class N4t extends Ua{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,LINEAR:9})}getUninforms(){const t=this.getCommonUniformsInfo(),r=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),Ce(Ce({},t.uniformsOption),r.uniformsOption)}getCommonUniformsInfo(){const{raisingHeight:t=0,opacityLinear:r={enable:!1,dir:"in"}}=this.layer.getLayerConfig(),n={u_raisingHeight:Number(t),u_opacitylinear:Number(r.enable),u_dir:r.dir==="in"?1:0};return this.getUniformsBufferInfo(n)}initModels(){var t=this;return Pe(function*(){return t.buildModels()})()}buildModels(){var t=this;return Pe(function*(){const{frag:r,vert:n,triangulation:i,type:a}=t.getModelParams();return t.initUniformsBuffer(),t.layer.triangulation=i,[yield t.layer.buildLayerModel({moduleName:a,vertexShader:n,fragmentShader:r,defines:t.getDefines(),inject:t.getInject(),triangulation:i,primitive:q.TRIANGLES,depth:{enable:!1}})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute();const{opacityLinear:t={enable:!1,dir:"in"}}=this.layer.getLayerConfig();t.enable&&this.styleAttributeService.registerStyleAttribute({name:"linear",type:Qr.Attribute,descriptor:{name:"a_linear",shaderLocation:this.attributeLocation.LINEAR,buffer:{usage:q.STATIC_DRAW,data:[],type:q.FLOAT},size:3,update:(r,n,i)=>[i[3],i[4],i[5]]}})}getModelParams(){const{opacityLinear:t={enable:!1}}=this.layer.getLayerConfig();return t.enable?{frag:D4t,vert:F4t,type:"polygonLinear",triangulation:DBt}:{frag:P4t,vert:B4t,type:"polygonFill",triangulation:SS}}}const k4t=`
layout(std140) uniform commonUniforms {
  vec4 u_watercolor;
  vec4 u_watercolor2;
  float u_time;
};

in vec2 v_uv;
in float v_opacity;
out vec4 outputColor;

float coast2water_fadedepth = 0.10;
float large_waveheight      = .750; // change to adjust the "heavy" waves
float large_wavesize        = 3.4;  // factor to adjust the large wave size
float small_waveheight      = 0.6;  // change to adjust the small random waves
float small_wavesize        = 0.5;   // factor to ajust the small wave size
float water_softlight_fact  = 15.;  // range [1..200] (should be << smaller than glossy-fact)
float water_glossylight_fact= 120.; // range [1..200]
float particle_amount       = 70.;

vec3 water_specularcolor    = vec3(1.3, 1.3, 0.9);    // specular Color (RGB) of the water-highlights
#define light                 vec3(-0., sin(u_time*0.5)*.5 + .35, 2.8) // position of the sun

uniform sampler2D u_texture1;
uniform sampler2D u_texture2;
uniform sampler2D u_texture3;

  

float hash( float n ) {
    return fract(sin(n)*43758.5453123);
}

// 2d noise function
float noise1( in vec2 x ) {
  vec2 p  = floor(x);
  vec2 f  = smoothstep(0.0, 1.0, fract(x));
  float n = p.x + p.y*57.0;
  return mix(mix( hash(n+  0.0), hash(n+  1.0),f.x),
    mix( hash(n+ 57.0), hash(n+ 58.0),f.x),f.y);
}

float noise(vec2 p) {
    return texture(SAMPLER_2D(u_texture2),p*vec2(1./256.)).x;
}

vec4 highness(vec2 p) {
    vec4 t = texture(SAMPLER_2D(u_texture1),fract(p));
    float clipped = -2.0-smoothstep(3.,10.,t.a)*6.9-smoothstep(10.,100.,t.a)*89.9-smoothstep(0.,10000.,t.a)*10000.0;
    return clamp(t, 0.0,3.0)+clamp(t/3.0-1.0, 0.0,1.0)+clamp(t/16.0-1.0, 0.0,1.0);
}

float height_map( vec2 p ) {
    vec4 height=highness(p);
    /*
    height = -0.5+
        0.5*smoothstep(-100.,0.,-height)+
        2.75*smoothstep(0.,2.,height)+
        1.75*smoothstep(2.,4.,height)+
        2.75*smoothstep(4.,16.,height)+
        1.5*smoothstep(16.,1000.,height);
    */

    mat2 m = mat2( 0.9563*1.4,  -0.2924*1.4,  0.2924*1.4,  0.9563*1.4 );
    //p = p*6.;
    float f = 0.6000*noise1( p ); p = m*p*1.1*6.;
    f += 0.2500*noise( p ); p = m*p*1.32;
    f += 0.1666*noise( p ); p = m*p*1.11;
    f += 0.0834*noise( p ); p = m*p*1.12;
    f += 0.0634*noise( p ); p = m*p*1.13;
    f += 0.0444*noise( p ); p = m*p*1.14;
    f += 0.0274*noise( p ); p = m*p*1.15;
    f += 0.0134*noise( p ); p = m*p*1.16;
    f += 0.0104*noise( p ); p = m*p*1.17;
    f += 0.0084*noise( p );
    f = .25*f+dot(height,vec4(-.03125,-.125,.25,.25))*.5;
        const float FLAT_LEVEL = 0.92525;
        //f = f*0.25+height*0.75;
    if (f<FLAT_LEVEL)
        f = f;
    else
        f = pow((f-FLAT_LEVEL)/(1.-FLAT_LEVEL), 2.)*(1.-FLAT_LEVEL)*2.0+FLAT_LEVEL; // makes a smooth coast-increase
    return clamp(f, 0., 10.);
}

vec3 plasma_quintic( float x ) {
    x = clamp( x, 0.0, 1.0);
    vec4 x1 = vec4( 1.0, x, x * x, x * x * x ); // 1 x x2 x3
    vec4 x2 = x1 * x1.w * x; // x4 x5 x6 x7
    return vec3(
        dot( x1.xyzw, vec4( +0.063861086, +1.992659096, -1.023901152, -0.490832805 ) ) + dot( x2.xy, vec2( +1.308442123, -0.914547012 ) ),
        dot( x1.xyzw, vec4( +0.049718590, -0.791144343, +2.892305078, +0.811726816 ) ) + dot( x2.xy, vec2( -4.686502417, +2.717794514 ) ),
        dot( x1.xyzw, vec4( +0.513275779, +1.580255060, -5.164414457, +4.559573646 ) ) + dot( x2.xy, vec2( -1.916810682, +0.570638854 ) ) );
}

vec4 color(vec2 p){
    vec4 c1 = vec4(1.7,1.6,.9,1);
    vec4 c2 = vec4(.2,.94,.1,1);
    vec4 c3 = vec4(.3,.2,.0,1);
    vec4 c4 = vec4(.99,.99,1.6,1);
    vec4 v = highness(p);
    float los = smoothstep(0.1,1.1,v.b);
    float his = smoothstep(3.5,6.5,v.b);
    float ces = smoothstep(1.,5.,v.a);
    vec4 lo = mix(c1,c2,los);
    vec4 hi = mix(c3,c4,his);
    vec4 ce = mix(lo,hi,ces);

    return vec4(plasma_quintic(ces),1).ragb;
}

vec3 terrain_map( vec2 p )
{
  return color(p).rgb*0.75+0.25*vec3(0.7, .55, .4)+texture(SAMPLER_2D(u_texture3), fract(p*5.)).rgb*.5; // test-terrain is simply 'sandstone'
}

const mat2 m = mat2( 0.72, -1.60,  1.60,  0.72 );

float water_map( vec2 p, float height ) {
    vec2 p2 = p*large_wavesize;
    vec2 shift1 = 0.001*vec2( u_time*160.0*2.0, u_time*120.0*2.0 );
    vec2 shift2 = 0.001*vec2( u_time*190.0*2.0, -u_time*130.0*2.0 );

    // coarse crossing 'ocean' waves...
    float f = 0.6000*noise( p );
    f += 0.2500*noise( p*m );
    f += 0.1666*noise( p*m*m );
    float wave = sin(p2.x*0.622+p2.y*0.622+shift2.x*4.269)*large_waveheight*f*height*height ;

    p *= small_wavesize;
    f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<9; i++)
    { p = m*p*.947; f -= amp*abs(sin((noise( p+shift1*s )-.5)*2.)); amp = amp*.59; s*=-1.329; }
    
    return wave+f*small_waveheight;
}

float nautic(vec2 p) {
    p *= 18.;
    float f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*abs(smoothstep(0., 1., noise( p+u_time*s ))-.5); amp = amp*.5; s*=-1.227; }
    return pow(1.-f, 5.);
}

float particles(vec2 p) {
    p *= 200.;
    float f = 0.;
    float amp = 1.0, s = 1.5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*noise( p+u_time*s ); amp = amp*.5; s*=-1.227; }
    return pow(f*.35, 7.)*particle_amount;
}

float test_shadow( vec2 xy, float height) {
    vec3 r0 = vec3(xy, height);
    vec3 rd = normalize( light - r0 );
    
    float hit = 1.0;
    float t   = 0.001;
    for (int j=1; j<25; j++)
    {
        vec3 p = r0 + t*rd;
        float h = height_map( p.xy );
        float height_diff = p.z - h;
        if (height_diff<0.0)
        {
            return 0.0;
        }
        t += 0.01+height_diff*.02;
        hit = min(hit, 2.*height_diff/t); // soft shaddow   
    }
    return hit;
}

vec3 CalcTerrain(vec2 uv, float height) {
    vec3 col = terrain_map( uv );
    vec2 iResolution = vec2(512.);
    float h1 = height_map(uv-vec2(0., 0.5)/ iResolution.xy);
    float h2 = height_map(uv+vec2(0., 0.5)/ iResolution.xy);
    float h3 = height_map(uv-vec2(0.5, 0.)/ iResolution.xy);
    float h4 = height_map(uv+vec2(0.5, 0.)/ iResolution.xy);
    vec3 norm = normalize(vec3(h3-h4, h1-h2, 1.));
    vec3 r0 = vec3(uv, height);
    vec3 rd = normalize( light - r0 );
    float grad = dot(norm, rd);
    col *= grad+pow(grad, 8.);
    float terrainshade = test_shadow( uv, height );
    col = mix(col*.25, col, terrainshade);
    return col;
}


void main() {
  vec3 watercolor = u_watercolor.rgb;
  vec3 watercolor2 = u_watercolor2.rgb;
  vec2 uv = v_uv;
  float WATER_LEVEL = 0.84; // Water level (range: 0.0 - 2.0)
  float deepwater_fadedepth   = 0.4 + coast2water_fadedepth;
  float height = height_map( uv );
  vec3 col;

    float waveheight = clamp(WATER_LEVEL*3.-1.5, 0., 1.);
    float level = WATER_LEVEL + .2*water_map(uv*15. + vec2(u_time*.1), waveheight);
    if (height > level)
    {
        col = CalcTerrain(uv, height);
    }
    if (height <= level)
    {
        vec2 dif = vec2(.0, .01);
        vec2 pos = uv*15. + vec2(u_time*.01);
        float h1 = water_map(pos-dif,waveheight);
        float h2 = water_map(pos+dif,waveheight);
        float h3 = water_map(pos-dif.yx,waveheight);
        float h4 = water_map(pos+dif.yx,waveheight);
        vec3 normwater = normalize(vec3(h3-h4, h1-h2, .125)); // norm-vector of the 'bumpy' water-plane
        uv += normwater.xy*.002*(level-height);
        
        col = CalcTerrain(uv, height);

        float coastfade = clamp((level-height)/coast2water_fadedepth, 0., 1.);
        float coastfade2= clamp((level-height)/deepwater_fadedepth, 0., 1.);
        float intensity = col.r*.2126+col.g*.7152+col.b*.0722;
        watercolor = mix(watercolor*intensity, watercolor2, smoothstep(0., 1., coastfade2));

        vec3 r0 = vec3(uv, WATER_LEVEL);
        vec3 rd = normalize( light - r0 ); // ray-direction to the light from water-position
        float grad     = dot(normwater, rd); // dot-product of norm-vector and light-direction
        float specular = pow(grad, water_softlight_fact);  // used for soft highlights                          
        float specular2= pow(grad, water_glossylight_fact); // used for glossy highlights
        float gradpos  = dot(vec3(0., 0., 1.), rd);
        float specular1= smoothstep(0., 1., pow(gradpos, 5.));  // used for diffusity (some darker corona around light's specular reflections...)                          
        float watershade  = test_shadow( uv, level );
        watercolor *= 2.2+watershade;
        watercolor += (.2+.8*watershade) * ((grad-1.0)*.5+specular) * .25;
        watercolor /= (1.+specular1*1.25);
        watercolor += watershade*specular2*water_specularcolor;
        watercolor += watershade*coastfade*(1.-coastfade2)*(vec3(.5, .6, .7)*nautic(uv)+vec3(1., 1., 1.)*particles(uv));
        
        col = mix(col, watercolor, coastfade);
    }
    
  outputColor = vec4(col, v_opacity);  
}
`,z4t=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_uv;

layout(std140) uniform commonUniforms {
  vec4 u_watercolor;
  vec4 u_watercolor2;
  float u_time;
};

out vec2 v_uv;
out float v_opacity;

#pragma include "projection"

void main() {
  v_uv = a_uv;
  v_opacity = opacity;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
}

`;class U4t extends Ua{constructor(...t){super(...t),z(this,"texture1",void 0),z(this,"texture2",void 0),z(this,"texture3",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getUninforms(){const t=this.getCommonUniformsInfo(),r=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),Ce(Ce({},t.uniformsOption),r.uniformsOption)}getCommonUniformsInfo(){const{watercolor:t="#6D99A8",watercolor2:r="#0F121C"}=this.layer.getLayerConfig(),n={u_watercolor:Qa(t),u_watercolor2:Qa(r),u_time:this.layer.getLayerAnimateTime(),u_texture1:this.texture1,u_texture2:this.texture2,u_texture3:this.texture3};return this.textures=[this.texture1,this.texture2,this.texture3],this.getUniformsBufferInfo(n)}getAnimateUniforms(){return{u_time:this.layer.getLayerAnimateTime()}}initModels(){var t=this;return Pe(function*(){return t.loadTexture(),t.buildModels()})()}buildModels(){var t=this;return Pe(function*(){return t.initUniformsBuffer(),[yield t.layer.buildLayerModel({moduleName:"polygonOcean",vertexShader:z4t,fragmentShader:k4t,defines:t.getDefines(),inject:t.getInject(),triangulation:SS,primitive:q.TRIANGLES,depth:{enable:!1}})]})()}clearModels(){var t,r,n;(t=this.texture1)===null||t===void 0||t.destroy(),(r=this.texture2)===null||r===void 0||r.destroy(),(n=this.texture3)===null||n===void 0||n.destroy()}registerBuiltinAttributes(){const t=this.layer.getSource().extent,[r,n,i,a]=t,o=i-r,s=a-n;this.styleAttributeService.registerStyleAttribute({name:"oceanUv",type:Qr.Attribute,descriptor:{name:"a_uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:q.STATIC_DRAW,data:[],type:q.FLOAT},size:2,update:(l,u,c)=>{const[f,d]=c;return[(f-r)/o,(d-n)/s]}}})}loadTexture(){const{createTexture2D:t}=this.rendererService,r={height:0,width:0};this.texture1=t(r),this.texture2=t(r),this.texture3=t(r),n(a=>{this.texture1=i(a[0]),this.texture2=i(a[1]),this.texture3=i(a[2]),this.layerService.reRender()});function n(a){let o=0;const s=[];["https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*MJ22QbpuCzIAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*-z2HSIVDsHIAAAAAAAAAAAAAARQnAQ"].map(u=>{const c=new Image;c.crossOrigin="",c.src=u,s.push(c),c.onload=()=>{o++,o===3&&a(s)}})}function i(a){return t({data:a,width:a.width,height:a.height,wrapS:q.MIRRORED_REPEAT,wrapT:q.MIRRORED_REPEAT,min:q.LINEAR,mag:q.LINEAR})}}}const $4t=`uniform sampler2D u_texture;
layout(std140) uniform commonUniforms {
  float u_speed;
  float u_time;
};

out vec4 outputColor;


in vec4 v_Color;
in vec2 v_uv;

float rand(vec2 n) { return 0.5 + 0.5 * fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453); }

float water(vec3 p) {
  float t = u_time * u_speed;
  p.z += t * 2.; p.x += t * 2.;
  vec3 c1 = texture(SAMPLER_2D(u_texture), p.xz / 30.).xyz;
  p.z += t * 3.; p.x += t * 0.52;
  vec3 c2 = texture(SAMPLER_2D(u_texture), p.xz / 30.).xyz;
  p.z += t * 4.; p.x += t * 0.8;
  vec3 c3 = texture(SAMPLER_2D(u_texture), p.xz / 30.).xyz;
  c1 += c2 - c3;
  float z = (c1.x + c1.y + c1.z) / 3.;
  return p.y + z / 4.;
}

float map(vec3 p) {
  float d = 100.0;
  d = water(p);
  return d;
}

float intersect(vec3 ro, vec3 rd) {
  float d = 0.0;
  for (int i = 0; i <= 100; i++) {
    float h = map(ro + rd * d);
    if (h < 0.1) return  d;
    d += h;
  }
  return 0.0;
}

vec3 norm(vec3 p) {
  float eps = .1;
  return normalize(vec3(
    map(p + vec3(eps, 0, 0)) - map(p + vec3(-eps, 0, 0)),
    map(p + vec3(0, eps, 0)) - map(p + vec3(0, -eps, 0)),
    map(p + vec3(0, 0, eps)) - map(p + vec3(0, 0, -eps))
  ));
} 

float calSpc() {
  vec3 l1 = normalize(vec3(1, 1, 1));
  vec3 ro = vec3(-3, 20, -8);
  vec3 rc = vec3(0, 0, 0);
  vec3 ww = normalize(rc - ro);
  vec3 uu = normalize(cross(vec3(0,1,0), ww));
  vec3 vv = normalize(cross(rc - ro, uu));
  vec3 rd = normalize(uu * v_uv.x + vv * v_uv.y + ww);
  float d = intersect(ro, rd);
  vec3 p = ro + rd * d;
  vec3 n = norm(p);
  float spc = pow(max(0.0, dot(reflect(l1, n), rd)), 30.0);
  return spc;
}

void main() {

  outputColor = v_Color;
  float spc = calSpc();
  outputColor += spc * 0.4;
}
`,H4t=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_uv;

layout(std140) uniform commonUniforms {
  float u_speed;
  float u_time;
};
out vec4 v_Color;
out vec2 v_uv;

#pragma include "projection"

void main() {
  v_uv = a_uv;
  v_Color = a_Color;
  v_Color.a *= opacity;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
}

`;class V4t extends Ua{constructor(...t){super(...t),z(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getUninforms(){const t=this.getCommonUniformsInfo(),r=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),Ce(Ce({},t.uniformsOption),r.uniformsOption)}getCommonUniformsInfo(){const{speed:t=.5}=this.layer.getLayerConfig(),r={u_speed:t,u_time:this.layer.getLayerAnimateTime(),u_texture:this.texture};return this.textures=[this.texture],this.getUniformsBufferInfo(r)}getAnimateUniforms(){return{u_time:this.layer.getLayerAnimateTime()}}initModels(){var t=this;return Pe(function*(){return t.loadTexture(),t.buildModels()})()}buildModels(){var t=this;return Pe(function*(){return t.initUniformsBuffer(),[yield t.layer.buildLayerModel({moduleName:"polygonWater",vertexShader:H4t,fragmentShader:$4t,triangulation:SS,defines:t.getDefines(),inject:t.getInject(),primitive:q.TRIANGLES,depth:{enable:!1},pickingEnabled:!1,diagnosticDerivativeUniformityEnabled:!1})]})()}clearModels(){var t;(t=this.texture)===null||t===void 0||t.destroy()}registerBuiltinAttributes(){const t=this.layer.getSource().extent,[r,n,i,a]=t,o=i-r,s=a-n;this.styleAttributeService.registerStyleAttribute({name:"waterUv",type:Qr.Attribute,descriptor:{name:"a_uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:q.STATIC_DRAW,data:[],type:q.FLOAT},size:2,update:(l,u,c)=>{const[f,d]=c;return[(f-r)/o,(d-n)/s]}}})}loadTexture(){const{waterTexture:t}=this.layer.getLayerConfig(),{createTexture2D:r}=this.rendererService;this.texture=r({height:1,width:1});const n=new Image;n.crossOrigin="",t?(console.warn("L7 recommend：https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ"),n.src=t):n.src="https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ",n.onload=()=>{this.texture=r({data:n,width:n.width,height:n.height,wrapS:q.MIRRORED_REPEAT,wrapT:q.MIRRORED_REPEAT,min:q.LINEAR,mag:q.LINEAR}),this.layerService.reRender()}}}const G4t={fill:N4t,line:vJ,extrude:R4t,text:wJ,point_fill:mJ,point_image:yJ,point_normal:_J,point_extrude:gJ,water:V4t,ocean:U4t,extrusion:O4t},W4t=G4t;class OM extends b_{constructor(...t){super(...t),z(this,"type","PolygonLayer"),z(this,"enableShaderEncodeStyles",["opacity","extrusionBase","rotation","offsets","stroke"])}buildModels(){var t=this;return Pe(function*(){const r=t.getModelType();t.layerModel=new W4t[r](t),yield t.initLayerModels()})()}getModelType(){var t;const r=this.styleAttributeService.getLayerStyleAttribute("shape"),n=r==null||(t=r.scale)===null||t===void 0?void 0:t.field;return n==="fill"||!n?"fill":n==="extrude"?"extrude":n==="extrusion"?"extrusion":n==="water"?"water":n==="ocean"?"ocean":n==="line"?"line":this.getPointModelType()}getPointModelType(){const t=this.getEncodedData(),{shape2d:r,shape3d:n}=this.getLayerConfig(),i=this.iconService.getIconMap(),a=t.find(o=>o.hasOwnProperty("shape"));if(a){const o=a.shape;return o==="dot"?"point_normal":(r==null?void 0:r.indexOf(o))!==-1?"point_fill":(n==null?void 0:n.indexOf(o))!==-1?"point_extrude":i.hasOwnProperty(o)?"point_image":"text"}else return"fill"}}const X4t=`layout(std140) uniform commonUniforms {
  vec2 u_domain;
  float u_opacity;
  float u_noDataValue;
  float u_clampLow;
  float u_clampHigh;
};

uniform sampler2D u_rasterTexture;
uniform sampler2D u_colorTexture;

in vec2 v_texCoord;

bool isnan_emu(float x) { return (x > 0.0 || x < 0.0) ? x != x : x != 0.0; }

out vec4 outputColor;

void main() {
  // Can use any component here since u_rasterTexture is under luminance format.
  float value = texture(SAMPLER_2D(u_rasterTexture), vec2(v_texCoord.x, v_texCoord.y)).r;
  if (value == u_noDataValue || isnan_emu(value)) {
    discard;
  } else if ((u_clampLow < 0.5 && value < u_domain[0]) || (u_clampHigh < 0.5 && value > u_domain[1])) {
    discard;
  } else {
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] - u_domain[0]);
    vec4 color = texture(SAMPLER_2D(u_colorTexture), vec2(normalisedValue, 0));
    
    outputColor = color;
    outputColor.a = outputColor.a * u_opacity ;
    if (outputColor.a < 0.01)
      discard;
  }
}
`,j4t=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
  vec2 u_domain;
  float u_opacity;
  float u_noDataValue;
  float u_clampLow;
  float u_clampHigh;
};

out vec2 v_texCoord;

#pragma include "projection"

void main() {
  v_texCoord = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));
}
`;let p$=class extends Ua{constructor(...t){super(...t),z(this,"texture",void 0),z(this,"colorTexture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getUninforms(){const t=this.getCommonUniformsInfo(),r=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),Ce(Ce({},t.uniformsOption),r.uniformsOption)}getCommonUniformsInfo(){const{opacity:t=1,clampLow:r=!0,clampHigh:n=!0,noDataValue:i=-9999999,domain:a,rampColors:o}=this.layer.getLayerConfig(),s=a||A5(o);this.colorTexture=this.layer.textureService.getColorTexture(o,s);const l={u_domain:s,u_opacity:t||1,u_noDataValue:i,u_clampLow:r?1:0,u_clampHigh:(typeof n<"u"?n:r)?1:0,u_rasterTexture:this.texture,u_colorTexture:this.colorTexture};return this.textures=[this.texture,this.colorTexture],this.getUniformsBufferInfo(l)}getRasterData(t){return Pe(function*(){if(Array.isArray(t.data))return{data:t.data,width:t.width,height:t.height};{const{rasterData:r,width:n,height:i}=yield t.data;return{data:Array.from(r),width:n,height:i}}})()}initModels(){var t=this;return Pe(function*(){return t.buildModels()})()}buildModels(){var t=this;return Pe(function*(){t.initUniformsBuffer();const r=t.layer.getSource(),{createTexture2D:n,queryVerdorInfo:i}=t.rendererService,a=r.data.dataArray[0],{data:o,width:s,height:l}=yield t.getRasterData(a);return t.texture=n({data:new Float32Array(o),width:s,height:l,format:i()==="WebGL1"?q.LUMINANCE:q.RED,type:q.FLOAT,alignment:1}),[yield t.layer.buildLayerModel({moduleName:"rasterImageData",vertexShader:j4t,fragmentShader:X4t,defines:t.getDefines(),triangulation:mI,primitive:q.TRIANGLES,depth:{enable:!1},pickingEnabled:!1})]})()}clearModels(){var t,r;(t=this.texture)===null||t===void 0||t.destroy(),(r=this.colorTexture)===null||r===void 0||r.destroy()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Qr.Attribute,descriptor:{shaderLocation:this.attributeLocation.UV,name:"a_Uv",buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:2,update:(t,r,n)=>[n[3],n[4]]}})}};const Y4t=["data"],Z4t=["rasterData"],q4t=`uniform sampler2D u_texture;
layout(std140) uniform commonUniforms {
 vec2 u_rminmax;
 vec2 u_gminmax;
 vec2 u_bminmax;
 float u_opacity;
 float u_noDataValue;
};

in vec2 v_texCoord;

out vec4 outputColor;

void main() {

  vec3 rgb = texture(SAMPLER_2D(u_texture),vec2(v_texCoord.x,v_texCoord.y)).rgb;

  if(rgb == vec3(u_noDataValue)) {
    outputColor = vec4(0.0, 0, 0, 0.0);
  } else {
    outputColor = vec4(rgb.r / (u_rminmax.y -u_rminmax.x), rgb.g /(u_gminmax.y -u_gminmax.x), rgb.b/ (u_bminmax.y - u_bminmax.x), u_opacity);
  }

  if(outputColor.a < 0.01)
    discard;
 
}`,K4t=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
  vec2 u_rminmax;
  vec2 u_gminmax;
  vec2 u_bminmax;
  float u_opacity;
  float u_noDataValue;
};

out vec2 v_texCoord;

#pragma include "projection"

void main() {
  v_texCoord = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));
}
`;class Q4t extends Ua{constructor(...t){super(...t),z(this,"texture",void 0),z(this,"dataOption",{})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getUninforms(){const t=this.getCommonUniformsInfo(),r=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),Ce(Ce({},t.uniformsOption),r.uniformsOption)}getCommonUniformsInfo(){const{opacity:t=1,noDataValue:r=0}=this.layer.getLayerConfig(),{rMinMax:n=[0,255],gMinMax:i=[0,255],bMinMax:a=[0,255]}=this.dataOption,o={u_rminmax:n,u_gminmax:i,u_bminmax:a,u_opacity:t||1,u_noDataValue:r,u_texture:this.texture};return this.textures=[this.texture],this.getUniformsBufferInfo(o)}getRasterData(t){var r=this;return Pe(function*(){if(Array.isArray(t.data)){const{data:o}=t,s=Hf(t,Y4t);return r.dataOption=s,Ce({data:o},s)}const n=yield t.data,{rasterData:i}=n,a=Hf(n,Z4t);return r.dataOption=a,Array.isArray(i)?Ce({data:i},a):Ce({data:Array.from(i)},a)})()}initModels(){var t=this;return Pe(function*(){t.initUniformsBuffer();const r=t.layer.getSource(),{createTexture2D:n}=t.rendererService,i=r.data.dataArray[0],{data:a,width:o,height:s}=yield t.getRasterData(i);return t.texture=n({data:new Float32Array(a),width:o,height:s,format:q.RGB,type:q.FLOAT}),[yield t.layer.buildLayerModel({moduleName:"rasterImageDataRGBA",vertexShader:K4t,fragmentShader:q4t,defines:t.getDefines(),triangulation:mI,primitive:q.TRIANGLES,depth:{enable:!1},pickingEnabled:!1})]})()}buildModels(){var t=this;return Pe(function*(){return t.initModels()})()}clearModels(){var t;(t=this.texture)===null||t===void 0||t.destroy()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Qr.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:2,update:(t,r,n)=>[n[3],n[4]]}})}}const J4t=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;

layout(std140) uniform commonUniforms {
 vec4 u_unpack;
 vec2 u_domain;
 float u_opacity;
 float u_noDataValue;
 float u_clampLow;
 float u_clampHigh;
};

in vec2 v_texCoord;
out vec4 outputColor;


float getElevation(vec2 coord, float bias) {
    // Convert encoded elevation value to meters
    vec4 data =  texture(SAMPLER_2D(u_texture), coord,bias) * 255.0;
    data.a = -1.0;
    return dot(data, u_unpack);
}

vec4 getColor(float value) {
   float normalisedValue =(value- u_domain[0]) / (u_domain[1] - u_domain[0]);
    vec2 coord = vec2(normalisedValue, 0);
    return  texture(SAMPLER_2D(u_colorTexture), coord);
}

void main() {
  float value = getElevation(v_texCoord,0.0);
  if (value == u_noDataValue) {
    outputColor = vec4(0.0, 0, 0, 0.0);
  } else if ((u_clampLow < 0.5 && value < u_domain[0]) || (u_clampHigh < 0.5 && value > u_domain[1])) {
     outputColor = vec4(0.0, 0, 0, 0.0);
  } else {
   
    outputColor = getColor(value);
    outputColor.a =  outputColor.a * u_opacity ;
      if(outputColor.a < 0.01)
      discard;
  }
}
`,tNt=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
  vec4 u_unpack;
  vec2 u_domain;
  float u_opacity;
  float u_noDataValue;
  float u_clampLow;
  float u_clampHigh;
};
out vec2 v_texCoord;
#pragma include "projection"

void main() {
  v_texCoord = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));
}
`;class eNt extends Ua{constructor(...t){super(...t),z(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getCommonUniformsInfo(){const{opacity:t,clampLow:r=!0,clampHigh:n=!0,noDataValue:i=-9999999,domain:a,rampColors:o,colorTexture:s,rScaler:l=6553.6,gScaler:u=25.6,bScaler:c=.1,offset:f=1e4}=this.layer.getLayerConfig(),d=a||A5(o);let v=s;s?this.layer.textureService.setColorTexture(s,o,d):v=this.layer.textureService.getColorTexture(o,d);const g={u_unpack:[l,u,c,f],u_domain:d,u_opacity:t||1,u_noDataValue:i,u_clampLow:r,u_clampHigh:typeof n<"u"?n:r,u_texture:this.texture,u_colorTexture:v};return this.textures=[this.texture,v],this.getUniformsBufferInfo(g)}initModels(){var t=this;return Pe(function*(){t.initUniformsBuffer();const r=t.layer.getSource(),{createTexture2D:n}=t.rendererService,i=yield r.data.images;return t.texture=n({data:i[0],width:i[0].width,height:i[0].height,min:q.LINEAR,mag:q.LINEAR}),[yield t.layer.buildLayerModel({moduleName:"RasterTileDataImage",vertexShader:tNt,fragmentShader:J4t,defines:t.getDefines(),triangulation:mI,primitive:q.TRIANGLES,depth:{enable:!1}})]})()}clearModels(){var t;(t=this.texture)===null||t===void 0||t.destroy()}buildModels(){var t=this;return Pe(function*(){return t.initModels()})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Qr.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:q.DYNAMIC_DRAW,data:[],type:q.FLOAT},size:2,update:(t,r,n)=>[n[3],n[4]]}})}}const rNt={raster:p$,rasterRgb:Q4t,raster3d:p$,rasterTerrainRgb:eNt},nNt=rNt;class p4 extends b_{constructor(...t){super(...t),z(this,"type","RasterLayer")}buildModels(){var t=this;return Pe(function*(){const r=t.getModelType();t.layerModel=new nNt[r](t),yield t.initLayerModels()})()}getDefaultConfig(){const t=this.getModelType();return{raster:{},rasterRgb:{},raster3d:{},rasterTerrainRgb:{}}[t]}getModelType(){switch(this.layerSource.getParserType()){case"raster":return"raster";case"rasterRgb":return"rasterRgb";case"rgb":return"rasterRgb";case"image":return"rasterTerrainRgb";default:return"raster"}}getLegend(t){if(t!=="color")return{type:void 0,field:void 0,items:[]};const r=this.getLayerConfig().rampColors;return pJ(r,t)}}class iNt{constructor({rendererService:t,layerService:r,parent:n}){z(this,"tileResource",new Map),z(this,"rendererService",void 0),z(this,"layerService",void 0),z(this,"parent",void 0),z(this,"layerTiles",[]),this.rendererService=t,this.layerService=r,this.parent=n}get tiles(){return this.layerTiles}hasTile(t){return this.layerTiles.some(r=>r.key===t)}addTile(t){this.layerTiles.push(t)}getTile(t){return this.layerTiles.find(r=>r.key===t)}getVisibleTileBylngLat(t){return this.layerTiles.find(r=>r.isLoaded&&r.visible&&r.lnglatInBounds(t))}removeTile(t){const r=this.layerTiles.findIndex(i=>i.key===t),n=this.layerTiles.splice(r,1);n[0]&&n[0].destroy()}updateTileVisible(t){const r=this.getTile(t.key);if(t.isVisible)if(t.parent){const n=this.isChildrenLoaded(t.parent);r==null||r.updateVisible(n)}else r==null||r.updateVisible(!0);else if(t.parent){const n=this.isChildrenLoaded(t.parent);r==null||r.updateVisible(!n)}else r==null||r.updateVisible(!1)}isParentLoaded(t){const r=t.parent;if(!r)return!0;const n=this.getTile(r==null?void 0:r.key);return!!(n!=null&&n.isLoaded)}isChildrenLoaded(t){const r=t==null?void 0:t.children;return r.length===0?!0:r.every(n=>{const i=this.getTile(n==null?void 0:n.key);return i?(i==null?void 0:i.isLoaded)===!0:!0})}render(){var t=this;return Pe(function*(){const n=t.getRenderLayers().map(function(){var i=Pe(function*(a){yield t.layerService.renderTileLayer(a)});return function(a){return i.apply(this,arguments)}}());yield Promise.all(n)})()}getRenderLayers(){const t=this.layerTiles.filter(n=>n.visible&&n.isLoaded),r=[];return t.map(n=>r.push(...n.getLayers())),r}getLayers(){const t=this.layerTiles.filter(n=>n.isLoaded),r=[];return t.map(n=>r.push(...n.getLayers())),r}getTiles(){return this.layerTiles}destroy(){this.layerTiles.forEach(t=>t.destroy()),this.tileResource.clear()}}/**
 * splaytree v3.1.2
 * Fast Splay tree for Node and browser
 *
 * @author Alexander Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function aNt(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(u){return function(c){return l([u,c])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(a=u[0]&2?i.return:u[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,u[1])).done)return a;switch(i=0,a&&(u=[u[0]&2,a.value]),u[0]){case 0:case 1:a=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,i=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!a||u[1]>a[0]&&u[1]<a[3])){r.label=u[1];break}if(u[0]===6&&r.label<a[1]){r.label=a[1],a=u;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(u);break}a[2]&&r.ops.pop(),r.trys.pop();continue}u=t.call(e,r)}catch(c){u=[6,c],i=0}finally{n=a=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}var Xm=function(){function e(t,r){this.next=null,this.key=t,this.data=r,this.left=null,this.right=null}return e}();function oNt(e,t){return e>t?1:e<t?-1:0}function Em(e,t,r){for(var n=new Xm(null,null),i=n,a=n;;){var o=r(e,t.key);if(o<0){if(t.left===null)break;if(r(e,t.left.key)<0){var s=t.left;if(t.left=s.right,s.right=t,t=s,t.left===null)break}a.left=t,a=t,t=t.left}else if(o>0){if(t.right===null)break;if(r(e,t.right.key)>0){var s=t.right;if(t.right=s.left,s.left=t,t=s,t.right===null)break}i.right=t,i=t,t=t.right}else break}return i.right=t.left,a.left=t.right,t.left=n.right,t.right=n.left,t}function xO(e,t,r,n){var i=new Xm(e,t);if(r===null)return i.left=i.right=null,i;r=Em(e,r,n);var a=n(e,r.key);return a<0?(i.left=r.left,i.right=r,r.left=null):a>=0&&(i.right=r.right,i.left=r,r.right=null),i}function v$(e,t,r){var n=null,i=null;if(t){t=Em(e,t,r);var a=r(t.key,e);a===0?(n=t.left,i=t.right):a<0?(i=t.right,t.right=null,n=t):(n=t.left,t.left=null,i=t)}return{left:n,right:i}}function sNt(e,t,r){return t===null?e:(e===null||(t=Em(e.key,t,r),t.left=e),t)}function ND(e,t,r,n,i){if(e){n(""+t+(r?"└── ":"├── ")+i(e)+`
`);var a=t+(r?"    ":"│   ");e.left&&ND(e.left,a,!1,n,i),e.right&&ND(e.right,a,!0,n,i)}}var v4=function(){function e(t){t===void 0&&(t=oNt),this._root=null,this._size=0,this._comparator=t}return e.prototype.insert=function(t,r){return this._size++,this._root=xO(t,r,this._root,this._comparator)},e.prototype.add=function(t,r){var n=new Xm(t,r);this._root===null&&(n.left=n.right=null,this._size++,this._root=n);var i=this._comparator,a=Em(t,this._root,i),o=i(t,a.key);return o===0?this._root=a:(o<0?(n.left=a.left,n.right=a,a.left=null):o>0&&(n.right=a.right,n.left=a,a.right=null),this._size++,this._root=n),this._root},e.prototype.remove=function(t){this._root=this._remove(t,this._root,this._comparator)},e.prototype._remove=function(t,r,n){var i;if(r===null)return null;r=Em(t,r,n);var a=n(t,r.key);return a===0?(r.left===null?i=r.right:(i=Em(t,r.left,n),i.right=r.right),this._size--,i):r},e.prototype.pop=function(){var t=this._root;if(t){for(;t.left;)t=t.left;return this._root=Em(t.key,this._root,this._comparator),this._root=this._remove(t.key,this._root,this._comparator),{key:t.key,data:t.data}}return null},e.prototype.findStatic=function(t){for(var r=this._root,n=this._comparator;r;){var i=n(t,r.key);if(i===0)return r;i<0?r=r.left:r=r.right}return null},e.prototype.find=function(t){return this._root&&(this._root=Em(t,this._root,this._comparator),this._comparator(t,this._root.key)!==0)?null:this._root},e.prototype.contains=function(t){for(var r=this._root,n=this._comparator;r;){var i=n(t,r.key);if(i===0)return!0;i<0?r=r.left:r=r.right}return!1},e.prototype.forEach=function(t,r){for(var n=this._root,i=[],a=!1;!a;)n!==null?(i.push(n),n=n.left):i.length!==0?(n=i.pop(),t.call(r,n),n=n.right):a=!0;return this},e.prototype.range=function(t,r,n,i){for(var a=[],o=this._comparator,s=this._root,l;a.length!==0||s;)if(s)a.push(s),s=s.left;else{if(s=a.pop(),l=o(s.key,r),l>0)break;if(o(s.key,t)>=0&&n.call(i,s))return this;s=s.right}return this},e.prototype.keys=function(){var t=[];return this.forEach(function(r){var n=r.key;return t.push(n)}),t},e.prototype.values=function(){var t=[];return this.forEach(function(r){var n=r.data;return t.push(n)}),t},e.prototype.min=function(){return this._root?this.minNode(this._root).key:null},e.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},e.prototype.minNode=function(t){if(t===void 0&&(t=this._root),t)for(;t.left;)t=t.left;return t},e.prototype.maxNode=function(t){if(t===void 0&&(t=this._root),t)for(;t.right;)t=t.right;return t},e.prototype.at=function(t){for(var r=this._root,n=!1,i=0,a=[];!n;)if(r)a.push(r),r=r.left;else if(a.length>0){if(r=a.pop(),i===t)return r;i++,r=r.right}else n=!0;return null},e.prototype.next=function(t){var r=this._root,n=null;if(t.right){for(n=t.right;n.left;)n=n.left;return n}for(var i=this._comparator;r;){var a=i(t.key,r.key);if(a===0)break;a<0?(n=r,r=r.left):r=r.right}return n},e.prototype.prev=function(t){var r=this._root,n=null;if(t.left!==null){for(n=t.left;n.right;)n=n.right;return n}for(var i=this._comparator;r;){var a=i(t.key,r.key);if(a===0)break;a<0?r=r.left:(n=r,r=r.right)}return n},e.prototype.clear=function(){return this._root=null,this._size=0,this},e.prototype.toList=function(){return uNt(this._root)},e.prototype.load=function(t,r,n){r===void 0&&(r=[]),n===void 0&&(n=!1);var i=t.length,a=this._comparator;if(n&&UD(t,r,0,i-1,a),this._root===null)this._root=kD(t,r,0,i),this._size=i;else{var o=cNt(this.toList(),lNt(t,r),a);i=this._size+i,this._root=zD({head:o},0,i)}return this},e.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),e.prototype.toString=function(t){t===void 0&&(t=function(n){return String(n.key)});var r=[];return ND(this._root,"",!0,function(n){return r.push(n)},t),r.join("")},e.prototype.update=function(t,r,n){var i=this._comparator,a=v$(t,this._root,i),o=a.left,s=a.right;i(t,r)<0?s=xO(r,n,s,i):o=xO(r,n,o,i),this._root=sNt(o,s,i)},e.prototype.split=function(t){return v$(t,this._root,this._comparator)},e.prototype[Symbol.iterator]=function(){var t,r,n;return aNt(this,function(i){switch(i.label){case 0:t=this._root,r=[],n=!1,i.label=1;case 1:return n?[3,6]:t===null?[3,2]:(r.push(t),t=t.left,[3,5]);case 2:return r.length===0?[3,4]:(t=r.pop(),[4,t]);case 3:return i.sent(),t=t.right,[3,5];case 4:n=!0,i.label=5;case 5:return[3,1];case 6:return[2]}})},e}();function kD(e,t,r,n){var i=n-r;if(i>0){var a=r+Math.floor(i/2),o=e[a],s=t[a],l=new Xm(o,s);return l.left=kD(e,t,r,a),l.right=kD(e,t,a+1,n),l}return null}function lNt(e,t){for(var r=new Xm(null,null),n=r,i=0;i<e.length;i++)n=n.next=new Xm(e[i],t[i]);return n.next=null,r.next}function uNt(e){for(var t=e,r=[],n=!1,i=new Xm(null,null),a=i;!n;)t?(r.push(t),t=t.left):r.length>0?(t=a=a.next=r.pop(),t=t.right):n=!0;return a.next=null,i.next}function zD(e,t,r){var n=r-t;if(n>0){var i=t+Math.floor(n/2),a=zD(e,t,i),o=e.head;return o.left=a,e.head=e.head.next,o.right=zD(e,i+1,r),o}return null}function cNt(e,t,r){for(var n=new Xm(null,null),i=n,a=e,o=t;a!==null&&o!==null;)r(a.key,o.key)<0?(i.next=a,a=a.next):(i.next=o,o=o.next),i=i.next;return a!==null?i.next=a:o!==null&&(i.next=o),n.next}function UD(e,t,r,n,i){if(!(r>=n)){for(var a=e[r+n>>1],o=r-1,s=n+1;;){do o++;while(i(e[o],a)<0);do s--;while(i(e[s],a)>0);if(o>=s)break;var l=e[o];e[o]=e[s],e[s]=l,l=t[o],t[o]=t[s],t[s]=l}UD(e,t,r,s,i),UD(e,t,s+1,n,i)}}const ig=11102230246251565e-32,Ru=134217729,hNt=(3+8*ig)*ig;function bO(e,t,r,n,i){let a,o,s,l,u=t[0],c=n[0],f=0,d=0;c>u==c>-u?(a=u,u=t[++f]):(a=c,c=n[++d]);let v=0;if(f<e&&d<r)for(c>u==c>-u?(o=u+a,s=a-(o-u),u=t[++f]):(o=c+a,s=a-(o-c),c=n[++d]),a=o,s!==0&&(i[v++]=s);f<e&&d<r;)c>u==c>-u?(o=a+u,l=o-a,s=a-(o-l)+(u-l),u=t[++f]):(o=a+c,l=o-a,s=a-(o-l)+(c-l),c=n[++d]),a=o,s!==0&&(i[v++]=s);for(;f<e;)o=a+u,l=o-a,s=a-(o-l)+(u-l),u=t[++f],a=o,s!==0&&(i[v++]=s);for(;d<r;)o=a+c,l=o-a,s=a-(o-l)+(c-l),c=n[++d],a=o,s!==0&&(i[v++]=s);return(a!==0||v===0)&&(i[v++]=a),v}function fNt(e,t){let r=t[0];for(let n=1;n<e;n++)r+=t[n];return r}function TS(e){return new Float64Array(e)}const dNt=(3+16*ig)*ig,pNt=(2+12*ig)*ig,vNt=(9+64*ig)*ig*ig,A1=TS(4),g$=TS(8),m$=TS(12),y$=TS(16),Ku=TS(4);function gNt(e,t,r,n,i,a,o){let s,l,u,c,f,d,v,g,x,w,S,A,M,R,O,N,k,V;const Q=e-i,Y=r-i,X=t-a,tt=n-a;R=Q*tt,d=Ru*Q,v=d-(d-Q),g=Q-v,d=Ru*tt,x=d-(d-tt),w=tt-x,O=g*w-(R-v*x-g*x-v*w),N=X*Y,d=Ru*X,v=d-(d-X),g=X-v,d=Ru*Y,x=d-(d-Y),w=Y-x,k=g*w-(N-v*x-g*x-v*w),S=O-k,f=O-S,A1[0]=O-(S+f)+(f-k),A=R+S,f=A-R,M=R-(A-f)+(S-f),S=M-N,f=M-S,A1[1]=M-(S+f)+(f-N),V=A+S,f=V-A,A1[2]=A-(V-f)+(S-f),A1[3]=V;let it=fNt(4,A1),Et=pNt*o;if(it>=Et||-it>=Et||(f=e-Q,s=e-(Q+f)+(f-i),f=r-Y,u=r-(Y+f)+(f-i),f=t-X,l=t-(X+f)+(f-a),f=n-tt,c=n-(tt+f)+(f-a),s===0&&l===0&&u===0&&c===0)||(Et=vNt*o+hNt*Math.abs(it),it+=Q*c+tt*s-(X*u+Y*l),it>=Et||-it>=Et))return it;R=s*tt,d=Ru*s,v=d-(d-s),g=s-v,d=Ru*tt,x=d-(d-tt),w=tt-x,O=g*w-(R-v*x-g*x-v*w),N=l*Y,d=Ru*l,v=d-(d-l),g=l-v,d=Ru*Y,x=d-(d-Y),w=Y-x,k=g*w-(N-v*x-g*x-v*w),S=O-k,f=O-S,Ku[0]=O-(S+f)+(f-k),A=R+S,f=A-R,M=R-(A-f)+(S-f),S=M-N,f=M-S,Ku[1]=M-(S+f)+(f-N),V=A+S,f=V-A,Ku[2]=A-(V-f)+(S-f),Ku[3]=V;const Tt=bO(4,A1,4,Ku,g$);R=Q*c,d=Ru*Q,v=d-(d-Q),g=Q-v,d=Ru*c,x=d-(d-c),w=c-x,O=g*w-(R-v*x-g*x-v*w),N=X*u,d=Ru*X,v=d-(d-X),g=X-v,d=Ru*u,x=d-(d-u),w=u-x,k=g*w-(N-v*x-g*x-v*w),S=O-k,f=O-S,Ku[0]=O-(S+f)+(f-k),A=R+S,f=A-R,M=R-(A-f)+(S-f),S=M-N,f=M-S,Ku[1]=M-(S+f)+(f-N),V=A+S,f=V-A,Ku[2]=A-(V-f)+(S-f),Ku[3]=V;const pt=bO(Tt,g$,4,Ku,m$);R=s*c,d=Ru*s,v=d-(d-s),g=s-v,d=Ru*c,x=d-(d-c),w=c-x,O=g*w-(R-v*x-g*x-v*w),N=l*u,d=Ru*l,v=d-(d-l),g=l-v,d=Ru*u,x=d-(d-u),w=u-x,k=g*w-(N-v*x-g*x-v*w),S=O-k,f=O-S,Ku[0]=O-(S+f)+(f-k),A=R+S,f=A-R,M=R-(A-f)+(S-f),S=M-N,f=M-S,Ku[1]=M-(S+f)+(f-N),V=A+S,f=V-A,Ku[2]=A-(V-f)+(S-f),Ku[3]=V;const kt=bO(pt,m$,4,Ku,y$);return y$[kt-1]}function mNt(e,t,r,n,i,a){const o=(t-a)*(r-i),s=(e-i)*(n-a),l=o-s,u=Math.abs(o+s);return Math.abs(l)>=dNt*u?l:-gNt(e,t,r,n,i,a,u)}const NE=(e,t)=>e.ll.x<=t.x&&t.x<=e.ur.x&&e.ll.y<=t.y&&t.y<=e.ur.y,$D=(e,t)=>{if(t.ur.x<e.ll.x||e.ur.x<t.ll.x||t.ur.y<e.ll.y||e.ur.y<t.ll.y)return null;const r=e.ll.x<t.ll.x?t.ll.x:e.ll.x,n=e.ur.x<t.ur.x?e.ur.x:t.ur.x,i=e.ll.y<t.ll.y?t.ll.y:e.ll.y,a=e.ur.y<t.ur.y?e.ur.y:t.ur.y;return{ll:{x:r,y:i},ur:{x:n,y:a}}};let Tm=Number.EPSILON;Tm===void 0&&(Tm=Math.pow(2,-52));const yNt=Tm*Tm,_$=(e,t)=>{if(-Tm<e&&e<Tm&&-Tm<t&&t<Tm)return 0;const r=e-t;return r*r<yNt*e*t?0:e<t?-1:1};class _Nt{constructor(){this.reset()}reset(){this.xRounder=new x$,this.yRounder=new x$}round(t,r){return{x:this.xRounder.round(t),y:this.yRounder.round(r)}}}class x${constructor(){this.tree=new v4,this.round(0)}round(t){const r=this.tree.add(t),n=this.tree.prev(r);if(n!==null&&_$(r.key,n.key)===0)return this.tree.remove(t),n.key;const i=this.tree.next(r);return i!==null&&_$(r.key,i.key)===0?(this.tree.remove(t),i.key):t}}const yC=new _Nt,AA=(e,t)=>e.x*t.y-e.y*t.x,CJ=(e,t)=>e.x*t.x+e.y*t.y,b$=(e,t,r)=>{const n=mNt(e.x,e.y,t.x,t.y,r.x,r.y);return n>0?-1:n<0?1:0},PM=e=>Math.sqrt(CJ(e,e)),xNt=(e,t,r)=>{const n={x:t.x-e.x,y:t.y-e.y},i={x:r.x-e.x,y:r.y-e.y};return AA(i,n)/PM(i)/PM(n)},bNt=(e,t,r)=>{const n={x:t.x-e.x,y:t.y-e.y},i={x:r.x-e.x,y:r.y-e.y};return CJ(i,n)/PM(i)/PM(n)},E$=(e,t,r)=>t.y===0?null:{x:e.x+t.x/t.y*(r-e.y),y:r},w$=(e,t,r)=>t.x===0?null:{x:r,y:e.y+t.y/t.x*(r-e.x)},ENt=(e,t,r,n)=>{if(t.x===0)return w$(r,n,e.x);if(n.x===0)return w$(e,t,r.x);if(t.y===0)return E$(r,n,e.y);if(n.y===0)return E$(e,t,r.y);const i=AA(t,n);if(i==0)return null;const a={x:r.x-e.x,y:r.y-e.y},o=AA(a,t)/i,s=AA(a,n)/i,l=e.x+s*t.x,u=r.x+o*n.x,c=e.y+s*t.y,f=r.y+o*n.y,d=(l+u)/2,v=(c+f)/2;return{x:d,y:v}};class Rf{static compare(t,r){const n=Rf.comparePoints(t.point,r.point);return n!==0?n:(t.point!==r.point&&t.link(r),t.isLeft!==r.isLeft?t.isLeft?1:-1:Fm.compare(t.segment,r.segment))}static comparePoints(t,r){return t.x<r.x?-1:t.x>r.x?1:t.y<r.y?-1:t.y>r.y?1:0}constructor(t,r){t.events===void 0?t.events=[this]:t.events.push(this),this.point=t,this.isLeft=r}link(t){if(t.point===this.point)throw new Error("Tried to link already linked events");const r=t.point.events;for(let n=0,i=r.length;n<i;n++){const a=r[n];this.point.events.push(a),a.point=this.point}this.checkForConsuming()}checkForConsuming(){const t=this.point.events.length;for(let r=0;r<t;r++){const n=this.point.events[r];if(n.segment.consumedBy===void 0)for(let i=r+1;i<t;i++){const a=this.point.events[i];a.consumedBy===void 0&&n.otherSE.point.events===a.otherSE.point.events&&n.segment.consume(a.segment)}}}getAvailableLinkedEvents(){const t=[];for(let r=0,n=this.point.events.length;r<n;r++){const i=this.point.events[r];i!==this&&!i.segment.ringOut&&i.segment.isInResult()&&t.push(i)}return t}getLeftmostComparator(t){const r=new Map,n=i=>{const a=i.otherSE;r.set(i,{sine:xNt(this.point,t.point,a.point),cosine:bNt(this.point,t.point,a.point)})};return(i,a)=>{r.has(i)||n(i),r.has(a)||n(a);const{sine:o,cosine:s}=r.get(i),{sine:l,cosine:u}=r.get(a);return o>=0&&l>=0?s<u?1:s>u?-1:0:o<0&&l<0?s<u?-1:s>u?1:0:l<o?-1:l>o?1:0}}}let wNt=0;class Fm{static compare(t,r){const n=t.leftSE.point.x,i=r.leftSE.point.x,a=t.rightSE.point.x,o=r.rightSE.point.x;if(o<n)return 1;if(a<i)return-1;const s=t.leftSE.point.y,l=r.leftSE.point.y,u=t.rightSE.point.y,c=r.rightSE.point.y;if(n<i){if(l<s&&l<u)return 1;if(l>s&&l>u)return-1;const f=t.comparePoint(r.leftSE.point);if(f<0)return 1;if(f>0)return-1;const d=r.comparePoint(t.rightSE.point);return d!==0?d:-1}if(n>i){if(s<l&&s<c)return-1;if(s>l&&s>c)return 1;const f=r.comparePoint(t.leftSE.point);if(f!==0)return f;const d=t.comparePoint(r.rightSE.point);return d<0?1:d>0?-1:1}if(s<l)return-1;if(s>l)return 1;if(a<o){const f=r.comparePoint(t.rightSE.point);if(f!==0)return f}if(a>o){const f=t.comparePoint(r.rightSE.point);if(f<0)return 1;if(f>0)return-1}if(a!==o){const f=u-s,d=a-n,v=c-l,g=o-i;if(f>d&&v<g)return 1;if(f<d&&v>g)return-1}return a>o?1:a<o||u<c?-1:u>c?1:t.id<r.id?-1:t.id>r.id?1:0}constructor(t,r,n,i){this.id=++wNt,this.leftSE=t,t.segment=this,t.otherSE=r,this.rightSE=r,r.segment=this,r.otherSE=t,this.rings=n,this.windings=i}static fromRing(t,r,n){let i,a,o;const s=Rf.comparePoints(t,r);if(s<0)i=t,a=r,o=1;else if(s>0)i=r,a=t,o=-1;else throw new Error(`Tried to create degenerate segment at [${t.x}, ${t.y}]`);const l=new Rf(i,!0),u=new Rf(a,!1);return new Fm(l,u,[n],[o])}replaceRightSE(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const t=this.leftSE.point.y,r=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<r?t:r},ur:{x:this.rightSE.point.x,y:t>r?t:r}}}vector(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}isAnEndpoint(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}comparePoint(t){if(this.isAnEndpoint(t))return 0;const r=this.leftSE.point,n=this.rightSE.point,i=this.vector();if(r.x===n.x)return t.x===r.x?0:t.x<r.x?1:-1;const a=(t.y-r.y)/i.y,o=r.x+a*i.x;if(t.x===o)return 0;const s=(t.x-r.x)/i.x,l=r.y+s*i.y;return t.y===l?0:t.y<l?-1:1}getIntersection(t){const r=this.bbox(),n=t.bbox(),i=$D(r,n);if(i===null)return null;const a=this.leftSE.point,o=this.rightSE.point,s=t.leftSE.point,l=t.rightSE.point,u=NE(r,s)&&this.comparePoint(s)===0,c=NE(n,a)&&t.comparePoint(a)===0,f=NE(r,l)&&this.comparePoint(l)===0,d=NE(n,o)&&t.comparePoint(o)===0;if(c&&u)return d&&!f?o:!d&&f?l:null;if(c)return f&&a.x===l.x&&a.y===l.y?null:a;if(u)return d&&o.x===s.x&&o.y===s.y?null:s;if(d&&f)return null;if(d)return o;if(f)return l;const v=ENt(a,this.vector(),s,t.vector());return v===null||!NE(i,v)?null:yC.round(v.x,v.y)}split(t){const r=[],n=t.events!==void 0,i=new Rf(t,!0),a=new Rf(t,!1),o=this.rightSE;this.replaceRightSE(a),r.push(a),r.push(i);const s=new Fm(i,o,this.rings.slice(),this.windings.slice());return Rf.comparePoints(s.leftSE.point,s.rightSE.point)>0&&s.swapEvents(),Rf.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),n&&(i.checkForConsuming(),a.checkForConsuming()),r}swapEvents(){const t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let r=0,n=this.windings.length;r<n;r++)this.windings[r]*=-1}consume(t){let r=this,n=t;for(;r.consumedBy;)r=r.consumedBy;for(;n.consumedBy;)n=n.consumedBy;const i=Fm.compare(r,n);if(i!==0){if(i>0){const a=r;r=n,n=a}if(r.prev===n){const a=r;r=n,n=a}for(let a=0,o=n.rings.length;a<o;a++){const s=n.rings[a],l=n.windings[a],u=r.rings.indexOf(s);u===-1?(r.rings.push(s),r.windings.push(l)):r.windings[u]+=l}n.rings=null,n.windings=null,n.consumedBy=r,n.leftSE.consumedBy=r.leftSE,n.rightSE.consumedBy=r.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};const r=this._afterState.rings,n=this._afterState.windings,i=this._afterState.multiPolys;for(let s=0,l=this.rings.length;s<l;s++){const u=this.rings[s],c=this.windings[s],f=r.indexOf(u);f===-1?(r.push(u),n.push(c)):n[f]+=c}const a=[],o=[];for(let s=0,l=r.length;s<l;s++){if(n[s]===0)continue;const u=r[s],c=u.poly;if(o.indexOf(c)===-1)if(u.isExterior)a.push(c);else{o.indexOf(c)===-1&&o.push(c);const f=a.indexOf(u.poly);f!==-1&&a.splice(f,1)}}for(let s=0,l=a.length;s<l;s++){const u=a[s].multiPoly;i.indexOf(u)===-1&&i.push(u)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const t=this.beforeState().multiPolys,r=this.afterState().multiPolys;switch(Id.type){case"union":{const n=t.length===0,i=r.length===0;this._isInResult=n!==i;break}case"intersection":{let n,i;t.length<r.length?(n=t.length,i=r.length):(n=r.length,i=t.length),this._isInResult=i===Id.numMultiPolys&&n<i;break}case"xor":{const n=Math.abs(t.length-r.length);this._isInResult=n%2===1;break}case"difference":{const n=i=>i.length===1&&i[0].isSubject;this._isInResult=n(t)!==n(r);break}default:throw new Error(`Unrecognized operation type found ${Id.type}`)}return this._isInResult}}class C${constructor(t,r,n){if(!Array.isArray(t)||t.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=r,this.isExterior=n,this.segments=[],typeof t[0][0]!="number"||typeof t[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const i=yC.round(t[0][0],t[0][1]);this.bbox={ll:{x:i.x,y:i.y},ur:{x:i.x,y:i.y}};let a=i;for(let o=1,s=t.length;o<s;o++){if(typeof t[o][0]!="number"||typeof t[o][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let l=yC.round(t[o][0],t[o][1]);l.x===a.x&&l.y===a.y||(this.segments.push(Fm.fromRing(a,l,this)),l.x<this.bbox.ll.x&&(this.bbox.ll.x=l.x),l.y<this.bbox.ll.y&&(this.bbox.ll.y=l.y),l.x>this.bbox.ur.x&&(this.bbox.ur.x=l.x),l.y>this.bbox.ur.y&&(this.bbox.ur.y=l.y),a=l)}(i.x!==a.x||i.y!==a.y)&&this.segments.push(Fm.fromRing(a,i,this))}getSweepEvents(){const t=[];for(let r=0,n=this.segments.length;r<n;r++){const i=this.segments[r];t.push(i.leftSE),t.push(i.rightSE)}return t}}class CNt{constructor(t,r){if(!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new C$(t[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let n=1,i=t.length;n<i;n++){const a=new C$(t[n],this,!1);a.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=a.bbox.ll.x),a.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=a.bbox.ll.y),a.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=a.bbox.ur.x),a.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=a.bbox.ur.y),this.interiorRings.push(a)}this.multiPoly=r}getSweepEvents(){const t=this.exteriorRing.getSweepEvents();for(let r=0,n=this.interiorRings.length;r<n;r++){const i=this.interiorRings[r].getSweepEvents();for(let a=0,o=i.length;a<o;a++)t.push(i[a])}return t}}class S${constructor(t,r){if(!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof t[0][0][0]=="number"&&(t=[t])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(let n=0,i=t.length;n<i;n++){const a=new CNt(t[n],this);a.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=a.bbox.ll.x),a.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=a.bbox.ll.y),a.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=a.bbox.ur.x),a.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=a.bbox.ur.y),this.polys.push(a)}this.isSubject=r}getSweepEvents(){const t=[];for(let r=0,n=this.polys.length;r<n;r++){const i=this.polys[r].getSweepEvents();for(let a=0,o=i.length;a<o;a++)t.push(i[a])}return t}}class DM{static factory(t){const r=[];for(let n=0,i=t.length;n<i;n++){const a=t[n];if(!a.isInResult()||a.ringOut)continue;let o=null,s=a.leftSE,l=a.rightSE;const u=[s],c=s.point,f=[];for(;o=s,s=l,u.push(s),s.point!==c;)for(;;){const d=s.getAvailableLinkedEvents();if(d.length===0){const x=u[0].point,w=u[u.length-1].point;throw new Error(`Unable to complete output ring starting at [${x.x}, ${x.y}]. Last matching segment found ends at [${w.x}, ${w.y}].`)}if(d.length===1){l=d[0].otherSE;break}let v=null;for(let x=0,w=f.length;x<w;x++)if(f[x].point===s.point){v=x;break}if(v!==null){const x=f.splice(v)[0],w=u.splice(x.index);w.unshift(w[0].otherSE),r.push(new DM(w.reverse()));continue}f.push({index:u.length,point:s.point});const g=s.getLeftmostComparator(o);l=d.sort(g)[0].otherSE;break}r.push(new DM(u))}return r}constructor(t){this.events=t;for(let r=0,n=t.length;r<n;r++)t[r].segment.ringOut=this;this.poly=null}getGeom(){let t=this.events[0].point;const r=[t];for(let u=1,c=this.events.length-1;u<c;u++){const f=this.events[u].point,d=this.events[u+1].point;b$(f,t,d)!==0&&(r.push(f),t=f)}if(r.length===1)return null;const n=r[0],i=r[1];b$(n,t,i)===0&&r.shift(),r.push(r[0]);const a=this.isExteriorRing()?1:-1,o=this.isExteriorRing()?0:r.length-1,s=this.isExteriorRing()?r.length:-1,l=[];for(let u=o;u!=s;u+=a)l.push([r[u].x,r[u].y]);return l}isExteriorRing(){if(this._isExteriorRing===void 0){const t=this.enclosingRing();this._isExteriorRing=t?!t.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let t=this.events[0];for(let i=1,a=this.events.length;i<a;i++){const o=this.events[i];Rf.compare(t,o)>0&&(t=o)}let r=t.segment.prevInResult(),n=r?r.prevInResult():null;for(;;){if(!r)return null;if(!n)return r.ringOut;if(n.ringOut!==r.ringOut)return n.ringOut.enclosingRing()!==r.ringOut?r.ringOut:r.ringOut.enclosingRing();r=n.prevInResult(),n=r?r.prevInResult():null}}}class T${constructor(t){this.exteriorRing=t,t.poly=this,this.interiorRings=[]}addInterior(t){this.interiorRings.push(t),t.poly=this}getGeom(){const t=[this.exteriorRing.getGeom()];if(t[0]===null)return null;for(let r=0,n=this.interiorRings.length;r<n;r++){const i=this.interiorRings[r].getGeom();i!==null&&t.push(i)}return t}}class SNt{constructor(t){this.rings=t,this.polys=this._composePolys(t)}getGeom(){const t=[];for(let r=0,n=this.polys.length;r<n;r++){const i=this.polys[r].getGeom();i!==null&&t.push(i)}return t}_composePolys(t){const r=[];for(let n=0,i=t.length;n<i;n++){const a=t[n];if(!a.poly)if(a.isExteriorRing())r.push(new T$(a));else{const o=a.enclosingRing();o.poly||r.push(new T$(o)),o.poly.addInterior(a)}}return r}}class TNt{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Fm.compare;this.queue=t,this.tree=new v4(r),this.segments=[]}process(t){const r=t.segment,n=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(r),n;const i=t.isLeft?this.tree.add(r):this.tree.find(r);if(!i)throw new Error(`Unable to find segment #${r.id} [${r.leftSE.point.x}, ${r.leftSE.point.y}] -> [${r.rightSE.point.x}, ${r.rightSE.point.y}] in SweepLine tree.`);let a=i,o=i,s,l;for(;s===void 0;)a=this.tree.prev(a),a===null?s=null:a.key.consumedBy===void 0&&(s=a.key);for(;l===void 0;)o=this.tree.next(o),o===null?l=null:o.key.consumedBy===void 0&&(l=o.key);if(t.isLeft){let u=null;if(s){const f=s.getIntersection(r);if(f!==null&&(r.isAnEndpoint(f)||(u=f),!s.isAnEndpoint(f))){const d=this._splitSafely(s,f);for(let v=0,g=d.length;v<g;v++)n.push(d[v])}}let c=null;if(l){const f=l.getIntersection(r);if(f!==null&&(r.isAnEndpoint(f)||(c=f),!l.isAnEndpoint(f))){const d=this._splitSafely(l,f);for(let v=0,g=d.length;v<g;v++)n.push(d[v])}}if(u!==null||c!==null){let f=null;u===null?f=c:c===null?f=u:f=Rf.comparePoints(u,c)<=0?u:c,this.queue.remove(r.rightSE),n.push(r.rightSE);const d=r.split(f);for(let v=0,g=d.length;v<g;v++)n.push(d[v])}n.length>0?(this.tree.remove(r),n.push(t)):(this.segments.push(r),r.prev=s)}else{if(s&&l){const u=s.getIntersection(l);if(u!==null){if(!s.isAnEndpoint(u)){const c=this._splitSafely(s,u);for(let f=0,d=c.length;f<d;f++)n.push(c[f])}if(!l.isAnEndpoint(u)){const c=this._splitSafely(l,u);for(let f=0,d=c.length;f<d;f++)n.push(c[f])}}}this.tree.remove(r)}return n}_splitSafely(t,r){this.tree.remove(t);const n=t.rightSE;this.queue.remove(n);const i=t.split(r);return i.push(n),t.consumedBy===void 0&&this.tree.add(t),i}}const A$=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,ANt=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6;class MNt{run(t,r,n){Id.type=t,yC.reset();const i=[new S$(r,!0)];for(let f=0,d=n.length;f<d;f++)i.push(new S$(n[f],!1));if(Id.numMultiPolys=i.length,Id.type==="difference"){const f=i[0];let d=1;for(;d<i.length;)$D(i[d].bbox,f.bbox)!==null?d++:i.splice(d,1)}if(Id.type==="intersection")for(let f=0,d=i.length;f<d;f++){const v=i[f];for(let g=f+1,x=i.length;g<x;g++)if($D(v.bbox,i[g].bbox)===null)return[]}const a=new v4(Rf.compare);for(let f=0,d=i.length;f<d;f++){const v=i[f].getSweepEvents();for(let g=0,x=v.length;g<x;g++)if(a.insert(v[g]),a.size>A$)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big).")}const o=new TNt(a);let s=a.size,l=a.pop();for(;l;){const f=l.key;if(a.size===s){const v=f.segment;throw new Error(`Unable to pop() ${f.isLeft?"left":"right"} SweepEvent [${f.point.x}, ${f.point.y}] from segment #${v.id} [${v.leftSE.point.x}, ${v.leftSE.point.y}] -> [${v.rightSE.point.x}, ${v.rightSE.point.y}] from queue.`)}if(a.size>A$)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big).");if(o.segments.length>ANt)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments).");const d=o.process(f);for(let v=0,g=d.length;v<g;v++){const x=d[v];x.consumedBy===void 0&&a.insert(x)}s=a.size,l=a.pop()}yC.reset();const u=DM.factory(o.segments);return new SNt(u).getGeom()}}const Id=new MNt,RNt=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return Id.run("union",e,r)},INt=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return Id.run("intersection",e,r)},LNt=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return Id.run("xor",e,r)},ONt=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return Id.run("difference",e,r)};var PNt={union:RNt,intersection:INt,xor:LNt,difference:ONt};function DNt(e,t,r){r===void 0&&(r={});var n=l7(e),i=l7(t),a=PNt.union(n.coordinates,i.coordinates);return a.length===0?null:a.length===1?_5(a[0],r.properties):gft(a,r.properties)}class FNt{getCombineFeature(t){let r=null;const n=t[0];return t.map(i=>{const a=_5(i.coordinates);r===null?r=a:r=DNt(r,a)}),n&&(r.properties=Ce({},n)),r}}const kE="select",zE="active";class BNt{constructor({layerService:t,tileLayerService:r,parent:n}){z(this,"layerService",void 0),z(this,"tileLayerService",void 0),z(this,"tileSourceService",void 0),z(this,"parent",void 0),z(this,"tilePickID",new Map),this.layerService=t,this.tileLayerService=r,this.parent=n,this.tileSourceService=new FNt}pickRender(t){const r=this.tileLayerService.getVisibleTileBylngLat(t.lngLat);if(r){const n=r.getMainLayer();n==null||n.layerPickService.pickRender(t)}}pick(t,r){var n=this;return Pe(function*(){const a=n.parent.getContainer().pickingService;if(t.type==="RasterLayer"){const o=n.tileLayerService.getVisibleTileBylngLat(r.lngLat);if(o&&o.getMainLayer()!==void 0){const s=o.getMainLayer();return s.layerPickService.pickRasterLayer(s,r,n.parent)}return!1}return n.pickRender(r),a.pickFromPickingFBO(t,r)})()}selectFeature(t){const[r,n,i]=t,a=this.color2PickId(r,n,i);this.tilePickID.set(kE,a),this.updateHighLight(r,n,i,kE)}highlightPickedFeature(t){const[r,n,i]=t,a=this.color2PickId(r,n,i);this.tilePickID.set(zE,a),this.updateHighLight(r,n,i,zE)}updateHighLight(t,r,n,i){this.tileLayerService.tiles.map(a=>{const o=a.getMainLayer();switch(i){case kE:o==null||o.hooks.beforeSelect.call([t,r,n]);break;case zE:o==null||o.hooks.beforeHighlight.call([t,r,n]);break}})}setPickState(){const t=this.tilePickID.get(kE),r=this.tilePickID.get(zE);if(t){const[n,i,a]=this.pickId2Color(t);this.updateHighLight(n,i,a,kE);return}if(r){const[n,i,a]=this.pickId2Color(r);this.updateHighLight(n,i,a,zE);return}}color2PickId(t,r,n){return Oy(new Uint8Array([t,r,n]))}pickId2Color(t){return Rx(t)}getFeatureById(t){const r=this.tileLayerService.getTiles().filter(i=>i.visible),n=[];return r.forEach(i=>{n.push(...i.getFeatureById(t))}),n}pickRasterLayer(){return!1}}function NNt(e){return e==="PolygonLayer"?OM:e==="LineLayer"?hx:mC}function kNt(e){return["PolygonLayer","LineLayer"].indexOf(e)!==-1}class E_ extends $u.EventEmitter{constructor(t,r){super(),z(this,"x",void 0),z(this,"y",void 0),z(this,"z",void 0),z(this,"key",void 0),z(this,"parent",void 0),z(this,"sourceTile",void 0),z(this,"visible",!0),z(this,"layers",[]),z(this,"isLoaded",!1),z(this,"tileMaskLayers",[]),z(this,"tileMask",void 0),this.parent=r,this.sourceTile=t,this.x=t.x,this.y=t.y,this.z=t.z,this.key=`${this.x}_${this.y}_${this.z}`}getLayers(){return this.layers}styleUpdate(...t){}lnglatInBounds(t){const[r,n,i,a]=this.sourceTile.bounds,{lng:o,lat:s}=t;return o>=r&&o<=i&&s>=n&&s<=a}getLayerOptions(){var t;const r=this.parent.getLayerConfig();return Ce(Ce({},r),{},{textAllowOverlap:!0,autoFit:!1,maskLayers:this.getMaskLayer(),tileMask:kNt(this.parent.type),mask:r.mask||((t=r.maskLayers)===null||t===void 0?void 0:t.length)!==0&&r.enableMask})}getMaskLayer(){const{maskLayers:t}=this.parent.getLayerConfig(),r=[];return t==null||t.forEach(n=>{if(!n.tileLayer)return r.push(n),n;const a=n.tileLayer.getTile(this.sourceTile.key),o=a==null?void 0:a.getLayers()[0];o&&r.push(o)}),r}addTileMask(){var t=this;return Pe(function*(){const r=new OM({name:"mask",visible:!0,enablePicking:!1}).source({type:"FeatureCollection",features:[t.sourceTile.bboxPolygon]},{parser:{type:"geojson",featureId:"id"}}).shape("fill").color("#0f0").style({opacity:.5}),n=Ow(t.parent.container);r.setContainer(n),yield r.init(),t.tileMask=r;const i=t.getMainLayer();return i!==void 0&&(i.tileMask=r),r})()}addMask(t,r){var n=this;return Pe(function*(){const i=Ow(n.parent.container);r.setContainer(i),yield r.init(),t.addMask(r),n.tileMaskLayers.push(r)})()}addLayer(t){var r=this;return Pe(function*(){t.isTileLayer=!0;const n=Ow(r.parent.container);t.setContainer(n),r.layers.push(t),yield t.init()})()}updateVisible(t){this.visible=t,this.updateOptions("visible",t)}updateOptions(t,r){this.layers.forEach(n=>{n.updateLayerConfig({[t]:r})})}getMainLayer(){return this.layers[0]}getFeatures(t){return[]}getFeatureById(t){return[]}destroy(){var t;(t=this.tileMask)===null||t===void 0||t.destroy(),this.layers.forEach(r=>r.destroy())}}class zNt extends E_{initTileLayer(){var t=this;return Pe(function*(){const r=t.getSourceOption(),n=r.data.features[0].properties,i=new hx().source(r.data,r.options).size(1).shape("line").color("red"),a=new mC({minZoom:t.z-1,maxZoom:t.z+1,textAllowOverlap:!0}).source([n],{parser:{type:"json",x:"x",y:"y"}}).size(20).color("red").shape(t.key).style({stroke:"#fff",strokeWidth:2});yield t.addLayer(i),yield t.addLayer(a),t.isLoaded=!0})()}getSourceOption(){const t=this.parent.getSource();return{data:{type:"FeatureCollection",features:this.sourceTile.data.layers.testTile.features},options:{parser:{type:"geojson"},transforms:t.transforms}}}}class UNt extends E_{initTileLayer(){var t=this;return Pe(function*(){const r=t.parent.getLayerAttributeConfig(),n=t.getLayerOptions(),i=t.getSourceOption(),a=new l5t(Ce({},n)).source(i.data,i.options);r&&Object.keys(r).forEach(o=>{var s,l;const u=o;a[u]((s=r[u])===null||s===void 0?void 0:s.field,(l=r[u])===null||l===void 0?void 0:l.values)}),yield t.addLayer(a),t.isLoaded=!0})()}getSourceOption(){const t=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:t.transforms}}}}const $Nt=`layout(std140) uniform commonUniorm {
  vec4 u_color;
  float u_opacity;
};

out vec4 outputColor;

void main() {
  outputColor = u_color;
  outputColor.a *= u_opacity;
}
`,HNt=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;

layout(std140) uniform commonUniorm {
  vec4 u_color;
  float u_opacity;
};

#pragma include "projection"

void main() {
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
}

`;class VNt extends Ua{getUninforms(){const t=this.getCommonUniformsInfo(),r=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),Ce(Ce({},t.uniformsOption),r.uniformsOption)}getCommonUniformsInfo(){const{opacity:t=1,color:r="#000"}=this.layer.getLayerConfig(),n={u_color:Qa(r),u_opacity:t||1};return this.getUniformsBufferInfo(n)}initModels(){var t=this;return Pe(function*(){return t.buildModels()})()}buildModels(){var t=this;return Pe(function*(){return t.initUniformsBuffer(),[yield t.layer.buildLayerModel({moduleName:"mask",vertexShader:HNt,fragmentShader:$Nt,defines:t.getDefines(),triangulation:SS,depth:{enable:!1},pick:!1})]})()}clearModels(t=!0){t&&this.layerService.clear()}registerBuiltinAttributes(){return""}}const GNt={fill:VNt},WNt=GNt;class SJ extends b_{constructor(...t){super(...t),z(this,"type","MaskLayer")}buildModels(){var t=this;return Pe(function*(){const r=t.getModelType();t.layerModel=new WNt[r](t),yield t.initLayerModels()})()}getModelType(){return"fill"}}class XNt extends E_{initTileLayer(){var t=this;return Pe(function*(){const r=t.parent.getLayerAttributeConfig(),n=t.getLayerOptions(),i=t.getSourceOption(),a=new SJ(Ce({},n)).source(i.data,i.options);r&&Object.keys(r).forEach(o=>{var s,l;const u=o;a[u]((s=r[u])===null||s===void 0?void 0:s.field,(l=r[u])===null||l===void 0?void 0:l.values)}),yield t.addLayer(a),t.isLoaded=!0})()}getFeatures(t){return t?this.sourceTile.data.getTileData(t):[]}getSourceOption(){const t=this.parent.getSource(),{sourceLayer:r,featureId:n}=this.parent.getLayerConfig();return{data:{type:"FeatureCollection",features:this.getFeatures(r)},options:{parser:{type:"geojson",featureId:n},transforms:t.transforms}}}}const jNt=["rasterData"];let YNt=class extends E_{initTileLayer(){var t=this;return Pe(function*(){const r=t.parent.getLayerAttributeConfig(),n=t.getLayerOptions(),i=t.getSourceOption(),a=new p4(Ce({},n)).source(i.data,i.options);r&&Object.keys(r).forEach(o=>{var s,l;const u=o;a[u]((s=r[u])===null||s===void 0?void 0:s.field,(l=r[u])===null||l===void 0?void 0:l.values)}),yield t.addLayer(a),t.isLoaded=!0})()}getSourceOption(){const t=this.parent.getSource(),r=this.sourceTile.data.data,{rasterData:n}=r,i=Hf(r,jNt);return{data:n,options:{parser:Ce({type:"rasterRgb",extent:this.sourceTile.bounds},i),transforms:t.transforms}}}};class ZNt extends E_{initTileLayer(){var t=this;return Pe(function*(){const r=t.parent.getLayerAttributeConfig(),n=t.getLayerOptions(),i=t.getSourceOption(),a=new p4(Ce({},n)).source(i.data,i.options);r&&Object.keys(r).forEach(o=>{var s,l;const u=o;a[u]((s=r[u])===null||s===void 0?void 0:s.field,(l=r[u])===null||l===void 0?void 0:l.values)}),yield t.addLayer(a),t.isLoaded=!0})()}getSourceOption(){const t=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:t.transforms}}}}const qNt=["rasterData"],KNt={positions:[0,1],colors:["#000","#fff"]};class QNt extends E_{constructor(...t){super(...t),z(this,"colorTexture",void 0)}initTileLayer(){var t=this;return Pe(function*(){const r=t.parent.getLayerAttributeConfig(),n=t.getLayerOptions(),i=t.getSourceOption(),{rampColors:a,domain:o}=t.getLayerOptions();t.colorTexture=t.parent.textureService.getColorTexture(a,o);const s=new p4(Ce(Ce({},n),{},{colorTexture:t.colorTexture})).source(i.data,i.options);r&&Object.keys(r).forEach(l=>{var u,c;const f=l;s[f]((u=r[f])===null||u===void 0?void 0:u.field,(c=r[f])===null||c===void 0?void 0:c.values)}),yield t.addLayer(s),t.isLoaded=!0})()}getSourceOption(){const t=this.parent.getSource(),r=this.sourceTile.data.data,{rasterData:n}=r,i=Hf(r,qNt);return{data:n,options:{parser:Ce({type:"raster",extent:this.sourceTile.bounds},i),transforms:t.transforms}}}styleUpdate(...t){const{rampColors:r=KNt,domain:n}=t;this.colorTexture=this.parent.textureService.getColorTexture(r,n||A5(r)),this.layers.forEach(i=>i.style({colorTexture:this.colorTexture}))}destroy(){this.layers.forEach(t=>t.destroy())}}class aT extends E_{initTileLayer(){var t=this;return Pe(function*(){const r=t.parent.getLayerAttributeConfig(),n=t.getLayerOptions(),i=NNt(t.parent.type),a=t.getSourceOption();if(!a){t.isLoaded=!0,t.emit("loaded");return}const o=new i(Ce({},n)).source(a.data,a.options);Object.keys(r).forEach(s=>{var l,u;const c=s;o[c]((l=r[c])===null||l===void 0?void 0:l.field,(u=r[c])===null||u===void 0?void 0:u.values)}),yield t.addLayer(o),n.tileMask&&(yield t.addTileMask()),t.setLayerMinMaxZoom(o),t.isLoaded=!0,t.emit("loaded")})()}getSourceOption(){const t=this.parent.getSource(),{sourceLayer:r="defaultLayer",featureId:n="id"}=this.parent.getLayerConfig();return{data:{type:"FeatureCollection",features:this.getFeatures(r)},options:{parser:{type:"geojson",featureId:n},transforms:t.transforms}}}setLayerMinMaxZoom(t){t.getModelType()==="text"&&t.updateLayerConfig({maxZoom:this.z+1,minZoom:this.z-1})}getFeatures(t){return this.sourceTile.data.getTileData(t)}getFeatureById(t){const r=this.getMainLayer();return r?r.getSource().data.dataArray.filter(i=>i._id===t):[]}}function JNt(e){switch(e.type){case"PolygonLayer":return aT;case"LineLayer":return aT;case"PointLayer":return aT;case"TileDebugLayer":return zNt;case"MaskLayer":return XNt;case"RasterLayer":const{dataType:r}=e.getSource().parser;switch(r){case nu.RGB:case nu.CUSTOMRGB:return YNt;case nu.ARRAYBUFFER:case nu.CUSTOMARRAYBUFFER:return QNt;case nu.TERRAINRGB:case nu.CUSTOMTERRAINRGB:return ZNt;default:return UNt}default:return aT}}const tkt=["shape","color","size","style","animate","filter","rotate","scale","setBlend","setSelect","setActive","disableMask","enableMask","addMask","removeMask"],{debounce:ekt}=is;class rkt{constructor(t){z(this,"parent",void 0),z(this,"tileLayerService",void 0),z(this,"mapService",void 0),z(this,"layerService",void 0),z(this,"rendererService",void 0),z(this,"pickingService",void 0),z(this,"tilePickService",void 0),z(this,"tilesetManager",void 0),z(this,"initedTileset",!1),z(this,"lastViewStates",void 0),z(this,"mapchange",()=>{var n;if(this.parent.isVisible()===!1)return;const{latLonBounds:i,zoom:a}=this.getCurrentView();this.lastViewStates&&this.lastViewStates.zoom===a&&this.lastViewStates.latLonBounds.toString()===i.toString()||(this.lastViewStates={zoom:a,latLonBounds:i},(n=this.tilesetManager)===null||n===void 0||n.throttleUpdate(a,i))}),z(this,"viewchange",ekt(this.mapchange,24)),this.parent=t;const r=this.parent.getContainer();this.rendererService=r.rendererService,this.layerService=r.layerService,this.mapService=r.mapService,this.pickingService=r.pickingService,this.tileLayerService=new iNt({rendererService:this.rendererService,layerService:this.layerService,parent:t}),this.tilePickService=new BNt({tileLayerService:this.tileLayerService,layerService:this.layerService,parent:t}),this.parent.setLayerPickService(this.tilePickService),this.proxy(t),this.initTileSetManager()}initTileSetManager(){var t;const r=this.parent.getSource();if(this.tilesetManager=r.tileset,this.initedTileset||(this.bindTilesetEvent(),this.initedTileset=!0),this.parent.isVisible()===!1)return;const{latLonBounds:n,zoom:i}=this.getCurrentView();(t=this.tilesetManager)===null||t===void 0||t.update(i,n)}getCurrentView(){const t=this.mapService.getBounds(),r=[t[0][0],t[0][1],t[1][0],t[1][1]],n=this.mapService.getZoom();return{latLonBounds:r,zoom:n}}bindTilesetEvent(){this.tilesetManager.on("tile-loaded",t=>{}),this.tilesetManager.on("tile-unload",t=>{this.tileUnLoad(t)}),this.tilesetManager.on("tile-error",(t,r)=>{this.tileError(t)}),this.tilesetManager.on("tile-update",()=>{this.tileUpdate()}),this.mapService.on("zoomend",this.mapchange),this.mapService.on("moveend",this.viewchange)}render(){this.tileLayerService.render()}getLayers(){return this.tileLayerService.getLayers()}getTiles(){return this.tileLayerService.getTiles()}getTile(t){return this.tileLayerService.getTile(t)}tileLoaded(t){}tileError(t){console.warn("error:",t)}destroy(){var t;this.mapService.off("zoomend",this.mapchange),this.mapService.off("moveend",this.viewchange),(t=this.tilesetManager)===null||t===void 0||t.destroy(),this.tileLayerService.destroy()}reload(){var t;this.tilesetManager.clear();const{latLonBounds:r,zoom:n}=this.getCurrentView();(t=this.tilesetManager)===null||t===void 0||t.update(n,r)}tileUnLoad(t){this.tileLayerService.removeTile(t.key)}tileUpdate(){var t=this;return Pe(function*(){if(!t.tilesetManager)return;const r=t.parent.getMinZoom(),n=t.parent.getMaxZoom(),i=t.tilesetManager.tiles.filter(a=>a.isLoaded).filter(a=>a.isVisibleChange).filter(a=>a.data).filter(a=>a.z>=r&&a.z<n);yield Promise.all(i.map(function(){var a=Pe(function*(o){if(t.tileLayerService.hasTile(o.key))t.tileLayerService.updateTileVisible(o),t.tilePickService.setPickState(),t.layerService.reRender();else{const s=JNt(t.parent),l=new s(o,t.parent);yield l.initTileLayer(),t.tilePickService.setPickState(),l.getLayers().length!==0&&(t.tileLayerService.addTile(l),t.tileLayerService.updateTileVisible(o),t.layerService.reRender())}});return function(o){return a.apply(this,arguments)}}())),t.tilesetManager.isLoaded&&t.parent.emit("tiles-loaded",t.tilesetManager.currentTiles)})()}setPickState(t){}pickRender(t){this.tilePickService.pickRender(t)}selectFeature(t){this.tilePickService.selectFeature(t)}highlightPickedFeature(t){this.tilePickService.highlightPickedFeature(t)}proxy(t){tkt.forEach(r=>{const n=t[r].bind(t);t[r]=(...i)=>(n(...i),this.getLayers().map(a=>{a[r](...i)}),r==="style"&&this.getTiles().forEach(a=>a.styleUpdate(...i)),t)})}}class nkt extends Wm{constructor(...t){super(...t),z(this,"disabled",void 0),z(this,"zoomInButton",void 0),z(this,"zoomOutButton",void 0),z(this,"zoomNumDiv",void 0),z(this,"zoomIn",()=>{!this.disabled&&this.mapsService.getZoom()<this.mapsService.getMaxZoom()&&this.mapsService.zoomIn()}),z(this,"zoomOut",()=>{!this.disabled&&this.mapsService.getZoom()>this.mapsService.getMinZoom()&&this.mapsService.zoomOut()}),z(this,"updateDisabled",()=>{const r=this.mapsService;this.zoomInButton.removeAttribute("disabled"),this.zoomOutButton.removeAttribute("disabled"),(this.disabled||r.getZoom()<=r.getMinZoom())&&this.zoomOutButton.setAttribute("disabled","true"),this.controlOption.showZoom&&this.zoomNumDiv&&(this.zoomNumDiv.innerText=String(Math.floor(r.getZoom()))),(this.disabled||r.getZoom()>=r.getMaxZoom())&&this.zoomInButton.setAttribute("disabled","true")})}getDefault(t){return Ce(Ce({},super.getDefault(t)),{},{position:Lx.BOTTOMRIGHT,name:"zoom",zoomInText:CD("l7-icon-enlarge"),zoomInTitle:"Zoom in",zoomOutText:CD("l7-icon-narrow"),zoomOutTitle:"Zoom out",showZoom:!1})}setOptions(t){super.setOptions(t),this.checkUpdateOption(t,["zoomInText","zoomInTitle","zoomOutText","zoomOutTitle","showZoom"])&&this.resetButtonGroup(this.container)}onAdd(){const t=uo("div","l7-control-zoom");return this.resetButtonGroup(t),this.mapsService.on("zoomend",this.updateDisabled),this.mapsService.on("zoomchange",this.updateDisabled),t}onRemove(){this.mapsService.off("zoomend",this.updateDisabled),this.mapsService.off("zoomchange",this.updateDisabled)}disable(){return this.disabled=!0,this.updateDisabled(),this}enable(){return this.disabled=!1,this.updateDisabled(),this}resetButtonGroup(t){_S(t),this.zoomInButton=this.createButton(this.controlOption.zoomInText,this.controlOption.zoomInTitle,"l7-button-control",t,this.zoomIn),this.controlOption.showZoom&&(this.zoomNumDiv=this.createButton("0","","l7-button-control l7-control-zoom__number",t)),this.zoomOutButton=this.createButton(this.controlOption.zoomOutText,this.controlOption.zoomOutTitle,"l7-button-control",t,this.zoomOut),this.updateDisabled()}createButton(t,r,n,i,a){const o=uo("button",n,i);return typeof t=="string"?o.innerHTML=t:o.append(t),o.title=r,a&&o.addEventListener("click",a),o}}class ikt extends $u.EventEmitter{get lngLat(){var t;return(t=this.popupOption.lngLat)!==null&&t!==void 0?t:{lng:0,lat:0}}set lngLat(t){this.popupOption.lngLat=t}constructor(t){super(),z(this,"popupOption",void 0),z(this,"mapsService",void 0),z(this,"sceneService",void 0),z(this,"layerService",void 0),z(this,"scene",void 0),z(this,"closeButton",void 0),z(this,"container",void 0),z(this,"content",void 0),z(this,"contentTitle",void 0),z(this,"contentPanel",void 0),z(this,"tip",void 0),z(this,"isShow",!0),z(this,"onMouseMove",n=>{var i;const a=this.mapsService.getMapContainer(),{left:o=0,top:s=0}=(i=a==null?void 0:a.getBoundingClientRect())!==null&&i!==void 0?i:{};this.setPopupPosition(n.clientX-o,n.clientY-s)}),z(this,"updateLngLatPosition",()=>{if(!this.mapsService||this.popupOption.followCursor)return;const{lng:n,lat:i}=this.lngLat,{x:a,y:o}=this.mapsService.lngLatToContainer([n,i]);this.setPopupPosition(a,o)}),z(this,"updateLngLatPositionWhenZoom",n=>{if(!this.mapsService||this.popupOption.followCursor)return;const i=n.map,a=i.getSize();a.x=a.x/2,a.y=a.y/2;const o=n.center,s=n.zoom,l=i.DE(this.lngLat,s,o);l.x=Math.round(l.x),l.y=Math.round(l.y),this.setPopupPosition(l.x,l.y,!0)}),z(this,"onKeyDown",n=>{n.keyCode===27&&this.remove()}),z(this,"onCloseButtonClick",n=>{n.stopPropagation&&n.stopPropagation(),this.hide()}),z(this,"updatePosition",(n,i=!0)=>{const a=!!this.lngLat,{className:o,style:s,maxWidth:l,anchor:u,stopPropagation:c}=this.popupOption;if(!this.mapsService||!a||!this.content)return;const f=this.mapsService.getMarkerContainer();if(!this.container&&f&&(this.container=uo("div",`l7-popup ${o??""} ${this.isShow?"":"l7-popup-hide"}`,f),s&&this.container.setAttribute("style",s),this.tip=uo("div","l7-popup-tip",this.container),this.container.appendChild(this.content),c&&["mousemove","mousedown","mouseup","click","dblclick"].forEach(d=>{this.container.addEventListener(d,v=>{v.stopPropagation()})}),this.container.style.whiteSpace="nowrap"),i?this.updateLngLatPositionWhenZoom(n):this.updateLngLatPosition(),hK(this.container,`${iM[u]}`),jZ(this.container,u,"popup"),l){const{width:d}=this.container.getBoundingClientRect();d>parseFloat(l)&&(this.container.style.width=l)}else this.container.style.removeProperty("width")}),z(this,"updateWhenZoom",n=>{this.updatePosition(n,!0)}),z(this,"update",()=>{this.updatePosition(null,!1)}),this.popupOption=Ce(Ce({},this.getDefault(t??{})),t);const{lngLat:r}=this.popupOption;r&&(this.lngLat=r)}getIsShow(){return this.isShow}addTo(t){this.mapsService=t.mapService,this.sceneService=t.sceneService,this.layerService=t.layerService,this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update),this.scene=t,this.update(),this.updateCloseOnClick(),this.updateCloseOnEsc(),this.updateFollowCursor();const{html:r,text:n,title:i}=this.popupOption;return r?this.setHTML(r):n&&this.setText(n),i&&this.setTitle(i),this.emit("open"),this}remove(){if(this!==null&&this!==void 0&&this.isOpen())return this.content&&Td(this.content),this.container&&(Td(this.container),delete this.container),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.updateCloseOnClick(!0),this.updateCloseOnEsc(!0),this.updateFollowCursor(!0),delete this.mapsService),this.emit("close"),this}getOptions(){return this.popupOption}setOptions(t){this.show();const{className:r}=this.popupOption;if(this.popupOption=Ce(Ce({},this.popupOption),t),this.checkUpdateOption(t,["html","text","title","closeButton","closeButtonOffsets","maxWidth","anchor","stopPropagation","lngLat","offsets"])&&(this.container&&(Td(this.container),this.container=void 0),this.popupOption.html?this.setHTML(this.popupOption.html):this.popupOption.text&&this.setText(this.popupOption.text),this.popupOption.title&&this.setTitle(this.popupOption.title)),this.checkUpdateOption(t,["closeOnEsc"])&&this.updateCloseOnEsc(),this.checkUpdateOption(t,["closeOnClick"])&&this.updateCloseOnClick(),this.checkUpdateOption(t,["followCursor"])&&this.updateFollowCursor(),this.checkUpdateOption(t,["html"])&&t.html?this.setHTML(t.html):this.checkUpdateOption(t,["text"])&&t.text&&this.setText(t.text),this.checkUpdateOption(t,["className"])){var n;r&&this.container.classList.remove(r??""),this.container.classList.add((n=t.className)!==null&&n!==void 0?n:"")}if(this.checkUpdateOption(t,["style"])){var i;H5(this.container,(i=t.style)!==null&&i!==void 0?i:"")}return this.checkUpdateOption(t,["lngLat"])&&t.lngLat&&this.setLnglat(t.lngLat),this}open(){return this.addTo(this.scene),this}close(){return this.remove(),this}show(){if(!this.isShow)return this.container&&cM(this.container,"l7-popup-hide"),this.isShow=!0,this.emit("show"),this}hide(){if(this.isShow)return this.container&&Pm(this.container,"l7-popup-hide"),this.isShow=!1,this.emit("hide"),this}setHTML(t){return this.popupOption.html=t,this.setDOMContent(t)}setText(t){return this.popupOption.text=t,this.setDOMContent(window.document.createTextNode(t))}setTitle(t){this.show(),this.popupOption.title=t,t?(this.contentTitle||(this.contentTitle=uo("div","l7-popup-content__title"),this.content.firstChild?this.content.insertBefore(this.contentTitle,this.content.firstChild):this.content.append(this.contentTitle)),_S(this.contentTitle),gy(this.contentTitle,t)):this.contentTitle&&(Td(this.contentTitle),this.contentTitle=void 0)}panToPopup(){const{lng:t,lat:r}=this.lngLat;return this.popupOption.autoPan&&this.mapsService.panTo([t,r]),this}setLngLat(t){return this.setLnglat(t)}setLnglat(t){return this.show(),this.lngLat=t,Array.isArray(t)&&(this.lngLat={lng:t[0],lat:t[1]}),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.update(),this.popupOption.autoPan&&setTimeout(()=>{this.panToPopup()},0),this}getLnglat(){return this.lngLat}setMaxWidth(t){return this.popupOption.maxWidth=t,this.update(),this}isOpen(){return!!this.mapsService}getDefault(t){return{closeButton:!0,closeOnClick:!1,maxWidth:"240px",offsets:[0,0],anchor:YR.BOTTOM,stopPropagation:!0,autoPan:!1,autoClose:!0,closeOnEsc:!1,followCursor:!1}}setDOMContent(t){return this.show(),this.createContent(),gy(this.contentPanel,t),this.update(),this}updateCloseOnClick(t){const r=this.mapsService;r&&(r==null||r.off("click",this.onCloseButtonClick),this.popupOption.closeOnClick&&!t&&requestAnimationFrame(()=>{r==null||r.on("click",this.onCloseButtonClick)}))}updateCloseOnEsc(t){window.removeEventListener("keydown",this.onKeyDown),this.popupOption.closeOnEsc&&!t&&window.addEventListener("keydown",this.onKeyDown)}updateFollowCursor(t){var r;const n=(r=this.mapsService)===null||r===void 0?void 0:r.getContainer();n&&(n==null||n.removeEventListener("mousemove",this.onMouseMove),this.popupOption.followCursor&&!t&&(n==null||n.addEventListener("mousemove",this.onMouseMove)))}createContent(){if(this.content&&Td(this.content),this.contentTitle=void 0,this.content=uo("div","l7-popup-content",this.container),this.setTitle(this.popupOption.title),this.popupOption.closeButton){const t=CD("l7-icon-guanbi");Pm(t,"l7-popup-close-button"),this.content.appendChild(t),this.popupOption.closeButtonOffsets&&(t.style.right=this.popupOption.closeButtonOffsets[0]+"px",t.style.top=this.popupOption.closeButtonOffsets[1]+"px"),t.setAttribute("aria-label","Close popup"),t.addEventListener("click",()=>{this.hide()}),t.addEventListener("pointerup",r=>{r.stopPropagation()}),t.addEventListener("pointerdown",r=>{r.stopPropagation()}),this.closeButton=t}else this.closeButton=void 0;this.contentPanel=uo("div","l7-popup-content__panel",this.content)}setPopupPosition(t,r,n=!1){if(this.container){const{offsets:i}=this.popupOption;this.container.style.left=t+i[0]+"px",this.container.style.top=r-i[1]+"px",n?this.container.style.transition="left 0.25s cubic-bezier(0,0,0.25,1), top 0.25s cubic-bezier(0,0,0.25,1)":this.container.style.transition=""}}checkUpdateOption(t,r){return r.some(n=>n in t)}}const{get:akt}=is;class D3e extends ikt{constructor(...t){super(...t),z(this,"layerClickCountByFrame",0),z(this,"layerConfigMap",new WeakMap),z(this,"displayFeatureInfo",void 0),z(this,"onLayerClick",(r,n)=>{requestAnimationFrame(()=>{if(this.popupOption.closeOnClick&&this.layerClickCountByFrame++,this.isShow&&this.isSameFeature(r,n.featureId))this.hide();else{const{title:i,content:a}=this.getLayerInfoFrag(r,n);this.setDOMContent(a),this.setLnglat(n.lngLat),this.setTitle(i),this.setDisplayFeatureInfo({layer:r,featureId:n.featureId}),this.show()}})}),z(this,"onSceneClick",()=>{this.layerClickCountByFrame=0,requestAnimationFrame(()=>{this.layerClickCountByFrame||this.hide()})}),z(this,"onLayerHide",()=>{this.hide(),this.setDisplayFeatureInfo(void 0)}),z(this,"updateCloseOnClick",()=>{})}get layerConfigItems(){var t;const{config:r,items:n}=this.popupOption;return(t=r??n)!==null&&t!==void 0?t:[]}addTo(t){return super.addTo(t),this.bindLayerEvent(),this.hide(),this}remove(){return super.remove(),this.unbindLayerEvent(),this}setOptions(t){this.unbindLayerEvent();const r=Ce({},t),n=r.trigger||this.popupOption.trigger,i=r.items||this.popupOption.items,a=(i==null?void 0:i.length)===0;r.followCursor=n==="hover"&&!a;const o=this.isShow;return super.setOptions(r),this.bindLayerEvent(),(a||!o)&&this.hide(),this}getDefault(t){const r=t.trigger!=="click";return Ce(Ce({},super.getDefault(t)),{},{trigger:"hover",followCursor:r,lngLat:{lng:0,lat:0},offsets:[0,10],closeButton:!1,closeOnClick:!0,autoClose:!1,closeOnEsc:!1})}bindLayerEvent(){const{trigger:t,closeOnClick:r}=this.popupOption;this.layerConfigItems.forEach(n=>{var i;const a=this.getLayerByConfig(n);if(!a)return;const o=Ce({},n);if(t==="hover"){const c=this.onLayerMouseMove.bind(this,a),f=this.onLayerMouseOut.bind(this,a);o.onMouseMove=c,o.onMouseOut=f,a==null||a.on("mousemove",c),a==null||a.on("mouseout",f)}else{var s;const c=this.onLayerClick.bind(this,a);o.onClick=c,a==null||a.on("click",c);const f=(s=this.mapsService)===null||s===void 0?void 0:s.getMapContainer();f&&r&&f.addEventListener("click",this.onSceneClick)}const l=a==null||(i=a.getSource)===null||i===void 0?void 0:i.call(a),u=this.onSourceUpdate.bind(this);l==null||l.on("update",u),o.onSourceUpdate=u,this.layerConfigMap.set(a,o)})}unbindLayerEvent(){this.layerConfigItems.forEach(t=>{var r;const n=this.getLayerByConfig(t),i=n&&this.layerConfigMap.get(n);if(!i)return;const{onMouseMove:a,onMouseOut:o,onClick:s,onSourceUpdate:l}=i;if(a&&n.off("mousemove",a),o&&n.off("mouseout",o),s&&n.off("click",s),l){var u;n==null||(u=n.getSource())===null||u===void 0||u.off("update",l)}const c=(r=this.mapsService)===null||r===void 0?void 0:r.getMapContainer();c&&c.removeEventListener("click",this.onSceneClick)})}onLayerMouseMove(t,r){if(!this.isSameFeature(t,r.featureId)){const{title:n,content:i}=this.getLayerInfoFrag(t,r);this.setDOMContent(i),this.setTitle(n),this.setDisplayFeatureInfo({layer:t,featureId:r.featureId}),this.show()}}onLayerMouseOut(t,r){this.setDisplayFeatureInfo(void 0),this.isShow&&this.hide()}onSourceUpdate(){this.hide(),this.setDisplayFeatureInfo(void 0)}getLayerInfoFrag(t,r){const n=this.layerConfigMap.get(t);let i;const a=document.createDocumentFragment();if(n){let o=r.feature;o.type==="Feature"&&"properties"in o&&"geometry"in o&&(o=o.properties);const{title:s,fields:l,customContent:u}=n;if(s){i=document.createDocumentFragment();const c=s instanceof Function?s(o):s;gy(i,c)}if(u){const c=u instanceof Function?u(o):u;gy(a,c)}else l!=null&&l.length&&(l==null||l.forEach(c=>{var f,d;const{field:v,formatField:g,formatValue:x,getValue:w}=typeof c=="string"?{field:c}:c,S=uo("div","l7-layer-popup__row"),A=w?w(r.feature):akt(o,v),M=(f=g instanceof Function?g(v,o):g)!==null&&f!==void 0?f:v;let R=(d=x instanceof Function?x(A,o):x)!==null&&d!==void 0?d:A;const O=uo("span","l7-layer-popup__key",S);gy(O,M),gy(O,document.createTextNode("："));const N=uo("span","l7-layer-popup__value",S);Array.isArray(R)&&R.every(k=>!(k instanceof Object))&&(R=R.map(k=>String(k)).join(",")),gy(N,R),a.appendChild(S)}))}return{title:i,content:a}}getLayerByConfig(t){const r=t.layer;if(r instanceof Object)return r;if(typeof r=="string")return this.layerService.getLayer(r)||this.layerService.getLayerByName(r)}isSameFeature(t,r){const n=this.displayFeatureInfo;return n&&t===n.layer&&r===n.featureId}setDisplayFeatureInfo(t){const r=this.displayFeatureInfo;r&&r.layer.off("hide",this.onLayerHide),t&&t.layer.on("hide",this.onLayerHide),this.displayFeatureInfo=t}}function okt(e,t){var r=typeof my<"u"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,n=typeof wx<"u"&&wx!==null&&(typeof wx.request<"u"||typeof wx.miniProgram<"u");if(!(r||n)&&(t||(t=document),!!t)){var i=t.head||t.getElementsByTagName("head")[0];if(!i){i=t.createElement("head");var a=t.body||t.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(i,a):t.documentElement.appendChild(i)}var o=t.createElement("style");return o.type="text/css",o.styleSheet?o.styleSheet.cssText=e:o.appendChild(t.createTextNode(e)),i.appendChild(o),o}}okt(`.l7-marker-container {
  position: absolute;
  width: 100%;
  height: 100%;
  overflow: hidden;
}
.l7-marker {
  position: absolute !important;
  top: 0;
  left: 0;
  z-index: 5;
  cursor: pointer;
}
.l7-marker-cluster {
  width: 40px;
  height: 40px;
  background-color: rgba(181, 226, 140, 0.6);
  background-clip: padding-box;
  border-radius: 20px;
}
.l7-marker-cluster div {
  width: 30px;
  height: 30px;
  margin-top: 5px;
  margin-left: 5px;
  font:
    12px 'Helvetica Neue',
    Arial,
    Helvetica,
    sans-serif;
  text-align: center;
  background-color: rgba(110, 204, 57, 0.6);
  border-radius: 15px;
}
.l7-marker-cluster span {
  line-height: 30px;
}
.l7-touch .l7-control-attribution,
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  box-shadow: none;
}
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  background-clip: padding-box;
  border: 2px solid rgba(0, 0, 0, 0.2);
}
.mapboxgl-ctrl-logo,
.amap-logo {
  display: none !important;
}
.l7-select-box {
  border: 3px dashed gray;
  border-radius: 2px;
  position: absolute;
  z-index: 999;
  box-sizing: border-box;
}
.l7-control-container {
  font:
    12px/1.5 'Helvetica Neue',
    Arial,
    Helvetica,
    sans-serif;
}
.l7-control-container .l7-control {
  position: relative;
  z-index: 999;
  float: left;
  clear: both;
  color: #595959;
  font-size: 12px;
  pointer-events: visiblePainted;
  /* IE 9-10 doesn't have auto */
  pointer-events: auto;
}
.l7-control-container .l7-control.l7-control--hide {
  display: none;
}
.l7-control-container .l7-top {
  top: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-top .l7-control:not(.l7-control--hide) {
  margin-top: 8px;
}
.l7-control-container .l7-right {
  right: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-right .l7-control:not(.l7-control--hide) {
  margin-right: 8px;
}
.l7-control-container .l7-bottom {
  bottom: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-bottom .l7-control:not(.l7-control--hide) {
  margin-bottom: 8px;
}
.l7-control-container .l7-left {
  left: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-left .l7-control:not(.l7-control--hide) {
  margin-left: 8px;
}
.l7-control-container .l7-center {
  position: absolute;
  display: flex;
  justify-content: center;
}
.l7-control-container .l7-center.l7-top,
.l7-control-container .l7-center.l7-bottom {
  width: 100%;
}
.l7-control-container .l7-center.l7-left,
.l7-control-container .l7-center.l7-right {
  height: 100%;
}
.l7-control-container .l7-center .l7-control {
  margin-right: 8px;
  margin-bottom: 8px;
}
.l7-control-container .l7-row {
  flex-direction: row;
}
.l7-control-container .l7-row.l7-top {
  align-items: flex-start;
}
.l7-control-container .l7-row.l7-bottom {
  align-items: flex-end;
}
.l7-control-container .l7-column {
  flex-direction: column;
}
.l7-control-container .l7-column.l7-left {
  align-items: flex-start;
}
.l7-control-container .l7-column.l7-right {
  align-items: flex-end;
}
.l7-button-control {
  min-width: 28px;
  height: 28px;
  background-color: #fff;
  border-width: 0;
  border-radius: 2px;
  outline: 0;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 0 6px;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  line-height: 16px;
}
.l7-button-control .l7-iconfont {
  fill: #595959;
  color: #595959;
  width: 16px;
  height: 16px;
}
.l7-button-control.l7-button-control--row {
  padding: 0 16px 0 13px;
}
.l7-button-control.l7-button-control--row * + .l7-button-control__text {
  margin-left: 8px;
}
.l7-button-control.l7-button-control--column {
  height: 44px;
  flex-direction: column;
}
.l7-button-control.l7-button-control--column .l7-iconfont {
  margin-top: 3px;
}
.l7-button-control.l7-button-control--column .l7-button-control__text {
  margin-top: 3px;
  font-size: 10px;
  -webkit-transform: scale(0.83333);
          transform: scale(0.83333);
}
.l7-button-control:not(:disabled):hover {
  background-color: #f3f3f3;
}
.l7-button-control:not(:disabled):active {
  background-color: #f3f3f3;
}
.l7-button-control:disabled {
  background-color: #fafafa;
  color: #bdbdbd;
  cursor: not-allowed;
}
.l7-button-control:disabled .l7-iconfont {
  fill: #bdbdbd;
  color: #bdbdbd;
}
.l7-button-control:disabled:hover {
  background-color: #fafafa;
}
.l7-button-control:disabled:active {
  background-color: #fafafa;
}
.l7-popper {
  position: absolute;
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 5;
  color: #595959;
}
.l7-popper.l7-popper-hide {
  display: none;
}
.l7-popper .l7-popper-content {
  min-height: 28px;
  background: #fff;
  border-radius: 2px;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper .l7-popper-arrow {
  width: 0;
  height: 0;
  border-width: 4px;
  border-style: solid;
  border-top-color: transparent;
  border-bottom-color: transparent;
  border-left-color: transparent;
  border-right-color: transparent;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper.l7-popper-left {
  flex-direction: row;
}
.l7-popper.l7-popper-left .l7-popper-arrow {
  border-left-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-right {
  flex-direction: row-reverse;
}
.l7-popper.l7-popper-right .l7-popper-arrow {
  border-right-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-top {
  flex-direction: column;
}
.l7-popper.l7-popper-top .l7-popper-arrow {
  border-top-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-bottom {
  flex-direction: column-reverse;
}
.l7-popper.l7-popper-bottom .l7-popper-arrow {
  border-bottom-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-start {
  align-items: flex-start;
}
.l7-popper.l7-popper-end {
  align-items: flex-end;
}
.l7-select-control--normal {
  padding: 4px 0;
}
.l7-select-control--normal .l7-select-control-item {
  display: flex;
  align-items: center;
  height: 24px;
  padding: 0 16px;
  font-size: 12px;
  line-height: 24px;
}
.l7-select-control--normal .l7-select-control-item > * + * {
  margin-left: 6px;
}
.l7-select-control--normal .l7-select-control-item input[type='checkbox'] {
  width: 14px;
  height: 14px;
}
.l7-select-control--normal .l7-select-control-item:hover {
  background-color: #f3f3f3;
}
.l7-select-control--image {
  display: flex;
  flex-wrap: wrap;
  align-items: flex-start;
  box-sizing: content-box;
  max-width: 460px;
  max-height: 400px;
  margin: 12px 0 0 12px;
  overflow-x: hidden;
  overflow-y: auto;
}
.l7-select-control--image .l7-select-control-item {
  position: relative;
  display: flex;
  flex: 0 0 calc((100% - (12px + 9px) * 2) / 3);
  flex-direction: column;
  justify-content: center;
  box-sizing: content-box;
  margin-right: 12px;
  margin-bottom: 12px;
  overflow: hidden;
  font-size: 12px;
  border: 1px solid #fff;
  border-radius: 2px;
}
.l7-select-control--image .l7-select-control-item img {
  width: 100%;
  height: 80px;
}
.l7-select-control--image .l7-select-control-item input[type='checkbox'] {
  position: absolute;
  top: 0;
  right: 0;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row {
  display: flex;
  align-items: center;
  justify-content: center;
  line-height: 26px;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row > * + * {
  margin-left: 8px;
}
.l7-select-control--image .l7-select-control-item.l7-select-control-item-active {
  border-color: #0370fe;
}
.l7-select-control-item {
  cursor: pointer;
}
.l7-select-control-item input[type='checkbox'] {
  margin: 0;
  cursor: pointer;
}
.l7-select-control--multiple .l7-select-control-item:hover {
  background-color: transparent;
}
.l7-control-logo {
  width: 89px;
  height: 16px;
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
}
.l7-control-logo img {
  height: 100%;
  width: 100%;
}
.l7-control-logo .l7-control-logo-link {
  display: block;
  cursor: pointer;
}
.l7-control-logo .l7-control-logo-link img {
  cursor: pointer;
}
.l7-control-mouse-location {
  background-color: #fff;
  border-radius: 2px;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  padding: 2px 4px;
  min-width: 130px;
}
.l7-control-zoom {
  overflow: hidden;
  border-radius: 2px;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-control-zoom .l7-button-control {
  font-size: 16px;
  border-bottom: 1px solid #f0f0f0;
  border-radius: 0;
  box-shadow: 0 0 0;
}
.l7-control-zoom .l7-button-control .l7-iconfont {
  width: 14px;
  height: 14px;
}
.l7-control-zoom .l7-button-control:last-child {
  border-bottom: 0;
}
.l7-control-zoom .l7-control-zoom__number {
  color: #595959;
  padding: 0;
}
.l7-control-zoom .l7-control-zoom__number:hover {
  background-color: #fff;
}
.l7-control-scale {
  display: flex;
  flex-direction: column;
}
.l7-control-scale .l7-control-scale-line {
  box-sizing: border-box;
  padding: 2px 5px 1px;
  overflow: hidden;
  color: #595959;
  font-size: 10px;
  line-height: 1.1;
  white-space: nowrap;
  background: #fff;
  border: 2px solid #000;
  border-top: 0;
  transition: width 0.1s;
}
.l7-control-scale .l7-control-scale-line + .l7-control-scale .l7-control-scale-line {
  margin-top: -2px;
  border-top: 2px solid #777;
  border-bottom: none;
}
.l7-right .l7-control-scale {
  display: flex;
  align-items: flex-end;
}
.l7-right .l7-control-scale .l7-control-scale-line {
  text-align: right;
}
.l7-popup {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 5;
  display: flex;
  will-change: transform;
  pointer-events: none;
}
.l7-popup.l7-popup-hide {
  display: none;
}
.l7-popup .l7-popup-content {
  position: relative;
  padding: 16px;
  font-size: 14px;
  background: #fff;
  border-radius: 3px;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}
.l7-popup .l7-popup-content .l7-popup-content__title {
  margin-bottom: 8px;
  font-weight: bold;
}
.l7-popup .l7-popup-content .l7-popup-close-button,
.l7-popup .l7-popup-content .l7-popup-content__title,
.l7-popup .l7-popup-content .l7-popup-content__panel {
  white-space: normal;
  -webkit-user-select: text;
     -moz-user-select: text;
      -ms-user-select: text;
          user-select: text;
  pointer-events: initial;
}
.l7-popup .l7-popup-content .l7-popup-close-button {
  position: absolute;
  top: 0;
  right: 0;
  width: 18px;
  height: 18px;
  padding: 0;
  font-size: 14px;
  line-height: 18px;
  text-align: center;
  background-color: transparent;
  border: 0;
  border-radius: 0 3px 0 0;
  cursor: pointer;
}
.l7-popup .l7-popup-tip {
  position: relative;
  z-index: 1;
  width: 0;
  height: 0;
  border: 10px solid transparent;
}
.l7-popup.l7-popup-anchor-bottom,
.l7-popup.l7-popup-anchor-bottom-left,
.l7-popup.l7-popup-anchor-bottom-right {
  flex-direction: column-reverse;
}
.l7-popup.l7-popup-anchor-bottom .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-right .l7-popup-tip {
  bottom: 1px;
}
.l7-popup.l7-popup-anchor-top,
.l7-popup.l7-popup-anchor-top-left,
.l7-popup.l7-popup-anchor-top-right {
  flex-direction: column;
}
.l7-popup.l7-popup-anchor-top .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-right .l7-popup-tip {
  top: 1px;
}
.l7-popup.l7-popup-anchor-left {
  flex-direction: row;
}
.l7-popup.l7-popup-anchor-right {
  flex-direction: row-reverse;
}
.l7-popup-anchor-top .l7-popup-tip {
  position: relative;
  align-self: center;
  border-top: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-tip {
  align-self: flex-start;
  border-top: none;
  border-bottom-color: #fff;
  border-left: none;
}
.l7-popup-anchor-top-right .l7-popup-tip {
  align-self: flex-end;
  border-top: none;
  border-right: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-bottom .l7-popup-tip {
  align-self: center;
  border-top-color: #fff;
  border-bottom: none;
}
.l7-popup-anchor-bottom-left .l7-popup-tip {
  align-self: flex-start;
  border-top-color: #fff;
  border-bottom: none;
  border-left: none;
}
.l7-popup-anchor-bottom-right .l7-popup-tip {
  align-self: flex-end;
  border-top-color: #fff;
  border-right: none;
  border-bottom: none;
}
.l7-popup-anchor-left .l7-popup-tip {
  align-self: center;
  border-right-color: #fff;
  border-left: none;
}
.l7-popup-anchor-right .l7-popup-tip {
  right: 1px;
  align-self: center;
  border-right: none;
  border-left-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-content {
  border-top-left-radius: 0;
}
.l7-popup-anchor-top-right .l7-popup-content {
  border-top-right-radius: 0;
}
.l7-popup-anchor-bottom-left .l7-popup-content {
  border-bottom-left-radius: 0;
}
.l7-popup-anchor-bottom-right .l7-popup-content {
  border-bottom-right-radius: 0;
}
.l7-popup-track-pointer {
  display: none;
}
.l7-popup-track-pointer * {
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
  pointer-events: none;
}
.l7-map:hover .l7-popup-track-pointer {
  display: flex;
}
.l7-map:active .l7-popup-track-pointer {
  display: none;
}
.l7-layer-popup__row {
  font-size: 12px;
}
.l7-layer-popup__row + .l7-layer-popup__row {
  margin-top: 4px;
}
.l7-control-swipe {
  position: absolute;
  top: 50%;
  left: 50%;
  z-index: 6;
  -webkit-transform: translate(-50%, -50%);
          transform: translate(-50%, -50%);
  touch-action: none;
}
.l7-control-swipe_hide {
  display: none;
}
.l7-control-swipe:before {
  position: absolute;
  top: -5000px;
  bottom: -5000px;
  left: 50%;
  z-index: -1;
  width: 4px;
  background: #fff;
  -webkit-transform: translate(-2px, 0);
          transform: translate(-2px, 0);
  content: '';
}
.l7-control-swipe.horizontal:before {
  top: 50%;
  right: -5000px;
  bottom: auto;
  left: -5000px;
  width: auto;
  height: 4px;
}
.l7-control-swipe__button {
  display: block;
  width: 28px;
  height: 28px;
  margin: 0;
  padding: 0;
  color: #595959;
  font-weight: bold;
  font-size: inherit;
  text-align: center;
  text-decoration: none;
  background-color: #fff;
  border: none;
  border-radius: 2px;
  outline: none;
}
.l7-control-swipe,
.l7-control-swipe__button {
  cursor: ew-resize;
}
.l7-control-swipe.horizontal,
.l7-control-swipe.horizontal button {
  cursor: ns-resize;
}
.l7-control-swipe:after,
.l7-control-swipe__button:before,
.l7-control-swipe__button:after {
  position: absolute;
  top: 25%;
  bottom: 25%;
  left: 50%;
  width: 2px;
  background: currentColor;
  -webkit-transform: translate(-1px, 0);
          transform: translate(-1px, 0);
  content: '';
}
.l7-control-swipe__button:after {
  -webkit-transform: translateX(4px);
          transform: translateX(4px);
}
.l7-control-swipe__button:before {
  -webkit-transform: translateX(-6px);
          transform: translateX(-6px);
}
`);class g4{constructor(t){z(this,"configService",void 0),z(this,"config",void 0),this.config=t}setContainer(t,r){this.configService=t.globalConfigService,t.mapConfig=Ce(Ce({},this.config),{},{id:r}),t.mapService=new(this.getServiceConstructor())(t)}getServiceConstructor(){throw new Error("Method not implemented.")}}var TJ={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(Cm,function(){function r(f){var d=[];return f.AMapUI&&d.push(n(f.AMapUI)),f.Loca&&d.push(i(f.Loca)),Promise.all(d)}function n(f){return new Promise(function(d,v){var g=[];if(f.plugins)for(var x=0;x<f.plugins.length;x+=1)o.AMapUI.plugins.indexOf(f.plugins[x])==-1&&g.push(f.plugins[x]);if(s.AMapUI===a.failed)v("前次请求 AMapUI 失败");else if(s.AMapUI===a.notload){s.AMapUI=a.loading,o.AMapUI.version=f.version||o.AMapUI.version,x=o.AMapUI.version;var w=document.body||document.head,S=document.createElement("script");S.type="text/javascript",S.src="https://webapi.amap.com/ui/"+x+"/main.js",S.onerror=function(A){s.AMapUI=a.failed,v("请求 AMapUI 失败")},S.onload=function(){if(s.AMapUI=a.loaded,g.length)window.AMapUI.loadUI(g,function(){for(var A=0,M=g.length;A<M;A++){var R=g[A].split("/").slice(-1)[0];window.AMapUI[R]=arguments[A]}for(d();l.AMapUI.length;)l.AMapUI.splice(0,1)[0]()});else for(d();l.AMapUI.length;)l.AMapUI.splice(0,1)[0]()},w.appendChild(S)}else s.AMapUI===a.loaded?f.version&&f.version!==o.AMapUI.version?v("不允许多个版本 AMapUI 混用"):g.length?window.AMapUI.loadUI(g,function(){for(var A=0,M=g.length;A<M;A++){var R=g[A].split("/").slice(-1)[0];window.AMapUI[R]=arguments[A]}d()}):d():f.version&&f.version!==o.AMapUI.version?v("不允许多个版本 AMapUI 混用"):l.AMapUI.push(function(A){A?v(A):g.length?window.AMapUI.loadUI(g,function(){for(var M=0,R=g.length;M<R;M++){var O=g[M].split("/").slice(-1)[0];window.AMapUI[O]=arguments[M]}d()}):d()})})}function i(f){return new Promise(function(d,v){if(s.Loca===a.failed)v("前次请求 Loca 失败");else if(s.Loca===a.notload){s.Loca=a.loading,o.Loca.version=f.version||o.Loca.version;var g=o.Loca.version,x=o.AMap.version.startsWith("2"),w=g.startsWith("2");if(x&&!w||!x&&w)v("JSAPI 与 Loca 版本不对应！！");else{x=o.key,w=document.body||document.head;var S=document.createElement("script");S.type="text/javascript",S.src="https://webapi.amap.com/loca?v="+g+"&key="+x,S.onerror=function(A){s.Loca=a.failed,v("请求 AMapUI 失败")},S.onload=function(){for(s.Loca=a.loaded,d();l.Loca.length;)l.Loca.splice(0,1)[0]()},w.appendChild(S)}}else s.Loca===a.loaded?f.version&&f.version!==o.Loca.version?v("不允许多个版本 Loca 混用"):d():f.version&&f.version!==o.Loca.version?v("不允许多个版本 Loca 混用"):l.Loca.push(function(A){A?v(A):v()})})}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var a;(function(f){f.notload="notload",f.loading="loading",f.loaded="loaded",f.failed="failed"})(a||(a={}));var o={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},s={AMap:a.notload,AMapUI:a.notload,Loca:a.notload},l={AMap:[],AMapUI:[],Loca:[]},u=[],c=function(f){typeof f=="function"&&(s.AMap===a.loaded?f(window.AMap):u.push(f))};return{load:function(f){return new Promise(function(d,v){if(s.AMap==a.failed)v("");else if(s.AMap==a.notload){var g=f.key,x=f.version,w=f.plugins;g?(window.AMap&&location.host!=="lbs.amap.com"&&v("禁止多种API加载方式混用"),o.key=g,o.AMap.version=x||o.AMap.version,o.AMap.plugins=w||o.AMap.plugins,s.AMap=a.loading,x=document.body||document.head,window.___onAPILoaded=function(A){if(delete window.___onAPILoaded,A)s.AMap=a.failed,v(A);else for(s.AMap=a.loaded,r(f).then(function(){d(window.AMap)}).catch(v);u.length;)u.splice(0,1)[0]()},w=document.createElement("script"),w.type="text/javascript",w.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+o.AMap.version+"&key="+g+"&plugin="+o.AMap.plugins.join(","),w.onerror=function(A){s.AMap=a.failed,v(A)},x.appendChild(w)):v("请填写key")}else if(s.AMap==a.loaded)if(f.key&&f.key!==o.key)v("多个不一致的 key");else if(f.version&&f.version!==o.AMap.version)v("不允许多个版本 JSAPI 混用");else{if(g=[],f.plugins)for(x=0;x<f.plugins.length;x+=1)o.AMap.plugins.indexOf(f.plugins[x])==-1&&g.push(f.plugins[x]);g.length?window.AMap.plugin(g,function(){r(f).then(function(){d(window.AMap)}).catch(v)}):r(f).then(function(){d(window.AMap)}).catch(v)}else if(f.key&&f.key!==o.key)v("多个不一致的 key");else if(f.version&&f.version!==o.AMap.version)v("不允许多个版本 JSAPI 混用");else{var S=[];if(f.plugins)for(x=0;x<f.plugins.length;x+=1)o.AMap.plugins.indexOf(f.plugins[x])==-1&&S.push(f.plugins[x]);c(function(){S.length?window.AMap.plugin(S,function(){r(f).then(function(){d(window.AMap)}).catch(v)}):r(f).then(function(){d(window.AMap)}).catch(v)})}})},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,o={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},s={AMap:a.notload,AMapUI:a.notload,Loca:a.notload},l={AMap:[],AMapUI:[],Loca:[]}}}})})(TJ);var skt=TJ.exports;const lkt=aa(skt);class AJ{constructor(t){z(this,"size",1e4),this.size=t||1e4}setSize(t){this.size=t}getSize(){return[this.size,this.size]}mercatorXfromLng(t){return(180+t)/360*this.size}mercatorYfromLat(t){return(1-(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360)*this.size}lngFromMercatorX(t){return t/this.size*360-180}latFromMercatorY(t){const r=180-(1-t/this.size)*360;return 360/Math.PI*Math.atan(Math.exp(r*Math.PI/180))-90}project(t){const r=this.mercatorXfromLng(t[0]),n=this.mercatorYfromLat(t[1]);return[r,n]}unproject(t){const r=this.lngFromMercatorX(t[0]),n=this.latFromMercatorY(t[1]);return[r,n]}}const ukt=12;class ckt{constructor(t){z(this,"map",void 0),z(this,"simpleMapCoord",new AJ),z(this,"bgColor","rgba(0.0, 0.0, 0.0, 0.0)"),z(this,"config",void 0),z(this,"configService",void 0),z(this,"coordinateSystemService",void 0),z(this,"eventEmitter",void 0),z(this,"markerContainer",void 0),z(this,"mapContainer",void 0),z(this,"cameraChangedCallback",void 0),this.config=t.mapConfig,this.configService=t.globalConfigService,this.coordinateSystemService=t.coordinateSystemService,this.eventEmitter=new $u.EventEmitter}onCameraChanged(t){this.cameraChangedCallback=t}updateView(t){var r;this.emit("mapchange"),this.viewport.syncWithMapCamera({bearing:t.bearing,center:t.center,viewportHeight:t.viewportHeight,pitch:t.pitch,viewportWidth:t.viewportWidth,zoom:t.zoom}),this.updateCoordinateSystemService(),(r=this.cameraChangedCallback)===null||r===void 0||r.call(this,this.viewport)}updateCoordinateSystemService(){const{offsetCoordinate:t=!0}=this.config;this.viewport.getZoom()>ukt&&t?this.coordinateSystemService.setCoordinateSystem(Ox.LNGLAT_OFFSET):this.coordinateSystemService.setCoordinateSystem(Ox.LNGLAT)}creatMapContainer(t){let r;return typeof t=="string"?r=document.getElementById(t):r=t,r}getMapStyleValue(t){var r;return(r=this.getMapStyleConfig()[t])!==null&&r!==void 0?r:t}setBgColor(t){this.bgColor=t}getMapContainer(){return this.mapContainer}getMarkerContainer(){return this.markerContainer}getOverlayContainer(){}getCanvasOverlays(){}emit(t,...r){this.eventEmitter.emit(t,...r)}once(t,r){this.eventEmitter.once(t,r)}meterToCoord(t,r){return 1}destroy(){this.eventEmitter.removeAllListeners()}}function MJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,PZ(n.key),n)}}function RJ(e,t,r){return t&&M$(e.prototype,t),r&&M$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pw(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hkt(e,t){if(t&&(nM(t)=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pw(e)}function HD(e){return HD=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},HD(e)}function VD(e,t){return VD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},VD(e,t)}function fkt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&VD(e,t)}function dkt(e){if(Array.isArray(e))return e}function pkt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function R$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function vkt(e,t){if(e){if(typeof e=="string")return R$(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?R$(e,t):void 0}}function gkt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Df(e,t){return dkt(e)||pkt(e,t)||vkt(e,t)||gkt()}function Pw(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function MA(e,t){var r=bm([],t,e);return rIt(r,r,1/r[3]),r}function Ky(e,t){if(!e)throw new Error(t||"viewport-mercator-project: assertion failed.")}var Ld=Math.PI,IJ=Ld/4,Bm=Ld/180,I$=180/Ld,m4=512,L$=4003e4,mkt=1.5;function LJ(e){return Math.pow(2,e)}function EO(e,t){var r=Df(e,2),n=r[0],i=r[1];Ky(Number.isFinite(n)&&Number.isFinite(t)),Ky(Number.isFinite(i)&&i>=-90&&i<=90,"invalid latitude"),t*=m4;var a=n*Bm,o=i*Bm,s=t*(a+Ld)/(2*Ld),l=t*(Ld-Math.log(Math.tan(IJ+o*.5)))/(2*Ld);return[s,l]}function O$(e,t){var r=Df(e,2),n=r[0],i=r[1];t*=m4;var a=n/t*(2*Ld)-Ld,o=2*(Math.atan(Math.exp(Ld-i/t*(2*Ld)))-IJ);return[a*I$,o*I$]}function ykt(e){var t=e.latitude,r=e.longitude,n=e.zoom,i=e.scale,a=e.highPrecision,o=a===void 0?!1:a;i=i!==void 0?i:LJ(n),Ky(Number.isFinite(t)&&Number.isFinite(r)&&Number.isFinite(i));var s={},l=m4*i,u=Math.cos(t*Bm),c=l/360,f=c/u,d=l/L$/u;if(s.pixelsPerMeter=[d,-d,d],s.metersPerPixel=[1/d,-1/d,1/d],s.pixelsPerDegree=[c,-f,d],s.degreesPerPixel=[1/c,-1/f,1/d],o){var v=Bm*Math.tan(t*Bm)/u,g=c*v/2,x=l/L$*v,w=x/f*d;s.pixelsPerDegree2=[0,-g,x],s.pixelsPerMeter2=[w,0,w]}return s}function _kt(e){var t=e.height,r=e.pitch,n=e.bearing,i=e.altitude,a=e.center,o=a===void 0?null:a,s=e.flipY,l=s===void 0?!1:s,u=Pw();return Lf(u,u,[0,0,-i]),Of(u,u,[1,1,1/t]),bb(u,u,-r*Bm),ES(u,u,n*Bm),l&&Of(u,u,[1,-1,1]),o&&Lf(u,u,QRt([],o)),u}function xkt(e){var t=e.width,r=e.height,n=e.altitude,i=n===void 0?mkt:n,a=e.pitch,o=a===void 0?0:a,s=e.nearZMultiplier,l=s===void 0?1:s,u=e.farZMultiplier,c=u===void 0?1:u,f=o*Bm,d=Math.atan(.5/i),v=Math.sin(d)*i/Math.sin(Math.PI/2-f-d),g=Math.cos(Math.PI/2-f)*v+i;return{fov:2*Math.atan(r/2/i),aspect:t/r,focalDistance:i,near:l,far:g*c}}function bkt(e){var t=e.width,r=e.height,n=e.pitch,i=e.altitude,a=e.nearZMultiplier,o=e.farZMultiplier,s=xkt({width:t,height:r,altitude:i,pitch:n,nearZMultiplier:a,farZMultiplier:o}),l=s.fov,u=s.aspect,c=s.near,f=s.far,d=zK([],l,u,c,f);return d}function Ekt(e,t){var r=Df(e,3),n=r[0],i=r[1],a=r[2],o=a===void 0?0:a;return Ky(Number.isFinite(n)&&Number.isFinite(i)&&Number.isFinite(o)),MA(t,[n,i,o,1])}function OJ(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=Df(e,3),i=n[0],a=n[1],o=n[2];if(Ky(Number.isFinite(i)&&Number.isFinite(a),"invalid pixel coordinate"),Number.isFinite(o)){var s=MA(t,[i,a,o,1]);return s}var l=MA(t,[i,a,0,1]),u=MA(t,[i,a,1,1]),c=l[2],f=u[2],d=c===f?0:((r||0)-c)/(f-c);return aIt([],l,u,d)}var P$=Pw(),wkt=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.width,n=t.height,i=t.viewMatrix,a=i===void 0?P$:i,o=t.projectionMatrix,s=o===void 0?P$:o;MJ(this,e),this.width=r||1,this.height=n||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=a,this.projectionMatrix=s;var l=Pw();Dm(l,l,this.projectionMatrix),Dm(l,l,this.viewMatrix),this.viewProjectionMatrix=l;var u=Pw();Of(u,u,[this.width/2,-this.height/2,1]),Lf(u,u,[1,-1,0]),Dm(u,u,this.viewProjectionMatrix);var c=aC(Pw(),u);if(!c)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=u,this.pixelUnprojectionMatrix=c,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return RJ(e,[{key:"equals",value:function(r){return r instanceof e?r.width===this.width&&r.height===this.height&&vU(r.projectionMatrix,this.projectionMatrix)&&vU(r.viewMatrix,this.viewMatrix):!1}},{key:"project",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.topLeft,a=i===void 0?!0:i,o=this.projectPosition(r),s=Ekt(o,this.pixelProjectionMatrix),l=Df(s,2),u=l[0],c=l[1],f=a?c:this.height-c;return r.length===2?[u,f]:[u,f,s[2]]}},{key:"unproject",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.topLeft,a=i===void 0?!0:i,o=n.targetZ,s=Df(r,3),l=s[0],u=s[1],c=s[2],f=a?u:this.height-u,d=o&&o*this.pixelsPerMeter,v=OJ([l,f,c],this.pixelUnprojectionMatrix,d),g=this.unprojectPosition(v),x=Df(g,3),w=x[0],S=x[1],A=x[2];return Number.isFinite(c)?[w,S,A]:Number.isFinite(o)?[w,S,o]:[w,S]}},{key:"projectPosition",value:function(r){var n=this.projectFlat(r),i=Df(n,2),a=i[0],o=i[1],s=(r[2]||0)*this.pixelsPerMeter;return[a,o,s]}},{key:"unprojectPosition",value:function(r){var n=this.unprojectFlat(r),i=Df(n,2),a=i[0],o=i[1],s=(r[2]||0)/this.pixelsPerMeter;return[a,o,s]}},{key:"projectFlat",value:function(r){return arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale,r}},{key:"unprojectFlat",value:function(r){return arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale,r}}]),e}();function Ckt(e){var t=e.width,r=e.height,n=e.bounds,i=e.minExtent,a=i===void 0?0:i,o=e.maxZoom,s=o===void 0?24:o,l=e.padding,u=l===void 0?0:l,c=e.offset,f=c===void 0?[0,0]:c,d=Df(n,2),v=Df(d[0],2),g=v[0],x=v[1],w=Df(d[1],2),S=w[0],A=w[1];if(Number.isFinite(u)){var M=u;u={top:M,bottom:M,left:M,right:M}}else Ky(Number.isFinite(u.top)&&Number.isFinite(u.bottom)&&Number.isFinite(u.left)&&Number.isFinite(u.right));var R=new GD({width:t,height:r,longitude:0,latitude:0,zoom:0}),O=R.project([g,A]),N=R.project([S,x]),k=[Math.max(Math.abs(N[0]-O[0]),a),Math.max(Math.abs(N[1]-O[1]),a)],V=[t-u.left-u.right-Math.abs(f[0])*2,r-u.top-u.bottom-Math.abs(f[1])*2];Ky(V[0]>0&&V[1]>0);var Q=V[0]/k[0],Y=V[1]/k[1],X=(u.right-u.left)/2/Q,tt=(u.bottom-u.top)/2/Y,it=[(N[0]+O[0])/2+X,(N[1]+O[1])/2+tt],Et=R.unproject(it),Tt=R.zoom+Math.log2(Math.abs(Math.min(Q,Y)));return{longitude:Et[0],latitude:Et[1],zoom:Math.min(Tt,s)}}var GD=function(e){fkt(t,e);function t(){var r,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=n.width,a=n.height,o=n.latitude,s=o===void 0?0:o,l=n.longitude,u=l===void 0?0:l,c=n.zoom,f=c===void 0?0:c,d=n.pitch,v=d===void 0?0:d,g=n.bearing,x=g===void 0?0:g,w=n.altitude,S=w===void 0?1.5:w,A=n.nearZMultiplier,M=n.farZMultiplier;MJ(this,t),i=i||1,a=a||1;var R=LJ(f);S=Math.max(.75,S);var O=EO([u,s],R);O[2]=0;var N=bkt({width:i,height:a,pitch:v,bearing:x,altitude:S,nearZMultiplier:A||1/a,farZMultiplier:M||1.01}),k=_kt({height:a,center:O,pitch:v,bearing:x,altitude:S,flipY:!0});return r=hkt(this,HD(t).call(this,{width:i,height:a,viewMatrix:k,projectionMatrix:N})),r.latitude=s,r.longitude=u,r.zoom=f,r.pitch=v,r.bearing=x,r.altitude=S,r.scale=R,r.center=O,r.pixelsPerMeter=ykt(pw(pw(r))).pixelsPerMeter[2],Object.freeze(pw(pw(r))),r}return RJ(t,[{key:"projectFlat",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return EO(n,i)}},{key:"unprojectFlat",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return O$(n,i)}},{key:"getMapCenterByLngLatPosition",value:function(n){var i=n.lngLat,a=n.pos,o=OJ(a,this.pixelUnprojectionMatrix),s=EO(i,this.scale),l=zl([],s,iIt([],o)),u=zl([],this.center,l);return O$(u,this.scale)}},{key:"getLocationAtPoint",value:function(n){var i=n.lngLat,a=n.pos;return this.getMapCenterByLngLatPosition({lngLat:i,pos:a})}},{key:"fitBounds",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=this.width,o=this.height,s=Ckt(Object.assign({width:a,height:o,bounds:n},i)),l=s.longitude,u=s.latitude,c=s.zoom;return new t({width:a,height:o,longitude:l,latitude:u,zoom:c})}}]),t}(wkt);class y4{constructor(){z(this,"viewport",new GD)}syncWithMapCamera(t){const{center:r,zoom:n,pitch:i,bearing:a,viewportHeight:o,viewportWidth:s}=t,l={width:this.viewport.width,height:this.viewport.height,longitude:this.viewport.center[0],latitude:this.viewport.center[1],zoom:this.viewport.zoom,pitch:this.viewport.pitch,bearing:this.viewport.bearing};this.viewport=new GD(Ce(Ce({},l),{},{width:s,height:o,longitude:r&&r[0],latitude:r&&r[1],zoom:n,pitch:i,bearing:a}))}getZoom(){return this.viewport.zoom}getZoomScale(){return Math.pow(2,this.getZoom())}getCenter(){return[this.viewport.longitude,this.viewport.latitude]}getProjectionMatrix(){return this.viewport.projectionMatrix}getModelMatrix(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}getViewMatrix(){return this.viewport.viewMatrix}getViewMatrixUncentered(){return this.viewport.viewMatrixUncentered}getViewProjectionMatrix(){return this.viewport.viewProjectionMatrix}getViewProjectionMatrixUncentered(){return this.viewport.viewProjectionMatrix}getFocalDistance(){return 1}projectFlat(t,r){return this.viewport.projectFlat(t,r)}}let PJ=function(e){return e.GAODE="GAODE",e.MAPBOX="MAPBOX",e.DEFAULT="DEFAUlTMAP",e.SIMPLE="SIMPLE",e.GLOBEL="GLOBEL",e}({});function D$(e={}){const t={top:0,right:0,bottom:0,left:0};if(typeof e=="number")return{top:e,right:e,bottom:e,left:e};if(Array.isArray(e)){if(e.length===4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(e.length===2)return{top:e[0],right:e[1],bottom:e[0],left:e[1]}}return Ce(Ce({},t),e)}const Skt={normal:"amap://styles/normal",light:"amap://styles/c422f5c0cfced5be9fe3a83f05f28a68?isPublic=true",dark:"amap://styles/c9f1d10cae34f8ab05e425462c5a58d7?isPublic=true",blank:"amap://styles/07c17002b38775b32a7a76c66cf90e99?isPublic=true",fresh:"amap://styles/fresh",grey:"amap://styles/grey",graffiti:"amap://styles/graffiti",macaron:"amap://styles/macaron",darkblue:"amap://styles/darkblue",wine:"amap://styles/wine"},Tkt=["id","style","minZoom","maxZoom","token","mapInstance","plugin"];function Akt(e,t){var r=typeof my<"u"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,n=typeof wx<"u"&&wx!==null&&(typeof wx.request<"u"||typeof wx.miniProgram<"u");if(!(r||n)&&(t||(t=document),!!t)){var i=t.head||t.getElementsByTagName("head")[0];if(!i){i=t.createElement("head");var a=t.body||t.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(i,a):t.documentElement.appendChild(i)}var o=t.createElement("style");return o.type="text/css",o.styleSheet?o.styleSheet.cssText=e:o.appendChild(t.createTextNode(e)),i.appendChild(o),o}}Akt(`.amap-logo {
  display: none !important;
}
.amap-copyright {
  display: none !important;
}
.amap-overlays {
  z-index: 3 !important;
}
`);const Mkt="2.0",F$="f59bcf249433f8b05caaee19f349b3d7",ny=1,B$={contextmenu:"rightclick",camerachange:"viewchange"};class Rkt extends ckt{constructor(...t){super(...t),z(this,"viewport",new y4),z(this,"version",PJ.GAODE),z(this,"handleCameraChanged",()=>{const r=this.getViewState();this.updateView(r)})}getType(){return"amap"}init(){var t=this;return Pe(function*(){const r=t.config,{id:n,style:i="light",minZoom:a=0,maxZoom:o=24,token:s=F$,mapInstance:l,plugin:u=[]}=r,c=Hf(r,Tkt);if(window.AMap||l||(u.push("Map3D"),yield lkt.load({key:s,version:Mkt,plugins:u})),l)t.map=l,t.mapContainer=t.map.getContainer(),t.map.on("viewchange",t.handleCameraChanged);else{const f=Ce({mapStyle:t.getMapStyleValue(i),zooms:[a,o],viewMode:"3D"},c);if(f.zoom&&(f.zoom+=ny),s===F$&&(window._AMapSecurityConfig={securityJsCode:"2653011adeb04230b3a26cc9a780a800"},console.warn(`%c${t.configService.getSceneWarninfo("MapToken")}!`,"color: #873bf4;font-weigh:900;font-size: 16px;")),!n)throw Error("No container id specified");window.forceWebGL=!0,t.mapContainer=t.creatMapContainer(n);const d=new AMap.Map(t.mapContainer,f);t.map=d,d.on("viewchange",t.handleCameraChanged)}t.syncInitViewPort()})()}syncInitViewPort(){const t=this.getViewState();this.updateView(t)}getViewState(){const{center:t,zoom:r}=Ikt(this.map);return{center:t,viewportWidth:this.map.getContainer().clientWidth,viewportHeight:this.map.getContainer().clientHeight,bearing:-this.map.getRotation(),pitch:this.map.getPitch(),zoom:r-ny}}creatMapContainer(t){const r=super.creatMapContainer(t),n=document.createElement("div");return n.style.cssText+=`
       position: absolute;
       top: 0;
       height: 100%;
       width: 100%;
     `,n.id=is.uniqueId("l7_amap_div"),r.appendChild(n),n}getContainer(){return this.map.getContainer()}addMarkerContainer(){if(!this.map)return;const t=this.map.getContainer();if(t!==null){const r=t.getElementsByClassName("amap-maps")[0];r.style.zIndex="auto",this.markerContainer=uo("div","l7-marker-container2",r)}}getMarkerContainer(){return this.markerContainer}getCanvasOverlays(){var t;return(t=this.mapContainer)===null||t===void 0?void 0:t.querySelector(".amap-overlays")}on(t,r){hD.indexOf(t)!==-1?this.eventEmitter.on(t,r):this.map.on(B$[t]||t,r)}off(t,r){hD.indexOf(t)!==-1?this.eventEmitter.off(t,r):this.map.off(B$[t]||t,r)}getSize(){const t=this.map.getSize();return[t.getWidth(),t.getHeight()]}getMinZoom(){return this.map.getZooms()[0]-ny}getMaxZoom(){return this.map.getZooms()[1]-ny}getZoom(){return this.map.getZoom()-ny}getCenter(t){if(t!=null&&t.padding){const n=this.getCenter(),i=D$(t.padding),a=this.lngLatToPixel([n.lng,n.lat]),o=[(i.right-i.left)/2,(i.bottom-i.top)/2];return this.pixelToLngLat([a.x-o[0],a.y-o[1]])}const r=this.map.getCenter();return{lng:r.getLng(),lat:r.getLat()}}getPitch(){return this.map.getPitch()}getRotation(){return 360-this.map.getRotation()}getBounds(){const t=this.map.getBounds(),r=t.getNorthEast(),n=t.getSouthWest(),i=this.getCenter(),a=i.lng>r.getLng()||i.lng<n.getLng()?180-r.getLng():r.getLng();return[[i.lng<n.getLng()?n.getLng()-180:n.getLng(),n.getLat()],[a,r.getLat()]]}getMapContainer(){return this.mapContainer}getMapCanvasContainer(){var t;return(t=this.map.getContainer())===null||t===void 0?void 0:t.getElementsByClassName("amap-maps")[0]}getMapStyleConfig(){return Skt}getMapStyleValue(t){return this.getMapStyleConfig()[t]||t}getMapStyle(){return this.map.getMapStyle()}setMapStyle(t){this.map.setMapStyle(this.getMapStyleValue(t))}setRotation(t){return this.map.setRotation(t)}zoomIn(){this.map.zoomIn()}zoomOut(){this.map.zoomOut()}panTo(t){this.map.panTo(t)}panBy(t=0,r=0){this.map.panBy(t,r)}fitBounds(t){this.map.setBounds(new AMap.Bounds([t[0][0],t[0][1],t[1][0],t[1][1]]),!0)}setZoomAndCenter(t,r){this.map.setZoomAndCenter(t+ny,r)}setCenter(t,r){if(r!=null&&r.padding){const n=D$(r.padding),i=this.lngLatToPixel(t),a=[(n.right-n.left)/2,(n.bottom-n.top)/2],o=this.pixelToLngLat([i.x+a[0],i.y+a[1]]);this.map.setCenter([o.lng,o.lat])}else this.map.setCenter(t)}setPitch(t){return this.map.setPitch(t)}setZoom(t){return this.map.setZoom(t+ny)}setMaxZoom(t){throw new Error("Method not implemented.")}setMinZoom(t){throw new Error("Method not implemented.")}setMapStatus(t){this.map.setStatus(t)}meterToCoord(t,r){const n=AMap.GeometryUtil.distance(new AMap.LngLat(...t),new AMap.LngLat(...r)),[i,a]=tO(...t),[o,s]=tO(...r);return Math.sqrt(Math.pow(i-o,2)+Math.pow(a-s,2))/n}pixelToLngLat(t){const r=this.map.pixelToLngLat(new AMap.Pixel(t[0],t[1]));return{lng:r.getLng(),lat:r.getLat()}}lngLatToPixel(t){const r=this.map.lnglatToPixel(t);return{x:r.getX(),y:r.getY()}}containerToLngLat(t){const r=new AMap.Pixel(t[0],t[1]),n=this.map.containerToLngLat(r);return{lng:n==null?void 0:n.getLng(),lat:n==null?void 0:n.getLat()}}lngLatToContainer(t){const r=this.map.lngLatToContainer(t);return{x:r.getX(),y:r.getY()}}lngLatToMercator([t,r],n){const[i,a]=tO(t,r);return{x:i,y:a,z:n}}getModelMatrix(t,r,n,i=[1,1,1]){const a=this.viewport.projectFlat(t),o=xb();return Lf(o,o,ec(a[0],a[1],r)),Of(o,o,ec(i[0],i[1],i[2])),bb(o,o,n[0]),cI(o,o,n[1]),ES(o,o,n[2]),o}exportMap(t){var r;const n=(r=this.getContainer())===null||r===void 0?void 0:r.getElementsByClassName("amap-layer")[0];return t==="jpg"?n==null?void 0:n.toDataURL("image/jpeg"):n==null?void 0:n.toDataURL("image/png")}destroy(){var t;super.destroy(),(t=this.mapContainer)===null||t===void 0||(t=t.parentNode)===null||t===void 0||t.removeChild(this.mapContainer),delete window.initAMap;const r=document.getElementById("amap-script");r&&document.head.removeChild(r),this.map.destroy()}}function Ikt(e){const t=e._view.getOptions(),r=t.center,n=t.zoom;return{center:r,zoom:n}}class _4 extends g4{getServiceConstructor(){return Rkt}}const Lkt={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},N$={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},Okt=12;class DJ{constructor(t){z(this,"version","DEFAUlTMAP"),z(this,"map",void 0),z(this,"simpleMapCoord",new AJ),z(this,"bgColor","rgba(0.0, 0.0, 0.0, 0.0)"),z(this,"config",void 0),z(this,"configService",void 0),z(this,"coordinateSystemService",void 0),z(this,"eventEmitter",void 0),z(this,"markerContainer",void 0),z(this,"cameraChangedCallback",void 0),z(this,"$mapContainer",void 0),z(this,"handleCameraChanged",r=>{const{lat:n,lng:i}=this.map.getCenter();this.emit("mapchange"),this.viewport.syncWithMapCamera({bearing:this.map.getBearing(),center:[i,n],viewportHeight:this.map.transform.height,pitch:this.map.getPitch(),viewportWidth:this.map.transform.width,zoom:this.map.getZoom(),cameraHeight:0}),this.updateCoordinateSystemService(),this.cameraChangedCallback(this.viewport)}),this.config=t.mapConfig,this.configService=t.globalConfigService,this.coordinateSystemService=t.coordinateSystemService,this.eventEmitter=new $u.EventEmitter}setBgColor(t){this.bgColor=t}addMarkerContainer(){const t=this.map.getCanvasContainer();this.markerContainer=uo("div","l7-marker-container",t),this.markerContainer.setAttribute("tabindex","-1")}getMarkerContainer(){return this.markerContainer}getOverlayContainer(){}getCanvasOverlays(){}on(t,r){hD.indexOf(t)!==-1?this.eventEmitter.on(t,r):this.map.on(N$[t]||t,r)}off(t,r){this.map.off(N$[t]||t,r),this.eventEmitter.off(t,r)}getContainer(){return this.map.getContainer()}getMapCanvasContainer(){return this.map.getCanvasContainer()}getSize(){if(this.version==="SIMPLE")return this.simpleMapCoord.getSize();const t=this.map.transform;return[t.width,t.height]}getType(){return"default"}getZoom(){return this.map.getZoom()}setZoom(t){return this.map.setZoom(t)}getCenter(){return this.map.getCenter()}setCenter(t){this.map.setCenter(t)}getPitch(){return this.map.getPitch()}getRotation(){return this.map.getBearing()}getBounds(){return this.map.getBounds().toArray()}getMinZoom(){return this.map.getMinZoom()}getMaxZoom(){return this.map.getMaxZoom()}setRotation(t){this.map.setBearing(t)}zoomIn(t,r){this.map.zoomIn(t,r)}zoomOut(t,r){this.map.zoomOut(t,r)}setPitch(t){return this.map.setPitch(t)}panTo(t){this.map.panTo(t)}panBy(t=0,r=0){this.map.panBy([t,r])}fitBounds(t,r){this.map.fitBounds(t,r)}setMaxZoom(t){this.map.setMaxZoom(t)}setMinZoom(t){this.map.setMinZoom(t)}setMapStatus(t){t.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),t.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),t.dragEnable===!1&&this.map.dragPan.disable(),t.dragEnable===!0&&this.map.dragPan.enable(),t.rotateEnable===!1&&this.map.dragRotate.disable(),t.dragEnable===!0&&this.map.dragRotate.enable(),t.keyboardEnable===!1&&this.map.keyboard.disable(),t.keyboardEnable===!0&&this.map.keyboard.enable(),t.zoomEnable===!1&&this.map.scrollZoom.disable(),t.zoomEnable===!0&&this.map.scrollZoom.enable()}setZoomAndCenter(t,r){this.map.flyTo({zoom:t,center:r})}setMapStyle(t){var r;(r=this.map)===null||r===void 0||r.setStyle(this.getMapStyleValue(t))}meterToCoord(t,r){return 1}pixelToLngLat(t){return this.map.unproject(t)}lngLatToPixel(t){return this.map.project(t)}containerToLngLat(t){return this.map.unproject(t)}lngLatToContainer(t){return this.map.project(t)}getMapStyle(){try{var t;const r=(t=this.map.getStyle().sprite)!==null&&t!==void 0?t:"";return/^mapbox:\/\/sprites\/zcxduo\/\w+\/\w+$/.test(r)?r==null?void 0:r.replace(/\/\w+$/,"").replace(/sprites/,"styles"):r}catch{return""}}getMapStyleConfig(){return Lkt}getMapStyleValue(t){var r;return(r=this.getMapStyleConfig()[t])!==null&&r!==void 0?r:t}destroy(){this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}emit(t,...r){this.eventEmitter.emit(t,...r)}once(t,...r){this.eventEmitter.once(t,...r)}getMapContainer(){return this.$mapContainer}exportMap(t){var r;const n=(r=this.map)===null||r===void 0?void 0:r.getCanvas();return t==="jpg"?n==null?void 0:n.toDataURL("image/jpeg"):n==null?void 0:n.toDataURL("image/png")}onCameraChanged(t){this.cameraChangedCallback=t}creatMapContainer(t){let r=t;return typeof t=="string"&&(r=document.getElementById(t)),r}updateView(t){this.emit("mapchange"),this.viewport.syncWithMapCamera({bearing:t.bearing,center:t.center,viewportHeight:t.viewportHeight,pitch:t.pitch,viewportWidth:t.viewportWidth,zoom:t.zoom,cameraHeight:0}),this.updateCoordinateSystemService(),this.cameraChangedCallback(this.viewport)}updateCoordinateSystemService(){const{offsetCoordinate:t=!0}=this.config;this.viewport.getZoom()>Okt&&t?this.coordinateSystemService.setCoordinateSystem(Ox.LNGLAT_OFFSET):this.coordinateSystemService.setCoordinateSystem(Ox.LNGLAT)}}var Pkt=FJ;function FJ(e,t,r,n){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(n-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=r,this.p2y=n}FJ.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(t===void 0&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var r=e,n=0;n<8;n++){var i=this.sampleCurveX(r)-e;if(Math.abs(i)<t)return r;var a=this.sampleCurveDerivativeX(r);if(Math.abs(a)<1e-6)break;r=r-i/a}var o=0,s=1;for(r=e,n=0;n<20&&(i=this.sampleCurveX(r),!(Math.abs(i-e)<t));n++)e>i?o=r:s=r,r=(s-o)*.5+o;return r},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}};const Dkt=aa(Pkt),Ff={number:function(t,r,n){return t+n*(r-t)}};function Lp(e,t,r){return Math.min(r,Math.max(t,e))}function j1(e,t,r){const n=r-t,i=((e-t)%n+n)%n+t;return i===t?r:i}let Fkt=1;function Bkt(){return Fkt++}function ms(e,...t){for(const r of t)for(const n in r)e[n]=r[n];return e}function Nkt(e,t){const r={};for(let n=0;n<t.length;n++){const i=t[n];i in e&&(r[i]=e[i])}return r}function x4(e,t,r,n){const i=new Dkt(e,t,r,n);return a=>i.solve(a)}const WD=x4(.25,.1,.25,1),k$={};function kkt(e){k$[e]||(typeof console<"u"&&console.warn(e),k$[e]=!0)}function z$(e){return e*Math.PI/180}const BJ=63710088e-1;class ya{constructor(t,r){if(z(this,"lng",void 0),z(this,"lat",void 0),isNaN(t)||isNaN(r))throw new Error(`Invalid LngLat object: (${t}, ${r})`);if(this.lng=+t,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ya(j1(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const r=Math.PI/180,n=this.lat*r,i=t.lat*r,a=Math.sin(n)*Math.sin(i)+Math.cos(n)*Math.cos(i)*Math.cos((t.lng-this.lng)*r);return BJ*Math.acos(Math.min(a,1))}static convert(t){if(t instanceof ya)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new ya(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new ya(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const NJ=2*Math.PI*BJ;function kJ(e){return NJ*Math.cos(e*Math.PI/180)}function RA(e){return(180+e)/360}function IA(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function zJ(e,t){return e/kJ(t)}function zkt(e){return e*360-180}function XD(e){const t=180-e*360;return 360/Math.PI*Math.atan(Math.exp(t*Math.PI/180))-90}function Ukt(e,t){return e*kJ(XD(t))}function $kt(e){return 1/Math.cos(e*Math.PI/180)}class Pp{constructor(t,r,n=0){z(this,"x",void 0),z(this,"y",void 0),z(this,"z",void 0),this.x=+t,this.y=+r,this.z=+n}static fromLngLat(t,r=0){const n=ya.convert(t);return new Pp(RA(n.lng),IA(n.lat),zJ(r,n.lat))}toLngLat(){return new ya(zkt(this.x),XD(this.y))}toAltitude(){return Ukt(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/NJ*$kt(XD(this.y))}}class Ad{constructor(t,r){z(this,"_ne",void 0),z(this,"_sw",void 0),t&&(r?this.setSouthWest(t).setNorthEast(r):Array.isArray(t)&&(t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1])))}setNorthEast(t){return this._ne=t instanceof ya?new ya(t.lng,t.lat):ya.convert(t),this}setSouthWest(t){return this._sw=t instanceof ya?new ya(t.lng,t.lat):ya.convert(t),this}extend(t){const r=this._sw,n=this._ne;let i,a;if(t instanceof ya)i=t,a=t;else if(t instanceof Ad){if(i=t._sw,a=t._ne,!i||!a)return this}else{if(Array.isArray(t))if(t.length===4||t.every(Array.isArray)){const o=t;return this.extend(Ad.convert(o))}else{const o=t;return this.extend(ya.convert(o))}else if(t&&("lng"in t||"lon"in t)&&"lat"in t)return this.extend(ya.convert(t));return this}return!r&&!n?(this._sw=new ya(i.lng,i.lat),this._ne=new ya(a.lng,a.lat)):(r.lng=Math.min(i.lng,r.lng),r.lat=Math.min(i.lat,r.lat),n.lng=Math.max(a.lng,n.lng),n.lat=Math.max(a.lat,n.lat)),this}getCenter(){return new ya((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new ya(this.getWest(),this.getNorth())}getSouthEast(){return new ya(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:r,lat:n}=ya.convert(t),i=this._sw.lat<=n&&n<=this._ne.lat;let a=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(a=this._sw.lng>=r&&r>=this._ne.lng),i&&a}static convert(t){return t instanceof Ad?t:new Ad(t)}static fromLngLat(t,r=0){const i=360*r/40075017,a=i/Math.cos(Math.PI/180*t.lat);return new Ad(new ya(t.lng-a,t.lat-i),new ya(t.lng+a,t.lat+i))}}const Hkt="AbortError";function Vkt(){return new Error(Hkt)}const Gkt=typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date);let wO;const Nf={now:Gkt,frameAsync(e){return new Promise((t,r)=>{const n=requestAnimationFrame(t);e.signal.addEventListener("abort",()=>{cancelAnimationFrame(n),r(Vkt())})})},get prefersReducedMotion(){return window.matchMedia?(wO==null&&(wO=window.matchMedia("(prefers-reduced-motion: reduce)")),wO.matches):!1}};function U$(e,t,r){r[e]&&r[e].indexOf(t)!==-1||(r[e]=r[e]||[],r[e].push(t))}function CO(e,t,r){if(r&&r[e]){const n=r[e].indexOf(t);n!==-1&&r[e].splice(n,1)}}let Gi=class{constructor(t,r={}){z(this,"type",void 0),ms(this,r),this.type=t}};class Wkt extends Gi{constructor(t,r={}){super("error",r),z(this,"error",void 0),this.error=t}}class Xkt{constructor(){z(this,"_listeners",void 0),z(this,"_oneTimeListeners",void 0),z(this,"_eventedParent",void 0),z(this,"_eventedParentData",void 0)}on(t,r){return this._listeners=this._listeners||{},U$(t,r,this._listeners),this}off(t,r){return CO(t,r,this._listeners),CO(t,r,this._oneTimeListeners),this}once(t,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},U$(t,r,this._oneTimeListeners),this):new Promise(n=>this.once(t,n))}fire(t,r){typeof t=="string"&&(t=new Gi(t,r||{}));const n=t.type;if(this.listens(n)){t.target=this;const i=this._listeners&&this._listeners[n]?this._listeners[n].slice():[];for(const s of i)s.call(this,t);const a=this._oneTimeListeners&&this._oneTimeListeners[n]?this._oneTimeListeners[n].slice():[];for(const s of a)CO(n,s,this._oneTimeListeners),s.call(this,t);const o=this._eventedParent;o&&(ms(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),o.fire(t))}else t instanceof Wkt&&console.error(t.error);return this}emit(t,r){return this.fire(t,r)}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,r){return t&&(this._eventedParent=t),this._eventedParentData=r,this}}class jkt extends Xkt{constructor(t,r){super(),z(this,"transform",void 0),z(this,"handlers",void 0),z(this,"_moving",void 0),z(this,"_zooming",void 0),z(this,"_rotating",void 0),z(this,"_pitching",void 0),z(this,"_padding",void 0),z(this,"_bearingSnap",void 0),z(this,"_easeStart",void 0),z(this,"_easeOptions",void 0),z(this,"_easeId",void 0),z(this,"_onEaseFrame",void 0),z(this,"_onEaseEnd",void 0),z(this,"_easeFrameId",void 0),z(this,"_requestedCameraState",void 0),z(this,"transformCameraUpdate",void 0),z(this,"_renderFrameCallback",()=>{const n=Math.min((Nf.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(n)),n<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}),this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=r.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new ya(this.transform.center.lng,this.transform.center.lat)}setCenter(t,r){return this.jumpTo({center:t},r)}panBy(t,r,n){return t=la.convert(t).mult(-1),this.panTo(this.transform.center,ms({offset:t},r),n)}panTo(t,r,n){return this.easeTo(ms({center:t},r),n)}getZoom(){return this.transform.zoom}setZoom(t,r){return this.jumpTo({zoom:t},r),this}zoomTo(t,r,n){return this.easeTo(ms({zoom:t},r),n)}zoomIn(t,r){return this.zoomTo(this.getZoom()+1,t,r),this}zoomOut(t,r){return this.zoomTo(this.getZoom()-1,t,r),this}getBearing(){return this.transform.bearing}setBearing(t,r){return this.jumpTo({bearing:t},r),this}getPadding(){return this.transform.padding}setPadding(t,r){return this.jumpTo({padding:t},r),this}rotateTo(t,r,n){return this.easeTo(ms({bearing:t},r),n)}resetNorth(t,r){return this.rotateTo(0,ms({duration:1e3},t),r),this}resetNorthPitch(t,r){return this.easeTo(ms({bearing:0,pitch:0,duration:1e3},t),r),this}snapToNorth(t,r){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,r):this}getPitch(){return this.transform.pitch}setPitch(t,r){return this.jumpTo({pitch:t},r),this}cameraForBounds(t,r){t=Ad.convert(t);const n=r&&r.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),n,r)}_cameraForBoxAndBearing(t,r,n,i){const a={top:0,bottom:0,right:0,left:0};if(i=ms({padding:a,offset:[0,0],maxZoom:this.transform.maxZoom},i),typeof i.padding=="number"){const pt=i.padding;i.padding={top:pt,bottom:pt,right:pt,left:pt}}i.padding=ms(a,i.padding);const o=this.transform,s=o.padding,l=new Ad(t,r),u=o.project(l.getNorthWest()),c=o.project(l.getNorthEast()),f=o.project(l.getSouthEast()),d=o.project(l.getSouthWest()),v=z$(-n),g=u.rotate(v),x=c.rotate(v),w=f.rotate(v),S=d.rotate(v),A=new la(Math.max(g.x,x.x,S.x,w.x),Math.max(g.y,x.y,S.y,w.y)),M=new la(Math.min(g.x,x.x,S.x,w.x),Math.min(g.y,x.y,S.y,w.y)),R=A.sub(M),O=(o.width-(s.left+s.right+i.padding.left+i.padding.right))/R.x,N=(o.height-(s.top+s.bottom+i.padding.top+i.padding.bottom))/R.y;if(N<0||O<0){kkt("Map cannot fit within canvas with the given bounds, padding, and/or offset.");return}const k=Math.min(o.scaleZoom(o.scale*Math.min(O,N)),i.maxZoom),V=la.convert(i.offset),Q=(i.padding.left-i.padding.right)/2,Y=(i.padding.top-i.padding.bottom)/2,tt=new la(Q,Y).rotate(z$(n)),Et=V.add(tt).mult(o.scale/o.zoomScale(k));return{center:o.unproject(u.add(f).div(2).sub(Et)),zoom:k,bearing:n}}fitBounds(t,r,n){return this._fitInternal(this.cameraForBounds(t,r),r,n)}fitScreenCoordinates(t,r,n,i,a){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(la.convert(t)),this.transform.pointLocation(la.convert(r)),n,i),i,a)}_fitInternal(t,r,n){return t?(r=ms(t,r),delete r.padding,r.linear?this.easeTo(r,n):this.flyTo(r,n)):this}jumpTo(t,r){this.stop();const n=this._getTransformForUpdate();let i=!1,a=!1,o=!1;return"zoom"in t&&n.zoom!==+t.zoom&&(i=!0,n.zoom=+t.zoom),t.center!==void 0&&(n.center=ya.convert(t.center)),"bearing"in t&&n.bearing!==+t.bearing&&(a=!0,n.bearing=+t.bearing),"pitch"in t&&n.pitch!==+t.pitch&&(o=!0,n.pitch=+t.pitch),t.padding!=null&&!n.isPaddingEqual(t.padding)&&(n.padding=t.padding),this._applyUpdatedTransform(n),this.fire(new Gi("movestart",r)).fire(new Gi("move",r)),i&&this.fire(new Gi("zoomstart",r)).fire(new Gi("zoom",r)).fire(new Gi("zoomend",r)),a&&this.fire(new Gi("rotatestart",r)).fire(new Gi("rotate",r)).fire(new Gi("rotateend",r)),o&&this.fire(new Gi("pitchstart",r)).fire(new Gi("pitch",r)).fire(new Gi("pitchend",r)),this.fire(new Gi("moveend",r))}calculateCameraOptionsFromTo(t,r,n,i=0){const a=Pp.fromLngLat(t,r),o=Pp.fromLngLat(n,i),s=o.x-a.x,l=o.y-a.y,u=o.z-a.z,c=Math.hypot(s,l,u);if(c===0)throw new Error("Can't calculate camera options with same From and To");const f=Math.hypot(s,l),d=this.transform.scaleZoom(this.transform.cameraToCenterDistance/c/this.transform.tileSize),v=Math.atan2(s,-l)*180/Math.PI;let g=Math.acos(f/c)*180/Math.PI;return g=u<0?90-g:90+g,{center:o.toLngLat(),zoom:d,pitch:g,bearing:v}}easeTo(t,r){var n;this._stop(!1,t.easeId),t=ms({offset:[0,0],duration:500,easing:WD},t),(t.animate===!1||!t.essential&&Nf.prefersReducedMotion)&&(t.duration=0);const i=this._getTransformForUpdate(),a=this.getZoom(),o=this.getBearing(),s=this.getPitch(),l=this.getPadding(),u="bearing"in t?this._normalizeBearing(t.bearing,o):o,c="pitch"in t?+t.pitch:s,f="padding"in t?t.padding:i.padding,d=la.convert(t.offset);let v=i.centerPoint.add(d);const g=i.pointLocation(v),{center:x,zoom:w}=i.getConstrained(ya.convert(t.center||g),(n=t.zoom)!==null&&n!==void 0?n:a);this._normalizeCenter(x);const S=i.project(g),A=i.project(x).sub(S),M=i.zoomScale(w-a);let R,O;t.around&&(R=ya.convert(t.around),O=i.locationPoint(R));const N={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||w!==a,this._rotating=this._rotating||o!==u,this._pitching=this._pitching||c!==s,this._padding=!i.isPaddingEqual(f),this._easeId=t.easeId,this._prepareEase(r,t.noMoveStart,N),this._ease(k=>{if(this._zooming&&(i.zoom=Ff.number(a,w,k)),this._rotating&&(i.bearing=Ff.number(o,u,k)),this._pitching&&(i.pitch=Ff.number(s,c,k)),this._padding&&(i.interpolatePadding(l,f,k),v=i.centerPoint.add(d)),R)i.setLocationAtPoint(R,O);else{const V=i.zoomScale(i.zoom-a),Q=w>a?Math.min(2,M):Math.max(.5,M),Y=Math.pow(Q,1-k),X=i.unproject(S.add(A.mult(k*Y)).mult(V));i.setLocationAtPoint(i.renderWorldCopies?X.wrap():X,v)}this._applyUpdatedTransform(i),this._fireMoveEvents(r)},k=>{this._afterEase(r,k)},t),this}_prepareEase(t,r,n={}){this._moving=!0,!r&&!n.moving&&this.fire(new Gi("movestart",t)),this._zooming&&!n.zooming&&this.fire(new Gi("zoomstart",t)),this._rotating&&!n.rotating&&this.fire(new Gi("rotatestart",t)),this._pitching&&!n.pitching&&this.fire(new Gi("pitchstart",t))}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(t){if(!this.transformCameraUpdate)return;const r=t.clone(),{center:n,zoom:i,pitch:a,bearing:o,elevation:s}=this.transformCameraUpdate(r);n&&(r.center=n),i!==void 0&&(r.zoom=i),a!==void 0&&(r.pitch=a),o!==void 0&&(r.bearing=o),s!==void 0&&(r.elevation=s),this.transform.apply(r)}_fireMoveEvents(t){this.fire(new Gi("move",t)),this._zooming&&this.fire(new Gi("zoom",t)),this._rotating&&this.fire(new Gi("rotate",t)),this._pitching&&this.fire(new Gi("pitch",t))}_afterEase(t,r){if(this._easeId&&r&&this._easeId===r)return;delete this._easeId;const n=this._zooming,i=this._rotating,a=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,n&&this.fire(new Gi("zoomend",t)),i&&this.fire(new Gi("rotateend",t)),a&&this.fire(new Gi("pitchend",t)),this.fire(new Gi("moveend",t))}flyTo(t,r){var n;if(!t.essential&&Nf.prefersReducedMotion){const kt=Nkt(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(kt,r)}this.stop(),t=ms({offset:[0,0],speed:1.2,curve:1.42,easing:WD},t);const i=this._getTransformForUpdate(),a=this.getZoom(),o=this.getBearing(),s=this.getPitch(),l=this.getPadding(),u="bearing"in t?this._normalizeBearing(t.bearing,o):o,c="pitch"in t?+t.pitch:s,f="padding"in t?t.padding:i.padding,d=la.convert(t.offset);let v=i.centerPoint.add(d);const g=i.pointLocation(v),{center:x,zoom:w}=i.getConstrained(ya.convert(t.center||g),(n=t.zoom)!==null&&n!==void 0?n:a);this._normalizeCenter(x);const S=i.zoomScale(w-a),A=i.project(g),M=i.project(x).sub(A);let R=t.curve;const O=Math.max(i.width,i.height),N=O/S,k=M.mag();if("minZoom"in t){const kt=Lp(Math.min(t.minZoom,a,w),i.minZoom,i.maxZoom),ae=O/i.zoomScale(kt-a);R=Math.sqrt(ae/k*2)}const V=R*R;function Q(kt){const ae=(N*N-O*O+(kt?-1:1)*V*V*k*k)/(2*(kt?N:O)*V*k);return Math.log(Math.sqrt(ae*ae+1)-ae)}function Y(kt){return(Math.exp(kt)-Math.exp(-kt))/2}function X(kt){return(Math.exp(kt)+Math.exp(-kt))/2}function tt(kt){return Y(kt)/X(kt)}const it=Q(!1);let Et=function(kt){return X(it)/X(it+R*kt)},Tt=function(kt){return O*((X(it)*tt(it+R*kt)-Y(it))/V)/k},pt=(Q(!0)-it)/R;if(Math.abs(k)<1e-6||!isFinite(pt)){if(Math.abs(O-N)<1e-6)return this.easeTo(t,r);const kt=N<O?-1:1;pt=Math.abs(Math.log(N/O))/R,Tt=()=>0,Et=ae=>Math.exp(kt*R*ae)}if("duration"in t)t.duration=+t.duration;else{const kt="screenSpeed"in t?+t.screenSpeed/R:+t.speed;t.duration=1e3*pt/kt}return t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=o!==u,this._pitching=c!==s,this._padding=!i.isPaddingEqual(f),this._prepareEase(r,!1),this._ease(kt=>{const ae=kt*pt,Kt=1/Et(ae);i.zoom=kt===1?w:a+i.scaleZoom(Kt),this._rotating&&(i.bearing=Ff.number(o,u,kt)),this._pitching&&(i.pitch=Ff.number(s,c,kt)),this._padding&&(i.interpolatePadding(l,f,kt),v=i.centerPoint.add(d));const re=kt===1?x:i.unproject(A.add(M.mult(Tt(ae))).mult(Kt));i.setLocationAtPoint(i.renderWorldCopies?re.wrap():re,v),this._applyUpdatedTransform(i),this._fireMoveEvents(r)},()=>{this._afterEase(r)},t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,r){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const i=this._onEaseEnd;delete this._onEaseEnd,i.call(this,r)}if(!t){var n;(n=this.handlers)===null||n===void 0||n.stop(!1)}return this}_ease(t,r,n){n.animate===!1||n.duration===0?(t(1),r()):(this._easeStart=Nf.now(),this._easeOptions=n,this._onEaseFrame=t,this._onEaseEnd=r,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(t,r){t=j1(t,-180,180);const n=Math.abs(t-r);return Math.abs(t-360-r)<n&&(t-=360),Math.abs(t+360-r)<n&&(t+=360),t}_normalizeCenter(t){const r=this.transform;if(!r.renderWorldCopies||r.lngRange)return;const n=t.lng-r.center.lng;t.lng+=n>180?-360:n<-180?360:0}}class b4{constructor(t=0,r=0,n=0,i=0){if(z(this,"top",void 0),z(this,"bottom",void 0),z(this,"left",void 0),z(this,"right",void 0),isNaN(t)||t<0||isNaN(r)||r<0||isNaN(n)||n<0||isNaN(i)||i<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=r,this.left=n,this.right=i}interpolate(t,r,n){return r.top!=null&&t.top!=null&&(this.top=Ff.number(t.top,r.top,n)),r.bottom!=null&&t.bottom!=null&&(this.bottom=Ff.number(t.bottom,r.bottom,n)),r.left!=null&&t.left!=null&&(this.left=Ff.number(t.left,r.left,n)),r.right!=null&&t.right!=null&&(this.right=Ff.number(t.right,r.right,n)),this}getCenter(t,r){const n=Lp((this.left+t-this.right)/2,0,t),i=Lp((this.top+r-this.bottom)/2,0,r);return new la(n,i)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new b4(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const oT=85.051129;class E4{constructor(t,r,n,i,a){z(this,"tileSize",void 0),z(this,"tileZoom",void 0),z(this,"lngRange",void 0),z(this,"latRange",void 0),z(this,"scale",void 0),z(this,"width",void 0),z(this,"height",void 0),z(this,"angle",void 0),z(this,"rotationMatrix",void 0),z(this,"pixelsToGLUnits",void 0),z(this,"cameraToCenterDistance",void 0),z(this,"mercatorMatrix",void 0),z(this,"projMatrix",void 0),z(this,"invProjMatrix",void 0),z(this,"alignedProjMatrix",void 0),z(this,"pixelMatrix",void 0),z(this,"pixelMatrix3D",void 0),z(this,"pixelMatrixInverse",void 0),z(this,"glCoordMatrix",void 0),z(this,"labelPlaneMatrix",void 0),z(this,"minElevationForCurrentTile",void 0),z(this,"_fov",void 0),z(this,"_pitch",void 0),z(this,"_zoom",void 0),z(this,"_unmodified",void 0),z(this,"_renderWorldCopies",void 0),z(this,"_minZoom",void 0),z(this,"_maxZoom",void 0),z(this,"_minPitch",void 0),z(this,"_maxPitch",void 0),z(this,"_center",void 0),z(this,"_elevation",void 0),z(this,"_pixelPerMeter",void 0),z(this,"_edgeInsets",void 0),z(this,"_constraining",void 0),z(this,"_posMatrixCache",void 0),z(this,"_alignedPosMatrixCache",void 0),this.tileSize=512,this._renderWorldCopies=a===void 0?!0:!!a,this._minZoom=t||0,this._maxZoom=r||22,this._minPitch=n??0,this._maxPitch=i??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new ya(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new b4,this._posMatrixCache={},this._alignedPosMatrixCache={},this.minElevationForCurrentTile=0}clone(){const t=new E4(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return t.apply(this),t}apply(t){this.tileSize=t.tileSize,this.latRange=t.latRange,this.width=t.width,this.height=t.height,this._center=t._center,this._elevation=t._elevation,this.minElevationForCurrentTile=t.minElevationForCurrentTile,this.zoom=t.zoom,this.angle=t.angle,this._fov=t._fov,this._pitch=t._pitch,this._unmodified=t._unmodified,this._edgeInsets=t._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new la(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(t){const r=-j1(t,-180,180)*Math.PI/180;this.angle!==r&&(this._unmodified=!1,this.angle=r,this._calcMatrices(),this.rotationMatrix=VRt(),GRt(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const r=Lp(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==r&&(this._unmodified=!1,this._pitch=r,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(t){const r=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==r&&(this._unmodified=!1,this._zoom=r,this.tileZoom=Math.max(0,Math.floor(r)),this.scale=this.zoomScale(r),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(t){t!==this._elevation&&(this._elevation=t,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,r,n){this._unmodified=!1,this._edgeInsets.interpolate(t,r,n),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const r=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,r)}resize(t,r){this.width=t,this.height=r,this.pixelsToGLUnits=[2/t,-2/r],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(t){const r=Lp(t.lat,-oT,oT);return new la(RA(t.lng)*this.worldSize,IA(r)*this.worldSize)}unproject(t){return new Pp(t.x/this.worldSize,t.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){const t=this.pointLocation(this.getCameraPoint()),r=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter;return{lngLat:t,altitude:r+this.elevation}}setLocationAtPoint(t,r){const n=this.pointCoordinate(r),i=this.pointCoordinate(this.centerPoint),a=this.locationCoordinate(t),o=new Pp(a.x-(n.x-i.x),a.y-(n.y-i.y));this.center=this.coordinateLocation(o),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(t){return this.coordinatePoint(this.locationCoordinate(t))}pointLocation(t){return this.coordinateLocation(this.pointCoordinate(t))}locationCoordinate(t){return Pp.fromLngLat(t)}coordinateLocation(t){return t&&t.toLngLat()}pointCoordinate(t){const n=[t.x,t.y,0,1],i=[t.x,t.y,1,1];bm(n,n,this.pixelMatrixInverse),bm(i,i,this.pixelMatrixInverse);const a=n[3],o=i[3],s=n[0]/a,l=i[0]/o,u=n[1]/a,c=i[1]/o,f=n[2]/a,d=i[2]/o,v=f===d?0:(0-f)/(d-f);return new Pp(Ff.number(s,l,v)/this.worldSize,Ff.number(u,c,v)/this.worldSize)}coordinatePoint(t,r=0,n=this.pixelMatrix){const i=[t.x*this.worldSize,t.y*this.worldSize,r,1];return bm(i,i,n),new la(i[0]/i[3],i[1]/i[3])}getBounds(){const t=Math.max(0,this.height/2-this.getHorizon());return new Ad().extend(this.pointLocation(new la(0,t))).extend(this.pointLocation(new la(this.width,t))).extend(this.pointLocation(new la(this.width,this.height))).extend(this.pointLocation(new la(0,this.height)))}getMaxBounds(){return!this.latRange||this.latRange.length!==2||!this.lngRange||this.lngRange.length!==2?null:new Ad([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]])}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-oT,oT])}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(t,r){r=Lp(+r,this.minZoom,this.maxZoom);const n={center:new ya(t.lng,t.lat),zoom:r};let i=this.lngRange;if(!this._renderWorldCopies&&i===null){const O=179.9999999999;i=[-O,O]}const a=this.tileSize*this.zoomScale(n.zoom);let o=0,s=a,l=0,u=a,c=0,f=0;const{x:d,y:v}=this.size;if(this.latRange){const O=this.latRange;o=IA(O[1])*a,s=IA(O[0])*a,s-o<v&&(c=v/(s-o))}i&&(l=j1(RA(i[0])*a,0,a),u=j1(RA(i[1])*a,0,a),u<l&&(u+=a),u-l<d&&(f=d/(u-l)));const{x:g,y:x}=this.project.call({worldSize:a},t);let w,S;const A=Math.max(f||0,c||0);if(A){const O=new la(f?(u+l)/2:g,c?(s+o)/2:x);return n.center=this.unproject.call({worldSize:a},O).wrap(),n.zoom+=this.scaleZoom(A),n}if(this.latRange){const O=v/2;x-O<o&&(S=o+O),x+O>s&&(S=s-O)}if(i){const O=(l+u)/2;let N=g;this._renderWorldCopies&&(N=j1(g,O-a/2,O+a/2));const k=d/2;N-k<l&&(w=l+k),N+k>u&&(w=u-k)}if(w!==void 0||S!==void 0){var M,R;const O=new la((M=w)!==null&&M!==void 0?M:g,(R=S)!==null&&R!==void 0?R:x);n.center=this.unproject.call({worldSize:a},O).wrap()}return n}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const t=this._unmodified,{center:r,zoom:n}=this.getConstrained(this.center,this.zoom);this.center=r,this.zoom=n,this._unmodified=t,this._constraining=!1}_calcMatrices(){if(!this.height)return;const t=this._fov/2,r=this.centerOffset,n=this.point.x,i=this.point.y;this.cameraToCenterDistance=.5/Math.tan(t)*this.height,this._pixelPerMeter=zJ(1,this.center.lat)*this.worldSize;let a=pU(new Float64Array(16));Of(a,a,[this.width/2,-this.height/2,1]),Lf(a,a,[1,-1,0]),this.labelPlaneMatrix=a,a=pU(new Float64Array(16)),Of(a,a,[1,-1,1]),Lf(a,a,[-1,-1,0]),Of(a,a,[2/this.width,2/this.height,1]),this.glCoordMatrix=a;const o=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),s=Math.min(this.elevation,this.minElevationForCurrentTile),l=o-s*this._pixelPerMeter/Math.cos(this._pitch),u=s<0?l:o,c=Math.PI/2+this._pitch,f=this._fov*(.5+r.y/this.height),d=Math.sin(f)*u/Math.sin(Lp(Math.PI-c-f,.01,Math.PI-.01)),v=this.getHorizon(),x=2*Math.atan(v/this.cameraToCenterDistance)*(.5+r.y/(v*2)),w=Math.sin(x)*u/Math.sin(Lp(Math.PI-c-x,.01,Math.PI-.01)),S=Math.min(d,w),A=(Math.cos(Math.PI/2-this._pitch)*S+u)*1.01,M=this.height/50;a=new Float64Array(16),zK(a,this._fov,this.width/this.height,M,A),a[8]=-r.x*2/this.width,a[9]=r.y*2/this.height,Of(a,a,[1,-1,1]),Lf(a,a,[0,0,-this.cameraToCenterDistance]),bb(a,a,this._pitch),ES(a,a,this.angle),Lf(a,a,[-n,-i,0]),this.mercatorMatrix=Of([],a,[this.worldSize,this.worldSize,this.worldSize]),Of(a,a,[1,1,this._pixelPerMeter]),this.pixelMatrix=Dm(new Float64Array(16),this.labelPlaneMatrix,a),Lf(a,a,[0,0,-this.elevation]),this.projMatrix=a,this.invProjMatrix=aC([],a),this.pixelMatrix3D=Dm(new Float64Array(16),this.labelPlaneMatrix,a);const R=this.width%2/2,O=this.height%2/2,N=Math.cos(this.angle),k=Math.sin(this.angle),V=n-Math.round(n)+N*R+k*O,Q=i-Math.round(i)+N*O+k*R,Y=new Float64Array(a);if(Lf(Y,Y,[V>.5?V-1:V,Q>.5?Q-1:Q,0]),this.alignedProjMatrix=Y,a=aC(new Float64Array(16),this.pixelMatrix),!a)throw new Error("failed to invert matrix");this.pixelMatrixInverse=a,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const t=this.pointCoordinate(new la(0,0)),r=[t.x*this.worldSize,t.y*this.worldSize,0,1];return bm(r,r,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const t=this._pitch,r=Math.tan(t)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new la(0,r))}getCameraQueryGeometry(t){const r=this.getCameraPoint();if(t.length===1)return[t[0],r];{let n=r.x,i=r.y,a=r.x,o=r.y;for(const s of t)n=Math.min(n,s.x),i=Math.min(i,s.y),a=Math.max(a,s.x),o=Math.max(o,s.y);return[new la(n,i),new la(a,i),new la(a,o),new la(n,o),new la(n,i)]}}lngLatToCameraDepth(t,r){const n=this.locationCoordinate(t),i=[n.x*this.worldSize,n.y*this.worldSize,r,1];return bm(i,i,this.projMatrix),i[2]/i[3]}}var w4;class jn{static testProp(t){if(!jn.docStyle)return t[0];for(let r=0;r<t.length;r++)if(t[r]in jn.docStyle)return t[r];return t[0]}static create(t,r,n){const i=window.document.createElement(t);return r!==void 0&&(i.className=r),n&&n.appendChild(i),i}static createNS(t,r){return window.document.createElementNS(t,r)}static disableDrag(){jn.docStyle&&jn.selectProp&&(jn.userSelect=jn.docStyle[jn.selectProp],jn.docStyle[jn.selectProp]="none")}static enableDrag(){jn.docStyle&&jn.selectProp&&(jn.docStyle[jn.selectProp]=jn.userSelect)}static setTransform(t,r){t.style[jn.transformProp]=r}static addEventListener(t,r,n,i={}){"passive"in i?t.addEventListener(r,n,i):t.addEventListener(r,n,i.capture)}static removeEventListener(t,r,n,i={}){"passive"in i?t.removeEventListener(r,n,i):t.removeEventListener(r,n,i.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",jn.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",jn.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",jn.suppressClickInternal,!0)},0)}static getScale(t){const r=t.getBoundingClientRect();return{x:r.width/t.offsetWidth||1,y:r.height/t.offsetHeight||1,boundingClientRect:r}}static getPoint(t,r,n){const i=r.boundingClientRect;return new la((n.clientX-i.left)/r.x-t.clientLeft,(n.clientY-i.top)/r.y-t.clientTop)}static mousePos(t,r){const n=jn.getScale(t);return jn.getPoint(t,n,r)}static touchPos(t,r){const n=[],i=jn.getScale(t);for(let a=0;a<r.length;a++)n.push(jn.getPoint(t,i,r[a]));return n}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}}w4=jn;z(jn,"docStyle",typeof window<"u"&&window.document&&window.document.documentElement.style);z(jn,"userSelect",void 0);z(jn,"selectProp",w4.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]));z(jn,"transformProp",w4.testProp(["transform","WebkitTransform"]));class AS{constructor(t){z(this,"_map",void 0),this._map=t}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(t){return this.transform.pointLocation(la.convert(t))}}class Ykt{constructor(t,r){z(this,"_map",void 0),z(this,"_tr",void 0),z(this,"_el",void 0),z(this,"_container",void 0),z(this,"_enabled",void 0),z(this,"_active",void 0),z(this,"_startPos",void 0),z(this,"_lastPos",void 0),z(this,"_box",void 0),z(this,"_clickTolerance",void 0),this._map=t,this._tr=new AS(t),this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=r.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,r){this.isEnabled()&&t.shiftKey&&t.button===0&&(jn.disableDrag(),this._startPos=this._lastPos=r,this._active=!0)}mousemoveWindow(t,r){if(!this._active)return;const n=r;if(this._lastPos.equals(n)||!this._box&&n.dist(this._startPos)<this._clickTolerance)return;const i=this._startPos;this._lastPos=n,this._box||(this._box=jn.create("div","l7-boxzoom",this._container),this._container.classList.add("l7-crosshair"),this._fireEvent("boxzoomstart",t));const a=Math.min(i.x,n.x),o=Math.max(i.x,n.x),s=Math.min(i.y,n.y),l=Math.max(i.y,n.y);jn.setTransform(this._box,`translate(${a}px,${s}px)`),this._box.style.width=`${o-a}px`,this._box.style.height=`${l-s}px`}mouseupWindow(t,r){if(!this._active||t.button!==0)return;const n=this._startPos,i=r;if(this.reset(),jn.suppressClick(),n.x===i.x&&n.y===i.y)this._fireEvent("boxzoomcancel",t);else return this._map.fire(new Gi("boxzoomend",{originalEvent:t})),{cameraAnimation:a=>a.fitScreenCoordinates(n,i,this._tr.bearing,{linear:!0})}}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("l7-crosshair"),this._box&&(jn.remove(this._box),this._box=null),jn.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,r){return this._map.fire(new Gi(t,{originalEvent:r}))}}class Zkt{constructor(t){z(this,"_tr",void 0),z(this,"_enabled",void 0),z(this,"_active",void 0),this._tr=new AS(t),this.reset()}reset(){this._active=!1}dblclick(t,r){return t.preventDefault(),{cameraAnimation:n=>{n.easeTo({duration:300,zoom:this._tr.zoom+(t.shiftKey?-1:1),around:this._tr.unproject(r)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class qkt{constructor(t,r){z(this,"_options",void 0),z(this,"_map",void 0),z(this,"_container",void 0),z(this,"_bypassKey",navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey"),z(this,"_enabled",void 0),this._map=t,this._options=r,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const t=this._map.getCanvasContainer();t.classList.add("l7-cooperative-gestures"),this._container=jn.create("div","l7-cooperative-gesture-screen",t);const r=document.createElement("div");r.className="l7-desktop-message",r.textContent="Missing UI string",this._container.appendChild(r);const n=document.createElement("div");n.className="l7-mobile-message",n.textContent="Missing UI string",this._container.appendChild(n),this._container.setAttribute("aria-hidden","true")}_destoryUI(){this._container&&(jn.remove(this._container),this._map.getCanvasContainer().classList.remove("l7-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destoryUI()}isEnabled(){return this._enabled}touchmove(t){this._onCooperativeGesture(t.touches.length===1)}wheel(t){this._map.scrollZoom.isEnabled()&&this._onCooperativeGesture(!t[this._bypassKey])}_onCooperativeGesture(t){!this._enabled||!t||(this._container.classList.add("l7-show"),setTimeout(()=>{this._container.classList.remove("l7-show")},100))}}const Kkt={panStep:100,bearingStep:15,pitchStep:10};class Qkt{constructor(t){z(this,"_tr",void 0),z(this,"_enabled",void 0),z(this,"_active",void 0),z(this,"_panStep",void 0),z(this,"_bearingStep",void 0),z(this,"_pitchStep",void 0),z(this,"_rotationDisabled",void 0),this._tr=new AS(t);const r=Kkt;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let r=0,n=0,i=0,a=0,o=0;switch(t.keyCode){case 61:case 107:case 171:case 187:r=1;break;case 189:case 109:case 173:r=-1;break;case 37:t.shiftKey?n=-1:(t.preventDefault(),a=-1);break;case 39:t.shiftKey?n=1:(t.preventDefault(),a=1);break;case 38:t.shiftKey?i=1:(t.preventDefault(),o=-1);break;case 40:t.shiftKey?i=-1:(t.preventDefault(),o=1);break;default:return}return this._rotationDisabled&&(n=0,i=0),{cameraAnimation:s=>{const l=this._tr;s.easeTo({duration:300,easeId:"keyboardHandler",easing:Jkt,zoom:r?Math.round(l.zoom)+r*(t.shiftKey?2:1):l.zoom,bearing:l.bearing+n*this._bearingStep,pitch:l.pitch+i*this._pitchStep,offset:[-a*this._panStep,-o*this._panStep],center:l.center},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Jkt(e){return e*(2-e)}class Gv extends Gi{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,r,n,i={}){super(t,i),z(this,"target",void 0),z(this,"originalEvent",void 0),z(this,"point",void 0),z(this,"lngLat",void 0),z(this,"_defaultPrevented",void 0);const a=jn.mousePos(r.getCanvasContainer(),n),o=r.unproject(a);this.point=a,this.lngLat=o,this.originalEvent=n,this._defaultPrevented=!1,this.target=r}}class sT extends Gi{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,r,n){super(t),z(this,"target",void 0),z(this,"originalEvent",void 0),z(this,"lngLat",void 0),z(this,"point",void 0),z(this,"points",void 0),z(this,"lngLats",void 0),z(this,"_defaultPrevented",void 0);const i=t==="touchend"?n.changedTouches:n.touches,a=jn.touchPos(r.getCanvasContainer(),i),o=a.map(u=>r.unproject(u)),s=a.reduce((u,c,f,d)=>u.add(c.div(d.length)),new la(0,0)),l=r.unproject(s);this.target=r,this.points=a,this.point=s,this.lngLats=o,this.lngLat=l,this.originalEvent=n,this._defaultPrevented=!1}}class t6t extends Gi{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,r,n){super(t),z(this,"target",void 0),z(this,"originalEvent",void 0),z(this,"_defaultPrevented",void 0),this.target=r,this._defaultPrevented=!1,this.originalEvent=n}}class e6t{constructor(t,r){z(this,"_mousedownPos",void 0),z(this,"_clickTolerance",void 0),z(this,"_map",void 0),this._map=t,this._clickTolerance=r.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new t6t(t.type,this._map,t))}mousedown(t,r){return this._mousedownPos=r,this._firePreventable(new Gv(t.type,this._map,t))}mouseup(t){this._map.fire(new Gv(t.type,this._map,t))}click(t,r){this._mousedownPos&&this._mousedownPos.dist(r)>=this._clickTolerance||this._map.fire(new Gv(t.type,this._map,t))}dblclick(t){return this._firePreventable(new Gv(t.type,this._map,t))}mouseover(t){this._map.fire(new Gv(t.type,this._map,t))}mouseout(t){this._map.fire(new Gv(t.type,this._map,t))}touchstart(t){return this._firePreventable(new sT(t.type,this._map,t))}touchmove(t){this._map.fire(new sT(t.type,this._map,t))}touchend(t){this._map.fire(new sT(t.type,this._map,t))}touchcancel(t){this._map.fire(new sT(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class r6t{constructor(t){z(this,"_map",void 0),z(this,"_delayContextMenu",void 0),z(this,"_ignoreContextMenu",void 0),z(this,"_contextMenuEvent",void 0),this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new Gv(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Gv("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new Gv(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class C4{constructor(t){z(this,"contextmenu",void 0),z(this,"mousedown",void 0),z(this,"mousemoveWindow",void 0),z(this,"mouseup",void 0),z(this,"touchstart",void 0),z(this,"touchmoveWindow",void 0),z(this,"touchend",void 0),z(this,"_clickTolerance",void 0),z(this,"_moveFunction",void 0),z(this,"_activateOnStart",void 0),z(this,"_active",void 0),z(this,"_enabled",void 0),z(this,"_moved",void 0),z(this,"_lastPoint",void 0),z(this,"_moveStateManager",void 0),this._enabled=!!t.enable,this._moveStateManager=t.moveStateManager,this._clickTolerance=t.clickTolerance||1,this._moveFunction=t.move,this._activateOnStart=!!t.activateOnStart,t.assignEvents(this),this.reset()}reset(t){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(t)}_move(...t){const r=this._moveFunction(...t);if(r.bearingDelta||r.pitchDelta||r.around||r.panDelta)return this._active=!0,r}dragStart(t,r){!this.isEnabled()||this._lastPoint||this._moveStateManager.isValidStartEvent(t)&&(this._moveStateManager.startMove(t),this._lastPoint=r.length?r[0]:r,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(t,r){if(!this.isEnabled())return;const n=this._lastPoint;if(!n)return;if(t.preventDefault(),!this._moveStateManager.isValidMoveEvent(t)){this.reset(t);return}const i=r.length?r[0]:r;if(!(!this._moved&&i.dist(n)<this._clickTolerance))return this._moved=!0,this._lastPoint=i,this._move(n,i)}dragEnd(t){!this.isEnabled()||!this._lastPoint||this._moveStateManager.isValidEndEvent(t)&&(this._moved&&jn.suppressClick(),this.reset(t))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const n6t=0,i6t=2,a6t={[n6t]:1,[i6t]:2};function o6t(e,t){const r=a6t[t];return e.buttons===void 0||(e.buttons&r)!==r}class S4{constructor(t){z(this,"_eventButton",void 0),z(this,"_correctEvent",void 0),this._correctEvent=t.checkCorrectEvent}startMove(t){const r=jn.mouseButton(t);this._eventButton=r}endMove(t){delete this._eventButton}isValidStartEvent(t){return this._correctEvent(t)}isValidMoveEvent(t){return!o6t(t,this._eventButton)}isValidEndEvent(t){return jn.mouseButton(t)===this._eventButton}}const T4=0,UJ=2,A4=e=>{e.mousedown=e.dragStart,e.mousemoveWindow=e.dragMove,e.mouseup=e.dragEnd,e.contextmenu=t=>{t.preventDefault()}},s6t=({enable:e,clickTolerance:t})=>{const r=new S4({checkCorrectEvent:n=>jn.mouseButton(n)===T4&&!n.ctrlKey});return new C4({clickTolerance:t,move:(n,i)=>({around:i,panDelta:i.sub(n)}),activateOnStart:!0,moveStateManager:r,enable:e,assignEvents:A4})},l6t=({enable:e,clickTolerance:t,bearingDegreesPerPixelMoved:r=.8})=>{const n=new S4({checkCorrectEvent:i=>jn.mouseButton(i)===T4&&i.ctrlKey||jn.mouseButton(i)===UJ});return new C4({clickTolerance:t,move:(i,a)=>({bearingDelta:(a.x-i.x)*r}),moveStateManager:n,enable:e,assignEvents:A4})},u6t=({enable:e,clickTolerance:t,pitchDegreesPerPixelMoved:r=-.5})=>{const n=new S4({checkCorrectEvent:i=>jn.mouseButton(i)===T4&&i.ctrlKey||jn.mouseButton(i)===UJ});return new C4({clickTolerance:t,move:(i,a)=>({pitchDelta:(a.y-i.y)*r}),moveStateManager:n,enable:e,assignEvents:A4})},$$=4.000244140625,c6t=1/100,h6t=1/450,f6t=2;class d6t{constructor(t,r){z(this,"_map",void 0),z(this,"_tr",void 0),z(this,"_enabled",void 0),z(this,"_active",void 0),z(this,"_zooming",void 0),z(this,"_aroundCenter",void 0),z(this,"_around",void 0),z(this,"_aroundPoint",void 0),z(this,"_type",void 0),z(this,"_lastValue",void 0),z(this,"_timeout",void 0),z(this,"_finishTimeout",void 0),z(this,"_lastWheelEvent",void 0),z(this,"_lastWheelEventTime",void 0),z(this,"_startZoom",void 0),z(this,"_targetZoom",void 0),z(this,"_delta",void 0),z(this,"_easing",void 0),z(this,"_prevEase",void 0),z(this,"_frameId",void 0),z(this,"_triggerRenderFrame",void 0),z(this,"_defaultZoomRate",void 0),z(this,"_wheelZoomRate",void 0),z(this,"_onTimeout",n=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)}),this._map=t,this._tr=new AS(t),this._triggerRenderFrame=r,this._delta=0,this._defaultZoomRate=c6t,this._wheelZoomRate=h6t}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(t){if(!this.isEnabled()||this._map.cooperativeGestures.isEnabled()&&!t[this._map.cooperativeGestures._bypassKey])return;let r=t.deltaMode===WheelEvent.DOM_DELTA_LINE?t.deltaY*40:t.deltaY;const n=Nf.now(),i=n-(this._lastWheelEventTime||0);this._lastWheelEventTime=n,r!==0&&r%$$===0?this._type="wheel":r!==0&&Math.abs(r)<4?this._type="trackpad":i>400?(this._type=null,this._lastValue=r,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(i*r)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,r+=this._lastValue)),t.shiftKey&&r&&(r=r/4),this._type&&(this._lastWheelEvent=t,this._delta-=r,this._active||this._start(t)),t.preventDefault()}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const r=jn.mousePos(this._map.getCanvasContainer(),t),n=this._tr;r.y>n.transform.height/2-n.transform.getHorizon()?this._around=ya.convert(this._aroundCenter?n.center:n.unproject(r)):this._around=ya.convert(n.center),this._aroundPoint=n.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._tr.transform;if(this._delta!==0){const s=this._type==="wheel"&&Math.abs(this._delta)>$$?this._wheelZoomRate:this._defaultZoomRate;let l=f6t/(1+Math.exp(-Math.abs(this._delta*s)));this._delta<0&&l!==0&&(l=1/l);const u=typeof this._targetZoom=="number"?t.zoomScale(this._targetZoom):t.scale;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(u*l))),this._type==="wheel"&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const r=typeof this._targetZoom=="number"?this._targetZoom:t.zoom,n=this._startZoom,i=this._easing;let a=!1,o;if(this._type==="wheel"&&n&&i){const s=Math.min((Nf.now()-this._lastWheelEventTime)/200,1),l=i(s);o=Ff.number(n,r,l),s<1?this._frameId||(this._frameId=!0):a=!0}else o=r,a=!0;return this._active=!0,a&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!a,zoomDelta:o-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let r=WD;if(this._prevEase){const n=this._prevEase,i=(Nf.now()-n.start)/n.duration,a=n.easing(i+.01)-n.easing(i),o=.27/Math.sqrt(a*a+1e-4)*.01,s=Math.sqrt(.27*.27-o*o);r=x4(o,s,.25,1)}return this._prevEase={start:Nf.now(),duration:t,easing:r},r}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class p6t{constructor(t,r){z(this,"_clickZoom",void 0),z(this,"_tapZoom",void 0),this._clickZoom=t,this._tapZoom=r}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class v6t{constructor(t,r,n){z(this,"_el",void 0),z(this,"_mousePan",void 0),z(this,"_touchPan",void 0),z(this,"_inertiaOptions",void 0),this._el=t,this._mousePan=r,this._touchPan=n}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("l7-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("l7-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class g6t{constructor(t,r,n){z(this,"_mouseRotate",void 0),z(this,"_mousePitch",void 0),z(this,"_pitchWithRotate",void 0),this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=r,this._mousePitch=n}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class m6t{constructor(t,r,n,i){z(this,"_el",void 0),z(this,"_touchZoom",void 0),z(this,"_touchRotate",void 0),z(this,"_tapDragZoom",void 0),z(this,"_rotationDisabled",void 0),z(this,"_enabled",void 0),this._el=t,this._touchZoom=r,this._touchRotate=n,this._tapDragZoom=i,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("l7-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("l7-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}function jD(e,t){if(e.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${e.length}, points ${t.length}`);const r={};for(let n=0;n<e.length;n++)r[e[n].identifier]=t[n];return r}function y6t(e){const t=new la(0,0);for(const r of e)t._add(r);return t.div(e.length)}const $J=500,_6t=500,M4=30;class x6t{constructor(t){z(this,"numTouches",void 0),z(this,"centroid",void 0),z(this,"startTime",void 0),z(this,"aborted",void 0),z(this,"touches",void 0),this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,r,n){(this.centroid||n.length>this.numTouches)&&(this.aborted=!0),!this.aborted&&(this.startTime===void 0&&(this.startTime=t.timeStamp),n.length===this.numTouches&&(this.centroid=y6t(r),this.touches=jD(n,r)))}touchmove(t,r,n){if(this.aborted||!this.centroid)return;const i=jD(n,r);for(const a in this.touches){const o=this.touches[a],s=i[a];(!s||s.dist(o)>M4)&&(this.aborted=!0)}}touchend(t,r,n){if((!this.centroid||t.timeStamp-this.startTime>_6t)&&(this.aborted=!0),n.length===0){const i=!this.aborted&&this.centroid;if(this.reset(),i)return i}}}class YD{constructor(t){z(this,"singleTap",void 0),z(this,"numTaps",void 0),z(this,"lastTime",void 0),z(this,"lastTap",void 0),z(this,"count",void 0),this.singleTap=new x6t(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,r,n){this.singleTap.touchstart(t,r,n)}touchmove(t,r,n){this.singleTap.touchmove(t,r,n)}touchend(t,r,n){const i=this.singleTap.touchend(t,r,n);if(i){const a=t.timeStamp-this.lastTime<$J,o=!this.lastTap||this.lastTap.dist(i)<M4;if((!a||!o)&&this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=i,this.count===this.numTaps)return this.reset(),i}}}class b6t{constructor(){z(this,"_enabled",void 0),z(this,"_active",void 0),z(this,"_swipePoint",void 0),z(this,"_swipeTouch",void 0),z(this,"_tapTime",void 0),z(this,"_tapPoint",void 0),z(this,"_tap",void 0),this._tap=new YD({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(t,r,n){if(!this._swipePoint)if(!this._tapTime)this._tap.touchstart(t,r,n);else{const i=r[0],a=t.timeStamp-this._tapTime<$J,o=this._tapPoint.dist(i)<M4;!a||!o?this.reset():n.length>0&&(this._swipePoint=i,this._swipeTouch=n[0].identifier)}}touchmove(t,r,n){if(!this._tapTime)this._tap.touchmove(t,r,n);else if(this._swipePoint){if(n[0].identifier!==this._swipeTouch)return;const i=r[0],a=i.y-this._swipePoint.y;return this._swipePoint=i,t.preventDefault(),this._active=!0,{zoomDelta:a/128}}}touchend(t,r,n){if(this._tapTime)this._swipePoint&&n.length===0&&this.reset();else{const i=this._tap.touchend(t,r,n);i&&(this._tapTime=t.timeStamp,this._tapPoint=i)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class E6t{constructor(t){z(this,"_tr",void 0),z(this,"_enabled",void 0),z(this,"_active",void 0),z(this,"_zoomIn",void 0),z(this,"_zoomOut",void 0),this._tr=new AS(t),this._zoomIn=new YD({numTouches:1,numTaps:2}),this._zoomOut=new YD({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,r,n){this._zoomIn.touchstart(t,r,n),this._zoomOut.touchstart(t,r,n)}touchmove(t,r,n){this._zoomIn.touchmove(t,r,n),this._zoomOut.touchmove(t,r,n)}touchend(t,r,n){const i=this._zoomIn.touchend(t,r,n),a=this._zoomOut.touchend(t,r,n),o=this._tr;if(i)return this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:s=>s.easeTo({duration:300,zoom:o.zoom+1,around:o.unproject(i)},{originalEvent:t})};if(a)return this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:s=>s.easeTo({duration:300,zoom:o.zoom-1,around:o.unproject(a)},{originalEvent:t})}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class w6t{constructor(t,r){z(this,"_enabled",void 0),z(this,"_active",void 0),z(this,"_touches",void 0),z(this,"_clickTolerance",void 0),z(this,"_sum",void 0),z(this,"_map",void 0),this._clickTolerance=t.clickTolerance||1,this._map=r,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new la(0,0)}minTouchs(){return this._map.cooperativeGestures.isEnabled()?2:1}touchstart(t,r,n){return this._calculateTransform(t,r,n)}touchmove(t,r,n){if(!(!this._active||n.length<this.minTouchs()))return t.preventDefault(),this._calculateTransform(t,r,n)}touchend(t,r,n){this._calculateTransform(t,r,n),this._active&&n.length<this.minTouchs()&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,r,n){n.length>0&&(this._active=!0);const i=jD(n,r),a=new la(0,0),o=new la(0,0);let s=0;for(const c in i){const f=i[c],d=this._touches[c];d&&(a._add(f),o._add(f.sub(d)),s++,i[c]=f)}if(this._touches=i,s<this.minTouchs()||!o.mag())return;const l=o.div(s);return this._sum._add(l),this._sum.mag()<this._clickTolerance?void 0:{around:a.div(s),panDelta:l}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class R4{constructor(){z(this,"_enabled",void 0),z(this,"_active",void 0),z(this,"_firstTwoTouches",void 0),z(this,"_vector",void 0),z(this,"_startVector",void 0),z(this,"_aroundCenter",void 0),this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(t,r,n){this._firstTwoTouches||n.length<2||(this._firstTwoTouches=[n[0].identifier,n[1].identifier],this._start([r[0],r[1]]))}touchmove(t,r,n){if(!this._firstTwoTouches)return;t.preventDefault();const[i,a]=this._firstTwoTouches,o=lT(n,r,i),s=lT(n,r,a);if(!o||!s)return;const l=this._aroundCenter?null:o.add(s).div(2);return this._move([o,s],l,t)}touchend(t,r,n){if(!this._firstTwoTouches)return;const[i,a]=this._firstTwoTouches,o=lT(n,r,i),s=lT(n,r,a);o&&s||(this._active&&jn.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function lT(e,t,r){for(let n=0;n<e.length;n++)if(e[n].identifier===r)return t[n]}const C6t=.1;function H$(e,t){return Math.log(e/t)/Math.LN2}class S6t extends R4{constructor(...t){super(...t),z(this,"_distance",void 0),z(this,"_startDistance",void 0)}reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,r){const n=this._distance;if(this._distance=t[0].dist(t[1]),!(!this._active&&Math.abs(H$(this._distance,this._startDistance))<C6t))return this._active=!0,{zoomDelta:H$(this._distance,n),pinchAround:r}}}const T6t=25;function V$(e,t){return e.angleWith(t)*180/Math.PI}class A6t extends R4{constructor(...t){super(...t),z(this,"_minDiameter",void 0)}reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,r,n){const i=this._vector;if(this._vector=t[0].sub(t[1]),!(!this._active&&this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:V$(this._vector,i),pinchAround:r}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const r=Math.PI*this._minDiameter,n=T6t/r*360,i=V$(t,this._startVector);return Math.abs(i)<n}}function SO(e){return Math.abs(e.y)>Math.abs(e.x)}const M6t=100;class R6t extends R4{constructor(t){super(),z(this,"_valid",void 0),z(this,"_firstMove",void 0),z(this,"_lastPoints",void 0),z(this,"_map",void 0),z(this,"_currentTouchCount",0),this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,r,n){super.touchstart(t,r,n),this._currentTouchCount=n.length}_start(t){this._lastPoints=t,SO(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,r,n){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const i=t[0].sub(this._lastPoints[0]),a=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(i,a,n.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(i.y+a.y)/2*-.5}):void 0}gestureBeginsVertically(t,r,n){if(this._valid!==void 0)return this._valid;const i=2,a=t.mag()>=i,o=r.mag()>=i;if(!a&&!o)return;if(!a||!o)return this._firstMove===void 0&&(this._firstMove=n),n-this._firstMove<M6t?void 0:!1;const s=t.y>0==r.y>0;return SO(t)&&SO(r)&&s}}const yI={linearity:.3,easing:x4(0,0,.3,1)},I6t=ms({deceleration:2500,maxSpeed:1400},yI),L6t=ms({deceleration:20,maxSpeed:1400},yI),O6t=ms({deceleration:1e3,maxSpeed:360},yI),P6t=ms({deceleration:1e3,maxSpeed:90},yI);class D6t{constructor(t){z(this,"_map",void 0),z(this,"_inertiaBuffer",void 0),this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:Nf.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,r=Nf.now(),n=160;for(;t.length>0&&r-t[0].time>n;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const r={zoom:0,bearing:0,pitch:0,pan:new la(0,0),pinchAround:void 0,around:void 0};for(const{settings:o}of this._inertiaBuffer)r.zoom+=o.zoomDelta||0,r.bearing+=o.bearingDelta||0,r.pitch+=o.pitchDelta||0,o.panDelta&&r.pan._add(o.panDelta),o.around&&(r.around=o.around),o.pinchAround&&(r.pinchAround=o.pinchAround);const i=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,a={};if(r.pan.mag()){const o=cT(r.pan.mag(),i,ms({},I6t,t||{}));a.offset=r.pan.mult(o.amount/r.pan.mag()),a.center=this._map.transform.center,uT(a,o)}if(r.zoom){const o=cT(r.zoom,i,L6t);a.zoom=this._map.transform.zoom+o.amount,uT(a,o)}if(r.bearing){const o=cT(r.bearing,i,O6t);a.bearing=this._map.transform.bearing+Lp(o.amount,-179,179),uT(a,o)}if(r.pitch){const o=cT(r.pitch,i,P6t);a.pitch=this._map.transform.pitch+o.amount,uT(a,o)}if(a.zoom||a.bearing){const o=r.pinchAround===void 0?r.around:r.pinchAround;a.around=o?this._map.unproject(o):this._map.getCenter()}return this.clear(),ms(a,{noMoveStart:!0})}}function uT(e,t){(!e.duration||e.duration<t.duration)&&(e.duration=t.duration,e.easing=t.easing)}function cT(e,t,r){const{maxSpeed:n,linearity:i,deceleration:a}=r,o=Lp(e*i/(t/1e3),-n,n),s=Math.abs(o)/(a*i);return{easing:r.easing,duration:s*1e3,amount:o*(s/2)}}const hT=e=>e.zoom||e.drag||e.pitch||e.rotate;class F6t extends Gi{constructor(t,r){super(t),z(this,"type","renderFrame"),z(this,"timeStamp",void 0),this.timeStamp=r}}function TO(e){return e.panDelta&&e.panDelta.mag()||e.zoomDelta||e.bearingDelta||e.pitchDelta}class B6t{constructor(t,r){z(this,"_map",void 0),z(this,"_el",void 0),z(this,"_handlers",void 0),z(this,"_eventsInProgress",void 0),z(this,"_frameId",void 0),z(this,"_inertia",void 0),z(this,"_bearingSnap",void 0),z(this,"_handlersById",void 0),z(this,"_updatingCamera",void 0),z(this,"_changes",void 0),z(this,"_zoom",void 0),z(this,"_previousActiveHandlers",void 0),z(this,"_listeners",void 0),z(this,"handleWindowEvent",i=>{this.handleEvent(i,`${i.type}Window`)}),z(this,"handleEvent",(i,a)=>{if(i.type==="blur"){this.stop(!0);return}this._updatingCamera=!0;const o=i.type==="renderFrame"?void 0:i,s={needsRenderFrame:!1},l={},u={},c=i.touches,f=c?this._getMapTouches(c):void 0,d=f?jn.touchPos(this._map.getCanvasContainer(),f):jn.mousePos(this._map.getCanvasContainer(),i);for(const{handlerName:x,handler:w,allowed:S}of this._handlers){if(!w.isEnabled())continue;let A;this._blockedByActive(u,S,x)?w.reset():w[a||i.type]&&(A=w[a||i.type](i,d,f),this.mergeHandlerResult(s,l,A,x,o),A&&A.needsRenderFrame&&this._triggerRenderFrame()),(A||w.isActive())&&(u[x]=w)}const v={};for(const x in this._previousActiveHandlers)u[x]||(v[x]=o);this._previousActiveHandlers=u,(Object.keys(v).length||TO(s))&&(this._changes.push([s,l,v]),this._triggerRenderFrame()),(Object.keys(u).length||TO(s))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:g}=s;g&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],g(this._map))}),this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new D6t(t),this._bearingSnap=r.bearingSnap||7,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(r);const n=this._el;this._listeners=[[n,"touchstart",{passive:!0}],[n,"touchmove",{passive:!1}],[n,"touchend",void 0],[n,"touchcancel",void 0],[n,"mousedown",void 0],[n,"mousemove",void 0],[n,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[n,"mouseover",void 0],[n,"mouseout",void 0],[n,"dblclick",void 0],[n,"click",void 0],[n,"keydown",{capture:!1}],[n,"keyup",void 0],[n,"wheel",{passive:!1}],[n,"contextmenu",void 0],[window,"blur",void 0]];for(const[i,a,o]of this._listeners)jn.addEventListener(i,a,i===document?this.handleWindowEvent:this.handleEvent,o)}destroy(){for(const[t,r,n]of this._listeners)jn.removeEventListener(t,r,t===document?this.handleWindowEvent:this.handleEvent,n)}_addDefaultHandlers(t){const r=this._map,n=r.getCanvasContainer();this._add("mapEvent",new e6t(r,t));const i=r.boxZoom=new Ykt(r,t);this._add("boxZoom",i),t.interactive&&t.boxZoom&&i.enable();const a=r.cooperativeGestures=new qkt(r,t.cooperativeGestures);this._add("cooperativeGestures",a),t.cooperativeGestures&&a.enable();const o=new E6t(r),s=new Zkt(r);r.doubleClickZoom=new p6t(s,o),this._add("tapZoom",o),this._add("clickZoom",s),t.interactive&&t.doubleClickZoom&&r.doubleClickZoom.enable();const l=new b6t;this._add("tapDragZoom",l);const u=r.touchPitch=new R6t(r);this._add("touchPitch",u),t.interactive&&t.touchPitch&&r.touchPitch.enable(t.touchPitch);const c=l6t(t),f=u6t(t);r.dragRotate=new g6t(t,c,f),this._add("mouseRotate",c,["mousePitch"]),this._add("mousePitch",f,["mouseRotate"]),t.interactive&&t.dragRotate&&r.dragRotate.enable();const d=s6t(t),v=new w6t(t,r);r.dragPan=new v6t(n,d,v),this._add("mousePan",d),this._add("touchPan",v,["touchZoom","touchRotate"]),t.interactive&&t.dragPan&&r.dragPan.enable(t.dragPan);const g=new A6t,x=new S6t;r.touchZoomRotate=new m6t(n,x,g,l),this._add("touchRotate",g,["touchPan","touchZoom"]),this._add("touchZoom",x,["touchPan","touchRotate"]),t.interactive&&t.touchZoomRotate&&r.touchZoomRotate.enable(t.touchZoomRotate);const w=r.scrollZoom=new d6t(r,()=>this._triggerRenderFrame());this._add("scrollZoom",w,["mousePan"]),t.interactive&&t.scrollZoom&&r.scrollZoom.enable(t.scrollZoom);const S=r.keyboard=new Qkt(r);this._add("keyboard",S),t.interactive&&t.keyboard&&r.keyboard.enable(),this._add("blockableMapEvent",new r6t(r))}_add(t,r,n){this._handlers.push({handlerName:t,handler:r,allowed:n}),this._handlersById[t]=r}stop(t){if(!this._updatingCamera){for(const{handler:r}of this._handlers)r.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!hT(this._eventsInProgress)||this.isZooming()}_blockedByActive(t,r,n){for(const i in t)if(i!==n&&(!r||r.indexOf(i)<0))return!0;return!1}_getMapTouches(t){const r=[];for(const n of t){const i=n.target;this._el.contains(i)&&r.push(n)}return r}mergeHandlerResult(t,r,n,i,a){if(!n)return;ms(t,n);const o={handlerName:i,originalEvent:n.originalEvent||a};n.zoomDelta!==void 0&&(r.zoom=o),n.panDelta!==void 0&&(r.drag=o),n.pitchDelta!==void 0&&(r.pitch=o),n.bearingDelta!==void 0&&(r.rotate=o)}_applyChanges(){const t={},r={},n={};for(const[i,a,o]of this._changes)i.panDelta&&(t.panDelta=(t.panDelta||new la(0,0))._add(i.panDelta)),i.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+i.zoomDelta),i.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+i.bearingDelta),i.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+i.pitchDelta),i.around!==void 0&&(t.around=i.around),i.pinchAround!==void 0&&(t.pinchAround=i.pinchAround),i.noInertia&&(t.noInertia=i.noInertia),ms(r,a),ms(n,o);this._updateMapTransform(t,r,n),this._changes=[]}_updateMapTransform(t,r,n){const i=this._map,a=i._getTransformForUpdate();if(!TO(t))return this._fireEvents(r,n,!0);const{panDelta:o,zoomDelta:s,bearingDelta:l,pitchDelta:u,pinchAround:c}=t;let{around:f}=t;c!==void 0&&(f=c),i._stop(!0),f=f||i.transform.centerPoint;const d=a.pointLocation(o?f.sub(o):f);l&&(a.bearing+=l),u&&(a.pitch+=u),s&&(a.zoom+=s),a.setLocationAtPoint(d,f),i._applyUpdatedTransform(a),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(r,n,!0)}_fireEvents(t,r,n){const i=hT(this._eventsInProgress),a=hT(t),o={};for(const f in t){const{originalEvent:d}=t[f];this._eventsInProgress[f]||(o[`${f}start`]=d),this._eventsInProgress[f]=t[f]}!i&&a&&this._fireEvent("movestart",a.originalEvent);for(const f in o)this._fireEvent(f,o[f]);a&&this._fireEvent("move",a.originalEvent);for(const f in t){const{originalEvent:d}=t[f];this._fireEvent(f,d)}const s={};let l;for(const f in this._eventsInProgress){const{handlerName:d,originalEvent:v}=this._eventsInProgress[f];this._handlersById[d].isActive()||(delete this._eventsInProgress[f],l=r[d]||v,s[`${f}end`]=l)}for(const f in s)this._fireEvent(f,s[f]);const u=hT(this._eventsInProgress);if(n&&((i||a)&&!u)){this._updatingCamera=!0;const f=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),d=v=>v!==0&&-this._bearingSnap<v&&v<this._bearingSnap;f&&(f.essential||!Nf.prefersReducedMotion)?(d(f.bearing||this._map.getBearing())&&(f.bearing=0),f.freezeElevation=!0,this._map.easeTo(f,{originalEvent:l})):(this._map.fire(new Gi("moveend",{originalEvent:l})),d(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(t,r){this._map.fire(new Gi(t,r?{originalEvent:r}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{delete this._frameId,this.handleEvent(new F6t("renderFrame",t)),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class N6t{constructor(){z(this,"_queue",void 0),z(this,"_id",void 0),z(this,"_cleared",void 0),z(this,"_currentlyRunning",void 0),this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const r=++this._id;return this._queue.push({callback:t,id:r,cancelled:!1}),r}remove(t){const r=this._currentlyRunning,n=r?this._queue.concat(r):this._queue;for(const i of n)if(i.id===t){i.cancelled=!0;return}}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const r=this._currentlyRunning=this._queue;this._queue=[];for(const n of r)if(!n.cancelled&&(n.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function k6t(e,t){var r=typeof my<"u"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,n=typeof wx<"u"&&wx!==null&&(typeof wx.request<"u"||typeof wx.miniProgram<"u");if(!(r||n)&&(t||(t=document),!!t)){var i=t.head||t.getElementsByTagName("head")[0];if(!i){i=t.createElement("head");var a=t.body||t.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(i,a):t.documentElement.appendChild(i)}var o=t.createElement("style");return o.type="text/css",o.styleSheet?o.styleSheet.cssText=e:o.appendChild(t.createTextNode(e)),i.appendChild(o),o}}k6t(`.l7-map {
  font:
    12px/20px 'Helvetica Neue',
    Arial,
    Helvetica,
    sans-serif;
  overflow: hidden;
  position: relative;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}

.l7-canvas {
  position: absolute;
  left: 0;
  top: 0;
}

.l7-map:-webkit-full-screen {
  width: 100%;
  height: 100%;
}

.l7-canary {
  background-color: salmon;
}

.l7-canvas-container.l7-interactive,
.l7-ctrl-group button.l7-ctrl-compass {
  cursor: grab;
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
}

.l7-canvas-container.l7-interactive.l7-track-pointer {
  cursor: pointer;
}

.l7-canvas-container.l7-interactive:active,
.l7-ctrl-group button.l7-ctrl-compass:active {
  cursor: grabbing;
}

.l7-canvas-container.l7-touch-zoom-rotate,
.l7-canvas-container.l7-touch-zoom-rotate .l7-canvas {
  touch-action: pan-x pan-y;
}

.l7-canvas-container.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-drag-pan .l7-canvas {
  touch-action: pinch-zoom;
}

.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan .l7-canvas {
  touch-action: none;
}

.l7-canvas-container.l7-touch-drag-pan.l7-cooperative-gestures,
.l7-canvas-container.l7-touch-drag-pan.l7-cooperative-gestures .l7-canvas {
  touch-action: pan-x pan-y;
}

.l7-cooperative-gesture-screen {
  background: rgba(0 0 0 / 40%);
  position: absolute;
  inset: 0;
  display: flex;
  justify-content: center;
  align-items: center;
  color: white;
  padding: 1rem;
  font-size: 1.4em;
  line-height: 1.2;
  opacity: 0;
  pointer-events: none;
  transition: opacity 1s ease 1s;
  z-index: 99999;
}

.l7-cooperative-gesture-screen.l7-show {
  opacity: 1;
  transition: opacity 0.05s;
}

.l7-cooperative-gesture-screen .l7-mobile-message {
  display: none;
}

@media (hover: none), (width <= 480px) {
  .l7-cooperative-gesture-screen .l7-desktop-message {
    display: none;
  }

  .l7-cooperative-gesture-screen .l7-mobile-message {
    display: block;
  }
}

.l7-ctrl-top-left,
.l7-ctrl-top-right,
.l7-ctrl-bottom-left,
.l7-ctrl-bottom-right {
  position: absolute;
  pointer-events: none;
  z-index: 2;
}
.l7-ctrl-top-left {
  top: 0;
  left: 0;
}
.l7-ctrl-top-right {
  top: 0;
  right: 0;
}
.l7-ctrl-bottom-left {
  bottom: 0;
  left: 0;
}
.l7-ctrl-bottom-right {
  right: 0;
  bottom: 0;
}

.l7-ctrl {
  clear: both;
  pointer-events: auto;

  /* workaround for a Safari bug https://github.com/mapbox/mapbox-gl-js/issues/8185 */
  -webkit-transform: translate(0, 0);
          transform: translate(0, 0);
}
.l7-ctrl-top-left .l7-ctrl {
  margin: 10px 0 0 10px;
  float: left;
}
.l7-ctrl-top-right .l7-ctrl {
  margin: 10px 10px 0 0;
  float: right;
}
.l7-ctrl-bottom-left .l7-ctrl {
  margin: 0 0 10px 10px;
  float: left;
}
.l7-ctrl-bottom-right .l7-ctrl {
  margin: 0 10px 10px 0;
  float: right;
}

.l7-crosshair,
.l7-crosshair .l7-interactive,
.l7-crosshair .l7-interactive:active {
  cursor: crosshair;
}

.l7-boxzoom {
  position: absolute;
  top: 0;
  left: 0;
  width: 0;
  height: 0;
  background: #fff;
  border: 2px dotted #202020;
  opacity: 0.5;
  z-index: 10;
}
`);const LA=-2,HJ=22,fm=0,VJ=60,fT=85,z6t={interactive:!0,bearingSnap:7,scrollZoom:!0,minZoom:LA,maxZoom:HJ,minPitch:fm,maxPitch:VJ,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,fadeDuration:300,clickTolerance:3,pitchWithRotate:!0};let U6t=class extends jkt{constructor(t){const r=Ce(Ce({},z6t),t);if(r.minZoom!=null&&r.maxZoom!=null&&r.minZoom>r.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(r.minPitch!=null&&r.maxPitch!=null&&r.minPitch>r.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(r.minPitch!=null&&r.minPitch<fm)throw new Error(`minPitch must be greater than or equal to ${fm}`);if(r.maxPitch!=null&&r.maxPitch>fT)throw new Error(`maxPitch must be less than or equal to ${fT}`);const n=new E4(r.minZoom,r.maxZoom,r.minPitch,r.maxPitch,r.renderWorldCopies);if(super(n,{bearingSnap:r.bearingSnap}),z(this,"_container",void 0),z(this,"_canvasContainer",void 0),z(this,"_interactive",void 0),z(this,"_frameRequest",void 0),z(this,"_loaded",void 0),z(this,"_idleTriggered",!1),z(this,"_fullyLoaded",void 0),z(this,"_trackResize",void 0),z(this,"_resizeObserver",void 0),z(this,"_preserveDrawingBuffer",void 0),z(this,"_failIfMajorPerformanceCaveat",void 0),z(this,"_fadeDuration",void 0),z(this,"_crossSourceCollisions",void 0),z(this,"_crossFadingFactor",1),z(this,"_collectResourceTiming",void 0),z(this,"_renderTaskQueue",new N6t),z(this,"_mapId",Bkt()),z(this,"_removed",void 0),z(this,"_clickTolerance",void 0),z(this,"scrollZoom",void 0),z(this,"boxZoom",void 0),z(this,"dragRotate",void 0),z(this,"dragPan",void 0),z(this,"keyboard",void 0),z(this,"doubleClickZoom",void 0),z(this,"touchZoomRotate",void 0),z(this,"touchPitch",void 0),z(this,"cooperativeGestures",void 0),z(this,"_onMapScroll",i=>{if(i.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}),this._interactive=r.interactive,this._trackResize=r.trackResize===!0,this._bearingSnap=r.bearingSnap,this._fadeDuration=r.fadeDuration,this._clickTolerance=r.clickTolerance,typeof r.container=="string"){if(this._container=document.getElementById(r.container),!this._container)throw new Error(`Container '${r.container}' not found.`)}else if(r.container instanceof HTMLElement)this._container=r.container;else throw new Error("Invalid type: 'container' must be a String or HTMLElement.");if(r.maxBounds&&this.setMaxBounds(r.maxBounds),this._setupContainer(),this.on("move",()=>this._update()).on("moveend",()=>this._update()).on("zoom",()=>this._update()).once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){let i=!1;const a=is.throttle(o=>{this._trackResize&&!this._removed&&this.resize(o)._update()},50);this._resizeObserver=new ResizeObserver(o=>{if(!i){i=!0;return}a(o)}),this._resizeObserver.observe(this._container)}this.handlers=new B6t(this,r),this.jumpTo({center:r.center,zoom:r.zoom,bearing:r.bearing,pitch:r.pitch}),r.bounds&&(this.resize(),this.fitBounds(r.bounds,ms({},r.fitBoundsOptions,{duration:0}))),this.resize()}_getMapId(){return this._mapId}calculateCameraOptionsFromTo(t,r,n,i){return super.calculateCameraOptionsFromTo(t,r,n,i)}resize(t){var r;const n=this._containerDimensions(),i=n[0],a=n[1];this.transform.resize(i,a),(r=this._requestedCameraState)===null||r===void 0||r.resize(i,a);const o=!this._moving;return o&&(this.stop(),this.fire(new Gi("movestart",t)).fire(new Gi("move",t))),this.fire(new Gi("resize",t)),o&&this.fire(new Gi("moveend",t)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(t){return this.transform.setMaxBounds(t&&Ad.convert(t)),this._update()}setMinZoom(t){if(t=t??LA,t>=LA&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t&&this.setZoom(t),this;throw new Error(`minZoom must be between ${LA} and the current maxZoom, inclusive`)}getMinZoom(){return this.transform.minZoom}setMaxZoom(t){if(t=t??HJ,t>=this.transform.minZoom)return this.transform.maxZoom=t,this.getZoom()>t&&this.setZoom(t),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(t){if(t=t??fm,t<fm)throw new Error(`minPitch must be greater than or equal to ${fm}`);if(t>=fm&&t<=this.transform.maxPitch)return this.transform.minPitch=t,this.getPitch()<t&&this.setPitch(t),this;throw new Error(`minPitch must be between ${fm} and the current maxPitch, inclusive`)}getMinPitch(){return this.transform.minPitch}setMaxPitch(t){if(t=t??VJ,t>fT)throw new Error(`maxPitch must be less than or equal to ${fT}`);if(t>=this.transform.minPitch)return this.transform.maxPitch=t,this.getPitch()>t&&this.setPitch(t),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(t){this.transform.renderWorldCopies=t}project(t){return this.transform.locationPoint(ya.convert(t))}unproject(t){return this.transform.pointLocation(la.convert(t))}isMoving(){var t;return this._moving||((t=this.handlers)===null||t===void 0?void 0:t.isMoving())}isZooming(){var t;return this._zooming||((t=this.handlers)===null||t===void 0?void 0:t.isZooming())}isRotating(){var t;return this._rotating||((t=this.handlers)===null||t===void 0?void 0:t.isRotating())}on(t,r){return super.on(t,r)}once(t,r){return super.once(t,r)}off(t,r){return super.off(t,r)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}_containerDimensions(){let t=0,r=0;return this._container&&(t=this._container.clientWidth||400,r=this._container.clientHeight||300),[t,r]}_setupContainer(){const t=this._container;t.classList.add("l7-map");const r=this._canvasContainer=jn.create("div","l7-canvas-container",t);this._interactive&&r.classList.add("l7-interactive"),this._container.addEventListener("scroll",this._onMapScroll,!1)}_update(){return this.triggerRepaint(),this}_requestRenderFrame(t){return this._update(),this._renderTaskQueue.add(t)}_cancelRenderFrame(t){this._renderTaskQueue.remove(t)}_render(t){if(this._renderTaskQueue.run(t),!this._removed)return this.fire(new Gi("render")),this.isMoving()||this.fire(new Gi("idle")),this}remove(){var t;this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.handlers.destroy(),delete this.handlers,(t=this._resizeObserver)===null||t===void 0||t.disconnect(),jn.remove(this._canvasContainer),this._container.classList.remove("l7-map"),this._removed=!0,this.fire(new Gi("remove"))}triggerRepaint(){this._frameRequest||(this._frameRequest=new AbortController,Nf.frameAsync(this._frameRequest).then(t=>{this._frameRequest=null,this._render(t)}).catch(()=>{}))}getCameraTargetElevation(){return this.transform.elevation}};const $6t=["id","style","rotation","mapInstance","version","mapSize","interactive"];class H6t extends DJ{constructor(...t){super(...t),z(this,"version",PJ.DEFAULT),z(this,"viewport",void 0)}lngLatToCoord(t,r={x:0,y:0,z:0}){const{x:n,y:i}=this.lngLatToMercator(t,0);return[n-r.x,i-r.y]}lngLatToMercator(t,r){const{x:n=0,y:i=0,z:a=0}=Pp.fromLngLat(t,r);return{x:n,y:i,z:a}}getModelMatrix(t,r,n,i=[1,1,1],a={x:0,y:0,z:0}){const o=Pp.fromLngLat(t,r),s=o.meterInMercatorCoordinateUnits(),l=xb();return Lf(l,l,ec(o.x-a.x,o.y-a.y,o.z||0-a.z)),Of(l,l,ec(s*i[0],-s*i[1],s*i[2])),bb(l,l,n[0]),cI(l,l,n[1]),ES(l,l,n[2]),l}init(){var t=this;return Pe(function*(){const r=t.config,{id:n="map",style:i="light",rotation:a=0,mapInstance:o,version:s="DEFAULTMAP",mapSize:l=1e4,interactive:u=!0}=r,c=Hf(r,$6t);t.viewport=new y4,t.version=s,t.simpleMapCoord.setSize(l),s==="SIMPLE"&&c.center&&(c.center=t.simpleMapCoord.unproject(c.center)),o?(t.map=o,t.$mapContainer=t.map.getContainer()):(t.$mapContainer=t.creatMapContainer(n),t.map=new U6t(Ce({container:t.$mapContainer,bearing:a},c))),t.map.on("load",()=>{t.handleCameraChanged()}),u&&t.map.on("move",t.handleCameraChanged),setTimeout(()=>{t.handleCameraChanged()},100),t.handleCameraChanged()})()}creatMapContainer(t){let r=t;typeof t=="string"&&(r=document.getElementById(t));const n=document.createElement("div");return n.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,r.appendChild(n),n}exportMap(t){return""}setMapStyle(t){}getCanvasOverlays(){return this.getContainer()}}let V6t=class extends g4{getServiceConstructor(){return H6t}};var GJ={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(Cm,function(){var r,n,i;function a(o,s){if(!r)r=s;else if(!n)n=s;else{var l="var sharedChunk = {}; ("+r+")(sharedChunk); ("+n+")(sharedChunk);",u={};r(u),i=s(u),typeof window<"u"&&(i.workerUrl=window.URL.createObjectURL(new Blob([l],{type:"text/javascript"})))}}return a(["exports"],function(o){function s(h,p){return h(p={exports:{}},p.exports),p.exports}var l=u;function u(h,p,m,E){this.cx=3*h,this.bx=3*(m-h)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*p,this.by=3*(E-p)-this.cy,this.ay=1-this.cy-this.by,this.p1x=h,this.p1y=E,this.p2x=m,this.p2y=E}u.prototype.sampleCurveX=function(h){return((this.ax*h+this.bx)*h+this.cx)*h},u.prototype.sampleCurveY=function(h){return((this.ay*h+this.by)*h+this.cy)*h},u.prototype.sampleCurveDerivativeX=function(h){return(3*this.ax*h+2*this.bx)*h+this.cx},u.prototype.solveCurveX=function(h,p){var m,E,T,I,P;for(p===void 0&&(p=1e-6),T=h,P=0;P<8;P++){if(I=this.sampleCurveX(T)-h,Math.abs(I)<p)return T;var B=this.sampleCurveDerivativeX(T);if(Math.abs(B)<1e-6)break;T-=I/B}if((T=h)<(m=0))return m;if(T>(E=1))return E;for(;m<E;){if(I=this.sampleCurveX(T),Math.abs(I-h)<p)return T;h>I?m=T:E=T,T=.5*(E-m)+m}return T},u.prototype.solve=function(h,p){return this.sampleCurveY(this.solveCurveX(h,p))};var c=f;function f(h,p){this.x=h,this.y=p}f.prototype={clone:function(){return new f(this.x,this.y)},add:function(h){return this.clone()._add(h)},sub:function(h){return this.clone()._sub(h)},multByPoint:function(h){return this.clone()._multByPoint(h)},divByPoint:function(h){return this.clone()._divByPoint(h)},mult:function(h){return this.clone()._mult(h)},div:function(h){return this.clone()._div(h)},rotate:function(h){return this.clone()._rotate(h)},rotateAround:function(h,p){return this.clone()._rotateAround(h,p)},matMult:function(h){return this.clone()._matMult(h)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(h){return this.x===h.x&&this.y===h.y},dist:function(h){return Math.sqrt(this.distSqr(h))},distSqr:function(h){var p=h.x-this.x,m=h.y-this.y;return p*p+m*m},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(h){return Math.atan2(this.y-h.y,this.x-h.x)},angleWith:function(h){return this.angleWithSep(h.x,h.y)},angleWithSep:function(h,p){return Math.atan2(this.x*p-this.y*h,this.x*h+this.y*p)},_matMult:function(h){var p=h[2]*this.x+h[3]*this.y;return this.x=h[0]*this.x+h[1]*this.y,this.y=p,this},_add:function(h){return this.x+=h.x,this.y+=h.y,this},_sub:function(h){return this.x-=h.x,this.y-=h.y,this},_mult:function(h){return this.x*=h,this.y*=h,this},_div:function(h){return this.x/=h,this.y/=h,this},_multByPoint:function(h){return this.x*=h.x,this.y*=h.y,this},_divByPoint:function(h){return this.x/=h.x,this.y/=h.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var h=this.y;return this.y=this.x,this.x=-h,this},_rotate:function(h){var p=Math.cos(h),m=Math.sin(h),E=m*this.x+p*this.y;return this.x=p*this.x-m*this.y,this.y=E,this},_rotateAround:function(h,p){var m=Math.cos(h),E=Math.sin(h),T=p.y+E*(this.x-p.x)+m*(this.y-p.y);return this.x=p.x+m*(this.x-p.x)-E*(this.y-p.y),this.y=T,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},f.convert=function(h){return h instanceof f?h:Array.isArray(h)?new f(h[0],h[1]):h};var d=typeof self<"u"?self:{},v=Math.pow(2,53)-1;function g(h,p,m,E){var T=new l(h,p,m,E);return function(I){return T.solve(I)}}var x=g(.25,.1,.25,1);function w(h,p,m){return Math.min(m,Math.max(p,h))}function S(h,p,m){var E=m-p,T=((h-p)%E+E)%E+p;return T===p?m:T}function A(h){for(var p=[],m=arguments.length-1;m-- >0;)p[m]=arguments[m+1];for(var E=0,T=p;E<T.length;E+=1){var I=T[E];for(var P in I)h[P]=I[P]}return h}var M=1;function R(){return M++}function O(){return function h(p){return p?(p^16*Math.random()>>p/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,h)}()}function N(h){return!!h&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(h)}function k(h,p){h.forEach(function(m){p[m]&&(p[m]=p[m].bind(p))})}function V(h,p){return h.indexOf(p,h.length-p.length)!==-1}function Q(h,p,m){var E={};for(var T in h)E[T]=p.call(m||this,h[T],T,h);return E}function Y(h,p,m){var E={};for(var T in h)p.call(m||this,h[T],T,h)&&(E[T]=h[T]);return E}function X(h){return Array.isArray(h)?h.map(X):typeof h=="object"&&h?Q(h,X):h}var tt={};function it(h){tt[h]||(typeof console<"u"&&console.warn(h),tt[h]=!0)}function Et(h,p,m){return(m.y-h.y)*(p.x-h.x)>(p.y-h.y)*(m.x-h.x)}function Tt(h){for(var p=0,m=0,E=h.length,T=E-1,I=void 0,P=void 0;m<E;T=m++)p+=((P=h[T]).x-(I=h[m]).x)*(I.y+P.y);return p}function pt(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function kt(h){var p={};if(h.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(E,T,I,P){var B=I||P;return p[T]=!B||B.toLowerCase(),""}),p["max-age"]){var m=parseInt(p["max-age"],10);isNaN(m)?delete p["max-age"]:p["max-age"]=m}return p}var ae=null;function Kt(h){if(ae==null){var p=h.navigator?h.navigator.userAgent:null;ae=!!h.safari||!(!p||!(/\b(iPad|iPhone|iPod)\b/.test(p)||p.match("Safari")&&!p.match("Chrome")))}return ae}function re(h){try{var p=d[h];return p.setItem("_mapbox_test_",1),p.removeItem("_mapbox_test_"),!0}catch{return!1}}var fe,Oe,Ye,Be,De=d.performance&&d.performance.now?d.performance.now.bind(d.performance):Date.now.bind(Date),Yr=d.requestAnimationFrame||d.mozRequestAnimationFrame||d.webkitRequestAnimationFrame||d.msRequestAnimationFrame,Gr=d.cancelAnimationFrame||d.mozCancelAnimationFrame||d.webkitCancelAnimationFrame||d.msCancelAnimationFrame,Mn={now:De,frame:function(h){var p=Yr(h);return{cancel:function(){return Gr(p)}}},getImageData:function(h,p){p===void 0&&(p=0);var m=d.document.createElement("canvas"),E=m.getContext("2d");if(!E)throw new Error("failed to create canvas 2d context");return m.width=h.width,m.height=h.height,E.drawImage(h,0,0,h.width,h.height),E.getImageData(-p,-p,h.width+2*p,h.height+2*p)},resolveURL:function(h){return fe||(fe=d.document.createElement("a")),fe.href=h,fe.href},hardwareConcurrency:d.navigator&&d.navigator.hardwareConcurrency||4,get devicePixelRatio(){return d.devicePixelRatio},get prefersReducedMotion(){return!!d.matchMedia&&(Oe==null&&(Oe=d.matchMedia("(prefers-reduced-motion: reduce)")),Oe.matches)}},ee={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},rr={supported:!1,testSupport:function(h){!Nr&&Be&&(Fe?Hr(h):Ye=h)}},Nr=!1,Fe=!1;function Hr(h){var p=h.createTexture();h.bindTexture(h.TEXTURE_2D,p);try{if(h.texImage2D(h.TEXTURE_2D,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,Be),h.isContextLost())return;rr.supported=!0}catch{}h.deleteTexture(p),Nr=!0}d.document&&((Be=d.document.createElement("img")).onload=function(){Ye&&Hr(Ye),Ye=null,Fe=!0},Be.onerror=function(){Nr=!0,Ye=null},Be.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var _n="01",Kn=function(h,p){this._transformRequestFn=h,this._customAccessToken=p,this._createSkuToken()};function vn(h){return h.indexOf("mapbox:")===0}Kn.prototype._createSkuToken=function(){var h=function(){for(var p="",m=0;m<10;m++)p+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",_n,p].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=h.token,this._skuTokenExpiresAt=h.tokenExpiresAt},Kn.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},Kn.prototype.transformRequest=function(h,p){return this._transformRequestFn&&this._transformRequestFn(h,p)||{url:h}},Kn.prototype.normalizeStyleURL=function(h,p){if(!vn(h))return h;var m=ta(h);return m.path="/styles/v1"+m.path,this._makeAPIURL(m,this._customAccessToken||p)},Kn.prototype.normalizeGlyphsURL=function(h,p){if(!vn(h))return h;var m=ta(h);return m.path="/fonts/v1"+m.path,this._makeAPIURL(m,this._customAccessToken||p)},Kn.prototype.normalizeSourceURL=function(h,p){if(!vn(h))return h;var m=ta(h);return m.path="/v4/"+m.authority+".json",m.params.push("secure"),this._makeAPIURL(m,this._customAccessToken||p)},Kn.prototype.normalizeSpriteURL=function(h,p,m,E){var T=ta(h);return vn(h)?(T.path="/styles/v1"+T.path+"/sprite"+p+m,this._makeAPIURL(T,this._customAccessToken||E)):(T.path+=""+p+m,oa(T))},Kn.prototype.normalizeTileURL=function(h,p){if(this._isSkuTokenExpired()&&this._createSkuToken(),h&&!vn(h))return h;var m=ta(h);m.path=m.path.replace(/(\.(png|jpg)\d*)(?=$)/,(Mn.devicePixelRatio>=2||p===512?"@2x":"")+(rr.supported?".webp":"$1")),m.path=m.path.replace(/^.+\/v4\//,"/"),m.path="/v4"+m.path;var E=this._customAccessToken||function(T){for(var I=0,P=T;I<P.length;I+=1){var B=P[I].match(/^access_token=(.*)$/);if(B)return B[1]}return null}(m.params)||ee.ACCESS_TOKEN;return ee.REQUIRE_ACCESS_TOKEN&&E&&this._skuToken&&m.params.push("sku="+this._skuToken),this._makeAPIURL(m,E)},Kn.prototype.canonicalizeTileURL=function(h,p){var m=ta(h);if(!m.path.match(/(^\/v4\/)/)||!m.path.match(/\.[\w]+$/))return h;var E="mapbox://tiles/";E+=m.path.replace("/v4/","");var T=m.params;return p&&(T=T.filter(function(I){return!I.match(/^access_token=/)})),T.length&&(E+="?"+T.join("&")),E},Kn.prototype.canonicalizeTileset=function(h,p){for(var m=!!p&&vn(p),E=[],T=0,I=h.tiles||[];T<I.length;T+=1){var P=I[T];ui(P)?E.push(this.canonicalizeTileURL(P,m)):E.push(P)}return E},Kn.prototype._makeAPIURL=function(h,p){var m="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",E=ta(ee.API_URL);if(h.protocol=E.protocol,h.authority=E.authority,h.protocol==="http"){var T=h.params.indexOf("secure");T>=0&&h.params.splice(T,1)}if(E.path!=="/"&&(h.path=""+E.path+h.path),!ee.REQUIRE_ACCESS_TOKEN)return oa(h);if(!(p=p||ee.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+m);if(p[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+m);return h.params=h.params.filter(function(I){return I.indexOf("access_token")===-1}),h.params.push("access_token="+p),oa(h)};var xn=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function ui(h){return xn.test(h)}var Ao=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ta(h){var p=h.match(Ao);if(!p)throw new Error("Unable to parse URL object");return{protocol:p[1],authority:p[2],path:p[3]||"/",params:p[4]?p[4].split("&"):[]}}function oa(h){var p=h.params.length?"?"+h.params.join("&"):"";return h.protocol+"://"+h.authority+h.path+p}function as(h){if(!h)return null;var p=h.split(".");if(!p||p.length!==3)return null;try{return JSON.parse(decodeURIComponent(d.atob(p[1]).split("").map(function(m){return"%"+("00"+m.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var bt=function(h){this.type=h,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};bt.prototype.getStorageKey=function(h){var p,m=as(ee.ACCESS_TOKEN);return p=m&&m.u?d.btoa(encodeURIComponent(m.u).replace(/%([0-9A-F]{2})/g,function(E,T){return String.fromCharCode(+("0x"+T))})):ee.ACCESS_TOKEN||"",h?"mapbox.eventData."+h+":"+p:"mapbox.eventData:"+p},bt.prototype.fetchEventData=function(){var h=re("localStorage"),p=this.getStorageKey(),m=this.getStorageKey("uuid");if(h)try{var E=d.localStorage.getItem(p);E&&(this.eventData=JSON.parse(E));var T=d.localStorage.getItem(m);T&&(this.anonId=T)}catch{it("Unable to read from LocalStorage")}},bt.prototype.saveEventData=function(){var h=re("localStorage"),p=this.getStorageKey(),m=this.getStorageKey("uuid");if(h)try{d.localStorage.setItem(m,this.anonId),Object.keys(this.eventData).length>=1&&d.localStorage.setItem(p,JSON.stringify(this.eventData))}catch{it("Unable to write to LocalStorage")}},bt.prototype.processRequests=function(h){},bt.prototype.postEvent=function(h,p,m,E){var T=this;if(ee.EVENTS_URL){var I=ta(ee.EVENTS_URL);I.params.push("access_token="+(E||ee.ACCESS_TOKEN||""));var P={event:this.type,created:new Date(h).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.3",skuId:_n,userId:this.anonId},B=p?A(P,p):P,H={url:oa(I),headers:{"Content-Type":"text/plain"},body:JSON.stringify([B])};this.pendingRequest=$i(H,function(G){T.pendingRequest=null,m(G),T.saveEventData(),T.processRequests(E)})}},bt.prototype.queueRequest=function(h,p){this.queue.push(h),this.processRequests(p)};var os,gu,ss=function(h){function p(){h.call(this,"map.load"),this.success={},this.skuToken=""}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype.postMapLoadEvent=function(m,E,T,I){this.skuToken=T;var P=!(!I&&!ee.ACCESS_TOKEN),B=Array.isArray(m)&&m.some(function(H){return vn(H)||ui(H)});ee.EVENTS_URL&&P&&B&&this.queueRequest({id:E,timestamp:Date.now()},I)},p.prototype.processRequests=function(m){var E=this;if(!this.pendingRequest&&this.queue.length!==0){var T=this.queue.shift(),I=T.id,P=T.timestamp;I&&this.success[I]||(this.anonId||this.fetchEventData(),N(this.anonId)||(this.anonId=O()),this.postEvent(P,{skuToken:this.skuToken},function(B){B||I&&(E.success[I]=!0)},m))}},p}(bt),Vu=new(function(h){function p(m){h.call(this,"appUserTurnstile"),this._customAccessToken=m}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype.postTurnstileEvent=function(m,E){ee.EVENTS_URL&&ee.ACCESS_TOKEN&&Array.isArray(m)&&m.some(function(T){return vn(T)||ui(T)})&&this.queueRequest(Date.now(),E)},p.prototype.processRequests=function(m){var E=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var T=as(ee.ACCESS_TOKEN),I=T?T.u:ee.ACCESS_TOKEN,P=I!==this.eventData.tokenU;N(this.anonId)||(this.anonId=O(),P=!0);var B=this.queue.shift();if(this.eventData.lastSuccess){var H=new Date(this.eventData.lastSuccess),G=new Date(B),Z=(B-this.eventData.lastSuccess)/864e5;P=P||Z>=1||Z<-1||H.getDate()!==G.getDate()}else P=!0;if(!P)return this.processRequests();this.postEvent(B,{"enabled.telemetry":!1},function(K){K||(E.eventData.lastSuccess=B,E.eventData.tokenU=I)},m)}},p}(bt)),va=Vu.postTurnstileEvent.bind(Vu),ls=new ss,il=ls.postMapLoadEvent.bind(ls),us=500,dc=50;function fo(){d.caches&&!os&&(os=d.caches.open("mapbox-tiles"))}function Gu(h){var p=h.indexOf("?");return p<0?h:h.slice(0,p)}var Cl,oh=1/0;function nd(){return Cl==null&&(Cl=d.OffscreenCanvas&&new d.OffscreenCanvas(1,1).getContext("2d")&&typeof d.createImageBitmap=="function"),Cl}var sh={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(sh);var Jd=function(h){function p(m,E,T){E===401&&ui(T)&&(m+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),h.call(this,m),this.status=E,this.url=T,this.name=this.constructor.name,this.message=m}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},p}(Error),lh=pt()?function(){return self.worker&&self.worker.referrer}:function(){return(d.location.protocol==="blob:"?d.parent:d).location.href},jl,Yl,pc=function(h,p){if(!(/^file:/.test(m=h.url)||/^file:/.test(lh())&&!/^\w+:/.test(m))){if(d.fetch&&d.Request&&d.AbortController&&d.Request.prototype.hasOwnProperty("signal"))return function(E,T){var I,P=new d.AbortController,B=new d.Request(E.url,{method:E.method||"GET",body:E.body,credentials:E.credentials,headers:E.headers,referrer:lh(),signal:P.signal}),H=!1,G=!1,Z=(I=B.url).indexOf("sku=")>0&&ui(I);E.type==="json"&&B.headers.set("Accept","application/json");var K=function(lt,St,Rt){if(!G){if(lt&&lt.message!=="SecurityError"&&it(lt),St&&Rt)return nt(St);var Gt=Date.now();d.fetch(B).then(function(Nt){if(Nt.ok){var ne=Z?Nt.clone():null;return nt(Nt,ne,Gt)}return T(new Jd(Nt.statusText,Nt.status,E.url))}).catch(function(Nt){Nt.code!==20&&T(new Error(Nt.message))})}},nt=function(lt,St,Rt){(E.type==="arrayBuffer"?lt.arrayBuffer():E.type==="json"?lt.json():lt.text()).then(function(Gt){G||(St&&Rt&&function(Nt,ne,le){if(fo(),os){var xe={status:ne.status,statusText:ne.statusText,headers:new d.Headers};ne.headers.forEach(function($e,sr){return xe.headers.set(sr,$e)});var we=kt(ne.headers.get("Cache-Control")||"");we["no-store"]||(we["max-age"]&&xe.headers.set("Expires",new Date(le+1e3*we["max-age"]).toUTCString()),new Date(xe.headers.get("Expires")).getTime()-le<42e4||function($e,sr){if(gu===void 0)try{new Response(new ReadableStream),gu=!0}catch{gu=!1}gu?sr($e.body):$e.blob().then(sr)}(ne,function($e){var sr=new d.Response($e,xe);fo(),os&&os.then(function(yr){return yr.put(Gu(Nt.url),sr)}).catch(function(yr){return it(yr.message)})}))}}(B,St,Rt),H=!0,T(null,Gt,lt.headers.get("Cache-Control"),lt.headers.get("Expires")))}).catch(function(Gt){G||T(new Error(Gt.message))})};return Z?function(lt,St){if(fo(),!os)return St(null);var Rt=Gu(lt.url);os.then(function(Gt){Gt.match(Rt).then(function(Nt){var ne=function(le){if(!le)return!1;var xe=new Date(le.headers.get("Expires")||0),we=kt(le.headers.get("Cache-Control")||"");return xe>Date.now()&&!we["no-cache"]}(Nt);Gt.delete(Rt),ne&&Gt.put(Rt,Nt.clone()),St(null,Nt,ne)}).catch(St)}).catch(St)}(B,K):K(null,null),{cancel:function(){G=!0,H||P.abort()}}}(h,p);if(pt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",h,p,void 0,!0)}var m;return function(E,T){var I=new d.XMLHttpRequest;for(var P in I.open(E.method||"GET",E.url,!0),E.type==="arrayBuffer"&&(I.responseType="arraybuffer"),E.headers)I.setRequestHeader(P,E.headers[P]);return E.type==="json"&&(I.responseType="text",I.setRequestHeader("Accept","application/json")),I.withCredentials=E.credentials==="include",I.onerror=function(){T(new Error(I.statusText))},I.onload=function(){if((I.status>=200&&I.status<300||I.status===0)&&I.response!==null){var B=I.response;if(E.type==="json")try{B=JSON.parse(I.response)}catch(H){return T(H)}T(null,B,I.getResponseHeader("Cache-Control"),I.getResponseHeader("Expires"))}else T(new Jd(I.statusText,I.status,E.url))},I.send(E.body),{cancel:function(){return I.abort()}}}(h,p)},id=function(h,p){return pc(A(h,{type:"arrayBuffer"}),p)},$i=function(h,p){return pc(A(h,{method:"POST"}),p)},J="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";jl=[],Yl=0;var rt=function(h,p){if(rr.supported&&(h.headers||(h.headers={}),h.headers.accept="image/webp,*/*"),Yl>=ee.MAX_PARALLEL_IMAGE_REQUESTS){var m={requestParameters:h,callback:p,cancelled:!1,cancel:function(){this.cancelled=!0}};return jl.push(m),m}Yl++;var E=!1,T=function(){if(!E)for(E=!0,Yl--;jl.length&&Yl<ee.MAX_PARALLEL_IMAGE_REQUESTS;){var P=jl.shift();P.cancelled||(P.cancel=rt(P.requestParameters,P.callback).cancel)}},I=id(h,function(P,B,H,G){T(),P?p(P):B&&(nd()?function(Z,K){var nt=new d.Blob([new Uint8Array(Z)],{type:"image/png"});d.createImageBitmap(nt).then(function(lt){K(null,lt)}).catch(function(lt){K(new Error("Could not load image because of "+lt.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(B,p):function(Z,K,nt,lt){var St=new d.Image,Rt=d.URL;St.onload=function(){K(null,St),Rt.revokeObjectURL(St.src),St.onload=null,d.requestAnimationFrame(function(){St.src=J})},St.onerror=function(){return K(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Gt=new d.Blob([new Uint8Array(Z)],{type:"image/png"});St.cacheControl=nt,St.expires=lt,St.src=Z.byteLength?Rt.createObjectURL(Gt):J}(B,p,H,G))});return{cancel:function(){I.cancel(),T()}}};function at(h,p,m){m[h]&&m[h].indexOf(p)!==-1||(m[h]=m[h]||[],m[h].push(p))}function mt(h,p,m){if(m&&m[h]){var E=m[h].indexOf(p);E!==-1&&m[h].splice(E,1)}}var Mt=function(h,p){p===void 0&&(p={}),A(this,p),this.type=h},Xt=function(h){function p(m,E){E===void 0&&(E={}),h.call(this,"error",A({error:m},E))}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p}(Mt),Qt=function(){};Qt.prototype.on=function(h,p){return this._listeners=this._listeners||{},at(h,p,this._listeners),this},Qt.prototype.off=function(h,p){return mt(h,p,this._listeners),mt(h,p,this._oneTimeListeners),this},Qt.prototype.once=function(h,p){return this._oneTimeListeners=this._oneTimeListeners||{},at(h,p,this._oneTimeListeners),this},Qt.prototype.fire=function(h,p){typeof h=="string"&&(h=new Mt(h,p||{}));var m=h.type;if(this.listens(m)){h.target=this;for(var E=0,T=this._listeners&&this._listeners[m]?this._listeners[m].slice():[];E<T.length;E+=1)T[E].call(this,h);for(var I=0,P=this._oneTimeListeners&&this._oneTimeListeners[m]?this._oneTimeListeners[m].slice():[];I<P.length;I+=1){var B=P[I];mt(m,B,this._oneTimeListeners),B.call(this,h)}var H=this._eventedParent;H&&(A(h,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),H.fire(h))}else h instanceof Xt&&console.error(h.error);return this},Qt.prototype.listens=function(h){return this._listeners&&this._listeners[h]&&this._listeners[h].length>0||this._oneTimeListeners&&this._oneTimeListeners[h]&&this._oneTimeListeners[h].length>0||this._eventedParent&&this._eventedParent.listens(h)},Qt.prototype.setEventedParent=function(h,p){return this._eventedParent=h,this._eventedParentData=p,this};var ct={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Pt=function(h,p,m,E){this.message=(h?h+": ":"")+m,E&&(this.identifier=E),p!=null&&p.__line__&&(this.line=p.__line__)};function oe(h){var p=h.value;return p?[new Pt(h.key,p,"constants have been deprecated as of v8")]:[]}function Le(h){for(var p=[],m=arguments.length-1;m-- >0;)p[m]=arguments[m+1];for(var E=0,T=p;E<T.length;E+=1){var I=T[E];for(var P in I)h[P]=I[P]}return h}function tr(h){return h instanceof Number||h instanceof String||h instanceof Boolean?h.valueOf():h}function Te(h){if(Array.isArray(h))return h.map(Te);if(h instanceof Object&&!(h instanceof Number||h instanceof String||h instanceof Boolean)){var p={};for(var m in h)p[m]=Te(h[m]);return p}return tr(h)}var Ze=function(h){function p(m,E){h.call(this,E),this.message=E,this.key=m}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p}(Error),jr=function(h,p){p===void 0&&(p=[]),this.parent=h,this.bindings={};for(var m=0,E=p;m<E.length;m+=1){var T=E[m];this.bindings[T[0]]=T[1]}};jr.prototype.concat=function(h){return new jr(this,h)},jr.prototype.get=function(h){if(this.bindings[h])return this.bindings[h];if(this.parent)return this.parent.get(h);throw new Error(h+" not found in scope.")},jr.prototype.has=function(h){return!!this.bindings[h]||!!this.parent&&this.parent.has(h)};var Ur={kind:"null"},Re={kind:"number"},Ar={kind:"string"},dr={kind:"boolean"},gr={kind:"color"},kn={kind:"object"},wr={kind:"value"},ci={kind:"collator"},ea={kind:"formatted"},ai={kind:"resolvedImage"};function wi(h,p){return{kind:"array",itemType:h,N:p}}function zn(h){if(h.kind==="array"){var p=zn(h.itemType);return typeof h.N=="number"?"array<"+p+", "+h.N+">":h.itemType.kind==="value"?"array":"array<"+p+">"}return h.kind}var po=[Ur,Re,Ar,dr,gr,ea,kn,wi(wr),ai];function pi(h,p){if(p.kind==="error")return null;if(h.kind==="array"){if(p.kind==="array"&&(p.N===0&&p.itemType.kind==="value"||!pi(h.itemType,p.itemType))&&(typeof h.N!="number"||h.N===p.N))return null}else{if(h.kind===p.kind)return null;if(h.kind==="value"){for(var m=0,E=po;m<E.length;m+=1)if(!pi(E[m],p))return null}}return"Expected "+zn(h)+" but found "+zn(p)+" instead."}function ra(h,p){return p.some(function(m){return m.kind===h.kind})}function Di(h,p){return p.some(function(m){return m==="null"?h===null:m==="array"?Array.isArray(h):m==="object"?h&&!Array.isArray(h)&&typeof h=="object":m===typeof h})}var Un=s(function(h,p){var m={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function E(B){return(B=Math.round(B))<0?0:B>255?255:B}function T(B){return E(B[B.length-1]==="%"?parseFloat(B)/100*255:parseInt(B))}function I(B){return(H=B[B.length-1]==="%"?parseFloat(B)/100:parseFloat(B))<0?0:H>1?1:H;var H}function P(B,H,G){return G<0?G+=1:G>1&&(G-=1),6*G<1?B+(H-B)*G*6:2*G<1?H:3*G<2?B+(H-B)*(2/3-G)*6:B}try{p.parseCSSColor=function(B){var H,G=B.replace(/ /g,"").toLowerCase();if(G in m)return m[G].slice();if(G[0]==="#")return G.length===4?(H=parseInt(G.substr(1),16))>=0&&H<=4095?[(3840&H)>>4|(3840&H)>>8,240&H|(240&H)>>4,15&H|(15&H)<<4,1]:null:G.length===7&&(H=parseInt(G.substr(1),16))>=0&&H<=16777215?[(16711680&H)>>16,(65280&H)>>8,255&H,1]:null;var Z=G.indexOf("("),K=G.indexOf(")");if(Z!==-1&&K+1===G.length){var nt=G.substr(0,Z),lt=G.substr(Z+1,K-(Z+1)).split(","),St=1;switch(nt){case"rgba":if(lt.length!==4)return null;St=I(lt.pop());case"rgb":return lt.length!==3?null:[T(lt[0]),T(lt[1]),T(lt[2]),St];case"hsla":if(lt.length!==4)return null;St=I(lt.pop());case"hsl":if(lt.length!==3)return null;var Rt=(parseFloat(lt[0])%360+360)%360/360,Gt=I(lt[1]),Nt=I(lt[2]),ne=Nt<=.5?Nt*(Gt+1):Nt+Gt-Nt*Gt,le=2*Nt-ne;return[E(255*P(le,ne,Rt+1/3)),E(255*P(le,ne,Rt)),E(255*P(le,ne,Rt-1/3)),St];default:return null}}return null}}catch{}}).parseCSSColor,oi=function(h,p,m,E){E===void 0&&(E=1),this.r=h,this.g=p,this.b=m,this.a=E};oi.parse=function(h){if(h){if(h instanceof oi)return h;if(typeof h=="string"){var p=Un(h);if(p)return new oi(p[0]/255*p[3],p[1]/255*p[3],p[2]/255*p[3],p[3])}}},oi.prototype.toString=function(){var h=this.toArray(),p=h[1],m=h[2],E=h[3];return"rgba("+Math.round(h[0])+","+Math.round(p)+","+Math.round(m)+","+E+")"},oi.prototype.toArray=function(){var h=this.a;return h===0?[0,0,0,0]:[255*this.r/h,255*this.g/h,255*this.b/h,h]},oi.black=new oi(0,0,0,1),oi.white=new oi(1,1,1,1),oi.transparent=new oi(0,0,0,0),oi.red=new oi(1,0,0,1);var Es=function(h,p,m){this.sensitivity=h?p?"variant":"case":p?"accent":"base",this.locale=m,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Es.prototype.compare=function(h,p){return this.collator.compare(h,p)},Es.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var qh=function(h,p,m,E,T){this.text=h,this.image=p,this.scale=m,this.fontStack=E,this.textColor=T},eo=function(h){this.sections=h};eo.fromString=function(h){return new eo([new qh(h,null,null,null,null)])},eo.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(h){return h.text.length!==0||h.image&&h.image.name.length!==0})},eo.factory=function(h){return h instanceof eo?h:eo.fromString(h)},eo.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(h){return h.text}).join("")},eo.prototype.serialize=function(){for(var h=["format"],p=0,m=this.sections;p<m.length;p+=1){var E=m[p];if(E.image)h.push(["image",E.image.name]);else{h.push(E.text);var T={};E.fontStack&&(T["text-font"]=["literal",E.fontStack.split(",")]),E.scale&&(T["font-scale"]=E.scale),E.textColor&&(T["text-color"]=["rgba"].concat(E.textColor.toArray())),h.push(T)}}return h};var Da=function(h){this.name=h.name,this.available=h.available};function Kh(h,p,m,E){return typeof h=="number"&&h>=0&&h<=255&&typeof p=="number"&&p>=0&&p<=255&&typeof m=="number"&&m>=0&&m<=255?E===void 0||typeof E=="number"&&E>=0&&E<=1?null:"Invalid rgba value ["+[h,p,m,E].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof E=="number"?[h,p,m,E]:[h,p,m]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function mu(h){if(h===null||typeof h=="string"||typeof h=="boolean"||typeof h=="number"||h instanceof oi||h instanceof Es||h instanceof eo||h instanceof Da)return!0;if(Array.isArray(h)){for(var p=0,m=h;p<m.length;p+=1)if(!mu(m[p]))return!1;return!0}if(typeof h=="object"){for(var E in h)if(!mu(h[E]))return!1;return!0}return!1}function Ma(h){if(h===null)return Ur;if(typeof h=="string")return Ar;if(typeof h=="boolean")return dr;if(typeof h=="number")return Re;if(h instanceof oi)return gr;if(h instanceof Es)return ci;if(h instanceof eo)return ea;if(h instanceof Da)return ai;if(Array.isArray(h)){for(var p,m=h.length,E=0,T=h;E<T.length;E+=1){var I=Ma(T[E]);if(p){if(p===I)continue;p=wr;break}p=I}return wi(p||wr,m)}return kn}function uh(h){var p=typeof h;return h===null?"":p==="string"||p==="number"||p==="boolean"?String(h):h instanceof oi||h instanceof eo||h instanceof Da?h.toString():JSON.stringify(h)}Da.prototype.toString=function(){return this.name},Da.fromString=function(h){return h?new Da({name:h,available:!1}):null},Da.prototype.serialize=function(){return["image",this.name]};var Ho=function(h,p){this.type=h,this.value=p};Ho.parse=function(h,p){if(h.length!==2)return p.error("'literal' expression requires exactly one argument, but found "+(h.length-1)+" instead.");if(!mu(h[1]))return p.error("invalid value");var m=h[1],E=Ma(m),T=p.expectedType;return E.kind!=="array"||E.N!==0||!T||T.kind!=="array"||typeof T.N=="number"&&T.N!==0||(E=T),new Ho(E,m)},Ho.prototype.evaluate=function(){return this.value},Ho.prototype.eachChild=function(){},Ho.prototype.outputDefined=function(){return!0},Ho.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof oi?["rgba"].concat(this.value.toArray()):this.value instanceof eo?this.value.serialize():this.value};var Ra=function(h){this.name="ExpressionEvaluationError",this.message=h};Ra.prototype.toJSON=function(){return this.message};var ro={string:Ar,number:Re,boolean:dr,object:kn},ga=function(h,p){this.type=h,this.args=p};ga.parse=function(h,p){if(h.length<2)return p.error("Expected at least one argument.");var m,E=1,T=h[0];if(T==="array"){var I,P;if(h.length>2){var B=h[1];if(typeof B!="string"||!(B in ro)||B==="object")return p.error('The item type argument of "array" must be one of string, number, boolean',1);I=ro[B],E++}else I=wr;if(h.length>3){if(h[2]!==null&&(typeof h[2]!="number"||h[2]<0||h[2]!==Math.floor(h[2])))return p.error('The length argument to "array" must be a positive integer literal',2);P=h[2],E++}m=wi(I,P)}else m=ro[T];for(var H=[];E<h.length;E++){var G=p.parse(h[E],E,wr);if(!G)return null;H.push(G)}return new ga(m,H)},ga.prototype.evaluate=function(h){for(var p=0;p<this.args.length;p++){var m=this.args[p].evaluate(h);if(!pi(this.type,Ma(m)))return m;if(p===this.args.length-1)throw new Ra("Expected value to be of type "+zn(this.type)+", but found "+zn(Ma(m))+" instead.")}return null},ga.prototype.eachChild=function(h){this.args.forEach(h)},ga.prototype.outputDefined=function(){return this.args.every(function(h){return h.outputDefined()})},ga.prototype.serialize=function(){var h=this.type,p=[h.kind];if(h.kind==="array"){var m=h.itemType;if(m.kind==="string"||m.kind==="number"||m.kind==="boolean"){p.push(m.kind);var E=h.N;(typeof E=="number"||this.args.length>1)&&p.push(E)}}return p.concat(this.args.map(function(T){return T.serialize()}))};var Xs=function(h){this.type=ea,this.sections=h};Xs.parse=function(h,p){if(h.length<2)return p.error("Expected at least one argument.");var m=h[1];if(!Array.isArray(m)&&typeof m=="object")return p.error("First argument must be an image or text section.");for(var E=[],T=!1,I=1;I<=h.length-1;++I){var P=h[I];if(T&&typeof P=="object"&&!Array.isArray(P)){T=!1;var B=null;if(P["font-scale"]&&!(B=p.parse(P["font-scale"],1,Re)))return null;var H=null;if(P["text-font"]&&!(H=p.parse(P["text-font"],1,wi(Ar))))return null;var G=null;if(P["text-color"]&&!(G=p.parse(P["text-color"],1,gr)))return null;var Z=E[E.length-1];Z.scale=B,Z.font=H,Z.textColor=G}else{var K=p.parse(h[I],1,wr);if(!K)return null;var nt=K.type.kind;if(nt!=="string"&&nt!=="value"&&nt!=="null"&&nt!=="resolvedImage")return p.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");T=!0,E.push({content:K,scale:null,font:null,textColor:null})}}return new Xs(E)},Xs.prototype.evaluate=function(h){return new eo(this.sections.map(function(p){var m=p.content.evaluate(h);return Ma(m)===ai?new qh("",m,null,null,null):new qh(uh(m),null,p.scale?p.scale.evaluate(h):null,p.font?p.font.evaluate(h).join(","):null,p.textColor?p.textColor.evaluate(h):null)}))},Xs.prototype.eachChild=function(h){for(var p=0,m=this.sections;p<m.length;p+=1){var E=m[p];h(E.content),E.scale&&h(E.scale),E.font&&h(E.font),E.textColor&&h(E.textColor)}},Xs.prototype.outputDefined=function(){return!1},Xs.prototype.serialize=function(){for(var h=["format"],p=0,m=this.sections;p<m.length;p+=1){var E=m[p];h.push(E.content.serialize());var T={};E.scale&&(T["font-scale"]=E.scale.serialize()),E.font&&(T["text-font"]=E.font.serialize()),E.textColor&&(T["text-color"]=E.textColor.serialize()),h.push(T)}return h};var Ds=function(h){this.type=ai,this.input=h};Ds.parse=function(h,p){if(h.length!==2)return p.error("Expected two arguments.");var m=p.parse(h[1],1,Ar);return m?new Ds(m):p.error("No image name provided.")},Ds.prototype.evaluate=function(h){var p=this.input.evaluate(h),m=Da.fromString(p);return m&&h.availableImages&&(m.available=h.availableImages.indexOf(p)>-1),m},Ds.prototype.eachChild=function(h){h(this.input)},Ds.prototype.outputDefined=function(){return!1},Ds.prototype.serialize=function(){return["image",this.input.serialize()]};var uv={"to-boolean":dr,"to-color":gr,"to-number":Re,"to-string":Ar},Sl=function(h,p){this.type=h,this.args=p};Sl.parse=function(h,p){if(h.length<2)return p.error("Expected at least one argument.");var m=h[0];if((m==="to-boolean"||m==="to-string")&&h.length!==2)return p.error("Expected one argument.");for(var E=uv[m],T=[],I=1;I<h.length;I++){var P=p.parse(h[I],I,wr);if(!P)return null;T.push(P)}return new Sl(E,T)},Sl.prototype.evaluate=function(h){if(this.type.kind==="boolean")return!!this.args[0].evaluate(h);if(this.type.kind==="color"){for(var p,m,E=0,T=this.args;E<T.length;E+=1){if(m=null,(p=T[E].evaluate(h))instanceof oi)return p;if(typeof p=="string"){var I=h.parseColor(p);if(I)return I}else if(Array.isArray(p)&&!(m=p.length<3||p.length>4?"Invalid rbga value "+JSON.stringify(p)+": expected an array containing either three or four numeric values.":Kh(p[0],p[1],p[2],p[3])))return new oi(p[0]/255,p[1]/255,p[2]/255,p[3])}throw new Ra(m||"Could not parse color from value '"+(typeof p=="string"?p:String(JSON.stringify(p)))+"'")}if(this.type.kind==="number"){for(var P=null,B=0,H=this.args;B<H.length;B+=1){if((P=H[B].evaluate(h))===null)return 0;var G=Number(P);if(!isNaN(G))return G}throw new Ra("Could not convert "+JSON.stringify(P)+" to number.")}return this.type.kind==="formatted"?eo.fromString(uh(this.args[0].evaluate(h))):this.type.kind==="resolvedImage"?Da.fromString(uh(this.args[0].evaluate(h))):uh(this.args[0].evaluate(h))},Sl.prototype.eachChild=function(h){this.args.forEach(h)},Sl.prototype.outputDefined=function(){return this.args.every(function(h){return h.outputDefined()})},Sl.prototype.serialize=function(){if(this.type.kind==="formatted")return new Xs([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Ds(this.args[0]).serialize();var h=["to-"+this.type.kind];return this.eachChild(function(p){h.push(p.serialize())}),h};var C0=["Unknown","Point","LineString","Polygon"],ot=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};ot.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},ot.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?C0[this.feature.type]:this.feature.type:null},ot.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},ot.prototype.canonicalID=function(){return this.canonical},ot.prototype.properties=function(){return this.feature&&this.feature.properties||{}},ot.prototype.parseColor=function(h){var p=this._parseColorCache[h];return p||(p=this._parseColorCache[h]=oi.parse(h)),p};var vt=function(h,p,m,E){this.name=h,this.type=p,this._evaluate=m,this.args=E};vt.prototype.evaluate=function(h){return this._evaluate(h,this.args)},vt.prototype.eachChild=function(h){this.args.forEach(h)},vt.prototype.outputDefined=function(){return!1},vt.prototype.serialize=function(){return[this.name].concat(this.args.map(function(h){return h.serialize()}))},vt.parse=function(h,p){var m,E=h[0],T=vt.definitions[E];if(!T)return p.error('Unknown expression "'+E+'". If you wanted a literal array, use ["literal", [...]].',0);for(var I=Array.isArray(T)?T[0]:T.type,P=Array.isArray(T)?[[T[1],T[2]]]:T.overloads,B=P.filter(function(pn){var zr=pn[0];return!Array.isArray(zr)||zr.length===h.length-1}),H=null,G=0,Z=B;G<Z.length;G+=1){var K=Z[G],nt=K[0],lt=K[1];H=new ch(p.registry,p.path,null,p.scope);for(var St=[],Rt=!1,Gt=1;Gt<h.length;Gt++){var Nt=h[Gt],ne=Array.isArray(nt)?nt[Gt-1]:nt.type,le=H.parse(Nt,1+St.length,ne);if(!le){Rt=!0;break}St.push(le)}if(!Rt)if(Array.isArray(nt)&&nt.length!==St.length)H.error("Expected "+nt.length+" arguments, but found "+St.length+" instead.");else{for(var xe=0;xe<St.length;xe++){var we=Array.isArray(nt)?nt[xe]:nt.type,$e=St[xe];H.concat(xe+1).checkSubtype(we,$e.type)}if(H.errors.length===0)return new vt(E,I,lt,St)}}if(B.length===1)(m=p.errors).push.apply(m,H.errors);else{for(var sr=(B.length?B:P).map(function(pn){var zr;return zr=pn[0],Array.isArray(zr)?"("+zr.map(zn).join(", ")+")":"("+zn(zr.type)+"...)"}).join(" | "),yr=[],ln=1;ln<h.length;ln++){var Dr=p.parse(h[ln],1+yr.length);if(!Dr)return null;yr.push(zn(Dr.type))}p.error("Expected arguments of type "+sr+", but found ("+yr.join(", ")+") instead.")}return null},vt.register=function(h,p){for(var m in vt.definitions=p,p)h[m]=vt};var Vt=function(h,p,m){this.type=ci,this.locale=m,this.caseSensitive=h,this.diacriticSensitive=p};function me(h,p){h[0]=Math.min(h[0],p[0]),h[1]=Math.min(h[1],p[1]),h[2]=Math.max(h[2],p[0]),h[3]=Math.max(h[3],p[1])}function ur(h,p){return!(h[0]<=p[0]||h[2]>=p[2]||h[1]<=p[1]||h[3]>=p[3])}function rn(h,p){var m=(180+h[0])/360,E=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+h[1]*Math.PI/360)))/360,T=Math.pow(2,p.z);return[Math.round(m*T*8192),Math.round(E*T*8192)]}function Ri(h,p,m){return p[1]>h[1]!=m[1]>h[1]&&h[0]<(m[0]-p[0])*(h[1]-p[1])/(m[1]-p[1])+p[0]}function xo(h,p){for(var m,E,T,I,P,B,H,G=!1,Z=0,K=p.length;Z<K;Z++)for(var nt=p[Z],lt=0,St=nt.length;lt<St-1;lt++){if((I=(m=h)[0]-(E=nt[lt])[0])*(H=m[1]-(T=nt[lt+1])[1])-(B=m[0]-T[0])*(P=m[1]-E[1])==0&&I*B<=0&&P*H<=0)return!1;Ri(h,nt[lt],nt[lt+1])&&(G=!G)}return G}function cs(h,p){for(var m=0;m<p.length;m++)if(xo(h,p[m]))return!0;return!1}function Vo(h,p,m,E){var T=E[0]-m[0],I=E[1]-m[1],P=(h[0]-m[0])*I-T*(h[1]-m[1]),B=(p[0]-m[0])*I-T*(p[1]-m[1]);return P>0&&B<0||P<0&&B>0}function yu(h,p,m){for(var E=0,T=m;E<T.length;E+=1)for(var I=T[E],P=0;P<I.length-1;++P)if((K=[(Z=I[P+1])[0]-(G=I[P])[0],Z[1]-G[1]])[0]*(nt=[(H=p)[0]-(B=h)[0],H[1]-B[1]])[1]-K[1]*nt[0]!=0&&Vo(B,H,G,Z)&&Vo(G,Z,B,H))return!0;var B,H,G,Z,K,nt;return!1}function k_(h,p){for(var m=0;m<h.length;++m)if(!xo(h[m],p))return!1;for(var E=0;E<h.length-1;++E)if(yu(h[E],h[E+1],p))return!1;return!0}function z_(h,p){for(var m=0;m<p.length;m++)if(k_(h,p[m]))return!0;return!1}function tp(h,p,m){for(var E=[],T=0;T<h.length;T++){for(var I=[],P=0;P<h[T].length;P++){var B=rn(h[T][P],m);me(p,B),I.push(B)}E.push(I)}return E}function S0(h,p,m){for(var E=[],T=0;T<h.length;T++){var I=tp(h[T],p,m);E.push(I)}return E}function cv(h,p,m,E){if(h[0]<m[0]||h[0]>m[2]){var T=.5*E,I=h[0]-m[0]>T?-E:m[0]-h[0]>T?E:0;I===0&&(I=h[0]-m[2]>T?-E:m[2]-h[0]>T?E:0),h[0]+=I}me(p,h)}function U_(h,p,m,E){for(var T=8192*Math.pow(2,E.z),I=[8192*E.x,8192*E.y],P=[],B=0,H=h;B<H.length;B+=1)for(var G=0,Z=H[B];G<Z.length;G+=1){var K=Z[G],nt=[K.x+I[0],K.y+I[1]];cv(nt,p,m,T),P.push(nt)}return P}function Cg(h,p,m,E){for(var T,I=8192*Math.pow(2,E.z),P=[8192*E.x,8192*E.y],B=[],H=0,G=h;H<G.length;H+=1){for(var Z=[],K=0,nt=G[H];K<nt.length;K+=1){var lt=nt[K],St=[lt.x+P[0],lt.y+P[1]];me(p,St),Z.push(St)}B.push(Z)}if(p[2]-p[0]<=I/2){(T=p)[0]=T[1]=1/0,T[2]=T[3]=-1/0;for(var Rt=0,Gt=B;Rt<Gt.length;Rt+=1)for(var Nt=0,ne=Gt[Rt];Nt<ne.length;Nt+=1)cv(ne[Nt],p,m,I)}return B}Vt.parse=function(h,p){if(h.length!==2)return p.error("Expected one argument.");var m=h[1];if(typeof m!="object"||Array.isArray(m))return p.error("Collator options argument must be an object.");var E=p.parse(m["case-sensitive"]!==void 0&&m["case-sensitive"],1,dr);if(!E)return null;var T=p.parse(m["diacritic-sensitive"]!==void 0&&m["diacritic-sensitive"],1,dr);if(!T)return null;var I=null;return m.locale&&!(I=p.parse(m.locale,1,Ar))?null:new Vt(E,T,I)},Vt.prototype.evaluate=function(h){return new Es(this.caseSensitive.evaluate(h),this.diacriticSensitive.evaluate(h),this.locale?this.locale.evaluate(h):null)},Vt.prototype.eachChild=function(h){h(this.caseSensitive),h(this.diacriticSensitive),this.locale&&h(this.locale)},Vt.prototype.outputDefined=function(){return!1},Vt.prototype.serialize=function(){var h={};return h["case-sensitive"]=this.caseSensitive.serialize(),h["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(h.locale=this.locale.serialize()),["collator",h]};var ws=function(h,p){this.type=dr,this.geojson=h,this.geometries=p};function Qh(h){if(h instanceof vt&&(h.name==="get"&&h.args.length===1||h.name==="feature-state"||h.name==="has"&&h.args.length===1||h.name==="properties"||h.name==="geometry-type"||h.name==="id"||/^filter-/.test(h.name))||h instanceof ws)return!1;var p=!0;return h.eachChild(function(m){p&&!Qh(m)&&(p=!1)}),p}function Jh(h){if(h instanceof vt&&h.name==="feature-state")return!1;var p=!0;return h.eachChild(function(m){p&&!Jh(m)&&(p=!1)}),p}function vc(h,p){if(h instanceof vt&&p.indexOf(h.name)>=0)return!1;var m=!0;return h.eachChild(function(E){m&&!vc(E,p)&&(m=!1)}),m}ws.parse=function(h,p){if(h.length!==2)return p.error("'within' expression requires exactly one argument, but found "+(h.length-1)+" instead.");if(mu(h[1])){var m=h[1];if(m.type==="FeatureCollection")for(var E=0;E<m.features.length;++E){var T=m.features[E].geometry.type;if(T==="Polygon"||T==="MultiPolygon")return new ws(m,m.features[E].geometry)}else if(m.type==="Feature"){var I=m.geometry.type;if(I==="Polygon"||I==="MultiPolygon")return new ws(m,m.geometry)}else if(m.type==="Polygon"||m.type==="MultiPolygon")return new ws(m,m)}return p.error("'within' expression requires valid geojson object that contains polygon geometry type.")},ws.prototype.evaluate=function(h){if(h.geometry()!=null&&h.canonicalID()!=null){if(h.geometryType()==="Point")return function(p,m){var E=[1/0,1/0,-1/0,-1/0],T=[1/0,1/0,-1/0,-1/0],I=p.canonicalID();if(m.type==="Polygon"){var P=tp(m.coordinates,T,I),B=U_(p.geometry(),E,T,I);if(!ur(E,T))return!1;for(var H=0,G=B;H<G.length;H+=1)if(!xo(G[H],P))return!1}if(m.type==="MultiPolygon"){var Z=S0(m.coordinates,T,I),K=U_(p.geometry(),E,T,I);if(!ur(E,T))return!1;for(var nt=0,lt=K;nt<lt.length;nt+=1)if(!cs(lt[nt],Z))return!1}return!0}(h,this.geometries);if(h.geometryType()==="LineString")return function(p,m){var E=[1/0,1/0,-1/0,-1/0],T=[1/0,1/0,-1/0,-1/0],I=p.canonicalID();if(m.type==="Polygon"){var P=tp(m.coordinates,T,I),B=Cg(p.geometry(),E,T,I);if(!ur(E,T))return!1;for(var H=0,G=B;H<G.length;H+=1)if(!k_(G[H],P))return!1}if(m.type==="MultiPolygon"){var Z=S0(m.coordinates,T,I),K=Cg(p.geometry(),E,T,I);if(!ur(E,T))return!1;for(var nt=0,lt=K;nt<lt.length;nt+=1)if(!z_(lt[nt],Z))return!1}return!0}(h,this.geometries)}return!1},ws.prototype.eachChild=function(){},ws.prototype.outputDefined=function(){return!0},ws.prototype.serialize=function(){return["within",this.geojson]};var gc=function(h,p){this.type=p.type,this.name=h,this.boundExpression=p};gc.parse=function(h,p){if(h.length!==2||typeof h[1]!="string")return p.error("'var' expression requires exactly one string literal argument.");var m=h[1];return p.scope.has(m)?new gc(m,p.scope.get(m)):p.error('Unknown variable "'+m+'". Make sure "'+m+'" has been bound in an enclosing "let" expression before using it.',1)},gc.prototype.evaluate=function(h){return this.boundExpression.evaluate(h)},gc.prototype.eachChild=function(){},gc.prototype.outputDefined=function(){return!1},gc.prototype.serialize=function(){return["var",this.name]};var ch=function(h,p,m,E,T){p===void 0&&(p=[]),E===void 0&&(E=new jr),T===void 0&&(T=[]),this.registry=h,this.path=p,this.key=p.map(function(I){return"["+I+"]"}).join(""),this.scope=E,this.errors=T,this.expectedType=m};function hv(h,p){for(var m,E=h.length-1,T=0,I=E,P=0;T<=I;)if((m=h[P=Math.floor((T+I)/2)])<=p){if(P===E||p<h[P+1])return P;T=P+1}else{if(!(m>p))throw new Ra("Input is not a number.");I=P-1}return 0}ch.prototype.parse=function(h,p,m,E,T){return T===void 0&&(T={}),p?this.concat(p,m,E)._parse(h,T):this._parse(h,T)},ch.prototype._parse=function(h,p){function m(G,Z,K){return K==="assert"?new ga(Z,[G]):K==="coerce"?new Sl(Z,[G]):G}if(h!==null&&typeof h!="string"&&typeof h!="boolean"&&typeof h!="number"||(h=["literal",h]),Array.isArray(h)){if(h.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var E=h[0];if(typeof E!="string")return this.error("Expression name must be a string, but found "+typeof E+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var T=this.registry[E];if(T){var I=T.parse(h,this);if(!I)return null;if(this.expectedType){var P=this.expectedType,B=I.type;if(P.kind!=="string"&&P.kind!=="number"&&P.kind!=="boolean"&&P.kind!=="object"&&P.kind!=="array"||B.kind!=="value")if(P.kind!=="color"&&P.kind!=="formatted"&&P.kind!=="resolvedImage"||B.kind!=="value"&&B.kind!=="string"){if(this.checkSubtype(P,B))return null}else I=m(I,P,p.typeAnnotation||"coerce");else I=m(I,P,p.typeAnnotation||"assert")}if(!(I instanceof Ho)&&I.type.kind!=="resolvedImage"&&function G(Z){if(Z instanceof gc)return G(Z.boundExpression);if(Z instanceof vt&&Z.name==="error"||Z instanceof Vt||Z instanceof ws)return!1;var K=Z instanceof Sl||Z instanceof ga,nt=!0;return Z.eachChild(function(lt){nt=K?nt&&G(lt):nt&&lt instanceof Ho}),!!nt&&Qh(Z)&&vc(Z,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(I)){var H=new ot;try{I=new Ho(I.type,I.evaluate(H))}catch(G){return this.error(G.message),null}}return I}return this.error('Unknown expression "'+E+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(h===void 0?"'undefined' value invalid. Use null instead.":typeof h=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof h+" instead.")},ch.prototype.concat=function(h,p,m){var E=typeof h=="number"?this.path.concat(h):this.path,T=m?this.scope.concat(m):this.scope;return new ch(this.registry,E,p||null,T,this.errors)},ch.prototype.error=function(h){for(var p=[],m=arguments.length-1;m-- >0;)p[m]=arguments[m+1];var E=""+this.key+p.map(function(T){return"["+T+"]"}).join("");this.errors.push(new Ze(E,h))},ch.prototype.checkSubtype=function(h,p){var m=pi(h,p);return m&&this.error(m),m};var Tl=function(h,p,m){this.type=h,this.input=p,this.labels=[],this.outputs=[];for(var E=0,T=m;E<T.length;E+=1){var I=T[E],P=I[1];this.labels.push(I[0]),this.outputs.push(P)}};function no(h,p,m){return h*(1-m)+p*m}Tl.parse=function(h,p){if(h.length-1<4)return p.error("Expected at least 4 arguments, but found only "+(h.length-1)+".");if((h.length-1)%2!=0)return p.error("Expected an even number of arguments.");var m=p.parse(h[1],1,Re);if(!m)return null;var E=[],T=null;p.expectedType&&p.expectedType.kind!=="value"&&(T=p.expectedType);for(var I=1;I<h.length;I+=2){var P=I===1?-1/0:h[I],B=h[I+1],H=I,G=I+1;if(typeof P!="number")return p.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',H);if(E.length&&E[E.length-1][0]>=P)return p.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',H);var Z=p.parse(B,G,T);if(!Z)return null;T=T||Z.type,E.push([P,Z])}return new Tl(T,m,E)},Tl.prototype.evaluate=function(h){var p=this.labels,m=this.outputs;if(p.length===1)return m[0].evaluate(h);var E=this.input.evaluate(h);if(E<=p[0])return m[0].evaluate(h);var T=p.length;return E>=p[T-1]?m[T-1].evaluate(h):m[hv(p,E)].evaluate(h)},Tl.prototype.eachChild=function(h){h(this.input);for(var p=0,m=this.outputs;p<m.length;p+=1)h(m[p])},Tl.prototype.outputDefined=function(){return this.outputs.every(function(h){return h.outputDefined()})},Tl.prototype.serialize=function(){for(var h=["step",this.input.serialize()],p=0;p<this.labels.length;p++)p>0&&h.push(this.labels[p]),h.push(this.outputs[p].serialize());return h};var tf=Object.freeze({__proto__:null,number:no,color:function(h,p,m){return new oi(no(h.r,p.r,m),no(h.g,p.g,m),no(h.b,p.b,m),no(h.a,p.a,m))},array:function(h,p,m){return h.map(function(E,T){return no(E,p[T],m)})}}),hh=6/29*3*(6/29),Sg=Math.PI/180,$_=180/Math.PI;function Tg(h){return h>.008856451679035631?Math.pow(h,1/3):h/hh+4/29}function T0(h){return h>6/29?h*h*h:hh*(h-4/29)}function A0(h){return 255*(h<=.0031308?12.92*h:1.055*Math.pow(h,1/2.4)-.055)}function M0(h){return(h/=255)<=.04045?h/12.92:Math.pow((h+.055)/1.055,2.4)}function H_(h){var p=M0(h.r),m=M0(h.g),E=M0(h.b),T=Tg((.4124564*p+.3575761*m+.1804375*E)/.95047),I=Tg((.2126729*p+.7151522*m+.072175*E)/1);return{l:116*I-16,a:500*(T-I),b:200*(I-Tg((.0193339*p+.119192*m+.9503041*E)/1.08883)),alpha:h.a}}function V_(h){var p=(h.l+16)/116,m=isNaN(h.a)?p:p+h.a/500,E=isNaN(h.b)?p:p-h.b/200;return p=1*T0(p),m=.95047*T0(m),E=1.08883*T0(E),new oi(A0(3.2404542*m-1.5371385*p-.4985314*E),A0(-.969266*m+1.8760108*p+.041556*E),A0(.0556434*m-.2040259*p+1.0572252*E),h.alpha)}function Xb(h,p,m){var E=p-h;return h+m*(E>180||E<-180?E-360*Math.round(E/360):E)}var fv={forward:H_,reverse:V_,interpolate:function(h,p,m){return{l:no(h.l,p.l,m),a:no(h.a,p.a,m),b:no(h.b,p.b,m),alpha:no(h.alpha,p.alpha,m)}}},mc={forward:function(h){var p=H_(h),m=p.l,E=p.a,T=p.b,I=Math.atan2(T,E)*$_;return{h:I<0?I+360:I,c:Math.sqrt(E*E+T*T),l:m,alpha:h.a}},reverse:function(h){var p=h.h*Sg,m=h.c;return V_({l:h.l,a:Math.cos(p)*m,b:Math.sin(p)*m,alpha:h.alpha})},interpolate:function(h,p,m){return{h:Xb(h.h,p.h,m),c:no(h.c,p.c,m),l:no(h.l,p.l,m),alpha:no(h.alpha,p.alpha,m)}}},G_=Object.freeze({__proto__:null,lab:fv,hcl:mc}),Cs=function(h,p,m,E,T){this.type=h,this.operator=p,this.interpolation=m,this.input=E,this.labels=[],this.outputs=[];for(var I=0,P=T;I<P.length;I+=1){var B=P[I],H=B[1];this.labels.push(B[0]),this.outputs.push(H)}};function ad(h,p,m,E){var T=E-m,I=h-m;return T===0?0:p===1?I/T:(Math.pow(p,I)-1)/(Math.pow(p,T)-1)}Cs.interpolationFactor=function(h,p,m,E){var T=0;if(h.name==="exponential")T=ad(p,h.base,m,E);else if(h.name==="linear")T=ad(p,1,m,E);else if(h.name==="cubic-bezier"){var I=h.controlPoints;T=new l(I[0],I[1],I[2],I[3]).solve(ad(p,1,m,E))}return T},Cs.parse=function(h,p){var m=h[0],E=h[1],T=h[2],I=h.slice(3);if(!Array.isArray(E)||E.length===0)return p.error("Expected an interpolation type expression.",1);if(E[0]==="linear")E={name:"linear"};else if(E[0]==="exponential"){var P=E[1];if(typeof P!="number")return p.error("Exponential interpolation requires a numeric base.",1,1);E={name:"exponential",base:P}}else{if(E[0]!=="cubic-bezier")return p.error("Unknown interpolation type "+String(E[0]),1,0);var B=E.slice(1);if(B.length!==4||B.some(function(Gt){return typeof Gt!="number"||Gt<0||Gt>1}))return p.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);E={name:"cubic-bezier",controlPoints:B}}if(h.length-1<4)return p.error("Expected at least 4 arguments, but found only "+(h.length-1)+".");if((h.length-1)%2!=0)return p.error("Expected an even number of arguments.");if(!(T=p.parse(T,2,Re)))return null;var H=[],G=null;m==="interpolate-hcl"||m==="interpolate-lab"?G=gr:p.expectedType&&p.expectedType.kind!=="value"&&(G=p.expectedType);for(var Z=0;Z<I.length;Z+=2){var K=I[Z],nt=I[Z+1],lt=Z+3,St=Z+4;if(typeof K!="number")return p.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',lt);if(H.length&&H[H.length-1][0]>=K)return p.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',lt);var Rt=p.parse(nt,St,G);if(!Rt)return null;G=G||Rt.type,H.push([K,Rt])}return G.kind==="number"||G.kind==="color"||G.kind==="array"&&G.itemType.kind==="number"&&typeof G.N=="number"?new Cs(G,m,E,T,H):p.error("Type "+zn(G)+" is not interpolatable.")},Cs.prototype.evaluate=function(h){var p=this.labels,m=this.outputs;if(p.length===1)return m[0].evaluate(h);var E=this.input.evaluate(h);if(E<=p[0])return m[0].evaluate(h);var T=p.length;if(E>=p[T-1])return m[T-1].evaluate(h);var I=hv(p,E),P=Cs.interpolationFactor(this.interpolation,E,p[I],p[I+1]),B=m[I].evaluate(h),H=m[I+1].evaluate(h);return this.operator==="interpolate"?tf[this.type.kind.toLowerCase()](B,H,P):this.operator==="interpolate-hcl"?mc.reverse(mc.interpolate(mc.forward(B),mc.forward(H),P)):fv.reverse(fv.interpolate(fv.forward(B),fv.forward(H),P))},Cs.prototype.eachChild=function(h){h(this.input);for(var p=0,m=this.outputs;p<m.length;p+=1)h(m[p])},Cs.prototype.outputDefined=function(){return this.outputs.every(function(h){return h.outputDefined()})},Cs.prototype.serialize=function(){var h;h=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var p=[this.operator,h,this.input.serialize()],m=0;m<this.labels.length;m++)p.push(this.labels[m],this.outputs[m].serialize());return p};var ef=function(h,p){this.type=h,this.args=p};ef.parse=function(h,p){if(h.length<2)return p.error("Expectected at least one argument.");var m=null,E=p.expectedType;E&&E.kind!=="value"&&(m=E);for(var T=[],I=0,P=h.slice(1);I<P.length;I+=1){var B=p.parse(P[I],1+T.length,m,void 0,{typeAnnotation:"omit"});if(!B)return null;m=m||B.type,T.push(B)}var H=E&&T.some(function(G){return pi(E,G.type)});return new ef(H?wr:m,T)},ef.prototype.evaluate=function(h){for(var p,m=null,E=0,T=0,I=this.args;T<I.length&&(E++,(m=I[T].evaluate(h))&&m instanceof Da&&!m.available&&(p||(p=m.name),m=null,E===this.args.length&&(m=p)),m===null);T+=1);return m},ef.prototype.eachChild=function(h){this.args.forEach(h)},ef.prototype.outputDefined=function(){return this.args.every(function(h){return h.outputDefined()})},ef.prototype.serialize=function(){var h=["coalesce"];return this.eachChild(function(p){h.push(p.serialize())}),h};var Zl=function(h,p){this.type=p.type,this.bindings=[].concat(h),this.result=p};Zl.prototype.evaluate=function(h){return this.result.evaluate(h)},Zl.prototype.eachChild=function(h){for(var p=0,m=this.bindings;p<m.length;p+=1)h(m[p][1]);h(this.result)},Zl.parse=function(h,p){if(h.length<4)return p.error("Expected at least 3 arguments, but found "+(h.length-1)+" instead.");for(var m=[],E=1;E<h.length-1;E+=2){var T=h[E];if(typeof T!="string")return p.error("Expected string, but found "+typeof T+" instead.",E);if(/[^a-zA-Z0-9_]/.test(T))return p.error("Variable names must contain only alphanumeric characters or '_'.",E);var I=p.parse(h[E+1],E+1);if(!I)return null;m.push([T,I])}var P=p.parse(h[h.length-1],h.length-1,p.expectedType,m);return P?new Zl(m,P):null},Zl.prototype.outputDefined=function(){return this.result.outputDefined()},Zl.prototype.serialize=function(){for(var h=["let"],p=0,m=this.bindings;p<m.length;p+=1){var E=m[p];h.push(E[0],E[1].serialize())}return h.push(this.result.serialize()),h};var rf=function(h,p,m){this.type=h,this.index=p,this.input=m};rf.parse=function(h,p){if(h.length!==3)return p.error("Expected 2 arguments, but found "+(h.length-1)+" instead.");var m=p.parse(h[1],1,Re),E=p.parse(h[2],2,wi(p.expectedType||wr));return m&&E?new rf(E.type.itemType,m,E):null},rf.prototype.evaluate=function(h){var p=this.index.evaluate(h),m=this.input.evaluate(h);if(p<0)throw new Ra("Array index out of bounds: "+p+" < 0.");if(p>=m.length)throw new Ra("Array index out of bounds: "+p+" > "+(m.length-1)+".");if(p!==Math.floor(p))throw new Ra("Array index must be an integer, but found "+p+" instead.");return m[p]},rf.prototype.eachChild=function(h){h(this.index),h(this.input)},rf.prototype.outputDefined=function(){return!1},rf.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var _u=function(h,p){this.type=dr,this.needle=h,this.haystack=p};_u.parse=function(h,p){if(h.length!==3)return p.error("Expected 2 arguments, but found "+(h.length-1)+" instead.");var m=p.parse(h[1],1,wr),E=p.parse(h[2],2,wr);return m&&E?ra(m.type,[dr,Ar,Re,Ur,wr])?new _u(m,E):p.error("Expected first argument to be of type boolean, string, number or null, but found "+zn(m.type)+" instead"):null},_u.prototype.evaluate=function(h){var p=this.needle.evaluate(h),m=this.haystack.evaluate(h);if(!m)return!1;if(!Di(p,["boolean","string","number","null"]))throw new Ra("Expected first argument to be of type boolean, string, number or null, but found "+zn(Ma(p))+" instead.");if(!Di(m,["string","array"]))throw new Ra("Expected second argument to be of type array or string, but found "+zn(Ma(m))+" instead.");return m.indexOf(p)>=0},_u.prototype.eachChild=function(h){h(this.needle),h(this.haystack)},_u.prototype.outputDefined=function(){return!0},_u.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var fh=function(h,p,m){this.type=Re,this.needle=h,this.haystack=p,this.fromIndex=m};fh.parse=function(h,p){if(h.length<=2||h.length>=5)return p.error("Expected 3 or 4 arguments, but found "+(h.length-1)+" instead.");var m=p.parse(h[1],1,wr),E=p.parse(h[2],2,wr);if(!m||!E)return null;if(!ra(m.type,[dr,Ar,Re,Ur,wr]))return p.error("Expected first argument to be of type boolean, string, number or null, but found "+zn(m.type)+" instead");if(h.length===4){var T=p.parse(h[3],3,Re);return T?new fh(m,E,T):null}return new fh(m,E)},fh.prototype.evaluate=function(h){var p=this.needle.evaluate(h),m=this.haystack.evaluate(h);if(!Di(p,["boolean","string","number","null"]))throw new Ra("Expected first argument to be of type boolean, string, number or null, but found "+zn(Ma(p))+" instead.");if(!Di(m,["string","array"]))throw new Ra("Expected second argument to be of type array or string, but found "+zn(Ma(m))+" instead.");if(this.fromIndex){var E=this.fromIndex.evaluate(h);return m.indexOf(p,E)}return m.indexOf(p)},fh.prototype.eachChild=function(h){h(this.needle),h(this.haystack),this.fromIndex&&h(this.fromIndex)},fh.prototype.outputDefined=function(){return!1},fh.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var h=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),h]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var ql=function(h,p,m,E,T,I){this.inputType=h,this.type=p,this.input=m,this.cases=E,this.outputs=T,this.otherwise=I};ql.parse=function(h,p){if(h.length<5)return p.error("Expected at least 4 arguments, but found only "+(h.length-1)+".");if(h.length%2!=1)return p.error("Expected an even number of arguments.");var m,E;p.expectedType&&p.expectedType.kind!=="value"&&(E=p.expectedType);for(var T={},I=[],P=2;P<h.length-1;P+=2){var B=h[P],H=h[P+1];Array.isArray(B)||(B=[B]);var G=p.concat(P);if(B.length===0)return G.error("Expected at least one branch label.");for(var Z=0,K=B;Z<K.length;Z+=1){var nt=K[Z];if(typeof nt!="number"&&typeof nt!="string")return G.error("Branch labels must be numbers or strings.");if(typeof nt=="number"&&Math.abs(nt)>Number.MAX_SAFE_INTEGER)return G.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof nt=="number"&&Math.floor(nt)!==nt)return G.error("Numeric branch labels must be integer values.");if(m){if(G.checkSubtype(m,Ma(nt)))return null}else m=Ma(nt);if(T[String(nt)]!==void 0)return G.error("Branch labels must be unique.");T[String(nt)]=I.length}var lt=p.parse(H,P,E);if(!lt)return null;E=E||lt.type,I.push(lt)}var St=p.parse(h[1],1,wr);if(!St)return null;var Rt=p.parse(h[h.length-1],h.length-1,E);return Rt?St.type.kind!=="value"&&p.concat(1).checkSubtype(m,St.type)?null:new ql(m,E,St,T,I,Rt):null},ql.prototype.evaluate=function(h){var p=this.input.evaluate(h);return(Ma(p)===this.inputType&&this.outputs[this.cases[p]]||this.otherwise).evaluate(h)},ql.prototype.eachChild=function(h){h(this.input),this.outputs.forEach(h),h(this.otherwise)},ql.prototype.outputDefined=function(){return this.outputs.every(function(h){return h.outputDefined()})&&this.otherwise.outputDefined()},ql.prototype.serialize=function(){for(var h=this,p=["match",this.input.serialize()],m=[],E={},T=0,I=Object.keys(this.cases).sort();T<I.length;T+=1){var P=I[T];(K=E[this.cases[P]])===void 0?(E[this.cases[P]]=m.length,m.push([this.cases[P],[P]])):m[K][1].push(P)}for(var B=function(lt){return h.inputType.kind==="number"?Number(lt):lt},H=0,G=m;H<G.length;H+=1){var Z=G[H],K=Z[0],nt=Z[1];p.push(nt.length===1?B(nt[0]):nt.map(B)),p.push(this.outputs[outputIndex$1].serialize())}return p.push(this.otherwise.serialize()),p};var dh=function(h,p,m){this.type=h,this.branches=p,this.otherwise=m};dh.parse=function(h,p){if(h.length<4)return p.error("Expected at least 3 arguments, but found only "+(h.length-1)+".");if(h.length%2!=0)return p.error("Expected an odd number of arguments.");var m;p.expectedType&&p.expectedType.kind!=="value"&&(m=p.expectedType);for(var E=[],T=1;T<h.length-1;T+=2){var I=p.parse(h[T],T,dr);if(!I)return null;var P=p.parse(h[T+1],T+1,m);if(!P)return null;E.push([I,P]),m=m||P.type}var B=p.parse(h[h.length-1],h.length-1,m);return B?new dh(m,E,B):null},dh.prototype.evaluate=function(h){for(var p=0,m=this.branches;p<m.length;p+=1){var E=m[p],T=E[1];if(E[0].evaluate(h))return T.evaluate(h)}return this.otherwise.evaluate(h)},dh.prototype.eachChild=function(h){for(var p=0,m=this.branches;p<m.length;p+=1){var E=m[p],T=E[1];h(E[0]),h(T)}h(this.otherwise)},dh.prototype.outputDefined=function(){return this.branches.every(function(h){return h[1].outputDefined()})&&this.otherwise.outputDefined()},dh.prototype.serialize=function(){var h=["case"];return this.eachChild(function(p){h.push(p.serialize())}),h};var nf=function(h,p,m,E){this.type=h,this.input=p,this.beginIndex=m,this.endIndex=E};function W_(h,p){return h==="=="||h==="!="?p.kind==="boolean"||p.kind==="string"||p.kind==="number"||p.kind==="null"||p.kind==="value":p.kind==="string"||p.kind==="number"||p.kind==="value"}function X_(h,p,m,E){return E.compare(p,m)===0}function sa(h,p,m){var E=h!=="=="&&h!=="!=";return function(){function T(I,P,B){this.type=dr,this.lhs=I,this.rhs=P,this.collator=B,this.hasUntypedArgument=I.type.kind==="value"||P.type.kind==="value"}return T.parse=function(I,P){if(I.length!==3&&I.length!==4)return P.error("Expected two or three arguments.");var B=I[0],H=P.parse(I[1],1,wr);if(!H)return null;if(!W_(B,H.type))return P.concat(1).error('"'+B+`" comparisons are not supported for type '`+zn(H.type)+"'.");var G=P.parse(I[2],2,wr);if(!G)return null;if(!W_(B,G.type))return P.concat(2).error('"'+B+`" comparisons are not supported for type '`+zn(G.type)+"'.");if(H.type.kind!==G.type.kind&&H.type.kind!=="value"&&G.type.kind!=="value")return P.error("Cannot compare types '"+zn(H.type)+"' and '"+zn(G.type)+"'.");E&&(H.type.kind==="value"&&G.type.kind!=="value"?H=new ga(G.type,[H]):H.type.kind!=="value"&&G.type.kind==="value"&&(G=new ga(H.type,[G])));var Z=null;if(I.length===4){if(H.type.kind!=="string"&&G.type.kind!=="string"&&H.type.kind!=="value"&&G.type.kind!=="value")return P.error("Cannot use collator to compare non-string types.");if(!(Z=P.parse(I[3],3,ci)))return null}return new T(H,G,Z)},T.prototype.evaluate=function(I){var P=this.lhs.evaluate(I),B=this.rhs.evaluate(I);if(E&&this.hasUntypedArgument){var H=Ma(P),G=Ma(B);if(H.kind!==G.kind||H.kind!=="string"&&H.kind!=="number")throw new Ra('Expected arguments for "'+h+'" to be (string, string) or (number, number), but found ('+H.kind+", "+G.kind+") instead.")}if(this.collator&&!E&&this.hasUntypedArgument){var Z=Ma(P),K=Ma(B);if(Z.kind!=="string"||K.kind!=="string")return p(I,P,B)}return this.collator?m(I,P,B,this.collator.evaluate(I)):p(I,P,B)},T.prototype.eachChild=function(I){I(this.lhs),I(this.rhs),this.collator&&I(this.collator)},T.prototype.outputDefined=function(){return!0},T.prototype.serialize=function(){var I=[h];return this.eachChild(function(P){I.push(P.serialize())}),I},T}()}nf.parse=function(h,p){if(h.length<=2||h.length>=5)return p.error("Expected 3 or 4 arguments, but found "+(h.length-1)+" instead.");var m=p.parse(h[1],1,wr),E=p.parse(h[2],2,Re);if(!m||!E)return null;if(!ra(m.type,[wi(wr),Ar,wr]))return p.error("Expected first argument to be of type array or string, but found "+zn(m.type)+" instead");if(h.length===4){var T=p.parse(h[3],3,Re);return T?new nf(m.type,m,E,T):null}return new nf(m.type,m,E)},nf.prototype.evaluate=function(h){var p=this.input.evaluate(h),m=this.beginIndex.evaluate(h);if(!Di(p,["string","array"]))throw new Ra("Expected first argument to be of type array or string, but found "+zn(Ma(p))+" instead.");if(this.endIndex){var E=this.endIndex.evaluate(h);return p.slice(m,E)}return p.slice(m)},nf.prototype.eachChild=function(h){h(this.input),h(this.beginIndex),this.endIndex&&h(this.endIndex)},nf.prototype.outputDefined=function(){return!1},nf.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var h=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),h]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var jb=sa("==",function(h,p,m){return p===m},X_),Ag=sa("!=",function(h,p,m){return p!==m},function(h,p,m,E){return!X_(0,p,m,E)}),R0=sa("<",function(h,p,m){return p<m},function(h,p,m,E){return E.compare(p,m)<0}),io=sa(">",function(h,p,m){return p>m},function(h,p,m,E){return E.compare(p,m)>0}),I0=sa("<=",function(h,p,m){return p<=m},function(h,p,m,E){return E.compare(p,m)<=0}),j_=sa(">=",function(h,p,m){return p>=m},function(h,p,m,E){return E.compare(p,m)>=0}),al=function(h,p,m,E,T){this.type=Ar,this.number=h,this.locale=p,this.currency=m,this.minFractionDigits=E,this.maxFractionDigits=T};al.parse=function(h,p){if(h.length!==3)return p.error("Expected two arguments.");var m=p.parse(h[1],1,Re);if(!m)return null;var E=h[2];if(typeof E!="object"||Array.isArray(E))return p.error("NumberFormat options argument must be an object.");var T=null;if(E.locale&&!(T=p.parse(E.locale,1,Ar)))return null;var I=null;if(E.currency&&!(I=p.parse(E.currency,1,Ar)))return null;var P=null;if(E["min-fraction-digits"]&&!(P=p.parse(E["min-fraction-digits"],1,Re)))return null;var B=null;return E["max-fraction-digits"]&&!(B=p.parse(E["max-fraction-digits"],1,Re))?null:new al(m,T,I,P,B)},al.prototype.evaluate=function(h){return new Intl.NumberFormat(this.locale?this.locale.evaluate(h):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(h):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(h):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(h):void 0}).format(this.number.evaluate(h))},al.prototype.eachChild=function(h){h(this.number),this.locale&&h(this.locale),this.currency&&h(this.currency),this.minFractionDigits&&h(this.minFractionDigits),this.maxFractionDigits&&h(this.maxFractionDigits)},al.prototype.outputDefined=function(){return!1},al.prototype.serialize=function(){var h={};return this.locale&&(h.locale=this.locale.serialize()),this.currency&&(h.currency=this.currency.serialize()),this.minFractionDigits&&(h["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(h["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),h]};var ph=function(h){this.type=Re,this.input=h};ph.parse=function(h,p){if(h.length!==2)return p.error("Expected 1 argument, but found "+(h.length-1)+" instead.");var m=p.parse(h[1],1);return m?m.type.kind!=="array"&&m.type.kind!=="string"&&m.type.kind!=="value"?p.error("Expected argument of type string or array, but found "+zn(m.type)+" instead."):new ph(m):null},ph.prototype.evaluate=function(h){var p=this.input.evaluate(h);if(typeof p=="string"||Array.isArray(p))return p.length;throw new Ra("Expected value to be of type string or array, but found "+zn(Ma(p))+" instead.")},ph.prototype.eachChild=function(h){h(this.input)},ph.prototype.outputDefined=function(){return!1},ph.prototype.serialize=function(){var h=["length"];return this.eachChild(function(p){h.push(p.serialize())}),h};var yc={"==":jb,"!=":Ag,">":io,"<":R0,">=":j_,"<=":I0,array:ga,at:rf,boolean:ga,case:dh,coalesce:ef,collator:Vt,format:Xs,image:Ds,in:_u,"index-of":fh,interpolate:Cs,"interpolate-hcl":Cs,"interpolate-lab":Cs,length:ph,let:Zl,literal:Ho,match:ql,number:ga,"number-format":al,object:ga,slice:nf,step:Tl,string:ga,"to-boolean":Sl,"to-color":Sl,"to-number":Sl,"to-string":Sl,var:gc,within:ws};function af(h,p){var m=p[0],E=p[1],T=p[2],I=p[3];m=m.evaluate(h),E=E.evaluate(h),T=T.evaluate(h);var P=I?I.evaluate(h):1,B=Kh(m,E,T,P);if(B)throw new Ra(B);return new oi(m/255*P,E/255*P,T/255*P,P)}function Mg(h,p){return h in p}function ep(h,p){var m=p[h];return m===void 0?null:m}function Wu(h){return{type:h}}function dv(h){return{result:"success",value:h}}function of(h){return{result:"error",value:h}}function vh(h){return h["property-type"]==="data-driven"||h["property-type"]==="cross-faded-data-driven"}function L0(h){return!!h.expression&&h.expression.parameters.indexOf("zoom")>-1}function pv(h){return!!h.expression&&h.expression.interpolated}function ba(h){return h instanceof Number?"number":h instanceof String?"string":h instanceof Boolean?"boolean":Array.isArray(h)?"array":h===null?"null":typeof h}function Rg(h){return typeof h=="object"&&h!==null&&!Array.isArray(h)}function Yb(h){return h}function sf(h,p,m){return h!==void 0?h:p!==void 0?p:m!==void 0?m:void 0}function vv(h,p,m,E,T){return sf(typeof m===T?E[m]:void 0,h.default,p.default)}function O0(h,p,m){if(ba(m)!=="number")return sf(h.default,p.default);var E=h.stops.length;if(E===1||m<=h.stops[0][0])return h.stops[0][1];if(m>=h.stops[E-1][0])return h.stops[E-1][1];var T=hv(h.stops.map(function(I){return I[0]}),m);return h.stops[T][1]}function Ig(h,p,m){var E=h.base!==void 0?h.base:1;if(ba(m)!=="number")return sf(h.default,p.default);var T=h.stops.length;if(T===1||m<=h.stops[0][0])return h.stops[0][1];if(m>=h.stops[T-1][0])return h.stops[T-1][1];var I=hv(h.stops.map(function(K){return K[0]}),m),P=function(K,nt,lt,St){var Rt=St-lt,Gt=K-lt;return Rt===0?0:nt===1?Gt/Rt:(Math.pow(nt,Gt)-1)/(Math.pow(nt,Rt)-1)}(m,E,h.stops[I][0],h.stops[I+1][0]),B=h.stops[I][1],H=h.stops[I+1][1],G=tf[p.type]||Yb;if(h.colorSpace&&h.colorSpace!=="rgb"){var Z=G_[h.colorSpace];G=function(K,nt){return Z.reverse(Z.interpolate(Z.forward(K),Z.forward(nt),P))}}return typeof B.evaluate=="function"?{evaluate:function(){for(var K=[],nt=arguments.length;nt--;)K[nt]=arguments[nt];var lt=B.evaluate.apply(void 0,K),St=H.evaluate.apply(void 0,K);if(lt!==void 0&&St!==void 0)return G(lt,St,P)}}:G(B,H,P)}function gh(h,p,m){return p.type==="color"?m=oi.parse(m):p.type==="formatted"?m=eo.fromString(m.toString()):p.type==="resolvedImage"?m=Da.fromString(m.toString()):ba(m)===p.type||p.type==="enum"&&p.values[m]||(m=void 0),sf(m,h.default,p.default)}vt.register(yc,{error:[{kind:"error"},[Ar],function(h,p){throw new Ra(p[0].evaluate(h))}],typeof:[Ar,[wr],function(h,p){return zn(Ma(p[0].evaluate(h)))}],"to-rgba":[wi(Re,4),[gr],function(h,p){return p[0].evaluate(h).toArray()}],rgb:[gr,[Re,Re,Re],af],rgba:[gr,[Re,Re,Re,Re],af],has:{type:dr,overloads:[[[Ar],function(h,p){return Mg(p[0].evaluate(h),h.properties())}],[[Ar,kn],function(h,p){var m=p[1];return Mg(p[0].evaluate(h),m.evaluate(h))}]]},get:{type:wr,overloads:[[[Ar],function(h,p){return ep(p[0].evaluate(h),h.properties())}],[[Ar,kn],function(h,p){var m=p[1];return ep(p[0].evaluate(h),m.evaluate(h))}]]},"feature-state":[wr,[Ar],function(h,p){return ep(p[0].evaluate(h),h.featureState||{})}],properties:[kn,[],function(h){return h.properties()}],"geometry-type":[Ar,[],function(h){return h.geometryType()}],id:[wr,[],function(h){return h.id()}],zoom:[Re,[],function(h){return h.globals.zoom}],"heatmap-density":[Re,[],function(h){return h.globals.heatmapDensity||0}],"line-progress":[Re,[],function(h){return h.globals.lineProgress||0}],accumulated:[wr,[],function(h){return h.globals.accumulated===void 0?null:h.globals.accumulated}],"+":[Re,Wu(Re),function(h,p){for(var m=0,E=0,T=p;E<T.length;E+=1)m+=T[E].evaluate(h);return m}],"*":[Re,Wu(Re),function(h,p){for(var m=1,E=0,T=p;E<T.length;E+=1)m*=T[E].evaluate(h);return m}],"-":{type:Re,overloads:[[[Re,Re],function(h,p){var m=p[1];return p[0].evaluate(h)-m.evaluate(h)}],[[Re],function(h,p){return-p[0].evaluate(h)}]]},"/":[Re,[Re,Re],function(h,p){var m=p[1];return p[0].evaluate(h)/m.evaluate(h)}],"%":[Re,[Re,Re],function(h,p){var m=p[1];return p[0].evaluate(h)%m.evaluate(h)}],ln2:[Re,[],function(){return Math.LN2}],pi:[Re,[],function(){return Math.PI}],e:[Re,[],function(){return Math.E}],"^":[Re,[Re,Re],function(h,p){var m=p[1];return Math.pow(p[0].evaluate(h),m.evaluate(h))}],sqrt:[Re,[Re],function(h,p){return Math.sqrt(p[0].evaluate(h))}],log10:[Re,[Re],function(h,p){return Math.log(p[0].evaluate(h))/Math.LN10}],ln:[Re,[Re],function(h,p){return Math.log(p[0].evaluate(h))}],log2:[Re,[Re],function(h,p){return Math.log(p[0].evaluate(h))/Math.LN2}],sin:[Re,[Re],function(h,p){return Math.sin(p[0].evaluate(h))}],cos:[Re,[Re],function(h,p){return Math.cos(p[0].evaluate(h))}],tan:[Re,[Re],function(h,p){return Math.tan(p[0].evaluate(h))}],asin:[Re,[Re],function(h,p){return Math.asin(p[0].evaluate(h))}],acos:[Re,[Re],function(h,p){return Math.acos(p[0].evaluate(h))}],atan:[Re,[Re],function(h,p){return Math.atan(p[0].evaluate(h))}],min:[Re,Wu(Re),function(h,p){return Math.min.apply(Math,p.map(function(m){return m.evaluate(h)}))}],max:[Re,Wu(Re),function(h,p){return Math.max.apply(Math,p.map(function(m){return m.evaluate(h)}))}],abs:[Re,[Re],function(h,p){return Math.abs(p[0].evaluate(h))}],round:[Re,[Re],function(h,p){var m=p[0].evaluate(h);return m<0?-Math.round(-m):Math.round(m)}],floor:[Re,[Re],function(h,p){return Math.floor(p[0].evaluate(h))}],ceil:[Re,[Re],function(h,p){return Math.ceil(p[0].evaluate(h))}],"filter-==":[dr,[Ar,wr],function(h,p){var m=p[0],E=p[1];return h.properties()[m.value]===E.value}],"filter-id-==":[dr,[wr],function(h,p){var m=p[0];return h.id()===m.value}],"filter-type-==":[dr,[Ar],function(h,p){var m=p[0];return h.geometryType()===m.value}],"filter-<":[dr,[Ar,wr],function(h,p){var m=p[0],E=p[1],T=h.properties()[m.value],I=E.value;return typeof T==typeof I&&T<I}],"filter-id-<":[dr,[wr],function(h,p){var m=p[0],E=h.id(),T=m.value;return typeof E==typeof T&&E<T}],"filter->":[dr,[Ar,wr],function(h,p){var m=p[0],E=p[1],T=h.properties()[m.value],I=E.value;return typeof T==typeof I&&T>I}],"filter-id->":[dr,[wr],function(h,p){var m=p[0],E=h.id(),T=m.value;return typeof E==typeof T&&E>T}],"filter-<=":[dr,[Ar,wr],function(h,p){var m=p[0],E=p[1],T=h.properties()[m.value],I=E.value;return typeof T==typeof I&&T<=I}],"filter-id-<=":[dr,[wr],function(h,p){var m=p[0],E=h.id(),T=m.value;return typeof E==typeof T&&E<=T}],"filter->=":[dr,[Ar,wr],function(h,p){var m=p[0],E=p[1],T=h.properties()[m.value],I=E.value;return typeof T==typeof I&&T>=I}],"filter-id->=":[dr,[wr],function(h,p){var m=p[0],E=h.id(),T=m.value;return typeof E==typeof T&&E>=T}],"filter-has":[dr,[wr],function(h,p){return p[0].value in h.properties()}],"filter-has-id":[dr,[],function(h){return h.id()!==null&&h.id()!==void 0}],"filter-type-in":[dr,[wi(Ar)],function(h,p){return p[0].value.indexOf(h.geometryType())>=0}],"filter-id-in":[dr,[wi(wr)],function(h,p){return p[0].value.indexOf(h.id())>=0}],"filter-in-small":[dr,[Ar,wi(wr)],function(h,p){var m=p[0];return p[1].value.indexOf(h.properties()[m.value])>=0}],"filter-in-large":[dr,[Ar,wi(wr)],function(h,p){var m=p[0],E=p[1];return function(T,I,P,B){for(;P<=B;){var H=P+B>>1;if(I[H]===T)return!0;I[H]>T?B=H-1:P=H+1}return!1}(h.properties()[m.value],E.value,0,E.value.length-1)}],all:{type:dr,overloads:[[[dr,dr],function(h,p){var m=p[1];return p[0].evaluate(h)&&m.evaluate(h)}],[Wu(dr),function(h,p){for(var m=0,E=p;m<E.length;m+=1)if(!E[m].evaluate(h))return!1;return!0}]]},any:{type:dr,overloads:[[[dr,dr],function(h,p){var m=p[1];return p[0].evaluate(h)||m.evaluate(h)}],[Wu(dr),function(h,p){for(var m=0,E=p;m<E.length;m+=1)if(E[m].evaluate(h))return!0;return!1}]]},"!":[dr,[dr],function(h,p){return!p[0].evaluate(h)}],"is-supported-script":[dr,[Ar],function(h,p){var m=h.globals&&h.globals.isSupportedScript;return!m||m(p[0].evaluate(h))}],upcase:[Ar,[Ar],function(h,p){return p[0].evaluate(h).toUpperCase()}],downcase:[Ar,[Ar],function(h,p){return p[0].evaluate(h).toLowerCase()}],concat:[Ar,Wu(wr),function(h,p){return p.map(function(m){return uh(m.evaluate(h))}).join("")}],"resolved-locale":[Ar,[ci],function(h,p){return p[0].evaluate(h).resolvedLocale()}]});var lf=function(h,p){this.expression=h,this._warningHistory={},this._evaluator=new ot,this._defaultValue=p?function(m){return m.type==="color"&&Rg(m.default)?new oi(0,0,0,0):m.type==="color"?oi.parse(m.default)||null:m.default===void 0?null:m.default}(p):null,this._enumValues=p&&p.type==="enum"?p.values:null};function od(h){return Array.isArray(h)&&h.length>0&&typeof h[0]=="string"&&h[0]in yc}function rp(h,p){var m=new ch(yc,[],p?function(T){var I={color:gr,string:Ar,number:Re,enum:Ar,boolean:dr,formatted:ea,resolvedImage:ai};return T.type==="array"?wi(I[T.value]||wr,T.length):I[T.type]}(p):void 0),E=m.parse(h,void 0,void 0,void 0,p&&p.type==="string"?{typeAnnotation:"coerce"}:void 0);return E?dv(new lf(E,p)):of(m.errors)}lf.prototype.evaluateWithoutErrorHandling=function(h,p,m,E,T,I){return this._evaluator.globals=h,this._evaluator.feature=p,this._evaluator.featureState=m,this._evaluator.canonical=E,this._evaluator.availableImages=T||null,this._evaluator.formattedSection=I,this.expression.evaluate(this._evaluator)},lf.prototype.evaluate=function(h,p,m,E,T,I){this._evaluator.globals=h,this._evaluator.feature=p||null,this._evaluator.featureState=m||null,this._evaluator.canonical=E,this._evaluator.availableImages=T||null,this._evaluator.formattedSection=I||null;try{var P=this.expression.evaluate(this._evaluator);if(P==null||typeof P=="number"&&P!=P)return this._defaultValue;if(this._enumValues&&!(P in this._enumValues))throw new Ra("Expected value to be one of "+Object.keys(this._enumValues).map(function(B){return JSON.stringify(B)}).join(", ")+", but found "+JSON.stringify(P)+" instead.");return P}catch(B){return this._warningHistory[B.message]||(this._warningHistory[B.message]=!0,typeof console<"u"&&console.warn(B.message)),this._defaultValue}};var sd=function(h,p){this.kind=h,this._styleExpression=p,this.isStateDependent=h!=="constant"&&!Jh(p.expression)};sd.prototype.evaluateWithoutErrorHandling=function(h,p,m,E,T,I){return this._styleExpression.evaluateWithoutErrorHandling(h,p,m,E,T,I)},sd.prototype.evaluate=function(h,p,m,E,T,I){return this._styleExpression.evaluate(h,p,m,E,T,I)};var ld=function(h,p,m,E){this.kind=h,this.zoomStops=m,this._styleExpression=p,this.isStateDependent=h!=="camera"&&!Jh(p.expression),this.interpolationType=E};function P0(h,p){if((h=rp(h,p)).result==="error")return h;var m=h.value.expression,E=Qh(m);if(!E&&!vh(p))return of([new Ze("","data expressions not supported")]);var T=vc(m,["zoom"]);if(!T&&!L0(p))return of([new Ze("","zoom expressions not supported")]);var I=function P(B){var H=null;if(B instanceof Zl)H=P(B.result);else if(B instanceof ef)for(var G=0,Z=B.args;G<Z.length&&!(H=P(Z[G]));G+=1);else(B instanceof Tl||B instanceof Cs)&&B.input instanceof vt&&B.input.name==="zoom"&&(H=B);return H instanceof Ze||B.eachChild(function(K){var nt=P(K);nt instanceof Ze?H=nt:!H&&nt?H=new Ze("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):H&&nt&&H!==nt&&(H=new Ze("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),H}(m);return I||T?I instanceof Ze?of([I]):I instanceof Cs&&!pv(p)?of([new Ze("",'"interpolate" expressions cannot be used with this property')]):dv(I?new ld(E?"camera":"composite",h.value,I.labels,I instanceof Cs?I.interpolation:void 0):new sd(E?"constant":"source",h.value)):of([new Ze("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}ld.prototype.evaluateWithoutErrorHandling=function(h,p,m,E,T,I){return this._styleExpression.evaluateWithoutErrorHandling(h,p,m,E,T,I)},ld.prototype.evaluate=function(h,p,m,E,T,I){return this._styleExpression.evaluate(h,p,m,E,T,I)},ld.prototype.interpolationFactor=function(h,p,m){return this.interpolationType?Cs.interpolationFactor(this.interpolationType,h,p,m):0};var ud=function(h,p){this._parameters=h,this._specification=p,Le(this,function m(E,T){var I,P,B,H=T.type==="color",G=E.stops&&typeof E.stops[0][0]=="object",Z=G||!(G||E.property!==void 0),K=E.type||(pv(T)?"exponential":"interval");if(H&&((E=Le({},E)).stops&&(E.stops=E.stops.map(function(Dr){return[Dr[0],oi.parse(Dr[1])]})),E.default=oi.parse(E.default?E.default:T.default)),E.colorSpace&&E.colorSpace!=="rgb"&&!G_[E.colorSpace])throw new Error("Unknown color space: "+E.colorSpace);if(K==="exponential")I=Ig;else if(K==="interval")I=O0;else if(K==="categorical"){I=vv,P=Object.create(null);for(var nt=0,lt=E.stops;nt<lt.length;nt+=1){var St=lt[nt];P[St[0]]=St[1]}B=typeof E.stops[0][0]}else{if(K!=="identity")throw new Error('Unknown function type "'+K+'"');I=gh}if(G){for(var Rt={},Gt=[],Nt=0;Nt<E.stops.length;Nt++){var ne=E.stops[Nt],le=ne[0].zoom;Rt[le]===void 0&&(Rt[le]={zoom:le,type:E.type,property:E.property,default:E.default,stops:[]},Gt.push(le)),Rt[le].stops.push([ne[0].value,ne[1]])}for(var xe=[],we=0,$e=Gt;we<$e.length;we+=1){var sr=$e[we];xe.push([Rt[sr].zoom,m(Rt[sr],T)])}var yr={name:"linear"};return{kind:"composite",interpolationType:yr,interpolationFactor:Cs.interpolationFactor.bind(void 0,yr),zoomStops:xe.map(function(Dr){return Dr[0]}),evaluate:function(Dr,pn){var zr=Dr.zoom;return Ig({stops:xe,base:E.base},T,zr).evaluate(zr,pn)}}}if(Z){var ln=K==="exponential"?{name:"exponential",base:E.base!==void 0?E.base:1}:null;return{kind:"camera",interpolationType:ln,interpolationFactor:Cs.interpolationFactor.bind(void 0,ln),zoomStops:E.stops.map(function(Dr){return Dr[0]}),evaluate:function(Dr){return I(E,T,Dr.zoom,P,B)}}}return{kind:"source",evaluate:function(Dr,pn){var zr=pn&&pn.properties?pn.properties[E.property]:void 0;return zr===void 0?sf(E.default,T.default):I(E,T,zr,P,B)}}}(this._parameters,this._specification))};function xu(h){var p=h.key,m=h.value,E=h.valueSpec||{},T=h.objectElementValidators||{},I=h.style,P=h.styleSpec,B=[],H=ba(m);if(H!=="object")return[new Pt(p,m,"object expected, "+H+" found")];for(var G in m){var Z=G.split(".")[0],K=E[Z]||E["*"],nt=void 0;if(T[Z])nt=T[Z];else if(E[Z])nt=Ci;else if(T["*"])nt=T["*"];else{if(!E["*"]){B.push(new Pt(p,m[G],'unknown property "'+G+'"'));continue}nt=Ci}B=B.concat(nt({key:(p&&p+".")+G,value:m[G],valueSpec:K,style:I,styleSpec:P,object:m,objectKey:G},m))}for(var lt in E)T[lt]||E[lt].required&&E[lt].default===void 0&&m[lt]===void 0&&B.push(new Pt(p,m,'missing required property "'+lt+'"'));return B}function D0(h){var p=h.value,m=h.valueSpec,E=h.style,T=h.styleSpec,I=h.key,P=h.arrayElementValidator||Ci;if(ba(p)!=="array")return[new Pt(I,p,"array expected, "+ba(p)+" found")];if(m.length&&p.length!==m.length)return[new Pt(I,p,"array length "+m.length+" expected, length "+p.length+" found")];if(m["min-length"]&&p.length<m["min-length"])return[new Pt(I,p,"array length at least "+m["min-length"]+" expected, length "+p.length+" found")];var B={type:m.value,values:m.values};T.$version<7&&(B.function=m.function),ba(m.value)==="object"&&(B=m.value);for(var H=[],G=0;G<p.length;G++)H=H.concat(P({array:p,arrayIndex:G,value:p[G],valueSpec:B,style:E,styleSpec:T,key:I+"["+G+"]"}));return H}function F0(h){var p=h.key,m=h.value,E=h.valueSpec,T=ba(m);return T==="number"&&m!=m&&(T="NaN"),T!=="number"?[new Pt(p,m,"number expected, "+T+" found")]:"minimum"in E&&m<E.minimum?[new Pt(p,m,m+" is less than the minimum value "+E.minimum)]:"maximum"in E&&m>E.maximum?[new Pt(p,m,m+" is greater than the maximum value "+E.maximum)]:[]}function B0(h){var p,m,E,T=h.valueSpec,I=tr(h.value.type),P={},B=I!=="categorical"&&h.value.property===void 0,H=!B,G=ba(h.value.stops)==="array"&&ba(h.value.stops[0])==="array"&&ba(h.value.stops[0][0])==="object",Z=xu({key:h.key,value:h.value,valueSpec:h.styleSpec.function,style:h.style,styleSpec:h.styleSpec,objectElementValidators:{stops:function(lt){if(I==="identity")return[new Pt(lt.key,lt.value,'identity function may not have a "stops" property')];var St=[],Rt=lt.value;return St=St.concat(D0({key:lt.key,value:Rt,valueSpec:lt.valueSpec,style:lt.style,styleSpec:lt.styleSpec,arrayElementValidator:K})),ba(Rt)==="array"&&Rt.length===0&&St.push(new Pt(lt.key,Rt,"array must have at least one stop")),St},default:function(lt){return Ci({key:lt.key,value:lt.value,valueSpec:T,style:lt.style,styleSpec:lt.styleSpec})}}});return I==="identity"&&B&&Z.push(new Pt(h.key,h.value,'missing required property "property"')),I==="identity"||h.value.stops||Z.push(new Pt(h.key,h.value,'missing required property "stops"')),I==="exponential"&&h.valueSpec.expression&&!pv(h.valueSpec)&&Z.push(new Pt(h.key,h.value,"exponential functions not supported")),h.styleSpec.$version>=8&&(H&&!vh(h.valueSpec)?Z.push(new Pt(h.key,h.value,"property functions not supported")):B&&!L0(h.valueSpec)&&Z.push(new Pt(h.key,h.value,"zoom functions not supported"))),I!=="categorical"&&!G||h.value.property!==void 0||Z.push(new Pt(h.key,h.value,'"property" property is required')),Z;function K(lt){var St=[],Rt=lt.value,Gt=lt.key;if(ba(Rt)!=="array")return[new Pt(Gt,Rt,"array expected, "+ba(Rt)+" found")];if(Rt.length!==2)return[new Pt(Gt,Rt,"array length 2 expected, length "+Rt.length+" found")];if(G){if(ba(Rt[0])!=="object")return[new Pt(Gt,Rt,"object expected, "+ba(Rt[0])+" found")];if(Rt[0].zoom===void 0)return[new Pt(Gt,Rt,"object stop key must have zoom")];if(Rt[0].value===void 0)return[new Pt(Gt,Rt,"object stop key must have value")];if(E&&E>tr(Rt[0].zoom))return[new Pt(Gt,Rt[0].zoom,"stop zoom values must appear in ascending order")];tr(Rt[0].zoom)!==E&&(E=tr(Rt[0].zoom),m=void 0,P={}),St=St.concat(xu({key:Gt+"[0]",value:Rt[0],valueSpec:{zoom:{}},style:lt.style,styleSpec:lt.styleSpec,objectElementValidators:{zoom:F0,value:nt}}))}else St=St.concat(nt({key:Gt+"[0]",value:Rt[0],valueSpec:{},style:lt.style,styleSpec:lt.styleSpec},Rt));return od(Te(Rt[1]))?St.concat([new Pt(Gt+"[1]",Rt[1],"expressions are not allowed in function stops.")]):St.concat(Ci({key:Gt+"[1]",value:Rt[1],valueSpec:T,style:lt.style,styleSpec:lt.styleSpec}))}function nt(lt,St){var Rt=ba(lt.value),Gt=tr(lt.value),Nt=lt.value!==null?lt.value:St;if(p){if(Rt!==p)return[new Pt(lt.key,Nt,Rt+" stop domain type must match previous stop domain type "+p)]}else p=Rt;if(Rt!=="number"&&Rt!=="string"&&Rt!=="boolean")return[new Pt(lt.key,Nt,"stop domain value must be a number, string, or boolean")];if(Rt!=="number"&&I!=="categorical"){var ne="number expected, "+Rt+" found";return vh(T)&&I===void 0&&(ne+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Pt(lt.key,Nt,ne)]}return I!=="categorical"||Rt!=="number"||isFinite(Gt)&&Math.floor(Gt)===Gt?I!=="categorical"&&Rt==="number"&&m!==void 0&&Gt<m?[new Pt(lt.key,Nt,"stop domain values must appear in ascending order")]:(m=Gt,I==="categorical"&&Gt in P?[new Pt(lt.key,Nt,"stop domain values must be unique")]:(P[Gt]=!0,[])):[new Pt(lt.key,Nt,"integer expected, found "+Gt)]}}function uf(h){var p=(h.expressionContext==="property"?P0:rp)(Te(h.value),h.valueSpec);if(p.result==="error")return p.value.map(function(E){return new Pt(""+h.key+E.key,h.value,E.message)});var m=p.value.expression||p.value._styleExpression.expression;if(h.expressionContext==="property"&&h.propertyKey==="text-font"&&!m.outputDefined())return[new Pt(h.key,h.value,'Invalid data expression for "'+h.propertyKey+'". Output values must be contained as literals within the expression.')];if(h.expressionContext==="property"&&h.propertyType==="layout"&&!Jh(m))return[new Pt(h.key,h.value,'"feature-state" data expressions are not supported with layout properties.')];if(h.expressionContext==="filter"&&!Jh(m))return[new Pt(h.key,h.value,'"feature-state" data expressions are not supported with filters.')];if(h.expressionContext&&h.expressionContext.indexOf("cluster")===0){if(!vc(m,["zoom","feature-state"]))return[new Pt(h.key,h.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(h.expressionContext==="cluster-initial"&&!Qh(m))return[new Pt(h.key,h.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function _c(h){var p=h.key,m=h.value,E=h.valueSpec,T=[];return Array.isArray(E.values)?E.values.indexOf(tr(m))===-1&&T.push(new Pt(p,m,"expected one of ["+E.values.join(", ")+"], "+JSON.stringify(m)+" found")):Object.keys(E.values).indexOf(tr(m))===-1&&T.push(new Pt(p,m,"expected one of ["+Object.keys(E.values).join(", ")+"], "+JSON.stringify(m)+" found")),T}function np(h){if(h===!0||h===!1)return!0;if(!Array.isArray(h)||h.length===0)return!1;switch(h[0]){case"has":return h.length>=2&&h[1]!=="$id"&&h[1]!=="$type";case"in":return h.length>=3&&(typeof h[1]!="string"||Array.isArray(h[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return h.length!==3||Array.isArray(h[1])||Array.isArray(h[2]);case"any":case"all":for(var p=0,m=h.slice(1);p<m.length;p+=1){var E=m[p];if(!np(E)&&typeof E!="boolean")return!1}return!0;default:return!0}}ud.deserialize=function(h){return new ud(h._parameters,h._specification)},ud.serialize=function(h){return{_parameters:h._parameters,_specification:h._specification}};var gv={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function cf(h){if(h==null)return{filter:function(){return!0},needGeometry:!1};np(h)||(h=Lg(h));var p=rp(h,gv);if(p.result==="error")throw new Error(p.value.map(function(m){return m.key+": "+m.message}).join(", "));return{filter:function(m,E,T){return p.value.evaluate(m,E,{},T)},needGeometry:function m(E){if(!Array.isArray(E))return!1;if(E[0]==="within")return!0;for(var T=1;T<E.length;T++)if(m(E[T]))return!0;return!1}(h)}}function Zb(h,p){return h<p?-1:h>p?1:0}function Lg(h){if(!h)return!0;var p,m=h[0];return h.length<=1?m!=="any":m==="=="?N0(h[1],h[2],"=="):m==="!="?Pg(N0(h[1],h[2],"==")):m==="<"||m===">"||m==="<="||m===">="?N0(h[1],h[2],m):m==="any"?(p=h.slice(1),["any"].concat(p.map(Lg))):m==="all"?["all"].concat(h.slice(1).map(Lg)):m==="none"?["all"].concat(h.slice(1).map(Lg).map(Pg)):m==="in"?Og(h[1],h.slice(2)):m==="!in"?Pg(Og(h[1],h.slice(2))):m==="has"?Y_(h[1]):m==="!has"?Pg(Y_(h[1])):m!=="within"||h}function N0(h,p,m){switch(h){case"$type":return["filter-type-"+m,p];case"$id":return["filter-id-"+m,p];default:return["filter-"+m,h,p]}}function Og(h,p){if(p.length===0)return!1;switch(h){case"$type":return["filter-type-in",["literal",p]];case"$id":return["filter-id-in",["literal",p]];default:return p.length>200&&!p.some(function(m){return typeof m!=typeof p[0]})?["filter-in-large",h,["literal",p.sort(Zb)]]:["filter-in-small",h,["literal",p]]}}function Y_(h){switch(h){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",h]}}function Pg(h){return["!",h]}function k0(h){return np(Te(h.value))?uf(Le({},h,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function p(m){var E=m.value,T=m.key;if(ba(E)!=="array")return[new Pt(T,E,"array expected, "+ba(E)+" found")];var I,P=m.styleSpec,B=[];if(E.length<1)return[new Pt(T,E,"filter array must have at least 1 element")];switch(B=B.concat(_c({key:T+"[0]",value:E[0],valueSpec:P.filter_operator,style:m.style,styleSpec:m.styleSpec})),tr(E[0])){case"<":case"<=":case">":case">=":E.length>=2&&tr(E[1])==="$type"&&B.push(new Pt(T,E,'"$type" cannot be use with operator "'+E[0]+'"'));case"==":case"!=":E.length!==3&&B.push(new Pt(T,E,'filter array for operator "'+E[0]+'" must have 3 elements'));case"in":case"!in":E.length>=2&&(I=ba(E[1]))!=="string"&&B.push(new Pt(T+"[1]",E[1],"string expected, "+I+" found"));for(var H=2;H<E.length;H++)I=ba(E[H]),tr(E[1])==="$type"?B=B.concat(_c({key:T+"["+H+"]",value:E[H],valueSpec:P.geometry_type,style:m.style,styleSpec:m.styleSpec})):I!=="string"&&I!=="number"&&I!=="boolean"&&B.push(new Pt(T+"["+H+"]",E[H],"string, number, or boolean expected, "+I+" found"));break;case"any":case"all":case"none":for(var G=1;G<E.length;G++)B=B.concat(p({key:T+"["+G+"]",value:E[G],style:m.style,styleSpec:m.styleSpec}));break;case"has":case"!has":I=ba(E[1]),E.length!==2?B.push(new Pt(T,E,'filter array for "'+E[0]+'" operator must have 2 elements')):I!=="string"&&B.push(new Pt(T+"[1]",E[1],"string expected, "+I+" found"));break;case"within":I=ba(E[1]),E.length!==2?B.push(new Pt(T,E,'filter array for "'+E[0]+'" operator must have 2 elements')):I!=="object"&&B.push(new Pt(T+"[1]",E[1],"object expected, "+I+" found"))}return B}(h)}function mv(h,p){var m=h.key,E=h.style,T=h.styleSpec,I=h.value,P=h.objectKey,B=T[p+"_"+h.layerType];if(!B)return[];var H=P.match(/^(.*)-transition$/);if(p==="paint"&&H&&B[H[1]]&&B[H[1]].transition)return Ci({key:m,value:I,valueSpec:T.transition,style:E,styleSpec:T});var G,Z=h.valueSpec||B[P];if(!Z)return[new Pt(m,I,'unknown property "'+P+'"')];if(ba(I)==="string"&&vh(Z)&&!Z.tokens&&(G=/^{([^}]+)}$/.exec(I)))return[new Pt(m,I,'"'+P+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(G[1])+" }`.")];var K=[];return h.layerType==="symbol"&&(P==="text-field"&&E&&!E.glyphs&&K.push(new Pt(m,I,'use of "text-field" requires a style "glyphs" property')),P==="text-font"&&Rg(Te(I))&&tr(I.type)==="identity"&&K.push(new Pt(m,I,'"text-font" does not support identity functions'))),K.concat(Ci({key:h.key,value:I,valueSpec:Z,style:E,styleSpec:T,expressionContext:"property",propertyType:p,propertyKey:P}))}function z0(h){return mv(h,"paint")}function cd(h){return mv(h,"layout")}function U0(h){var p=[],m=h.value,E=h.key,T=h.style,I=h.styleSpec;m.type||m.ref||p.push(new Pt(E,m,'either "type" or "ref" is required'));var P,B=tr(m.type),H=tr(m.ref);if(m.id)for(var G=tr(m.id),Z=0;Z<h.arrayIndex;Z++){var K=T.layers[Z];tr(K.id)===G&&p.push(new Pt(E,m.id,'duplicate layer id "'+m.id+'", previously used at line '+K.id.__line__))}if("ref"in m)["type","source","source-layer","filter","layout"].forEach(function(St){St in m&&p.push(new Pt(E,m[St],'"'+St+'" is prohibited for ref layers'))}),T.layers.forEach(function(St){tr(St.id)===H&&(P=St)}),P?P.ref?p.push(new Pt(E,m.ref,"ref cannot reference another ref layer")):B=tr(P.type):p.push(new Pt(E,m.ref,'ref layer "'+H+'" not found'));else if(B!=="background")if(m.source){var nt=T.sources&&T.sources[m.source],lt=nt&&tr(nt.type);nt?lt==="vector"&&B==="raster"?p.push(new Pt(E,m.source,'layer "'+m.id+'" requires a raster source')):lt==="raster"&&B!=="raster"?p.push(new Pt(E,m.source,'layer "'+m.id+'" requires a vector source')):lt!=="vector"||m["source-layer"]?lt==="raster-dem"&&B!=="hillshade"?p.push(new Pt(E,m.source,"raster-dem source can only be used with layer type 'hillshade'.")):B!=="line"||!m.paint||!m.paint["line-gradient"]||lt==="geojson"&&nt.lineMetrics||p.push(new Pt(E,m,'layer "'+m.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):p.push(new Pt(E,m,'layer "'+m.id+'" must specify a "source-layer"')):p.push(new Pt(E,m.source,'source "'+m.source+'" not found'))}else p.push(new Pt(E,m,'missing required property "source"'));return p=p.concat(xu({key:E,value:m,valueSpec:I.layer,style:h.style,styleSpec:h.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Ci({key:E+".type",value:m.type,valueSpec:I.layer.type,style:h.style,styleSpec:h.styleSpec,object:m,objectKey:"type"})},filter:k0,layout:function(St){return xu({layer:m,key:St.key,value:St.value,style:St.style,styleSpec:St.styleSpec,objectElementValidators:{"*":function(Rt){return cd(Le({layerType:B},Rt))}}})},paint:function(St){return xu({layer:m,key:St.key,value:St.value,style:St.style,styleSpec:St.styleSpec,objectElementValidators:{"*":function(Rt){return z0(Le({layerType:B},Rt))}}})}}}))}function hf(h){var p=h.value,m=h.key,E=ba(p);return E!=="string"?[new Pt(m,p,"string expected, "+E+" found")]:[]}var Ea={promoteId:function(h){var p=h.key,m=h.value;if(ba(m)==="string")return hf({key:p,value:m});var E=[];for(var T in m)E.push.apply(E,hf({key:p+"."+T,value:m[T]}));return E}};function Dg(h){var p=h.value,m=h.key,E=h.styleSpec,T=h.style;if(!p.type)return[new Pt(m,p,'"type" is required')];var I,P=tr(p.type);switch(P){case"vector":case"raster":case"raster-dem":return xu({key:m,value:p,valueSpec:E["source_"+P.replace("-","_")],style:h.style,styleSpec:E,objectElementValidators:Ea});case"geojson":if(I=xu({key:m,value:p,valueSpec:E.source_geojson,style:T,styleSpec:E,objectElementValidators:Ea}),p.cluster)for(var B in p.clusterProperties){var H=p.clusterProperties[B],G=H[0],Z=typeof G=="string"?[G,["accumulated"],["get",B]]:G;I.push.apply(I,uf({key:m+"."+B+".map",value:H[1],expressionContext:"cluster-map"})),I.push.apply(I,uf({key:m+"."+B+".reduce",value:Z,expressionContext:"cluster-reduce"}))}return I;case"video":return xu({key:m,value:p,valueSpec:E.source_video,style:T,styleSpec:E});case"image":return xu({key:m,value:p,valueSpec:E.source_image,style:T,styleSpec:E});case"canvas":return[new Pt(m,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return _c({key:m+".type",value:p.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:T,styleSpec:E})}}function xc(h){var p=h.value,m=h.styleSpec,E=m.light,T=h.style,I=[],P=ba(p);if(p===void 0)return I;if(P!=="object")return I.concat([new Pt("light",p,"object expected, "+P+" found")]);for(var B in p){var H=B.match(/^(.*)-transition$/);I=I.concat(H&&E[H[1]]&&E[H[1]].transition?Ci({key:B,value:p[B],valueSpec:m.transition,style:T,styleSpec:m}):E[B]?Ci({key:B,value:p[B],valueSpec:E[B],style:T,styleSpec:m}):[new Pt(B,p[B],'unknown property "'+B+'"')])}return I}var ff={"*":function(){return[]},array:D0,boolean:function(h){var p=h.value,m=h.key,E=ba(p);return E!=="boolean"?[new Pt(m,p,"boolean expected, "+E+" found")]:[]},number:F0,color:function(h){var p=h.key,m=h.value,E=ba(m);return E!=="string"?[new Pt(p,m,"color expected, "+E+" found")]:Un(m)===null?[new Pt(p,m,'color expected, "'+m+'" found')]:[]},constants:oe,enum:_c,filter:k0,function:B0,layer:U0,object:xu,source:Dg,light:xc,string:hf,formatted:function(h){return hf(h).length===0?[]:uf(h)},resolvedImage:function(h){return hf(h).length===0?[]:uf(h)}};function Ci(h){var p=h.value,m=h.valueSpec,E=h.styleSpec;return m.expression&&Rg(tr(p))?B0(h):m.expression&&od(Te(p))?uf(h):m.type&&ff[m.type]?ff[m.type](h):xu(Le({},h,{valueSpec:m.type?E[m.type]:m}))}function wa(h){var p=h.value,m=h.key,E=hf(h);return E.length||(p.indexOf("{fontstack}")===-1&&E.push(new Pt(m,p,'"glyphs" url must include a "{fontstack}" token')),p.indexOf("{range}")===-1&&E.push(new Pt(m,p,'"glyphs" url must include a "{range}" token'))),E}function Kl(h,p){p===void 0&&(p=ct);var m=[];return m=m.concat(Ci({key:"",value:h,valueSpec:p.$root,styleSpec:p,style:h,objectElementValidators:{glyphs:wa,"*":function(){return[]}}})),h.constants&&(m=m.concat(oe({key:"constants",value:h.constants,style:h,styleSpec:p}))),yv(m)}function yv(h){return[].concat(h).sort(function(p,m){return p.line-m.line})}function ip(h){return function(){for(var p=[],m=arguments.length;m--;)p[m]=arguments[m];return yv(h.apply(this,p))}}Kl.source=ip(Dg),Kl.light=ip(xc),Kl.layer=ip(U0),Kl.filter=ip(k0),Kl.paintProperty=ip(z0),Kl.layoutProperty=ip(cd);var _v=Kl,Z_=_v.light,Fg=_v.paintProperty,xv=_v.layoutProperty;function df(h,p){var m=!1;if(p&&p.length)for(var E=0,T=p;E<T.length;E+=1)h.fire(new Xt(new Error(T[E].message))),m=!0;return m}var Go=Ha;function Ha(h,p,m){var E=this.cells=[];if(h instanceof ArrayBuffer){this.arrayBuffer=h;var T=new Int32Array(this.arrayBuffer);h=T[0],this.d=(p=T[1])+2*(m=T[2]);for(var I=0;I<this.d*this.d;I++){var P=T[3+I],B=T[3+I+1];E.push(P===B?null:T.subarray(P,B))}var H=T[3+E.length+1];this.keys=T.subarray(T[3+E.length],H),this.bboxes=T.subarray(H),this.insert=this._insertReadonly}else{this.d=p+2*m;for(var G=0;G<this.d*this.d;G++)E.push([]);this.keys=[],this.bboxes=[]}this.n=p,this.extent=h,this.padding=m,this.scale=p/h,this.uid=0;var Z=m/p*h;this.min=-Z,this.max=h+Z}Ha.prototype.insert=function(h,p,m,E,T){this._forEachCell(p,m,E,T,this._insertCell,this.uid++),this.keys.push(h),this.bboxes.push(p),this.bboxes.push(m),this.bboxes.push(E),this.bboxes.push(T)},Ha.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Ha.prototype._insertCell=function(h,p,m,E,T,I){this.cells[T].push(I)},Ha.prototype.query=function(h,p,m,E,T){var I=this.min,P=this.max;if(h<=I&&p<=I&&P<=m&&P<=E&&!T)return Array.prototype.slice.call(this.keys);var B=[];return this._forEachCell(h,p,m,E,this._queryCell,B,{},T),B},Ha.prototype._queryCell=function(h,p,m,E,T,I,P,B){var H=this.cells[T];if(H!==null)for(var G=this.keys,Z=this.bboxes,K=0;K<H.length;K++){var nt=H[K];if(P[nt]===void 0){var lt=4*nt;(B?B(Z[lt+0],Z[lt+1],Z[lt+2],Z[lt+3]):h<=Z[lt+2]&&p<=Z[lt+3]&&m>=Z[lt+0]&&E>=Z[lt+1])?(P[nt]=!0,I.push(G[nt])):P[nt]=!1}}},Ha.prototype._forEachCell=function(h,p,m,E,T,I,P,B){for(var H=this._convertToCellCoord(h),G=this._convertToCellCoord(p),Z=this._convertToCellCoord(m),K=this._convertToCellCoord(E),nt=H;nt<=Z;nt++)for(var lt=G;lt<=K;lt++){var St=this.d*lt+nt;if((!B||B(this._convertFromCellCoord(nt),this._convertFromCellCoord(lt),this._convertFromCellCoord(nt+1),this._convertFromCellCoord(lt+1)))&&T.call(this,h,p,m,E,St,I,P,B))return}},Ha.prototype._convertFromCellCoord=function(h){return(h-this.padding)/this.scale},Ha.prototype._convertToCellCoord=function(h){return Math.max(0,Math.min(this.d-1,Math.floor(h*this.scale)+this.padding))},Ha.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var h=this.cells,p=3+this.cells.length+1+1,m=0,E=0;E<this.cells.length;E++)m+=this.cells[E].length;var T=new Int32Array(p+m+this.keys.length+this.bboxes.length);T[0]=this.extent,T[1]=this.n,T[2]=this.padding;for(var I=p,P=0;P<h.length;P++){var B=h[P];T[3+P]=I,T.set(B,I),I+=B.length}return T[3+h.length]=I,T.set(this.keys,I),T[3+h.length+1]=I+=this.keys.length,T.set(this.bboxes,I),I+=this.bboxes.length,T.buffer};var ap=d.ImageData,$0=d.ImageBitmap,vo={};function Wr(h,p,m){m===void 0&&(m={}),Object.defineProperty(p,"_classRegistryKey",{value:h,writeable:!1}),vo[h]={klass:p,omit:m.omit||[],shallow:m.shallow||[]}}for(var ol in Wr("Object",Object),Go.serialize=function(h,p){var m=h.toArrayBuffer();return p&&p.push(m),{buffer:m}},Go.deserialize=function(h){return new Go(h.buffer)},Wr("Grid",Go),Wr("Color",oi),Wr("Error",Error),Wr("ResolvedImage",Da),Wr("StylePropertyFunction",ud),Wr("StyleExpression",lf,{omit:["_evaluator"]}),Wr("ZoomDependentExpression",ld),Wr("ZoomConstantExpression",sd),Wr("CompoundExpression",vt,{omit:["_evaluate"]}),yc)yc[ol]._classRegistryKey||Wr("Expression_"+ol,yc[ol]);function bv(h){return h&&typeof ArrayBuffer<"u"&&(h instanceof ArrayBuffer||h.constructor&&h.constructor.name==="ArrayBuffer")}function op(h){return $0&&h instanceof $0}function js(h,p){if(h==null||typeof h=="boolean"||typeof h=="number"||typeof h=="string"||h instanceof Boolean||h instanceof Number||h instanceof String||h instanceof Date||h instanceof RegExp)return h;if(bv(h)||op(h))return p&&p.push(h),h;if(ArrayBuffer.isView(h)){var m=h;return p&&p.push(m.buffer),m}if(h instanceof ap)return p&&p.push(h.data.buffer),h;if(Array.isArray(h)){for(var E=[],T=0,I=h;T<I.length;T+=1)E.push(js(I[T],p));return E}if(typeof h=="object"){var P=h.constructor,B=P._classRegistryKey;if(!B)throw new Error("can't serialize object of unregistered class");var H=P.serialize?P.serialize(h,p):{};if(!P.serialize){for(var G in h)if(h.hasOwnProperty(G)&&!(vo[B].omit.indexOf(G)>=0)){var Z=h[G];H[G]=vo[B].shallow.indexOf(G)>=0?Z:js(Z,p)}h instanceof Error&&(H.message=h.message)}if(H.$name)throw new Error("$name property is reserved for worker serialization logic.");return B!=="Object"&&(H.$name=B),H}throw new Error("can't serialize object of type "+typeof h)}function ha(h){if(h==null||typeof h=="boolean"||typeof h=="number"||typeof h=="string"||h instanceof Boolean||h instanceof Number||h instanceof String||h instanceof Date||h instanceof RegExp||bv(h)||op(h)||ArrayBuffer.isView(h)||h instanceof ap)return h;if(Array.isArray(h))return h.map(ha);if(typeof h=="object"){var p=h.$name||"Object",m=vo[p].klass;if(!m)throw new Error("can't deserialize unregistered class "+p);if(m.deserialize)return m.deserialize(h);for(var E=Object.create(m.prototype),T=0,I=Object.keys(h);T<I.length;T+=1){var P=I[T];if(P!=="$name"){var B=h[P];E[P]=vo[p].shallow.indexOf(P)>=0?B:ha(B)}}return E}throw new Error("can't deserialize object of type "+typeof h)}var Bg=function(){this.first=!0};Bg.prototype.update=function(h,p){var m=Math.floor(h);return this.first?(this.first=!1,this.lastIntegerZoom=m,this.lastIntegerZoomTime=0,this.lastZoom=h,this.lastFloorZoom=m,!0):(this.lastFloorZoom>m?(this.lastIntegerZoom=m+1,this.lastIntegerZoomTime=p):this.lastFloorZoom<m&&(this.lastIntegerZoom=m,this.lastIntegerZoomTime=p),h!==this.lastZoom&&(this.lastZoom=h,this.lastFloorZoom=m,!0))};var _r={"Latin-1 Supplement":function(h){return h>=128&&h<=255},Arabic:function(h){return h>=1536&&h<=1791},"Arabic Supplement":function(h){return h>=1872&&h<=1919},"Arabic Extended-A":function(h){return h>=2208&&h<=2303},"Hangul Jamo":function(h){return h>=4352&&h<=4607},"Unified Canadian Aboriginal Syllabics":function(h){return h>=5120&&h<=5759},Khmer:function(h){return h>=6016&&h<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(h){return h>=6320&&h<=6399},"General Punctuation":function(h){return h>=8192&&h<=8303},"Letterlike Symbols":function(h){return h>=8448&&h<=8527},"Number Forms":function(h){return h>=8528&&h<=8591},"Miscellaneous Technical":function(h){return h>=8960&&h<=9215},"Control Pictures":function(h){return h>=9216&&h<=9279},"Optical Character Recognition":function(h){return h>=9280&&h<=9311},"Enclosed Alphanumerics":function(h){return h>=9312&&h<=9471},"Geometric Shapes":function(h){return h>=9632&&h<=9727},"Miscellaneous Symbols":function(h){return h>=9728&&h<=9983},"Miscellaneous Symbols and Arrows":function(h){return h>=11008&&h<=11263},"CJK Radicals Supplement":function(h){return h>=11904&&h<=12031},"Kangxi Radicals":function(h){return h>=12032&&h<=12255},"Ideographic Description Characters":function(h){return h>=12272&&h<=12287},"CJK Symbols and Punctuation":function(h){return h>=12288&&h<=12351},Hiragana:function(h){return h>=12352&&h<=12447},Katakana:function(h){return h>=12448&&h<=12543},Bopomofo:function(h){return h>=12544&&h<=12591},"Hangul Compatibility Jamo":function(h){return h>=12592&&h<=12687},Kanbun:function(h){return h>=12688&&h<=12703},"Bopomofo Extended":function(h){return h>=12704&&h<=12735},"CJK Strokes":function(h){return h>=12736&&h<=12783},"Katakana Phonetic Extensions":function(h){return h>=12784&&h<=12799},"Enclosed CJK Letters and Months":function(h){return h>=12800&&h<=13055},"CJK Compatibility":function(h){return h>=13056&&h<=13311},"CJK Unified Ideographs Extension A":function(h){return h>=13312&&h<=19903},"Yijing Hexagram Symbols":function(h){return h>=19904&&h<=19967},"CJK Unified Ideographs":function(h){return h>=19968&&h<=40959},"Yi Syllables":function(h){return h>=40960&&h<=42127},"Yi Radicals":function(h){return h>=42128&&h<=42191},"Hangul Jamo Extended-A":function(h){return h>=43360&&h<=43391},"Hangul Syllables":function(h){return h>=44032&&h<=55215},"Hangul Jamo Extended-B":function(h){return h>=55216&&h<=55295},"Private Use Area":function(h){return h>=57344&&h<=63743},"CJK Compatibility Ideographs":function(h){return h>=63744&&h<=64255},"Arabic Presentation Forms-A":function(h){return h>=64336&&h<=65023},"Vertical Forms":function(h){return h>=65040&&h<=65055},"CJK Compatibility Forms":function(h){return h>=65072&&h<=65103},"Small Form Variants":function(h){return h>=65104&&h<=65135},"Arabic Presentation Forms-B":function(h){return h>=65136&&h<=65279},"Halfwidth and Fullwidth Forms":function(h){return h>=65280&&h<=65519}};function mh(h){for(var p=0,m=h;p<m.length;p+=1)if(Ev(m[p].charCodeAt(0)))return!0;return!1}function Ev(h){return!(h!==746&&h!==747&&(h<4352||!(_r["Bopomofo Extended"](h)||_r.Bopomofo(h)||_r["CJK Compatibility Forms"](h)&&!(h>=65097&&h<=65103)||_r["CJK Compatibility Ideographs"](h)||_r["CJK Compatibility"](h)||_r["CJK Radicals Supplement"](h)||_r["CJK Strokes"](h)||!(!_r["CJK Symbols and Punctuation"](h)||h>=12296&&h<=12305||h>=12308&&h<=12319||h===12336)||_r["CJK Unified Ideographs Extension A"](h)||_r["CJK Unified Ideographs"](h)||_r["Enclosed CJK Letters and Months"](h)||_r["Hangul Compatibility Jamo"](h)||_r["Hangul Jamo Extended-A"](h)||_r["Hangul Jamo Extended-B"](h)||_r["Hangul Jamo"](h)||_r["Hangul Syllables"](h)||_r.Hiragana(h)||_r["Ideographic Description Characters"](h)||_r.Kanbun(h)||_r["Kangxi Radicals"](h)||_r["Katakana Phonetic Extensions"](h)||_r.Katakana(h)&&h!==12540||!(!_r["Halfwidth and Fullwidth Forms"](h)||h===65288||h===65289||h===65293||h>=65306&&h<=65310||h===65339||h===65341||h===65343||h>=65371&&h<=65503||h===65507||h>=65512&&h<=65519)||!(!_r["Small Form Variants"](h)||h>=65112&&h<=65118||h>=65123&&h<=65126)||_r["Unified Canadian Aboriginal Syllabics"](h)||_r["Unified Canadian Aboriginal Syllabics Extended"](h)||_r["Vertical Forms"](h)||_r["Yijing Hexagram Symbols"](h)||_r["Yi Syllables"](h)||_r["Yi Radicals"](h))))}function Ng(h){return!(Ev(h)||function(p){return!!(_r["Latin-1 Supplement"](p)&&(p===167||p===169||p===174||p===177||p===188||p===189||p===190||p===215||p===247)||_r["General Punctuation"](p)&&(p===8214||p===8224||p===8225||p===8240||p===8241||p===8251||p===8252||p===8258||p===8263||p===8264||p===8265||p===8273)||_r["Letterlike Symbols"](p)||_r["Number Forms"](p)||_r["Miscellaneous Technical"](p)&&(p>=8960&&p<=8967||p>=8972&&p<=8991||p>=8996&&p<=9e3||p===9003||p>=9085&&p<=9114||p>=9150&&p<=9165||p===9167||p>=9169&&p<=9179||p>=9186&&p<=9215)||_r["Control Pictures"](p)&&p!==9251||_r["Optical Character Recognition"](p)||_r["Enclosed Alphanumerics"](p)||_r["Geometric Shapes"](p)||_r["Miscellaneous Symbols"](p)&&!(p>=9754&&p<=9759)||_r["Miscellaneous Symbols and Arrows"](p)&&(p>=11026&&p<=11055||p>=11088&&p<=11097||p>=11192&&p<=11243)||_r["CJK Symbols and Punctuation"](p)||_r.Katakana(p)||_r["Private Use Area"](p)||_r["CJK Compatibility Forms"](p)||_r["Small Form Variants"](p)||_r["Halfwidth and Fullwidth Forms"](p)||p===8734||p===8756||p===8757||p>=9984&&p<=10087||p>=10102&&p<=10131||p===65532||p===65533)}(h))}function bu(h){return h>=1424&&h<=2303||_r["Arabic Presentation Forms-A"](h)||_r["Arabic Presentation Forms-B"](h)}function Al(h,p){return!(!p&&bu(h)||h>=2304&&h<=3583||h>=3840&&h<=4255||_r.Khmer(h))}function kg(h){for(var p=0,m=h;p<m.length;p+=1)if(bu(m[p].charCodeAt(0)))return!0;return!1}var zg=null,Ys="unavailable",bc=null,q_=function(h){h&&typeof h=="string"&&h.indexOf("NetworkError")>-1&&(Ys="error"),zg&&zg(h)};function sp(){Ug.fire(new Mt("pluginStateChange",{pluginStatus:Ys,pluginURL:bc}))}var Ug=new Qt,H0=function(){return Ys},Ml=function(){if(Ys!=="deferred"||!bc)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Ys="loading",sp(),bc&&id({url:bc},function(h){h?q_(h):(Ys="loaded",sp())})},Ql={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Ys==="loaded"||Ql.applyArabicShaping!=null},isLoading:function(){return Ys==="loading"},setState:function(h){Ys=h.pluginStatus,bc=h.pluginURL},isParsed:function(){return Ql.applyArabicShaping!=null&&Ql.processBidirectionalText!=null&&Ql.processStyledBidirectionalText!=null},getPluginURL:function(){return bc}},Vn=function(h,p){this.zoom=h,p?(this.now=p.now,this.fadeDuration=p.fadeDuration,this.zoomHistory=p.zoomHistory,this.transition=p.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Bg,this.transition={})};Vn.prototype.isSupportedScript=function(h){return function(p,m){for(var E=0,T=p;E<T.length;E+=1)if(!Al(T[E].charCodeAt(0),m))return!1;return!0}(h,Ql.isLoaded())},Vn.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},Vn.prototype.getCrossfadeParameters=function(){var h=this.zoom,p=h-Math.floor(h),m=this.crossFadingFactor();return h>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:p+(1-p)*m}:{fromScale:.5,toScale:1,t:1-(1-m)*p}};var Jl=function(h,p){this.property=h,this.value=p,this.expression=function(m,E){if(Rg(m))return new ud(m,E);if(od(m)){var T=P0(m,E);if(T.result==="error")throw new Error(T.value.map(function(P){return P.key+": "+P.message}).join(", "));return T.value}var I=m;return typeof m=="string"&&E.type==="color"&&(I=oi.parse(m)),{kind:"constant",evaluate:function(){return I}}}(p===void 0?h.specification.default:p,h.specification)};Jl.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},Jl.prototype.possiblyEvaluate=function(h,p,m){return this.property.possiblyEvaluate(this,h,p,m)};var tu=function(h){this.property=h,this.value=new Jl(h,void 0)};tu.prototype.transitioned=function(h,p){return new pf(this.property,this.value,p,A({},h.transition,this.transition),h.now)},tu.prototype.untransitioned=function(){return new pf(this.property,this.value,null,{},0)};var hs=function(h){this._properties=h,this._values=Object.create(h.defaultTransitionablePropertyValues)};hs.prototype.getValue=function(h){return X(this._values[h].value.value)},hs.prototype.setValue=function(h,p){this._values.hasOwnProperty(h)||(this._values[h]=new tu(this._values[h].property)),this._values[h].value=new Jl(this._values[h].property,p===null?void 0:X(p))},hs.prototype.getTransition=function(h){return X(this._values[h].transition)},hs.prototype.setTransition=function(h,p){this._values.hasOwnProperty(h)||(this._values[h]=new tu(this._values[h].property)),this._values[h].transition=X(p)||void 0},hs.prototype.serialize=function(){for(var h={},p=0,m=Object.keys(this._values);p<m.length;p+=1){var E=m[p],T=this.getValue(E);T!==void 0&&(h[E]=T);var I=this.getTransition(E);I!==void 0&&(h[E+"-transition"]=I)}return h},hs.prototype.transitioned=function(h,p){for(var m=new yh(this._properties),E=0,T=Object.keys(this._values);E<T.length;E+=1){var I=T[E];m._values[I]=this._values[I].transitioned(h,p._values[I])}return m},hs.prototype.untransitioned=function(){for(var h=new yh(this._properties),p=0,m=Object.keys(this._values);p<m.length;p+=1){var E=m[p];h._values[E]=this._values[E].untransitioned()}return h};var pf=function(h,p,m,E,T){this.property=h,this.value=p,this.begin=T+E.delay||0,this.end=this.begin+E.duration||0,h.specification.transition&&(E.delay||E.duration)&&(this.prior=m)};pf.prototype.possiblyEvaluate=function(h,p,m){var E=h.now||0,T=this.value.possiblyEvaluate(h,p,m),I=this.prior;if(I){if(E>this.end)return this.prior=null,T;if(this.value.isDataDriven())return this.prior=null,T;if(E<this.begin)return I.possiblyEvaluate(h,p,m);var P=(E-this.begin)/(this.end-this.begin);return this.property.interpolate(I.possiblyEvaluate(h,p,m),T,function(B){if(B<=0)return 0;if(B>=1)return 1;var H=B*B,G=H*B;return 4*(B<.5?G:3*(B-H)+G-.75)}(P))}return T};var yh=function(h){this._properties=h,this._values=Object.create(h.defaultTransitioningPropertyValues)};yh.prototype.possiblyEvaluate=function(h,p,m){for(var E=new lp(this._properties),T=0,I=Object.keys(this._values);T<I.length;T+=1){var P=I[T];E._values[P]=this._values[P].possiblyEvaluate(h,p,m)}return E},yh.prototype.hasTransition=function(){for(var h=0,p=Object.keys(this._values);h<p.length;h+=1)if(this._values[p[h]].prior)return!0;return!1};var Eu=function(h){this._properties=h,this._values=Object.create(h.defaultPropertyValues)};Eu.prototype.getValue=function(h){return X(this._values[h].value)},Eu.prototype.setValue=function(h,p){this._values[h]=new Jl(this._values[h].property,p===null?void 0:X(p))},Eu.prototype.serialize=function(){for(var h={},p=0,m=Object.keys(this._values);p<m.length;p+=1){var E=m[p],T=this.getValue(E);T!==void 0&&(h[E]=T)}return h},Eu.prototype.possiblyEvaluate=function(h,p,m){for(var E=new lp(this._properties),T=0,I=Object.keys(this._values);T<I.length;T+=1){var P=I[T];E._values[P]=this._values[P].possiblyEvaluate(h,p,m)}return E};var Fs=function(h,p,m){this.property=h,this.value=p,this.parameters=m};Fs.prototype.isConstant=function(){return this.value.kind==="constant"},Fs.prototype.constantOr=function(h){return this.value.kind==="constant"?this.value.value:h},Fs.prototype.evaluate=function(h,p,m,E){return this.property.evaluate(this.value,this.parameters,h,p,m,E)};var lp=function(h){this._properties=h,this._values=Object.create(h.defaultPossiblyEvaluatedValues)};lp.prototype.get=function(h){return this._values[h]};var on=function(h){this.specification=h};on.prototype.possiblyEvaluate=function(h,p){return h.expression.evaluate(p)},on.prototype.interpolate=function(h,p,m){var E=tf[this.specification.type];return E?E(h,p,m):h};var Zr=function(h,p){this.specification=h,this.overrides=p};Zr.prototype.possiblyEvaluate=function(h,p,m,E){return new Fs(this,h.expression.kind==="constant"||h.expression.kind==="camera"?{kind:"constant",value:h.expression.evaluate(p,null,{},m,E)}:h.expression,p)},Zr.prototype.interpolate=function(h,p,m){if(h.value.kind!=="constant"||p.value.kind!=="constant")return h;if(h.value.value===void 0||p.value.value===void 0)return new Fs(this,{kind:"constant",value:void 0},h.parameters);var E=tf[this.specification.type];return E?new Fs(this,{kind:"constant",value:E(h.value.value,p.value.value,m)},h.parameters):h},Zr.prototype.evaluate=function(h,p,m,E,T,I){return h.kind==="constant"?h.value:h.evaluate(p,m,E,T,I)};var Rl=function(h){function p(){h.apply(this,arguments)}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype.possiblyEvaluate=function(m,E,T,I){if(m.value===void 0)return new Fs(this,{kind:"constant",value:void 0},E);if(m.expression.kind==="constant"){var P=m.expression.evaluate(E,null,{},T,I),B=m.property.specification.type==="resolvedImage"&&typeof P!="string"?P.name:P,H=this._calculate(B,B,B,E);return new Fs(this,{kind:"constant",value:H},E)}if(m.expression.kind==="camera"){var G=this._calculate(m.expression.evaluate({zoom:E.zoom-1}),m.expression.evaluate({zoom:E.zoom}),m.expression.evaluate({zoom:E.zoom+1}),E);return new Fs(this,{kind:"constant",value:G},E)}return new Fs(this,m.expression,E)},p.prototype.evaluate=function(m,E,T,I,P,B){if(m.kind==="source"){var H=m.evaluate(E,T,I,P,B);return this._calculate(H,H,H,E)}return m.kind==="composite"?this._calculate(m.evaluate({zoom:Math.floor(E.zoom)-1},T,I),m.evaluate({zoom:Math.floor(E.zoom)},T,I),m.evaluate({zoom:Math.floor(E.zoom)+1},T,I),E):m.value},p.prototype._calculate=function(m,E,T,I){return I.zoom>I.zoomHistory.lastIntegerZoom?{from:m,to:E}:{from:T,to:E}},p.prototype.interpolate=function(m){return m},p}(Zr),Bs=function(h){this.specification=h};Bs.prototype.possiblyEvaluate=function(h,p,m,E){if(h.value!==void 0){if(h.expression.kind==="constant"){var T=h.expression.evaluate(p,null,{},m,E);return this._calculate(T,T,T,p)}return this._calculate(h.expression.evaluate(new Vn(Math.floor(p.zoom-1),p)),h.expression.evaluate(new Vn(Math.floor(p.zoom),p)),h.expression.evaluate(new Vn(Math.floor(p.zoom+1),p)),p)}},Bs.prototype._calculate=function(h,p,m,E){return E.zoom>E.zoomHistory.lastIntegerZoom?{from:h,to:p}:{from:m,to:p}},Bs.prototype.interpolate=function(h){return h};var Xu=function(h){this.specification=h};Xu.prototype.possiblyEvaluate=function(h,p,m,E){return!!h.expression.evaluate(p,null,{},m,E)},Xu.prototype.interpolate=function(){return!1};var Va=function(h){for(var p in this.properties=h,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],h){var m=h[p];m.specification.overridable&&this.overridableProperties.push(p);var E=this.defaultPropertyValues[p]=new Jl(m,void 0),T=this.defaultTransitionablePropertyValues[p]=new tu(m);this.defaultTransitioningPropertyValues[p]=T.untransitioned(),this.defaultPossiblyEvaluatedValues[p]=E.possiblyEvaluate({})}};Wr("DataDrivenProperty",Zr),Wr("DataConstantProperty",on),Wr("CrossFadedDataDrivenProperty",Rl),Wr("CrossFadedProperty",Bs),Wr("ColorRampProperty",Xu);var wu=function(h){function p(m,E){if(h.call(this),this.id=m.id,this.type=m.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},m.type!=="custom"&&(this.metadata=(m=m).metadata,this.minzoom=m.minzoom,this.maxzoom=m.maxzoom,m.type!=="background"&&(this.source=m.source,this.sourceLayer=m["source-layer"],this.filter=m.filter),E.layout&&(this._unevaluatedLayout=new Eu(E.layout)),E.paint)){for(var T in this._transitionablePaint=new hs(E.paint),m.paint)this.setPaintProperty(T,m.paint[T],{validate:!1});for(var I in m.layout)this.setLayoutProperty(I,m.layout[I],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new lp(E.paint)}}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},p.prototype.getLayoutProperty=function(m){return m==="visibility"?this.visibility:this._unevaluatedLayout.getValue(m)},p.prototype.setLayoutProperty=function(m,E,T){T===void 0&&(T={}),E!=null&&this._validate(xv,"layers."+this.id+".layout."+m,m,E,T)||(m!=="visibility"?this._unevaluatedLayout.setValue(m,E):this.visibility=E)},p.prototype.getPaintProperty=function(m){return V(m,"-transition")?this._transitionablePaint.getTransition(m.slice(0,-11)):this._transitionablePaint.getValue(m)},p.prototype.setPaintProperty=function(m,E,T){if(T===void 0&&(T={}),E!=null&&this._validate(Fg,"layers."+this.id+".paint."+m,m,E,T))return!1;if(V(m,"-transition"))return this._transitionablePaint.setTransition(m.slice(0,-11),E||void 0),!1;var I=this._transitionablePaint._values[m],P=I.property.specification["property-type"]==="cross-faded-data-driven",B=I.value.isDataDriven(),H=I.value;this._transitionablePaint.setValue(m,E),this._handleSpecialPaintPropertyUpdate(m);var G=this._transitionablePaint._values[m].value;return G.isDataDriven()||B||P||this._handleOverridablePaintPropertyUpdate(m,H,G)},p.prototype._handleSpecialPaintPropertyUpdate=function(m){},p.prototype._handleOverridablePaintPropertyUpdate=function(m,E,T){return!1},p.prototype.isHidden=function(m){return!!(this.minzoom&&m<this.minzoom)||!!(this.maxzoom&&m>=this.maxzoom)||this.visibility==="none"},p.prototype.updateTransitions=function(m){this._transitioningPaint=this._transitionablePaint.transitioned(m,this._transitioningPaint)},p.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},p.prototype.recalculate=function(m,E){m.getCrossfadeParameters&&(this._crossfadeParameters=m.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(m,void 0,E)),this.paint=this._transitioningPaint.possiblyEvaluate(m,void 0,E)},p.prototype.serialize=function(){var m={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(m.layout=m.layout||{},m.layout.visibility=this.visibility),Y(m,function(E,T){return!(E===void 0||T==="layout"&&!Object.keys(E).length||T==="paint"&&!Object.keys(E).length)})},p.prototype._validate=function(m,E,T,I,P){return P===void 0&&(P={}),(!P||P.validate!==!1)&&df(this,m.call(_v,{key:E,layerType:this.type,objectKey:T,value:I,styleSpec:ct,style:{glyphs:!0,sprite:!0}}))},p.prototype.is3D=function(){return!1},p.prototype.isTileClipped=function(){return!1},p.prototype.hasOffscreenPass=function(){return!1},p.prototype.resize=function(){},p.prototype.isStateDependent=function(){for(var m in this.paint._values){var E=this.paint.get(m);if(E instanceof Fs&&vh(E.property.specification)&&(E.value.kind==="source"||E.value.kind==="composite")&&E.value.isStateDependent)return!0}return!1},p}(Qt),_h={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},hd=function(h,p){this._structArray=h,this._pos1=p*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Wi=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Wo(h,p){p===void 0&&(p=1);var m=0,E=0;return{members:h.map(function(T){var I=_h[T.type].BYTES_PER_ELEMENT,P=m=V0(m,Math.max(p,I)),B=T.components||1;return E=Math.max(E,I),m+=I*B,{name:T.name,type:T.type,components:B,offset:P}}),size:V0(m,Math.max(E,p)),alignment:p}}function V0(h,p){return Math.ceil(h/p)*p}Wi.serialize=function(h,p){return h._trim(),p&&(h.isTransferred=!0,p.push(h.arrayBuffer)),{length:h.length,arrayBuffer:h.arrayBuffer}},Wi.deserialize=function(h){var p=Object.create(this.prototype);return p.arrayBuffer=h.arrayBuffer,p.length=h.length,p.capacity=h.arrayBuffer.byteLength/p.bytesPerElement,p._refreshViews(),p},Wi.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Wi.prototype.clear=function(){this.length=0},Wi.prototype.resize=function(h){this.reserve(h),this.length=h},Wi.prototype.reserve=function(h){if(h>this.capacity){this.capacity=Math.max(h,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var p=this.uint8;this._refreshViews(),p&&this.uint8.set(p)}},Wi.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var vf=function(h){function p(){h.apply(this,arguments)}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},p.prototype.emplaceBack=function(m,E){var T=this.length;return this.resize(T+1),this.emplace(T,m,E)},p.prototype.emplace=function(m,E,T){var I=2*m;return this.int16[I+0]=E,this.int16[I+1]=T,m},p}(Wi);vf.prototype.bytesPerElement=4,Wr("StructArrayLayout2i4",vf);var $g=function(h){function p(){h.apply(this,arguments)}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},p.prototype.emplaceBack=function(m,E,T,I){var P=this.length;return this.resize(P+1),this.emplace(P,m,E,T,I)},p.prototype.emplace=function(m,E,T,I,P){var B=4*m;return this.int16[B+0]=E,this.int16[B+1]=T,this.int16[B+2]=I,this.int16[B+3]=P,m},p}(Wi);$g.prototype.bytesPerElement=8,Wr("StructArrayLayout4i8",$g);var xh=function(h){function p(){h.apply(this,arguments)}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},p.prototype.emplaceBack=function(m,E,T,I,P,B){var H=this.length;return this.resize(H+1),this.emplace(H,m,E,T,I,P,B)},p.prototype.emplace=function(m,E,T,I,P,B,H){var G=6*m;return this.int16[G+0]=E,this.int16[G+1]=T,this.int16[G+2]=I,this.int16[G+3]=P,this.int16[G+4]=B,this.int16[G+5]=H,m},p}(Wi);xh.prototype.bytesPerElement=12,Wr("StructArrayLayout2i4i12",xh);var Il=function(h){function p(){h.apply(this,arguments)}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},p.prototype.emplaceBack=function(m,E,T,I,P,B){var H=this.length;return this.resize(H+1),this.emplace(H,m,E,T,I,P,B)},p.prototype.emplace=function(m,E,T,I,P,B,H){var G=4*m,Z=8*m;return this.int16[G+0]=E,this.int16[G+1]=T,this.uint8[Z+4]=I,this.uint8[Z+5]=P,this.uint8[Z+6]=B,this.uint8[Z+7]=H,m},p}(Wi);Il.prototype.bytesPerElement=8,Wr("StructArrayLayout2i4ub8",Il);var up=function(h){function p(){h.apply(this,arguments)}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},p.prototype.emplaceBack=function(m,E){var T=this.length;return this.resize(T+1),this.emplace(T,m,E)},p.prototype.emplace=function(m,E,T){var I=2*m;return this.float32[I+0]=E,this.float32[I+1]=T,m},p}(Wi);up.prototype.bytesPerElement=8,Wr("StructArrayLayout2f8",up);var Ec=function(h){function p(){h.apply(this,arguments)}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},p.prototype.emplaceBack=function(m,E,T,I,P,B,H,G,Z,K){var nt=this.length;return this.resize(nt+1),this.emplace(nt,m,E,T,I,P,B,H,G,Z,K)},p.prototype.emplace=function(m,E,T,I,P,B,H,G,Z,K,nt){var lt=10*m;return this.uint16[lt+0]=E,this.uint16[lt+1]=T,this.uint16[lt+2]=I,this.uint16[lt+3]=P,this.uint16[lt+4]=B,this.uint16[lt+5]=H,this.uint16[lt+6]=G,this.uint16[lt+7]=Z,this.uint16[lt+8]=K,this.uint16[lt+9]=nt,m},p}(Wi);Ec.prototype.bytesPerElement=20,Wr("StructArrayLayout10ui20",Ec);var Hg=function(h){function p(){h.apply(this,arguments)}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},p.prototype.emplaceBack=function(m,E,T,I,P,B,H,G,Z,K,nt,lt){var St=this.length;return this.resize(St+1),this.emplace(St,m,E,T,I,P,B,H,G,Z,K,nt,lt)},p.prototype.emplace=function(m,E,T,I,P,B,H,G,Z,K,nt,lt,St){var Rt=12*m;return this.int16[Rt+0]=E,this.int16[Rt+1]=T,this.int16[Rt+2]=I,this.int16[Rt+3]=P,this.uint16[Rt+4]=B,this.uint16[Rt+5]=H,this.uint16[Rt+6]=G,this.uint16[Rt+7]=Z,this.int16[Rt+8]=K,this.int16[Rt+9]=nt,this.int16[Rt+10]=lt,this.int16[Rt+11]=St,m},p}(Wi);Hg.prototype.bytesPerElement=24,Wr("StructArrayLayout4i4ui4i24",Hg);var cp=function(h){function p(){h.apply(this,arguments)}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},p.prototype.emplaceBack=function(m,E,T){var I=this.length;return this.resize(I+1),this.emplace(I,m,E,T)},p.prototype.emplace=function(m,E,T,I){var P=3*m;return this.float32[P+0]=E,this.float32[P+1]=T,this.float32[P+2]=I,m},p}(Wi);cp.prototype.bytesPerElement=12,Wr("StructArrayLayout3f12",cp);var wv=function(h){function p(){h.apply(this,arguments)}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},p.prototype.emplaceBack=function(m){var E=this.length;return this.resize(E+1),this.emplace(E,m)},p.prototype.emplace=function(m,E){return this.uint32[1*m+0]=E,m},p}(Wi);wv.prototype.bytesPerElement=4,Wr("StructArrayLayout1ul4",wv);var Vg=function(h){function p(){h.apply(this,arguments)}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},p.prototype.emplaceBack=function(m,E,T,I,P,B,H,G,Z){var K=this.length;return this.resize(K+1),this.emplace(K,m,E,T,I,P,B,H,G,Z)},p.prototype.emplace=function(m,E,T,I,P,B,H,G,Z,K){var nt=10*m,lt=5*m;return this.int16[nt+0]=E,this.int16[nt+1]=T,this.int16[nt+2]=I,this.int16[nt+3]=P,this.int16[nt+4]=B,this.int16[nt+5]=H,this.uint32[lt+3]=G,this.uint16[nt+8]=Z,this.uint16[nt+9]=K,m},p}(Wi);Vg.prototype.bytesPerElement=20,Wr("StructArrayLayout6i1ul2ui20",Vg);var fd=function(h){function p(){h.apply(this,arguments)}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},p.prototype.emplaceBack=function(m,E,T,I,P,B){var H=this.length;return this.resize(H+1),this.emplace(H,m,E,T,I,P,B)},p.prototype.emplace=function(m,E,T,I,P,B,H){var G=6*m;return this.int16[G+0]=E,this.int16[G+1]=T,this.int16[G+2]=I,this.int16[G+3]=P,this.int16[G+4]=B,this.int16[G+5]=H,m},p}(Wi);fd.prototype.bytesPerElement=12,Wr("StructArrayLayout2i2i2i12",fd);var dd=function(h){function p(){h.apply(this,arguments)}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},p.prototype.emplaceBack=function(m,E,T,I,P){var B=this.length;return this.resize(B+1),this.emplace(B,m,E,T,I,P)},p.prototype.emplace=function(m,E,T,I,P,B){var H=4*m,G=8*m;return this.float32[H+0]=E,this.float32[H+1]=T,this.float32[H+2]=I,this.int16[G+6]=P,this.int16[G+7]=B,m},p}(Wi);dd.prototype.bytesPerElement=16,Wr("StructArrayLayout2f1f2i16",dd);var G0=function(h){function p(){h.apply(this,arguments)}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},p.prototype.emplaceBack=function(m,E,T,I){var P=this.length;return this.resize(P+1),this.emplace(P,m,E,T,I)},p.prototype.emplace=function(m,E,T,I,P){var B=12*m,H=3*m;return this.uint8[B+0]=E,this.uint8[B+1]=T,this.float32[H+1]=I,this.float32[H+2]=P,m},p}(Wi);G0.prototype.bytesPerElement=12,Wr("StructArrayLayout2ub2f12",G0);var wc=function(h){function p(){h.apply(this,arguments)}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},p.prototype.emplaceBack=function(m,E,T){var I=this.length;return this.resize(I+1),this.emplace(I,m,E,T)},p.prototype.emplace=function(m,E,T,I){var P=3*m;return this.uint16[P+0]=E,this.uint16[P+1]=T,this.uint16[P+2]=I,m},p}(Wi);wc.prototype.bytesPerElement=6,Wr("StructArrayLayout3ui6",wc);var ju=function(h){function p(){h.apply(this,arguments)}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},p.prototype.emplaceBack=function(m,E,T,I,P,B,H,G,Z,K,nt,lt,St,Rt,Gt,Nt,ne){var le=this.length;return this.resize(le+1),this.emplace(le,m,E,T,I,P,B,H,G,Z,K,nt,lt,St,Rt,Gt,Nt,ne)},p.prototype.emplace=function(m,E,T,I,P,B,H,G,Z,K,nt,lt,St,Rt,Gt,Nt,ne,le){var xe=24*m,we=12*m,$e=48*m;return this.int16[xe+0]=E,this.int16[xe+1]=T,this.uint16[xe+2]=I,this.uint16[xe+3]=P,this.uint32[we+2]=B,this.uint32[we+3]=H,this.uint32[we+4]=G,this.uint16[xe+10]=Z,this.uint16[xe+11]=K,this.uint16[xe+12]=nt,this.float32[we+7]=lt,this.float32[we+8]=St,this.uint8[$e+36]=Rt,this.uint8[$e+37]=Gt,this.uint8[$e+38]=Nt,this.uint32[we+10]=ne,this.int16[xe+22]=le,m},p}(Wi);ju.prototype.bytesPerElement=48,Wr("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ju);var Gg=function(h){function p(){h.apply(this,arguments)}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},p.prototype.emplaceBack=function(m,E,T,I,P,B,H,G,Z,K,nt,lt,St,Rt,Gt,Nt,ne,le,xe,we,$e,sr,yr,ln,Dr,pn,zr,li){var In=this.length;return this.resize(In+1),this.emplace(In,m,E,T,I,P,B,H,G,Z,K,nt,lt,St,Rt,Gt,Nt,ne,le,xe,we,$e,sr,yr,ln,Dr,pn,zr,li)},p.prototype.emplace=function(m,E,T,I,P,B,H,G,Z,K,nt,lt,St,Rt,Gt,Nt,ne,le,xe,we,$e,sr,yr,ln,Dr,pn,zr,li,In){var Kr=34*m,gi=17*m;return this.int16[Kr+0]=E,this.int16[Kr+1]=T,this.int16[Kr+2]=I,this.int16[Kr+3]=P,this.int16[Kr+4]=B,this.int16[Kr+5]=H,this.int16[Kr+6]=G,this.int16[Kr+7]=Z,this.uint16[Kr+8]=K,this.uint16[Kr+9]=nt,this.uint16[Kr+10]=lt,this.uint16[Kr+11]=St,this.uint16[Kr+12]=Rt,this.uint16[Kr+13]=Gt,this.uint16[Kr+14]=Nt,this.uint16[Kr+15]=ne,this.uint16[Kr+16]=le,this.uint16[Kr+17]=xe,this.uint16[Kr+18]=we,this.uint16[Kr+19]=$e,this.uint16[Kr+20]=sr,this.uint16[Kr+21]=yr,this.uint16[Kr+22]=ln,this.uint32[gi+12]=Dr,this.float32[gi+13]=pn,this.float32[gi+14]=zr,this.float32[gi+15]=li,this.float32[gi+16]=In,m},p}(Wi);Gg.prototype.bytesPerElement=68,Wr("StructArrayLayout8i15ui1ul4f68",Gg);var gf=function(h){function p(){h.apply(this,arguments)}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},p.prototype.emplaceBack=function(m){var E=this.length;return this.resize(E+1),this.emplace(E,m)},p.prototype.emplace=function(m,E){return this.float32[1*m+0]=E,m},p}(Wi);gf.prototype.bytesPerElement=4,Wr("StructArrayLayout1f4",gf);var Cu=function(h){function p(){h.apply(this,arguments)}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},p.prototype.emplaceBack=function(m,E,T){var I=this.length;return this.resize(I+1),this.emplace(I,m,E,T)},p.prototype.emplace=function(m,E,T,I){var P=3*m;return this.int16[P+0]=E,this.int16[P+1]=T,this.int16[P+2]=I,m},p}(Wi);Cu.prototype.bytesPerElement=6,Wr("StructArrayLayout3i6",Cu);var W0=function(h){function p(){h.apply(this,arguments)}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},p.prototype.emplaceBack=function(m,E,T){var I=this.length;return this.resize(I+1),this.emplace(I,m,E,T)},p.prototype.emplace=function(m,E,T,I){var P=4*m;return this.uint32[2*m+0]=E,this.uint16[P+2]=T,this.uint16[P+3]=I,m},p}(Wi);W0.prototype.bytesPerElement=8,Wr("StructArrayLayout1ul2ui8",W0);var Cv=function(h){function p(){h.apply(this,arguments)}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},p.prototype.emplaceBack=function(m,E){var T=this.length;return this.resize(T+1),this.emplace(T,m,E)},p.prototype.emplace=function(m,E,T){var I=2*m;return this.uint16[I+0]=E,this.uint16[I+1]=T,m},p}(Wi);Cv.prototype.bytesPerElement=4,Wr("StructArrayLayout2ui4",Cv);var Wg=function(h){function p(){h.apply(this,arguments)}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},p.prototype.emplaceBack=function(m){var E=this.length;return this.resize(E+1),this.emplace(E,m)},p.prototype.emplace=function(m,E){return this.uint16[1*m+0]=E,m},p}(Wi);Wg.prototype.bytesPerElement=2,Wr("StructArrayLayout1ui2",Wg);var Xg=function(h){function p(){h.apply(this,arguments)}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},p.prototype.emplaceBack=function(m,E,T,I){var P=this.length;return this.resize(P+1),this.emplace(P,m,E,T,I)},p.prototype.emplace=function(m,E,T,I,P){var B=4*m;return this.float32[B+0]=E,this.float32[B+1]=T,this.float32[B+2]=I,this.float32[B+3]=P,m},p}(Wi);Xg.prototype.bytesPerElement=16,Wr("StructArrayLayout4f16",Xg);var y=function(h){function p(){h.apply(this,arguments)}h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p;var m={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return m.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},m.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},m.x1.get=function(){return this._structArray.int16[this._pos2+2]},m.y1.get=function(){return this._structArray.int16[this._pos2+3]},m.x2.get=function(){return this._structArray.int16[this._pos2+4]},m.y2.get=function(){return this._structArray.int16[this._pos2+5]},m.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},m.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},m.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},m.anchorPoint.get=function(){return new c(this.anchorPointX,this.anchorPointY)},Object.defineProperties(p.prototype,m),p}(hd);y.prototype.size=20;var b=function(h){function p(){h.apply(this,arguments)}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype.get=function(m){return new y(this,m)},p}(Vg);Wr("CollisionBoxArray",b);var _=function(h){function p(){h.apply(this,arguments)}h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p;var m={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return m.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},m.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},m.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},m.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},m.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},m.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},m.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},m.segment.get=function(){return this._structArray.uint16[this._pos2+10]},m.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},m.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},m.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},m.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},m.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},m.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},m.placedOrientation.set=function(E){this._structArray.uint8[this._pos1+37]=E},m.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},m.hidden.set=function(E){this._structArray.uint8[this._pos1+38]=E},m.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},m.crossTileID.set=function(E){this._structArray.uint32[this._pos4+10]=E},m.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(p.prototype,m),p}(hd);_.prototype.size=48;var C=function(h){function p(){h.apply(this,arguments)}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype.get=function(m){return new _(this,m)},p}(ju);Wr("PlacedSymbolArray",C);var L=function(h){function p(){h.apply(this,arguments)}h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p;var m={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return m.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},m.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},m.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},m.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},m.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},m.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},m.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},m.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},m.key.get=function(){return this._structArray.uint16[this._pos2+8]},m.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},m.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},m.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},m.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},m.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},m.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},m.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},m.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},m.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},m.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},m.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},m.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},m.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},m.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},m.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},m.crossTileID.set=function(E){this._structArray.uint32[this._pos4+12]=E},m.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},m.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},m.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},m.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(p.prototype,m),p}(hd);L.prototype.size=68;var D=function(h){function p(){h.apply(this,arguments)}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype.get=function(m){return new L(this,m)},p}(Gg);Wr("SymbolInstanceArray",D);var F=function(h){function p(){h.apply(this,arguments)}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype.getoffsetX=function(m){return this.float32[1*m+0]},p}(gf);Wr("GlyphOffsetArray",F);var $=function(h){function p(){h.apply(this,arguments)}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype.getx=function(m){return this.int16[3*m+0]},p.prototype.gety=function(m){return this.int16[3*m+1]},p.prototype.gettileUnitDistanceFromAnchor=function(m){return this.int16[3*m+2]},p}(Cu);Wr("SymbolLineVertexArray",$);var j=function(h){function p(){h.apply(this,arguments)}h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p;var m={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return m.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},m.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},m.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(p.prototype,m),p}(hd);j.prototype.size=8;var et=function(h){function p(){h.apply(this,arguments)}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype.get=function(m){return new j(this,m)},p}(W0);Wr("FeatureIndexArray",et);var ut=Wo([{name:"a_pos",components:2,type:"Int16"}],4).members,ht=function(h){h===void 0&&(h=[]),this.segments=h};function dt(h,p){return 256*(h=w(Math.floor(h),0,255))+w(Math.floor(p),0,255)}ht.prototype.prepareSegment=function(h,p,m,E){var T=this.segments[this.segments.length-1];return h>ht.MAX_VERTEX_ARRAY_LENGTH&&it("Max vertices per segment is "+ht.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+h),(!T||T.vertexLength+h>ht.MAX_VERTEX_ARRAY_LENGTH||T.sortKey!==E)&&(T={vertexOffset:p.length,primitiveOffset:m.length,vertexLength:0,primitiveLength:0},E!==void 0&&(T.sortKey=E),this.segments.push(T)),T},ht.prototype.get=function(){return this.segments},ht.prototype.destroy=function(){for(var h=0,p=this.segments;h<p.length;h+=1){var m=p[h];for(var E in m.vaos)m.vaos[E].destroy()}},ht.simpleSegment=function(h,p,m,E){return new ht([{vertexOffset:h,primitiveOffset:p,vertexLength:m,primitiveLength:E,vaos:{},sortKey:0}])},ht.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Wr("SegmentVector",ht);var Ot=Wo([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),At=s(function(h){h.exports=function(p,m){var E,T,I,P,B,H,G,Z;for(T=p.length-(E=3&p.length),I=m,B=3432918353,H=461845907,Z=0;Z<T;)G=255&p.charCodeAt(Z)|(255&p.charCodeAt(++Z))<<8|(255&p.charCodeAt(++Z))<<16|(255&p.charCodeAt(++Z))<<24,++Z,I=27492+(65535&(P=5*(65535&(I=(I^=G=(65535&(G=(G=(65535&G)*B+(((G>>>16)*B&65535)<<16)&4294967295)<<15|G>>>17))*H+(((G>>>16)*H&65535)<<16)&4294967295)<<13|I>>>19))+((5*(I>>>16)&65535)<<16)&4294967295))+((58964+(P>>>16)&65535)<<16);switch(G=0,E){case 3:G^=(255&p.charCodeAt(Z+2))<<16;case 2:G^=(255&p.charCodeAt(Z+1))<<8;case 1:I^=G=(65535&(G=(G=(65535&(G^=255&p.charCodeAt(Z)))*B+(((G>>>16)*B&65535)<<16)&4294967295)<<15|G>>>17))*H+(((G>>>16)*H&65535)<<16)&4294967295}return I^=p.length,I=2246822507*(65535&(I^=I>>>16))+((2246822507*(I>>>16)&65535)<<16)&4294967295,I=3266489909*(65535&(I^=I>>>13))+((3266489909*(I>>>16)&65535)<<16)&4294967295,(I^=I>>>16)>>>0}}),$t=s(function(h){h.exports=function(p,m){for(var E,T=p.length,I=m^T,P=0;T>=4;)E=1540483477*(65535&(E=255&p.charCodeAt(P)|(255&p.charCodeAt(++P))<<8|(255&p.charCodeAt(++P))<<16|(255&p.charCodeAt(++P))<<24))+((1540483477*(E>>>16)&65535)<<16),I=1540483477*(65535&I)+((1540483477*(I>>>16)&65535)<<16)^(E=1540483477*(65535&(E^=E>>>24))+((1540483477*(E>>>16)&65535)<<16)),T-=4,++P;switch(T){case 3:I^=(255&p.charCodeAt(P+2))<<16;case 2:I^=(255&p.charCodeAt(P+1))<<8;case 1:I=1540483477*(65535&(I^=255&p.charCodeAt(P)))+((1540483477*(I>>>16)&65535)<<16)}return I=1540483477*(65535&(I^=I>>>13))+((1540483477*(I>>>16)&65535)<<16),(I^=I>>>15)>>>0}}),Ct=At,zt=$t;Ct.murmur3=At,Ct.murmur2=zt;var qt=function(){this.ids=[],this.positions=[],this.indexed=!1};qt.prototype.add=function(h,p,m,E){this.ids.push(Ee(h)),this.positions.push(p,m,E)},qt.prototype.getPositions=function(h){for(var p=Ee(h),m=0,E=this.ids.length-1;m<E;){var T=m+E>>1;this.ids[T]>=p?E=T:m=T+1}for(var I=[];this.ids[m]===p;)I.push({index:this.positions[3*m],start:this.positions[3*m+1],end:this.positions[3*m+2]}),m++;return I},qt.serialize=function(h,p){var m=new Float64Array(h.ids),E=new Uint32Array(h.positions);return function T(I,P,B,H){for(;B<H;){for(var G=I[B+H>>1],Z=B-1,K=H+1;;){do Z++;while(I[Z]<G);do K--;while(I[K]>G);if(Z>=K)break;pe(I,Z,K),pe(P,3*Z,3*K),pe(P,3*Z+1,3*K+1),pe(P,3*Z+2,3*K+2)}K-B<H-K?(T(I,P,B,K),B=K+1):(T(I,P,K+1,H),H=K)}}(m,E,0,m.length-1),p&&p.push(m.buffer,E.buffer),{ids:m,positions:E}},qt.deserialize=function(h){var p=new qt;return p.ids=h.ids,p.positions=h.positions,p.indexed=!0,p};var se=Math.pow(2,53)-1;function Ee(h){var p=+h;return!isNaN(p)&&p<=se?p:Ct(String(h))}function pe(h,p,m){var E=h[p];h[p]=h[m],h[m]=E}Wr("FeaturePositionMap",qt);var Ae=function(h,p){this.gl=h.gl,this.location=p},Ve=function(h){function p(m,E){h.call(this,m,E),this.current=0}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype.set=function(m){this.current!==m&&(this.current=m,this.gl.uniform1i(this.location,m))},p}(Ae),cr=function(h){function p(m,E){h.call(this,m,E),this.current=0}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype.set=function(m){this.current!==m&&(this.current=m,this.gl.uniform1f(this.location,m))},p}(Ae),ar=function(h){function p(m,E){h.call(this,m,E),this.current=[0,0]}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype.set=function(m){m[0]===this.current[0]&&m[1]===this.current[1]||(this.current=m,this.gl.uniform2f(this.location,m[0],m[1]))},p}(Ae),Mr=function(h){function p(m,E){h.call(this,m,E),this.current=[0,0,0]}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype.set=function(m){m[0]===this.current[0]&&m[1]===this.current[1]&&m[2]===this.current[2]||(this.current=m,this.gl.uniform3f(this.location,m[0],m[1],m[2]))},p}(Ae),sn=function(h){function p(m,E){h.call(this,m,E),this.current=[0,0,0,0]}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype.set=function(m){m[0]===this.current[0]&&m[1]===this.current[1]&&m[2]===this.current[2]&&m[3]===this.current[3]||(this.current=m,this.gl.uniform4f(this.location,m[0],m[1],m[2],m[3]))},p}(Ae),hn=function(h){function p(m,E){h.call(this,m,E),this.current=oi.transparent}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype.set=function(m){m.r===this.current.r&&m.g===this.current.g&&m.b===this.current.b&&m.a===this.current.a||(this.current=m,this.gl.uniform4f(this.location,m.r,m.g,m.b,m.a))},p}(Ae),cn=new Float32Array(16),Ii=function(h){function p(m,E){h.call(this,m,E),this.current=cn}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype.set=function(m){if(m[12]!==this.current[12]||m[0]!==this.current[0])return this.current=m,void this.gl.uniformMatrix4fv(this.location,!1,m);for(var E=1;E<16;E++)if(m[E]!==this.current[E]){this.current=m,this.gl.uniformMatrix4fv(this.location,!1,m);break}},p}(Ae);function kr(h){return[dt(255*h.r,255*h.g),dt(255*h.b,255*h.a)]}var Ln=function(h,p,m){this.value=h,this.uniformNames=p.map(function(E){return"u_"+E}),this.type=m};Ln.prototype.setUniform=function(h,p,m){h.set(m.constantOr(this.value))},Ln.prototype.getBinding=function(h,p,m){return this.type==="color"?new hn(h,p):new cr(h,p)};var Xn=function(h,p){this.uniformNames=p.map(function(m){return"u_"+m}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Xn.prototype.setConstantPatternPositions=function(h,p){this.pixelRatioFrom=p.pixelRatio,this.pixelRatioTo=h.pixelRatio,this.patternFrom=p.tlbr,this.patternTo=h.tlbr},Xn.prototype.setUniform=function(h,p,m,E){var T=E==="u_pattern_to"?this.patternTo:E==="u_pattern_from"?this.patternFrom:E==="u_pixel_ratio_to"?this.pixelRatioTo:E==="u_pixel_ratio_from"?this.pixelRatioFrom:null;T&&h.set(T)},Xn.prototype.getBinding=function(h,p,m){return m.substr(0,9)==="u_pattern"?new sn(h,p):new cr(h,p)};var Rn=function(h,p,m,E){this.expression=h,this.type=m,this.maxValue=0,this.paintVertexAttributes=p.map(function(T){return{name:"a_"+T,type:"Float32",components:m==="color"?2:1,offset:0}}),this.paintVertexArray=new E};Rn.prototype.populatePaintArray=function(h,p,m,E,T){var I=this.paintVertexArray.length,P=this.expression.evaluate(new Vn(0),p,{},E,[],T);this.paintVertexArray.resize(h),this._setPaintValue(I,h,P)},Rn.prototype.updatePaintArray=function(h,p,m,E){var T=this.expression.evaluate({zoom:0},m,E);this._setPaintValue(h,p,T)},Rn.prototype._setPaintValue=function(h,p,m){if(this.type==="color")for(var E=kr(m),T=h;T<p;T++)this.paintVertexArray.emplace(T,E[0],E[1]);else{for(var I=h;I<p;I++)this.paintVertexArray.emplace(I,m);this.maxValue=Math.max(this.maxValue,Math.abs(m))}},Rn.prototype.upload=function(h){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=h.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Rn.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Cn=function(h,p,m,E,T,I){this.expression=h,this.uniformNames=p.map(function(P){return"u_"+P+"_t"}),this.type=m,this.useIntegerZoom=E,this.zoom=T,this.maxValue=0,this.paintVertexAttributes=p.map(function(P){return{name:"a_"+P,type:"Float32",components:m==="color"?4:2,offset:0}}),this.paintVertexArray=new I};Cn.prototype.populatePaintArray=function(h,p,m,E,T){var I=this.expression.evaluate(new Vn(this.zoom),p,{},E,[],T),P=this.expression.evaluate(new Vn(this.zoom+1),p,{},E,[],T),B=this.paintVertexArray.length;this.paintVertexArray.resize(h),this._setPaintValue(B,h,I,P)},Cn.prototype.updatePaintArray=function(h,p,m,E){var T=this.expression.evaluate({zoom:this.zoom},m,E),I=this.expression.evaluate({zoom:this.zoom+1},m,E);this._setPaintValue(h,p,T,I)},Cn.prototype._setPaintValue=function(h,p,m,E){if(this.type==="color")for(var T=kr(m),I=kr(E),P=h;P<p;P++)this.paintVertexArray.emplace(P,T[0],T[1],I[0],I[1]);else{for(var B=h;B<p;B++)this.paintVertexArray.emplace(B,m,E);this.maxValue=Math.max(this.maxValue,Math.abs(m),Math.abs(E))}},Cn.prototype.upload=function(h){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=h.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Cn.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Cn.prototype.setUniform=function(h,p){var m=this.useIntegerZoom?Math.floor(p.zoom):p.zoom,E=w(this.expression.interpolationFactor(m,this.zoom,this.zoom+1),0,1);h.set(E)},Cn.prototype.getBinding=function(h,p,m){return new cr(h,p)};var $n=function(h,p,m,E,T,I){this.expression=h,this.type=p,this.useIntegerZoom=m,this.zoom=E,this.layerId=I,this.zoomInPaintVertexArray=new T,this.zoomOutPaintVertexArray=new T};$n.prototype.populatePaintArray=function(h,p,m){var E=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(h),this.zoomOutPaintVertexArray.resize(h),this._setPaintValues(E,h,p.patterns&&p.patterns[this.layerId],m)},$n.prototype.updatePaintArray=function(h,p,m,E,T){this._setPaintValues(h,p,m.patterns&&m.patterns[this.layerId],T)},$n.prototype._setPaintValues=function(h,p,m,E){if(E&&m){var T=E[m.min],I=E[m.mid],P=E[m.max];if(T&&I&&P)for(var B=h;B<p;B++)this.zoomInPaintVertexArray.emplace(B,I.tl[0],I.tl[1],I.br[0],I.br[1],T.tl[0],T.tl[1],T.br[0],T.br[1],I.pixelRatio,T.pixelRatio),this.zoomOutPaintVertexArray.emplace(B,I.tl[0],I.tl[1],I.br[0],I.br[1],P.tl[0],P.tl[1],P.br[0],P.br[1],I.pixelRatio,P.pixelRatio)}},$n.prototype.upload=function(h){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=h.createVertexBuffer(this.zoomInPaintVertexArray,Ot.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=h.createVertexBuffer(this.zoomOutPaintVertexArray,Ot.members,this.expression.isStateDependent))},$n.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Sn=function(h,p,m){this.binders={},this._buffers=[];var E=[];for(var T in h.paint._values)if(m(T)){var I=h.paint.get(T);if(I instanceof Fs&&vh(I.property.specification)){var P=Mo(T,h.type),B=I.value,H=I.property.specification.type,G=I.property.useIntegerZoom,Z=I.property.specification["property-type"],K=Z==="cross-faded"||Z==="cross-faded-data-driven";if(B.kind==="constant")this.binders[T]=K?new Xn(B.value,P):new Ln(B.value,P,H),E.push("/u_"+T);else if(B.kind==="source"||K){var nt=ja(T,H,"source");this.binders[T]=K?new $n(B,H,G,p,nt,h.id):new Rn(B,P,H,nt),E.push("/a_"+T)}else{var lt=ja(T,H,"composite");this.binders[T]=new Cn(B,P,H,G,p,lt),E.push("/z_"+T)}}}this.cacheKey=E.sort().join("")};Sn.prototype.getMaxValue=function(h){var p=this.binders[h];return p instanceof Rn||p instanceof Cn?p.maxValue:0},Sn.prototype.populatePaintArrays=function(h,p,m,E,T){for(var I in this.binders){var P=this.binders[I];(P instanceof Rn||P instanceof Cn||P instanceof $n)&&P.populatePaintArray(h,p,m,E,T)}},Sn.prototype.setConstantPatternPositions=function(h,p){for(var m in this.binders){var E=this.binders[m];E instanceof Xn&&E.setConstantPatternPositions(h,p)}},Sn.prototype.updatePaintArrays=function(h,p,m,E,T){var I=!1;for(var P in h)for(var B=0,H=p.getPositions(P);B<H.length;B+=1){var G=H[B],Z=m.feature(G.index);for(var K in this.binders){var nt=this.binders[K];if((nt instanceof Rn||nt instanceof Cn||nt instanceof $n)&&nt.expression.isStateDependent===!0){var lt=E.paint.get(K);nt.expression=lt.value,nt.updatePaintArray(G.start,G.end,Z,h[P],T),I=!0}}}return I},Sn.prototype.defines=function(){var h=[];for(var p in this.binders){var m=this.binders[p];(m instanceof Ln||m instanceof Xn)&&h.push.apply(h,m.uniformNames.map(function(E){return"#define HAS_UNIFORM_"+E}))}return h},Sn.prototype.getBinderAttributes=function(){var h=[];for(var p in this.binders){var m=this.binders[p];if(m instanceof Rn||m instanceof Cn)for(var E=0;E<m.paintVertexAttributes.length;E++)h.push(m.paintVertexAttributes[E].name);else if(m instanceof $n)for(var T=0;T<Ot.members.length;T++)h.push(Ot.members[T].name)}return h},Sn.prototype.getBinderUniforms=function(){var h=[];for(var p in this.binders){var m=this.binders[p];if(m instanceof Ln||m instanceof Xn||m instanceof Cn)for(var E=0,T=m.uniformNames;E<T.length;E+=1)h.push(T[E])}return h},Sn.prototype.getPaintVertexBuffers=function(){return this._buffers},Sn.prototype.getUniforms=function(h,p){var m=[];for(var E in this.binders){var T=this.binders[E];if(T instanceof Ln||T instanceof Xn||T instanceof Cn)for(var I=0,P=T.uniformNames;I<P.length;I+=1){var B=P[I];if(p[B]){var H=T.getBinding(h,p[B],B);m.push({name:B,property:E,binding:H})}}}return m},Sn.prototype.setUniforms=function(h,p,m,E){for(var T=0,I=p;T<I.length;T+=1){var P=I[T],B=P.name,H=P.property;this.binders[H].setUniform(P.binding,E,m.get(H),B)}},Sn.prototype.updatePaintBuffers=function(h){for(var p in this._buffers=[],this.binders){var m=this.binders[p];if(h&&m instanceof $n){var E=h.fromScale===2?m.zoomInPaintVertexBuffer:m.zoomOutPaintVertexBuffer;E&&this._buffers.push(E)}else(m instanceof Rn||m instanceof Cn)&&m.paintVertexBuffer&&this._buffers.push(m.paintVertexBuffer)}},Sn.prototype.upload=function(h){for(var p in this.binders){var m=this.binders[p];(m instanceof Rn||m instanceof Cn||m instanceof $n)&&m.upload(h)}this.updatePaintBuffers()},Sn.prototype.destroy=function(){for(var h in this.binders){var p=this.binders[h];(p instanceof Rn||p instanceof Cn||p instanceof $n)&&p.destroy()}};var bn=function(h,p,m){m===void 0&&(m=function(){return!0}),this.programConfigurations={};for(var E=0,T=h;E<T.length;E+=1){var I=T[E];this.programConfigurations[I.id]=new Sn(I,p,m)}this.needsUpload=!1,this._featureMap=new qt,this._bufferOffset=0};function Mo(h,p){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[h]||[h.replace(p+"-","").replace(/-/g,"_")]}function ja(h,p,m){var E={color:{source:up,composite:Xg},number:{source:gf,composite:up}},T=function(I){return{"line-pattern":{source:Ec,composite:Ec},"fill-pattern":{source:Ec,composite:Ec},"fill-extrusion-pattern":{source:Ec,composite:Ec}}[I]}(h);return T&&T[m]||E[p][m]}bn.prototype.populatePaintArrays=function(h,p,m,E,T,I){for(var P in this.programConfigurations)this.programConfigurations[P].populatePaintArrays(h,p,E,T,I);p.id!==void 0&&this._featureMap.add(p.id,m,this._bufferOffset,h),this._bufferOffset=h,this.needsUpload=!0},bn.prototype.updatePaintArrays=function(h,p,m,E){for(var T=0,I=m;T<I.length;T+=1){var P=I[T];this.needsUpload=this.programConfigurations[P.id].updatePaintArrays(h,this._featureMap,p,P,E)||this.needsUpload}},bn.prototype.get=function(h){return this.programConfigurations[h]},bn.prototype.upload=function(h){if(this.needsUpload){for(var p in this.programConfigurations)this.programConfigurations[p].upload(h);this.needsUpload=!1}},bn.prototype.destroy=function(){for(var h in this.programConfigurations)this.programConfigurations[h].destroy()},Wr("ConstantBinder",Ln),Wr("CrossFadedConstantBinder",Xn),Wr("SourceExpressionBinder",Rn),Wr("CrossFadedCompositeBinder",$n),Wr("CompositeExpressionBinder",Cn),Wr("ProgramConfiguration",Sn,{omit:["_buffers"]}),Wr("ProgramConfigurationSet",bn);var fs=Math.pow(2,14)-1,Xo=-fs-1;function Ga(h){for(var p=8192/h.extent,m=h.loadGeometry(),E=0;E<m.length;E++)for(var T=m[E],I=0;I<T.length;I++){var P=T[I],B=Math.round(P.x*p),H=Math.round(P.y*p);P.x=w(B,Xo,fs),P.y=w(H,Xo,fs),(B<P.x||B>P.x+1||H<P.y||H>P.y+1)&&it("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return m}function Ya(h,p){return{type:h.type,id:h.id,properties:h.properties,geometry:p?Ga(h):[]}}function Zs(h,p,m,E,T){h.emplaceBack(2*p+(E+1)/2,2*m+(T+1)/2)}var Ns=function(h){this.zoom=h.zoom,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(function(p){return p.id}),this.index=h.index,this.hasPattern=!1,this.layoutVertexArray=new vf,this.indexArray=new wc,this.segments=new ht,this.programConfigurations=new bn(h.layers,h.zoom),this.stateDependentLayerIds=this.layers.filter(function(p){return p.isStateDependent()}).map(function(p){return p.id})};function Cc(h,p){for(var m=0;m<h.length;m++)if(Yu(p,h[m]))return!0;for(var E=0;E<p.length;E++)if(Yu(h,p[E]))return!0;return!!hp(h,p)}function qs(h,p,m){return!!Yu(h,p)||!!Sc(p,h,m)}function Su(h,p){if(h.length===1)return bh(p,h[0]);for(var m=0;m<p.length;m++)for(var E=p[m],T=0;T<E.length;T++)if(Yu(h,E[T]))return!0;for(var I=0;I<h.length;I++)if(bh(p,h[I]))return!0;for(var P=0;P<p.length;P++)if(hp(h,p[P]))return!0;return!1}function Ll(h,p,m){if(h.length>1){if(hp(h,p))return!0;for(var E=0;E<p.length;E++)if(Sc(p[E],h,m))return!0}for(var T=0;T<h.length;T++)if(Sc(h[T],p,m))return!0;return!1}function hp(h,p){if(h.length===0||p.length===0)return!1;for(var m=0;m<h.length-1;m++)for(var E=h[m],T=h[m+1],I=0;I<p.length-1;I++)if(pd(E,T,p[I],p[I+1]))return!0;return!1}function pd(h,p,m,E){return Et(h,m,E)!==Et(p,m,E)&&Et(h,p,m)!==Et(h,p,E)}function Sc(h,p,m){var E=m*m;if(p.length===1)return h.distSqr(p[0])<E;for(var T=1;T<p.length;T++)if(mf(h,p[T-1],p[T])<E)return!0;return!1}function mf(h,p,m){var E=p.distSqr(m);if(E===0)return h.distSqr(p);var T=((h.x-p.x)*(m.x-p.x)+(h.y-p.y)*(m.y-p.y))/E;return h.distSqr(T<0?p:T>1?m:m.sub(p)._mult(T)._add(p))}function bh(h,p){for(var m,E,T,I=!1,P=0;P<h.length;P++)for(var B=0,H=(m=h[P]).length-1;B<m.length;H=B++)(E=m[B]).y>p.y!=(T=m[H]).y>p.y&&p.x<(T.x-E.x)*(p.y-E.y)/(T.y-E.y)+E.x&&(I=!I);return I}function Yu(h,p){for(var m=!1,E=0,T=h.length-1;E<h.length;T=E++){var I=h[E],P=h[T];I.y>p.y!=P.y>p.y&&p.x<(P.x-I.x)*(p.y-I.y)/(P.y-I.y)+I.x&&(m=!m)}return m}function yf(h,p,m){var E=m[0],T=m[2];if(h.x<E.x&&p.x<E.x||h.x>T.x&&p.x>T.x||h.y<E.y&&p.y<E.y||h.y>T.y&&p.y>T.y)return!1;var I=Et(h,p,m[0]);return I!==Et(h,p,m[1])||I!==Et(h,p,m[2])||I!==Et(h,p,m[3])}function Ss(h,p,m){var E=p.paint.get(h).value;return E.kind==="constant"?E.value:m.programConfigurations.get(p.id).getMaxValue(h)}function ao(h){return Math.sqrt(h[0]*h[0]+h[1]*h[1])}function sl(h,p,m,E,T){if(!p[0]&&!p[1])return h;var I=c.convert(p)._mult(T);m==="viewport"&&I._rotate(-E);for(var P=[],B=0;B<h.length;B++)P.push(h[B].sub(I));return P}Ns.prototype.populate=function(h,p,m){var E=this.layers[0],T=[],I=null;E.type==="circle"&&(I=E.layout.get("circle-sort-key"));for(var P=0,B=h;P<B.length;P+=1){var H=B[P],G=H.feature,Z=H.id,K=H.index,nt=H.sourceLayerIndex,lt=this.layers[0]._featureFilter.needGeometry,St=Ya(G,lt);if(this.layers[0]._featureFilter.filter(new Vn(this.zoom),St,m)){var Rt=I?I.evaluate(St,{},m):void 0,Gt={id:Z,properties:G.properties,type:G.type,sourceLayerIndex:nt,index:K,geometry:lt?St.geometry:Ga(G),patterns:{},sortKey:Rt};T.push(Gt)}}I&&T.sort(function(yr,ln){return yr.sortKey-ln.sortKey});for(var Nt=0,ne=T;Nt<ne.length;Nt+=1){var le=ne[Nt],xe=le.geometry,we=le.index,$e=le.sourceLayerIndex,sr=h[we].feature;this.addFeature(le,xe,we,m),p.featureIndex.insert(sr,xe,we,$e,this.index)}},Ns.prototype.update=function(h,p,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(h,p,this.stateDependentLayers,m)},Ns.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ns.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ns.prototype.upload=function(h){this.uploaded||(this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,ut),this.indexBuffer=h.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(h),this.uploaded=!0},Ns.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ns.prototype.addFeature=function(h,p,m,E){for(var T=0,I=p;T<I.length;T+=1)for(var P=0,B=I[T];P<B.length;P+=1){var H=B[P],G=H.x,Z=H.y;if(!(G<0||G>=8192||Z<0||Z>=8192)){var K=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,h.sortKey),nt=K.vertexLength;Zs(this.layoutVertexArray,G,Z,-1,-1),Zs(this.layoutVertexArray,G,Z,1,-1),Zs(this.layoutVertexArray,G,Z,1,1),Zs(this.layoutVertexArray,G,Z,-1,1),this.indexArray.emplaceBack(nt,nt+1,nt+2),this.indexArray.emplaceBack(nt,nt+3,nt+2),K.vertexLength+=4,K.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,h,m,{},E)},Wr("CircleBucket",Ns,{omit:["layers"]});var Tu=new Va({"circle-sort-key":new Zr(ct.layout_circle["circle-sort-key"])}),Zu={paint:new Va({"circle-radius":new Zr(ct.paint_circle["circle-radius"]),"circle-color":new Zr(ct.paint_circle["circle-color"]),"circle-blur":new Zr(ct.paint_circle["circle-blur"]),"circle-opacity":new Zr(ct.paint_circle["circle-opacity"]),"circle-translate":new on(ct.paint_circle["circle-translate"]),"circle-translate-anchor":new on(ct.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new on(ct.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new on(ct.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Zr(ct.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Zr(ct.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Zr(ct.paint_circle["circle-stroke-opacity"])}),layout:Tu},_i=typeof Float32Array<"u"?Float32Array:Array;function ds(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=1,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=1,h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,h}function Ro(h,p,m){var E=p[0],T=p[1],I=p[2],P=p[3],B=p[4],H=p[5],G=p[6],Z=p[7],K=p[8],nt=p[9],lt=p[10],St=p[11],Rt=p[12],Gt=p[13],Nt=p[14],ne=p[15],le=m[0],xe=m[1],we=m[2],$e=m[3];return h[0]=le*E+xe*B+we*K+$e*Rt,h[1]=le*T+xe*H+we*nt+$e*Gt,h[2]=le*I+xe*G+we*lt+$e*Nt,h[3]=le*P+xe*Z+we*St+$e*ne,h[4]=(le=m[4])*E+(xe=m[5])*B+(we=m[6])*K+($e=m[7])*Rt,h[5]=le*T+xe*H+we*nt+$e*Gt,h[6]=le*I+xe*G+we*lt+$e*Nt,h[7]=le*P+xe*Z+we*St+$e*ne,h[8]=(le=m[8])*E+(xe=m[9])*B+(we=m[10])*K+($e=m[11])*Rt,h[9]=le*T+xe*H+we*nt+$e*Gt,h[10]=le*I+xe*G+we*lt+$e*Nt,h[11]=le*P+xe*Z+we*St+$e*ne,h[12]=(le=m[12])*E+(xe=m[13])*B+(we=m[14])*K+($e=m[15])*Rt,h[13]=le*T+xe*H+we*nt+$e*Gt,h[14]=le*I+xe*G+we*lt+$e*Nt,h[15]=le*P+xe*Z+we*St+$e*ne,h}Math.hypot||(Math.hypot=function(){for(var h=arguments,p=0,m=arguments.length;m--;)p+=h[m]*h[m];return Math.sqrt(p)});var Tc,jg=Ro;function _f(h,p,m){var E=p[0],T=p[1],I=p[2],P=p[3];return h[0]=m[0]*E+m[4]*T+m[8]*I+m[12]*P,h[1]=m[1]*E+m[5]*T+m[9]*I+m[13]*P,h[2]=m[2]*E+m[6]*T+m[10]*I+m[14]*P,h[3]=m[3]*E+m[7]*T+m[11]*I+m[15]*P,h}Tc=new _i(3),_i!=Float32Array&&(Tc[0]=0,Tc[1]=0,Tc[2]=0),function(){var h=new _i(4);_i!=Float32Array&&(h[0]=0,h[1]=0,h[2]=0,h[3]=0)}();var X0=(function(){var h=new _i(2);_i!=Float32Array&&(h[0]=0,h[1]=0)}(),function(h){function p(m){h.call(this,m,Zu)}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype.createBucket=function(m){return new Ns(m)},p.prototype.queryRadius=function(m){var E=m;return Ss("circle-radius",this,E)+Ss("circle-stroke-width",this,E)+ao(this.paint.get("circle-translate"))},p.prototype.queryIntersectsFeature=function(m,E,T,I,P,B,H,G){for(var Z=sl(m,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),B.angle,H),K=this.paint.get("circle-radius").evaluate(E,T)+this.paint.get("circle-stroke-width").evaluate(E,T),nt=this.paint.get("circle-pitch-alignment")==="map",lt=nt?Z:function(sr,yr){return sr.map(function(ln){return vd(ln,yr)})}(Z,G),St=nt?K*H:K,Rt=0,Gt=I;Rt<Gt.length;Rt+=1)for(var Nt=0,ne=Gt[Rt];Nt<ne.length;Nt+=1){var le=ne[Nt],xe=nt?le:vd(le,G),we=St,$e=_f([],[le.x,le.y,0,1],G);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?we*=$e[3]/B.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(we*=B.cameraToCenterDistance/$e[3]),qs(lt,xe,we))return!0}return!1},p}(wu));function vd(h,p){var m=_f([],[h.x,h.y,0,1],p);return new c(m[0]/m[3],m[1]/m[3])}var gd=function(h){function p(){h.apply(this,arguments)}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p}(Ns);function qu(h,p,m,E){var T=p.width,I=p.height;if(E){if(E instanceof Uint8ClampedArray)E=new Uint8Array(E.buffer);else if(E.length!==T*I*m)throw new RangeError("mismatched image size")}else E=new Uint8Array(T*I*m);return h.width=T,h.height=I,h.data=E,h}function Yg(h,p,m){var E=p.width,T=p.height;if(E!==h.width||T!==h.height){var I=qu({},{width:E,height:T},m);qb(h,I,{x:0,y:0},{x:0,y:0},{width:Math.min(h.width,E),height:Math.min(h.height,T)},m),h.width=E,h.height=T,h.data=I.data}}function qb(h,p,m,E,T,I){if(T.width===0||T.height===0)return p;if(T.width>h.width||T.height>h.height||m.x>h.width-T.width||m.y>h.height-T.height)throw new RangeError("out of range source coordinates for image copy");if(T.width>p.width||T.height>p.height||E.x>p.width-T.width||E.y>p.height-T.height)throw new RangeError("out of range destination coordinates for image copy");for(var P=h.data,B=p.data,H=0;H<T.height;H++)for(var G=((m.y+H)*h.width+m.x)*I,Z=((E.y+H)*p.width+E.x)*I,K=0;K<T.width*I;K++)B[Z+K]=P[G+K];return p}Wr("HeatmapBucket",gd,{omit:["layers"]});var fp=function(h,p){qu(this,h,1,p)};fp.prototype.resize=function(h){Yg(this,h,1)},fp.prototype.clone=function(){return new fp({width:this.width,height:this.height},new Uint8Array(this.data))},fp.copy=function(h,p,m,E,T){qb(h,p,m,E,T,1)};var ll=function(h,p){qu(this,h,4,p)};ll.prototype.resize=function(h){Yg(this,h,4)},ll.prototype.replace=function(h,p){p?this.data.set(h):this.data=h instanceof Uint8ClampedArray?new Uint8Array(h.buffer):h},ll.prototype.clone=function(){return new ll({width:this.width,height:this.height},new Uint8Array(this.data))},ll.copy=function(h,p,m,E,T){qb(h,p,m,E,T,4)},Wr("AlphaImage",fp),Wr("RGBAImage",ll);var l2={paint:new Va({"heatmap-radius":new Zr(ct.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Zr(ct.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new on(ct.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Xu(ct.paint_heatmap["heatmap-color"]),"heatmap-opacity":new on(ct.paint_heatmap["heatmap-opacity"])})};function u2(h){var p={},m=h.resolution||256,E=h.clips?h.clips.length:1,T=h.image||new ll({width:m,height:E}),I=function(St,Rt,Gt){p[h.evaluationKey]=Gt;var Nt=h.expression.evaluate(p);T.data[St+Rt+0]=Math.floor(255*Nt.r/Nt.a),T.data[St+Rt+1]=Math.floor(255*Nt.g/Nt.a),T.data[St+Rt+2]=Math.floor(255*Nt.b/Nt.a),T.data[St+Rt+3]=Math.floor(255*Nt.a)};if(h.clips)for(var P=0,B=0;P<E;++P,B+=4*m)for(var H=0,G=0;H<m;H++,G+=4){var Z=H/(m-1),K=h.clips[P];I(B,G,K.start*(1-Z)+K.end*Z)}else for(var nt=0,lt=0;nt<m;nt++,lt+=4)I(0,lt,nt/(m-1));return T}var Zg=function(h){function p(m){h.call(this,m,l2),this._updateColorRamp()}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype.createBucket=function(m){return new gd(m)},p.prototype._handleSpecialPaintPropertyUpdate=function(m){m==="heatmap-color"&&this._updateColorRamp()},p.prototype._updateColorRamp=function(){this.colorRamp=u2({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},p.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},p.prototype.queryRadius=function(){return 0},p.prototype.queryIntersectsFeature=function(){return!1},p.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},p}(wu),hL={paint:new Va({"hillshade-illumination-direction":new on(ct.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new on(ct.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new on(ct.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new on(ct.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new on(ct.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new on(ct.paint_hillshade["hillshade-accent-color"])})},fL=function(h){function p(m){h.call(this,m,hL)}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},p}(wu),dL=Wo([{name:"a_pos",components:2,type:"Int16"}],4).members,K_=Q_,pL=Q_;function Q_(h,p,m){m=m||2;var E,T,I,P,B,H,G,Z=p&&p.length,K=Z?p[0]*m:h.length,nt=c2(h,0,K,m,!0),lt=[];if(!nt||nt.next===nt.prev)return lt;if(Z&&(nt=function(Rt,Gt,Nt,ne){var le,xe,we,$e=[];for(le=0,xe=Gt.length;le<xe;le++)(we=c2(Rt,Gt[le]*ne,le<xe-1?Gt[le+1]*ne:Rt.length,ne,!1))===we.next&&(we.steiner=!0),$e.push(t1(we));for($e.sort(_L),le=0;le<$e.length;le++)Kb($e[le],Nt),Nt=dp(Nt,Nt.next);return Nt}(h,p,nt,m)),h.length>80*m){E=I=h[0],T=P=h[1];for(var St=m;St<K;St+=m)(B=h[St])<E&&(E=B),(H=h[St+1])<T&&(T=H),B>I&&(I=B),H>P&&(P=H);G=(G=Math.max(I-E,P-T))!==0?1/G:0}return j0(nt,lt,m,E,T,G),lt}function c2(h,p,m,E,T){var I,P;if(T===Rv(h,p,m,E)>0)for(I=p;I<m;I+=E)P=Qg(I,h[I],h[I+1],P);else for(I=m-E;I>=p;I-=E)P=Qg(I,h[I],h[I+1],P);return P&&Sv(P,P.next)&&(md(P),P=P.next),P}function dp(h,p){if(!h)return h;p||(p=h);var m,E=h;do if(m=!1,E.steiner||!Sv(E,E.next)&&oo(E.prev,E,E.next)!==0)E=E.next;else{if(md(E),(E=p=E.prev)===E.next)break;m=!0}while(m||E!==p);return p}function j0(h,p,m,E,T,I,P){if(h){!P&&I&&function(Z,K,nt,lt){var St=Z;do St.z===null&&(St.z=qg(St.x,St.y,K,nt,lt)),St.prevZ=St.prev,St.nextZ=St.next,St=St.next;while(St!==Z);St.prevZ.nextZ=null,St.prevZ=null,function(Rt){var Gt,Nt,ne,le,xe,we,$e,sr,yr=1;do{for(Nt=Rt,Rt=null,xe=null,we=0;Nt;){for(we++,ne=Nt,$e=0,Gt=0;Gt<yr&&($e++,ne=ne.nextZ);Gt++);for(sr=yr;$e>0||sr>0&&ne;)$e!==0&&(sr===0||!ne||Nt.z<=ne.z)?(le=Nt,Nt=Nt.nextZ,$e--):(le=ne,ne=ne.nextZ,sr--),xe?xe.nextZ=le:Rt=le,le.prevZ=xe,xe=le;Nt=ne}xe.nextZ=null,yr*=2}while(we>1)}(St)}(h,E,T,I);for(var B,H,G=h;h.prev!==h.next;)if(B=h.prev,H=h.next,I?gL(h,E,T,I):vL(h))p.push(B.i/m),p.push(h.i/m),p.push(H.i/m),md(h),h=H.next,G=H.next;else if((h=H)===G){P?P===1?j0(h=mL(dp(h),p,m),p,m,E,T,I,2):P===2&&yL(h,p,m,E,T,I):j0(dp(h),p,m,E,T,I,1);break}}}function vL(h){var p=h.prev,m=h,E=h.next;if(oo(p,m,E)>=0)return!1;for(var T=h.next.next;T!==h.prev;){if(pp(p.x,p.y,m.x,m.y,E.x,E.y,T.x,T.y)&&oo(T.prev,T,T.next)>=0)return!1;T=T.next}return!0}function gL(h,p,m,E){var T=h.prev,I=h,P=h.next;if(oo(T,I,P)>=0)return!1;for(var B=T.x>I.x?T.x>P.x?T.x:P.x:I.x>P.x?I.x:P.x,H=T.y>I.y?T.y>P.y?T.y:P.y:I.y>P.y?I.y:P.y,G=qg(T.x<I.x?T.x<P.x?T.x:P.x:I.x<P.x?I.x:P.x,T.y<I.y?T.y<P.y?T.y:P.y:I.y<P.y?I.y:P.y,p,m,E),Z=qg(B,H,p,m,E),K=h.prevZ,nt=h.nextZ;K&&K.z>=G&&nt&&nt.z<=Z;){if(K!==h.prev&&K!==h.next&&pp(T.x,T.y,I.x,I.y,P.x,P.y,K.x,K.y)&&oo(K.prev,K,K.next)>=0||(K=K.prevZ,nt!==h.prev&&nt!==h.next&&pp(T.x,T.y,I.x,I.y,P.x,P.y,nt.x,nt.y)&&oo(nt.prev,nt,nt.next)>=0))return!1;nt=nt.nextZ}for(;K&&K.z>=G;){if(K!==h.prev&&K!==h.next&&pp(T.x,T.y,I.x,I.y,P.x,P.y,K.x,K.y)&&oo(K.prev,K,K.next)>=0)return!1;K=K.prevZ}for(;nt&&nt.z<=Z;){if(nt!==h.prev&&nt!==h.next&&pp(T.x,T.y,I.x,I.y,P.x,P.y,nt.x,nt.y)&&oo(nt.prev,nt,nt.next)>=0)return!1;nt=nt.nextZ}return!0}function mL(h,p,m){var E=h;do{var T=E.prev,I=E.next.next;!Sv(T,I)&&r1(T,E,E.next,I)&&vp(T,I)&&vp(I,T)&&(p.push(T.i/m),p.push(E.i/m),p.push(I.i/m),md(E),md(E.next),E=h=I),E=E.next}while(E!==h);return dp(E)}function yL(h,p,m,E,T,I){var P=h;do{for(var B=P.next.next;B!==P.prev;){if(P.i!==B.i&&e1(P,B)){var H=Kg(P,B);return P=dp(P,P.next),H=dp(H,H.next),j0(P,p,m,E,T,I),void j0(H,p,m,E,T,I)}B=B.next}P=P.next}while(P!==h)}function _L(h,p){return h.x-p.x}function Kb(h,p){if(p=function(E,T){var I,P=T,B=E.x,H=E.y,G=-1/0;do{if(H<=P.y&&H>=P.next.y&&P.next.y!==P.y){var Z=P.x+(H-P.y)*(P.next.x-P.x)/(P.next.y-P.y);if(Z<=B&&Z>G){if(G=Z,Z===B){if(H===P.y)return P;if(H===P.next.y)return P.next}I=P.x<P.next.x?P:P.next}}P=P.next}while(P!==T);if(!I)return null;if(B===G)return I;var K,nt=I,lt=I.x,St=I.y,Rt=1/0;P=I;do B>=P.x&&P.x>=lt&&B!==P.x&&pp(H<St?B:G,H,lt,St,H<St?G:B,H,P.x,P.y)&&(K=Math.abs(H-P.y)/(B-P.x),vp(P,E)&&(K<Rt||K===Rt&&(P.x>I.x||P.x===I.x&&J_(I,P)))&&(I=P,Rt=K)),P=P.next;while(P!==nt);return I}(h,p)){var m=Kg(p,h);dp(p,p.next),dp(m,m.next)}}function J_(h,p){return oo(h.prev,h,p.prev)<0&&oo(p.next,h,h.next)<0}function qg(h,p,m,E,T){return(h=1431655765&((h=858993459&((h=252645135&((h=16711935&((h=32767*(h-m)*T)|h<<8))|h<<4))|h<<2))|h<<1))|(p=1431655765&((p=858993459&((p=252645135&((p=16711935&((p=32767*(p-E)*T)|p<<8))|p<<4))|p<<2))|p<<1))<<1}function t1(h){var p=h,m=h;do(p.x<m.x||p.x===m.x&&p.y<m.y)&&(m=p),p=p.next;while(p!==h);return m}function pp(h,p,m,E,T,I,P,B){return(T-P)*(p-B)-(h-P)*(I-B)>=0&&(h-P)*(E-B)-(m-P)*(p-B)>=0&&(m-P)*(I-B)-(T-P)*(E-B)>=0}function e1(h,p){return h.next.i!==p.i&&h.prev.i!==p.i&&!function(m,E){var T=m;do{if(T.i!==m.i&&T.next.i!==m.i&&T.i!==E.i&&T.next.i!==E.i&&r1(T,T.next,m,E))return!0;T=T.next}while(T!==m);return!1}(h,p)&&(vp(h,p)&&vp(p,h)&&function(m,E){var T=m,I=!1,P=(m.x+E.x)/2,B=(m.y+E.y)/2;do T.y>B!=T.next.y>B&&T.next.y!==T.y&&P<(T.next.x-T.x)*(B-T.y)/(T.next.y-T.y)+T.x&&(I=!I),T=T.next;while(T!==m);return I}(h,p)&&(oo(h.prev,h,p.prev)||oo(h,p.prev,p))||Sv(h,p)&&oo(h.prev,h,h.next)>0&&oo(p.prev,p,p.next)>0)}function oo(h,p,m){return(p.y-h.y)*(m.x-p.x)-(p.x-h.x)*(m.y-p.y)}function Sv(h,p){return h.x===p.x&&h.y===p.y}function r1(h,p,m,E){var T=Av(oo(h,p,m)),I=Av(oo(h,p,E)),P=Av(oo(m,E,h)),B=Av(oo(m,E,p));return T!==I&&P!==B||!(T!==0||!Tv(h,m,p))||!(I!==0||!Tv(h,E,p))||!(P!==0||!Tv(m,h,E))||!(B!==0||!Tv(m,p,E))}function Tv(h,p,m){return p.x<=Math.max(h.x,m.x)&&p.x>=Math.min(h.x,m.x)&&p.y<=Math.max(h.y,m.y)&&p.y>=Math.min(h.y,m.y)}function Av(h){return h>0?1:h<0?-1:0}function vp(h,p){return oo(h.prev,h,h.next)<0?oo(h,p,h.next)>=0&&oo(h,h.prev,p)>=0:oo(h,p,h.prev)<0||oo(h,h.next,p)<0}function Kg(h,p){var m=new Mv(h.i,h.x,h.y),E=new Mv(p.i,p.x,p.y),T=h.next,I=p.prev;return h.next=p,p.prev=h,m.next=T,T.prev=m,E.next=m,m.prev=E,I.next=E,E.prev=I,E}function Qg(h,p,m,E){var T=new Mv(h,p,m);return E?(T.next=E.next,T.prev=E,E.next.prev=T,E.next=T):(T.prev=T,T.next=T),T}function md(h){h.next.prev=h.prev,h.prev.next=h.next,h.prevZ&&(h.prevZ.nextZ=h.nextZ),h.nextZ&&(h.nextZ.prevZ=h.prevZ)}function Mv(h,p,m){this.i=h,this.x=p,this.y=m,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Rv(h,p,m,E){for(var T=0,I=p,P=m-E;I<m;I+=E)T+=(h[P]-h[I])*(h[I+1]+h[P+1]),P=I;return T}function h2(h,p,m,E,T){(function I(P,B,H,G,Z){for(;G>H;){if(G-H>600){var K=G-H+1,nt=B-H+1,lt=Math.log(K),St=.5*Math.exp(2*lt/3),Rt=.5*Math.sqrt(lt*St*(K-St)/K)*(nt-K/2<0?-1:1);I(P,B,Math.max(H,Math.floor(B-nt*St/K+Rt)),Math.min(G,Math.floor(B+(K-nt)*St/K+Rt)),Z)}var Gt=P[B],Nt=H,ne=G;for(yd(P,H,B),Z(P[G],Gt)>0&&yd(P,H,G);Nt<ne;){for(yd(P,Nt,ne),Nt++,ne--;Z(P[Nt],Gt)<0;)Nt++;for(;Z(P[ne],Gt)>0;)ne--}Z(P[H],Gt)===0?yd(P,H,ne):yd(P,++ne,G),ne<=B&&(H=ne+1),B<=ne&&(G=ne-1)}})(h,p,m||0,E||h.length-1,T||Iv)}function yd(h,p,m){var E=h[p];h[p]=h[m],h[m]=E}function Iv(h,p){return h<p?-1:h>p?1:0}function n1(h,p){var m=h.length;if(m<=1)return[h];for(var E,T,I=[],P=0;P<m;P++){var B=Tt(h[P]);B!==0&&(h[P].area=Math.abs(B),T===void 0&&(T=B<0),T===B<0?(E&&I.push(E),E=[h[P]]):E.push(h[P]))}if(E&&I.push(E),p>1)for(var H=0;H<I.length;H++)I[H].length<=p||(h2(I[H],p,1,I[H].length-1,Qb),I[H]=I[H].slice(0,p));return I}function Qb(h,p){return p.area-h.area}function Jb(h,p,m){for(var E=m.patternDependencies,T=!1,I=0,P=p;I<P.length;I+=1){var B=P[I].paint.get(h+"-pattern");B.isConstant()||(T=!0);var H=B.constantOr(null);H&&(T=!0,E[H.to]=!0,E[H.from]=!0)}return T}function tE(h,p,m,E,T){for(var I=T.patternDependencies,P=0,B=p;P<B.length;P+=1){var H=B[P],G=H.paint.get(h+"-pattern").value;if(G.kind!=="constant"){var Z=G.evaluate({zoom:E-1},m,{},T.availableImages),K=G.evaluate({zoom:E},m,{},T.availableImages),nt=G.evaluate({zoom:E+1},m,{},T.availableImages);K=K&&K.name?K.name:K,nt=nt&&nt.name?nt.name:nt,I[Z=Z&&Z.name?Z.name:Z]=!0,I[K]=!0,I[nt]=!0,m.patterns[H.id]={min:Z,mid:K,max:nt}}}return m}Q_.deviation=function(h,p,m,E){var T=p&&p.length,I=Math.abs(Rv(h,0,T?p[0]*m:h.length,m));if(T)for(var P=0,B=p.length;P<B;P++)I-=Math.abs(Rv(h,p[P]*m,P<B-1?p[P+1]*m:h.length,m));var H=0;for(P=0;P<E.length;P+=3){var G=E[P]*m,Z=E[P+1]*m,K=E[P+2]*m;H+=Math.abs((h[G]-h[K])*(h[Z+1]-h[G+1])-(h[G]-h[Z])*(h[K+1]-h[G+1]))}return I===0&&H===0?0:Math.abs((H-I)/I)},Q_.flatten=function(h){for(var p=h[0][0].length,m={vertices:[],holes:[],dimensions:p},E=0,T=0;T<h.length;T++){for(var I=0;I<h[T].length;I++)for(var P=0;P<p;P++)m.vertices.push(h[T][I][P]);T>0&&m.holes.push(E+=h[T-1].length)}return m},K_.default=pL;var Eh=function(h){this.zoom=h.zoom,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(function(p){return p.id}),this.index=h.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new vf,this.indexArray=new wc,this.indexArray2=new Cv,this.programConfigurations=new bn(h.layers,h.zoom),this.segments=new ht,this.segments2=new ht,this.stateDependentLayerIds=this.layers.filter(function(p){return p.isStateDependent()}).map(function(p){return p.id})};Eh.prototype.populate=function(h,p,m){this.hasPattern=Jb("fill",this.layers,p);for(var E=this.layers[0].layout.get("fill-sort-key"),T=[],I=0,P=h;I<P.length;I+=1){var B=P[I],H=B.feature,G=B.id,Z=B.index,K=B.sourceLayerIndex,nt=this.layers[0]._featureFilter.needGeometry,lt=Ya(H,nt);if(this.layers[0]._featureFilter.filter(new Vn(this.zoom),lt,m)){var St=E?E.evaluate(lt,{},m,p.availableImages):void 0,Rt={id:G,properties:H.properties,type:H.type,sourceLayerIndex:K,index:Z,geometry:nt?lt.geometry:Ga(H),patterns:{},sortKey:St};T.push(Rt)}}E&&T.sort(function(sr,yr){return sr.sortKey-yr.sortKey});for(var Gt=0,Nt=T;Gt<Nt.length;Gt+=1){var ne=Nt[Gt],le=ne.geometry,xe=ne.index,we=ne.sourceLayerIndex;if(this.hasPattern){var $e=tE("fill",this.layers,ne,this.zoom,p);this.patternFeatures.push($e)}else this.addFeature(ne,le,xe,m,{});p.featureIndex.insert(h[xe].feature,le,xe,we,this.index)}},Eh.prototype.update=function(h,p,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(h,p,this.stateDependentLayers,m)},Eh.prototype.addFeatures=function(h,p,m){for(var E=0,T=this.patternFeatures;E<T.length;E+=1){var I=T[E];this.addFeature(I,I.geometry,I.index,p,m)}},Eh.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Eh.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Eh.prototype.upload=function(h){this.uploaded||(this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,dL),this.indexBuffer=h.createIndexBuffer(this.indexArray),this.indexBuffer2=h.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(h),this.uploaded=!0},Eh.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Eh.prototype.addFeature=function(h,p,m,E,T){for(var I=0,P=n1(p,500);I<P.length;I+=1){for(var B=P[I],H=0,G=0,Z=B;G<Z.length;G+=1)H+=Z[G].length;for(var K=this.segments.prepareSegment(H,this.layoutVertexArray,this.indexArray),nt=K.vertexLength,lt=[],St=[],Rt=0,Gt=B;Rt<Gt.length;Rt+=1){var Nt=Gt[Rt];if(Nt.length!==0){Nt!==B[0]&&St.push(lt.length/2);var ne=this.segments2.prepareSegment(Nt.length,this.layoutVertexArray,this.indexArray2),le=ne.vertexLength;this.layoutVertexArray.emplaceBack(Nt[0].x,Nt[0].y),this.indexArray2.emplaceBack(le+Nt.length-1,le),lt.push(Nt[0].x),lt.push(Nt[0].y);for(var xe=1;xe<Nt.length;xe++)this.layoutVertexArray.emplaceBack(Nt[xe].x,Nt[xe].y),this.indexArray2.emplaceBack(le+xe-1,le+xe),lt.push(Nt[xe].x),lt.push(Nt[xe].y);ne.vertexLength+=Nt.length,ne.primitiveLength+=Nt.length}}for(var we=K_(lt,St),$e=0;$e<we.length;$e+=3)this.indexArray.emplaceBack(nt+we[$e],nt+we[$e+1],nt+we[$e+2]);K.vertexLength+=H,K.primitiveLength+=we.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,h,m,T,E)},Wr("FillBucket",Eh,{omit:["layers","patternFeatures"]});var gp=new Va({"fill-sort-key":new Zr(ct.layout_fill["fill-sort-key"])}),f2={paint:new Va({"fill-antialias":new on(ct.paint_fill["fill-antialias"]),"fill-opacity":new Zr(ct.paint_fill["fill-opacity"]),"fill-color":new Zr(ct.paint_fill["fill-color"]),"fill-outline-color":new Zr(ct.paint_fill["fill-outline-color"]),"fill-translate":new on(ct.paint_fill["fill-translate"]),"fill-translate-anchor":new on(ct.paint_fill["fill-translate-anchor"]),"fill-pattern":new Rl(ct.paint_fill["fill-pattern"])}),layout:gp},d2=function(h){function p(m){h.call(this,m,f2)}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype.recalculate=function(m,E){h.prototype.recalculate.call(this,m,E);var T=this.paint._values["fill-outline-color"];T.value.kind==="constant"&&T.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},p.prototype.createBucket=function(m){return new Eh(m)},p.prototype.queryRadius=function(){return ao(this.paint.get("fill-translate"))},p.prototype.queryIntersectsFeature=function(m,E,T,I,P,B,H){return Su(sl(m,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),B.angle,H),I)},p.prototype.isTileClipped=function(){return!0},p}(wu),p2=Wo([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,v2=Lv;function Lv(h,p,m,E,T){this.properties={},this.extent=m,this.type=0,this._pbf=h,this._geometry=-1,this._keys=E,this._values=T,h.readFields(xL,this,p)}function xL(h,p,m){h==1?p.id=m.readVarint():h==2?function(E,T){for(var I=E.readVarint()+E.pos;E.pos<I;){var P=T._keys[E.readVarint()],B=T._values[E.readVarint()];T.properties[P]=B}}(m,p):h==3?p.type=m.readVarint():h==4&&(p._geometry=m.pos)}function xf(h){for(var p,m,E=0,T=0,I=h.length,P=I-1;T<I;P=T++)E+=((m=h[P]).x-(p=h[T]).x)*(p.y+m.y);return E}Lv.types=["Unknown","Point","LineString","Polygon"],Lv.prototype.loadGeometry=function(){var h=this._pbf;h.pos=this._geometry;for(var p,m=h.readVarint()+h.pos,E=1,T=0,I=0,P=0,B=[];h.pos<m;){if(T<=0){var H=h.readVarint();E=7&H,T=H>>3}if(T--,E===1||E===2)I+=h.readSVarint(),P+=h.readSVarint(),E===1&&(p&&B.push(p),p=[]),p.push(new c(I,P));else{if(E!==7)throw new Error("unknown command "+E);p&&p.push(p[0].clone())}}return p&&B.push(p),B},Lv.prototype.bbox=function(){var h=this._pbf;h.pos=this._geometry;for(var p=h.readVarint()+h.pos,m=1,E=0,T=0,I=0,P=1/0,B=-1/0,H=1/0,G=-1/0;h.pos<p;){if(E<=0){var Z=h.readVarint();m=7&Z,E=Z>>3}if(E--,m===1||m===2)(T+=h.readSVarint())<P&&(P=T),T>B&&(B=T),(I+=h.readSVarint())<H&&(H=I),I>G&&(G=I);else if(m!==7)throw new Error("unknown command "+m)}return[P,H,B,G]},Lv.prototype.toGeoJSON=function(h,p,m){var E,T,I=this.extent*Math.pow(2,m),P=this.extent*h,B=this.extent*p,H=this.loadGeometry(),G=Lv.types[this.type];function Z(lt){for(var St=0;St<lt.length;St++){var Rt=lt[St];lt[St]=[360*(Rt.x+P)/I-180,360/Math.PI*Math.atan(Math.exp((180-360*(Rt.y+B)/I)*Math.PI/180))-90]}}switch(this.type){case 1:var K=[];for(E=0;E<H.length;E++)K[E]=H[E][0];Z(H=K);break;case 2:for(E=0;E<H.length;E++)Z(H[E]);break;case 3:for(H=function(lt){var St=lt.length;if(St<=1)return[lt];for(var Rt,Gt,Nt=[],ne=0;ne<St;ne++){var le=xf(lt[ne]);le!==0&&(Gt===void 0&&(Gt=le<0),Gt===le<0?(Rt&&Nt.push(Rt),Rt=[lt[ne]]):Rt.push(lt[ne]))}return Rt&&Nt.push(Rt),Nt}(H),E=0;E<H.length;E++)for(T=0;T<H[E].length;T++)Z(H[E][T])}H.length===1?H=H[0]:G="Multi"+G;var nt={type:"Feature",geometry:{type:G,coordinates:H},properties:this.properties};return"id"in this&&(nt.id=this.id),nt};var eE=Ov;function Ov(h,p){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=h,this._keys=[],this._values=[],this._features=[],h.readFields(mp,this,p),this.length=this._features.length}function mp(h,p,m){h===15?p.version=m.readVarint():h===1?p.name=m.readString():h===5?p.extent=m.readVarint():h===2?p._features.push(m.pos):h===3?p._keys.push(m.readString()):h===4&&p._values.push(function(E){for(var T=null,I=E.readVarint()+E.pos;E.pos<I;){var P=E.readVarint()>>3;T=P===1?E.readString():P===2?E.readFloat():P===3?E.readDouble():P===4?E.readVarint64():P===5?E.readVarint():P===6?E.readSVarint():P===7?E.readBoolean():null}return T}(m))}function g2(h,p,m){if(h===3){var E=new eE(m,m.readVarint()+m.pos);E.length&&(p[E.name]=E)}}Ov.prototype.feature=function(h){if(h<0||h>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[h];var p=this._pbf.readVarint()+this._pbf.pos;return new v2(this._pbf,p,this.extent,this._keys,this._values)};var yp={VectorTile:function(h,p){this.layers=h.readFields(g2,{},p)},VectorTileFeature:v2,VectorTileLayer:eE},i1=yp.VectorTileFeature.types,a1=Math.pow(2,13);function ul(h,p,m,E,T,I,P,B){h.emplaceBack(p,m,2*Math.floor(E*a1)+P,T*a1*2,I*a1*2,Math.round(B))}var Ks=function(h){this.zoom=h.zoom,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(function(p){return p.id}),this.index=h.index,this.hasPattern=!1,this.layoutVertexArray=new xh,this.indexArray=new wc,this.programConfigurations=new bn(h.layers,h.zoom),this.segments=new ht,this.stateDependentLayerIds=this.layers.filter(function(p){return p.isStateDependent()}).map(function(p){return p.id})};function jo(h,p){return h.x===p.x&&(h.x<0||h.x>8192)||h.y===p.y&&(h.y<0||h.y>8192)}Ks.prototype.populate=function(h,p,m){this.features=[],this.hasPattern=Jb("fill-extrusion",this.layers,p);for(var E=0,T=h;E<T.length;E+=1){var I=T[E],P=I.feature,B=I.id,H=I.index,G=I.sourceLayerIndex,Z=this.layers[0]._featureFilter.needGeometry,K=Ya(P,Z);if(this.layers[0]._featureFilter.filter(new Vn(this.zoom),K,m)){var nt={id:B,sourceLayerIndex:G,index:H,geometry:Z?K.geometry:Ga(P),properties:P.properties,type:P.type,patterns:{}};this.hasPattern?this.features.push(tE("fill-extrusion",this.layers,nt,this.zoom,p)):this.addFeature(nt,nt.geometry,H,m,{}),p.featureIndex.insert(P,nt.geometry,H,G,this.index,!0)}}},Ks.prototype.addFeatures=function(h,p,m){for(var E=0,T=this.features;E<T.length;E+=1){var I=T[E];this.addFeature(I,I.geometry,I.index,p,m)}},Ks.prototype.update=function(h,p,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(h,p,this.stateDependentLayers,m)},Ks.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ks.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ks.prototype.upload=function(h){this.uploaded||(this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,p2),this.indexBuffer=h.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(h),this.uploaded=!0},Ks.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ks.prototype.addFeature=function(h,p,m,E,T){for(var I=0,P=n1(p,500);I<P.length;I+=1){for(var B=P[I],H=0,G=0,Z=B;G<Z.length;G+=1)H+=Z[G].length;for(var K=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),nt=0,lt=B;nt<lt.length;nt+=1){var St=lt[nt];if(St.length!==0&&!((gi=St).every(function(Zn){return Zn.x<0})||gi.every(function(Zn){return Zn.x>8192})||gi.every(function(Zn){return Zn.y<0})||gi.every(function(Zn){return Zn.y>8192})))for(var Rt=0,Gt=0;Gt<St.length;Gt++){var Nt=St[Gt];if(Gt>=1){var ne=St[Gt-1];if(!jo(Nt,ne)){K.vertexLength+4>ht.MAX_VERTEX_ARRAY_LENGTH&&(K=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var le=Nt.sub(ne)._perp()._unit(),xe=ne.dist(Nt);Rt+xe>32768&&(Rt=0),ul(this.layoutVertexArray,Nt.x,Nt.y,le.x,le.y,0,0,Rt),ul(this.layoutVertexArray,Nt.x,Nt.y,le.x,le.y,0,1,Rt),ul(this.layoutVertexArray,ne.x,ne.y,le.x,le.y,0,0,Rt+=xe),ul(this.layoutVertexArray,ne.x,ne.y,le.x,le.y,0,1,Rt);var we=K.vertexLength;this.indexArray.emplaceBack(we,we+2,we+1),this.indexArray.emplaceBack(we+1,we+2,we+3),K.vertexLength+=4,K.primitiveLength+=2}}}}if(K.vertexLength+H>ht.MAX_VERTEX_ARRAY_LENGTH&&(K=this.segments.prepareSegment(H,this.layoutVertexArray,this.indexArray)),i1[h.type]==="Polygon"){for(var $e=[],sr=[],yr=K.vertexLength,ln=0,Dr=B;ln<Dr.length;ln+=1){var pn=Dr[ln];if(pn.length!==0){pn!==B[0]&&sr.push($e.length/2);for(var zr=0;zr<pn.length;zr++){var li=pn[zr];ul(this.layoutVertexArray,li.x,li.y,0,0,1,1,0),$e.push(li.x),$e.push(li.y)}}}for(var In=K_($e,sr),Kr=0;Kr<In.length;Kr+=3)this.indexArray.emplaceBack(yr+In[Kr],yr+In[Kr+2],yr+In[Kr+1]);K.primitiveLength+=In.length/3,K.vertexLength+=H}}var gi;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,h,m,T,E)},Wr("FillExtrusionBucket",Ks,{omit:["layers","features"]});var Au={paint:new Va({"fill-extrusion-opacity":new on(ct["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Zr(ct["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new on(ct["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new on(ct["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Rl(ct["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Zr(ct["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Zr(ct["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new on(ct["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},m2=function(h){function p(m){h.call(this,m,Au)}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype.createBucket=function(m){return new Ks(m)},p.prototype.queryRadius=function(){return ao(this.paint.get("fill-extrusion-translate"))},p.prototype.is3D=function(){return!0},p.prototype.queryIntersectsFeature=function(m,E,T,I,P,B,H,G){var Z=sl(m,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),B.angle,H),K=this.paint.get("fill-extrusion-height").evaluate(E,T),nt=this.paint.get("fill-extrusion-base").evaluate(E,T),lt=function(Rt,Gt,Nt,ne){for(var le=[],xe=0,we=Rt;xe<we.length;xe+=1){var $e=we[xe],sr=[$e.x,$e.y,0,1];_f(sr,sr,Gt),le.push(new c(sr[0]/sr[3],sr[1]/sr[3]))}return le}(Z,G),St=function(Rt,Gt,Nt,ne){for(var le=[],xe=[],we=ne[8]*Gt,$e=ne[9]*Gt,sr=ne[10]*Gt,yr=ne[11]*Gt,ln=ne[8]*Nt,Dr=ne[9]*Nt,pn=ne[10]*Nt,zr=ne[11]*Nt,li=0,In=Rt;li<In.length;li+=1){for(var Kr=[],gi=[],Zn=0,Bi=In[li];Zn<Bi.length;Zn+=1){var gn=Bi[Zn],Yi=gn.x,qa=gn.y,bo=ne[0]*Yi+ne[4]*qa+ne[12],go=ne[1]*Yi+ne[5]*qa+ne[13],Ka=ne[2]*Yi+ne[6]*qa+ne[14],Eo=ne[3]*Yi+ne[7]*qa+ne[15],As=Ka+sr,Ms=Eo+yr,Ol=bo+ln,Us=go+Dr,Pl=Ka+pn,Po=Eo+zr,$s=new c((bo+we)/Ms,(go+$e)/Ms);$s.z=As/Ms,Kr.push($s);var Si=new c(Ol/Po,Us/Po);Si.z=Pl/Po,gi.push(Si)}le.push(Kr),xe.push(gi)}return[le,xe]}(I,nt,K,G);return function(Rt,Gt,Nt){var ne=1/0;Su(Nt,Gt)&&(ne=y2(Nt,Gt[0]));for(var le=0;le<Gt.length;le++)for(var xe=Gt[le],we=Rt[le],$e=0;$e<xe.length-1;$e++){var sr=xe[$e],yr=[sr,xe[$e+1],we[$e+1],we[$e],sr];Cc(Nt,yr)&&(ne=Math.min(ne,y2(Nt,yr)))}return ne!==1/0&&ne}(St[0],St[1],lt)},p}(wu);function Y0(h,p){return h.x*p.x+h.y*p.y}function y2(h,p){if(h.length===1){for(var m,E=0,T=p[E++];!m||T.equals(m);)if(!(m=p[E++]))return 1/0;for(;E<p.length;E++){var I=p[E],P=h[0],B=m.sub(T),H=I.sub(T),G=P.sub(T),Z=Y0(B,B),K=Y0(B,H),nt=Y0(H,H),lt=Y0(G,B),St=Y0(G,H),Rt=Z*nt-K*K,Gt=(nt*lt-K*St)/Rt,Nt=(Z*St-K*lt)/Rt,ne=T.z*(1-Gt-Nt)+m.z*Gt+I.z*Nt;if(isFinite(ne))return ne}return 1/0}for(var le=1/0,xe=0,we=p;xe<we.length;xe+=1)le=Math.min(le,we[xe].z);return le}var bL=Wo([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,EL=Wo([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,_2=yp.VectorTileFeature.types,wL=Math.cos(Math.PI/180*37.5),x2=Math.pow(2,14)/.5,cl=function(h){var p=this;this.zoom=h.zoom,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(function(m){return m.id}),this.index=h.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(m){p.gradients[m.id]={}}),this.layoutVertexArray=new Il,this.layoutVertexArray2=new up,this.indexArray=new wc,this.programConfigurations=new bn(h.layers,h.zoom),this.segments=new ht,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(m){return m.isStateDependent()}).map(function(m){return m.id})};cl.prototype.populate=function(h,p,m){this.hasPattern=Jb("line",this.layers,p);for(var E=this.layers[0].layout.get("line-sort-key"),T=[],I=0,P=h;I<P.length;I+=1){var B=P[I],H=B.feature,G=B.id,Z=B.index,K=B.sourceLayerIndex,nt=this.layers[0]._featureFilter.needGeometry,lt=Ya(H,nt);if(this.layers[0]._featureFilter.filter(new Vn(this.zoom),lt,m)){var St=E?E.evaluate(lt,{},m):void 0,Rt={id:G,properties:H.properties,type:H.type,sourceLayerIndex:K,index:Z,geometry:nt?lt.geometry:Ga(H),patterns:{},sortKey:St};T.push(Rt)}}E&&T.sort(function(sr,yr){return sr.sortKey-yr.sortKey});for(var Gt=0,Nt=T;Gt<Nt.length;Gt+=1){var ne=Nt[Gt],le=ne.geometry,xe=ne.index,we=ne.sourceLayerIndex;if(this.hasPattern){var $e=tE("line",this.layers,ne,this.zoom,p);this.patternFeatures.push($e)}else this.addFeature(ne,le,xe,m,{});p.featureIndex.insert(h[xe].feature,le,xe,we,this.index)}},cl.prototype.update=function(h,p,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(h,p,this.stateDependentLayers,m)},cl.prototype.addFeatures=function(h,p,m){for(var E=0,T=this.patternFeatures;E<T.length;E+=1){var I=T[E];this.addFeature(I,I.geometry,I.index,p,m)}},cl.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},cl.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},cl.prototype.upload=function(h){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=h.createVertexBuffer(this.layoutVertexArray2,EL)),this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,bL),this.indexBuffer=h.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(h),this.uploaded=!0},cl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},cl.prototype.lineFeatureClips=function(h){if(h.properties&&h.properties.hasOwnProperty("mapbox_clip_start")&&h.properties.hasOwnProperty("mapbox_clip_end"))return{start:+h.properties.mapbox_clip_start,end:+h.properties.mapbox_clip_end}},cl.prototype.addFeature=function(h,p,m,E,T){var I=this.layers[0].layout,P=I.get("line-join").evaluate(h,{}),B=I.get("line-cap"),H=I.get("line-miter-limit"),G=I.get("line-round-limit");this.lineClips=this.lineFeatureClips(h);for(var Z=0,K=p;Z<K.length;Z+=1)this.addLine(K[Z],h,P,B,H,G);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,h,m,T,E)},cl.prototype.addLine=function(h,p,m,E,T,I){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var P=0;P<h.length-1;P++)this.totalDistance+=h[P].dist(h[P+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var B=_2[p.type]==="Polygon",H=h.length;H>=2&&h[H-1].equals(h[H-2]);)H--;for(var G=0;G<H-1&&h[G].equals(h[G+1]);)G++;if(!(H<(B?3:2))){m==="bevel"&&(T=1.05);var Z,K=this.overscaling<=16?122880/(512*this.overscaling):0,nt=this.segments.prepareSegment(10*H,this.layoutVertexArray,this.indexArray),lt=void 0,St=void 0,Rt=void 0,Gt=void 0;this.e1=this.e2=-1,B&&(Gt=h[G].sub(Z=h[H-2])._unit()._perp());for(var Nt=G;Nt<H;Nt++)if(!(St=Nt===H-1?B?h[G+1]:void 0:h[Nt+1])||!h[Nt].equals(St)){Gt&&(Rt=Gt),Z&&(lt=Z),Z=h[Nt],Gt=St?St.sub(Z)._unit()._perp():Rt;var ne=(Rt=Rt||Gt).add(Gt);ne.x===0&&ne.y===0||ne._unit();var le=Rt.x*Gt.x+Rt.y*Gt.y,xe=ne.x*Gt.x+ne.y*Gt.y,we=xe!==0?1/xe:1/0,$e=2*Math.sqrt(2-2*xe),sr=xe<wL&&lt&&St,yr=Rt.x*Gt.y-Rt.y*Gt.x>0;if(sr&&Nt>G){var ln=Z.dist(lt);if(ln>2*K){var Dr=Z.sub(Z.sub(lt)._mult(K/ln)._round());this.updateDistance(lt,Dr),this.addCurrentVertex(Dr,Rt,0,0,nt),lt=Dr}}var pn=lt&&St,zr=pn?m:B?"butt":E;if(pn&&zr==="round"&&(we<I?zr="miter":we<=2&&(zr="fakeround")),zr==="miter"&&we>T&&(zr="bevel"),zr==="bevel"&&(we>2&&(zr="flipbevel"),we<T&&(zr="miter")),lt&&this.updateDistance(lt,Z),zr==="miter")ne._mult(we),this.addCurrentVertex(Z,ne,0,0,nt);else if(zr==="flipbevel"){if(we>100)ne=Gt.mult(-1);else{var li=we*Rt.add(Gt).mag()/Rt.sub(Gt).mag();ne._perp()._mult(li*(yr?-1:1))}this.addCurrentVertex(Z,ne,0,0,nt),this.addCurrentVertex(Z,ne.mult(-1),0,0,nt)}else if(zr==="bevel"||zr==="fakeround"){var In=-Math.sqrt(we*we-1),Kr=yr?In:0,gi=yr?0:In;if(lt&&this.addCurrentVertex(Z,Rt,Kr,gi,nt),zr==="fakeround")for(var Zn=Math.round(180*$e/Math.PI/20),Bi=1;Bi<Zn;Bi++){var gn=Bi/Zn;if(gn!==.5){var Yi=gn-.5;gn+=gn*Yi*(gn-1)*((1.0904+le*(le*(3.55645-1.43519*le)-3.2452))*Yi*Yi+(.848013+le*(.215638*le-1.06021)))}var qa=Gt.sub(Rt)._mult(gn)._add(Rt)._unit()._mult(yr?-1:1);this.addHalfVertex(Z,qa.x,qa.y,!1,yr,0,nt)}St&&this.addCurrentVertex(Z,Gt,-Kr,-gi,nt)}else if(zr==="butt")this.addCurrentVertex(Z,ne,0,0,nt);else if(zr==="square"){var bo=lt?1:-1;this.addCurrentVertex(Z,ne,bo,bo,nt)}else zr==="round"&&(lt&&(this.addCurrentVertex(Z,Rt,0,0,nt),this.addCurrentVertex(Z,Rt,1,1,nt,!0)),St&&(this.addCurrentVertex(Z,Gt,-1,-1,nt,!0),this.addCurrentVertex(Z,Gt,0,0,nt)));if(sr&&Nt<H-1){var go=Z.dist(St);if(go>2*K){var Ka=Z.add(St.sub(Z)._mult(K/go)._round());this.updateDistance(Z,Ka),this.addCurrentVertex(Ka,Gt,0,0,nt),Z=Ka}}}}},cl.prototype.addCurrentVertex=function(h,p,m,E,T,I){I===void 0&&(I=!1);var P=p.y*E-p.x,B=-p.y-p.x*E;this.addHalfVertex(h,p.x+p.y*m,p.y-p.x*m,I,!1,m,T),this.addHalfVertex(h,P,B,I,!0,-E,T),this.distance>x2/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(h,p,m,E,T,I))},cl.prototype.addHalfVertex=function(h,p,m,E,T,I,P){var B=.5*(this.lineClips?this.scaledDistance*(x2-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((h.x<<1)+(E?1:0),(h.y<<1)+(T?1:0),Math.round(63*p)+128,Math.round(63*m)+128,1+(I===0?0:I<0?-1:1)|(63&B)<<2,B>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var H=P.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,H),P.primitiveLength++),T?this.e2=H:this.e1=H},cl.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},cl.prototype.updateDistance=function(h,p){this.distance+=h.dist(p),this.updateScaledDistance()},Wr("LineBucket",cl,{omit:["layers","patternFeatures"]});var CL=new Va({"line-cap":new on(ct.layout_line["line-cap"]),"line-join":new Zr(ct.layout_line["line-join"]),"line-miter-limit":new on(ct.layout_line["line-miter-limit"]),"line-round-limit":new on(ct.layout_line["line-round-limit"]),"line-sort-key":new Zr(ct.layout_line["line-sort-key"])}),b2={paint:new Va({"line-opacity":new Zr(ct.paint_line["line-opacity"]),"line-color":new Zr(ct.paint_line["line-color"]),"line-translate":new on(ct.paint_line["line-translate"]),"line-translate-anchor":new on(ct.paint_line["line-translate-anchor"]),"line-width":new Zr(ct.paint_line["line-width"]),"line-gap-width":new Zr(ct.paint_line["line-gap-width"]),"line-offset":new Zr(ct.paint_line["line-offset"]),"line-blur":new Zr(ct.paint_line["line-blur"]),"line-dasharray":new Bs(ct.paint_line["line-dasharray"]),"line-pattern":new Rl(ct.paint_line["line-pattern"]),"line-gradient":new Xu(ct.paint_line["line-gradient"])}),layout:CL},rE=new(function(h){function p(){h.apply(this,arguments)}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype.possiblyEvaluate=function(m,E){return E=new Vn(Math.floor(E.zoom),{now:E.now,fadeDuration:E.fadeDuration,zoomHistory:E.zoomHistory,transition:E.transition}),h.prototype.possiblyEvaluate.call(this,m,E)},p.prototype.evaluate=function(m,E,T,I){return E=A({},E,{zoom:Math.floor(E.zoom)}),h.prototype.evaluate.call(this,m,E,T,I)},p}(Zr))(b2.paint.properties["line-width"].specification);rE.useIntegerZoom=!0;var E2=function(h){function p(m){h.call(this,m,b2),this.gradientVersion=0}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype._handleSpecialPaintPropertyUpdate=function(m){m==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Tl,this.gradientVersion=(this.gradientVersion+1)%v)},p.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},p.prototype.recalculate=function(m,E){h.prototype.recalculate.call(this,m,E),this.paint._values["line-floorwidth"]=rE.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,m)},p.prototype.createBucket=function(m){return new cl(m)},p.prototype.queryRadius=function(m){var E=m,T=nE(Ss("line-width",this,E),Ss("line-gap-width",this,E)),I=Ss("line-offset",this,E);return T/2+Math.abs(I)+ao(this.paint.get("line-translate"))},p.prototype.queryIntersectsFeature=function(m,E,T,I,P,B,H){var G=sl(m,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),B.angle,H),Z=H/2*nE(this.paint.get("line-width").evaluate(E,T),this.paint.get("line-gap-width").evaluate(E,T)),K=this.paint.get("line-offset").evaluate(E,T);return K&&(I=function(nt,lt){for(var St=[],Rt=new c(0,0),Gt=0;Gt<nt.length;Gt++){for(var Nt=nt[Gt],ne=[],le=0;le<Nt.length;le++){var xe=Nt[le],we=Nt[le+1],$e=le===0?Rt:xe.sub(Nt[le-1])._unit()._perp(),sr=le===Nt.length-1?Rt:we.sub(xe)._unit()._perp(),yr=$e._add(sr)._unit();yr._mult(1/(yr.x*sr.x+yr.y*sr.y)),ne.push(yr._mult(lt)._add(xe))}St.push(ne)}return St}(I,K*H)),function(nt,lt,St){for(var Rt=0;Rt<lt.length;Rt++){var Gt=lt[Rt];if(nt.length>=3){for(var Nt=0;Nt<Gt.length;Nt++)if(Yu(nt,Gt[Nt]))return!0}if(Ll(nt,Gt,St))return!0}return!1}(G,I,Z)},p.prototype.isTileClipped=function(){return!0},p}(wu);function nE(h,p){return p>0?p+2*h:h}var SL=Wo([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),TL=Wo([{name:"a_projected_pos",components:3,type:"Float32"}],4),w2=(Wo([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Wo([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),C2=(Wo([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Wo([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),W=Wo([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function yt(h,p,m){return h.sections.forEach(function(E){E.text=function(T,I,P){var B=I.layout.get("text-transform").evaluate(P,{});return B==="uppercase"?T=T.toLocaleUpperCase():B==="lowercase"&&(T=T.toLocaleLowerCase()),Ql.applyArabicShaping&&(T=Ql.applyArabicShaping(T)),T}(E.text,p,m)}),h}Wo([{name:"triangle",components:3,type:"Uint16"}]),Wo([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Wo([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Wo([{type:"Float32",name:"offsetX"}]),Wo([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Ft={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"},ve=function(h,p,m,E,T){var I,P,B=8*T-E-1,H=(1<<B)-1,G=H>>1,Z=-7,K=m?T-1:0,nt=m?-1:1,lt=h[p+K];for(K+=nt,I=lt&(1<<-Z)-1,lt>>=-Z,Z+=B;Z>0;I=256*I+h[p+K],K+=nt,Z-=8);for(P=I&(1<<-Z)-1,I>>=-Z,Z+=E;Z>0;P=256*P+h[p+K],K+=nt,Z-=8);if(I===0)I=1-G;else{if(I===H)return P?NaN:1/0*(lt?-1:1);P+=Math.pow(2,E),I-=G}return(lt?-1:1)*P*Math.pow(2,I-E)},Ne=function(h,p,m,E,T,I){var P,B,H,G=8*I-T-1,Z=(1<<G)-1,K=Z>>1,nt=T===23?Math.pow(2,-24)-Math.pow(2,-77):0,lt=E?0:I-1,St=E?1:-1,Rt=p<0||p===0&&1/p<0?1:0;for(p=Math.abs(p),isNaN(p)||p===1/0?(B=isNaN(p)?1:0,P=Z):(P=Math.floor(Math.log(p)/Math.LN2),p*(H=Math.pow(2,-P))<1&&(P--,H*=2),(p+=P+K>=1?nt/H:nt*Math.pow(2,1-K))*H>=2&&(P++,H/=2),P+K>=Z?(B=0,P=Z):P+K>=1?(B=(p*H-1)*Math.pow(2,T),P+=K):(B=p*Math.pow(2,K-1)*Math.pow(2,T),P=0));T>=8;h[m+lt]=255&B,lt+=St,B/=256,T-=8);for(P=P<<T|B,G+=T;G>0;h[m+lt]=255&P,lt+=St,P/=256,G-=8);h[m+lt-St]|=128*Rt},ye=ue;function ue(h){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(h)?h:new Uint8Array(h||0),this.pos=0,this.type=0,this.length=this.buf.length}ue.Varint=0,ue.Fixed64=1,ue.Bytes=2,ue.Fixed32=5;var nr=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function qe(h){return h.type===ue.Bytes?h.readVarint()+h.pos:h.pos+1}function pr(h,p,m){return m?4294967296*p+(h>>>0):4294967296*(p>>>0)+(h>>>0)}function or(h,p,m){var E=p<=16383?1:p<=2097151?2:p<=268435455?3:Math.floor(Math.log(p)/(7*Math.LN2));m.realloc(E);for(var T=m.pos-1;T>=h;T--)m.buf[T+E]=m.buf[T]}function hr(h,p){for(var m=0;m<h.length;m++)p.writeVarint(h[m])}function mr(h,p){for(var m=0;m<h.length;m++)p.writeSVarint(h[m])}function Ke(h,p){for(var m=0;m<h.length;m++)p.writeFloat(h[m])}function fr(h,p){for(var m=0;m<h.length;m++)p.writeDouble(h[m])}function ie(h,p){for(var m=0;m<h.length;m++)p.writeBoolean(h[m])}function Se(h,p){for(var m=0;m<h.length;m++)p.writeFixed32(h[m])}function ir(h,p){for(var m=0;m<h.length;m++)p.writeSFixed32(h[m])}function Cr(h,p){for(var m=0;m<h.length;m++)p.writeFixed64(h[m])}function We(h,p){for(var m=0;m<h.length;m++)p.writeSFixed64(h[m])}function Rr(h,p){return(h[p]|h[p+1]<<8|h[p+2]<<16)+16777216*h[p+3]}function Je(h,p,m){h[m]=p,h[m+1]=p>>>8,h[m+2]=p>>>16,h[m+3]=p>>>24}function Sr(h,p){return(h[p]|h[p+1]<<8|h[p+2]<<16)+(h[p+3]<<24)}function Xe(h,p,m){h===1&&m.readMessage(br,p)}function br(h,p,m){if(h===3){var E=m.readMessage(fn,{}),T=E.width,I=E.height,P=E.left,B=E.top,H=E.advance;p.push({id:E.id,bitmap:new fp({width:T+6,height:I+6},E.bitmap),metrics:{width:T,height:I,left:P,top:B,advance:H}})}}function fn(h,p,m){h===1?p.id=m.readVarint():h===2?p.bitmap=m.readBytes():h===3?p.width=m.readVarint():h===4?p.height=m.readVarint():h===5?p.left=m.readSVarint():h===6?p.top=m.readSVarint():h===7&&(p.advance=m.readVarint())}function Bn(h){for(var p=0,m=0,E=0,T=h;E<T.length;E+=1){var I=T[E];p+=I.w*I.h,m=Math.max(m,I.w)}h.sort(function(Rt,Gt){return Gt.h-Rt.h});for(var P=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(p/.95)),m),h:1/0}],B=0,H=0,G=0,Z=h;G<Z.length;G+=1)for(var K=Z[G],nt=P.length-1;nt>=0;nt--){var lt=P[nt];if(!(K.w>lt.w||K.h>lt.h)){if(K.x=lt.x,K.y=lt.y,H=Math.max(H,K.y+K.h),B=Math.max(B,K.x+K.w),K.w===lt.w&&K.h===lt.h){var St=P.pop();nt<P.length&&(P[nt]=St)}else K.h===lt.h?(lt.x+=K.w,lt.w-=K.w):K.w===lt.w?(lt.y+=K.h,lt.h-=K.h):(P.push({x:lt.x+K.w,y:lt.y,w:lt.w-K.w,h:K.h}),lt.y+=K.h,lt.h-=K.h);break}}return{w:B,h:H,fill:p/(B*H)||0}}ue.prototype={destroy:function(){this.buf=null},readFields:function(h,p,m){for(m=m||this.length;this.pos<m;){var E=this.readVarint(),T=E>>3,I=this.pos;this.type=7&E,h(T,p,this),this.pos===I&&this.skip(E)}return p},readMessage:function(h,p){return this.readFields(h,p,this.readVarint()+this.pos)},readFixed32:function(){var h=Rr(this.buf,this.pos);return this.pos+=4,h},readSFixed32:function(){var h=Sr(this.buf,this.pos);return this.pos+=4,h},readFixed64:function(){var h=Rr(this.buf,this.pos)+4294967296*Rr(this.buf,this.pos+4);return this.pos+=8,h},readSFixed64:function(){var h=Rr(this.buf,this.pos)+4294967296*Sr(this.buf,this.pos+4);return this.pos+=8,h},readFloat:function(){var h=ve(this.buf,this.pos,!0,23,4);return this.pos+=4,h},readDouble:function(){var h=ve(this.buf,this.pos,!0,52,8);return this.pos+=8,h},readVarint:function(h){var p,m,E=this.buf;return p=127&(m=E[this.pos++]),m<128?p:(p|=(127&(m=E[this.pos++]))<<7,m<128?p:(p|=(127&(m=E[this.pos++]))<<14,m<128?p:(p|=(127&(m=E[this.pos++]))<<21,m<128?p:function(T,I,P){var B,H,G=P.buf;if(B=(112&(H=G[P.pos++]))>>4,H<128||(B|=(127&(H=G[P.pos++]))<<3,H<128)||(B|=(127&(H=G[P.pos++]))<<10,H<128)||(B|=(127&(H=G[P.pos++]))<<17,H<128)||(B|=(127&(H=G[P.pos++]))<<24,H<128)||(B|=(1&(H=G[P.pos++]))<<31,H<128))return pr(T,B,I);throw new Error("Expected varint not more than 10 bytes")}(p|=(15&(m=E[this.pos]))<<28,h,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var h=this.readVarint();return h%2==1?(h+1)/-2:h/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var h=this.readVarint()+this.pos,p=this.pos;return this.pos=h,h-p>=12&&nr?function(m,E,T){return nr.decode(m.subarray(E,T))}(this.buf,p,h):function(m,E,T){for(var I="",P=E;P<T;){var B,H,G,Z=m[P],K=null,nt=Z>239?4:Z>223?3:Z>191?2:1;if(P+nt>T)break;nt===1?Z<128&&(K=Z):nt===2?(192&(B=m[P+1]))==128&&(K=(31&Z)<<6|63&B)<=127&&(K=null):nt===3?(H=m[P+2],(192&(B=m[P+1]))==128&&(192&H)==128&&((K=(15&Z)<<12|(63&B)<<6|63&H)<=2047||K>=55296&&K<=57343)&&(K=null)):nt===4&&(H=m[P+2],G=m[P+3],(192&(B=m[P+1]))==128&&(192&H)==128&&(192&G)==128&&((K=(15&Z)<<18|(63&B)<<12|(63&H)<<6|63&G)<=65535||K>=1114112)&&(K=null)),K===null?(K=65533,nt=1):K>65535&&(K-=65536,I+=String.fromCharCode(K>>>10&1023|55296),K=56320|1023&K),I+=String.fromCharCode(K),P+=nt}return I}(this.buf,p,h)},readBytes:function(){var h=this.readVarint()+this.pos,p=this.buf.subarray(this.pos,h);return this.pos=h,p},readPackedVarint:function(h,p){if(this.type!==ue.Bytes)return h.push(this.readVarint(p));var m=qe(this);for(h=h||[];this.pos<m;)h.push(this.readVarint(p));return h},readPackedSVarint:function(h){if(this.type!==ue.Bytes)return h.push(this.readSVarint());var p=qe(this);for(h=h||[];this.pos<p;)h.push(this.readSVarint());return h},readPackedBoolean:function(h){if(this.type!==ue.Bytes)return h.push(this.readBoolean());var p=qe(this);for(h=h||[];this.pos<p;)h.push(this.readBoolean());return h},readPackedFloat:function(h){if(this.type!==ue.Bytes)return h.push(this.readFloat());var p=qe(this);for(h=h||[];this.pos<p;)h.push(this.readFloat());return h},readPackedDouble:function(h){if(this.type!==ue.Bytes)return h.push(this.readDouble());var p=qe(this);for(h=h||[];this.pos<p;)h.push(this.readDouble());return h},readPackedFixed32:function(h){if(this.type!==ue.Bytes)return h.push(this.readFixed32());var p=qe(this);for(h=h||[];this.pos<p;)h.push(this.readFixed32());return h},readPackedSFixed32:function(h){if(this.type!==ue.Bytes)return h.push(this.readSFixed32());var p=qe(this);for(h=h||[];this.pos<p;)h.push(this.readSFixed32());return h},readPackedFixed64:function(h){if(this.type!==ue.Bytes)return h.push(this.readFixed64());var p=qe(this);for(h=h||[];this.pos<p;)h.push(this.readFixed64());return h},readPackedSFixed64:function(h){if(this.type!==ue.Bytes)return h.push(this.readSFixed64());var p=qe(this);for(h=h||[];this.pos<p;)h.push(this.readSFixed64());return h},skip:function(h){var p=7&h;if(p===ue.Varint)for(;this.buf[this.pos++]>127;);else if(p===ue.Bytes)this.pos=this.readVarint()+this.pos;else if(p===ue.Fixed32)this.pos+=4;else{if(p!==ue.Fixed64)throw new Error("Unimplemented type: "+p);this.pos+=8}},writeTag:function(h,p){this.writeVarint(h<<3|p)},realloc:function(h){for(var p=this.length||16;p<this.pos+h;)p*=2;if(p!==this.length){var m=new Uint8Array(p);m.set(this.buf),this.buf=m,this.length=p}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(h){this.realloc(4),Je(this.buf,h,this.pos),this.pos+=4},writeSFixed32:function(h){this.realloc(4),Je(this.buf,h,this.pos),this.pos+=4},writeFixed64:function(h){this.realloc(8),Je(this.buf,-1&h,this.pos),Je(this.buf,Math.floor(h*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(h){this.realloc(8),Je(this.buf,-1&h,this.pos),Je(this.buf,Math.floor(h*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(h){(h=+h||0)>268435455||h<0?function(p,m){var E,T;if(p>=0?(E=p%4294967296|0,T=p/4294967296|0):(T=~(-p/4294967296),4294967295^(E=~(-p%4294967296))?E=E+1|0:(E=0,T=T+1|0)),p>=18446744073709552e3||p<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");m.realloc(10),function(I,P,B){B.buf[B.pos++]=127&I|128,I>>>=7,B.buf[B.pos++]=127&I|128,I>>>=7,B.buf[B.pos++]=127&I|128,I>>>=7,B.buf[B.pos++]=127&I|128,B.buf[B.pos]=127&(I>>>=7)}(E,0,m),function(I,P){var B=(7&I)<<4;P.buf[P.pos++]|=B|((I>>>=3)?128:0),I&&(P.buf[P.pos++]=127&I|((I>>>=7)?128:0),I&&(P.buf[P.pos++]=127&I|((I>>>=7)?128:0),I&&(P.buf[P.pos++]=127&I|((I>>>=7)?128:0),I&&(P.buf[P.pos++]=127&I|((I>>>=7)?128:0),I&&(P.buf[P.pos++]=127&I)))))}(T,m)}(h,this):(this.realloc(4),this.buf[this.pos++]=127&h|(h>127?128:0),h<=127||(this.buf[this.pos++]=127&(h>>>=7)|(h>127?128:0),h<=127||(this.buf[this.pos++]=127&(h>>>=7)|(h>127?128:0),h<=127||(this.buf[this.pos++]=h>>>7&127))))},writeSVarint:function(h){this.writeVarint(h<0?2*-h-1:2*h)},writeBoolean:function(h){this.writeVarint(!!h)},writeString:function(h){h=String(h),this.realloc(4*h.length),this.pos++;var p=this.pos;this.pos=function(E,T,I){for(var P,B,H=0;H<T.length;H++){if((P=T.charCodeAt(H))>55295&&P<57344){if(!B){P>56319||H+1===T.length?(E[I++]=239,E[I++]=191,E[I++]=189):B=P;continue}if(P<56320){E[I++]=239,E[I++]=191,E[I++]=189,B=P;continue}P=B-55296<<10|P-56320|65536,B=null}else B&&(E[I++]=239,E[I++]=191,E[I++]=189,B=null);P<128?E[I++]=P:(P<2048?E[I++]=P>>6|192:(P<65536?E[I++]=P>>12|224:(E[I++]=P>>18|240,E[I++]=P>>12&63|128),E[I++]=P>>6&63|128),E[I++]=63&P|128)}return I}(this.buf,h,this.pos);var m=this.pos-p;m>=128&&or(p,m,this),this.pos=p-1,this.writeVarint(m),this.pos+=m},writeFloat:function(h){this.realloc(4),Ne(this.buf,h,this.pos,!0,23,4),this.pos+=4},writeDouble:function(h){this.realloc(8),Ne(this.buf,h,this.pos,!0,52,8),this.pos+=8},writeBytes:function(h){var p=h.length;this.writeVarint(p),this.realloc(p);for(var m=0;m<p;m++)this.buf[this.pos++]=h[m]},writeRawMessage:function(h,p){this.pos++;var m=this.pos;h(p,this);var E=this.pos-m;E>=128&&or(m,E,this),this.pos=m-1,this.writeVarint(E),this.pos+=E},writeMessage:function(h,p,m){this.writeTag(h,ue.Bytes),this.writeRawMessage(p,m)},writePackedVarint:function(h,p){p.length&&this.writeMessage(h,hr,p)},writePackedSVarint:function(h,p){p.length&&this.writeMessage(h,mr,p)},writePackedBoolean:function(h,p){p.length&&this.writeMessage(h,ie,p)},writePackedFloat:function(h,p){p.length&&this.writeMessage(h,Ke,p)},writePackedDouble:function(h,p){p.length&&this.writeMessage(h,fr,p)},writePackedFixed32:function(h,p){p.length&&this.writeMessage(h,Se,p)},writePackedSFixed32:function(h,p){p.length&&this.writeMessage(h,ir,p)},writePackedFixed64:function(h,p){p.length&&this.writeMessage(h,Cr,p)},writePackedSFixed64:function(h,p){p.length&&this.writeMessage(h,We,p)},writeBytesField:function(h,p){this.writeTag(h,ue.Bytes),this.writeBytes(p)},writeFixed32Field:function(h,p){this.writeTag(h,ue.Fixed32),this.writeFixed32(p)},writeSFixed32Field:function(h,p){this.writeTag(h,ue.Fixed32),this.writeSFixed32(p)},writeFixed64Field:function(h,p){this.writeTag(h,ue.Fixed64),this.writeFixed64(p)},writeSFixed64Field:function(h,p){this.writeTag(h,ue.Fixed64),this.writeSFixed64(p)},writeVarintField:function(h,p){this.writeTag(h,ue.Varint),this.writeVarint(p)},writeSVarintField:function(h,p){this.writeTag(h,ue.Varint),this.writeSVarint(p)},writeStringField:function(h,p){this.writeTag(h,ue.Bytes),this.writeString(p)},writeFloatField:function(h,p){this.writeTag(h,ue.Fixed32),this.writeFloat(p)},writeDoubleField:function(h,p){this.writeTag(h,ue.Fixed64),this.writeDouble(p)},writeBooleanField:function(h,p){this.writeVarintField(h,!!p)}};var Er=function(h,p){var m=p.pixelRatio,E=p.version,T=p.stretchX,I=p.stretchY,P=p.content;this.paddedRect=h,this.pixelRatio=m,this.stretchX=T,this.stretchY=I,this.content=P,this.version=E},er={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};er.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},er.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},er.tlbr.get=function(){return this.tl.concat(this.br)},er.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Er.prototype,er);var Ue=function(h,p){var m={},E={};this.haveRenderCallbacks=[];var T=[];this.addImages(h,m,T),this.addImages(p,E,T);var I=Bn(T),P=new ll({width:I.w||1,height:I.h||1});for(var B in h){var H=h[B],G=m[B].paddedRect;ll.copy(H.data,P,{x:0,y:0},{x:G.x+1,y:G.y+1},H.data)}for(var Z in p){var K=p[Z],nt=E[Z].paddedRect,lt=nt.x+1,St=nt.y+1,Rt=K.data.width,Gt=K.data.height;ll.copy(K.data,P,{x:0,y:0},{x:lt,y:St},K.data),ll.copy(K.data,P,{x:0,y:Gt-1},{x:lt,y:St-1},{width:Rt,height:1}),ll.copy(K.data,P,{x:0,y:0},{x:lt,y:St+Gt},{width:Rt,height:1}),ll.copy(K.data,P,{x:Rt-1,y:0},{x:lt-1,y:St},{width:1,height:Gt}),ll.copy(K.data,P,{x:0,y:0},{x:lt+Rt,y:St},{width:1,height:Gt})}this.image=P,this.iconPositions=m,this.patternPositions=E};Ue.prototype.addImages=function(h,p,m){for(var E in h){var T=h[E],I={x:0,y:0,w:T.data.width+2,h:T.data.height+2};m.push(I),p[E]=new Er(I,T),T.hasRenderCallback&&this.haveRenderCallbacks.push(E)}},Ue.prototype.patchUpdatedImages=function(h,p){for(var m in h.dispatchRenderCallbacks(this.haveRenderCallbacks),h.updatedImages)this.patchUpdatedImage(this.iconPositions[m],h.getImage(m),p),this.patchUpdatedImage(this.patternPositions[m],h.getImage(m),p)},Ue.prototype.patchUpdatedImage=function(h,p,m){if(h&&p&&h.version!==p.version){h.version=p.version;var E=h.tl;m.update(p.data,void 0,{x:E[0],y:E[1]})}},Wr("ImagePosition",Er),Wr("ImageAtlas",Ue);var dn={horizontal:1,vertical:2,horizontalOnly:3},si=function(){this.scale=1,this.fontStack="",this.imageName=null};si.forText=function(h,p){var m=new si;return m.scale=h||1,m.fontStack=p,m},si.forImage=function(h){var p=new si;return p.imageName=h,p};var Ir=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function ti(h,p,m,E,T,I,P,B,H,G,Z,K,nt,lt,St,Rt){var Gt,Nt=Ir.fromFeature(h,T);K===dn.vertical&&Nt.verticalizePunctuation();var ne=Ql.processBidirectionalText,le=Ql.processStyledBidirectionalText;if(ne&&Nt.sections.length===1){Gt=[];for(var xe=0,we=ne(Nt.toString(),Lo(Nt,G,I,p,E,lt,St));xe<we.length;xe+=1){var $e=we[xe],sr=new Ir;sr.text=$e,sr.sections=Nt.sections;for(var yr=0;yr<$e.length;yr++)sr.sectionIndex.push(0);Gt.push(sr)}}else if(le){Gt=[];for(var ln=0,Dr=le(Nt.text,Nt.sectionIndex,Lo(Nt,G,I,p,E,lt,St));ln<Dr.length;ln+=1){var pn=Dr[ln],zr=new Ir;zr.text=pn[0],zr.sectionIndex=pn[1],zr.sections=Nt.sections,Gt.push(zr)}}else Gt=function(Kr,gi){for(var Zn=[],Bi=Kr.text,gn=0,Yi=0,qa=gi;Yi<qa.length;Yi+=1){var bo=qa[Yi];Zn.push(Kr.substring(gn,bo)),gn=bo}return gn<Bi.length&&Zn.push(Kr.substring(gn,Bi.length)),Zn}(Nt,Lo(Nt,G,I,p,E,lt,St));var li=[],In={positionedLines:li,text:Nt.toString(),top:Z[1],bottom:Z[1],left:Z[0],right:Z[0],writingMode:K,iconsInText:!1,verticalizable:!1};return function(Kr,gi,Zn,Bi,gn,Yi,qa,bo,go,Ka,Eo,As){for(var Ms=0,Ol=-17,Us=0,Pl=0,Po=bo==="right"?1:bo==="left"?0:.5,$s=0,Si=0,Ca=gn;Si<Ca.length;Si+=1){var da=Ca[Si];da.trim();var Vi=da.getMaxScale(),eu=24*(Vi-1),hl={positionedGlyphs:[],lineOffset:0};Kr.positionedLines[$s]=hl;var Wa=hl.positionedGlyphs,Qo=0;if(da.length()){for(var fl=0;fl<da.length();fl++){var Zi=da.getSection(fl),_p=da.getSectionIndex(fl),Mc=da.getCharCode(fl),xp=0,Do=null,bp=null,bf=null,l1=24,Q0=!(go===dn.horizontal||!Eo&&!Ev(Mc)||Eo&&(Dn[Mc]||(Bv=Mc,_r.Arabic(Bv)||_r["Arabic Supplement"](Bv)||_r["Arabic Extended-A"](Bv)||_r["Arabic Presentation Forms-A"](Bv)||_r["Arabic Presentation Forms-B"](Bv))));if(Zi.imageName){var u1=Bi[Zi.imageName];if(!u1)continue;bf=Zi.imageName,Kr.iconsInText=Kr.iconsInText||!0,bp=u1.paddedRect;var Fv=u1.displaySize;Zi.scale=24*Zi.scale/As,xp=eu+(24-Fv[1]*Zi.scale),l1=(Do={width:Fv[0],height:Fv[1],left:1,top:-3,advance:Q0?Fv[1]:Fv[0]}).advance;var c1=Q0?Fv[0]*Zi.scale-24*Vi:Fv[1]*Zi.scale-24*Vi;c1>0&&c1>Qo&&(Qo=c1)}else{var R2=Zn[Zi.fontStack],h1=R2&&R2[Mc];if(h1&&h1.rect)bp=h1.rect,Do=h1.metrics;else{var sE=gi[Zi.fontStack],I2=sE&&sE[Mc];if(!I2)continue;Do=I2.metrics}xp=24*(Vi-Zi.scale)}Q0?(Kr.verticalizable=!0,Wa.push({glyph:Mc,imageName:bf,x:Ms,y:Ol+xp,vertical:Q0,scale:Zi.scale,fontStack:Zi.fontStack,sectionIndex:_p,metrics:Do,rect:bp}),Ms+=l1*Zi.scale+Ka):(Wa.push({glyph:Mc,imageName:bf,x:Ms,y:Ol+xp,vertical:Q0,scale:Zi.scale,fontStack:Zi.fontStack,sectionIndex:_p,metrics:Do,rect:bp}),Ms+=Do.advance*Zi.scale+Ka)}Wa.length!==0&&(Us=Math.max(Ms-Ka,Us),Yo(Wa,0,Wa.length-1,Po,Qo)),Ms=0;var L2=Yi*Vi+Qo;hl.lineOffset=Math.max(Qo,eu),Ol+=L2,Pl=Math.max(L2,Pl),++$s}else Ol+=Yi,++$s}var Bv,lE=Ol- -17,f1=Ia(qa),tm=f1.horizontalAlign,d1=f1.verticalAlign;(function(O2,P2,uE,cE,D2,hE,fE,dE,F2){var p1,B2=(P2-uE)*D2;p1=hE!==fE?-dE*cE- -17:(-cE*F2+.5)*fE;for(var v1=0,pE=O2;v1<pE.length;v1+=1)for(var J0=0,vE=pE[v1].positionedGlyphs;J0<vE.length;J0+=1){var g1=vE[J0];g1.x+=B2,g1.y+=p1}})(Kr.positionedLines,Po,tm,d1,Us,Pl,Yi,lE,gn.length),Kr.top+=-d1*lE,Kr.bottom=Kr.top+lE,Kr.left+=-tm*Us,Kr.right=Kr.left+Us}(In,p,m,E,Gt,P,B,H,K,G,nt,Rt),!function(Kr){for(var gi=0,Zn=Kr;gi<Zn.length;gi+=1)if(Zn[gi].positionedGlyphs.length!==0)return!1;return!0}(li)&&In}Ir.fromFeature=function(h,p){for(var m=new Ir,E=0;E<h.sections.length;E++){var T=h.sections[E];T.image?m.addImageSection(T):m.addTextSection(T,p)}return m},Ir.prototype.length=function(){return this.text.length},Ir.prototype.getSection=function(h){return this.sections[this.sectionIndex[h]]},Ir.prototype.getSectionIndex=function(h){return this.sectionIndex[h]},Ir.prototype.getCharCode=function(h){return this.text.charCodeAt(h)},Ir.prototype.verticalizePunctuation=function(){this.text=function(h){for(var p="",m=0;m<h.length;m++){var E=h.charCodeAt(m+1)||null,T=h.charCodeAt(m-1)||null;p+=E&&Ng(E)&&!Ft[h[m+1]]||T&&Ng(T)&&!Ft[h[m-1]]||!Ft[h[m]]?h[m]:Ft[h[m]]}return p}(this.text)},Ir.prototype.trim=function(){for(var h=0,p=0;p<this.text.length&&Dn[this.text.charCodeAt(p)];p++)h++;for(var m=this.text.length,E=this.text.length-1;E>=0&&E>=h&&Dn[this.text.charCodeAt(E)];E--)m--;this.text=this.text.substring(h,m),this.sectionIndex=this.sectionIndex.slice(h,m)},Ir.prototype.substring=function(h,p){var m=new Ir;return m.text=this.text.substring(h,p),m.sectionIndex=this.sectionIndex.slice(h,p),m.sections=this.sections,m},Ir.prototype.toString=function(){return this.text},Ir.prototype.getMaxScale=function(){var h=this;return this.sectionIndex.reduce(function(p,m){return Math.max(p,h.sections[m].scale)},0)},Ir.prototype.addTextSection=function(h,p){this.text+=h.text,this.sections.push(si.forText(h.scale,h.fontStack||p));for(var m=this.sections.length-1,E=0;E<h.text.length;++E)this.sectionIndex.push(m)},Ir.prototype.addImageSection=function(h){var p=h.image?h.image.name:"";if(p.length!==0){var m=this.getNextImageSectionCharCode();m?(this.text+=String.fromCharCode(m),this.sections.push(si.forImage(p)),this.sectionIndex.push(this.sections.length-1)):it("Reached maximum number of images 6401")}else it("Can't add FormattedSection with an empty image.")},Ir.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Dn={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Tn={};function Hi(h,p,m,E,T,I){if(p.imageName){var P=E[p.imageName];return P?P.displaySize[0]*p.scale*24/I+T:0}var B=m[p.fontStack],H=B&&B[h];return H?H.metrics.advance*p.scale+T:0}function Io(h,p,m,E){var T=Math.pow(h-p,2);return E?h<p?T/2:2*T:T+Math.abs(m)*m}function Ts(h,p,m){var E=0;return h===10&&(E-=1e4),m&&(E+=150),h!==40&&h!==65288||(E+=50),p!==41&&p!==65289||(E+=50),E}function vi(h,p,m,E,T,I){for(var P=null,B=Io(p,m,T,I),H=0,G=E;H<G.length;H+=1){var Z=G[H],K=Io(p-Z.x,m,T,I)+Z.badness;K<=B&&(P=Z,B=K)}return{index:h,x:p,priorBreak:P,badness:B}}function Lo(h,p,m,E,T,I,P){if(I!=="point")return[];if(!h)return[];for(var B,H=[],G=function(Gt,Nt,ne,le,xe,we){for(var $e=0,sr=0;sr<Gt.length();sr++){var yr=Gt.getSection(sr);$e+=Hi(Gt.getCharCode(sr),yr,le,xe,Nt,we)}return $e/Math.max(1,Math.ceil($e/ne))}(h,p,m,E,T,P),Z=h.text.indexOf("​")>=0,K=0,nt=0;nt<h.length();nt++){var lt=h.getSection(nt),St=h.getCharCode(nt);if(Dn[St]||(K+=Hi(St,lt,E,T,p,P)),nt<h.length()-1){var Rt=!((B=St)<11904||!(_r["Bopomofo Extended"](B)||_r.Bopomofo(B)||_r["CJK Compatibility Forms"](B)||_r["CJK Compatibility Ideographs"](B)||_r["CJK Compatibility"](B)||_r["CJK Radicals Supplement"](B)||_r["CJK Strokes"](B)||_r["CJK Symbols and Punctuation"](B)||_r["CJK Unified Ideographs Extension A"](B)||_r["CJK Unified Ideographs"](B)||_r["Enclosed CJK Letters and Months"](B)||_r["Halfwidth and Fullwidth Forms"](B)||_r.Hiragana(B)||_r["Ideographic Description Characters"](B)||_r["Kangxi Radicals"](B)||_r["Katakana Phonetic Extensions"](B)||_r.Katakana(B)||_r["Vertical Forms"](B)||_r["Yi Radicals"](B)||_r["Yi Syllables"](B)));(Tn[St]||Rt||lt.imageName)&&H.push(vi(nt+1,K,G,H,Ts(St,h.getCharCode(nt+1),Rt&&Z),!1))}}return function Gt(Nt){return Nt?Gt(Nt.priorBreak).concat(Nt.index):[]}(vi(h.length(),K,G,H,0,!0))}function Ia(h){var p=.5,m=.5;switch(h){case"right":case"top-right":case"bottom-right":p=1;break;case"left":case"top-left":case"bottom-left":p=0}switch(h){case"bottom":case"bottom-right":case"bottom-left":m=1;break;case"top":case"top-right":case"top-left":m=0}return{horizontalAlign:p,verticalAlign:m}}function Yo(h,p,m,E,T){if(E||T)for(var I=h[m],P=(h[m].x+I.metrics.advance*I.scale)*E,B=p;B<=m;B++)h[B].x-=P,h[B].y+=T}function Zo(h,p,m,E,T,I){var P,B=h.image;if(B.content){var H=B.content,G=B.pixelRatio||1;P=[H[0]/G,H[1]/G,B.displaySize[0]-H[2]/G,B.displaySize[1]-H[3]/G]}var Z,K,nt,lt,St=p.left*I,Rt=p.right*I;m==="width"||m==="both"?(lt=T[0]+St-E[3],K=T[0]+Rt+E[1]):K=(lt=T[0]+(St+Rt-B.displaySize[0])/2)+B.displaySize[0];var Gt=p.top*I,Nt=p.bottom*I;return m==="height"||m==="both"?(Z=T[1]+Gt-E[0],nt=T[1]+Nt+E[2]):nt=(Z=T[1]+(Gt+Nt-B.displaySize[1])/2)+B.displaySize[1],{image:B,top:Z,right:K,bottom:nt,left:lt,collisionPadding:P}}Tn[10]=!0,Tn[32]=!0,Tn[38]=!0,Tn[40]=!0,Tn[41]=!0,Tn[43]=!0,Tn[45]=!0,Tn[47]=!0,Tn[173]=!0,Tn[183]=!0,Tn[8203]=!0,Tn[8208]=!0,Tn[8211]=!0,Tn[8231]=!0;var so=function(h){function p(m,E,T,I){h.call(this,m,E),this.angle=T,I!==void 0&&(this.segment=I)}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype.clone=function(){return new p(this.x,this.y,this.angle,this.segment)},p}(c);function ps(h,p){var m=p.expression;if(m.kind==="constant")return{kind:"constant",layoutSize:m.evaluate(new Vn(h+1))};if(m.kind==="source")return{kind:"source"};for(var E=m.zoomStops,T=m.interpolationType,I=0;I<E.length&&E[I]<=h;)I++;for(var P=I=Math.max(0,I-1);P<E.length&&E[P]<h+1;)P++;P=Math.min(E.length-1,P);var B=E[I],H=E[P];return m.kind==="composite"?{kind:"composite",minZoom:B,maxZoom:H,interpolationType:T}:{kind:"camera",minZoom:B,maxZoom:H,minSize:m.evaluate(new Vn(B)),maxSize:m.evaluate(new Vn(H)),interpolationType:T}}function Qs(h,p,m){var E=p.uSize,T=m.lowerSize;return h.kind==="source"?T/128:h.kind==="composite"?no(T/128,m.upperSize/128,p.uSizeT):E}function qo(h,p){var m=0,E=0;if(h.kind==="constant")E=h.layoutSize;else if(h.kind!=="source"){var T=h.interpolationType,I=T?w(Cs.interpolationFactor(T,p,h.minZoom,h.maxZoom),0,1):0;h.kind==="camera"?E=no(h.minSize,h.maxSize,I):m=I}return{uSizeT:m,uSize:E}}Wr("Anchor",so);var Qn=Object.freeze({__proto__:null,getSizeData:ps,evaluateSizeForFeature:Qs,evaluateSizeForZoom:qo,SIZE_PACK_FACTOR:128});function ks(h,p,m,E,T){if(p.segment===void 0)return!0;for(var I=p,P=p.segment+1,B=0;B>-m/2;){if(--P<0)return!1;B-=h[P].dist(I),I=h[P]}B+=h[P].dist(h[P+1]),P++;for(var H=[],G=0;B<m/2;){var Z=h[P],K=h[P+1];if(!K)return!1;var nt=h[P-1].angleTo(Z)-Z.angleTo(K);for(nt=Math.abs((nt+3*Math.PI)%(2*Math.PI)-Math.PI),H.push({distance:B,angleDelta:nt}),G+=nt;B-H[0].distance>E;)G-=H.shift().angleDelta;if(G>T)return!1;P++,B+=Z.dist(K)}return!0}function Xi(h){for(var p=0,m=0;m<h.length-1;m++)p+=h[m].dist(h[m+1]);return p}function En(h,p,m){return h?.6*p*m:0}function fi(h,p){return Math.max(h?h.right-h.left:0,p?p.right-p.left:0)}function Fi(h,p,m,E,T,I){for(var P=En(m,T,I),B=fi(m,E)*I,H=0,G=Xi(h)/2,Z=0;Z<h.length-1;Z++){var K=h[Z],nt=h[Z+1],lt=K.dist(nt);if(H+lt>G){var St=(G-H)/lt,Rt=no(K.x,nt.x,St),Gt=no(K.y,nt.y,St),Nt=new so(Rt,Gt,nt.angleTo(K),Z);return Nt._round(),!P||ks(h,Nt,B,P,p)?Nt:void 0}H+=lt}}function Oo(h,p,m,E,T,I,P,B,H){var G=En(E,I,P),Z=fi(E,T),K=Z*P,nt=h[0].x===0||h[0].x===H||h[0].y===0||h[0].y===H;return p-K<p/4&&(p=K+p/4),function lt(St,Rt,Gt,Nt,ne,le,xe,we,$e){for(var sr=le/2,yr=Xi(St),ln=0,Dr=Rt-Gt,pn=[],zr=0;zr<St.length-1;zr++){for(var li=St[zr],In=St[zr+1],Kr=li.dist(In),gi=In.angleTo(li);Dr+Gt<ln+Kr;){var Zn=((Dr+=Gt)-ln)/Kr,Bi=no(li.x,In.x,Zn),gn=no(li.y,In.y,Zn);if(Bi>=0&&Bi<$e&&gn>=0&&gn<$e&&Dr-sr>=0&&Dr+sr<=yr){var Yi=new so(Bi,gn,gi,zr);Yi._round(),Nt&&!ks(St,Yi,le,Nt,ne)||pn.push(Yi)}}ln+=Kr}return we||pn.length||xe||(pn=lt(St,ln/2,Gt,Nt,ne,le,xe,!0,$e)),pn}(h,nt?p/2*B%p:(Z/2+2*I)*P*B%p,p,G,m,K,nt,!1,H)}function wh(h,p,m,E,T){for(var I=[],P=0;P<h.length;P++)for(var B=h[P],H=void 0,G=0;G<B.length-1;G++){var Z=B[G],K=B[G+1];Z.x<p&&K.x<p||(Z.x<p?Z=new c(p,Z.y+(p-Z.x)/(K.x-Z.x)*(K.y-Z.y))._round():K.x<p&&(K=new c(p,Z.y+(p-Z.x)/(K.x-Z.x)*(K.y-Z.y))._round()),Z.y<m&&K.y<m||(Z.y<m?Z=new c(Z.x+(m-Z.y)/(K.y-Z.y)*(K.x-Z.x),m)._round():K.y<m&&(K=new c(Z.x+(m-Z.y)/(K.y-Z.y)*(K.x-Z.x),m)._round()),Z.x>=E&&K.x>=E||(Z.x>=E?Z=new c(E,Z.y+(E-Z.x)/(K.x-Z.x)*(K.y-Z.y))._round():K.x>=E&&(K=new c(E,Z.y+(E-Z.x)/(K.x-Z.x)*(K.y-Z.y))._round()),Z.y>=T&&K.y>=T||(Z.y>=T?Z=new c(Z.x+(T-Z.y)/(K.y-Z.y)*(K.x-Z.x),T)._round():K.y>=T&&(K=new c(Z.x+(T-Z.y)/(K.y-Z.y)*(K.x-Z.x),T)._round()),H&&Z.equals(H[H.length-1])||I.push(H=[Z]),H.push(K)))))}return I}function It(h,p,m,E){var T=[],I=h.image,P=I.pixelRatio,B=I.paddedRect.w-2,H=I.paddedRect.h-2,G=h.right-h.left,Z=h.bottom-h.top,K=I.stretchX||[[0,B]],nt=I.stretchY||[[0,H]],lt=function(Bi,gn){return Bi+gn[1]-gn[0]},St=K.reduce(lt,0),Rt=nt.reduce(lt,0),Gt=B-St,Nt=H-Rt,ne=0,le=St,xe=0,we=Rt,$e=0,sr=Gt,yr=0,ln=Nt;if(I.content&&E){var Dr=I.content;ne=_e(K,0,Dr[0]),xe=_e(nt,0,Dr[1]),le=_e(K,Dr[0],Dr[2]),we=_e(nt,Dr[1],Dr[3]),$e=Dr[0]-ne,yr=Dr[1]-xe,sr=Dr[2]-Dr[0]-le,ln=Dr[3]-Dr[1]-we}var pn=function(Bi,gn,Yi,qa){var bo=Pr(Bi.stretch-ne,le,G,h.left),go=ei(Bi.fixed-$e,sr,Bi.stretch,St),Ka=Pr(gn.stretch-xe,we,Z,h.top),Eo=ei(gn.fixed-yr,ln,gn.stretch,Rt),As=Pr(Yi.stretch-ne,le,G,h.left),Ms=ei(Yi.fixed-$e,sr,Yi.stretch,St),Ol=Pr(qa.stretch-xe,we,Z,h.top),Us=ei(qa.fixed-yr,ln,qa.stretch,Rt),Pl=new c(bo,Ka),Po=new c(As,Ka),$s=new c(As,Ol),Si=new c(bo,Ol),Ca=new c(go/P,Eo/P),da=new c(Ms/P,Us/P),Vi=p*Math.PI/180;if(Vi){var eu=Math.sin(Vi),hl=Math.cos(Vi),Wa=[hl,-eu,eu,hl];Pl._matMult(Wa),Po._matMult(Wa),Si._matMult(Wa),$s._matMult(Wa)}var Qo=Bi.stretch+Bi.fixed,fl=gn.stretch+gn.fixed;return{tl:Pl,tr:Po,bl:Si,br:$s,tex:{x:I.paddedRect.x+1+Qo,y:I.paddedRect.y+1+fl,w:Yi.stretch+Yi.fixed-Qo,h:qa.stretch+qa.fixed-fl},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ca,pixelOffsetBR:da,minFontScaleX:sr/P/G,minFontScaleY:ln/P/Z,isSDF:m}};if(E&&(I.stretchX||I.stretchY))for(var zr=he(K,Gt,St),li=he(nt,Nt,Rt),In=0;In<zr.length-1;In++)for(var Kr=zr[In],gi=zr[In+1],Zn=0;Zn<li.length-1;Zn++)T.push(pn(Kr,li[Zn],gi,li[Zn+1]));else T.push(pn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:B+1},{fixed:0,stretch:H+1}));return T}function _e(h,p,m){for(var E=0,T=0,I=h;T<I.length;T+=1){var P=I[T];E+=Math.max(p,Math.min(m,P[1]))-Math.max(p,Math.min(m,P[0]))}return E}function he(h,p,m){for(var E=[{fixed:-1,stretch:0}],T=0,I=h;T<I.length;T+=1){var P=I[T],B=P[0],H=P[1],G=E[E.length-1];E.push({fixed:B-G.stretch,stretch:G.stretch}),E.push({fixed:B-G.stretch,stretch:G.stretch+(H-B)})}return E.push({fixed:p+1,stretch:m}),E}function Pr(h,p,m,E){return h/p*m+E}function ei(h,p,m,E){return h-p*m/E}var fa=function(h,p,m,E,T,I,P,B,H,G){if(this.boxStartIndex=h.length,H){var Z=I.top,K=I.bottom,nt=I.collisionPadding;nt&&(Z-=nt[1],K+=nt[3]);var lt=K-Z;lt>0&&(lt=Math.max(10,lt),this.circleDiameter=lt)}else{var St=I.top*P-B,Rt=I.bottom*P+B,Gt=I.left*P-B,Nt=I.right*P+B,ne=I.collisionPadding;if(ne&&(Gt-=ne[0]*P,St-=ne[1]*P,Nt+=ne[2]*P,Rt+=ne[3]*P),G){var le=new c(Gt,St),xe=new c(Nt,St),we=new c(Gt,Rt),$e=new c(Nt,Rt),sr=G*Math.PI/180;le._rotate(sr),xe._rotate(sr),we._rotate(sr),$e._rotate(sr),Gt=Math.min(le.x,xe.x,we.x,$e.x),Nt=Math.max(le.x,xe.x,we.x,$e.x),St=Math.min(le.y,xe.y,we.y,$e.y),Rt=Math.max(le.y,xe.y,we.y,$e.y)}h.emplaceBack(p.x,p.y,Gt,St,Nt,Rt,m,E,T)}this.boxEndIndex=h.length},st=function(h,p){if(h===void 0&&(h=[]),p===void 0&&(p=wt),this.data=h,this.length=this.data.length,this.compare=p,this.length>0)for(var m=(this.length>>1)-1;m>=0;m--)this._down(m)};function wt(h,p){return h<p?-1:h>p?1:0}function Bt(h,p,m){p===void 0&&(p=1),m===void 0&&(m=!1);for(var E=1/0,T=1/0,I=-1/0,P=-1/0,B=h[0],H=0;H<B.length;H++){var G=B[H];(!H||G.x<E)&&(E=G.x),(!H||G.y<T)&&(T=G.y),(!H||G.x>I)&&(I=G.x),(!H||G.y>P)&&(P=G.y)}var Z=Math.min(I-E,P-T),K=Z/2,nt=new st([],de);if(Z===0)return new c(E,T);for(var lt=E;lt<I;lt+=Z)for(var St=T;St<P;St+=Z)nt.push(new ce(lt+K,St+K,K,h));for(var Rt=function(ne){for(var le=0,xe=0,we=0,$e=ne[0],sr=0,yr=$e.length,ln=yr-1;sr<yr;ln=sr++){var Dr=$e[sr],pn=$e[ln],zr=Dr.x*pn.y-pn.x*Dr.y;xe+=(Dr.x+pn.x)*zr,we+=(Dr.y+pn.y)*zr,le+=3*zr}return new ce(xe/le,we/le,0,ne)}(h),Gt=nt.length;nt.length;){var Nt=nt.pop();(Nt.d>Rt.d||!Rt.d)&&(Rt=Nt,m&&console.log("found best %d after %d probes",Math.round(1e4*Nt.d)/1e4,Gt)),Nt.max-Rt.d<=p||(nt.push(new ce(Nt.p.x-(K=Nt.h/2),Nt.p.y-K,K,h)),nt.push(new ce(Nt.p.x+K,Nt.p.y-K,K,h)),nt.push(new ce(Nt.p.x-K,Nt.p.y+K,K,h)),nt.push(new ce(Nt.p.x+K,Nt.p.y+K,K,h)),Gt+=4)}return m&&(console.log("num probes: "+Gt),console.log("best distance: "+Rt.d)),Rt.p}function de(h,p){return p.max-h.max}function ce(h,p,m,E){this.p=new c(h,p),this.h=m,this.d=function(T,I){for(var P=!1,B=1/0,H=0;H<I.length;H++)for(var G=I[H],Z=0,K=G.length,nt=K-1;Z<K;nt=Z++){var lt=G[Z],St=G[nt];lt.y>T.y!=St.y>T.y&&T.x<(St.x-lt.x)*(T.y-lt.y)/(St.y-lt.y)+lt.x&&(P=!P),B=Math.min(B,mf(T,lt,St))}return(P?1:-1)*Math.sqrt(B)}(this.p,E),this.max=this.d+this.h*Math.SQRT2}st.prototype.push=function(h){this.data.push(h),this.length++,this._up(this.length-1)},st.prototype.pop=function(){if(this.length!==0){var h=this.data[0],p=this.data.pop();return this.length--,this.length>0&&(this.data[0]=p,this._down(0)),h}},st.prototype.peek=function(){return this.data[0]},st.prototype._up=function(h){for(var p=this.data,m=this.compare,E=p[h];h>0;){var T=h-1>>1,I=p[T];if(m(E,I)>=0)break;p[h]=I,h=T}p[h]=E},st.prototype._down=function(h){for(var p=this.data,m=this.compare,E=this.length>>1,T=p[h];h<E;){var I=1+(h<<1),P=p[I],B=I+1;if(B<this.length&&m(p[B],P)<0&&(I=B,P=p[B]),m(P,T)>=0)break;p[h]=P,h=I}p[h]=T};var Ht=Number.POSITIVE_INFINITY;function Yt(h,p){return p[1]!==Ht?function(m,E,T){var I=0,P=0;switch(E=Math.abs(E),T=Math.abs(T),m){case"top-right":case"top-left":case"top":P=T-7;break;case"bottom-right":case"bottom-left":case"bottom":P=7-T}switch(m){case"top-right":case"bottom-right":case"right":I=-E;break;case"top-left":case"bottom-left":case"left":I=E}return[I,P]}(h,p[0],p[1]):function(m,E){var T=0,I=0;E<0&&(E=0);var P=E/Math.sqrt(2);switch(m){case"top-right":case"top-left":I=P-7;break;case"bottom-right":case"bottom-left":I=7-P;break;case"bottom":I=7-E;break;case"top":I=E-7}switch(m){case"top-right":case"bottom-right":T=-P;break;case"top-left":case"bottom-left":T=P;break;case"left":T=E;break;case"right":T=-E}return[T,I]}(h,p[0])}function Jt(h){switch(h){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Lt(h,p,m,E,T,I,P,B,H,G,Z,K,nt,lt,St){var Rt=function(xe,we,$e,sr,yr,ln,Dr,pn){for(var zr=sr.layout.get("text-rotate").evaluate(ln,{})*Math.PI/180,li=[],In=0,Kr=we.positionedLines;In<Kr.length;In+=1)for(var gi=Kr[In],Zn=0,Bi=gi.positionedGlyphs;Zn<Bi.length;Zn+=1){var gn=Bi[Zn];if(gn.rect){var Yi=gn.rect||{},qa=4,bo=!0,go=1,Ka=0,Eo=(yr||pn)&&gn.vertical,As=gn.metrics.advance*gn.scale/2;if(pn&&we.verticalizable&&(Ka=gi.lineOffset/2-(gn.imageName?-(24-gn.metrics.width*gn.scale)/2:24*(gn.scale-1))),gn.imageName){var Ms=Dr[gn.imageName];bo=Ms.sdf,qa=1/(go=Ms.pixelRatio)}var Ol=yr?[gn.x+As,gn.y]:[0,0],Us=yr?[0,0]:[gn.x+As+$e[0],gn.y+$e[1]-Ka],Pl=[0,0];Eo&&(Pl=Us,Us=[0,0]);var Po=(gn.metrics.left-qa)*gn.scale-As+Us[0],$s=(-gn.metrics.top-qa)*gn.scale+Us[1],Si=Po+Yi.w*gn.scale/go,Ca=$s+Yi.h*gn.scale/go,da=new c(Po,$s),Vi=new c(Si,$s),eu=new c(Po,Ca),hl=new c(Si,Ca);if(Eo){var Wa=new c(-As,As- -17),Qo=-Math.PI/2,fl=12-As,Zi=new c(22-fl,-(gn.imageName?fl:0)),_p=new(Function.prototype.bind.apply(c,[null].concat(Pl)));da._rotateAround(Qo,Wa)._add(Zi)._add(_p),Vi._rotateAround(Qo,Wa)._add(Zi)._add(_p),eu._rotateAround(Qo,Wa)._add(Zi)._add(_p),hl._rotateAround(Qo,Wa)._add(Zi)._add(_p)}if(zr){var Mc=Math.sin(zr),xp=Math.cos(zr),Do=[xp,-Mc,Mc,xp];da._matMult(Do),Vi._matMult(Do),eu._matMult(Do),hl._matMult(Do)}var bp=new c(0,0),bf=new c(0,0);li.push({tl:da,tr:Vi,bl:eu,br:hl,tex:Yi,writingMode:we.writingMode,glyphOffset:Ol,sectionIndex:gn.sectionIndex,isSDF:bo,pixelOffsetTL:bp,pixelOffsetBR:bf,minFontScaleX:0,minFontScaleY:0})}}return li}(0,m,B,T,I,P,E,h.allowVerticalPlacement),Gt=h.textSizeData,Nt=null;Gt.kind==="source"?(Nt=[128*T.layout.get("text-size").evaluate(P,{})])[0]>32640&&it(h.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):Gt.kind==="composite"&&((Nt=[128*lt.compositeTextSizes[0].evaluate(P,{},St),128*lt.compositeTextSizes[1].evaluate(P,{},St)])[0]>32640||Nt[1]>32640)&&it(h.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),h.addSymbols(h.text,Rt,Nt,B,I,P,G,p,H.lineStartIndex,H.lineLength,nt,St);for(var ne=0,le=Z;ne<le.length;ne+=1)K[le[ne]]=h.text.placedSymbolArray.length-1;return 4*Rt.length}function Wt(h){for(var p in h)return h[p];return null}function _t(h,p,m,E){var T=h.compareText;if(p in T){for(var I=T[p],P=I.length-1;P>=0;P--)if(E.dist(I[P])<m)return!0}else T[p]=[];return T[p].push(E),!1}var jt=yp.VectorTileFeature.types,be=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Ie(h,p,m,E,T,I,P,B,H,G,Z,K,nt){var lt=B?Math.min(32640,Math.round(B[0])):0,St=B?Math.min(32640,Math.round(B[1])):0;h.emplaceBack(p,m,Math.round(32*E),Math.round(32*T),I,P,(lt<<1)+(H?1:0),St,16*G,16*Z,256*K,256*nt)}function je(h,p,m){h.emplaceBack(p.x,p.y,m),h.emplaceBack(p.x,p.y,m),h.emplaceBack(p.x,p.y,m),h.emplaceBack(p.x,p.y,m)}function He(h){for(var p=0,m=h.sections;p<m.length;p+=1)if(kg(m[p].text))return!0;return!1}var Qe=function(h){this.layoutVertexArray=new Hg,this.indexArray=new wc,this.programConfigurations=h,this.segments=new ht,this.dynamicLayoutVertexArray=new cp,this.opacityVertexArray=new wv,this.placedSymbolArray=new C};Qe.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},Qe.prototype.upload=function(h,p,m,E){this.isEmpty()||(m&&(this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,SL.members),this.indexBuffer=h.createIndexBuffer(this.indexArray,p),this.dynamicLayoutVertexBuffer=h.createVertexBuffer(this.dynamicLayoutVertexArray,TL.members,!0),this.opacityVertexBuffer=h.createVertexBuffer(this.opacityVertexArray,be,!0),this.opacityVertexBuffer.itemSize=1),(m||E)&&this.programConfigurations.upload(h))},Qe.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Wr("SymbolBuffers",Qe);var tn=function(h,p,m){this.layoutVertexArray=new h,this.layoutAttributes=p,this.indexArray=new m,this.segments=new ht,this.collisionVertexArray=new G0};tn.prototype.upload=function(h){this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=h.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=h.createVertexBuffer(this.collisionVertexArray,w2.members,!0)},tn.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Wr("CollisionBuffers",tn);var Xr=function(h){this.collisionBoxArray=h.collisionBoxArray,this.zoom=h.zoom,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(function(I){return I.id}),this.index=h.index,this.pixelRatio=h.pixelRatio,this.sourceLayerIndex=h.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=ds([]),this.placementViewportMatrix=ds([]);var p=this.layers[0]._unevaluatedLayout._values;this.textSizeData=ps(this.zoom,p["text-size"]),this.iconSizeData=ps(this.zoom,p["icon-size"]);var m=this.layers[0].layout,E=m.get("symbol-sort-key"),T=m.get("symbol-z-order");this.canOverlap=m.get("text-allow-overlap")||m.get("icon-allow-overlap")||m.get("text-ignore-placement")||m.get("icon-ignore-placement"),this.sortFeaturesByKey=T!=="viewport-y"&&E.constantOr(1)!==void 0,this.sortFeaturesByY=(T==="viewport-y"||T==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,m.get("symbol-placement")==="point"&&(this.writingModes=m.get("text-writing-mode").map(function(I){return dn[I]})),this.stateDependentLayerIds=this.layers.filter(function(I){return I.isStateDependent()}).map(function(I){return I.id}),this.sourceID=h.sourceID};Xr.prototype.createArrays=function(){this.text=new Qe(new bn(this.layers,this.zoom,function(h){return/^text/.test(h)})),this.icon=new Qe(new bn(this.layers,this.zoom,function(h){return/^icon/.test(h)})),this.glyphOffsetArray=new F,this.lineVertexArray=new $,this.symbolInstances=new D},Xr.prototype.calculateGlyphDependencies=function(h,p,m,E,T){for(var I=0;I<h.length;I++)if(p[h.charCodeAt(I)]=!0,(m||E)&&T){var P=Ft[h.charAt(I)];P&&(p[P.charCodeAt(0)]=!0)}},Xr.prototype.populate=function(h,p,m){var E=this.layers[0],T=E.layout,I=T.get("text-font"),P=T.get("text-field"),B=T.get("icon-image"),H=(P.value.kind!=="constant"||P.value.value instanceof eo&&!P.value.value.isEmpty()||P.value.value.toString().length>0)&&(I.value.kind!=="constant"||I.value.value.length>0),G=B.value.kind!=="constant"||!!B.value.value||Object.keys(B.parameters).length>0,Z=T.get("symbol-sort-key");if(this.features=[],H||G){for(var K=p.iconDependencies,nt=p.glyphDependencies,lt=p.availableImages,St=new Vn(this.zoom),Rt=0,Gt=h;Rt<Gt.length;Rt+=1){var Nt=Gt[Rt],ne=Nt.feature,le=Nt.id,xe=Nt.index,we=Nt.sourceLayerIndex,$e=E._featureFilter.needGeometry,sr=Ya(ne,$e);if(E._featureFilter.filter(St,sr,m)){$e||(sr.geometry=Ga(ne));var yr=void 0;if(H){var ln=E.getValueAndResolveTokens("text-field",sr,m,lt),Dr=eo.factory(ln);He(Dr)&&(this.hasRTLText=!0),(!this.hasRTLText||H0()==="unavailable"||this.hasRTLText&&Ql.isParsed())&&(yr=yt(Dr,E,sr))}var pn=void 0;if(G){var zr=E.getValueAndResolveTokens("icon-image",sr,m,lt);pn=zr instanceof Da?zr:Da.fromString(zr)}if(yr||pn){var li=this.sortFeaturesByKey?Z.evaluate(sr,{},m):void 0;if(this.features.push({id:le,text:yr,icon:pn,index:xe,sourceLayerIndex:we,geometry:sr.geometry,properties:ne.properties,type:jt[ne.type],sortKey:li}),pn&&(K[pn.name]=!0),yr){var In=I.evaluate(sr,{},m).join(","),Kr=T.get("text-rotation-alignment")==="map"&&T.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(dn.vertical)>=0;for(var gi=0,Zn=yr.sections;gi<Zn.length;gi+=1){var Bi=Zn[gi];if(Bi.image)K[Bi.image.name]=!0;else{var gn=mh(yr.toString()),Yi=Bi.fontStack||In,qa=nt[Yi]=nt[Yi]||{};this.calculateGlyphDependencies(Bi.text,qa,Kr,this.allowVerticalPlacement,gn)}}}}}}T.get("symbol-placement")==="line"&&(this.features=function(bo){var go={},Ka={},Eo=[],As=0;function Ms(Wa){Eo.push(bo[Wa]),As++}function Ol(Wa,Qo,fl){var Zi=Ka[Wa];return delete Ka[Wa],Ka[Qo]=Zi,Eo[Zi].geometry[0].pop(),Eo[Zi].geometry[0]=Eo[Zi].geometry[0].concat(fl[0]),Zi}function Us(Wa,Qo,fl){var Zi=go[Qo];return delete go[Qo],go[Wa]=Zi,Eo[Zi].geometry[0].shift(),Eo[Zi].geometry[0]=fl[0].concat(Eo[Zi].geometry[0]),Zi}function Pl(Wa,Qo,fl){var Zi=fl?Qo[0][Qo[0].length-1]:Qo[0][0];return Wa+":"+Zi.x+":"+Zi.y}for(var Po=0;Po<bo.length;Po++){var $s=bo[Po],Si=$s.geometry,Ca=$s.text?$s.text.toString():null;if(Ca){var da=Pl(Ca,Si),Vi=Pl(Ca,Si,!0);if(da in Ka&&Vi in go&&Ka[da]!==go[Vi]){var eu=Us(da,Vi,Si),hl=Ol(da,Vi,Eo[eu].geometry);delete go[da],delete Ka[Vi],Ka[Pl(Ca,Eo[hl].geometry,!0)]=hl,Eo[eu].geometry=null}else da in Ka?Ol(da,Vi,Si):Vi in go?Us(da,Vi,Si):(Ms(Po),go[da]=As-1,Ka[Vi]=As-1)}else Ms(Po)}return Eo.filter(function(Wa){return Wa.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(bo,go){return bo.sortKey-go.sortKey})}},Xr.prototype.update=function(h,p,m){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(h,p,this.layers,m),this.icon.programConfigurations.updatePaintArrays(h,p,this.layers,m))},Xr.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},Xr.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Xr.prototype.upload=function(h){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(h),this.iconCollisionBox.upload(h)),this.text.upload(h,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(h,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Xr.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Xr.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Xr.prototype.addToLineVertexArray=function(h,p){var m=this.lineVertexArray.length;if(h.segment!==void 0){for(var E=h.dist(p[h.segment+1]),T=h.dist(p[h.segment]),I={},P=h.segment+1;P<p.length;P++)I[P]={x:p[P].x,y:p[P].y,tileUnitDistanceFromAnchor:E},P<p.length-1&&(E+=p[P+1].dist(p[P]));for(var B=h.segment||0;B>=0;B--)I[B]={x:p[B].x,y:p[B].y,tileUnitDistanceFromAnchor:T},B>0&&(T+=p[B-1].dist(p[B]));for(var H=0;H<p.length;H++){var G=I[H];this.lineVertexArray.emplaceBack(G.x,G.y,G.tileUnitDistanceFromAnchor)}}return{lineStartIndex:m,lineLength:this.lineVertexArray.length-m}},Xr.prototype.addSymbols=function(h,p,m,E,T,I,P,B,H,G,Z,K){for(var nt=h.indexArray,lt=h.layoutVertexArray,St=h.segments.prepareSegment(4*p.length,lt,nt,this.canOverlap?I.sortKey:void 0),Rt=this.glyphOffsetArray.length,Gt=St.vertexLength,Nt=this.allowVerticalPlacement&&P===dn.vertical?Math.PI/2:0,ne=I.text&&I.text.sections,le=0;le<p.length;le++){var xe=p[le],we=xe.tl,$e=xe.tr,sr=xe.bl,yr=xe.br,ln=xe.tex,Dr=xe.pixelOffsetTL,pn=xe.pixelOffsetBR,zr=xe.minFontScaleX,li=xe.minFontScaleY,In=xe.glyphOffset,Kr=xe.isSDF,gi=xe.sectionIndex,Zn=St.vertexLength,Bi=In[1];Ie(lt,B.x,B.y,we.x,Bi+we.y,ln.x,ln.y,m,Kr,Dr.x,Dr.y,zr,li),Ie(lt,B.x,B.y,$e.x,Bi+$e.y,ln.x+ln.w,ln.y,m,Kr,pn.x,Dr.y,zr,li),Ie(lt,B.x,B.y,sr.x,Bi+sr.y,ln.x,ln.y+ln.h,m,Kr,Dr.x,pn.y,zr,li),Ie(lt,B.x,B.y,yr.x,Bi+yr.y,ln.x+ln.w,ln.y+ln.h,m,Kr,pn.x,pn.y,zr,li),je(h.dynamicLayoutVertexArray,B,Nt),nt.emplaceBack(Zn,Zn+1,Zn+2),nt.emplaceBack(Zn+1,Zn+2,Zn+3),St.vertexLength+=4,St.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(In[0]),le!==p.length-1&&gi===p[le+1].sectionIndex||h.programConfigurations.populatePaintArrays(lt.length,I,I.index,{},K,ne&&ne[gi])}h.placedSymbolArray.emplaceBack(B.x,B.y,Rt,this.glyphOffsetArray.length-Rt,Gt,H,G,B.segment,m?m[0]:0,m?m[1]:0,E[0],E[1],P,0,!1,0,Z)},Xr.prototype._addCollisionDebugVertex=function(h,p,m,E,T,I){return p.emplaceBack(0,0),h.emplaceBack(m.x,m.y,E,T,Math.round(I.x),Math.round(I.y))},Xr.prototype.addCollisionDebugVertices=function(h,p,m,E,T,I,P){var B=T.segments.prepareSegment(4,T.layoutVertexArray,T.indexArray),H=B.vertexLength,G=T.layoutVertexArray,Z=T.collisionVertexArray,K=P.anchorX,nt=P.anchorY;this._addCollisionDebugVertex(G,Z,I,K,nt,new c(h,p)),this._addCollisionDebugVertex(G,Z,I,K,nt,new c(m,p)),this._addCollisionDebugVertex(G,Z,I,K,nt,new c(m,E)),this._addCollisionDebugVertex(G,Z,I,K,nt,new c(h,E)),B.vertexLength+=4;var lt=T.indexArray;lt.emplaceBack(H,H+1),lt.emplaceBack(H+1,H+2),lt.emplaceBack(H+2,H+3),lt.emplaceBack(H+3,H),B.primitiveLength+=4},Xr.prototype.addDebugCollisionBoxes=function(h,p,m,E){for(var T=h;T<p;T++){var I=this.collisionBoxArray.get(T);this.addCollisionDebugVertices(I.x1,I.y1,I.x2,I.y2,E?this.textCollisionBox:this.iconCollisionBox,I.anchorPoint,m)}},Xr.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new tn(fd,C2.members,Cv),this.iconCollisionBox=new tn(fd,C2.members,Cv);for(var h=0;h<this.symbolInstances.length;h++){var p=this.symbolInstances.get(h);this.addDebugCollisionBoxes(p.textBoxStartIndex,p.textBoxEndIndex,p,!0),this.addDebugCollisionBoxes(p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p,!0),this.addDebugCollisionBoxes(p.iconBoxStartIndex,p.iconBoxEndIndex,p,!1),this.addDebugCollisionBoxes(p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex,p,!1)}},Xr.prototype._deserializeCollisionBoxesForSymbol=function(h,p,m,E,T,I,P,B,H){for(var G={},Z=p;Z<m;Z++){var K=h.get(Z);G.textBox={x1:K.x1,y1:K.y1,x2:K.x2,y2:K.y2,anchorPointX:K.anchorPointX,anchorPointY:K.anchorPointY},G.textFeatureIndex=K.featureIndex;break}for(var nt=E;nt<T;nt++){var lt=h.get(nt);G.verticalTextBox={x1:lt.x1,y1:lt.y1,x2:lt.x2,y2:lt.y2,anchorPointX:lt.anchorPointX,anchorPointY:lt.anchorPointY},G.verticalTextFeatureIndex=lt.featureIndex;break}for(var St=I;St<P;St++){var Rt=h.get(St);G.iconBox={x1:Rt.x1,y1:Rt.y1,x2:Rt.x2,y2:Rt.y2,anchorPointX:Rt.anchorPointX,anchorPointY:Rt.anchorPointY},G.iconFeatureIndex=Rt.featureIndex;break}for(var Gt=B;Gt<H;Gt++){var Nt=h.get(Gt);G.verticalIconBox={x1:Nt.x1,y1:Nt.y1,x2:Nt.x2,y2:Nt.y2,anchorPointX:Nt.anchorPointX,anchorPointY:Nt.anchorPointY},G.verticalIconFeatureIndex=Nt.featureIndex;break}return G},Xr.prototype.deserializeCollisionBoxes=function(h){this.collisionArrays=[];for(var p=0;p<this.symbolInstances.length;p++){var m=this.symbolInstances.get(p);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(h,m.textBoxStartIndex,m.textBoxEndIndex,m.verticalTextBoxStartIndex,m.verticalTextBoxEndIndex,m.iconBoxStartIndex,m.iconBoxEndIndex,m.verticalIconBoxStartIndex,m.verticalIconBoxEndIndex))}},Xr.prototype.hasTextData=function(){return this.text.segments.get().length>0},Xr.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Xr.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Xr.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Xr.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Xr.prototype.addIndicesForPlacedSymbol=function(h,p){for(var m=h.placedSymbolArray.get(p),E=m.vertexStartIndex+4*m.numGlyphs,T=m.vertexStartIndex;T<E;T+=4)h.indexArray.emplaceBack(T,T+1,T+2),h.indexArray.emplaceBack(T+1,T+2,T+3)},Xr.prototype.getSortedSymbolIndexes=function(h){if(this.sortedAngle===h&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var p=Math.sin(h),m=Math.cos(h),E=[],T=[],I=[],P=0;P<this.symbolInstances.length;++P){I.push(P);var B=this.symbolInstances.get(P);E.push(0|Math.round(p*B.anchorX+m*B.anchorY)),T.push(B.featureIndex)}return I.sort(function(H,G){return E[H]-E[G]||T[G]-T[H]}),I},Xr.prototype.addToSortKeyRanges=function(h,p){var m=this.sortKeyRanges[this.sortKeyRanges.length-1];m&&m.sortKey===p?m.symbolInstanceEnd=h+1:this.sortKeyRanges.push({sortKey:p,symbolInstanceStart:h,symbolInstanceEnd:h+1})},Xr.prototype.sortFeatures=function(h){var p=this;if(this.sortFeaturesByY&&this.sortedAngle!==h&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(h),this.sortedAngle=h,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var m=0,E=this.symbolInstanceIndexes;m<E.length;m+=1){var T=this.symbolInstances.get(E[m]);this.featureSortOrder.push(T.featureIndex),[T.rightJustifiedTextSymbolIndex,T.centerJustifiedTextSymbolIndex,T.leftJustifiedTextSymbolIndex].forEach(function(I,P,B){I>=0&&B.indexOf(I)===P&&p.addIndicesForPlacedSymbol(p.text,I)}),T.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,T.verticalPlacedTextSymbolIndex),T.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,T.placedIconSymbolIndex),T.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,T.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Wr("SymbolBucket",Xr,{omit:["layers","collisionBoxArray","features","compareText"]}),Xr.MAX_GLYPHS=65535,Xr.addDynamicAttributes=je;var qr=new Va({"symbol-placement":new on(ct.layout_symbol["symbol-placement"]),"symbol-spacing":new on(ct.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new on(ct.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Zr(ct.layout_symbol["symbol-sort-key"]),"symbol-z-order":new on(ct.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new on(ct.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new on(ct.layout_symbol["icon-ignore-placement"]),"icon-optional":new on(ct.layout_symbol["icon-optional"]),"icon-rotation-alignment":new on(ct.layout_symbol["icon-rotation-alignment"]),"icon-size":new Zr(ct.layout_symbol["icon-size"]),"icon-text-fit":new on(ct.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new on(ct.layout_symbol["icon-text-fit-padding"]),"icon-image":new Zr(ct.layout_symbol["icon-image"]),"icon-rotate":new Zr(ct.layout_symbol["icon-rotate"]),"icon-padding":new on(ct.layout_symbol["icon-padding"]),"icon-keep-upright":new on(ct.layout_symbol["icon-keep-upright"]),"icon-offset":new Zr(ct.layout_symbol["icon-offset"]),"icon-anchor":new Zr(ct.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new on(ct.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new on(ct.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new on(ct.layout_symbol["text-rotation-alignment"]),"text-field":new Zr(ct.layout_symbol["text-field"]),"text-font":new Zr(ct.layout_symbol["text-font"]),"text-size":new Zr(ct.layout_symbol["text-size"]),"text-max-width":new Zr(ct.layout_symbol["text-max-width"]),"text-line-height":new on(ct.layout_symbol["text-line-height"]),"text-letter-spacing":new Zr(ct.layout_symbol["text-letter-spacing"]),"text-justify":new Zr(ct.layout_symbol["text-justify"]),"text-radial-offset":new Zr(ct.layout_symbol["text-radial-offset"]),"text-variable-anchor":new on(ct.layout_symbol["text-variable-anchor"]),"text-anchor":new Zr(ct.layout_symbol["text-anchor"]),"text-max-angle":new on(ct.layout_symbol["text-max-angle"]),"text-writing-mode":new on(ct.layout_symbol["text-writing-mode"]),"text-rotate":new Zr(ct.layout_symbol["text-rotate"]),"text-padding":new on(ct.layout_symbol["text-padding"]),"text-keep-upright":new on(ct.layout_symbol["text-keep-upright"]),"text-transform":new Zr(ct.layout_symbol["text-transform"]),"text-offset":new Zr(ct.layout_symbol["text-offset"]),"text-allow-overlap":new on(ct.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new on(ct.layout_symbol["text-ignore-placement"]),"text-optional":new on(ct.layout_symbol["text-optional"])}),wn={paint:new Va({"icon-opacity":new Zr(ct.paint_symbol["icon-opacity"]),"icon-color":new Zr(ct.paint_symbol["icon-color"]),"icon-halo-color":new Zr(ct.paint_symbol["icon-halo-color"]),"icon-halo-width":new Zr(ct.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Zr(ct.paint_symbol["icon-halo-blur"]),"icon-translate":new on(ct.paint_symbol["icon-translate"]),"icon-translate-anchor":new on(ct.paint_symbol["icon-translate-anchor"]),"text-opacity":new Zr(ct.paint_symbol["text-opacity"]),"text-color":new Zr(ct.paint_symbol["text-color"],{runtimeType:gr,getOverride:function(h){return h.textColor},hasOverride:function(h){return!!h.textColor}}),"text-halo-color":new Zr(ct.paint_symbol["text-halo-color"]),"text-halo-width":new Zr(ct.paint_symbol["text-halo-width"]),"text-halo-blur":new Zr(ct.paint_symbol["text-halo-blur"]),"text-translate":new on(ct.paint_symbol["text-translate"]),"text-translate-anchor":new on(ct.paint_symbol["text-translate-anchor"])}),layout:qr},Pn=function(h){this.type=h.property.overrides?h.property.overrides.runtimeType:Ur,this.defaultValue=h};Pn.prototype.evaluate=function(h){if(h.formattedSection){var p=this.defaultValue.property.overrides;if(p&&p.hasOverride(h.formattedSection))return p.getOverride(h.formattedSection)}return h.feature&&h.featureState?this.defaultValue.evaluate(h.feature,h.featureState):this.defaultValue.property.specification.default},Pn.prototype.eachChild=function(h){this.defaultValue.isConstant()||h(this.defaultValue.value._styleExpression.expression)},Pn.prototype.outputDefined=function(){return!1},Pn.prototype.serialize=function(){return null},Wr("FormatSectionOverride",Pn,{omit:["defaultValue"]});var ji=function(h){function p(m){h.call(this,m,wn)}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype.recalculate=function(m,E){if(h.prototype.recalculate.call(this,m,E),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var T=this.layout.get("text-writing-mode");if(T){for(var I=[],P=0,B=T;P<B.length;P+=1){var H=B[P];I.indexOf(H)<0&&I.push(H)}this.layout._values["text-writing-mode"]=I}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},p.prototype.getValueAndResolveTokens=function(m,E,T,I){var P=this.layout.get(m).evaluate(E,{},T,I),B=this._unevaluatedLayout._values[m];return B.isDataDriven()||od(B.value)||!P?P:function(H,G){return G.replace(/{([^{}]+)}/g,function(Z,K){return K in H?String(H[K]):""})}(E.properties,P)},p.prototype.createBucket=function(m){return new Xr(m)},p.prototype.queryRadius=function(){return 0},p.prototype.queryIntersectsFeature=function(){return!1},p.prototype._setPaintOverrides=function(){for(var m=0,E=wn.paint.overridableProperties;m<E.length;m+=1){var T=E[m];if(p.hasPaintOverride(this.layout,T)){var I,P=this.paint.get(T),B=new Pn(P),H=new lf(B,P.property.specification);I=P.value.kind==="constant"||P.value.kind==="source"?new sd("source",H):new ld("composite",H,P.value.zoomStops,P.value._interpolationType),this.paint._values[T]=new Fs(P.property,I,P.parameters)}}},p.prototype._handleOverridablePaintPropertyUpdate=function(m,E,T){return!(!this.layout||E.isDataDriven()||T.isDataDriven())&&p.hasPaintOverride(this.layout,m)},p.hasPaintOverride=function(m,E){var T=m.get("text-field"),I=wn.paint.properties[E],P=!1,B=function(Z){for(var K=0,nt=Z;K<nt.length;K+=1)if(I.overrides&&I.overrides.hasOverride(nt[K]))return void(P=!0)};if(T.value.kind==="constant"&&T.value.value instanceof eo)B(T.value.value.sections);else if(T.value.kind==="source"){var H=function(Z){P||(Z instanceof Ho&&Ma(Z.value)===ea?B(Z.value.sections):Z instanceof Xs?B(Z.sections):Z.eachChild(H))},G=T.value;G._styleExpression&&H(G._styleExpression.expression)}return P},p}(wu),Ko={paint:new Va({"background-color":new on(ct.paint_background["background-color"]),"background-pattern":new Bs(ct.paint_background["background-pattern"]),"background-opacity":new on(ct.paint_background["background-opacity"])})},Ch=function(h){function p(m){h.call(this,m,Ko)}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p}(wu),iE={paint:new Va({"raster-opacity":new on(ct.paint_raster["raster-opacity"]),"raster-hue-rotate":new on(ct.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new on(ct.paint_raster["raster-brightness-min"]),"raster-brightness-max":new on(ct.paint_raster["raster-brightness-max"]),"raster-saturation":new on(ct.paint_raster["raster-saturation"]),"raster-contrast":new on(ct.paint_raster["raster-contrast"]),"raster-resampling":new on(ct.paint_raster["raster-resampling"]),"raster-fade-duration":new on(ct.paint_raster["raster-fade-duration"])})},Ac=function(h){function p(m){h.call(this,m,iE)}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p}(wu),S2=function(h){function p(m){h.call(this,m,{}),this.implementation=m}return h&&(p.__proto__=h),(p.prototype=Object.create(h&&h.prototype)).constructor=p,p.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},p.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},p.prototype.recalculate=function(){},p.prototype.updateTransitions=function(){},p.prototype.hasTransition=function(){},p.prototype.serialize=function(){},p.prototype.onAdd=function(m){this.implementation.onAdd&&this.implementation.onAdd(m,m.painter.context.gl)},p.prototype.onRemove=function(m){this.implementation.onRemove&&this.implementation.onRemove(m,m.painter.context.gl)},p}(wu),_d={circle:X0,heatmap:Zg,hillshade:fL,fill:d2,"fill-extrusion":m2,line:E2,symbol:ji,background:Ch,raster:Ac},aE=d.HTMLImageElement,_8=d.HTMLCanvasElement,x8=d.HTMLVideoElement,b8=d.ImageData,T2=d.ImageBitmap,Z0=function(h,p,m,E){this.context=h,this.format=m,this.texture=h.gl.createTexture(),this.update(p,E)};Z0.prototype.update=function(h,p,m){var E=h.width,T=h.height,I=!(this.size&&this.size[0]===E&&this.size[1]===T||m),P=this.context,B=P.gl;if(this.useMipmap=!!(p&&p.useMipmap),B.bindTexture(B.TEXTURE_2D,this.texture),P.pixelStoreUnpackFlipY.set(!1),P.pixelStoreUnpack.set(1),P.pixelStoreUnpackPremultiplyAlpha.set(this.format===B.RGBA&&(!p||p.premultiply!==!1)),I)this.size=[E,T],h instanceof aE||h instanceof _8||h instanceof x8||h instanceof b8||T2&&h instanceof T2?B.texImage2D(B.TEXTURE_2D,0,this.format,this.format,B.UNSIGNED_BYTE,h):B.texImage2D(B.TEXTURE_2D,0,this.format,E,T,0,this.format,B.UNSIGNED_BYTE,h.data);else{var H=m||{x:0,y:0},G=H.x,Z=H.y;h instanceof aE||h instanceof _8||h instanceof x8||h instanceof b8||T2&&h instanceof T2?B.texSubImage2D(B.TEXTURE_2D,0,G,Z,B.RGBA,B.UNSIGNED_BYTE,h):B.texSubImage2D(B.TEXTURE_2D,0,G,Z,E,T,B.RGBA,B.UNSIGNED_BYTE,h.data)}this.useMipmap&&this.isSizePowerOfTwo()&&B.generateMipmap(B.TEXTURE_2D)},Z0.prototype.bind=function(h,p,m){var E=this.context.gl;E.bindTexture(E.TEXTURE_2D,this.texture),m!==E.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(m=E.LINEAR),h!==this.filter&&(E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MAG_FILTER,h),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MIN_FILTER,m||h),this.filter=h),p!==this.wrap&&(E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_S,p),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_T,p),this.wrap=p)},Z0.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Z0.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var AL=function(h){var p=this;this._callback=h,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){p._triggered=!1,p._callback()})};AL.prototype.trigger=function(){var h=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){h._triggered=!1,h._callback()},0))},AL.prototype.remove=function(){delete this._channel,this._callback=function(){}};var o1=function(h,p,m){this.target=h,this.parent=p,this.mapId=m,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},k(["receive","process"],this),this.invoker=new AL(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=pt()?h:d};function E8(h,p,m){var E=2*Math.PI*6378137/256/Math.pow(2,m);return[h*E-2*Math.PI*6378137/2,p*E-2*Math.PI*6378137/2]}o1.prototype.send=function(h,p,m,E,T){var I=this;T===void 0&&(T=!1);var P=Math.round(1e18*Math.random()).toString(36).substring(0,10);m&&(this.callbacks[P]=m);var B=Kt(this.globalScope)?void 0:[];return this.target.postMessage({id:P,type:h,hasCallback:!!m,targetMapId:E,mustQueue:T,sourceMapId:this.mapId,data:js(p,B)},B),{cancel:function(){m&&delete I.callbacks[P],I.target.postMessage({id:P,type:"<cancel>",targetMapId:E,sourceMapId:I.mapId})}}},o1.prototype.receive=function(h){var p=h.data,m=p.id;if(m&&(!p.targetMapId||this.mapId===p.targetMapId))if(p.type==="<cancel>"){delete this.tasks[m];var E=this.cancelCallbacks[m];delete this.cancelCallbacks[m],E&&E()}else pt()||p.mustQueue?(this.tasks[m]=p,this.taskQueue.push(m),this.invoker.trigger()):this.processTask(m,p)},o1.prototype.process=function(){if(this.taskQueue.length){var h=this.taskQueue.shift(),p=this.tasks[h];delete this.tasks[h],this.taskQueue.length&&this.invoker.trigger(),p&&this.processTask(h,p)}},o1.prototype.processTask=function(h,p){var m=this;if(p.type==="<response>"){var E=this.callbacks[h];delete this.callbacks[h],E&&(p.error?E(ha(p.error)):E(null,ha(p.data)))}else{var T=!1,I=Kt(this.globalScope)?void 0:[],P=p.hasCallback?function(Z,K){T=!0,delete m.cancelCallbacks[h],m.target.postMessage({id:h,type:"<response>",sourceMapId:m.mapId,error:Z?js(Z):null,data:js(K,I)},I)}:function(Z){T=!0},B=null,H=ha(p.data);if(this.parent[p.type])B=this.parent[p.type](p.sourceMapId,H,P);else if(this.parent.getWorkerSource){var G=p.type.split(".");B=this.parent.getWorkerSource(p.sourceMapId,G[0],H.source)[G[1]](H,P)}else P(new Error("Could not find function "+p.type));!T&&B&&B.cancel&&(this.cancelCallbacks[h]=B.cancel)}},o1.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var vs=function(h,p){h&&(p?this.setSouthWest(h).setNorthEast(p):h.length===4?this.setSouthWest([h[0],h[1]]).setNorthEast([h[2],h[3]]):this.setSouthWest(h[0]).setNorthEast(h[1]))};vs.prototype.setNorthEast=function(h){return this._ne=h instanceof Za?new Za(h.lng,h.lat):Za.convert(h),this},vs.prototype.setSouthWest=function(h){return this._sw=h instanceof Za?new Za(h.lng,h.lat):Za.convert(h),this},vs.prototype.extend=function(h){var p,m,E=this._sw,T=this._ne;if(h instanceof Za)p=h,m=h;else{if(!(h instanceof vs))return Array.isArray(h)?h.length===4||h.every(Array.isArray)?this.extend(vs.convert(h)):this.extend(Za.convert(h)):this;if(m=h._ne,!(p=h._sw)||!m)return this}return E||T?(E.lng=Math.min(p.lng,E.lng),E.lat=Math.min(p.lat,E.lat),T.lng=Math.max(m.lng,T.lng),T.lat=Math.max(m.lat,T.lat)):(this._sw=new Za(p.lng,p.lat),this._ne=new Za(m.lng,m.lat)),this},vs.prototype.getCenter=function(){return new Za((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},vs.prototype.getSouthWest=function(){return this._sw},vs.prototype.getNorthEast=function(){return this._ne},vs.prototype.getNorthWest=function(){return new Za(this.getWest(),this.getNorth())},vs.prototype.getSouthEast=function(){return new Za(this.getEast(),this.getSouth())},vs.prototype.getWest=function(){return this._sw.lng},vs.prototype.getSouth=function(){return this._sw.lat},vs.prototype.getEast=function(){return this._ne.lng},vs.prototype.getNorth=function(){return this._ne.lat},vs.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},vs.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},vs.prototype.isEmpty=function(){return!(this._sw&&this._ne)},vs.prototype.contains=function(h){var p=Za.convert(h),m=p.lng,E=p.lat,T=this._sw.lng<=m&&m<=this._ne.lng;return this._sw.lng>this._ne.lng&&(T=this._sw.lng>=m&&m>=this._ne.lng),this._sw.lat<=E&&E<=this._ne.lat&&T},vs.convert=function(h){return!h||h instanceof vs?h:new vs(h)};var Za=function(h,p){if(isNaN(h)||isNaN(p))throw new Error("Invalid LngLat object: ("+h+", "+p+")");if(this.lng=+h,this.lat=+p,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Za.prototype.wrap=function(){return new Za(S(this.lng,-180,180),this.lat)},Za.prototype.toArray=function(){return[this.lng,this.lat]},Za.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Za.prototype.distanceTo=function(h){var p=Math.PI/180,m=this.lat*p,E=h.lat*p,T=Math.sin(m)*Math.sin(E)+Math.cos(m)*Math.cos(E)*Math.cos((h.lng-this.lng)*p);return 63710088e-1*Math.acos(Math.min(T,1))},Za.prototype.toBounds=function(h){h===void 0&&(h=0);var p=360*h/40075017,m=p/Math.cos(Math.PI/180*this.lat);return new vs(new Za(this.lng-m,this.lat-p),new Za(this.lng+m,this.lat+p))},Za.convert=function(h){if(h instanceof Za)return h;if(Array.isArray(h)&&(h.length===2||h.length===3))return new Za(Number(h[0]),Number(h[1]));if(!Array.isArray(h)&&typeof h=="object"&&h!==null)return new Za(Number("lng"in h?h.lng:h.lon),Number(h.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var w8=2*Math.PI*63710088e-1;function C8(h){return w8*Math.cos(h*Math.PI/180)}function S8(h){return(180+h)/360}function T8(h){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+h*Math.PI/360)))/360}function A8(h,p){return h/C8(p)}function ML(h){return 360/Math.PI*Math.atan(Math.exp((180-360*h)*Math.PI/180))-90}var q0=function(h,p,m){m===void 0&&(m=0),this.x=+h,this.y=+p,this.z=+m};q0.fromLngLat=function(h,p){p===void 0&&(p=0);var m=Za.convert(h);return new q0(S8(m.lng),T8(m.lat),A8(p,m.lat))},q0.prototype.toLngLat=function(){return new Za(360*this.x-180,ML(this.y))},q0.prototype.toAltitude=function(){return this.z*C8(ML(this.y))},q0.prototype.meterInMercatorCoordinateUnits=function(){return 1/w8*(h=ML(this.y),1/Math.cos(h*Math.PI/180));var h};var K0=function(h,p,m){this.z=h,this.x=p,this.y=m,this.key=oE(0,h,h,p,m)};K0.prototype.equals=function(h){return this.z===h.z&&this.x===h.x&&this.y===h.y},K0.prototype.url=function(h,p){var m,E,T,I,P,B=(E=this.y,T=this.z,I=E8(256*(m=this.x),256*(E=Math.pow(2,T)-E-1),T),P=E8(256*(m+1),256*(E+1),T),I[0]+","+I[1]+","+P[0]+","+P[1]),H=function(G,Z,K){for(var nt,lt="",St=G;St>0;St--)lt+=(Z&(nt=1<<St-1)?1:0)+(K&nt?2:0);return lt}(this.z,this.x,this.y);return h[(this.x+this.y)%h.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(p==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",H).replace("{bbox-epsg-3857}",B)},K0.prototype.getTilePoint=function(h){var p=Math.pow(2,this.z);return new c(8192*(h.x*p-this.x),8192*(h.y*p-this.y))},K0.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var M8=function(h,p){this.wrap=h,this.canonical=p,this.key=oE(h,p.z,p.z,p.x,p.y)},gs=function(h,p,m,E,T){this.overscaledZ=h,this.wrap=p,this.canonical=new K0(m,+E,+T),this.key=oE(p,h,m,E,T)};function oE(h,p,m,E,T){(h*=2)<0&&(h=-1*h-1);var I=1<<m;return(I*I*h+I*T+E).toString(36)+m.toString(36)+p.toString(36)}gs.prototype.equals=function(h){return this.overscaledZ===h.overscaledZ&&this.wrap===h.wrap&&this.canonical.equals(h.canonical)},gs.prototype.scaledTo=function(h){var p=this.canonical.z-h;return h>this.canonical.z?new gs(h,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new gs(h,this.wrap,h,this.canonical.x>>p,this.canonical.y>>p)},gs.prototype.calculateScaledKey=function(h,p){var m=this.canonical.z-h;return h>this.canonical.z?oE(this.wrap*+p,h,this.canonical.z,this.canonical.x,this.canonical.y):oE(this.wrap*+p,h,h,this.canonical.x>>m,this.canonical.y>>m)},gs.prototype.isChildOf=function(h){if(h.wrap!==this.wrap)return!1;var p=this.canonical.z-h.canonical.z;return h.overscaledZ===0||h.overscaledZ<this.overscaledZ&&h.canonical.x===this.canonical.x>>p&&h.canonical.y===this.canonical.y>>p},gs.prototype.children=function(h){if(this.overscaledZ>=h)return[new gs(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var p=this.canonical.z+1,m=2*this.canonical.x,E=2*this.canonical.y;return[new gs(p,this.wrap,p,m,E),new gs(p,this.wrap,p,m+1,E),new gs(p,this.wrap,p,m,E+1),new gs(p,this.wrap,p,m+1,E+1)]},gs.prototype.isLessThan=function(h){return this.wrap<h.wrap||!(this.wrap>h.wrap)&&(this.overscaledZ<h.overscaledZ||!(this.overscaledZ>h.overscaledZ)&&(this.canonical.x<h.canonical.x||!(this.canonical.x>h.canonical.x)&&this.canonical.y<h.canonical.y))},gs.prototype.wrapped=function(){return new gs(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},gs.prototype.unwrapTo=function(h){return new gs(this.overscaledZ,h,this.canonical.z,this.canonical.x,this.canonical.y)},gs.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},gs.prototype.toUnwrapped=function(){return new M8(this.wrap,this.canonical)},gs.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},gs.prototype.getTilePoint=function(h){return this.canonical.getTilePoint(new q0(h.x-this.wrap,h.y))},Wr("CanonicalTileID",K0),Wr("OverscaledTileID",gs,{omit:["posMatrix"]});var Pv=function(h,p,m){if(this.uid=h,p.height!==p.width)throw new RangeError("DEM tiles must be square");if(m&&m!=="mapbox"&&m!=="terrarium")return it('"'+m+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=p.height;var E=this.dim=p.height-2;this.data=new Uint32Array(p.data.buffer),this.encoding=m||"mapbox";for(var T=0;T<E;T++)this.data[this._idx(-1,T)]=this.data[this._idx(0,T)],this.data[this._idx(E,T)]=this.data[this._idx(E-1,T)],this.data[this._idx(T,-1)]=this.data[this._idx(T,0)],this.data[this._idx(T,E)]=this.data[this._idx(T,E-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(E,-1)]=this.data[this._idx(E-1,0)],this.data[this._idx(-1,E)]=this.data[this._idx(0,E-1)],this.data[this._idx(E,E)]=this.data[this._idx(E-1,E-1)]};Pv.prototype.get=function(h,p){var m=new Uint8Array(this.data.buffer),E=4*this._idx(h,p);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(m[E],m[E+1],m[E+2])},Pv.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Pv.prototype._idx=function(h,p){if(h<-1||h>=this.dim+1||p<-1||p>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(p+1)*this.stride+(h+1)},Pv.prototype._unpackMapbox=function(h,p,m){return(256*h*256+256*p+m)/10-1e4},Pv.prototype._unpackTerrarium=function(h,p,m){return 256*h+p+m/256-32768},Pv.prototype.getPixels=function(){return new ll({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Pv.prototype.backfillBorder=function(h,p,m){if(this.dim!==h.dim)throw new Error("dem dimension mismatch");var E=p*this.dim,T=p*this.dim+this.dim,I=m*this.dim,P=m*this.dim+this.dim;switch(p){case-1:E=T-1;break;case 1:T=E+1}switch(m){case-1:I=P-1;break;case 1:P=I+1}for(var B=-p*this.dim,H=-m*this.dim,G=I;G<P;G++)for(var Z=E;Z<T;Z++)this.data[this._idx(Z,G)]=h.data[this._idx(Z+B,G+H)]},Wr("DEMData",Pv);var A2=function(h){this._stringToNumber={},this._numberToString=[];for(var p=0;p<h.length;p++){var m=h[p];this._stringToNumber[m]=p,this._numberToString[p]=m}};A2.prototype.encode=function(h){return this._stringToNumber[h]},A2.prototype.decode=function(h){return this._numberToString[h]};var M2=function(h,p,m,E,T){this.type="Feature",this._vectorTileFeature=h,h._z=p,h._x=m,h._y=E,this.properties=h.properties,this.id=T},RL={geometry:{configurable:!0}};RL.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},RL.geometry.set=function(h){this._geometry=h},M2.prototype.toJSON=function(){var h={geometry:this.geometry};for(var p in this)p!=="_geometry"&&p!=="_vectorTileFeature"&&(h[p]=this[p]);return h},Object.defineProperties(M2.prototype,RL);var s1=function(){this.state={},this.stateChanges={},this.deletedStates={}};s1.prototype.updateState=function(h,p,m){var E=String(p);if(this.stateChanges[h]=this.stateChanges[h]||{},this.stateChanges[h][E]=this.stateChanges[h][E]||{},A(this.stateChanges[h][E],m),this.deletedStates[h]===null)for(var T in this.deletedStates[h]={},this.state[h])T!==E&&(this.deletedStates[h][T]=null);else if(this.deletedStates[h]&&this.deletedStates[h][E]===null)for(var I in this.deletedStates[h][E]={},this.state[h][E])m[I]||(this.deletedStates[h][E][I]=null);else for(var P in m)this.deletedStates[h]&&this.deletedStates[h][E]&&this.deletedStates[h][E][P]===null&&delete this.deletedStates[h][E][P]},s1.prototype.removeFeatureState=function(h,p,m){if(this.deletedStates[h]!==null){var E=String(p);if(this.deletedStates[h]=this.deletedStates[h]||{},m&&p!==void 0)this.deletedStates[h][E]!==null&&(this.deletedStates[h][E]=this.deletedStates[h][E]||{},this.deletedStates[h][E][m]=null);else if(p!==void 0)if(this.stateChanges[h]&&this.stateChanges[h][E])for(m in this.deletedStates[h][E]={},this.stateChanges[h][E])this.deletedStates[h][E][m]=null;else this.deletedStates[h][E]=null;else this.deletedStates[h]=null}},s1.prototype.getState=function(h,p){var m=String(p),E=A({},(this.state[h]||{})[m],(this.stateChanges[h]||{})[m]);if(this.deletedStates[h]===null)return{};if(this.deletedStates[h]){var T=this.deletedStates[h][p];if(T===null)return{};for(var I in T)delete E[I]}return E},s1.prototype.initializeTileState=function(h,p){h.setFeatureState(this.state,p)},s1.prototype.coalesceChanges=function(h,p){var m={};for(var E in this.stateChanges){this.state[E]=this.state[E]||{};var T={};for(var I in this.stateChanges[E])this.state[E][I]||(this.state[E][I]={}),A(this.state[E][I],this.stateChanges[E][I]),T[I]=this.state[E][I];m[E]=T}for(var P in this.deletedStates){this.state[P]=this.state[P]||{};var B={};if(this.deletedStates[P]===null)for(var H in this.state[P])B[H]={},this.state[P][H]={};else for(var G in this.deletedStates[P]){if(this.deletedStates[P][G]===null)this.state[P][G]={};else for(var Z=0,K=Object.keys(this.deletedStates[P][G]);Z<K.length;Z+=1)delete this.state[P][G][K[Z]];B[G]=this.state[P][G]}m[P]=m[P]||{},A(m[P],B)}if(this.stateChanges={},this.deletedStates={},Object.keys(m).length!==0)for(var nt in h)h[nt].setFeatureState(m,p)};var Dv=function(h,p){this.tileID=h,this.x=h.canonical.x,this.y=h.canonical.y,this.z=h.canonical.z,this.grid=new Go(8192,16,0),this.grid3D=new Go(8192,16,0),this.featureIndexArray=new et,this.promoteId=p};function R8(h,p,m,E,T){return Q(h,function(I,P){var B=p instanceof lp?p.get(P):null;return B&&B.evaluate?B.evaluate(m,E,T):B})}function I8(h){for(var p=1/0,m=1/0,E=-1/0,T=-1/0,I=0,P=h;I<P.length;I+=1){var B=P[I];p=Math.min(p,B.x),m=Math.min(m,B.y),E=Math.max(E,B.x),T=Math.max(T,B.y)}return{minX:p,minY:m,maxX:E,maxY:T}}function Uht(h,p){return p-h}Dv.prototype.insert=function(h,p,m,E,T,I){var P=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(m,E,T);for(var B=I?this.grid3D:this.grid,H=0;H<p.length;H++){for(var G=p[H],Z=[1/0,1/0,-1/0,-1/0],K=0;K<G.length;K++){var nt=G[K];Z[0]=Math.min(Z[0],nt.x),Z[1]=Math.min(Z[1],nt.y),Z[2]=Math.max(Z[2],nt.x),Z[3]=Math.max(Z[3],nt.y)}Z[0]<8192&&Z[1]<8192&&Z[2]>=0&&Z[3]>=0&&B.insert(P,Z[0],Z[1],Z[2],Z[3])}},Dv.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new yp.VectorTile(new ye(this.rawTileData)).layers,this.sourceLayerCoder=new A2(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Dv.prototype.query=function(h,p,m,E){var T=this;this.loadVTLayers();for(var I=h.params||{},P=8192/h.tileSize/h.scale,B=cf(I.filter),H=h.queryGeometry,G=h.queryPadding*P,Z=I8(H),K=this.grid.query(Z.minX-G,Z.minY-G,Z.maxX+G,Z.maxY+G),nt=I8(h.cameraQueryGeometry),lt=this.grid3D.query(nt.minX-G,nt.minY-G,nt.maxX+G,nt.maxY+G,function(xe,we,$e,sr){return function(yr,ln,Dr,pn,zr){for(var li=0,In=yr;li<In.length;li+=1){var Kr=In[li];if(ln<=Kr.x&&Dr<=Kr.y&&pn>=Kr.x&&zr>=Kr.y)return!0}var gi=[new c(ln,Dr),new c(ln,zr),new c(pn,zr),new c(pn,Dr)];if(yr.length>2){for(var Zn=0,Bi=gi;Zn<Bi.length;Zn+=1)if(Yu(yr,Bi[Zn]))return!0}for(var gn=0;gn<yr.length-1;gn++)if(yf(yr[gn],yr[gn+1],gi))return!0;return!1}(h.cameraQueryGeometry,xe-G,we-G,$e+G,sr+G)}),St=0,Rt=lt;St<Rt.length;St+=1)K.push(Rt[St]);K.sort(Uht);for(var Gt,Nt={},ne=function(xe){var we=K[xe];if(we!==Gt){Gt=we;var $e=T.featureIndexArray.get(we),sr=null;T.loadMatchingFeature(Nt,$e.bucketIndex,$e.sourceLayerIndex,$e.featureIndex,B,I.layers,I.availableImages,p,m,E,function(yr,ln,Dr){return sr||(sr=Ga(yr)),ln.queryIntersectsFeature(H,yr,Dr,sr,T.z,h.transform,P,h.pixelPosMatrix)})}},le=0;le<K.length;le++)ne(le);return Nt},Dv.prototype.loadMatchingFeature=function(h,p,m,E,T,I,P,B,H,G,Z){var K=this.bucketLayerIDs[p];if(!I||function(yr,ln){for(var Dr=0;Dr<yr.length;Dr++)if(ln.indexOf(yr[Dr])>=0)return!0;return!1}(I,K)){var nt=this.sourceLayerCoder.decode(m),lt=this.vtLayers[nt].feature(E);if(T.needGeometry){var St=Ya(lt,!0);if(!T.filter(new Vn(this.tileID.overscaledZ),St,this.tileID.canonical))return}else if(!T.filter(new Vn(this.tileID.overscaledZ),lt))return;for(var Rt=this.getId(lt,nt),Gt=0;Gt<K.length;Gt++){var Nt=K[Gt];if(!(I&&I.indexOf(Nt)<0)){var ne=B[Nt];if(ne){var le={};Rt!==void 0&&G&&(le=G.getState(ne.sourceLayer||"_geojsonTileLayer",Rt));var xe=A({},H[Nt]);xe.paint=R8(xe.paint,ne.paint,lt,le,P),xe.layout=R8(xe.layout,ne.layout,lt,le,P);var we=!Z||Z(lt,ne,le);if(we){var $e=new M2(lt,this.z,this.x,this.y,Rt);$e.layer=xe;var sr=h[Nt];sr===void 0&&(sr=h[Nt]=[]),sr.push({featureIndex:E,feature:$e,intersectionZ:we})}}}}}},Dv.prototype.lookupSymbolFeatures=function(h,p,m,E,T,I,P,B){var H={};this.loadVTLayers();for(var G=cf(T),Z=0,K=h;Z<K.length;Z+=1)this.loadMatchingFeature(H,m,E,K[Z],G,I,P,B,p);return H},Dv.prototype.hasLayer=function(h){for(var p=0,m=this.bucketLayerIDs;p<m.length;p+=1)for(var E=0,T=m[p];E<T.length;E+=1)if(h===T[E])return!0;return!1},Dv.prototype.getId=function(h,p){var m=h.id;return this.promoteId&&typeof(m=h.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[p]])=="boolean"&&(m=Number(m)),m},Wr("FeatureIndex",Dv,{omit:["rawTileData","sourceLayerCoder"]});var zs=function(h,p){this.tileID=h,this.uid=R(),this.uses=0,this.tileSize=p,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};zs.prototype.registerFadeDuration=function(h){var p=h+this.timeAdded;p<Mn.now()||this.fadeEndTime&&p<this.fadeEndTime||(this.fadeEndTime=p)},zs.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},zs.prototype.loadVectorData=function(h,p,m){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",h){for(var E in h.featureIndex&&(this.latestFeatureIndex=h.featureIndex,h.rawTileData?(this.latestRawTileData=h.rawTileData,this.latestFeatureIndex.rawTileData=h.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=h.collisionBoxArray,this.buckets=function(G,Z){var K={};if(!Z)return K;for(var nt=function(){var Rt=St[lt],Gt=Rt.layerIds.map(function(le){return Z.getLayer(le)}).filter(Boolean);if(Gt.length!==0){Rt.layers=Gt,Rt.stateDependentLayerIds&&(Rt.stateDependentLayers=Rt.stateDependentLayerIds.map(function(le){return Gt.filter(function(xe){return xe.id===le})[0]}));for(var Nt=0,ne=Gt;Nt<ne.length;Nt+=1)K[ne[Nt].id]=Rt}},lt=0,St=G;lt<St.length;lt+=1)nt();return K}(h.buckets,p.style),this.hasSymbolBuckets=!1,this.buckets){var T=this.buckets[E];if(T instanceof Xr){if(this.hasSymbolBuckets=!0,!m)break;T.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var I in this.buckets){var P=this.buckets[I];if(P instanceof Xr&&P.hasRTLText){this.hasRTLText=!0,Ql.isLoading()||Ql.isLoaded()||H0()!=="deferred"||Ml();break}}for(var B in this.queryPadding=0,this.buckets){var H=this.buckets[B];this.queryPadding=Math.max(this.queryPadding,p.style.getLayer(B).queryRadius(H))}h.imageAtlas&&(this.imageAtlas=h.imageAtlas),h.glyphAtlasImage&&(this.glyphAtlasImage=h.glyphAtlasImage)}else this.collisionBoxArray=new b},zs.prototype.unloadVectorData=function(){for(var h in this.buckets)this.buckets[h].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},zs.prototype.getBucket=function(h){return this.buckets[h.id]},zs.prototype.upload=function(h){for(var p in this.buckets){var m=this.buckets[p];m.uploadPending()&&m.upload(h)}var E=h.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Z0(h,this.imageAtlas.image,E.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Z0(h,this.glyphAtlasImage,E.ALPHA),this.glyphAtlasImage=null)},zs.prototype.prepare=function(h){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(h,this.imageAtlasTexture)},zs.prototype.queryRenderedFeatures=function(h,p,m,E,T,I,P,B,H,G){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:E,cameraQueryGeometry:T,scale:I,tileSize:this.tileSize,pixelPosMatrix:G,transform:B,params:P,queryPadding:this.queryPadding*H},h,p,m):{}},zs.prototype.querySourceFeatures=function(h,p){var m=this.latestFeatureIndex;if(m&&m.rawTileData){var E=m.loadVTLayers(),T=p?p.sourceLayer:"",I=E._geojsonTileLayer||E[T];if(I)for(var P=cf(p&&p.filter),B=this.tileID.canonical,H=B.z,G=B.x,Z=B.y,K={z:H,x:G,y:Z},nt=0;nt<I.length;nt++){var lt=I.feature(nt);if(P.needGeometry){var St=Ya(lt,!0);if(!P.filter(new Vn(this.tileID.overscaledZ),St,this.tileID.canonical))continue}else if(!P.filter(new Vn(this.tileID.overscaledZ),lt))continue;var Rt=m.getId(lt,T),Gt=new M2(lt,H,G,Z,Rt);Gt.tile=K,h.push(Gt)}}},zs.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},zs.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},zs.prototype.setExpiryData=function(h){var p=this.expirationTime;if(h.cacheControl){var m=kt(h.cacheControl);m["max-age"]&&(this.expirationTime=Date.now()+1e3*m["max-age"])}else h.expires&&(this.expirationTime=new Date(h.expires).getTime());if(this.expirationTime){var E=Date.now(),T=!1;if(this.expirationTime>E)T=!1;else if(p)if(this.expirationTime<p)T=!0;else{var I=this.expirationTime-p;I?this.expirationTime=E+Math.max(I,3e4):T=!0}else T=!0;T?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},zs.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},zs.prototype.setFeatureState=function(h,p){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(h).length!==0){var m=this.latestFeatureIndex.loadVTLayers();for(var E in this.buckets)if(p.style.hasLayer(E)){var T=this.buckets[E],I=T.layers[0].sourceLayer||"_geojsonTileLayer",P=m[I],B=h[I];if(P&&B&&Object.keys(B).length!==0){T.update(B,P,this.imageAtlas&&this.imageAtlas.patternPositions||{});var H=p&&p.style&&p.style.getLayer(E);H&&(this.queryPadding=Math.max(this.queryPadding,H.queryRadius(T)))}}}},zs.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},zs.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Mn.now()},zs.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},zs.prototype.setHoldDuration=function(h){this.symbolFadeHoldUntil=Mn.now()+h},zs.prototype.setDependencies=function(h,p){for(var m={},E=0,T=p;E<T.length;E+=1)m[T[E]]=!0;this.dependencies[h]=m},zs.prototype.hasDependency=function(h,p){for(var m=0,E=h;m<E.length;m+=1){var T=this.dependencies[E[m]];if(T){for(var I=0,P=p;I<P.length;I+=1)if(T[P[I]])return!0}}return!1};var Jg=d.performance,L8=function(h){this._marks={start:[h.url,"start"].join("#"),end:[h.url,"end"].join("#"),measure:h.url.toString()},Jg.mark(this._marks.start)};L8.prototype.finish=function(){Jg.mark(this._marks.end);var h=Jg.getEntriesByName(this._marks.measure);return h.length===0&&(Jg.measure(this._marks.measure,this._marks.start,this._marks.end),h=Jg.getEntriesByName(this._marks.measure),Jg.clearMarks(this._marks.start),Jg.clearMarks(this._marks.end),Jg.clearMeasures(this._marks.measure)),h},o.Actor=o1,o.AlphaImage=fp,o.CanonicalTileID=K0,o.CollisionBoxArray=b,o.Color=oi,o.DEMData=Pv,o.DataConstantProperty=on,o.DictionaryCoder=A2,o.EXTENT=8192,o.ErrorEvent=Xt,o.EvaluationParameters=Vn,o.Event=Mt,o.Evented=Qt,o.FeatureIndex=Dv,o.FillBucket=Eh,o.FillExtrusionBucket=Ks,o.ImageAtlas=Ue,o.ImagePosition=Er,o.LineBucket=cl,o.LngLat=Za,o.LngLatBounds=vs,o.MercatorCoordinate=q0,o.ONE_EM=24,o.OverscaledTileID=gs,o.Point=c,o.Point$1=c,o.Properties=Va,o.Protobuf=ye,o.RGBAImage=ll,o.RequestManager=Kn,o.RequestPerformance=L8,o.ResourceType=sh,o.SegmentVector=ht,o.SourceFeatureState=s1,o.StructArrayLayout1ui2=Wg,o.StructArrayLayout2f1f2i16=dd,o.StructArrayLayout2i4=vf,o.StructArrayLayout3ui6=wc,o.StructArrayLayout4i8=$g,o.SymbolBucket=Xr,o.Texture=Z0,o.Tile=zs,o.Transitionable=hs,o.Uniform1f=cr,o.Uniform1i=Ve,o.Uniform2f=ar,o.Uniform3f=Mr,o.Uniform4f=sn,o.UniformColor=hn,o.UniformMatrix4f=Ii,o.UnwrappedTileID=M8,o.ValidationError=Pt,o.WritingMode=dn,o.ZoomHistory=Bg,o.add=function(h,p,m){return h[0]=p[0]+m[0],h[1]=p[1]+m[1],h[2]=p[2]+m[2],h},o.addDynamicAttributes=je,o.asyncAll=function(h,p,m){if(!h.length)return m(null,[]);var E=h.length,T=new Array(h.length),I=null;h.forEach(function(P,B){p(P,function(H,G){H&&(I=H),T[B]=G,--E==0&&m(I,T)})})},o.bezier=g,o.bindAll=k,o.browser=Mn,o.cacheEntryPossiblyAdded=function(h){++oh>dc&&(h.getActor().send("enforceCacheSizeLimit",us),oh=0)},o.clamp=w,o.clearTileCache=function(h){var p=d.caches.delete("mapbox-tiles");h&&p.catch(h).then(function(){return h()})},o.clipLine=wh,o.clone=function(h){var p=new _i(16);return p[0]=h[0],p[1]=h[1],p[2]=h[2],p[3]=h[3],p[4]=h[4],p[5]=h[5],p[6]=h[6],p[7]=h[7],p[8]=h[8],p[9]=h[9],p[10]=h[10],p[11]=h[11],p[12]=h[12],p[13]=h[13],p[14]=h[14],p[15]=h[15],p},o.clone$1=X,o.clone$2=function(h){var p=new _i(3);return p[0]=h[0],p[1]=h[1],p[2]=h[2],p},o.collisionCircleLayout=W,o.config=ee,o.create=function(){var h=new _i(16);return _i!=Float32Array&&(h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[11]=0,h[12]=0,h[13]=0,h[14]=0),h[0]=1,h[5]=1,h[10]=1,h[15]=1,h},o.create$1=function(){var h=new _i(9);return _i!=Float32Array&&(h[1]=0,h[2]=0,h[3]=0,h[5]=0,h[6]=0,h[7]=0),h[0]=1,h[4]=1,h[8]=1,h},o.create$2=function(){var h=new _i(4);return _i!=Float32Array&&(h[1]=0,h[2]=0),h[0]=1,h[3]=1,h},o.createCommonjsModule=s,o.createExpression=rp,o.createLayout=Wo,o.createStyleLayer=function(h){return h.type==="custom"?new S2(h):new _d[h.type](h)},o.cross=function(h,p,m){var E=p[0],T=p[1],I=p[2],P=m[0],B=m[1],H=m[2];return h[0]=T*H-I*B,h[1]=I*P-E*H,h[2]=E*B-T*P,h},o.deepEqual=function h(p,m){if(Array.isArray(p)){if(!Array.isArray(m)||p.length!==m.length)return!1;for(var E=0;E<p.length;E++)if(!h(p[E],m[E]))return!1;return!0}if(typeof p=="object"&&p!==null&&m!==null){if(typeof m!="object"||Object.keys(p).length!==Object.keys(m).length)return!1;for(var T in p)if(!h(p[T],m[T]))return!1;return!0}return p===m},o.dot=function(h,p){return h[0]*p[0]+h[1]*p[1]+h[2]*p[2]},o.dot$1=function(h,p){return h[0]*p[0]+h[1]*p[1]+h[2]*p[2]+h[3]*p[3]},o.ease=x,o.emitValidationErrors=df,o.endsWith=V,o.enforceCacheSizeLimit=function(h){fo(),os&&os.then(function(p){p.keys().then(function(m){for(var E=0;E<m.length-h;E++)p.delete(m[E])})})},o.evaluateSizeForFeature=Qs,o.evaluateSizeForZoom=qo,o.evaluateVariableOffset=Yt,o.evented=Ug,o.extend=A,o.featureFilter=cf,o.filterObject=Y,o.fromRotation=function(h,p){var m=Math.sin(p),E=Math.cos(p);return h[0]=E,h[1]=m,h[2]=0,h[3]=-m,h[4]=E,h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},o.getAnchorAlignment=Ia,o.getAnchorJustification=Jt,o.getArrayBuffer=id,o.getImage=rt,o.getJSON=function(h,p){return pc(A(h,{type:"json"}),p)},o.getRTLTextPluginStatus=H0,o.getReferrer=lh,o.getVideo=function(h,p){var m,E,T=d.document.createElement("video");T.muted=!0,T.onloadstart=function(){p(null,T)};for(var I=0;I<h.length;I++){var P=d.document.createElement("source");m=h[I],E=void 0,(E=d.document.createElement("a")).href=m,(E.protocol!==d.document.location.protocol||E.host!==d.document.location.host)&&(T.crossOrigin="Anonymous"),P.src=h[I],T.appendChild(P)}return{cancel:function(){}}},o.identity=ds,o.invert=function(h,p){var m=p[0],E=p[1],T=p[2],I=p[3],P=p[4],B=p[5],H=p[6],G=p[7],Z=p[8],K=p[9],nt=p[10],lt=p[11],St=p[12],Rt=p[13],Gt=p[14],Nt=p[15],ne=m*B-E*P,le=m*H-T*P,xe=m*G-I*P,we=E*H-T*B,$e=E*G-I*B,sr=T*G-I*H,yr=Z*Rt-K*St,ln=Z*Gt-nt*St,Dr=Z*Nt-lt*St,pn=K*Gt-nt*Rt,zr=K*Nt-lt*Rt,li=nt*Nt-lt*Gt,In=ne*li-le*zr+xe*pn+we*Dr-$e*ln+sr*yr;return In?(h[0]=(B*li-H*zr+G*pn)*(In=1/In),h[1]=(T*zr-E*li-I*pn)*In,h[2]=(Rt*sr-Gt*$e+Nt*we)*In,h[3]=(nt*$e-K*sr-lt*we)*In,h[4]=(H*Dr-P*li-G*ln)*In,h[5]=(m*li-T*Dr+I*ln)*In,h[6]=(Gt*xe-St*sr-Nt*le)*In,h[7]=(Z*sr-nt*xe+lt*le)*In,h[8]=(P*zr-B*Dr+G*yr)*In,h[9]=(E*Dr-m*zr-I*yr)*In,h[10]=(St*$e-Rt*xe+Nt*ne)*In,h[11]=(K*xe-Z*$e-lt*ne)*In,h[12]=(B*ln-P*pn-H*yr)*In,h[13]=(m*pn-E*ln+T*yr)*In,h[14]=(Rt*le-St*we-Gt*ne)*In,h[15]=(Z*we-K*le+nt*ne)*In,h):null},o.isChar=_r,o.isMapboxURL=vn,o.keysDifference=function(h,p){var m=[];for(var E in h)E in p||m.push(E);return m},o.makeRequest=pc,o.mapObject=Q,o.mercatorXfromLng=S8,o.mercatorYfromLat=T8,o.mercatorZfromAltitude=A8,o.mul=jg,o.multiply=Ro,o.mvt=yp,o.nextPowerOfTwo=function(h){return h<=1?1:Math.pow(2,Math.ceil(Math.log(h)/Math.LN2))},o.normalize=function(h,p){var m=p[0],E=p[1],T=p[2],I=m*m+E*E+T*T;return I>0&&(I=1/Math.sqrt(I)),h[0]=p[0]*I,h[1]=p[1]*I,h[2]=p[2]*I,h},o.number=no,o.offscreenCanvasSupported=nd,o.ortho=function(h,p,m,E,T,I,P){var B=1/(p-m),H=1/(E-T),G=1/(I-P);return h[0]=-2*B,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=-2*H,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=2*G,h[11]=0,h[12]=(p+m)*B,h[13]=(T+E)*H,h[14]=(P+I)*G,h[15]=1,h},o.parseGlyphPBF=function(h){return new ye(h).readFields(Xe,[])},o.pbf=ye,o.performSymbolLayout=function(h,p,m,E,T,I,P){h.createArrays(),h.tilePixelRatio=8192/(512*h.overscaling),h.compareText={},h.iconsNeedLinear=!1;var B=h.layers[0].layout,H=h.layers[0]._unevaluatedLayout._values,G={};if(h.textSizeData.kind==="composite"){var Z=h.textSizeData,K=Z.maxZoom;G.compositeTextSizes=[H["text-size"].possiblyEvaluate(new Vn(Z.minZoom),P),H["text-size"].possiblyEvaluate(new Vn(K),P)]}if(h.iconSizeData.kind==="composite"){var nt=h.iconSizeData,lt=nt.maxZoom;G.compositeIconSizes=[H["icon-size"].possiblyEvaluate(new Vn(nt.minZoom),P),H["icon-size"].possiblyEvaluate(new Vn(lt),P)]}G.layoutTextSize=H["text-size"].possiblyEvaluate(new Vn(h.zoom+1),P),G.layoutIconSize=H["icon-size"].possiblyEvaluate(new Vn(h.zoom+1),P),G.textMaxSize=H["text-size"].possiblyEvaluate(new Vn(18));for(var St=24*B.get("text-line-height"),Rt=B.get("text-rotation-alignment")==="map"&&B.get("symbol-placement")!=="point",Gt=B.get("text-keep-upright"),Nt=B.get("text-size"),ne=function(){var we=xe[le],$e=B.get("text-font").evaluate(we,{},P).join(","),sr=Nt.evaluate(we,{},P),yr=G.layoutTextSize.evaluate(we,{},P),ln=G.layoutIconSize.evaluate(we,{},P),Dr={horizontal:{},vertical:void 0},pn=we.text,zr=[0,0];if(pn){var li=pn.toString(),In=24*B.get("text-letter-spacing").evaluate(we,{},P),Kr=function(Si){for(var Ca=0,da=Si;Ca<da.length;Ca+=1)if(Vi=da[Ca].charCodeAt(0),_r.Arabic(Vi)||_r["Arabic Supplement"](Vi)||_r["Arabic Extended-A"](Vi)||_r["Arabic Presentation Forms-A"](Vi)||_r["Arabic Presentation Forms-B"](Vi))return!1;var Vi;return!0}(li)?In:0,gi=B.get("text-anchor").evaluate(we,{},P),Zn=B.get("text-variable-anchor");if(!Zn){var Bi=B.get("text-radial-offset").evaluate(we,{},P);zr=Bi?Yt(gi,[24*Bi,Ht]):B.get("text-offset").evaluate(we,{},P).map(function(Si){return 24*Si})}var gn=Rt?"center":B.get("text-justify").evaluate(we,{},P),Yi=B.get("symbol-placement"),qa=Yi==="point"?24*B.get("text-max-width").evaluate(we,{},P):0,bo=function(){h.allowVerticalPlacement&&mh(li)&&(Dr.vertical=ti(pn,p,m,T,$e,qa,St,gi,"left",Kr,zr,dn.vertical,!0,Yi,yr,sr))};if(!Rt&&Zn){for(var go=gn==="auto"?Zn.map(function(Si){return Jt(Si)}):[gn],Ka=!1,Eo=0;Eo<go.length;Eo++){var As=go[Eo];if(!Dr.horizontal[As])if(Ka)Dr.horizontal[As]=Dr.horizontal[0];else{var Ms=ti(pn,p,m,T,$e,qa,St,"center",As,Kr,zr,dn.horizontal,!1,Yi,yr,sr);Ms&&(Dr.horizontal[As]=Ms,Ka=Ms.positionedLines.length===1)}}bo()}else{gn==="auto"&&(gn=Jt(gi));var Ol=ti(pn,p,m,T,$e,qa,St,gi,gn,Kr,zr,dn.horizontal,!1,Yi,yr,sr);Ol&&(Dr.horizontal[gn]=Ol),bo(),mh(li)&&Rt&&Gt&&(Dr.vertical=ti(pn,p,m,T,$e,qa,St,gi,gn,Kr,zr,dn.vertical,!1,Yi,yr,sr))}}var Us=void 0,Pl=!1;if(we.icon&&we.icon.name){var Po=E[we.icon.name];Po&&(Us=function(Si,Ca,da){var Vi=Ia(da),eu=Ca[0]-Si.displaySize[0]*Vi.horizontalAlign,hl=Ca[1]-Si.displaySize[1]*Vi.verticalAlign;return{image:Si,top:hl,bottom:hl+Si.displaySize[1],left:eu,right:eu+Si.displaySize[0]}}(T[we.icon.name],B.get("icon-offset").evaluate(we,{},P),B.get("icon-anchor").evaluate(we,{},P)),Pl=Po.sdf,h.sdfIcons===void 0?h.sdfIcons=Po.sdf:h.sdfIcons!==Po.sdf&&it("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Po.pixelRatio!==h.pixelRatio||B.get("icon-rotate").constantOr(1)!==0)&&(h.iconsNeedLinear=!0))}var $s=Wt(Dr.horizontal)||Dr.vertical;h.iconsInText=!!$s&&$s.iconsInText,($s||Us)&&function(Si,Ca,da,Vi,eu,hl,Wa,Qo,fl,Zi,_p){var Mc=hl.textMaxSize.evaluate(Ca,{});Mc===void 0&&(Mc=Wa);var xp,Do=Si.layers[0].layout,bp=Do.get("icon-offset").evaluate(Ca,{},_p),bf=Wt(da.horizontal),l1=Wa/24,Q0=Si.tilePixelRatio*l1,u1=Si.tilePixelRatio*Mc/24,Fv=Si.tilePixelRatio*Qo,c1=Si.tilePixelRatio*Do.get("symbol-spacing"),R2=Do.get("text-padding")*Si.tilePixelRatio,h1=Do.get("icon-padding")*Si.tilePixelRatio,sE=Do.get("text-max-angle")/180*Math.PI,I2=Do.get("text-rotation-alignment")==="map"&&Do.get("symbol-placement")!=="point",L2=Do.get("icon-rotation-alignment")==="map"&&Do.get("symbol-placement")!=="point",Bv=Do.get("symbol-placement"),lE=c1/2,f1=Do.get("icon-text-fit");Vi&&f1!=="none"&&(Si.allowVerticalPlacement&&da.vertical&&(xp=Zo(Vi,da.vertical,f1,Do.get("icon-text-fit-padding"),bp,l1)),bf&&(Vi=Zo(Vi,bf,f1,Do.get("icon-text-fit-padding"),bp,l1)));var tm=function($ht,gE){gE.x<0||gE.x>=8192||gE.y<0||gE.y>=8192||function(Fo,xd,Hht,em,PL,D8,N2,Ep,k2,mE,z2,U2,DL,F8,yE,B8,N8,k8,z8,U8,Rc,$2,$8,wp,Vht){var H8,ty,m1,y1,_1,x1=Fo.addToLineVertexArray(xd,Hht),V8=0,G8=0,W8=0,X8=0,FL=-1,BL=-1,Nv={},j8=Ct(""),NL=0,kL=0;if(Ep._unevaluatedLayout.getValue("text-radial-offset")===void 0?(NL=(H8=Ep.layout.get("text-offset").evaluate(Rc,{},wp).map(function(xE){return 24*xE}))[0],kL=H8[1]):(NL=24*Ep.layout.get("text-radial-offset").evaluate(Rc,{},wp),kL=Ht),Fo.allowVerticalPlacement&&em.vertical){var Y8=Ep.layout.get("text-rotate").evaluate(Rc,{},wp)+90;y1=new fa(k2,xd,mE,z2,U2,em.vertical,DL,F8,yE,Y8),N2&&(_1=new fa(k2,xd,mE,z2,U2,N2,N8,k8,yE,Y8))}if(PL){var zL=Ep.layout.get("icon-rotate").evaluate(Rc,{}),Z8=Ep.layout.get("icon-text-fit")!=="none",q8=It(PL,zL,$8,Z8),UL=N2?It(N2,zL,$8,Z8):void 0;m1=new fa(k2,xd,mE,z2,U2,PL,N8,k8,!1,zL),V8=4*q8.length;var K8=Fo.iconSizeData,_E=null;K8.kind==="source"?(_E=[128*Ep.layout.get("icon-size").evaluate(Rc,{})])[0]>32640&&it(Fo.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):K8.kind==="composite"&&((_E=[128*$2.compositeIconSizes[0].evaluate(Rc,{},wp),128*$2.compositeIconSizes[1].evaluate(Rc,{},wp)])[0]>32640||_E[1]>32640)&&it(Fo.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Fo.addSymbols(Fo.icon,q8,_E,U8,z8,Rc,!1,xd,x1.lineStartIndex,x1.lineLength,-1,wp),FL=Fo.icon.placedSymbolArray.length-1,UL&&(G8=4*UL.length,Fo.addSymbols(Fo.icon,UL,_E,U8,z8,Rc,dn.vertical,xd,x1.lineStartIndex,x1.lineLength,-1,wp),BL=Fo.icon.placedSymbolArray.length-1)}for(var Q8 in em.horizontal){var H2=em.horizontal[Q8];if(!ty){j8=Ct(H2.text);var Ght=Ep.layout.get("text-rotate").evaluate(Rc,{},wp);ty=new fa(k2,xd,mE,z2,U2,H2,DL,F8,yE,Ght)}var J8=H2.positionedLines.length===1;if(W8+=Lt(Fo,xd,H2,D8,Ep,yE,Rc,B8,x1,em.vertical?dn.horizontal:dn.horizontalOnly,J8?Object.keys(em.horizontal):[Q8],Nv,FL,$2,wp),J8)break}em.vertical&&(X8+=Lt(Fo,xd,em.vertical,D8,Ep,yE,Rc,B8,x1,dn.vertical,["vertical"],Nv,BL,$2,wp));var Wht=ty?ty.boxStartIndex:Fo.collisionBoxArray.length,Xht=ty?ty.boxEndIndex:Fo.collisionBoxArray.length,jht=y1?y1.boxStartIndex:Fo.collisionBoxArray.length,Yht=y1?y1.boxEndIndex:Fo.collisionBoxArray.length,Zht=m1?m1.boxStartIndex:Fo.collisionBoxArray.length,qht=m1?m1.boxEndIndex:Fo.collisionBoxArray.length,Kht=_1?_1.boxStartIndex:Fo.collisionBoxArray.length,Qht=_1?_1.boxEndIndex:Fo.collisionBoxArray.length,Cp=-1,V2=function(xE,e7){return xE&&xE.circleDiameter?Math.max(xE.circleDiameter,e7):e7};Cp=V2(ty,Cp),Cp=V2(y1,Cp),Cp=V2(m1,Cp);var t7=(Cp=V2(_1,Cp))>-1?1:0;t7&&(Cp*=Vht/24),Fo.glyphOffsetArray.length>=Xr.MAX_GLYPHS&&it("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Rc.sortKey!==void 0&&Fo.addToSortKeyRanges(Fo.symbolInstances.length,Rc.sortKey),Fo.symbolInstances.emplaceBack(xd.x,xd.y,Nv.right>=0?Nv.right:-1,Nv.center>=0?Nv.center:-1,Nv.left>=0?Nv.left:-1,Nv.vertical||-1,FL,BL,j8,Wht,Xht,jht,Yht,Zht,qht,Kht,Qht,mE,W8,X8,V8,G8,t7,0,DL,NL,kL,Cp)}(Si,gE,$ht,da,Vi,eu,xp,Si.layers[0],Si.collisionBoxArray,Ca.index,Ca.sourceLayerIndex,Si.index,Q0,R2,I2,fl,Fv,h1,L2,bp,Ca,hl,Zi,_p,Wa)};if(Bv==="line")for(var d1=0,O2=wh(Ca.geometry,0,0,8192,8192);d1<O2.length;d1+=1)for(var P2=O2[d1],uE=0,cE=Oo(P2,c1,sE,da.vertical||bf,Vi,24,u1,Si.overscaling,8192);uE<cE.length;uE+=1){var D2=cE[uE];bf&&_t(Si,bf.text,lE,D2)||tm(P2,D2)}else if(Bv==="line-center")for(var hE=0,fE=Ca.geometry;hE<fE.length;hE+=1){var dE=fE[hE];if(dE.length>1){var F2=Fi(dE,sE,da.vertical||bf,Vi,24,u1);F2&&tm(dE,F2)}}else if(Ca.type==="Polygon")for(var p1=0,B2=n1(Ca.geometry,0);p1<B2.length;p1+=1){var v1=B2[p1],pE=Bt(v1,16);tm(v1[0],new so(pE.x,pE.y,0))}else if(Ca.type==="LineString")for(var J0=0,vE=Ca.geometry;J0<vE.length;J0+=1){var g1=vE[J0];tm(g1,new so(g1[0].x,g1[0].y,0))}else if(Ca.type==="Point")for(var IL=0,O8=Ca.geometry;IL<O8.length;IL+=1)for(var LL=0,P8=O8[IL];LL<P8.length;LL+=1){var OL=P8[LL];tm([OL],new so(OL.x,OL.y,0))}}(h,we,Dr,Us,E,G,yr,ln,zr,Pl,P)},le=0,xe=h.features;le<xe.length;le+=1)ne();I&&h.generateCollisionDebugBuffers()},o.perspective=function(h,p,m,E,T){var I,P=1/Math.tan(p/2);return h[0]=P/m,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=P,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[11]=-1,h[12]=0,h[13]=0,h[15]=0,T!=null&&T!==1/0?(h[10]=(T+E)*(I=1/(E-T)),h[14]=2*T*E*I):(h[10]=-1,h[14]=-2*E),h},o.pick=function(h,p){for(var m={},E=0;E<p.length;E++){var T=p[E];T in h&&(m[T]=h[T])}return m},o.plugin=Ql,o.polygonIntersectsPolygon=Cc,o.postMapLoadEvent=il,o.postTurnstileEvent=va,o.potpack=Bn,o.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],o.register=Wr,o.registerForPluginStateChange=function(h){return h({pluginStatus:Ys,pluginURL:bc}),Ug.on("pluginStateChange",h),h},o.renderColorRamp=u2,o.rotate=function(h,p,m){var E=p[0],T=p[1],I=p[2],P=p[3],B=Math.sin(m),H=Math.cos(m);return h[0]=E*H+I*B,h[1]=T*H+P*B,h[2]=E*-B+I*H,h[3]=T*-B+P*H,h},o.rotateX=function(h,p,m){var E=Math.sin(m),T=Math.cos(m),I=p[4],P=p[5],B=p[6],H=p[7],G=p[8],Z=p[9],K=p[10],nt=p[11];return p!==h&&(h[0]=p[0],h[1]=p[1],h[2]=p[2],h[3]=p[3],h[12]=p[12],h[13]=p[13],h[14]=p[14],h[15]=p[15]),h[4]=I*T+G*E,h[5]=P*T+Z*E,h[6]=B*T+K*E,h[7]=H*T+nt*E,h[8]=G*T-I*E,h[9]=Z*T-P*E,h[10]=K*T-B*E,h[11]=nt*T-H*E,h},o.rotateZ=function(h,p,m){var E=Math.sin(m),T=Math.cos(m),I=p[0],P=p[1],B=p[2],H=p[3],G=p[4],Z=p[5],K=p[6],nt=p[7];return p!==h&&(h[8]=p[8],h[9]=p[9],h[10]=p[10],h[11]=p[11],h[12]=p[12],h[13]=p[13],h[14]=p[14],h[15]=p[15]),h[0]=I*T+G*E,h[1]=P*T+Z*E,h[2]=B*T+K*E,h[3]=H*T+nt*E,h[4]=G*T-I*E,h[5]=Z*T-P*E,h[6]=K*T-B*E,h[7]=nt*T-H*E,h},o.scale=function(h,p,m){var E=m[0],T=m[1],I=m[2];return h[0]=p[0]*E,h[1]=p[1]*E,h[2]=p[2]*E,h[3]=p[3]*E,h[4]=p[4]*T,h[5]=p[5]*T,h[6]=p[6]*T,h[7]=p[7]*T,h[8]=p[8]*I,h[9]=p[9]*I,h[10]=p[10]*I,h[11]=p[11]*I,h[12]=p[12],h[13]=p[13],h[14]=p[14],h[15]=p[15],h},o.scale$1=function(h,p,m){return h[0]=p[0]*m,h[1]=p[1]*m,h[2]=p[2]*m,h[3]=p[3]*m,h},o.scale$2=function(h,p,m){return h[0]=p[0]*m,h[1]=p[1]*m,h[2]=p[2]*m,h},o.setCacheLimits=function(h,p){us=h,dc=p},o.setRTLTextPlugin=function(h,p,m){if(m===void 0&&(m=!1),Ys==="deferred"||Ys==="loading"||Ys==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");bc=Mn.resolveURL(h),Ys="deferred",zg=p,sp(),m||Ml()},o.sphericalToCartesian=function(h){var p=h[0],m=h[1],E=h[2];return m+=90,m*=Math.PI/180,E*=Math.PI/180,{x:p*Math.cos(m)*Math.sin(E),y:p*Math.sin(m)*Math.sin(E),z:p*Math.cos(E)}},o.sqrLen=function(h){var p=h[0],m=h[1];return p*p+m*m},o.styleSpec=ct,o.sub=function(h,p,m){return h[0]=p[0]-m[0],h[1]=p[1]-m[1],h[2]=p[2]-m[2],h},o.symbolSize=Qn,o.transformMat3=function(h,p,m){var E=p[0],T=p[1],I=p[2];return h[0]=E*m[0]+T*m[3]+I*m[6],h[1]=E*m[1]+T*m[4]+I*m[7],h[2]=E*m[2]+T*m[5]+I*m[8],h},o.transformMat4=_f,o.translate=function(h,p,m){var E,T,I,P,B,H,G,Z,K,nt,lt,St,Rt=m[0],Gt=m[1],Nt=m[2];return p===h?(h[12]=p[0]*Rt+p[4]*Gt+p[8]*Nt+p[12],h[13]=p[1]*Rt+p[5]*Gt+p[9]*Nt+p[13],h[14]=p[2]*Rt+p[6]*Gt+p[10]*Nt+p[14],h[15]=p[3]*Rt+p[7]*Gt+p[11]*Nt+p[15]):(T=p[1],I=p[2],P=p[3],B=p[4],H=p[5],G=p[6],Z=p[7],K=p[8],nt=p[9],lt=p[10],St=p[11],h[0]=E=p[0],h[1]=T,h[2]=I,h[3]=P,h[4]=B,h[5]=H,h[6]=G,h[7]=Z,h[8]=K,h[9]=nt,h[10]=lt,h[11]=St,h[12]=E*Rt+B*Gt+K*Nt+p[12],h[13]=T*Rt+H*Gt+nt*Nt+p[13],h[14]=I*Rt+G*Gt+lt*Nt+p[14],h[15]=P*Rt+Z*Gt+St*Nt+p[15]),h},o.triggerPluginCompletionEvent=q_,o.uniqueId=R,o.validateCustomStyleLayer=function(h){var p=[],m=h.id;return m===void 0&&p.push({message:"layers."+m+': missing required property "id"'}),h.render===void 0&&p.push({message:"layers."+m+': missing required method "render"'}),h.renderingMode&&h.renderingMode!=="2d"&&h.renderingMode!=="3d"&&p.push({message:"layers."+m+': property "renderingMode" must be either "2d" or "3d"'}),p},o.validateLight=Z_,o.validateStyle=_v,o.values=function(h){var p=[];for(var m in h)p.push(h[m]);return p},o.vectorTile=yp,o.version="1.13.3",o.warnOnce=it,o.webpSupported=rr,o.window=d,o.wrap=S}),a(["./shared"],function(o){function s(J){var rt=typeof J;if(rt==="number"||rt==="boolean"||rt==="string"||J==null)return JSON.stringify(J);if(Array.isArray(J)){for(var at="[",mt=0,Mt=J;mt<Mt.length;mt+=1)at+=s(Mt[mt])+",";return at+"]"}for(var Xt=Object.keys(J).sort(),Qt="{",ct=0;ct<Xt.length;ct++)Qt+=JSON.stringify(Xt[ct])+":"+s(J[Xt[ct]])+",";return Qt+"}"}function l(J){for(var rt="",at=0,mt=o.refProperties;at<mt.length;at+=1)rt+="/"+s(J[mt[at]]);return rt}var u=function(J){this.keyCache={},J&&this.replace(J)};u.prototype.replace=function(J){this._layerConfigs={},this._layers={},this.update(J,[])},u.prototype.update=function(J,rt){for(var at=this,mt=0,Mt=J;mt<Mt.length;mt+=1){var Xt=Mt[mt];this._layerConfigs[Xt.id]=Xt;var Qt=this._layers[Xt.id]=o.createStyleLayer(Xt);Qt._featureFilter=o.featureFilter(Qt.filter),this.keyCache[Xt.id]&&delete this.keyCache[Xt.id]}for(var ct=0,Pt=rt;ct<Pt.length;ct+=1){var oe=Pt[ct];delete this.keyCache[oe],delete this._layerConfigs[oe],delete this._layers[oe]}this.familiesBySource={};for(var Le=0,tr=function(dr,gr){for(var kn={},wr=0;wr<dr.length;wr++){var ci=gr&&gr[dr[wr].id]||l(dr[wr]);gr&&(gr[dr[wr].id]=ci);var ea=kn[ci];ea||(ea=kn[ci]=[]),ea.push(dr[wr])}var ai=[];for(var wi in kn)ai.push(kn[wi]);return ai}(o.values(this._layerConfigs),this.keyCache);Le<tr.length;Le+=1){var Te=tr[Le].map(function(dr){return at._layers[dr.id]}),Ze=Te[0];if(Ze.visibility!=="none"){var jr=Ze.source||"",Ur=this.familiesBySource[jr];Ur||(Ur=this.familiesBySource[jr]={});var Re=Ze.sourceLayer||"_geojsonTileLayer",Ar=Ur[Re];Ar||(Ar=Ur[Re]=[]),Ar.push(Te)}}};var c=function(J){var rt={},at=[];for(var mt in J){var Mt=J[mt],Xt=rt[mt]={};for(var Qt in Mt){var ct=Mt[+Qt];if(ct&&ct.bitmap.width!==0&&ct.bitmap.height!==0){var Pt={x:0,y:0,w:ct.bitmap.width+2,h:ct.bitmap.height+2};at.push(Pt),Xt[Qt]={rect:Pt,metrics:ct.metrics}}}}var oe=o.potpack(at),Le=new o.AlphaImage({width:oe.w||1,height:oe.h||1});for(var tr in J){var Te=J[tr];for(var Ze in Te){var jr=Te[+Ze];if(jr&&jr.bitmap.width!==0&&jr.bitmap.height!==0){var Ur=rt[tr][Ze].rect;o.AlphaImage.copy(jr.bitmap,Le,{x:0,y:0},{x:Ur.x+1,y:Ur.y+1},jr.bitmap)}}}this.image=Le,this.positions=rt};o.register("GlyphAtlas",c);var f=function(J){this.tileID=new o.OverscaledTileID(J.tileID.overscaledZ,J.tileID.wrap,J.tileID.canonical.z,J.tileID.canonical.x,J.tileID.canonical.y),this.uid=J.uid,this.zoom=J.zoom,this.pixelRatio=J.pixelRatio,this.tileSize=J.tileSize,this.source=J.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=J.showCollisionBoxes,this.collectResourceTiming=!!J.collectResourceTiming,this.returnDependencies=!!J.returnDependencies,this.promoteId=J.promoteId};function d(J,rt,at){for(var mt=new o.EvaluationParameters(rt),Mt=0,Xt=J;Mt<Xt.length;Mt+=1)Xt[Mt].recalculate(mt,at)}function v(J,rt){var at=o.getArrayBuffer(J.request,function(mt,Mt,Xt,Qt){mt?rt(mt):Mt&&rt(null,{vectorTile:new o.vectorTile.VectorTile(new o.pbf(Mt)),rawData:Mt,cacheControl:Xt,expires:Qt})});return function(){at.cancel(),rt()}}f.prototype.parse=function(J,rt,at,mt,Mt){var Xt=this;this.status="parsing",this.data=J,this.collisionBoxArray=new o.CollisionBoxArray;var Qt=new o.DictionaryCoder(Object.keys(J.layers).sort()),ct=new o.FeatureIndex(this.tileID,this.promoteId);ct.bucketLayerIDs=[];var Pt,oe,Le,tr,Te={},Ze={featureIndex:ct,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:at},jr=rt.familiesBySource[this.source];for(var Ur in jr){var Re=J.layers[Ur];if(Re){Re.version===1&&o.warnOnce('Vector tile source "'+this.source+'" layer "'+Ur+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Ar=Qt.encode(Ur),dr=[],gr=0;gr<Re.length;gr++){var kn=Re.feature(gr),wr=ct.getId(kn,Ur);dr.push({feature:kn,id:wr,index:gr,sourceLayerIndex:Ar})}for(var ci=0,ea=jr[Ur];ci<ea.length;ci+=1){var ai=ea[ci],wi=ai[0];wi.minzoom&&this.zoom<Math.floor(wi.minzoom)||wi.maxzoom&&this.zoom>=wi.maxzoom||wi.visibility!=="none"&&(d(ai,this.zoom,at),(Te[wi.id]=wi.createBucket({index:ct.bucketLayerIDs.length,layers:ai,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ar,sourceID:this.source})).populate(dr,Ze,this.tileID.canonical),ct.bucketLayerIDs.push(ai.map(function(Di){return Di.id})))}}}var zn=o.mapObject(Ze.glyphDependencies,function(Di){return Object.keys(Di).map(Number)});Object.keys(zn).length?mt.send("getGlyphs",{uid:this.uid,stacks:zn},function(Di,Un){Pt||(Pt=Di,oe=Un,ra.call(Xt))}):oe={};var po=Object.keys(Ze.iconDependencies);po.length?mt.send("getImages",{icons:po,source:this.source,tileID:this.tileID,type:"icons"},function(Di,Un){Pt||(Pt=Di,Le=Un,ra.call(Xt))}):Le={};var pi=Object.keys(Ze.patternDependencies);function ra(){if(Pt)return Mt(Pt);if(oe&&Le&&tr){var Di=new c(oe),Un=new o.ImageAtlas(Le,tr);for(var oi in Te){var Es=Te[oi];Es instanceof o.SymbolBucket?(d(Es.layers,this.zoom,at),o.performSymbolLayout(Es,oe,Di.positions,Le,Un.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Es.hasPattern&&(Es instanceof o.LineBucket||Es instanceof o.FillBucket||Es instanceof o.FillExtrusionBucket)&&(d(Es.layers,this.zoom,at),Es.addFeatures(Ze,this.tileID.canonical,Un.patternPositions))}this.status="done",Mt(null,{buckets:o.values(Te).filter(function(qh){return!qh.isEmpty()}),featureIndex:ct,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Di.image,imageAtlas:Un,glyphMap:this.returnDependencies?oe:null,iconMap:this.returnDependencies?Le:null,glyphPositions:this.returnDependencies?Di.positions:null})}}pi.length?mt.send("getImages",{icons:pi,source:this.source,tileID:this.tileID,type:"patterns"},function(Di,Un){Pt||(Pt=Di,tr=Un,ra.call(Xt))}):tr={},ra.call(this)};var g=function(J,rt,at,mt){this.actor=J,this.layerIndex=rt,this.availableImages=at,this.loadVectorData=mt||v,this.loading={},this.loaded={}};g.prototype.loadTile=function(J,rt){var at=this,mt=J.uid;this.loading||(this.loading={});var Mt=!!(J&&J.request&&J.request.collectResourceTiming)&&new o.RequestPerformance(J.request),Xt=this.loading[mt]=new f(J);Xt.abort=this.loadVectorData(J,function(Qt,ct){if(delete at.loading[mt],Qt||!ct)return Xt.status="done",at.loaded[mt]=Xt,rt(Qt);var Pt=ct.rawData,oe={};ct.expires&&(oe.expires=ct.expires),ct.cacheControl&&(oe.cacheControl=ct.cacheControl);var Le={};if(Mt){var tr=Mt.finish();tr&&(Le.resourceTiming=JSON.parse(JSON.stringify(tr)))}Xt.vectorTile=ct.vectorTile,Xt.parse(ct.vectorTile,at.layerIndex,at.availableImages,at.actor,function(Te,Ze){if(Te||!Ze)return rt(Te);rt(null,o.extend({rawTileData:Pt.slice(0)},Ze,oe,Le))}),at.loaded=at.loaded||{},at.loaded[mt]=Xt})},g.prototype.reloadTile=function(J,rt){var at=this,mt=this.loaded,Mt=J.uid,Xt=this;if(mt&&mt[Mt]){var Qt=mt[Mt];Qt.showCollisionBoxes=J.showCollisionBoxes;var ct=function(Pt,oe){var Le=Qt.reloadCallback;Le&&(delete Qt.reloadCallback,Qt.parse(Qt.vectorTile,Xt.layerIndex,at.availableImages,Xt.actor,Le)),rt(Pt,oe)};Qt.status==="parsing"?Qt.reloadCallback=ct:Qt.status==="done"&&(Qt.vectorTile?Qt.parse(Qt.vectorTile,this.layerIndex,this.availableImages,this.actor,ct):ct())}},g.prototype.abortTile=function(J,rt){var at=this.loading,mt=J.uid;at&&at[mt]&&at[mt].abort&&(at[mt].abort(),delete at[mt]),rt()},g.prototype.removeTile=function(J,rt){var at=this.loaded,mt=J.uid;at&&at[mt]&&delete at[mt],rt()};var x=o.window.ImageBitmap,w=function(){this.loaded={}};function S(J,rt){if(J.length!==0){A(J[0],rt);for(var at=1;at<J.length;at++)A(J[at],!rt)}}function A(J,rt){for(var at=0,mt=0,Mt=0,Xt=J.length,Qt=Xt-1;Mt<Xt;Qt=Mt++){var ct=(J[Mt][0]-J[Qt][0])*(J[Qt][1]+J[Mt][1]),Pt=at+ct;mt+=Math.abs(at)>=Math.abs(ct)?at-Pt+ct:ct-Pt+at,at=Pt}at+mt>=0!=!!rt&&J.reverse()}w.prototype.loadTile=function(J,rt){var at=J.uid,mt=J.encoding,Mt=J.rawImageData,Xt=x&&Mt instanceof x?this.getImageData(Mt):Mt,Qt=new o.DEMData(at,Xt,mt);this.loaded=this.loaded||{},this.loaded[at]=Qt,rt(null,Qt)},w.prototype.getImageData=function(J){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(J.width,J.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=J.width,this.offscreenCanvas.height=J.height,this.offscreenCanvasContext.drawImage(J,0,0,J.width,J.height);var rt=this.offscreenCanvasContext.getImageData(-1,-1,J.width+2,J.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new o.RGBAImage({width:rt.width,height:rt.height},rt.data)},w.prototype.removeTile=function(J){var rt=this.loaded,at=J.uid;rt&&rt[at]&&delete rt[at]};var M=o.vectorTile.VectorTileFeature.prototype.toGeoJSON,R=function(J){this._feature=J,this.extent=o.EXTENT,this.type=J.type,this.properties=J.tags,"id"in J&&!isNaN(J.id)&&(this.id=parseInt(J.id,10))};R.prototype.loadGeometry=function(){if(this._feature.type===1){for(var J=[],rt=0,at=this._feature.geometry;rt<at.length;rt+=1){var mt=at[rt];J.push([new o.Point$1(mt[0],mt[1])])}return J}for(var Mt=[],Xt=0,Qt=this._feature.geometry;Xt<Qt.length;Xt+=1){for(var ct=[],Pt=0,oe=Qt[Xt];Pt<oe.length;Pt+=1){var Le=oe[Pt];ct.push(new o.Point$1(Le[0],Le[1]))}Mt.push(ct)}return Mt},R.prototype.toGeoJSON=function(J,rt,at){return M.call(this,J,rt,at)};var O=function(J){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=o.EXTENT,this.length=J.length,this._features=J};O.prototype.feature=function(J){return new R(this._features[J])};var N=o.vectorTile.VectorTileFeature,k=V;function V(J,rt){this.options=rt||{},this.features=J,this.length=J.length}function Q(J,rt){this.id=typeof J.id=="number"?J.id:void 0,this.type=J.type,this.rawGeometry=J.type===1?[J.geometry]:J.geometry,this.properties=J.tags,this.extent=rt||4096}V.prototype.feature=function(J){return new Q(this.features[J],this.options.extent)},Q.prototype.loadGeometry=function(){var J=this.rawGeometry;this.geometry=[];for(var rt=0;rt<J.length;rt++){for(var at=J[rt],mt=[],Mt=0;Mt<at.length;Mt++)mt.push(new o.Point$1(at[Mt][0],at[Mt][1]));this.geometry.push(mt)}return this.geometry},Q.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var J=this.geometry,rt=1/0,at=-1/0,mt=1/0,Mt=-1/0,Xt=0;Xt<J.length;Xt++)for(var Qt=J[Xt],ct=0;ct<Qt.length;ct++){var Pt=Qt[ct];rt=Math.min(rt,Pt.x),at=Math.max(at,Pt.x),mt=Math.min(mt,Pt.y),Mt=Math.max(Mt,Pt.y)}return[rt,mt,at,Mt]},Q.prototype.toGeoJSON=N.prototype.toGeoJSON;var Y=tt,X=k;function tt(J){var rt=new o.pbf;return function(at,mt){for(var Mt in at.layers)mt.writeMessage(3,it,at.layers[Mt])}(J,rt),rt.finish()}function it(J,rt){var at;rt.writeVarintField(15,J.version||1),rt.writeStringField(1,J.name||""),rt.writeVarintField(5,J.extent||4096);var mt={keys:[],values:[],keycache:{},valuecache:{}};for(at=0;at<J.length;at++)mt.feature=J.feature(at),rt.writeMessage(2,Et,mt);var Mt=mt.keys;for(at=0;at<Mt.length;at++)rt.writeStringField(3,Mt[at]);var Xt=mt.values;for(at=0;at<Xt.length;at++)rt.writeMessage(4,Kt,Xt[at])}function Et(J,rt){var at=J.feature;at.id!==void 0&&rt.writeVarintField(1,at.id),rt.writeMessage(2,Tt,J),rt.writeVarintField(3,at.type),rt.writeMessage(4,ae,at)}function Tt(J,rt){var at=J.feature,mt=J.keys,Mt=J.values,Xt=J.keycache,Qt=J.valuecache;for(var ct in at.properties){var Pt=Xt[ct];Pt===void 0&&(mt.push(ct),Xt[ct]=Pt=mt.length-1),rt.writeVarint(Pt);var oe=at.properties[ct],Le=typeof oe;Le!=="string"&&Le!=="boolean"&&Le!=="number"&&(oe=JSON.stringify(oe));var tr=Le+":"+oe,Te=Qt[tr];Te===void 0&&(Mt.push(oe),Qt[tr]=Te=Mt.length-1),rt.writeVarint(Te)}}function pt(J,rt){return(rt<<3)+(7&J)}function kt(J){return J<<1^J>>31}function ae(J,rt){for(var at=J.loadGeometry(),mt=J.type,Mt=0,Xt=0,Qt=at.length,ct=0;ct<Qt;ct++){var Pt=at[ct],oe=1;mt===1&&(oe=Pt.length),rt.writeVarint(pt(1,oe));for(var Le=mt===3?Pt.length-1:Pt.length,tr=0;tr<Le;tr++){tr===1&&mt!==1&&rt.writeVarint(pt(2,Le-1));var Te=Pt[tr].x-Mt,Ze=Pt[tr].y-Xt;rt.writeVarint(kt(Te)),rt.writeVarint(kt(Ze)),Mt+=Te,Xt+=Ze}mt===3&&rt.writeVarint(pt(7,1))}}function Kt(J,rt){var at=typeof J;at==="string"?rt.writeStringField(1,J):at==="boolean"?rt.writeBooleanField(7,J):at==="number"&&(J%1!=0?rt.writeDoubleField(3,J):J<0?rt.writeSVarintField(6,J):rt.writeVarintField(5,J))}function re(J,rt,at,mt){fe(J,at,mt),fe(rt,2*at,2*mt),fe(rt,2*at+1,2*mt+1)}function fe(J,rt,at){var mt=J[rt];J[rt]=J[at],J[at]=mt}function Oe(J,rt,at,mt){var Mt=J-at,Xt=rt-mt;return Mt*Mt+Xt*Xt}Y.fromVectorTileJs=tt,Y.fromGeojsonVt=function(J,rt){rt=rt||{};var at={};for(var mt in J)at[mt]=new k(J[mt].features,rt),at[mt].name=mt,at[mt].version=rt.version,at[mt].extent=rt.extent;return tt({layers:at})},Y.GeoJSONWrapper=X;var Ye=function(J){return J[0]},Be=function(J){return J[1]},De=function(J,rt,at,mt,Mt){rt===void 0&&(rt=Ye),at===void 0&&(at=Be),mt===void 0&&(mt=64),Mt===void 0&&(Mt=Float64Array),this.nodeSize=mt,this.points=J;for(var Xt=J.length<65536?Uint16Array:Uint32Array,Qt=this.ids=new Xt(J.length),ct=this.coords=new Mt(2*J.length),Pt=0;Pt<J.length;Pt++)Qt[Pt]=Pt,ct[2*Pt]=rt(J[Pt]),ct[2*Pt+1]=at(J[Pt]);(function oe(Le,tr,Te,Ze,jr,Ur){if(!(jr-Ze<=Te)){var Re=Ze+jr>>1;(function Ar(dr,gr,kn,wr,ci,ea){for(;ci>wr;){if(ci-wr>600){var ai=ci-wr+1,wi=kn-wr+1,zn=Math.log(ai),po=.5*Math.exp(2*zn/3),pi=.5*Math.sqrt(zn*po*(ai-po)/ai)*(wi-ai/2<0?-1:1);Ar(dr,gr,kn,Math.max(wr,Math.floor(kn-wi*po/ai+pi)),Math.min(ci,Math.floor(kn+(ai-wi)*po/ai+pi)),ea)}var ra=gr[2*kn+ea],Di=wr,Un=ci;for(re(dr,gr,wr,kn),gr[2*ci+ea]>ra&&re(dr,gr,wr,ci);Di<Un;){for(re(dr,gr,Di,Un),Di++,Un--;gr[2*Di+ea]<ra;)Di++;for(;gr[2*Un+ea]>ra;)Un--}gr[2*wr+ea]===ra?re(dr,gr,wr,Un):re(dr,gr,++Un,ci),Un<=kn&&(wr=Un+1),kn<=Un&&(ci=Un-1)}})(Le,tr,Re,Ze,jr,Ur%2),oe(Le,tr,Te,Ze,Re-1,Ur+1),oe(Le,tr,Te,Re+1,jr,Ur+1)}})(Qt,ct,mt,0,Qt.length-1,0)};De.prototype.range=function(J,rt,at,mt){return function(Mt,Xt,Qt,ct,Pt,oe,Le){for(var tr,Te,Ze=[0,Mt.length-1,0],jr=[];Ze.length;){var Ur=Ze.pop(),Re=Ze.pop(),Ar=Ze.pop();if(Re-Ar<=Le)for(var dr=Ar;dr<=Re;dr++)Te=Xt[2*dr+1],(tr=Xt[2*dr])>=Qt&&tr<=Pt&&Te>=ct&&Te<=oe&&jr.push(Mt[dr]);else{var gr=Math.floor((Ar+Re)/2);Te=Xt[2*gr+1],(tr=Xt[2*gr])>=Qt&&tr<=Pt&&Te>=ct&&Te<=oe&&jr.push(Mt[gr]);var kn=(Ur+1)%2;(Ur===0?Qt<=tr:ct<=Te)&&(Ze.push(Ar),Ze.push(gr-1),Ze.push(kn)),(Ur===0?Pt>=tr:oe>=Te)&&(Ze.push(gr+1),Ze.push(Re),Ze.push(kn))}}return jr}(this.ids,this.coords,J,rt,at,mt,this.nodeSize)},De.prototype.within=function(J,rt,at){return function(mt,Mt,Xt,Qt,ct,Pt){for(var oe=[0,mt.length-1,0],Le=[],tr=ct*ct;oe.length;){var Te=oe.pop(),Ze=oe.pop(),jr=oe.pop();if(Ze-jr<=Pt)for(var Ur=jr;Ur<=Ze;Ur++)Oe(Mt[2*Ur],Mt[2*Ur+1],Xt,Qt)<=tr&&Le.push(mt[Ur]);else{var Re=Math.floor((jr+Ze)/2),Ar=Mt[2*Re],dr=Mt[2*Re+1];Oe(Ar,dr,Xt,Qt)<=tr&&Le.push(mt[Re]);var gr=(Te+1)%2;(Te===0?Xt-ct<=Ar:Qt-ct<=dr)&&(oe.push(jr),oe.push(Re-1),oe.push(gr)),(Te===0?Xt+ct>=Ar:Qt+ct>=dr)&&(oe.push(Re+1),oe.push(Ze),oe.push(gr))}}return Le}(this.ids,this.coords,J,rt,at,this.nodeSize)};var Yr={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(J){return J}},Gr=function(J){this.options=_n(Object.create(Yr),J),this.trees=new Array(this.options.maxZoom+1)};function Mn(J,rt,at,mt,Mt){return{x:J,y:rt,zoom:1/0,id:at,parentId:-1,numPoints:mt,properties:Mt}}function ee(J,rt){var at=J.geometry.coordinates,mt=at[1];return{x:Fe(at[0]),y:Hr(mt),zoom:1/0,index:rt,parentId:-1}}function rr(J){return{type:"Feature",id:J.id,properties:Nr(J),geometry:{type:"Point",coordinates:[(mt=J.x,360*(mt-.5)),(rt=J.y,at=(180-360*rt)*Math.PI/180,360*Math.atan(Math.exp(at))/Math.PI-90)]}};var rt,at,mt}function Nr(J){var rt=J.numPoints,at=rt>=1e4?Math.round(rt/1e3)+"k":rt>=1e3?Math.round(rt/100)/10+"k":rt;return _n(_n({},J.properties),{cluster:!0,cluster_id:J.id,point_count:rt,point_count_abbreviated:at})}function Fe(J){return J/360+.5}function Hr(J){var rt=Math.sin(J*Math.PI/180),at=.5-.25*Math.log((1+rt)/(1-rt))/Math.PI;return at<0?0:at>1?1:at}function _n(J,rt){for(var at in rt)J[at]=rt[at];return J}function Kn(J){return J.x}function vn(J){return J.y}function xn(J,rt,at,mt,Mt,Xt){var Qt=Mt-at,ct=Xt-mt;if(Qt!==0||ct!==0){var Pt=((J-at)*Qt+(rt-mt)*ct)/(Qt*Qt+ct*ct);Pt>1?(at=Mt,mt=Xt):Pt>0&&(at+=Qt*Pt,mt+=ct*Pt)}return(Qt=J-at)*Qt+(ct=rt-mt)*ct}function ui(J,rt,at,mt){var Mt={id:J===void 0?null:J,type:rt,geometry:at,tags:mt,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Xt){var Qt=Xt.geometry,ct=Xt.type;if(ct==="Point"||ct==="MultiPoint"||ct==="LineString")Ao(Xt,Qt);else if(ct==="Polygon"||ct==="MultiLineString")for(var Pt=0;Pt<Qt.length;Pt++)Ao(Xt,Qt[Pt]);else if(ct==="MultiPolygon")for(Pt=0;Pt<Qt.length;Pt++)for(var oe=0;oe<Qt[Pt].length;oe++)Ao(Xt,Qt[Pt][oe])}(Mt),Mt}function Ao(J,rt){for(var at=0;at<rt.length;at+=3)J.minX=Math.min(J.minX,rt[at]),J.minY=Math.min(J.minY,rt[at+1]),J.maxX=Math.max(J.maxX,rt[at]),J.maxY=Math.max(J.maxY,rt[at+1])}function ta(J,rt,at,mt){if(rt.geometry){var Mt=rt.geometry.coordinates,Xt=rt.geometry.type,Qt=Math.pow(at.tolerance/((1<<at.maxZoom)*at.extent),2),ct=[],Pt=rt.id;if(at.promoteId?Pt=rt.properties[at.promoteId]:at.generateId&&(Pt=mt||0),Xt==="Point")oa(Mt,ct);else if(Xt==="MultiPoint")for(var oe=0;oe<Mt.length;oe++)oa(Mt[oe],ct);else if(Xt==="LineString")as(Mt,ct,Qt,!1);else if(Xt==="MultiLineString"){if(at.lineMetrics){for(oe=0;oe<Mt.length;oe++)as(Mt[oe],ct=[],Qt,!1),J.push(ui(Pt,"LineString",ct,rt.properties));return}bt(Mt,ct,Qt,!1)}else if(Xt==="Polygon")bt(Mt,ct,Qt,!0);else{if(Xt!=="MultiPolygon"){if(Xt==="GeometryCollection"){for(oe=0;oe<rt.geometry.geometries.length;oe++)ta(J,{id:Pt,geometry:rt.geometry.geometries[oe],properties:rt.properties},at,mt);return}throw new Error("Input data is not a valid GeoJSON object.")}for(oe=0;oe<Mt.length;oe++){var Le=[];bt(Mt[oe],Le,Qt,!0),ct.push(Le)}}J.push(ui(Pt,Xt,ct,rt.properties))}}function oa(J,rt){rt.push(os(J[0])),rt.push(gu(J[1])),rt.push(0)}function as(J,rt,at,mt){for(var Mt,Xt,Qt=0,ct=0;ct<J.length;ct++){var Pt=os(J[ct][0]),oe=gu(J[ct][1]);rt.push(Pt),rt.push(oe),rt.push(0),ct>0&&(Qt+=mt?(Mt*oe-Pt*Xt)/2:Math.sqrt(Math.pow(Pt-Mt,2)+Math.pow(oe-Xt,2))),Mt=Pt,Xt=oe}var Le=rt.length-3;rt[2]=1,function tr(Te,Ze,jr,Ur){for(var Re,Ar=Ur,dr=jr-Ze>>1,gr=jr-Ze,kn=Te[Ze],wr=Te[Ze+1],ci=Te[jr],ea=Te[jr+1],ai=Ze+3;ai<jr;ai+=3){var wi=xn(Te[ai],Te[ai+1],kn,wr,ci,ea);if(wi>Ar)Re=ai,Ar=wi;else if(wi===Ar){var zn=Math.abs(ai-dr);zn<gr&&(Re=ai,gr=zn)}}Ar>Ur&&(Re-Ze>3&&tr(Te,Ze,Re,Ur),Te[Re+2]=Ar,jr-Re>3&&tr(Te,Re,jr,Ur))}(rt,0,Le,at),rt[Le+2]=1,rt.size=Math.abs(Qt),rt.start=0,rt.end=rt.size}function bt(J,rt,at,mt){for(var Mt=0;Mt<J.length;Mt++){var Xt=[];as(J[Mt],Xt,at,mt),rt.push(Xt)}}function os(J){return J/360+.5}function gu(J){var rt=Math.sin(J*Math.PI/180),at=.5-.25*Math.log((1+rt)/(1-rt))/Math.PI;return at<0?0:at>1?1:at}function ss(J,rt,at,mt,Mt,Xt,Qt,ct){if(mt/=rt,Xt>=(at/=rt)&&Qt<mt)return J;if(Qt<at||Xt>=mt)return null;for(var Pt=[],oe=0;oe<J.length;oe++){var Le=J[oe],tr=Le.geometry,Te=Le.type,Ze=Mt===0?Le.minX:Le.minY,jr=Mt===0?Le.maxX:Le.maxY;if(Ze>=at&&jr<mt)Pt.push(Le);else if(!(jr<at||Ze>=mt)){var Ur=[];if(Te==="Point"||Te==="MultiPoint")Vu(tr,Ur,at,mt,Mt);else if(Te==="LineString")va(tr,Ur,at,mt,Mt,!1,ct.lineMetrics);else if(Te==="MultiLineString")il(tr,Ur,at,mt,Mt,!1);else if(Te==="Polygon")il(tr,Ur,at,mt,Mt,!0);else if(Te==="MultiPolygon")for(var Re=0;Re<tr.length;Re++){var Ar=[];il(tr[Re],Ar,at,mt,Mt,!0),Ar.length&&Ur.push(Ar)}if(Ur.length){if(ct.lineMetrics&&Te==="LineString"){for(Re=0;Re<Ur.length;Re++)Pt.push(ui(Le.id,Te,Ur[Re],Le.tags));continue}Te!=="LineString"&&Te!=="MultiLineString"||(Ur.length===1?(Te="LineString",Ur=Ur[0]):Te="MultiLineString"),Te!=="Point"&&Te!=="MultiPoint"||(Te=Ur.length===3?"Point":"MultiPoint"),Pt.push(ui(Le.id,Te,Ur,Le.tags))}}}return Pt.length?Pt:null}function Vu(J,rt,at,mt,Mt){for(var Xt=0;Xt<J.length;Xt+=3){var Qt=J[Xt+Mt];Qt>=at&&Qt<=mt&&(rt.push(J[Xt]),rt.push(J[Xt+1]),rt.push(J[Xt+2]))}}function va(J,rt,at,mt,Mt,Xt,Qt){for(var ct,Pt,oe=ls(J),Le=Mt===0?dc:fo,tr=J.start,Te=0;Te<J.length-3;Te+=3){var Ze=J[Te],jr=J[Te+1],Ur=J[Te+2],Re=J[Te+3],Ar=J[Te+4],dr=Mt===0?Ze:jr,gr=Mt===0?Re:Ar,kn=!1;Qt&&(ct=Math.sqrt(Math.pow(Ze-Re,2)+Math.pow(jr-Ar,2))),dr<at?gr>at&&(Pt=Le(oe,Ze,jr,Re,Ar,at),Qt&&(oe.start=tr+ct*Pt)):dr>mt?gr<mt&&(Pt=Le(oe,Ze,jr,Re,Ar,mt),Qt&&(oe.start=tr+ct*Pt)):us(oe,Ze,jr,Ur),gr<at&&dr>=at&&(Pt=Le(oe,Ze,jr,Re,Ar,at),kn=!0),gr>mt&&dr<=mt&&(Pt=Le(oe,Ze,jr,Re,Ar,mt),kn=!0),!Xt&&kn&&(Qt&&(oe.end=tr+ct*Pt),rt.push(oe),oe=ls(J)),Qt&&(tr+=ct)}var wr=J.length-3;Ze=J[wr],jr=J[wr+1],Ur=J[wr+2],(dr=Mt===0?Ze:jr)>=at&&dr<=mt&&us(oe,Ze,jr,Ur),wr=oe.length-3,Xt&&wr>=3&&(oe[wr]!==oe[0]||oe[wr+1]!==oe[1])&&us(oe,oe[0],oe[1],oe[2]),oe.length&&rt.push(oe)}function ls(J){var rt=[];return rt.size=J.size,rt.start=J.start,rt.end=J.end,rt}function il(J,rt,at,mt,Mt,Xt){for(var Qt=0;Qt<J.length;Qt++)va(J[Qt],rt,at,mt,Mt,Xt,!1)}function us(J,rt,at,mt){J.push(rt),J.push(at),J.push(mt)}function dc(J,rt,at,mt,Mt,Xt){var Qt=(Xt-rt)/(mt-rt);return J.push(Xt),J.push(at+(Mt-at)*Qt),J.push(1),Qt}function fo(J,rt,at,mt,Mt,Xt){var Qt=(Xt-at)/(Mt-at);return J.push(rt+(mt-rt)*Qt),J.push(Xt),J.push(1),Qt}function Gu(J,rt){for(var at=[],mt=0;mt<J.length;mt++){var Mt,Xt=J[mt],Qt=Xt.type;if(Qt==="Point"||Qt==="MultiPoint"||Qt==="LineString")Mt=Cl(Xt.geometry,rt);else if(Qt==="MultiLineString"||Qt==="Polygon"){Mt=[];for(var ct=0;ct<Xt.geometry.length;ct++)Mt.push(Cl(Xt.geometry[ct],rt))}else if(Qt==="MultiPolygon")for(Mt=[],ct=0;ct<Xt.geometry.length;ct++){for(var Pt=[],oe=0;oe<Xt.geometry[ct].length;oe++)Pt.push(Cl(Xt.geometry[ct][oe],rt));Mt.push(Pt)}at.push(ui(Xt.id,Qt,Mt,Xt.tags))}return at}function Cl(J,rt){var at=[];at.size=J.size,J.start!==void 0&&(at.start=J.start,at.end=J.end);for(var mt=0;mt<J.length;mt+=3)at.push(J[mt]+rt,J[mt+1],J[mt+2]);return at}function oh(J,rt){if(J.transformed)return J;var at,mt,Mt,Xt=1<<J.z,Qt=J.x,ct=J.y;for(at=0;at<J.features.length;at++){var Pt=J.features[at],oe=Pt.geometry,Le=Pt.type;if(Pt.geometry=[],Le===1)for(mt=0;mt<oe.length;mt+=2)Pt.geometry.push(nd(oe[mt],oe[mt+1],rt,Xt,Qt,ct));else for(mt=0;mt<oe.length;mt++){var tr=[];for(Mt=0;Mt<oe[mt].length;Mt+=2)tr.push(nd(oe[mt][Mt],oe[mt][Mt+1],rt,Xt,Qt,ct));Pt.geometry.push(tr)}}return J.transformed=!0,J}function nd(J,rt,at,mt,Mt,Xt){return[Math.round(at*(J*mt-Mt)),Math.round(at*(rt*mt-Xt))]}function sh(J,rt,at,mt,Mt){for(var Xt=rt===Mt.maxZoom?0:Mt.tolerance/((1<<rt)*Mt.extent),Qt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:at,y:mt,z:rt,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ct=0;ct<J.length;ct++){Qt.numFeatures++,Jd(Qt,J[ct],Xt,Mt);var Pt=J[ct].minX,oe=J[ct].minY,Le=J[ct].maxX,tr=J[ct].maxY;Pt<Qt.minX&&(Qt.minX=Pt),oe<Qt.minY&&(Qt.minY=oe),Le>Qt.maxX&&(Qt.maxX=Le),tr>Qt.maxY&&(Qt.maxY=tr)}return Qt}function Jd(J,rt,at,mt){var Mt=rt.geometry,Xt=rt.type,Qt=[];if(Xt==="Point"||Xt==="MultiPoint")for(var ct=0;ct<Mt.length;ct+=3)Qt.push(Mt[ct]),Qt.push(Mt[ct+1]),J.numPoints++,J.numSimplified++;else if(Xt==="LineString")lh(Qt,Mt,J,at,!1,!1);else if(Xt==="MultiLineString"||Xt==="Polygon")for(ct=0;ct<Mt.length;ct++)lh(Qt,Mt[ct],J,at,Xt==="Polygon",ct===0);else if(Xt==="MultiPolygon")for(var Pt=0;Pt<Mt.length;Pt++){var oe=Mt[Pt];for(ct=0;ct<oe.length;ct++)lh(Qt,oe[ct],J,at,!0,ct===0)}if(Qt.length){var Le=rt.tags||null;if(Xt==="LineString"&&mt.lineMetrics){for(var tr in Le={},rt.tags)Le[tr]=rt.tags[tr];Le.mapbox_clip_start=Mt.start/Mt.size,Le.mapbox_clip_end=Mt.end/Mt.size}var Te={geometry:Qt,type:Xt==="Polygon"||Xt==="MultiPolygon"?3:Xt==="LineString"||Xt==="MultiLineString"?2:1,tags:Le};rt.id!==null&&(Te.id=rt.id),J.features.push(Te)}}function lh(J,rt,at,mt,Mt,Xt){var Qt=mt*mt;if(mt>0&&rt.size<(Mt?Qt:mt))at.numPoints+=rt.length/3;else{for(var ct=[],Pt=0;Pt<rt.length;Pt+=3)(mt===0||rt[Pt+2]>Qt)&&(at.numSimplified++,ct.push(rt[Pt]),ct.push(rt[Pt+1])),at.numPoints++;Mt&&function(oe,Le){for(var tr=0,Te=0,Ze=oe.length,jr=Ze-2;Te<Ze;jr=Te,Te+=2)tr+=(oe[Te]-oe[jr])*(oe[Te+1]+oe[jr+1]);if(tr>0===Le)for(Te=0,Ze=oe.length;Te<Ze/2;Te+=2){var Ur=oe[Te],Re=oe[Te+1];oe[Te]=oe[Ze-2-Te],oe[Te+1]=oe[Ze-1-Te],oe[Ze-2-Te]=Ur,oe[Ze-1-Te]=Re}}(ct,Xt),J.push(ct)}}function jl(J,rt){var at=(rt=this.options=function(Mt,Xt){for(var Qt in Xt)Mt[Qt]=Xt[Qt];return Mt}(Object.create(this.options),rt)).debug;if(at&&console.time("preprocess data"),rt.maxZoom<0||rt.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(rt.promoteId&&rt.generateId)throw new Error("promoteId and generateId cannot be used together.");var mt=function(Mt,Xt){var Qt=[];if(Mt.type==="FeatureCollection")for(var ct=0;ct<Mt.features.length;ct++)ta(Qt,Mt.features[ct],Xt,ct);else ta(Qt,Mt.type==="Feature"?Mt:{geometry:Mt},Xt);return Qt}(J,rt);this.tiles={},this.tileCoords=[],at&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",rt.indexMaxZoom,rt.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(mt=function(Mt,Xt){var Qt=Xt.buffer/Xt.extent,ct=Mt,Pt=ss(Mt,1,-1-Qt,Qt,0,-1,2,Xt),oe=ss(Mt,1,1-Qt,2+Qt,0,-1,2,Xt);return(Pt||oe)&&(ct=ss(Mt,1,-Qt,1+Qt,0,-1,2,Xt)||[],Pt&&(ct=Gu(Pt,1).concat(ct)),oe&&(ct=ct.concat(Gu(oe,-1)))),ct}(mt,rt)).length&&this.splitTile(mt,0,0,0),at&&(mt.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Yl(J,rt,at){return 32*((1<<J)*at+rt)+J}function pc(J,rt){var at=J.tileID.canonical;if(!this._geoJSONIndex)return rt(null,null);var mt=this._geoJSONIndex.getTile(at.z,at.x,at.y);if(!mt)return rt(null,null);var Mt=new O(mt.features),Xt=Y(Mt);Xt.byteOffset===0&&Xt.byteLength===Xt.buffer.byteLength||(Xt=new Uint8Array(Xt)),rt(null,{vectorTile:Mt,rawData:Xt.buffer})}Gr.prototype.load=function(J){var rt=this.options,at=rt.log,mt=rt.minZoom,Mt=rt.maxZoom,Xt=rt.nodeSize;at&&console.time("total time");var Qt="prepare "+J.length+" points";at&&console.time(Qt),this.points=J;for(var ct=[],Pt=0;Pt<J.length;Pt++)J[Pt].geometry&&ct.push(ee(J[Pt],Pt));this.trees[Mt+1]=new De(ct,Kn,vn,Xt,Float32Array),at&&console.timeEnd(Qt);for(var oe=Mt;oe>=mt;oe--){var Le=+Date.now();ct=this._cluster(ct,oe),this.trees[oe]=new De(ct,Kn,vn,Xt,Float32Array),at&&console.log("z%d: %d clusters in %dms",oe,ct.length,+Date.now()-Le)}return at&&console.timeEnd("total time"),this},Gr.prototype.getClusters=function(J,rt){var at=((J[0]+180)%360+360)%360-180,mt=Math.max(-90,Math.min(90,J[1])),Mt=J[2]===180?180:((J[2]+180)%360+360)%360-180,Xt=Math.max(-90,Math.min(90,J[3]));if(J[2]-J[0]>=360)at=-180,Mt=180;else if(at>Mt){var Qt=this.getClusters([at,mt,180,Xt],rt),ct=this.getClusters([-180,mt,Mt,Xt],rt);return Qt.concat(ct)}for(var Pt=this.trees[this._limitZoom(rt)],oe=[],Le=0,tr=Pt.range(Fe(at),Hr(Xt),Fe(Mt),Hr(mt));Le<tr.length;Le+=1){var Te=Pt.points[tr[Le]];oe.push(Te.numPoints?rr(Te):this.points[Te.index])}return oe},Gr.prototype.getChildren=function(J){var rt=this._getOriginId(J),at=this._getOriginZoom(J),mt="No cluster with the specified id.",Mt=this.trees[at];if(!Mt)throw new Error(mt);var Xt=Mt.points[rt];if(!Xt)throw new Error(mt);for(var Qt=this.options.radius/(this.options.extent*Math.pow(2,at-1)),ct=[],Pt=0,oe=Mt.within(Xt.x,Xt.y,Qt);Pt<oe.length;Pt+=1){var Le=Mt.points[oe[Pt]];Le.parentId===J&&ct.push(Le.numPoints?rr(Le):this.points[Le.index])}if(ct.length===0)throw new Error(mt);return ct},Gr.prototype.getLeaves=function(J,rt,at){var mt=[];return this._appendLeaves(mt,J,rt=rt||10,at=at||0,0),mt},Gr.prototype.getTile=function(J,rt,at){var mt=this.trees[this._limitZoom(J)],Mt=Math.pow(2,J),Xt=this.options,Qt=Xt.radius/Xt.extent,ct=(at-Qt)/Mt,Pt=(at+1+Qt)/Mt,oe={features:[]};return this._addTileFeatures(mt.range((rt-Qt)/Mt,ct,(rt+1+Qt)/Mt,Pt),mt.points,rt,at,Mt,oe),rt===0&&this._addTileFeatures(mt.range(1-Qt/Mt,ct,1,Pt),mt.points,Mt,at,Mt,oe),rt===Mt-1&&this._addTileFeatures(mt.range(0,ct,Qt/Mt,Pt),mt.points,-1,at,Mt,oe),oe.features.length?oe:null},Gr.prototype.getClusterExpansionZoom=function(J){for(var rt=this._getOriginZoom(J)-1;rt<=this.options.maxZoom;){var at=this.getChildren(J);if(rt++,at.length!==1)break;J=at[0].properties.cluster_id}return rt},Gr.prototype._appendLeaves=function(J,rt,at,mt,Mt){for(var Xt=0,Qt=this.getChildren(rt);Xt<Qt.length;Xt+=1){var ct=Qt[Xt],Pt=ct.properties;if(Pt&&Pt.cluster?Mt+Pt.point_count<=mt?Mt+=Pt.point_count:Mt=this._appendLeaves(J,Pt.cluster_id,at,mt,Mt):Mt<mt?Mt++:J.push(ct),J.length===at)break}return Mt},Gr.prototype._addTileFeatures=function(J,rt,at,mt,Mt,Xt){for(var Qt=0,ct=J;Qt<ct.length;Qt+=1){var Pt=rt[ct[Qt]],oe=Pt.numPoints,Le={type:1,geometry:[[Math.round(this.options.extent*(Pt.x*Mt-at)),Math.round(this.options.extent*(Pt.y*Mt-mt))]],tags:oe?Nr(Pt):this.points[Pt.index].properties},tr=void 0;oe?tr=Pt.id:this.options.generateId?tr=Pt.index:this.points[Pt.index].id&&(tr=this.points[Pt.index].id),tr!==void 0&&(Le.id=tr),Xt.features.push(Le)}},Gr.prototype._limitZoom=function(J){return Math.max(this.options.minZoom,Math.min(+J,this.options.maxZoom+1))},Gr.prototype._cluster=function(J,rt){for(var at=[],mt=this.options,Mt=mt.reduce,Xt=mt.minPoints,Qt=mt.radius/(mt.extent*Math.pow(2,rt)),ct=0;ct<J.length;ct++){var Pt=J[ct];if(!(Pt.zoom<=rt)){Pt.zoom=rt;for(var oe=this.trees[rt+1],Le=oe.within(Pt.x,Pt.y,Qt),tr=Pt.numPoints||1,Te=tr,Ze=0,jr=Le;Ze<jr.length;Ze+=1){var Ur=oe.points[jr[Ze]];Ur.zoom>rt&&(Te+=Ur.numPoints||1)}if(Te>=Xt){for(var Re=Pt.x*tr,Ar=Pt.y*tr,dr=Mt&&tr>1?this._map(Pt,!0):null,gr=(ct<<5)+(rt+1)+this.points.length,kn=0,wr=Le;kn<wr.length;kn+=1){var ci=oe.points[wr[kn]];if(!(ci.zoom<=rt)){ci.zoom=rt;var ea=ci.numPoints||1;Re+=ci.x*ea,Ar+=ci.y*ea,ci.parentId=gr,Mt&&(dr||(dr=this._map(Pt,!0)),Mt(dr,this._map(ci)))}}Pt.parentId=gr,at.push(Mn(Re/Te,Ar/Te,gr,Te,dr))}else if(at.push(Pt),Te>1)for(var ai=0,wi=Le;ai<wi.length;ai+=1){var zn=oe.points[wi[ai]];zn.zoom<=rt||(zn.zoom=rt,at.push(zn))}}}return at},Gr.prototype._getOriginId=function(J){return J-this.points.length>>5},Gr.prototype._getOriginZoom=function(J){return(J-this.points.length)%32},Gr.prototype._map=function(J,rt){if(J.numPoints)return rt?_n({},J.properties):J.properties;var at=this.points[J.index].properties,mt=this.options.map(at);return rt&&mt===at?_n({},mt):mt},jl.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},jl.prototype.splitTile=function(J,rt,at,mt,Mt,Xt,Qt){for(var ct=[J,rt,at,mt],Pt=this.options,oe=Pt.debug;ct.length;){mt=ct.pop(),at=ct.pop(),rt=ct.pop(),J=ct.pop();var Le=1<<rt,tr=Yl(rt,at,mt),Te=this.tiles[tr];if(!Te&&(oe>1&&console.time("creation"),Te=this.tiles[tr]=sh(J,rt,at,mt,Pt),this.tileCoords.push({z:rt,x:at,y:mt}),oe)){oe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",rt,at,mt,Te.numFeatures,Te.numPoints,Te.numSimplified),console.timeEnd("creation"));var Ze="z"+rt;this.stats[Ze]=(this.stats[Ze]||0)+1,this.total++}if(Te.source=J,Mt){if(rt===Pt.maxZoom||rt===Mt)continue;var jr=1<<Mt-rt;if(at!==Math.floor(Xt/jr)||mt!==Math.floor(Qt/jr))continue}else if(rt===Pt.indexMaxZoom||Te.numPoints<=Pt.indexMaxPoints)continue;if(Te.source=null,J.length!==0){oe>1&&console.time("clipping");var Ur,Re,Ar,dr,gr,kn,wr=.5*Pt.buffer/Pt.extent,ci=.5-wr,ea=.5+wr,ai=1+wr;Ur=Re=Ar=dr=null,gr=ss(J,Le,at-wr,at+ea,0,Te.minX,Te.maxX,Pt),kn=ss(J,Le,at+ci,at+ai,0,Te.minX,Te.maxX,Pt),J=null,gr&&(Ur=ss(gr,Le,mt-wr,mt+ea,1,Te.minY,Te.maxY,Pt),Re=ss(gr,Le,mt+ci,mt+ai,1,Te.minY,Te.maxY,Pt),gr=null),kn&&(Ar=ss(kn,Le,mt-wr,mt+ea,1,Te.minY,Te.maxY,Pt),dr=ss(kn,Le,mt+ci,mt+ai,1,Te.minY,Te.maxY,Pt),kn=null),oe>1&&console.timeEnd("clipping"),ct.push(Ur||[],rt+1,2*at,2*mt),ct.push(Re||[],rt+1,2*at,2*mt+1),ct.push(Ar||[],rt+1,2*at+1,2*mt),ct.push(dr||[],rt+1,2*at+1,2*mt+1)}}},jl.prototype.getTile=function(J,rt,at){var mt=this.options,Mt=mt.extent,Xt=mt.debug;if(J<0||J>24)return null;var Qt=1<<J,ct=Yl(J,rt=(rt%Qt+Qt)%Qt,at);if(this.tiles[ct])return oh(this.tiles[ct],Mt);Xt>1&&console.log("drilling down to z%d-%d-%d",J,rt,at);for(var Pt,oe=J,Le=rt,tr=at;!Pt&&oe>0;)oe--,Le=Math.floor(Le/2),tr=Math.floor(tr/2),Pt=this.tiles[Yl(oe,Le,tr)];return Pt&&Pt.source?(Xt>1&&console.log("found parent tile z%d-%d-%d",oe,Le,tr),Xt>1&&console.time("drilling down"),this.splitTile(Pt.source,oe,Le,tr,J,rt,at),Xt>1&&console.timeEnd("drilling down"),this.tiles[ct]?oh(this.tiles[ct],Mt):null):null};var id=function(J){function rt(at,mt,Mt,Xt){J.call(this,at,mt,Mt,pc),Xt&&(this.loadGeoJSON=Xt)}return J&&(rt.__proto__=J),(rt.prototype=Object.create(J&&J.prototype)).constructor=rt,rt.prototype.loadData=function(at,mt){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=mt,this._pendingLoadDataParams=at,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},rt.prototype._loadData=function(){var at=this;if(this._pendingCallback&&this._pendingLoadDataParams){var mt=this._pendingCallback,Mt=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var Xt=!!(Mt&&Mt.request&&Mt.request.collectResourceTiming)&&new o.RequestPerformance(Mt.request);this.loadGeoJSON(Mt,function(Qt,ct){if(Qt||!ct)return mt(Qt);if(typeof ct!="object")return mt(new Error("Input data given to '"+Mt.source+"' is not a valid GeoJSON object."));(function Te(Ze,jr){var Ur,Re=Ze&&Ze.type;if(Re==="FeatureCollection")for(Ur=0;Ur<Ze.features.length;Ur++)Te(Ze.features[Ur],jr);else if(Re==="GeometryCollection")for(Ur=0;Ur<Ze.geometries.length;Ur++)Te(Ze.geometries[Ur],jr);else if(Re==="Feature")Te(Ze.geometry,jr);else if(Re==="Polygon")S(Ze.coordinates,jr);else if(Re==="MultiPolygon")for(Ur=0;Ur<Ze.coordinates.length;Ur++)S(Ze.coordinates[Ur],jr);return Ze})(ct,!0);try{if(Mt.filter){var Pt=o.createExpression(Mt.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Pt.result==="error")throw new Error(Pt.value.map(function(Te){return Te.key+": "+Te.message}).join(", "));var oe=ct.features.filter(function(Te){return Pt.value.evaluate({zoom:0},Te)});ct={type:"FeatureCollection",features:oe}}at._geoJSONIndex=Mt.cluster?new Gr(function(Te){var Ze=Te.superclusterOptions,jr=Te.clusterProperties;if(!jr||!Ze)return Ze;for(var Ur={},Re={},Ar={accumulated:null,zoom:0},dr={properties:null},gr=Object.keys(jr),kn=0,wr=gr;kn<wr.length;kn+=1){var ci=wr[kn],ea=jr[ci],ai=ea[0],wi=o.createExpression(ea[1]),zn=o.createExpression(typeof ai=="string"?[ai,["accumulated"],["get",ci]]:ai);Ur[ci]=wi.value,Re[ci]=zn.value}return Ze.map=function(po){dr.properties=po;for(var pi={},ra=0,Di=gr;ra<Di.length;ra+=1){var Un=Di[ra];pi[Un]=Ur[Un].evaluate(Ar,dr)}return pi},Ze.reduce=function(po,pi){dr.properties=pi;for(var ra=0,Di=gr;ra<Di.length;ra+=1){var Un=Di[ra];Ar.accumulated=po[Un],po[Un]=Re[Un].evaluate(Ar,dr)}},Ze}(Mt)).load(ct.features):function(Te,Ze){return new jl(Te,Ze)}(ct,Mt.geojsonVtOptions)}catch(Te){return mt(Te)}at.loaded={};var Le={};if(Xt){var tr=Xt.finish();tr&&(Le.resourceTiming={},Le.resourceTiming[Mt.source]=JSON.parse(JSON.stringify(tr)))}mt(null,Le)})}},rt.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},rt.prototype.reloadTile=function(at,mt){var Mt=this.loaded;return Mt&&Mt[at.uid]?J.prototype.reloadTile.call(this,at,mt):this.loadTile(at,mt)},rt.prototype.loadGeoJSON=function(at,mt){if(at.request)o.getJSON(at.request,mt);else{if(typeof at.data!="string")return mt(new Error("Input data given to '"+at.source+"' is not a valid GeoJSON object."));try{return mt(null,JSON.parse(at.data))}catch{return mt(new Error("Input data given to '"+at.source+"' is not a valid GeoJSON object."))}}},rt.prototype.removeSource=function(at,mt){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),mt()},rt.prototype.getClusterExpansionZoom=function(at,mt){try{mt(null,this._geoJSONIndex.getClusterExpansionZoom(at.clusterId))}catch(Mt){mt(Mt)}},rt.prototype.getClusterChildren=function(at,mt){try{mt(null,this._geoJSONIndex.getChildren(at.clusterId))}catch(Mt){mt(Mt)}},rt.prototype.getClusterLeaves=function(at,mt){try{mt(null,this._geoJSONIndex.getLeaves(at.clusterId,at.limit,at.offset))}catch(Mt){mt(Mt)}},rt}(g),$i=function(J){var rt=this;this.self=J,this.actor=new o.Actor(J,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:g,geojson:id},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(at,mt){if(rt.workerSourceTypes[at])throw new Error('Worker source with name "'+at+'" already registered.');rt.workerSourceTypes[at]=mt},this.self.registerRTLTextPlugin=function(at){if(o.plugin.isParsed())throw new Error("RTL text plugin already registered.");o.plugin.applyArabicShaping=at.applyArabicShaping,o.plugin.processBidirectionalText=at.processBidirectionalText,o.plugin.processStyledBidirectionalText=at.processStyledBidirectionalText}};return $i.prototype.setReferrer=function(J,rt){this.referrer=rt},$i.prototype.setImages=function(J,rt,at){for(var mt in this.availableImages[J]=rt,this.workerSources[J]){var Mt=this.workerSources[J][mt];for(var Xt in Mt)Mt[Xt].availableImages=rt}at()},$i.prototype.setLayers=function(J,rt,at){this.getLayerIndex(J).replace(rt),at()},$i.prototype.updateLayers=function(J,rt,at){this.getLayerIndex(J).update(rt.layers,rt.removedIds),at()},$i.prototype.loadTile=function(J,rt,at){this.getWorkerSource(J,rt.type,rt.source).loadTile(rt,at)},$i.prototype.loadDEMTile=function(J,rt,at){this.getDEMWorkerSource(J,rt.source).loadTile(rt,at)},$i.prototype.reloadTile=function(J,rt,at){this.getWorkerSource(J,rt.type,rt.source).reloadTile(rt,at)},$i.prototype.abortTile=function(J,rt,at){this.getWorkerSource(J,rt.type,rt.source).abortTile(rt,at)},$i.prototype.removeTile=function(J,rt,at){this.getWorkerSource(J,rt.type,rt.source).removeTile(rt,at)},$i.prototype.removeDEMTile=function(J,rt){this.getDEMWorkerSource(J,rt.source).removeTile(rt)},$i.prototype.removeSource=function(J,rt,at){if(this.workerSources[J]&&this.workerSources[J][rt.type]&&this.workerSources[J][rt.type][rt.source]){var mt=this.workerSources[J][rt.type][rt.source];delete this.workerSources[J][rt.type][rt.source],mt.removeSource!==void 0?mt.removeSource(rt,at):at()}},$i.prototype.loadWorkerSource=function(J,rt,at){try{this.self.importScripts(rt.url),at()}catch(mt){at(mt.toString())}},$i.prototype.syncRTLPluginState=function(J,rt,at){try{o.plugin.setState(rt);var mt=o.plugin.getPluginURL();if(o.plugin.isLoaded()&&!o.plugin.isParsed()&&mt!=null){this.self.importScripts(mt);var Mt=o.plugin.isParsed();at(Mt?void 0:new Error("RTL Text Plugin failed to import scripts from "+mt),Mt)}}catch(Xt){at(Xt.toString())}},$i.prototype.getAvailableImages=function(J){var rt=this.availableImages[J];return rt||(rt=[]),rt},$i.prototype.getLayerIndex=function(J){var rt=this.layerIndexes[J];return rt||(rt=this.layerIndexes[J]=new u),rt},$i.prototype.getWorkerSource=function(J,rt,at){var mt=this;return this.workerSources[J]||(this.workerSources[J]={}),this.workerSources[J][rt]||(this.workerSources[J][rt]={}),this.workerSources[J][rt][at]||(this.workerSources[J][rt][at]=new this.workerSourceTypes[rt]({send:function(Mt,Xt,Qt){mt.actor.send(Mt,Xt,Qt,J)}},this.getLayerIndex(J),this.getAvailableImages(J))),this.workerSources[J][rt][at]},$i.prototype.getDEMWorkerSource=function(J,rt){return this.demWorkerSources[J]||(this.demWorkerSources[J]={}),this.demWorkerSources[J][rt]||(this.demWorkerSources[J][rt]=new w),this.demWorkerSources[J][rt]},$i.prototype.enforceCacheSizeLimit=function(J,rt){o.enforceCacheSizeLimit(rt)},typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new $i(self)),$i}),a(["./shared"],function(o){var s=o.createCommonjsModule(function(y){function b(L){return!_(L)}function _(L){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var F,$,j=new Blob([""],{type:"text/javascript"}),et=URL.createObjectURL(j);try{$=new Worker(et),F=!0}catch{F=!1}return $&&$.terminate(),URL.revokeObjectURL(et),F}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var F=document.createElement("canvas");F.width=F.height=1;var $=F.getContext("2d");if(!$)return!1;var j=$.getImageData(0,0,1,1);return j&&j.width===F.width}()?(C[D=L&&L.failIfMajorPerformanceCaveat]===void 0&&(C[D]=function(F){var $=function(et){var ut=document.createElement("canvas"),ht=Object.create(b.webGLContextAttributes);return ht.failIfMajorPerformanceCaveat=et,ut.probablySupportsContext?ut.probablySupportsContext("webgl",ht)||ut.probablySupportsContext("experimental-webgl",ht):ut.supportsContext?ut.supportsContext("webgl",ht)||ut.supportsContext("experimental-webgl",ht):ut.getContext("webgl",ht)||ut.getContext("experimental-webgl",ht)}(F);if(!$)return!1;var j=$.createShader($.VERTEX_SHADER);return!(!j||$.isContextLost())&&($.shaderSource(j,"void main() {}"),$.compileShader(j),$.getShaderParameter(j,$.COMPILE_STATUS)===!0)}(D)),C[D]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var D}y.exports?y.exports=b:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=b,window.mapboxgl.notSupportedReason=_);var C={};b.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),l={create:function(y,b,_){var C=o.window.document.createElement(y);return b!==void 0&&(C.className=b),_&&_.appendChild(C),C},createNS:function(y,b){return o.window.document.createElementNS(y,b)}},u=o.window.document&&o.window.document.documentElement.style;function c(y){if(!u)return y[0];for(var b=0;b<y.length;b++)if(y[b]in u)return y[b];return y[0]}var f,d=c(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);l.disableDrag=function(){u&&d&&(f=u[d],u[d]="none")},l.enableDrag=function(){u&&d&&(u[d]=f)};var v=c(["transform","WebkitTransform"]);l.setTransform=function(y,b){y.style[v]=b};var g=!1;try{var x=Object.defineProperty({},"passive",{get:function(){g=!0}});o.window.addEventListener("test",x,x),o.window.removeEventListener("test",x,x)}catch{g=!1}l.addEventListener=function(y,b,_,C){C===void 0&&(C={}),y.addEventListener(b,_,"passive"in C&&g?C:C.capture)},l.removeEventListener=function(y,b,_,C){C===void 0&&(C={}),y.removeEventListener(b,_,"passive"in C&&g?C:C.capture)};var w=function(y){y.preventDefault(),y.stopPropagation(),o.window.removeEventListener("click",w,!0)};function S(y){var b=y.userImage;return!!(b&&b.render&&b.render())&&(y.data.replace(new Uint8Array(b.data.buffer)),!0)}l.suppressClick=function(){o.window.addEventListener("click",w,!0),o.window.setTimeout(function(){o.window.removeEventListener("click",w,!0)},0)},l.mousePos=function(y,b){var _=y.getBoundingClientRect();return new o.Point(b.clientX-_.left-y.clientLeft,b.clientY-_.top-y.clientTop)},l.touchPos=function(y,b){for(var _=y.getBoundingClientRect(),C=[],L=0;L<b.length;L++)C.push(new o.Point(b[L].clientX-_.left-y.clientLeft,b[L].clientY-_.top-y.clientTop));return C},l.mouseButton=function(y){return o.window.InstallTrigger!==void 0&&y.button===2&&y.ctrlKey&&o.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:y.button},l.remove=function(y){y.parentNode&&y.parentNode.removeChild(y)};var A=function(y){function b(){y.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.RGBAImage({width:1,height:1}),this.dirty=!0}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.isLoaded=function(){return this.loaded},b.prototype.setLoaded=function(_){if(this.loaded!==_&&(this.loaded=_,_)){for(var C=0,L=this.requestors;C<L.length;C+=1){var D=L[C];this._notify(D.ids,D.callback)}this.requestors=[]}},b.prototype.getImage=function(_){return this.images[_]},b.prototype.addImage=function(_,C){this._validate(_,C)&&(this.images[_]=C)},b.prototype._validate=function(_,C){var L=!0;return this._validateStretch(C.stretchX,C.data&&C.data.width)||(this.fire(new o.ErrorEvent(new Error('Image "'+_+'" has invalid "stretchX" value'))),L=!1),this._validateStretch(C.stretchY,C.data&&C.data.height)||(this.fire(new o.ErrorEvent(new Error('Image "'+_+'" has invalid "stretchY" value'))),L=!1),this._validateContent(C.content,C)||(this.fire(new o.ErrorEvent(new Error('Image "'+_+'" has invalid "content" value'))),L=!1),L},b.prototype._validateStretch=function(_,C){if(!_)return!0;for(var L=0,D=0,F=_;D<F.length;D+=1){var $=F[D];if($[0]<L||$[1]<$[0]||C<$[1])return!1;L=$[1]}return!0},b.prototype._validateContent=function(_,C){return!(_&&(_.length!==4||_[0]<0||C.data.width<_[0]||_[1]<0||C.data.height<_[1]||_[2]<0||C.data.width<_[2]||_[3]<0||C.data.height<_[3]||_[2]<_[0]||_[3]<_[1]))},b.prototype.updateImage=function(_,C){C.version=this.images[_].version+1,this.images[_]=C,this.updatedImages[_]=!0},b.prototype.removeImage=function(_){var C=this.images[_];delete this.images[_],delete this.patterns[_],C.userImage&&C.userImage.onRemove&&C.userImage.onRemove()},b.prototype.listImages=function(){return Object.keys(this.images)},b.prototype.getImages=function(_,C){var L=!0;if(!this.isLoaded())for(var D=0,F=_;D<F.length;D+=1)this.images[F[D]]||(L=!1);this.isLoaded()||L?this._notify(_,C):this.requestors.push({ids:_,callback:C})},b.prototype._notify=function(_,C){for(var L={},D=0,F=_;D<F.length;D+=1){var $=F[D];this.images[$]||this.fire(new o.Event("styleimagemissing",{id:$}));var j=this.images[$];j?L[$]={data:j.data.clone(),pixelRatio:j.pixelRatio,sdf:j.sdf,version:j.version,stretchX:j.stretchX,stretchY:j.stretchY,content:j.content,hasRenderCallback:!!(j.userImage&&j.userImage.render)}:o.warnOnce('Image "'+$+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}C(null,L)},b.prototype.getPixelSize=function(){var _=this.atlasImage;return{width:_.width,height:_.height}},b.prototype.getPattern=function(_){var C=this.patterns[_],L=this.getImage(_);if(!L)return null;if(C&&C.position.version===L.version)return C.position;if(C)C.position.version=L.version;else{var D={w:L.data.width+2,h:L.data.height+2,x:0,y:0},F=new o.ImagePosition(D,L);this.patterns[_]={bin:D,position:F}}return this._updatePatternAtlas(),this.patterns[_].position},b.prototype.bind=function(_){var C=_.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new o.Texture(_,this.atlasImage,C.RGBA),this.atlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE)},b.prototype._updatePatternAtlas=function(){var _=[];for(var C in this.patterns)_.push(this.patterns[C].bin);var L=o.potpack(_),D=L.w,F=L.h,$=this.atlasImage;for(var j in $.resize({width:D||1,height:F||1}),this.patterns){var et=this.patterns[j].bin,ut=et.x+1,ht=et.y+1,dt=this.images[j].data,Ot=dt.width,At=dt.height;o.RGBAImage.copy(dt,$,{x:0,y:0},{x:ut,y:ht},{width:Ot,height:At}),o.RGBAImage.copy(dt,$,{x:0,y:At-1},{x:ut,y:ht-1},{width:Ot,height:1}),o.RGBAImage.copy(dt,$,{x:0,y:0},{x:ut,y:ht+At},{width:Ot,height:1}),o.RGBAImage.copy(dt,$,{x:Ot-1,y:0},{x:ut-1,y:ht},{width:1,height:At}),o.RGBAImage.copy(dt,$,{x:0,y:0},{x:ut+Ot,y:ht},{width:1,height:At})}this.dirty=!0},b.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},b.prototype.dispatchRenderCallbacks=function(_){for(var C=0,L=_;C<L.length;C+=1){var D=L[C];if(!this.callbackDispatchedThisFrame[D]){this.callbackDispatchedThisFrame[D]=!0;var F=this.images[D];S(F)&&this.updateImage(D,F)}}},b}(o.Evented),M=N,R=N,O=1e20;function N(y,b,_,C,L,D){this.fontSize=y||24,this.buffer=b===void 0?3:b,this.cutoff=C||.25,this.fontFamily=L||"sans-serif",this.fontWeight=D||"normal",this.radius=_||8;var F=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=F,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(F*F),this.gridInner=new Float64Array(F*F),this.f=new Float64Array(F),this.d=new Float64Array(F),this.z=new Float64Array(F+1),this.v=new Int16Array(F),this.middle=Math.round(F/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function k(y,b,_,C,L,D,F){for(var $=0;$<b;$++){for(var j=0;j<_;j++)C[j]=y[j*b+$];for(V(C,L,D,F,_),j=0;j<_;j++)y[j*b+$]=L[j]}for(j=0;j<_;j++){for($=0;$<b;$++)C[$]=y[j*b+$];for(V(C,L,D,F,b),$=0;$<b;$++)y[j*b+$]=Math.sqrt(L[$])}}function V(y,b,_,C,L){_[0]=0,C[0]=-O,C[1]=+O;for(var D=1,F=0;D<L;D++){for(var $=(y[D]+D*D-(y[_[F]]+_[F]*_[F]))/(2*D-2*_[F]);$<=C[F];)F--,$=(y[D]+D*D-(y[_[F]]+_[F]*_[F]))/(2*D-2*_[F]);_[++F]=D,C[F]=$,C[F+1]=+O}for(D=0,F=0;D<L;D++){for(;C[F+1]<D;)F++;b[D]=(D-_[F])*(D-_[F])+y[_[F]]}}N.prototype.draw=function(y){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(y,this.buffer,this.middle);for(var b=this.ctx.getImageData(0,0,this.size,this.size),_=new Uint8ClampedArray(this.size*this.size),C=0;C<this.size*this.size;C++){var L=b.data[4*C+3]/255;this.gridOuter[C]=L===1?0:L===0?O:Math.pow(Math.max(0,.5-L),2),this.gridInner[C]=L===1?O:L===0?0:Math.pow(Math.max(0,L-.5),2)}for(k(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),k(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),C=0;C<this.size*this.size;C++)_[C]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[C]-this.gridInner[C])/this.radius+this.cutoff))));return _},M.default=R;var Q=function(y,b){this.requestManager=y,this.localIdeographFontFamily=b,this.entries={}};Q.prototype.setURL=function(y){this.url=y},Q.prototype.getGlyphs=function(y,b){var _=this,C=[];for(var L in y)for(var D=0,F=y[L];D<F.length;D+=1)C.push({stack:L,id:F[D]});o.asyncAll(C,function($,j){var et=$.stack,ut=$.id,ht=_.entries[et];ht||(ht=_.entries[et]={glyphs:{},requests:{},ranges:{}});var dt=ht.glyphs[ut];if(dt===void 0){if(dt=_._tinySDF(ht,et,ut))return ht.glyphs[ut]=dt,void j(null,{stack:et,id:ut,glyph:dt});var Ot=Math.floor(ut/256);if(256*Ot>65535)j(new Error("glyphs > 65535 not supported"));else if(ht.ranges[Ot])j(null,{stack:et,id:ut,glyph:dt});else{var At=ht.requests[Ot];At||(At=ht.requests[Ot]=[],Q.loadGlyphRange(et,Ot,_.url,_.requestManager,function($t,Ct){if(Ct){for(var zt in Ct)_._doesCharSupportLocalGlyph(+zt)||(ht.glyphs[+zt]=Ct[+zt]);ht.ranges[Ot]=!0}for(var qt=0,se=At;qt<se.length;qt+=1)(0,se[qt])($t,Ct);delete ht.requests[Ot]})),At.push(function($t,Ct){$t?j($t):Ct&&j(null,{stack:et,id:ut,glyph:Ct[ut]||null})})}}else j(null,{stack:et,id:ut,glyph:dt})},function($,j){if($)b($);else if(j){for(var et={},ut=0,ht=j;ut<ht.length;ut+=1){var dt=ht[ut],Ot=dt.stack,At=dt.id,$t=dt.glyph;(et[Ot]||(et[Ot]={}))[At]=$t&&{id:$t.id,bitmap:$t.bitmap.clone(),metrics:$t.metrics}}b(null,et)}})},Q.prototype._doesCharSupportLocalGlyph=function(y){return!!this.localIdeographFontFamily&&(o.isChar["CJK Unified Ideographs"](y)||o.isChar["Hangul Syllables"](y)||o.isChar.Hiragana(y)||o.isChar.Katakana(y))},Q.prototype._tinySDF=function(y,b,_){var C=this.localIdeographFontFamily;if(C&&this._doesCharSupportLocalGlyph(_)){var L=y.tinySDF;if(!L){var D="400";/bold/i.test(b)?D="900":/medium/i.test(b)?D="500":/light/i.test(b)&&(D="200"),L=y.tinySDF=new Q.TinySDF(24,3,8,.25,C,D)}return{id:_,bitmap:new o.AlphaImage({width:30,height:30},L.draw(String.fromCharCode(_))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},Q.loadGlyphRange=function(y,b,_,C,L){var D=256*b,F=D+255,$=C.transformRequest(C.normalizeGlyphsURL(_).replace("{fontstack}",y).replace("{range}",D+"-"+F),o.ResourceType.Glyphs);o.getArrayBuffer($,function(j,et){if(j)L(j);else if(et){for(var ut={},ht=0,dt=o.parseGlyphPBF(et);ht<dt.length;ht+=1){var Ot=dt[ht];ut[Ot.id]=Ot}L(null,ut)}})},Q.TinySDF=M;var Y=function(){this.specification=o.styleSpec.light.position};Y.prototype.possiblyEvaluate=function(y,b){return o.sphericalToCartesian(y.expression.evaluate(b))},Y.prototype.interpolate=function(y,b,_){return{x:o.number(y.x,b.x,_),y:o.number(y.y,b.y,_),z:o.number(y.z,b.z,_)}};var X=new o.Properties({anchor:new o.DataConstantProperty(o.styleSpec.light.anchor),position:new Y,color:new o.DataConstantProperty(o.styleSpec.light.color),intensity:new o.DataConstantProperty(o.styleSpec.light.intensity)}),tt=function(y){function b(_){y.call(this),this._transitionable=new o.Transitionable(X),this.setLight(_),this._transitioning=this._transitionable.untransitioned()}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getLight=function(){return this._transitionable.serialize()},b.prototype.setLight=function(_,C){if(C===void 0&&(C={}),!this._validate(o.validateLight,_,C))for(var L in _){var D=_[L];o.endsWith(L,"-transition")?this._transitionable.setTransition(L.slice(0,-11),D):this._transitionable.setValue(L,D)}},b.prototype.updateTransitions=function(_){this._transitioning=this._transitionable.transitioned(_,this._transitioning)},b.prototype.hasTransition=function(){return this._transitioning.hasTransition()},b.prototype.recalculate=function(_){this.properties=this._transitioning.possiblyEvaluate(_)},b.prototype._validate=function(_,C,L){return(!L||L.validate!==!1)&&o.emitValidationErrors(this,_.call(o.validateStyle,o.extend({value:C,style:{glyphs:!0,sprite:!0},styleSpec:o.styleSpec})))},b}(o.Evented),it=function(y,b){this.width=y,this.height=b,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};it.prototype.getDash=function(y,b){var _=y.join(",")+String(b);return this.dashEntry[_]||(this.dashEntry[_]=this.addDash(y,b)),this.dashEntry[_]},it.prototype.getDashRanges=function(y,b,_){var C=[],L=y.length%2==1?-y[y.length-1]*_:0,D=y[0]*_,F=!0;C.push({left:L,right:D,isDash:F,zeroLength:y[0]===0});for(var $=y[0],j=1;j<y.length;j++){var et=y[j];C.push({left:L=$*_,right:D=($+=et)*_,isDash:F=!F,zeroLength:et===0})}return C},it.prototype.addRoundDash=function(y,b,_){for(var C=b/2,L=-_;L<=_;L++)for(var D=this.width*(this.nextRow+_+L),F=0,$=y[F],j=0;j<this.width;j++){j/$.right>1&&($=y[++F]);var et=Math.abs(j-$.left),ut=Math.abs(j-$.right),ht=Math.min(et,ut),dt=void 0,Ot=L/_*(C+1);if($.isDash){var At=C-Math.abs(Ot);dt=Math.sqrt(ht*ht+At*At)}else dt=C-Math.sqrt(ht*ht+Ot*Ot);this.data[D+j]=Math.max(0,Math.min(255,dt+128))}},it.prototype.addRegularDash=function(y){for(var b=y.length-1;b>=0;--b){var _=y[b],C=y[b+1];_.zeroLength?y.splice(b,1):C&&C.isDash===_.isDash&&(C.left=_.left,y.splice(b,1))}var L=y[0],D=y[y.length-1];L.isDash===D.isDash&&(L.left=D.left-this.width,D.right=L.right+this.width);for(var F=this.width*this.nextRow,$=0,j=y[$],et=0;et<this.width;et++){et/j.right>1&&(j=y[++$]);var ut=Math.abs(et-j.left),ht=Math.abs(et-j.right),dt=Math.min(ut,ht);this.data[F+et]=Math.max(0,Math.min(255,(j.isDash?dt:-dt)+128))}},it.prototype.addDash=function(y,b){var _=b?7:0,C=2*_+1;if(this.nextRow+C>this.height)return o.warnOnce("LineAtlas out of space"),null;for(var L=0,D=0;D<y.length;D++)L+=y[D];if(L!==0){var F=this.width/L,$=this.getDashRanges(y,this.width,F);b?this.addRoundDash($,F,_):this.addRegularDash($)}var j={y:(this.nextRow+_+.5)/this.height,height:2*_/this.height,width:L};return this.nextRow+=C,this.dirty=!0,j},it.prototype.bind=function(y){var b=y.gl;this.texture?(b.bindTexture(b.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,b.texSubImage2D(b.TEXTURE_2D,0,0,0,this.width,this.height,b.ALPHA,b.UNSIGNED_BYTE,this.data))):(this.texture=b.createTexture(),b.bindTexture(b.TEXTURE_2D,this.texture),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.REPEAT),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.REPEAT),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.LINEAR),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.LINEAR),b.texImage2D(b.TEXTURE_2D,0,b.ALPHA,this.width,this.height,0,b.ALPHA,b.UNSIGNED_BYTE,this.data))};var Et=function y(b,_){this.workerPool=b,this.actors=[],this.currentActor=0,this.id=o.uniqueId();for(var C=this.workerPool.acquire(this.id),L=0;L<C.length;L++){var D=new y.Actor(C[L],_,this.id);D.name="Worker "+L,this.actors.push(D)}};function Tt(y,b,_){var C=function(L,D){if(L)return _(L);if(D){var F=o.pick(o.extend(D,y),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);D.vector_layers&&(F.vectorLayers=D.vector_layers,F.vectorLayerIds=F.vectorLayers.map(function($){return $.id})),F.tiles=b.canonicalizeTileset(F,y.url),_(null,F)}};return y.url?o.getJSON(b.transformRequest(b.normalizeSourceURL(y.url),o.ResourceType.Source),C):o.browser.frame(function(){return C(null,y)})}Et.prototype.broadcast=function(y,b,_){o.asyncAll(this.actors,function(C,L){C.send(y,b,L)},_=_||function(){})},Et.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},Et.prototype.remove=function(){this.actors.forEach(function(y){y.remove()}),this.actors=[],this.workerPool.release(this.id)},Et.Actor=o.Actor;var pt=function(y,b,_){this.bounds=o.LngLatBounds.convert(this.validateBounds(y)),this.minzoom=b||0,this.maxzoom=_||24};pt.prototype.validateBounds=function(y){return Array.isArray(y)&&y.length===4?[Math.max(-180,y[0]),Math.max(-90,y[1]),Math.min(180,y[2]),Math.min(90,y[3])]:[-180,-90,180,90]},pt.prototype.contains=function(y){var b=Math.pow(2,y.z),_=Math.floor(o.mercatorXfromLng(this.bounds.getWest())*b),C=Math.floor(o.mercatorYfromLat(this.bounds.getNorth())*b),L=Math.ceil(o.mercatorXfromLng(this.bounds.getEast())*b),D=Math.ceil(o.mercatorYfromLat(this.bounds.getSouth())*b);return y.x>=_&&y.x<L&&y.y>=C&&y.y<D};var kt=function(y){function b(_,C,L,D){if(y.call(this),this.id=_,this.dispatcher=L,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.extend(this,o.pick(C,["url","scheme","tileSize","promoteId"])),this._options=o.extend({type:"vector"},C),this._collectResourceTiming=C.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(D)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.load=function(){var _=this;this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Tt(this._options,this.map._requestManager,function(C,L){_._tileJSONRequest=null,_._loaded=!0,C?_.fire(new o.ErrorEvent(C)):L&&(o.extend(_,L),L.bounds&&(_.tileBounds=new pt(L.bounds,_.minzoom,_.maxzoom)),o.postTurnstileEvent(L.tiles,_.map._requestManager._customAccessToken),o.postMapLoadEvent(L.tiles,_.map._getMapId(),_.map._requestManager._skuToken,_.map._requestManager._customAccessToken),_.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),_.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})},b.prototype.loaded=function(){return this._loaded},b.prototype.hasTile=function(_){return!this.tileBounds||this.tileBounds.contains(_.canonical)},b.prototype.onAdd=function(_){this.map=_,this.load()},b.prototype.setSourceProperty=function(_){this._tileJSONRequest&&this._tileJSONRequest.cancel(),_(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},b.prototype.setTiles=function(_){var C=this;return this.setSourceProperty(function(){C._options.tiles=_}),this},b.prototype.setUrl=function(_){var C=this;return this.setSourceProperty(function(){C.url=_,C._options.url=_}),this},b.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},b.prototype.serialize=function(){return o.extend({},this._options)},b.prototype.loadTile=function(_,C){var L=this.map._requestManager.normalizeTileURL(_.tileID.canonical.url(this.tiles,this.scheme)),D={request:this.map._requestManager.transformRequest(L,o.ResourceType.Tile),uid:_.uid,tileID:_.tileID,zoom:_.tileID.overscaledZ,tileSize:this.tileSize*_.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:o.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function F($,j){return delete _.request,_.aborted?C(null):$&&$.status!==404?C($):(j&&j.resourceTiming&&(_.resourceTiming=j.resourceTiming),this.map._refreshExpiredTiles&&j&&_.setExpiryData(j),_.loadVectorData(j,this.map.painter),o.cacheEntryPossiblyAdded(this.dispatcher),C(null),void(_.reloadCallback&&(this.loadTile(_,_.reloadCallback),_.reloadCallback=null)))}D.request.collectResourceTiming=this._collectResourceTiming,_.actor&&_.state!=="expired"?_.state==="loading"?_.reloadCallback=C:_.request=_.actor.send("reloadTile",D,F.bind(this)):(_.actor=this.dispatcher.getActor(),_.request=_.actor.send("loadTile",D,F.bind(this)))},b.prototype.abortTile=function(_){_.request&&(_.request.cancel(),delete _.request),_.actor&&_.actor.send("abortTile",{uid:_.uid,type:this.type,source:this.id},void 0)},b.prototype.unloadTile=function(_){_.unloadVectorData(),_.actor&&_.actor.send("removeTile",{uid:_.uid,type:this.type,source:this.id},void 0)},b.prototype.hasTransition=function(){return!1},b}(o.Evented),ae=function(y){function b(_,C,L,D){y.call(this),this.id=_,this.dispatcher=L,this.setEventedParent(D),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.extend({type:"raster"},C),o.extend(this,o.pick(C,["url","scheme","tileSize"]))}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.load=function(){var _=this;this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Tt(this._options,this.map._requestManager,function(C,L){_._tileJSONRequest=null,_._loaded=!0,C?_.fire(new o.ErrorEvent(C)):L&&(o.extend(_,L),L.bounds&&(_.tileBounds=new pt(L.bounds,_.minzoom,_.maxzoom)),o.postTurnstileEvent(L.tiles),o.postMapLoadEvent(L.tiles,_.map._getMapId(),_.map._requestManager._skuToken),_.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),_.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})},b.prototype.loaded=function(){return this._loaded},b.prototype.onAdd=function(_){this.map=_,this.load()},b.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},b.prototype.serialize=function(){return o.extend({},this._options)},b.prototype.hasTile=function(_){return!this.tileBounds||this.tileBounds.contains(_.canonical)},b.prototype.loadTile=function(_,C){var L=this,D=this.map._requestManager.normalizeTileURL(_.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);_.request=o.getImage(this.map._requestManager.transformRequest(D,o.ResourceType.Tile),function(F,$){if(delete _.request,_.aborted)_.state="unloaded",C(null);else if(F)_.state="errored",C(F);else if($){L.map._refreshExpiredTiles&&_.setExpiryData($),delete $.cacheControl,delete $.expires;var j=L.map.painter.context,et=j.gl;_.texture=L.map.painter.getTileTexture($.width),_.texture?_.texture.update($,{useMipmap:!0}):(_.texture=new o.Texture(j,$,et.RGBA,{useMipmap:!0}),_.texture.bind(et.LINEAR,et.CLAMP_TO_EDGE,et.LINEAR_MIPMAP_NEAREST),j.extTextureFilterAnisotropic&&et.texParameterf(et.TEXTURE_2D,j.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,j.extTextureFilterAnisotropicMax)),_.state="loaded",o.cacheEntryPossiblyAdded(L.dispatcher),C(null)}})},b.prototype.abortTile=function(_,C){_.request&&(_.request.cancel(),delete _.request),C()},b.prototype.unloadTile=function(_,C){_.texture&&this.map.painter.saveTileTexture(_.texture),C()},b.prototype.hasTransition=function(){return!1},b}(o.Evented),Kt=function(y){function b(_,C,L,D){y.call(this,_,C,L,D),this.type="raster-dem",this.maxzoom=22,this._options=o.extend({type:"raster-dem"},C),this.encoding=C.encoding||"mapbox"}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},b.prototype.loadTile=function(_,C){var L=this.map._requestManager.normalizeTileURL(_.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function D(F,$){F&&(_.state="errored",C(F)),$&&(_.dem=$,_.needsHillshadePrepare=!0,_.state="loaded",C(null))}_.request=o.getImage(this.map._requestManager.transformRequest(L,o.ResourceType.Tile),(function(F,$){if(delete _.request,_.aborted)_.state="unloaded",C(null);else if(F)_.state="errored",C(F);else if($){this.map._refreshExpiredTiles&&_.setExpiryData($),delete $.cacheControl,delete $.expires;var j=o.window.ImageBitmap&&$ instanceof o.window.ImageBitmap&&o.offscreenCanvasSupported()?$:o.browser.getImageData($,1),et={uid:_.uid,coord:_.tileID,source:this.id,rawImageData:j,encoding:this.encoding};_.actor&&_.state!=="expired"||(_.actor=this.dispatcher.getActor(),_.actor.send("loadDEMTile",et,D.bind(this)))}}).bind(this)),_.neighboringTiles=this._getNeighboringTiles(_.tileID)},b.prototype._getNeighboringTiles=function(_){var C=_.canonical,L=Math.pow(2,C.z),D=(C.x-1+L)%L,F=C.x===0?_.wrap-1:_.wrap,$=(C.x+1+L)%L,j=C.x+1===L?_.wrap+1:_.wrap,et={};return et[new o.OverscaledTileID(_.overscaledZ,F,C.z,D,C.y).key]={backfilled:!1},et[new o.OverscaledTileID(_.overscaledZ,j,C.z,$,C.y).key]={backfilled:!1},C.y>0&&(et[new o.OverscaledTileID(_.overscaledZ,F,C.z,D,C.y-1).key]={backfilled:!1},et[new o.OverscaledTileID(_.overscaledZ,_.wrap,C.z,C.x,C.y-1).key]={backfilled:!1},et[new o.OverscaledTileID(_.overscaledZ,j,C.z,$,C.y-1).key]={backfilled:!1}),C.y+1<L&&(et[new o.OverscaledTileID(_.overscaledZ,F,C.z,D,C.y+1).key]={backfilled:!1},et[new o.OverscaledTileID(_.overscaledZ,_.wrap,C.z,C.x,C.y+1).key]={backfilled:!1},et[new o.OverscaledTileID(_.overscaledZ,j,C.z,$,C.y+1).key]={backfilled:!1}),et},b.prototype.unloadTile=function(_){_.demTexture&&this.map.painter.saveTileTexture(_.demTexture),_.fbo&&(_.fbo.destroy(),delete _.fbo),_.dem&&delete _.dem,delete _.neighboringTiles,_.state="unloaded",_.actor&&_.actor.send("removeDEMTile",{uid:_.uid,source:this.id})},b}(ae),re=function(y){function b(_,C,L,D){y.call(this),this.id=_,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=L.getActor(),this.setEventedParent(D),this._data=C.data,this._options=o.extend({},C),this._collectResourceTiming=C.collectResourceTiming,this._resourceTiming=[],C.maxzoom!==void 0&&(this.maxzoom=C.maxzoom),C.type&&(this.type=C.type),C.attribution&&(this.attribution=C.attribution),this.promoteId=C.promoteId;var F=o.EXTENT/this.tileSize;this.workerOptions=o.extend({source:this.id,cluster:C.cluster||!1,geojsonVtOptions:{buffer:(C.buffer!==void 0?C.buffer:128)*F,tolerance:(C.tolerance!==void 0?C.tolerance:.375)*F,extent:o.EXTENT,maxZoom:this.maxzoom,lineMetrics:C.lineMetrics||!1,generateId:C.generateId||!1},superclusterOptions:{maxZoom:C.clusterMaxZoom!==void 0?Math.min(C.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,C.clusterMinPoints||2),extent:o.EXTENT,radius:(C.clusterRadius||50)*F,log:!1,generateId:C.generateId||!1},clusterProperties:C.clusterProperties,filter:C.filter},C.workerOptions)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.load=function(){var _=this;this.fire(new o.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(C){if(C)_.fire(new o.ErrorEvent(C));else{var L={dataType:"source",sourceDataType:"metadata"};_._collectResourceTiming&&_._resourceTiming&&_._resourceTiming.length>0&&(L.resourceTiming=_._resourceTiming,_._resourceTiming=[]),_.fire(new o.Event("data",L))}})},b.prototype.onAdd=function(_){this.map=_,this.load()},b.prototype.setData=function(_){var C=this;return this._data=_,this.fire(new o.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(L){if(L)C.fire(new o.ErrorEvent(L));else{var D={dataType:"source",sourceDataType:"content"};C._collectResourceTiming&&C._resourceTiming&&C._resourceTiming.length>0&&(D.resourceTiming=C._resourceTiming,C._resourceTiming=[]),C.fire(new o.Event("data",D))}}),this},b.prototype.getClusterExpansionZoom=function(_,C){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:_,source:this.id},C),this},b.prototype.getClusterChildren=function(_,C){return this.actor.send("geojson.getClusterChildren",{clusterId:_,source:this.id},C),this},b.prototype.getClusterLeaves=function(_,C,L,D){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:_,limit:C,offset:L},D),this},b.prototype._updateWorkerData=function(_){var C=this;this._loaded=!1;var L=o.extend({},this.workerOptions),D=this._data;typeof D=="string"?(L.request=this.map._requestManager.transformRequest(o.browser.resolveURL(D),o.ResourceType.Source),L.request.collectResourceTiming=this._collectResourceTiming):L.data=JSON.stringify(D),this.actor.send(this.type+".loadData",L,function(F,$){C._removed||$&&$.abandoned||(C._loaded=!0,$&&$.resourceTiming&&$.resourceTiming[C.id]&&(C._resourceTiming=$.resourceTiming[C.id].slice(0)),C.actor.send(C.type+".coalesce",{source:L.source},null),_(F))})},b.prototype.loaded=function(){return this._loaded},b.prototype.loadTile=function(_,C){var L=this,D=_.actor?"reloadTile":"loadTile";_.actor=this.actor,_.request=this.actor.send(D,{type:this.type,uid:_.uid,tileID:_.tileID,zoom:_.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:o.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(F,$){return delete _.request,_.unloadVectorData(),_.aborted?C(null):F?C(F):(_.loadVectorData($,L.map.painter,D==="reloadTile"),C(null))})},b.prototype.abortTile=function(_){_.request&&(_.request.cancel(),delete _.request),_.aborted=!0},b.prototype.unloadTile=function(_){_.unloadVectorData(),this.actor.send("removeTile",{uid:_.uid,type:this.type,source:this.id})},b.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},b.prototype.serialize=function(){return o.extend({},this._options,{type:this.type,data:this._data})},b.prototype.hasTransition=function(){return!1},b}(o.Evented),fe=o.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),Oe=function(y){function b(_,C,L,D){y.call(this),this.id=_,this.dispatcher=L,this.coordinates=C.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(D),this.options=C}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.load=function(_,C){var L=this;this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this.url=this.options.url,o.getImage(this.map._requestManager.transformRequest(this.url,o.ResourceType.Image),function(D,F){L._loaded=!0,D?L.fire(new o.ErrorEvent(D)):F&&(L.image=F,_&&(L.coordinates=_),C&&C(),L._finishLoading())})},b.prototype.loaded=function(){return this._loaded},b.prototype.updateImage=function(_){var C=this;return this.image&&_.url?(this.options.url=_.url,this.load(_.coordinates,function(){C.texture=null}),this):this},b.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})))},b.prototype.onAdd=function(_){this.map=_,this.load()},b.prototype.setCoordinates=function(_){var C=this;this.coordinates=_;var L=_.map(o.MercatorCoordinate.fromLngLat);this.tileID=function(F){for(var $=1/0,j=1/0,et=-1/0,ut=-1/0,ht=0,dt=F;ht<dt.length;ht+=1){var Ot=dt[ht];$=Math.min($,Ot.x),j=Math.min(j,Ot.y),et=Math.max(et,Ot.x),ut=Math.max(ut,Ot.y)}var At=Math.max(et-$,ut-j),$t=Math.max(0,Math.floor(-Math.log(At)/Math.LN2)),Ct=Math.pow(2,$t);return new o.CanonicalTileID($t,Math.floor(($+et)/2*Ct),Math.floor((j+ut)/2*Ct))}(L),this.minzoom=this.maxzoom=this.tileID.z;var D=L.map(function(F){return C.tileID.getTilePoint(F)._round()});return this._boundsArray=new o.StructArrayLayout4i8,this._boundsArray.emplaceBack(D[0].x,D[0].y,0,0),this._boundsArray.emplaceBack(D[1].x,D[1].y,o.EXTENT,0),this._boundsArray.emplaceBack(D[3].x,D[3].y,0,o.EXTENT),this._boundsArray.emplaceBack(D[2].x,D[2].y,o.EXTENT,o.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})),this},b.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var _=this.map.painter.context,C=_.gl;for(var L in this.boundsBuffer||(this.boundsBuffer=_.createVertexBuffer(this._boundsArray,fe.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new o.Texture(_,this.image,C.RGBA),this.texture.bind(C.LINEAR,C.CLAMP_TO_EDGE)),this.tiles){var D=this.tiles[L];D.state!=="loaded"&&(D.state="loaded",D.texture=this.texture)}}},b.prototype.loadTile=function(_,C){this.tileID&&this.tileID.equals(_.tileID.canonical)?(this.tiles[String(_.tileID.wrap)]=_,_.buckets={},C(null)):(_.state="errored",C(null))},b.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},b.prototype.hasTransition=function(){return!1},b}(o.Evented),Ye=function(y){function b(_,C,L,D){y.call(this,_,C,L,D),this.roundZoom=!0,this.type="video",this.options=C}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.load=function(){var _=this;this._loaded=!1;var C=this.options;this.urls=[];for(var L=0,D=C.urls;L<D.length;L+=1)this.urls.push(this.map._requestManager.transformRequest(D[L],o.ResourceType.Source).url);o.getVideo(this.urls,function(F,$){_._loaded=!0,F?_.fire(new o.ErrorEvent(F)):$&&(_.video=$,_.video.loop=!0,_.video.setAttribute("playsinline",""),_.video.addEventListener("playing",function(){_.map.triggerRepaint()}),_.map&&_.video.play(),_._finishLoading())})},b.prototype.pause=function(){this.video&&this.video.pause()},b.prototype.play=function(){this.video&&this.video.play()},b.prototype.seek=function(_){if(this.video){var C=this.video.seekable;_<C.start(0)||_>C.end(0)?this.fire(new o.ErrorEvent(new o.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+C.start(0)+" and "+C.end(0)+"-second mark."))):this.video.currentTime=_}},b.prototype.getVideo=function(){return this.video},b.prototype.onAdd=function(_){this.map||(this.map=_,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},b.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var _=this.map.painter.context,C=_.gl;for(var L in this.boundsBuffer||(this.boundsBuffer=_.createVertexBuffer(this._boundsArray,fe.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(C.LINEAR,C.CLAMP_TO_EDGE),C.texSubImage2D(C.TEXTURE_2D,0,0,0,C.RGBA,C.UNSIGNED_BYTE,this.video)):(this.texture=new o.Texture(_,this.video,C.RGBA),this.texture.bind(C.LINEAR,C.CLAMP_TO_EDGE)),this.tiles){var D=this.tiles[L];D.state!=="loaded"&&(D.state="loaded",D.texture=this.texture)}}},b.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},b.prototype.hasTransition=function(){return this.video&&!this.video.paused},b}(Oe),Be=function(y){function b(_,C,L,D){y.call(this,_,C,L,D),C.coordinates?Array.isArray(C.coordinates)&&C.coordinates.length===4&&!C.coordinates.some(function(F){return!Array.isArray(F)||F.length!==2||F.some(function($){return typeof $!="number"})})||this.fire(new o.ErrorEvent(new o.ValidationError("sources."+_,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.ErrorEvent(new o.ValidationError("sources."+_,null,'missing required property "coordinates"'))),C.animate&&typeof C.animate!="boolean"&&this.fire(new o.ErrorEvent(new o.ValidationError("sources."+_,null,'optional "animate" property must be a boolean value'))),C.canvas?typeof C.canvas=="string"||C.canvas instanceof o.window.HTMLCanvasElement||this.fire(new o.ErrorEvent(new o.ValidationError("sources."+_,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.ErrorEvent(new o.ValidationError("sources."+_,null,'missing required property "canvas"'))),this.options=C,this.animate=C.animate===void 0||C.animate}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof o.window.HTMLCanvasElement?this.options.canvas:o.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},b.prototype.getCanvas=function(){return this.canvas},b.prototype.onAdd=function(_){this.map=_,this.load(),this.canvas&&this.animate&&this.play()},b.prototype.onRemove=function(){this.pause()},b.prototype.prepare=function(){var _=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,_=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,_=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var C=this.map.painter.context,L=C.gl;for(var D in this.boundsBuffer||(this.boundsBuffer=C.createVertexBuffer(this._boundsArray,fe.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(_||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new o.Texture(C,this.canvas,L.RGBA,{premultiply:!0}),this.tiles){var F=this.tiles[D];F.state!=="loaded"&&(F.state="loaded",F.texture=this.texture)}}},b.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},b.prototype.hasTransition=function(){return this._playing},b.prototype._hasInvalidDimensions=function(){for(var _=0,C=[this.canvas.width,this.canvas.height];_<C.length;_+=1){var L=C[_];if(isNaN(L)||L<=0)return!0}return!1},b}(Oe),De={vector:kt,raster:ae,"raster-dem":Kt,geojson:re,video:Ye,image:Oe,canvas:Be};function Yr(y,b){var _=o.identity([]);return o.translate(_,_,[1,1,0]),o.scale(_,_,[.5*y.width,.5*y.height,1]),o.multiply(_,_,y.calculatePosMatrix(b.toUnwrapped()))}function Gr(y,b,_,C,L,D){var F=function($t,Ct,zt){if($t)for(var qt=0,se=$t;qt<se.length;qt+=1){var Ee=Ct[se[qt]];if(Ee&&Ee.source===zt&&Ee.type==="fill-extrusion")return!0}else for(var pe in Ct){var Ae=Ct[pe];if(Ae.source===zt&&Ae.type==="fill-extrusion")return!0}return!1}(L&&L.layers,b,y.id),$=D.maxPitchScaleFactor(),j=y.tilesIn(C,$,F);j.sort(Mn);for(var et=[],ut=0,ht=j;ut<ht.length;ut+=1){var dt=ht[ut];et.push({wrappedTileID:dt.tileID.wrapped().key,queryResults:dt.tile.queryRenderedFeatures(b,_,y._state,dt.queryGeometry,dt.cameraQueryGeometry,dt.scale,L,D,$,Yr(y.transform,dt.tileID))})}var Ot=function($t){for(var Ct={},zt={},qt=0,se=$t;qt<se.length;qt+=1){var Ee=se[qt],pe=Ee.queryResults,Ae=Ee.wrappedTileID,Ve=zt[Ae]=zt[Ae]||{};for(var cr in pe)for(var ar=pe[cr],Mr=Ve[cr]=Ve[cr]||{},sn=Ct[cr]=Ct[cr]||[],hn=0,cn=ar;hn<cn.length;hn+=1){var Ii=cn[hn];Mr[Ii.featureIndex]||(Mr[Ii.featureIndex]=!0,sn.push(Ii))}}return Ct}(et);for(var At in Ot)Ot[At].forEach(function($t){var Ct=$t.feature,zt=y.getFeatureState(Ct.layer["source-layer"],Ct.id);Ct.source=Ct.layer.source,Ct.layer["source-layer"]&&(Ct.sourceLayer=Ct.layer["source-layer"]),Ct.state=zt});return Ot}function Mn(y,b){var _=y.tileID,C=b.tileID;return _.overscaledZ-C.overscaledZ||_.canonical.y-C.canonical.y||_.wrap-C.wrap||_.canonical.x-C.canonical.x}var ee=function(y,b){this.max=y,this.onRemove=b,this.reset()};ee.prototype.reset=function(){for(var y in this.data)for(var b=0,_=this.data[y];b<_.length;b+=1){var C=_[b];C.timeout&&clearTimeout(C.timeout),this.onRemove(C.value)}return this.data={},this.order=[],this},ee.prototype.add=function(y,b,_){var C=this,L=y.wrapped().key;this.data[L]===void 0&&(this.data[L]=[]);var D={value:b,timeout:void 0};if(_!==void 0&&(D.timeout=setTimeout(function(){C.remove(y,D)},_)),this.data[L].push(D),this.order.push(L),this.order.length>this.max){var F=this._getAndRemoveByKey(this.order[0]);F&&this.onRemove(F)}return this},ee.prototype.has=function(y){return y.wrapped().key in this.data},ee.prototype.getAndRemove=function(y){return this.has(y)?this._getAndRemoveByKey(y.wrapped().key):null},ee.prototype._getAndRemoveByKey=function(y){var b=this.data[y].shift();return b.timeout&&clearTimeout(b.timeout),this.data[y].length===0&&delete this.data[y],this.order.splice(this.order.indexOf(y),1),b.value},ee.prototype.getByKey=function(y){var b=this.data[y];return b?b[0].value:null},ee.prototype.get=function(y){return this.has(y)?this.data[y.wrapped().key][0].value:null},ee.prototype.remove=function(y,b){if(!this.has(y))return this;var _=y.wrapped().key,C=b===void 0?0:this.data[_].indexOf(b),L=this.data[_][C];return this.data[_].splice(C,1),L.timeout&&clearTimeout(L.timeout),this.data[_].length===0&&delete this.data[_],this.onRemove(L.value),this.order.splice(this.order.indexOf(_),1),this},ee.prototype.setMaxSize=function(y){for(this.max=y;this.order.length>this.max;){var b=this._getAndRemoveByKey(this.order[0]);b&&this.onRemove(b)}return this},ee.prototype.filter=function(y){var b=[];for(var _ in this.data)for(var C=0,L=this.data[_];C<L.length;C+=1){var D=L[C];y(D.value)||b.push(D)}for(var F=0,$=b;F<$.length;F+=1){var j=$[F];this.remove(j.value.tileID,j)}};var rr=function(y,b,_){this.context=y;var C=y.gl;this.buffer=C.createBuffer(),this.dynamicDraw=!!_,this.context.unbindVAO(),y.bindElementBuffer.set(this.buffer),C.bufferData(C.ELEMENT_ARRAY_BUFFER,b.arrayBuffer,this.dynamicDraw?C.DYNAMIC_DRAW:C.STATIC_DRAW),this.dynamicDraw||delete b.arrayBuffer};rr.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},rr.prototype.updateData=function(y){var b=this.context.gl;this.context.unbindVAO(),this.bind(),b.bufferSubData(b.ELEMENT_ARRAY_BUFFER,0,y.arrayBuffer)},rr.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Nr={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Fe=function(y,b,_,C){this.length=b.length,this.attributes=_,this.itemSize=b.bytesPerElement,this.dynamicDraw=C,this.context=y;var L=y.gl;this.buffer=L.createBuffer(),y.bindVertexBuffer.set(this.buffer),L.bufferData(L.ARRAY_BUFFER,b.arrayBuffer,this.dynamicDraw?L.DYNAMIC_DRAW:L.STATIC_DRAW),this.dynamicDraw||delete b.arrayBuffer};Fe.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Fe.prototype.updateData=function(y){var b=this.context.gl;this.bind(),b.bufferSubData(b.ARRAY_BUFFER,0,y.arrayBuffer)},Fe.prototype.enableAttributes=function(y,b){for(var _=0;_<this.attributes.length;_++){var C=b.attributes[this.attributes[_].name];C!==void 0&&y.enableVertexAttribArray(C)}},Fe.prototype.setVertexAttribPointers=function(y,b,_){for(var C=0;C<this.attributes.length;C++){var L=this.attributes[C],D=b.attributes[L.name];D!==void 0&&y.vertexAttribPointer(D,L.components,y[Nr[L.type]],!1,this.itemSize,L.offset+this.itemSize*(_||0))}},Fe.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Hr=function(y){this.gl=y.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};Hr.prototype.get=function(){return this.current},Hr.prototype.set=function(y){},Hr.prototype.getDefault=function(){return this.default},Hr.prototype.setDefault=function(){this.set(this.default)};var _n=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return o.Color.transparent},b.prototype.set=function(_){var C=this.current;(_.r!==C.r||_.g!==C.g||_.b!==C.b||_.a!==C.a||this.dirty)&&(this.gl.clearColor(_.r,_.g,_.b,_.a),this.current=_,this.dirty=!1)},b}(Hr),Kn=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return 1},b.prototype.set=function(_){(_!==this.current||this.dirty)&&(this.gl.clearDepth(_),this.current=_,this.dirty=!1)},b}(Hr),vn=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return 0},b.prototype.set=function(_){(_!==this.current||this.dirty)&&(this.gl.clearStencil(_),this.current=_,this.dirty=!1)},b}(Hr),xn=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return[!0,!0,!0,!0]},b.prototype.set=function(_){var C=this.current;(_[0]!==C[0]||_[1]!==C[1]||_[2]!==C[2]||_[3]!==C[3]||this.dirty)&&(this.gl.colorMask(_[0],_[1],_[2],_[3]),this.current=_,this.dirty=!1)},b}(Hr),ui=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return!0},b.prototype.set=function(_){(_!==this.current||this.dirty)&&(this.gl.depthMask(_),this.current=_,this.dirty=!1)},b}(Hr),Ao=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return 255},b.prototype.set=function(_){(_!==this.current||this.dirty)&&(this.gl.stencilMask(_),this.current=_,this.dirty=!1)},b}(Hr),ta=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},b.prototype.set=function(_){var C=this.current;(_.func!==C.func||_.ref!==C.ref||_.mask!==C.mask||this.dirty)&&(this.gl.stencilFunc(_.func,_.ref,_.mask),this.current=_,this.dirty=!1)},b}(Hr),oa=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){var _=this.gl;return[_.KEEP,_.KEEP,_.KEEP]},b.prototype.set=function(_){var C=this.current;(_[0]!==C[0]||_[1]!==C[1]||_[2]!==C[2]||this.dirty)&&(this.gl.stencilOp(_[0],_[1],_[2]),this.current=_,this.dirty=!1)},b}(Hr),as=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return!1},b.prototype.set=function(_){if(_!==this.current||this.dirty){var C=this.gl;_?C.enable(C.STENCIL_TEST):C.disable(C.STENCIL_TEST),this.current=_,this.dirty=!1}},b}(Hr),bt=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return[0,1]},b.prototype.set=function(_){var C=this.current;(_[0]!==C[0]||_[1]!==C[1]||this.dirty)&&(this.gl.depthRange(_[0],_[1]),this.current=_,this.dirty=!1)},b}(Hr),os=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return!1},b.prototype.set=function(_){if(_!==this.current||this.dirty){var C=this.gl;_?C.enable(C.DEPTH_TEST):C.disable(C.DEPTH_TEST),this.current=_,this.dirty=!1}},b}(Hr),gu=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return this.gl.LESS},b.prototype.set=function(_){(_!==this.current||this.dirty)&&(this.gl.depthFunc(_),this.current=_,this.dirty=!1)},b}(Hr),ss=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return!1},b.prototype.set=function(_){if(_!==this.current||this.dirty){var C=this.gl;_?C.enable(C.BLEND):C.disable(C.BLEND),this.current=_,this.dirty=!1}},b}(Hr),Vu=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){var _=this.gl;return[_.ONE,_.ZERO]},b.prototype.set=function(_){var C=this.current;(_[0]!==C[0]||_[1]!==C[1]||this.dirty)&&(this.gl.blendFunc(_[0],_[1]),this.current=_,this.dirty=!1)},b}(Hr),va=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return o.Color.transparent},b.prototype.set=function(_){var C=this.current;(_.r!==C.r||_.g!==C.g||_.b!==C.b||_.a!==C.a||this.dirty)&&(this.gl.blendColor(_.r,_.g,_.b,_.a),this.current=_,this.dirty=!1)},b}(Hr),ls=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return this.gl.FUNC_ADD},b.prototype.set=function(_){(_!==this.current||this.dirty)&&(this.gl.blendEquation(_),this.current=_,this.dirty=!1)},b}(Hr),il=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return!1},b.prototype.set=function(_){if(_!==this.current||this.dirty){var C=this.gl;_?C.enable(C.CULL_FACE):C.disable(C.CULL_FACE),this.current=_,this.dirty=!1}},b}(Hr),us=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return this.gl.BACK},b.prototype.set=function(_){(_!==this.current||this.dirty)&&(this.gl.cullFace(_),this.current=_,this.dirty=!1)},b}(Hr),dc=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return this.gl.CCW},b.prototype.set=function(_){(_!==this.current||this.dirty)&&(this.gl.frontFace(_),this.current=_,this.dirty=!1)},b}(Hr),fo=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return null},b.prototype.set=function(_){(_!==this.current||this.dirty)&&(this.gl.useProgram(_),this.current=_,this.dirty=!1)},b}(Hr),Gu=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return this.gl.TEXTURE0},b.prototype.set=function(_){(_!==this.current||this.dirty)&&(this.gl.activeTexture(_),this.current=_,this.dirty=!1)},b}(Hr),Cl=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){var _=this.gl;return[0,0,_.drawingBufferWidth,_.drawingBufferHeight]},b.prototype.set=function(_){var C=this.current;(_[0]!==C[0]||_[1]!==C[1]||_[2]!==C[2]||_[3]!==C[3]||this.dirty)&&(this.gl.viewport(_[0],_[1],_[2],_[3]),this.current=_,this.dirty=!1)},b}(Hr),oh=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return null},b.prototype.set=function(_){if(_!==this.current||this.dirty){var C=this.gl;C.bindFramebuffer(C.FRAMEBUFFER,_),this.current=_,this.dirty=!1}},b}(Hr),nd=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return null},b.prototype.set=function(_){if(_!==this.current||this.dirty){var C=this.gl;C.bindRenderbuffer(C.RENDERBUFFER,_),this.current=_,this.dirty=!1}},b}(Hr),sh=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return null},b.prototype.set=function(_){if(_!==this.current||this.dirty){var C=this.gl;C.bindTexture(C.TEXTURE_2D,_),this.current=_,this.dirty=!1}},b}(Hr),Jd=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return null},b.prototype.set=function(_){if(_!==this.current||this.dirty){var C=this.gl;C.bindBuffer(C.ARRAY_BUFFER,_),this.current=_,this.dirty=!1}},b}(Hr),lh=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return null},b.prototype.set=function(_){var C=this.gl;C.bindBuffer(C.ELEMENT_ARRAY_BUFFER,_),this.current=_,this.dirty=!1},b}(Hr),jl=function(y){function b(_){y.call(this,_),this.vao=_.extVertexArrayObject}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return null},b.prototype.set=function(_){this.vao&&(_!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(_),this.current=_,this.dirty=!1)},b}(Hr),Yl=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return 4},b.prototype.set=function(_){if(_!==this.current||this.dirty){var C=this.gl;C.pixelStorei(C.UNPACK_ALIGNMENT,_),this.current=_,this.dirty=!1}},b}(Hr),pc=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return!1},b.prototype.set=function(_){if(_!==this.current||this.dirty){var C=this.gl;C.pixelStorei(C.UNPACK_PREMULTIPLY_ALPHA_WEBGL,_),this.current=_,this.dirty=!1}},b}(Hr),id=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return!1},b.prototype.set=function(_){if(_!==this.current||this.dirty){var C=this.gl;C.pixelStorei(C.UNPACK_FLIP_Y_WEBGL,_),this.current=_,this.dirty=!1}},b}(Hr),$i=function(y){function b(_,C){y.call(this,_),this.context=_,this.parent=C}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getDefault=function(){return null},b}(Hr),J=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.setDirty=function(){this.dirty=!0},b.prototype.set=function(_){if(_!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var C=this.gl;C.framebufferTexture2D(C.FRAMEBUFFER,C.COLOR_ATTACHMENT0,C.TEXTURE_2D,_,0),this.current=_,this.dirty=!1}},b}($i),rt=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.set=function(_){if(_!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var C=this.gl;C.framebufferRenderbuffer(C.FRAMEBUFFER,C.DEPTH_ATTACHMENT,C.RENDERBUFFER,_),this.current=_,this.dirty=!1}},b}($i),at=function(y,b,_,C){this.context=y,this.width=b,this.height=_;var L=this.framebuffer=y.gl.createFramebuffer();this.colorAttachment=new J(y,L),C&&(this.depthAttachment=new rt(y,L))};at.prototype.destroy=function(){var y=this.context.gl,b=this.colorAttachment.get();if(b&&y.deleteTexture(b),this.depthAttachment){var _=this.depthAttachment.get();_&&y.deleteRenderbuffer(_)}y.deleteFramebuffer(this.framebuffer)};var mt=function(y,b,_){this.func=y,this.mask=b,this.range=_};mt.ReadOnly=!1,mt.ReadWrite=!0,mt.disabled=new mt(519,mt.ReadOnly,[0,1]);var Mt=function(y,b,_,C,L,D){this.test=y,this.ref=b,this.mask=_,this.fail=C,this.depthFail=L,this.pass=D};Mt.disabled=new Mt({func:519,mask:0},0,0,7680,7680,7680);var Xt=function(y,b,_){this.blendFunction=y,this.blendColor=b,this.mask=_};Xt.disabled=new Xt(Xt.Replace=[1,0],o.Color.transparent,[!1,!1,!1,!1]),Xt.unblended=new Xt(Xt.Replace,o.Color.transparent,[!0,!0,!0,!0]),Xt.alphaBlended=new Xt([1,771],o.Color.transparent,[!0,!0,!0,!0]);var Qt=function(y,b,_){this.enable=y,this.mode=b,this.frontFace=_};Qt.disabled=new Qt(!1,1029,2305),Qt.backCCW=new Qt(!0,1029,2305);var ct=function(y){this.gl=y,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new _n(this),this.clearDepth=new Kn(this),this.clearStencil=new vn(this),this.colorMask=new xn(this),this.depthMask=new ui(this),this.stencilMask=new Ao(this),this.stencilFunc=new ta(this),this.stencilOp=new oa(this),this.stencilTest=new as(this),this.depthRange=new bt(this),this.depthTest=new os(this),this.depthFunc=new gu(this),this.blend=new ss(this),this.blendFunc=new Vu(this),this.blendColor=new va(this),this.blendEquation=new ls(this),this.cullFace=new il(this),this.cullFaceSide=new us(this),this.frontFace=new dc(this),this.program=new fo(this),this.activeTexture=new Gu(this),this.viewport=new Cl(this),this.bindFramebuffer=new oh(this),this.bindRenderbuffer=new nd(this),this.bindTexture=new sh(this),this.bindVertexBuffer=new Jd(this),this.bindElementBuffer=new lh(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new jl(this),this.pixelStoreUnpack=new Yl(this),this.pixelStoreUnpackPremultiplyAlpha=new pc(this),this.pixelStoreUnpackFlipY=new id(this),this.extTextureFilterAnisotropic=y.getExtension("EXT_texture_filter_anisotropic")||y.getExtension("MOZ_EXT_texture_filter_anisotropic")||y.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=y.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=y.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(y.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=y.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=y.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=y.getParameter(y.MAX_TEXTURE_SIZE)};ct.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},ct.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},ct.prototype.createIndexBuffer=function(y,b){return new rr(this,y,b)},ct.prototype.createVertexBuffer=function(y,b,_){return new Fe(this,y,b,_)},ct.prototype.createRenderbuffer=function(y,b,_){var C=this.gl,L=C.createRenderbuffer();return this.bindRenderbuffer.set(L),C.renderbufferStorage(C.RENDERBUFFER,y,b,_),this.bindRenderbuffer.set(null),L},ct.prototype.createFramebuffer=function(y,b,_){return new at(this,y,b,_)},ct.prototype.clear=function(y){var b=y.color,_=y.depth,C=this.gl,L=0;b&&(L|=C.COLOR_BUFFER_BIT,this.clearColor.set(b),this.colorMask.set([!0,!0,!0,!0])),_!==void 0&&(L|=C.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(_),this.depthMask.set(!0)),C.clear(L)},ct.prototype.setCullFace=function(y){y.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(y.mode),this.frontFace.set(y.frontFace))},ct.prototype.setDepthMode=function(y){y.func!==this.gl.ALWAYS||y.mask?(this.depthTest.set(!0),this.depthFunc.set(y.func),this.depthMask.set(y.mask),this.depthRange.set(y.range)):this.depthTest.set(!1)},ct.prototype.setStencilMode=function(y){y.test.func!==this.gl.ALWAYS||y.mask?(this.stencilTest.set(!0),this.stencilMask.set(y.mask),this.stencilOp.set([y.fail,y.depthFail,y.pass]),this.stencilFunc.set({func:y.test.func,ref:y.ref,mask:y.test.mask})):this.stencilTest.set(!1)},ct.prototype.setColorMode=function(y){o.deepEqual(y.blendFunction,Xt.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(y.blendFunction),this.blendColor.set(y.blendColor)),this.colorMask.set(y.mask)},ct.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Pt=function(y){function b(_,C,L){var D=this;y.call(this),this.id=_,this.dispatcher=L,this.on("data",function(F){F.dataType==="source"&&F.sourceDataType==="metadata"&&(D._sourceLoaded=!0),D._sourceLoaded&&!D._paused&&F.dataType==="source"&&F.sourceDataType==="content"&&(D.reload(),D.transform&&D.update(D.transform))}),this.on("error",function(){D._sourceErrored=!0}),this._source=function(F,$,j,et){var ut=new De[$.type](F,$,j,et);if(ut.id!==F)throw new Error("Expected Source id to be "+F+" instead of "+ut.id);return o.bindAll(["load","abort","unload","serialize","prepare"],ut),ut}(_,C,L,this),this._tiles={},this._cache=new ee(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new o.SourceFeatureState}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.onAdd=function(_){this.map=_,this._maxTileCacheSize=_?_._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(_)},b.prototype.onRemove=function(_){this._source&&this._source.onRemove&&this._source.onRemove(_)},b.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var _ in this._tiles){var C=this._tiles[_];if(C.state!=="loaded"&&C.state!=="errored")return!1}return!0},b.prototype.getSource=function(){return this._source},b.prototype.pause=function(){this._paused=!0},b.prototype.resume=function(){if(this._paused){var _=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,_&&this.reload(),this.transform&&this.update(this.transform)}},b.prototype._loadTile=function(_,C){return this._source.loadTile(_,C)},b.prototype._unloadTile=function(_){if(this._source.unloadTile)return this._source.unloadTile(_,function(){})},b.prototype._abortTile=function(_){if(this._source.abortTile)return this._source.abortTile(_,function(){})},b.prototype.serialize=function(){return this._source.serialize()},b.prototype.prepare=function(_){for(var C in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var L=this._tiles[C];L.upload(_),L.prepare(this.map.style.imageManager)}},b.prototype.getIds=function(){return o.values(this._tiles).map(function(_){return _.tileID}).sort(oe).map(function(_){return _.key})},b.prototype.getRenderableIds=function(_){var C=this,L=[];for(var D in this._tiles)this._isIdRenderable(D,_)&&L.push(this._tiles[D]);return _?L.sort(function(F,$){var j=F.tileID,et=$.tileID,ut=new o.Point(j.canonical.x,j.canonical.y)._rotate(C.transform.angle),ht=new o.Point(et.canonical.x,et.canonical.y)._rotate(C.transform.angle);return j.overscaledZ-et.overscaledZ||ht.y-ut.y||ht.x-ut.x}).map(function(F){return F.tileID.key}):L.map(function(F){return F.tileID}).sort(oe).map(function(F){return F.key})},b.prototype.hasRenderableParent=function(_){var C=this.findLoadedParent(_,0);return!!C&&this._isIdRenderable(C.tileID.key)},b.prototype._isIdRenderable=function(_,C){return this._tiles[_]&&this._tiles[_].hasData()&&!this._coveredTiles[_]&&(C||!this._tiles[_].holdingForFade())},b.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var _ in this._cache.reset(),this._tiles)this._tiles[_].state!=="errored"&&this._reloadTile(_,"reloading")},b.prototype._reloadTile=function(_,C){var L=this._tiles[_];L&&(L.state!=="loading"&&(L.state=C),this._loadTile(L,this._tileLoaded.bind(this,L,_,C)))},b.prototype._tileLoaded=function(_,C,L,D){if(D)return _.state="errored",void(D.status!==404?this._source.fire(new o.ErrorEvent(D,{tile:_})):this.update(this.transform));_.timeAdded=o.browser.now(),L==="expired"&&(_.refreshedUponExpiration=!0),this._setTileReloadTimer(C,_),this.getSource().type==="raster-dem"&&_.dem&&this._backfillDEM(_),this._state.initializeTileState(_,this.map?this.map.painter:null),this._source.fire(new o.Event("data",{dataType:"source",tile:_,coord:_.tileID}))},b.prototype._backfillDEM=function(_){for(var C=this.getRenderableIds(),L=0;L<C.length;L++){var D=C[L];if(_.neighboringTiles&&_.neighboringTiles[D]){var F=this.getTileByID(D);$(_,F),$(F,_)}}function $(j,et){j.needsHillshadePrepare=!0;var ut=et.tileID.canonical.x-j.tileID.canonical.x,ht=et.tileID.canonical.y-j.tileID.canonical.y,dt=Math.pow(2,j.tileID.canonical.z),Ot=et.tileID.key;ut===0&&ht===0||Math.abs(ht)>1||(Math.abs(ut)>1&&(Math.abs(ut+dt)===1?ut+=dt:Math.abs(ut-dt)===1&&(ut-=dt)),et.dem&&j.dem&&(j.dem.backfillBorder(et.dem,ut,ht),j.neighboringTiles&&j.neighboringTiles[Ot]&&(j.neighboringTiles[Ot].backfilled=!0)))}},b.prototype.getTile=function(_){return this.getTileByID(_.key)},b.prototype.getTileByID=function(_){return this._tiles[_]},b.prototype._retainLoadedChildren=function(_,C,L,D){for(var F in this._tiles){var $=this._tiles[F];if(!(D[F]||!$.hasData()||$.tileID.overscaledZ<=C||$.tileID.overscaledZ>L)){for(var j=$.tileID;$&&$.tileID.overscaledZ>C+1;){var et=$.tileID.scaledTo($.tileID.overscaledZ-1);($=this._tiles[et.key])&&$.hasData()&&(j=et)}for(var ut=j;ut.overscaledZ>C;)if(_[(ut=ut.scaledTo(ut.overscaledZ-1)).key]){D[j.key]=j;break}}}},b.prototype.findLoadedParent=function(_,C){if(_.key in this._loadedParentTiles){var L=this._loadedParentTiles[_.key];return L&&L.tileID.overscaledZ>=C?L:null}for(var D=_.overscaledZ-1;D>=C;D--){var F=_.scaledTo(D),$=this._getLoadedTile(F);if($)return $}},b.prototype._getLoadedTile=function(_){var C=this._tiles[_.key];return C&&C.hasData()?C:this._cache.getByKey(_.wrapped().key)},b.prototype.updateCacheSize=function(_){var C=Math.ceil(_.width/this._source.tileSize)+1,L=Math.ceil(_.height/this._source.tileSize)+1,D=Math.floor(C*L*5),F=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,D):D;this._cache.setMaxSize(F)},b.prototype.handleWrapJump=function(_){var C=Math.round((_-(this._prevLng===void 0?_:this._prevLng))/360);if(this._prevLng=_,C){var L={};for(var D in this._tiles){var F=this._tiles[D];F.tileID=F.tileID.unwrapTo(F.tileID.wrap+C),L[F.tileID.key]=F}for(var $ in this._tiles=L,this._timers)clearTimeout(this._timers[$]),delete this._timers[$];for(var j in this._tiles)this._setTileReloadTimer(j,this._tiles[j])}},b.prototype.update=function(_){var C=this;if(this.transform=_,this._sourceLoaded&&!this._paused){var L;this.updateCacheSize(_),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?L=_.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Ve){return new o.OverscaledTileID(Ve.canonical.z,Ve.wrap,Ve.canonical.z,Ve.canonical.x,Ve.canonical.y)}):(L=_.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(L=L.filter(function(Ve){return C._source.hasTile(Ve)}))):L=[];var D=_.coveringZoomLevel(this._source),F=Math.max(D-b.maxOverzooming,this._source.minzoom),$=Math.max(D+b.maxUnderzooming,this._source.minzoom),j=this._updateRetainedTiles(L,D);if(Le(this._source.type)){for(var et={},ut={},ht=0,dt=Object.keys(j);ht<dt.length;ht+=1){var Ot=dt[ht],At=j[Ot],$t=this._tiles[Ot];if($t&&!($t.fadeEndTime&&$t.fadeEndTime<=o.browser.now())){var Ct=this.findLoadedParent(At,F);Ct&&(this._addTile(Ct.tileID),et[Ct.tileID.key]=Ct.tileID),ut[Ot]=At}}for(var zt in this._retainLoadedChildren(ut,D,$,j),et)j[zt]||(this._coveredTiles[zt]=!0,j[zt]=et[zt])}for(var qt in j)this._tiles[qt].clearFadeHold();for(var se=0,Ee=o.keysDifference(this._tiles,j);se<Ee.length;se+=1){var pe=Ee[se],Ae=this._tiles[pe];Ae.hasSymbolBuckets&&!Ae.holdingForFade()?Ae.setHoldDuration(this.map._fadeDuration):Ae.hasSymbolBuckets&&!Ae.symbolFadeFinished()||this._removeTile(pe)}this._updateLoadedParentTileCache()}},b.prototype.releaseSymbolFadeTiles=function(){for(var _ in this._tiles)this._tiles[_].holdingForFade()&&this._removeTile(_)},b.prototype._updateRetainedTiles=function(_,C){for(var L={},D={},F=Math.max(C-b.maxOverzooming,this._source.minzoom),$=Math.max(C+b.maxUnderzooming,this._source.minzoom),j={},et=0,ut=_;et<ut.length;et+=1){var ht=ut[et],dt=this._addTile(ht);L[ht.key]=ht,dt.hasData()||C<this._source.maxzoom&&(j[ht.key]=ht)}this._retainLoadedChildren(j,C,$,L);for(var Ot=0,At=_;Ot<At.length;Ot+=1){var $t=At[Ot],Ct=this._tiles[$t.key];if(!Ct.hasData()){if(C+1>this._source.maxzoom){var zt=$t.children(this._source.maxzoom)[0],qt=this.getTile(zt);if(qt&&qt.hasData()){L[zt.key]=zt;continue}}else{var se=$t.children(this._source.maxzoom);if(L[se[0].key]&&L[se[1].key]&&L[se[2].key]&&L[se[3].key])continue}for(var Ee=Ct.wasRequested(),pe=$t.overscaledZ-1;pe>=F;--pe){var Ae=$t.scaledTo(pe);if(D[Ae.key]||(D[Ae.key]=!0,!(Ct=this.getTile(Ae))&&Ee&&(Ct=this._addTile(Ae)),Ct&&(L[Ae.key]=Ae,Ee=Ct.wasRequested(),Ct.hasData())))break}}}return L},b.prototype._updateLoadedParentTileCache=function(){for(var _ in this._loadedParentTiles={},this._tiles){for(var C=[],L=void 0,D=this._tiles[_].tileID;D.overscaledZ>0;){if(D.key in this._loadedParentTiles){L=this._loadedParentTiles[D.key];break}C.push(D.key);var F=D.scaledTo(D.overscaledZ-1);if(L=this._getLoadedTile(F))break;D=F}for(var $=0,j=C;$<j.length;$+=1)this._loadedParentTiles[j[$]]=L}},b.prototype._addTile=function(_){var C=this._tiles[_.key];if(C)return C;(C=this._cache.getAndRemove(_))&&(this._setTileReloadTimer(_.key,C),C.tileID=_,this._state.initializeTileState(C,this.map?this.map.painter:null),this._cacheTimers[_.key]&&(clearTimeout(this._cacheTimers[_.key]),delete this._cacheTimers[_.key],this._setTileReloadTimer(_.key,C)));var L=!!C;return L||(C=new o.Tile(_,this._source.tileSize*_.overscaleFactor()),this._loadTile(C,this._tileLoaded.bind(this,C,_.key,C.state))),C?(C.uses++,this._tiles[_.key]=C,L||this._source.fire(new o.Event("dataloading",{tile:C,coord:C.tileID,dataType:"source"})),C):null},b.prototype._setTileReloadTimer=function(_,C){var L=this;_ in this._timers&&(clearTimeout(this._timers[_]),delete this._timers[_]);var D=C.getExpiryTimeout();D&&(this._timers[_]=setTimeout(function(){L._reloadTile(_,"expired"),delete L._timers[_]},D))},b.prototype._removeTile=function(_){var C=this._tiles[_];C&&(C.uses--,delete this._tiles[_],this._timers[_]&&(clearTimeout(this._timers[_]),delete this._timers[_]),C.uses>0||(C.hasData()&&C.state!=="reloading"?this._cache.add(C.tileID,C,C.getExpiryTimeout()):(C.aborted=!0,this._abortTile(C),this._unloadTile(C))))},b.prototype.clearTiles=function(){for(var _ in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(_);this._cache.reset()},b.prototype.tilesIn=function(_,C,L){var D=this,F=[],$=this.transform;if(!$)return F;for(var j=L?$.getCameraQueryGeometry(_):_,et=_.map(function(pe){return $.pointCoordinate(pe)}),ut=j.map(function(pe){return $.pointCoordinate(pe)}),ht=this.getIds(),dt=1/0,Ot=1/0,At=-1/0,$t=-1/0,Ct=0,zt=ut;Ct<zt.length;Ct+=1){var qt=zt[Ct];dt=Math.min(dt,qt.x),Ot=Math.min(Ot,qt.y),At=Math.max(At,qt.x),$t=Math.max($t,qt.y)}for(var se=function(pe){var Ae=D._tiles[ht[pe]];if(!Ae.holdingForFade()){var Ve=Ae.tileID,cr=Math.pow(2,$.zoom-Ae.tileID.overscaledZ),ar=C*Ae.queryPadding*o.EXTENT/Ae.tileSize/cr,Mr=[Ve.getTilePoint(new o.MercatorCoordinate(dt,Ot)),Ve.getTilePoint(new o.MercatorCoordinate(At,$t))];if(Mr[0].x-ar<o.EXTENT&&Mr[0].y-ar<o.EXTENT&&Mr[1].x+ar>=0&&Mr[1].y+ar>=0){var sn=et.map(function(cn){return Ve.getTilePoint(cn)}),hn=ut.map(function(cn){return Ve.getTilePoint(cn)});F.push({tile:Ae,tileID:Ve,queryGeometry:sn,cameraQueryGeometry:hn,scale:cr})}}},Ee=0;Ee<ht.length;Ee++)se(Ee);return F},b.prototype.getVisibleCoordinates=function(_){for(var C=this,L=this.getRenderableIds(_).map(function(j){return C._tiles[j].tileID}),D=0,F=L;D<F.length;D+=1){var $=F[D];$.posMatrix=this.transform.calculatePosMatrix($.toUnwrapped())}return L},b.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Le(this._source.type))for(var _ in this._tiles){var C=this._tiles[_];if(C.fadeEndTime!==void 0&&C.fadeEndTime>=o.browser.now())return!0}return!1},b.prototype.setFeatureState=function(_,C,L){this._state.updateState(_=_||"_geojsonTileLayer",C,L)},b.prototype.removeFeatureState=function(_,C,L){this._state.removeFeatureState(_=_||"_geojsonTileLayer",C,L)},b.prototype.getFeatureState=function(_,C){return this._state.getState(_=_||"_geojsonTileLayer",C)},b.prototype.setDependencies=function(_,C,L){var D=this._tiles[_];D&&D.setDependencies(C,L)},b.prototype.reloadTilesForDependencies=function(_,C){for(var L in this._tiles)this._tiles[L].hasDependency(_,C)&&this._reloadTile(L,"reloading");this._cache.filter(function(D){return!D.hasDependency(_,C)})},b}(o.Evented);function oe(y,b){var _=Math.abs(2*y.wrap)-+(y.wrap<0),C=Math.abs(2*b.wrap)-+(b.wrap<0);return y.overscaledZ-b.overscaledZ||C-_||b.canonical.y-y.canonical.y||b.canonical.x-y.canonical.x}function Le(y){return y==="raster"||y==="image"||y==="video"}function tr(){return new o.window.Worker(Xg.workerUrl)}Pt.maxOverzooming=10,Pt.maxUnderzooming=3;var Te="mapboxgl_preloaded_worker_pool",Ze=function(){this.active={}};Ze.prototype.acquire=function(y){if(!this.workers)for(this.workers=[];this.workers.length<Ze.workerCount;)this.workers.push(new tr);return this.active[y]=!0,this.workers.slice()},Ze.prototype.release=function(y){delete this.active[y],this.numActive()===0&&(this.workers.forEach(function(b){b.terminate()}),this.workers=null)},Ze.prototype.isPreloaded=function(){return!!this.active[Te]},Ze.prototype.numActive=function(){return Object.keys(this.active).length};var jr,Ur=Math.floor(o.browser.hardwareConcurrency/2);function Re(){return jr||(jr=new Ze),jr}function Ar(y,b){var _={};for(var C in y)C!=="ref"&&(_[C]=y[C]);return o.refProperties.forEach(function(L){L in b&&(_[L]=b[L])}),_}function dr(y){y=y.slice();for(var b=Object.create(null),_=0;_<y.length;_++)b[y[_].id]=y[_];for(var C=0;C<y.length;C++)"ref"in y[C]&&(y[C]=Ar(y[C],b[y[C].ref]));return y}Ze.workerCount=Math.max(Math.min(Ur,6),1);var gr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function kn(y,b,_){_.push({command:gr.addSource,args:[y,b[y]]})}function wr(y,b,_){b.push({command:gr.removeSource,args:[y]}),_[y]=!0}function ci(y,b,_,C){wr(y,_,C),kn(y,b,_)}function ea(y,b,_){var C;for(C in y[_])if(y[_].hasOwnProperty(C)&&C!=="data"&&!o.deepEqual(y[_][C],b[_][C]))return!1;for(C in b[_])if(b[_].hasOwnProperty(C)&&C!=="data"&&!o.deepEqual(y[_][C],b[_][C]))return!1;return!0}function ai(y,b,_,C,L,D){var F;for(F in b=b||{},y=y||{})y.hasOwnProperty(F)&&(o.deepEqual(y[F],b[F])||_.push({command:D,args:[C,F,b[F],L]}));for(F in b)b.hasOwnProperty(F)&&!y.hasOwnProperty(F)&&(o.deepEqual(y[F],b[F])||_.push({command:D,args:[C,F,b[F],L]}))}function wi(y){return y.id}function zn(y,b){return y[b.id]=b,y}var po=function(y,b){this.reset(y,b)};po.prototype.reset=function(y,b){this.points=y||[],this._distances=[0];for(var _=1;_<this.points.length;_++)this._distances[_]=this._distances[_-1]+this.points[_].dist(this.points[_-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(b||0,.5*this.length),this.paddedLength=this.length-2*this.padding},po.prototype.lerp=function(y){if(this.points.length===1)return this.points[0];y=o.clamp(y,0,1);for(var b=1,_=this._distances[b],C=y*this.paddedLength+this.padding;_<C&&b<this._distances.length;)_=this._distances[++b];var L=b-1,D=this._distances[L],F=_-D,$=F>0?(C-D)/F:0;return this.points[L].mult(1-$).add(this.points[b].mult($))};var pi=function(y,b,_){var C=this.boxCells=[],L=this.circleCells=[];this.xCellCount=Math.ceil(y/_),this.yCellCount=Math.ceil(b/_);for(var D=0;D<this.xCellCount*this.yCellCount;D++)C.push([]),L.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=y,this.height=b,this.xScale=this.xCellCount/y,this.yScale=this.yCellCount/b,this.boxUid=0,this.circleUid=0};function ra(y,b,_,C,L){var D=o.create();return b?(o.scale(D,D,[1/L,1/L,1]),_||o.rotateZ(D,D,C.angle)):o.multiply(D,C.labelPlaneMatrix,y),D}function Di(y,b,_,C,L){if(b){var D=o.clone(y);return o.scale(D,D,[L,L,1]),_||o.rotateZ(D,D,-C.angle),D}return C.glCoordMatrix}function Un(y,b){var _=[y.x,y.y,0,1];Ra(_,_,b);var C=_[3];return{point:new o.Point(_[0]/C,_[1]/C),signedDistanceFromCamera:C}}function oi(y,b){return .5+y/b*.5}function Es(y,b){var _=y[0]/y[3],C=y[1]/y[3];return _>=-b[0]&&_<=b[0]&&C>=-b[1]&&C<=b[1]}function qh(y,b,_,C,L,D,F,$){var j=C?y.textSizeData:y.iconSizeData,et=o.evaluateSizeForZoom(j,_.transform.zoom),ut=[256/_.width*2+1,256/_.height*2+1],ht=C?y.text.dynamicLayoutVertexArray:y.icon.dynamicLayoutVertexArray;ht.clear();for(var dt=y.lineVertexArray,Ot=C?y.text.placedSymbolArray:y.icon.placedSymbolArray,At=_.transform.width/_.transform.height,$t=!1,Ct=0;Ct<Ot.length;Ct++){var zt=Ot.get(Ct);if(zt.hidden||zt.writingMode===o.WritingMode.vertical&&!$t)Ho(zt.numGlyphs,ht);else{$t=!1;var qt=[zt.anchorX,zt.anchorY,0,1];if(o.transformMat4(qt,qt,b),Es(qt,ut)){var se=oi(_.transform.cameraToCenterDistance,qt[3]),Ee=o.evaluateSizeForFeature(j,et,zt),pe=F?Ee/se:Ee*se,Ae=new o.Point(zt.anchorX,zt.anchorY),Ve=Un(Ae,L).point,cr={},ar=Kh(zt,pe,!1,$,b,L,D,y.glyphOffsetArray,dt,ht,Ve,Ae,cr,At);$t=ar.useVertical,(ar.notEnoughRoom||$t||ar.needsFlipping&&Kh(zt,pe,!0,$,b,L,D,y.glyphOffsetArray,dt,ht,Ve,Ae,cr,At).notEnoughRoom)&&Ho(zt.numGlyphs,ht)}else Ho(zt.numGlyphs,ht)}}C?y.text.dynamicLayoutVertexBuffer.updateData(ht):y.icon.dynamicLayoutVertexBuffer.updateData(ht)}function eo(y,b,_,C,L,D,F,$,j,et,ut){var ht=$.glyphStartIndex+$.numGlyphs,dt=$.lineStartIndex,Ot=$.lineStartIndex+$.lineLength,At=b.getoffsetX($.glyphStartIndex),$t=b.getoffsetX(ht-1),Ct=Ma(y*At,_,C,L,D,F,$.segment,dt,Ot,j,et,ut);if(!Ct)return null;var zt=Ma(y*$t,_,C,L,D,F,$.segment,dt,Ot,j,et,ut);return zt?{first:Ct,last:zt}:null}function Da(y,b,_,C){return y===o.WritingMode.horizontal&&Math.abs(_.y-b.y)>Math.abs(_.x-b.x)*C?{useVertical:!0}:(y===o.WritingMode.vertical?b.y<_.y:b.x>_.x)?{needsFlipping:!0}:null}function Kh(y,b,_,C,L,D,F,$,j,et,ut,ht,dt,Ot){var At,$t=b/24,Ct=y.lineOffsetX*$t,zt=y.lineOffsetY*$t;if(y.numGlyphs>1){var qt=y.glyphStartIndex+y.numGlyphs,se=y.lineStartIndex,Ee=y.lineStartIndex+y.lineLength,pe=eo($t,$,Ct,zt,_,ut,ht,y,j,D,dt);if(!pe)return{notEnoughRoom:!0};var Ae=Un(pe.first.point,F).point,Ve=Un(pe.last.point,F).point;if(C&&!_){var cr=Da(y.writingMode,Ae,Ve,Ot);if(cr)return cr}At=[pe.first];for(var ar=y.glyphStartIndex+1;ar<qt-1;ar++)At.push(Ma($t*$.getoffsetX(ar),Ct,zt,_,ut,ht,y.segment,se,Ee,j,D,dt));At.push(pe.last)}else{if(C&&!_){var Mr=Un(ht,L).point,sn=y.lineStartIndex+y.segment+1,hn=new o.Point(j.getx(sn),j.gety(sn)),cn=Un(hn,L),Ii=cn.signedDistanceFromCamera>0?cn.point:mu(ht,hn,Mr,1,L),kr=Da(y.writingMode,Mr,Ii,Ot);if(kr)return kr}var Ln=Ma($t*$.getoffsetX(y.glyphStartIndex),Ct,zt,_,ut,ht,y.segment,y.lineStartIndex,y.lineStartIndex+y.lineLength,j,D,dt);if(!Ln)return{notEnoughRoom:!0};At=[Ln]}for(var Xn=0,Rn=At;Xn<Rn.length;Xn+=1){var Cn=Rn[Xn];o.addDynamicAttributes(et,Cn.point,Cn.angle)}return{}}function mu(y,b,_,C,L){var D=Un(y.add(y.sub(b)._unit()),L).point,F=_.sub(D);return _.add(F._mult(C/F.mag()))}function Ma(y,b,_,C,L,D,F,$,j,et,ut,ht){var dt=C?y-b:y+b,Ot=dt>0?1:-1,At=0;C&&(Ot*=-1,At=Math.PI),Ot<0&&(At+=Math.PI);for(var $t=Ot>0?$+F:$+F+1,Ct=L,zt=L,qt=0,se=0,Ee=Math.abs(dt),pe=[];qt+se<=Ee;){if(($t+=Ot)<$||$t>=j)return null;if(zt=Ct,pe.push(Ct),(Ct=ht[$t])===void 0){var Ae=new o.Point(et.getx($t),et.gety($t)),Ve=Un(Ae,ut);if(Ve.signedDistanceFromCamera>0)Ct=ht[$t]=Ve.point;else{var cr=$t-Ot;Ct=mu(qt===0?D:new o.Point(et.getx(cr),et.gety(cr)),Ae,zt,Ee-qt+1,ut)}}qt+=se,se=zt.dist(Ct)}var ar=(Ee-qt)/se,Mr=Ct.sub(zt),sn=Mr.mult(ar)._add(zt);sn._add(Mr._unit()._perp()._mult(_*Ot));var hn=At+Math.atan2(Ct.y-zt.y,Ct.x-zt.x);return pe.push(sn),{point:sn,angle:hn,path:pe}}pi.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},pi.prototype.insert=function(y,b,_,C,L){this._forEachCell(b,_,C,L,this._insertBoxCell,this.boxUid++),this.boxKeys.push(y),this.bboxes.push(b),this.bboxes.push(_),this.bboxes.push(C),this.bboxes.push(L)},pi.prototype.insertCircle=function(y,b,_,C){this._forEachCell(b-C,_-C,b+C,_+C,this._insertCircleCell,this.circleUid++),this.circleKeys.push(y),this.circles.push(b),this.circles.push(_),this.circles.push(C)},pi.prototype._insertBoxCell=function(y,b,_,C,L,D){this.boxCells[L].push(D)},pi.prototype._insertCircleCell=function(y,b,_,C,L,D){this.circleCells[L].push(D)},pi.prototype._query=function(y,b,_,C,L,D){if(_<0||y>this.width||C<0||b>this.height)return!L&&[];var F=[];if(y<=0&&b<=0&&this.width<=_&&this.height<=C){if(L)return!0;for(var $=0;$<this.boxKeys.length;$++)F.push({key:this.boxKeys[$],x1:this.bboxes[4*$],y1:this.bboxes[4*$+1],x2:this.bboxes[4*$+2],y2:this.bboxes[4*$+3]});for(var j=0;j<this.circleKeys.length;j++){var et=this.circles[3*j],ut=this.circles[3*j+1],ht=this.circles[3*j+2];F.push({key:this.circleKeys[j],x1:et-ht,y1:ut-ht,x2:et+ht,y2:ut+ht})}return D?F.filter(D):F}return this._forEachCell(y,b,_,C,this._queryCell,F,{hitTest:L,seenUids:{box:{},circle:{}}},D),L?F.length>0:F},pi.prototype._queryCircle=function(y,b,_,C,L){var D=y-_,F=y+_,$=b-_,j=b+_;if(F<0||D>this.width||j<0||$>this.height)return!C&&[];var et=[];return this._forEachCell(D,$,F,j,this._queryCellCircle,et,{hitTest:C,circle:{x:y,y:b,radius:_},seenUids:{box:{},circle:{}}},L),C?et.length>0:et},pi.prototype.query=function(y,b,_,C,L){return this._query(y,b,_,C,!1,L)},pi.prototype.hitTest=function(y,b,_,C,L){return this._query(y,b,_,C,!0,L)},pi.prototype.hitTestCircle=function(y,b,_,C){return this._queryCircle(y,b,_,!0,C)},pi.prototype._queryCell=function(y,b,_,C,L,D,F,$){var j=F.seenUids,et=this.boxCells[L];if(et!==null)for(var ut=this.bboxes,ht=0,dt=et;ht<dt.length;ht+=1){var Ot=dt[ht];if(!j.box[Ot]){j.box[Ot]=!0;var At=4*Ot;if(y<=ut[At+2]&&b<=ut[At+3]&&_>=ut[At+0]&&C>=ut[At+1]&&(!$||$(this.boxKeys[Ot]))){if(F.hitTest)return D.push(!0),!0;D.push({key:this.boxKeys[Ot],x1:ut[At],y1:ut[At+1],x2:ut[At+2],y2:ut[At+3]})}}}var $t=this.circleCells[L];if($t!==null)for(var Ct=this.circles,zt=0,qt=$t;zt<qt.length;zt+=1){var se=qt[zt];if(!j.circle[se]){j.circle[se]=!0;var Ee=3*se;if(this._circleAndRectCollide(Ct[Ee],Ct[Ee+1],Ct[Ee+2],y,b,_,C)&&(!$||$(this.circleKeys[se]))){if(F.hitTest)return D.push(!0),!0;var pe=Ct[Ee],Ae=Ct[Ee+1],Ve=Ct[Ee+2];D.push({key:this.circleKeys[se],x1:pe-Ve,y1:Ae-Ve,x2:pe+Ve,y2:Ae+Ve})}}}},pi.prototype._queryCellCircle=function(y,b,_,C,L,D,F,$){var j=F.circle,et=F.seenUids,ut=this.boxCells[L];if(ut!==null)for(var ht=this.bboxes,dt=0,Ot=ut;dt<Ot.length;dt+=1){var At=Ot[dt];if(!et.box[At]){et.box[At]=!0;var $t=4*At;if(this._circleAndRectCollide(j.x,j.y,j.radius,ht[$t+0],ht[$t+1],ht[$t+2],ht[$t+3])&&(!$||$(this.boxKeys[At])))return D.push(!0),!0}}var Ct=this.circleCells[L];if(Ct!==null)for(var zt=this.circles,qt=0,se=Ct;qt<se.length;qt+=1){var Ee=se[qt];if(!et.circle[Ee]){et.circle[Ee]=!0;var pe=3*Ee;if(this._circlesCollide(zt[pe],zt[pe+1],zt[pe+2],j.x,j.y,j.radius)&&(!$||$(this.circleKeys[Ee])))return D.push(!0),!0}}},pi.prototype._forEachCell=function(y,b,_,C,L,D,F,$){for(var j=this._convertToXCellCoord(y),et=this._convertToYCellCoord(b),ut=this._convertToXCellCoord(_),ht=this._convertToYCellCoord(C),dt=j;dt<=ut;dt++)for(var Ot=et;Ot<=ht;Ot++)if(L.call(this,y,b,_,C,this.xCellCount*Ot+dt,D,F,$))return},pi.prototype._convertToXCellCoord=function(y){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(y*this.xScale)))},pi.prototype._convertToYCellCoord=function(y){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(y*this.yScale)))},pi.prototype._circlesCollide=function(y,b,_,C,L,D){var F=C-y,$=L-b,j=_+D;return j*j>F*F+$*$},pi.prototype._circleAndRectCollide=function(y,b,_,C,L,D,F){var $=(D-C)/2,j=Math.abs(y-(C+$));if(j>$+_)return!1;var et=(F-L)/2,ut=Math.abs(b-(L+et));if(ut>et+_)return!1;if(j<=$||ut<=et)return!0;var ht=j-$,dt=ut-et;return ht*ht+dt*dt<=_*_};var uh=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Ho(y,b){for(var _=0;_<y;_++){var C=b.length;b.resize(C+4),b.float32.set(uh,3*C)}}function Ra(y,b,_){var C=b[0],L=b[1];return y[0]=_[0]*C+_[4]*L+_[12],y[1]=_[1]*C+_[5]*L+_[13],y[3]=_[3]*C+_[7]*L+_[15],y}var ro=function(y,b,_){b===void 0&&(b=new pi(y.width+200,y.height+200,25)),_===void 0&&(_=new pi(y.width+200,y.height+200,25)),this.transform=y,this.grid=b,this.ignoredGrid=_,this.pitchfactor=Math.cos(y._pitch)*y.cameraToCenterDistance,this.screenRightBoundary=y.width+100,this.screenBottomBoundary=y.height+100,this.gridRightBoundary=y.width+200,this.gridBottomBoundary=y.height+200};function ga(y,b,_){return b*(o.EXTENT/(y.tileSize*Math.pow(2,_-y.tileID.overscaledZ)))}ro.prototype.placeCollisionBox=function(y,b,_,C,L){var D=this.projectAndGetPerspectiveRatio(C,y.anchorPointX,y.anchorPointY),F=_*D.perspectiveRatio,$=y.x1*F+D.point.x,j=y.y1*F+D.point.y,et=y.x2*F+D.point.x,ut=y.y2*F+D.point.y;return!this.isInsideGrid($,j,et,ut)||!b&&this.grid.hitTest($,j,et,ut,L)?{box:[],offscreen:!1}:{box:[$,j,et,ut],offscreen:this.isOffscreen($,j,et,ut)}},ro.prototype.placeCollisionCircles=function(y,b,_,C,L,D,F,$,j,et,ut,ht,dt){var Ot=[],At=new o.Point(b.anchorX,b.anchorY),$t=Un(At,D),Ct=oi(this.transform.cameraToCenterDistance,$t.signedDistanceFromCamera),zt=(et?L/Ct:L*Ct)/o.ONE_EM,qt=Un(At,F).point,se=eo(zt,C,b.lineOffsetX*zt,b.lineOffsetY*zt,!1,qt,At,b,_,F,{}),Ee=!1,pe=!1,Ae=!0;if(se){for(var Ve=.5*ht*Ct+dt,cr=new o.Point(-100,-100),ar=new o.Point(this.screenRightBoundary,this.screenBottomBoundary),Mr=new po,sn=se.first,hn=se.last,cn=[],Ii=sn.path.length-1;Ii>=1;Ii--)cn.push(sn.path[Ii]);for(var kr=1;kr<hn.path.length;kr++)cn.push(hn.path[kr]);var Ln=2.5*Ve;if($){var Xn=cn.map(function(Ll){return Un(Ll,$)});cn=Xn.some(function(Ll){return Ll.signedDistanceFromCamera<=0})?[]:Xn.map(function(Ll){return Ll.point})}var Rn=[];if(cn.length>0){for(var Cn=cn[0].clone(),$n=cn[0].clone(),Sn=1;Sn<cn.length;Sn++)Cn.x=Math.min(Cn.x,cn[Sn].x),Cn.y=Math.min(Cn.y,cn[Sn].y),$n.x=Math.max($n.x,cn[Sn].x),$n.y=Math.max($n.y,cn[Sn].y);Rn=Cn.x>=cr.x&&$n.x<=ar.x&&Cn.y>=cr.y&&$n.y<=ar.y?[cn]:$n.x<cr.x||Cn.x>ar.x||$n.y<cr.y||Cn.y>ar.y?[]:o.clipLine([cn],cr.x,cr.y,ar.x,ar.y)}for(var bn=0,Mo=Rn;bn<Mo.length;bn+=1){var ja;Mr.reset(Mo[bn],.25*Ve),ja=Mr.length<=.5*Ve?1:Math.ceil(Mr.paddedLength/Ln)+1;for(var fs=0;fs<ja;fs++){var Xo=fs/Math.max(ja-1,1),Ga=Mr.lerp(Xo),Ya=Ga.x+100,Zs=Ga.y+100;Ot.push(Ya,Zs,Ve,0);var Ns=Ya-Ve,Cc=Zs-Ve,qs=Ya+Ve,Su=Zs+Ve;if(Ae=Ae&&this.isOffscreen(Ns,Cc,qs,Su),pe=pe||this.isInsideGrid(Ns,Cc,qs,Su),!y&&this.grid.hitTestCircle(Ya,Zs,Ve,ut)&&(Ee=!0,!j))return{circles:[],offscreen:!1,collisionDetected:Ee}}}}return{circles:!j&&Ee||!pe?[]:Ot,offscreen:Ae,collisionDetected:Ee}},ro.prototype.queryRenderedSymbols=function(y){if(y.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var b=[],_=1/0,C=1/0,L=-1/0,D=-1/0,F=0,$=y;F<$.length;F+=1){var j=$[F],et=new o.Point(j.x+100,j.y+100);_=Math.min(_,et.x),C=Math.min(C,et.y),L=Math.max(L,et.x),D=Math.max(D,et.y),b.push(et)}for(var ut={},ht={},dt=0,Ot=this.grid.query(_,C,L,D).concat(this.ignoredGrid.query(_,C,L,D));dt<Ot.length;dt+=1){var At=Ot[dt],$t=At.key;if(ut[$t.bucketInstanceId]===void 0&&(ut[$t.bucketInstanceId]={}),!ut[$t.bucketInstanceId][$t.featureIndex]){var Ct=[new o.Point(At.x1,At.y1),new o.Point(At.x2,At.y1),new o.Point(At.x2,At.y2),new o.Point(At.x1,At.y2)];o.polygonIntersectsPolygon(b,Ct)&&(ut[$t.bucketInstanceId][$t.featureIndex]=!0,ht[$t.bucketInstanceId]===void 0&&(ht[$t.bucketInstanceId]=[]),ht[$t.bucketInstanceId].push($t.featureIndex))}}return ht},ro.prototype.insertCollisionBox=function(y,b,_,C,L){(b?this.ignoredGrid:this.grid).insert({bucketInstanceId:_,featureIndex:C,collisionGroupID:L},y[0],y[1],y[2],y[3])},ro.prototype.insertCollisionCircles=function(y,b,_,C,L){for(var D=b?this.ignoredGrid:this.grid,F={bucketInstanceId:_,featureIndex:C,collisionGroupID:L},$=0;$<y.length;$+=4)D.insertCircle(F,y[$],y[$+1],y[$+2])},ro.prototype.projectAndGetPerspectiveRatio=function(y,b,_){var C=[b,_,0,1];return Ra(C,C,y),{point:new o.Point((C[0]/C[3]+1)/2*this.transform.width+100,(-C[1]/C[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/C[3]*.5}},ro.prototype.isOffscreen=function(y,b,_,C){return _<100||y>=this.screenRightBoundary||C<100||b>this.screenBottomBoundary},ro.prototype.isInsideGrid=function(y,b,_,C){return _>=0&&y<this.gridRightBoundary&&C>=0&&b<this.gridBottomBoundary},ro.prototype.getViewportMatrix=function(){var y=o.identity([]);return o.translate(y,y,[-100,-100,0]),y};var Xs=function(y,b,_,C){this.opacity=y?Math.max(0,Math.min(1,y.opacity+(y.placed?b:-b))):C&&_?1:0,this.placed=_};Xs.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var Ds=function(y,b,_,C,L){this.text=new Xs(y?y.text:null,b,_,L),this.icon=new Xs(y?y.icon:null,b,C,L)};Ds.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var uv=function(y,b,_){this.text=y,this.icon=b,this.skipFade=_},Sl=function(){this.invProjMatrix=o.create(),this.viewportMatrix=o.create(),this.circles=[]},C0=function(y,b,_,C,L){this.bucketInstanceId=y,this.featureIndex=b,this.sourceLayerIndex=_,this.bucketIndex=C,this.tileID=L},ot=function(y){this.crossSourceCollisions=y,this.maxGroupID=0,this.collisionGroups={}};function vt(y,b,_,C,L){var D=o.getAnchorAlignment(y),F=-(D.horizontalAlign-.5)*b,$=-(D.verticalAlign-.5)*_,j=o.evaluateVariableOffset(y,C);return new o.Point(F+j[0]*L,$+j[1]*L)}function Vt(y,b,_,C,L,D){var F=y.x1,$=y.x2,j=y.y1,et=y.y2,ut=y.anchorPointX,ht=y.anchorPointY,dt=new o.Point(b,_);return C&&dt._rotate(L?D:-D),{x1:F+dt.x,y1:j+dt.y,x2:$+dt.x,y2:et+dt.y,anchorPointX:ut,anchorPointY:ht}}ot.prototype.get=function(y){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[y]){var b=++this.maxGroupID;this.collisionGroups[y]={ID:b,predicate:function(_){return _.collisionGroupID===b}}}return this.collisionGroups[y]};var me=function(y,b,_,C){this.transform=y.clone(),this.collisionIndex=new ro(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=b,this.retainedQueryData={},this.collisionGroups=new ot(_),this.collisionCircleArrays={},this.prevPlacement=C,C&&(C.prevPlacement=void 0),this.placedOrientations={}};function ur(y,b,_,C,L){y.emplaceBack(b?1:0,_?1:0,C||0,L||0),y.emplaceBack(b?1:0,_?1:0,C||0,L||0),y.emplaceBack(b?1:0,_?1:0,C||0,L||0),y.emplaceBack(b?1:0,_?1:0,C||0,L||0)}me.prototype.getBucketParts=function(y,b,_,C){var L=_.getBucket(b),D=_.latestFeatureIndex;if(L&&D&&b.id===L.layerIds[0]){var F=_.collisionBoxArray,$=L.layers[0].layout,j=Math.pow(2,this.transform.zoom-_.tileID.overscaledZ),et=_.tileSize/o.EXTENT,ut=this.transform.calculatePosMatrix(_.tileID.toUnwrapped()),ht=$.get("text-pitch-alignment")==="map",dt=$.get("text-rotation-alignment")==="map",Ot=ga(_,1,this.transform.zoom),At=ra(ut,ht,dt,this.transform,Ot),$t=null;if(ht){var Ct=Di(ut,ht,dt,this.transform,Ot);$t=o.multiply([],this.transform.labelPlaneMatrix,Ct)}this.retainedQueryData[L.bucketInstanceId]=new C0(L.bucketInstanceId,D,L.sourceLayerIndex,L.index,_.tileID);var zt={bucket:L,layout:$,posMatrix:ut,textLabelPlaneMatrix:At,labelToScreenMatrix:$t,scale:j,textPixelRatio:et,holdingForFade:_.holdingForFade(),collisionBoxArray:F,partiallyEvaluatedTextSize:o.evaluateSizeForZoom(L.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(L.sourceID)};if(C)for(var qt=0,se=L.sortKeyRanges;qt<se.length;qt+=1){var Ee=se[qt];y.push({sortKey:Ee.sortKey,symbolInstanceStart:Ee.symbolInstanceStart,symbolInstanceEnd:Ee.symbolInstanceEnd,parameters:zt})}else y.push({symbolInstanceStart:0,symbolInstanceEnd:L.symbolInstances.length,parameters:zt})}},me.prototype.attemptAnchorPlacement=function(y,b,_,C,L,D,F,$,j,et,ut,ht,dt,Ot,At){var $t,Ct=[ht.textOffset0,ht.textOffset1],zt=vt(y,_,C,Ct,L),qt=this.collisionIndex.placeCollisionBox(Vt(b,zt.x,zt.y,D,F,this.transform.angle),ut,$,j,et.predicate);if(!At||this.collisionIndex.placeCollisionBox(Vt(At,zt.x,zt.y,D,F,this.transform.angle),ut,$,j,et.predicate).box.length!==0)return qt.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[ht.crossTileID]&&this.prevPlacement.placements[ht.crossTileID]&&this.prevPlacement.placements[ht.crossTileID].text&&($t=this.prevPlacement.variableOffsets[ht.crossTileID].anchor),this.variableOffsets[ht.crossTileID]={textOffset:Ct,width:_,height:C,anchor:y,textBoxScale:L,prevAnchor:$t},this.markUsedJustification(dt,y,ht,Ot),dt.allowVerticalPlacement&&(this.markUsedOrientation(dt,Ot,ht),this.placedOrientations[ht.crossTileID]=Ot),{shift:zt,placedGlyphBoxes:qt}):void 0},me.prototype.placeLayerBucketPart=function(y,b,_){var C=this,L=y.parameters,D=L.bucket,F=L.layout,$=L.posMatrix,j=L.textLabelPlaneMatrix,et=L.labelToScreenMatrix,ut=L.textPixelRatio,ht=L.holdingForFade,dt=L.collisionBoxArray,Ot=L.partiallyEvaluatedTextSize,At=L.collisionGroup,$t=F.get("text-optional"),Ct=F.get("icon-optional"),zt=F.get("text-allow-overlap"),qt=F.get("icon-allow-overlap"),se=F.get("text-rotation-alignment")==="map",Ee=F.get("text-pitch-alignment")==="map",pe=F.get("icon-text-fit")!=="none",Ae=F.get("symbol-z-order")==="viewport-y",Ve=zt&&(qt||!D.hasIconData()||Ct),cr=qt&&(zt||!D.hasTextData()||$t);!D.collisionArrays&&dt&&D.deserializeCollisionBoxes(dt);var ar=function(kr,Ln){if(!b[kr.crossTileID])if(ht)C.placements[kr.crossTileID]=new uv(!1,!1,!1);else{var Xn,Rn=!1,Cn=!1,$n=!0,Sn=null,bn={box:null,offscreen:null},Mo={box:null,offscreen:null},ja=null,fs=null,Xo=0,Ga=0,Ya=0;Ln.textFeatureIndex?Xo=Ln.textFeatureIndex:kr.useRuntimeCollisionCircles&&(Xo=kr.featureIndex),Ln.verticalTextFeatureIndex&&(Ga=Ln.verticalTextFeatureIndex);var Zs=Ln.textBox;if(Zs){var Ns=function(_i){var ds=o.WritingMode.horizontal;if(D.allowVerticalPlacement&&!_i&&C.prevPlacement){var Ro=C.prevPlacement.placedOrientations[kr.crossTileID];Ro&&(C.placedOrientations[kr.crossTileID]=Ro,C.markUsedOrientation(D,ds=Ro,kr))}return ds},Cc=function(_i,ds){if(D.allowVerticalPlacement&&kr.numVerticalGlyphVertices>0&&Ln.verticalTextBox)for(var Ro=0,Tc=D.writingModes;Ro<Tc.length&&(Tc[Ro]===o.WritingMode.vertical?(bn=ds(),Mo=bn):bn=_i(),!(bn&&bn.box&&bn.box.length));Ro+=1);else bn=_i()};if(F.get("text-variable-anchor")){var qs=F.get("text-variable-anchor");if(C.prevPlacement&&C.prevPlacement.variableOffsets[kr.crossTileID]){var Su=C.prevPlacement.variableOffsets[kr.crossTileID];qs.indexOf(Su.anchor)>0&&(qs=qs.filter(function(_i){return _i!==Su.anchor})).unshift(Su.anchor)}var Ll=function(_i,ds,Ro){for(var Tc=_i.x2-_i.x1,jg=_i.y2-_i.y1,_f=kr.textBoxScale,X0=pe&&!qt?ds:null,vd={box:[],offscreen:!1},gd=zt?2*qs.length:qs.length,qu=0;qu<gd;++qu){var Yg=C.attemptAnchorPlacement(qs[qu%qs.length],_i,Tc,jg,_f,se,Ee,ut,$,At,qu>=qs.length,kr,D,Ro,X0);if(Yg&&(vd=Yg.placedGlyphBoxes)&&vd.box&&vd.box.length){Rn=!0,Sn=Yg.shift;break}}return vd};Cc(function(){return Ll(Zs,Ln.iconBox,o.WritingMode.horizontal)},function(){var _i=Ln.verticalTextBox;return D.allowVerticalPlacement&&!(bn&&bn.box&&bn.box.length)&&kr.numVerticalGlyphVertices>0&&_i?Ll(_i,Ln.verticalIconBox,o.WritingMode.vertical):{box:null,offscreen:null}}),bn&&(Rn=bn.box,$n=bn.offscreen);var hp=Ns(bn&&bn.box);if(!Rn&&C.prevPlacement){var pd=C.prevPlacement.variableOffsets[kr.crossTileID];pd&&(C.variableOffsets[kr.crossTileID]=pd,C.markUsedJustification(D,pd.anchor,kr,hp))}}else{var Sc=function(_i,ds){var Ro=C.collisionIndex.placeCollisionBox(_i,zt,ut,$,At.predicate);return Ro&&Ro.box&&Ro.box.length&&(C.markUsedOrientation(D,ds,kr),C.placedOrientations[kr.crossTileID]=ds),Ro};Cc(function(){return Sc(Zs,o.WritingMode.horizontal)},function(){var _i=Ln.verticalTextBox;return D.allowVerticalPlacement&&kr.numVerticalGlyphVertices>0&&_i?Sc(_i,o.WritingMode.vertical):{box:null,offscreen:null}}),Ns(bn&&bn.box&&bn.box.length)}}if(Rn=(Xn=bn)&&Xn.box&&Xn.box.length>0,$n=Xn&&Xn.offscreen,kr.useRuntimeCollisionCircles){var mf=D.text.placedSymbolArray.get(kr.centerJustifiedTextSymbolIndex),bh=o.evaluateSizeForFeature(D.textSizeData,Ot,mf),Yu=F.get("text-padding");ja=C.collisionIndex.placeCollisionCircles(zt,mf,D.lineVertexArray,D.glyphOffsetArray,bh,$,j,et,_,Ee,At.predicate,kr.collisionCircleDiameter,Yu),Rn=zt||ja.circles.length>0&&!ja.collisionDetected,$n=$n&&ja.offscreen}if(Ln.iconFeatureIndex&&(Ya=Ln.iconFeatureIndex),Ln.iconBox){var yf=function(_i){var ds=pe&&Sn?Vt(_i,Sn.x,Sn.y,se,Ee,C.transform.angle):_i;return C.collisionIndex.placeCollisionBox(ds,qt,ut,$,At.predicate)};Cn=Mo&&Mo.box&&Mo.box.length&&Ln.verticalIconBox?(fs=yf(Ln.verticalIconBox)).box.length>0:(fs=yf(Ln.iconBox)).box.length>0,$n=$n&&fs.offscreen}var Ss=$t||kr.numHorizontalGlyphVertices===0&&kr.numVerticalGlyphVertices===0,ao=Ct||kr.numIconVertices===0;if(Ss||ao?ao?Ss||(Cn=Cn&&Rn):Rn=Cn&&Rn:Cn=Rn=Cn&&Rn,Rn&&Xn&&Xn.box&&C.collisionIndex.insertCollisionBox(Xn.box,F.get("text-ignore-placement"),D.bucketInstanceId,Mo&&Mo.box&&Ga?Ga:Xo,At.ID),Cn&&fs&&C.collisionIndex.insertCollisionBox(fs.box,F.get("icon-ignore-placement"),D.bucketInstanceId,Ya,At.ID),ja&&(Rn&&C.collisionIndex.insertCollisionCircles(ja.circles,F.get("text-ignore-placement"),D.bucketInstanceId,Xo,At.ID),_)){var sl=D.bucketInstanceId,Tu=C.collisionCircleArrays[sl];Tu===void 0&&(Tu=C.collisionCircleArrays[sl]=new Sl);for(var Zu=0;Zu<ja.circles.length;Zu+=4)Tu.circles.push(ja.circles[Zu+0]),Tu.circles.push(ja.circles[Zu+1]),Tu.circles.push(ja.circles[Zu+2]),Tu.circles.push(ja.collisionDetected?1:0)}C.placements[kr.crossTileID]=new uv(Rn||Ve,Cn||cr,$n||D.justReloaded),b[kr.crossTileID]=!0}};if(Ae)for(var Mr=D.getSortedSymbolIndexes(this.transform.angle),sn=Mr.length-1;sn>=0;--sn){var hn=Mr[sn];ar(D.symbolInstances.get(hn),D.collisionArrays[hn])}else for(var cn=y.symbolInstanceStart;cn<y.symbolInstanceEnd;cn++)ar(D.symbolInstances.get(cn),D.collisionArrays[cn]);if(_&&D.bucketInstanceId in this.collisionCircleArrays){var Ii=this.collisionCircleArrays[D.bucketInstanceId];o.invert(Ii.invProjMatrix,$),Ii.viewportMatrix=this.collisionIndex.getViewportMatrix()}D.justReloaded=!1},me.prototype.markUsedJustification=function(y,b,_,C){var L;L=C===o.WritingMode.vertical?_.verticalPlacedTextSymbolIndex:{left:_.leftJustifiedTextSymbolIndex,center:_.centerJustifiedTextSymbolIndex,right:_.rightJustifiedTextSymbolIndex}[o.getAnchorJustification(b)];for(var D=0,F=[_.leftJustifiedTextSymbolIndex,_.centerJustifiedTextSymbolIndex,_.rightJustifiedTextSymbolIndex,_.verticalPlacedTextSymbolIndex];D<F.length;D+=1){var $=F[D];$>=0&&(y.text.placedSymbolArray.get($).crossTileID=L>=0&&$!==L?0:_.crossTileID)}},me.prototype.markUsedOrientation=function(y,b,_){for(var C=b===o.WritingMode.horizontal||b===o.WritingMode.horizontalOnly?b:0,L=b===o.WritingMode.vertical?b:0,D=0,F=[_.leftJustifiedTextSymbolIndex,_.centerJustifiedTextSymbolIndex,_.rightJustifiedTextSymbolIndex];D<F.length;D+=1)y.text.placedSymbolArray.get(F[D]).placedOrientation=C;_.verticalPlacedTextSymbolIndex&&(y.text.placedSymbolArray.get(_.verticalPlacedTextSymbolIndex).placedOrientation=L)},me.prototype.commit=function(y){this.commitTime=y,this.zoomAtLastRecencyCheck=this.transform.zoom;var b=this.prevPlacement,_=!1;this.prevZoomAdjustment=b?b.zoomAdjustment(this.transform.zoom):0;var C=b?b.symbolFadeChange(y):1,L=b?b.opacities:{},D=b?b.variableOffsets:{},F=b?b.placedOrientations:{};for(var $ in this.placements){var j=this.placements[$],et=L[$];et?(this.opacities[$]=new Ds(et,C,j.text,j.icon),_=_||j.text!==et.text.placed||j.icon!==et.icon.placed):(this.opacities[$]=new Ds(null,C,j.text,j.icon,j.skipFade),_=_||j.text||j.icon)}for(var ut in L){var ht=L[ut];if(!this.opacities[ut]){var dt=new Ds(ht,C,!1,!1);dt.isHidden()||(this.opacities[ut]=dt,_=_||ht.text.placed||ht.icon.placed)}}for(var Ot in D)this.variableOffsets[Ot]||!this.opacities[Ot]||this.opacities[Ot].isHidden()||(this.variableOffsets[Ot]=D[Ot]);for(var At in F)this.placedOrientations[At]||!this.opacities[At]||this.opacities[At].isHidden()||(this.placedOrientations[At]=F[At]);_?this.lastPlacementChangeTime=y:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=b?b.lastPlacementChangeTime:y)},me.prototype.updateLayerOpacities=function(y,b){for(var _={},C=0,L=b;C<L.length;C+=1){var D=L[C],F=D.getBucket(y);F&&D.latestFeatureIndex&&y.id===F.layerIds[0]&&this.updateBucketOpacities(F,_,D.collisionBoxArray)}},me.prototype.updateBucketOpacities=function(y,b,_){var C=this;y.hasTextData()&&y.text.opacityVertexArray.clear(),y.hasIconData()&&y.icon.opacityVertexArray.clear(),y.hasIconCollisionBoxData()&&y.iconCollisionBox.collisionVertexArray.clear(),y.hasTextCollisionBoxData()&&y.textCollisionBox.collisionVertexArray.clear();var L=y.layers[0].layout,D=new Ds(null,0,!1,!1,!0),F=L.get("text-allow-overlap"),$=L.get("icon-allow-overlap"),j=L.get("text-variable-anchor"),et=L.get("text-rotation-alignment")==="map",ut=L.get("text-pitch-alignment")==="map",ht=L.get("icon-text-fit")!=="none",dt=new Ds(null,0,F&&($||!y.hasIconData()||L.get("icon-optional")),$&&(F||!y.hasTextData()||L.get("text-optional")),!0);!y.collisionArrays&&_&&(y.hasIconCollisionBoxData()||y.hasTextCollisionBoxData())&&y.deserializeCollisionBoxes(_);for(var Ot=function(zt,qt,se){for(var Ee=0;Ee<qt/4;Ee++)zt.opacityVertexArray.emplaceBack(se)},At=function(zt){var qt=y.symbolInstances.get(zt),se=qt.numHorizontalGlyphVertices,Ee=qt.numVerticalGlyphVertices,pe=qt.crossTileID,Ae=C.opacities[pe];b[pe]?Ae=D:Ae||(C.opacities[pe]=Ae=dt),b[pe]=!0;var Ve=qt.numIconVertices>0,cr=C.placedOrientations[qt.crossTileID],ar=cr===o.WritingMode.vertical,Mr=cr===o.WritingMode.horizontal||cr===o.WritingMode.horizontalOnly;if(se>0||Ee>0){var sn=z_(Ae.text);Ot(y.text,se,ar?tp:sn),Ot(y.text,Ee,Mr?tp:sn);var hn=Ae.text.isHidden();[qt.rightJustifiedTextSymbolIndex,qt.centerJustifiedTextSymbolIndex,qt.leftJustifiedTextSymbolIndex].forEach(function(bn){bn>=0&&(y.text.placedSymbolArray.get(bn).hidden=hn||ar?1:0)}),qt.verticalPlacedTextSymbolIndex>=0&&(y.text.placedSymbolArray.get(qt.verticalPlacedTextSymbolIndex).hidden=hn||Mr?1:0);var cn=C.variableOffsets[qt.crossTileID];cn&&C.markUsedJustification(y,cn.anchor,qt,cr);var Ii=C.placedOrientations[qt.crossTileID];Ii&&(C.markUsedJustification(y,"left",qt,Ii),C.markUsedOrientation(y,Ii,qt))}if(Ve){var kr=z_(Ae.icon),Ln=!(ht&&qt.verticalPlacedIconSymbolIndex&&ar);qt.placedIconSymbolIndex>=0&&(Ot(y.icon,qt.numIconVertices,Ln?kr:tp),y.icon.placedSymbolArray.get(qt.placedIconSymbolIndex).hidden=Ae.icon.isHidden()),qt.verticalPlacedIconSymbolIndex>=0&&(Ot(y.icon,qt.numVerticalIconVertices,Ln?tp:kr),y.icon.placedSymbolArray.get(qt.verticalPlacedIconSymbolIndex).hidden=Ae.icon.isHidden())}if(y.hasIconCollisionBoxData()||y.hasTextCollisionBoxData()){var Xn=y.collisionArrays[zt];if(Xn){var Rn=new o.Point(0,0);if(Xn.textBox||Xn.verticalTextBox){var Cn=!0;if(j){var $n=C.variableOffsets[pe];$n?(Rn=vt($n.anchor,$n.width,$n.height,$n.textOffset,$n.textBoxScale),et&&Rn._rotate(ut?C.transform.angle:-C.transform.angle)):Cn=!1}Xn.textBox&&ur(y.textCollisionBox.collisionVertexArray,Ae.text.placed,!Cn||ar,Rn.x,Rn.y),Xn.verticalTextBox&&ur(y.textCollisionBox.collisionVertexArray,Ae.text.placed,!Cn||Mr,Rn.x,Rn.y)}var Sn=!!(!Mr&&Xn.verticalIconBox);Xn.iconBox&&ur(y.iconCollisionBox.collisionVertexArray,Ae.icon.placed,Sn,ht?Rn.x:0,ht?Rn.y:0),Xn.verticalIconBox&&ur(y.iconCollisionBox.collisionVertexArray,Ae.icon.placed,!Sn,ht?Rn.x:0,ht?Rn.y:0)}}},$t=0;$t<y.symbolInstances.length;$t++)At($t);if(y.sortFeatures(this.transform.angle),this.retainedQueryData[y.bucketInstanceId]&&(this.retainedQueryData[y.bucketInstanceId].featureSortOrder=y.featureSortOrder),y.hasTextData()&&y.text.opacityVertexBuffer&&y.text.opacityVertexBuffer.updateData(y.text.opacityVertexArray),y.hasIconData()&&y.icon.opacityVertexBuffer&&y.icon.opacityVertexBuffer.updateData(y.icon.opacityVertexArray),y.hasIconCollisionBoxData()&&y.iconCollisionBox.collisionVertexBuffer&&y.iconCollisionBox.collisionVertexBuffer.updateData(y.iconCollisionBox.collisionVertexArray),y.hasTextCollisionBoxData()&&y.textCollisionBox.collisionVertexBuffer&&y.textCollisionBox.collisionVertexBuffer.updateData(y.textCollisionBox.collisionVertexArray),y.bucketInstanceId in this.collisionCircleArrays){var Ct=this.collisionCircleArrays[y.bucketInstanceId];y.placementInvProjMatrix=Ct.invProjMatrix,y.placementViewportMatrix=Ct.viewportMatrix,y.collisionCircleArray=Ct.circles,delete this.collisionCircleArrays[y.bucketInstanceId]}},me.prototype.symbolFadeChange=function(y){return this.fadeDuration===0?1:(y-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},me.prototype.zoomAdjustment=function(y){return Math.max(0,(this.transform.zoom-y)/1.5)},me.prototype.hasTransitions=function(y){return this.stale||y-this.lastPlacementChangeTime<this.fadeDuration},me.prototype.stillRecent=function(y,b){var _=this.zoomAtLastRecencyCheck===b?1-this.zoomAdjustment(b):1;return this.zoomAtLastRecencyCheck=b,this.commitTime+this.fadeDuration*_>y},me.prototype.setStale=function(){this.stale=!0};var rn=Math.pow(2,25),Ri=Math.pow(2,24),xo=Math.pow(2,17),cs=Math.pow(2,16),Vo=Math.pow(2,9),yu=Math.pow(2,8),k_=Math.pow(2,1);function z_(y){if(y.opacity===0&&!y.placed)return 0;if(y.opacity===1&&y.placed)return 4294967295;var b=y.placed?1:0,_=Math.floor(127*y.opacity);return _*rn+b*Ri+_*xo+b*cs+_*Vo+b*yu+_*k_+b}var tp=0,S0=function(y){this._sortAcrossTiles=y.layout.get("symbol-z-order")!=="viewport-y"&&y.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};S0.prototype.continuePlacement=function(y,b,_,C,L){for(var D=this._bucketParts;this._currentTileIndex<y.length;)if(b.getBucketParts(D,C,y[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,L())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,D.sort(function(F,$){return F.sortKey-$.sortKey}));this._currentPartIndex<D.length;)if(b.placeLayerBucketPart(D[this._currentPartIndex],this._seenCrossTileIDs,_),this._currentPartIndex++,L())return!0;return!1};var cv=function(y,b,_,C,L,D,F){this.placement=new me(y,L,D,F),this._currentPlacementIndex=b.length-1,this._forceFullPlacement=_,this._showCollisionBoxes=C,this._done=!1};cv.prototype.isDone=function(){return this._done},cv.prototype.continuePlacement=function(y,b,_){for(var C=this,L=o.browser.now(),D=function(){var j=o.browser.now()-L;return!C._forceFullPlacement&&j>2};this._currentPlacementIndex>=0;){var F=b[y[this._currentPlacementIndex]],$=this.placement.collisionIndex.transform.zoom;if(F.type==="symbol"&&(!F.minzoom||F.minzoom<=$)&&(!F.maxzoom||F.maxzoom>$)){if(this._inProgressLayer||(this._inProgressLayer=new S0(F)),this._inProgressLayer.continuePlacement(_[F.source],this.placement,this._showCollisionBoxes,F,D))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},cv.prototype.commit=function(y){return this.placement.commit(y),this.placement};var U_=512/o.EXTENT/2,Cg=function(y,b,_){this.tileID=y,this.indexedSymbolInstances={},this.bucketInstanceId=_;for(var C=0;C<b.length;C++){var L=b.get(C),D=L.key;this.indexedSymbolInstances[D]||(this.indexedSymbolInstances[D]=[]),this.indexedSymbolInstances[D].push({crossTileID:L.crossTileID,coord:this.getScaledCoordinates(L,y)})}};Cg.prototype.getScaledCoordinates=function(y,b){var _=U_/Math.pow(2,b.canonical.z-this.tileID.canonical.z);return{x:Math.floor((b.canonical.x*o.EXTENT+y.anchorX)*_),y:Math.floor((b.canonical.y*o.EXTENT+y.anchorY)*_)}},Cg.prototype.findMatches=function(y,b,_){for(var C=this.tileID.canonical.z<b.canonical.z?1:Math.pow(2,this.tileID.canonical.z-b.canonical.z),L=0;L<y.length;L++){var D=y.get(L);if(!D.crossTileID){var F=this.indexedSymbolInstances[D.key];if(F)for(var $=this.getScaledCoordinates(D,b),j=0,et=F;j<et.length;j+=1){var ut=et[j];if(Math.abs(ut.coord.x-$.x)<=C&&Math.abs(ut.coord.y-$.y)<=C&&!_[ut.crossTileID]){_[ut.crossTileID]=!0,D.crossTileID=ut.crossTileID;break}}}}};var ws=function(){this.maxCrossTileID=0};ws.prototype.generate=function(){return++this.maxCrossTileID};var Qh=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Qh.prototype.handleWrapJump=function(y){var b=Math.round((y-this.lng)/360);if(b!==0)for(var _ in this.indexes){var C=this.indexes[_],L={};for(var D in C){var F=C[D];F.tileID=F.tileID.unwrapTo(F.tileID.wrap+b),L[F.tileID.key]=F}this.indexes[_]=L}this.lng=y},Qh.prototype.addBucket=function(y,b,_){if(this.indexes[y.overscaledZ]&&this.indexes[y.overscaledZ][y.key]){if(this.indexes[y.overscaledZ][y.key].bucketInstanceId===b.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(y.overscaledZ,this.indexes[y.overscaledZ][y.key])}for(var C=0;C<b.symbolInstances.length;C++)b.symbolInstances.get(C).crossTileID=0;this.usedCrossTileIDs[y.overscaledZ]||(this.usedCrossTileIDs[y.overscaledZ]={});var L=this.usedCrossTileIDs[y.overscaledZ];for(var D in this.indexes){var F=this.indexes[D];if(Number(D)>y.overscaledZ)for(var $ in F){var j=F[$];j.tileID.isChildOf(y)&&j.findMatches(b.symbolInstances,y,L)}else{var et=F[y.scaledTo(Number(D)).key];et&&et.findMatches(b.symbolInstances,y,L)}}for(var ut=0;ut<b.symbolInstances.length;ut++){var ht=b.symbolInstances.get(ut);ht.crossTileID||(ht.crossTileID=_.generate(),L[ht.crossTileID]=!0)}return this.indexes[y.overscaledZ]===void 0&&(this.indexes[y.overscaledZ]={}),this.indexes[y.overscaledZ][y.key]=new Cg(y,b.symbolInstances,b.bucketInstanceId),!0},Qh.prototype.removeBucketCrossTileIDs=function(y,b){for(var _ in b.indexedSymbolInstances)for(var C=0,L=b.indexedSymbolInstances[_];C<L.length;C+=1)delete this.usedCrossTileIDs[y][L[C].crossTileID]},Qh.prototype.removeStaleBuckets=function(y){var b=!1;for(var _ in this.indexes){var C=this.indexes[_];for(var L in C)y[C[L].bucketInstanceId]||(this.removeBucketCrossTileIDs(_,C[L]),delete C[L],b=!0)}return b};var Jh=function(){this.layerIndexes={},this.crossTileIDs=new ws,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Jh.prototype.addLayer=function(y,b,_){var C=this.layerIndexes[y.id];C===void 0&&(C=this.layerIndexes[y.id]=new Qh);var L=!1,D={};C.handleWrapJump(_);for(var F=0,$=b;F<$.length;F+=1){var j=$[F],et=j.getBucket(y);et&&y.id===et.layerIds[0]&&(et.bucketInstanceId||(et.bucketInstanceId=++this.maxBucketInstanceId),C.addBucket(j.tileID,et,this.crossTileIDs)&&(L=!0),D[et.bucketInstanceId]=!0)}return C.removeStaleBuckets(D)&&(L=!0),L},Jh.prototype.pruneUnusedLayers=function(y){var b={};for(var _ in y.forEach(function(C){b[C]=!0}),this.layerIndexes)b[_]||delete this.layerIndexes[_]};var vc=function(y,b){return o.emitValidationErrors(y,b&&b.filter(function(_){return _.identifier!=="source.canvas"}))},gc=o.pick(gr,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),ch=o.pick(gr,["setCenter","setZoom","setBearing","setPitch"]),hv=function(){var y={},b=o.styleSpec.$version;for(var _ in o.styleSpec.$root){var C,L=o.styleSpec.$root[_];L.required&&(C=_==="version"?b:L.type==="array"?[]:{})!=null&&(y[_]=C)}return y}(),Tl=function(y){function b(_,C){var L=this;C===void 0&&(C={}),y.call(this),this.map=_,this.dispatcher=new Et(Re(),this),this.imageManager=new A,this.imageManager.setEventedParent(this),this.glyphManager=new Q(_._requestManager,C.localIdeographFontFamily),this.lineAtlas=new it(256,512),this.crossTileSymbolIndex=new Jh,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new o.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",o.getReferrer());var D=this;this._rtlTextPluginCallback=b.registerForPluginStateChange(function(F){D.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:F.pluginStatus,pluginURL:F.pluginURL},function($,j){if(o.triggerPluginCompletionEvent($),j&&j.every(function(ut){return ut}))for(var et in D.sourceCaches)D.sourceCaches[et].reload()})}),this.on("data",function(F){if(F.dataType==="source"&&F.sourceDataType==="metadata"){var $=L.sourceCaches[F.sourceId];if($){var j=$.getSource();if(j&&j.vectorLayerIds)for(var et in L._layers){var ut=L._layers[et];ut.source===j.id&&L._validateLayer(ut)}}}})}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.loadURL=function(_,C){var L=this;C===void 0&&(C={}),this.fire(new o.Event("dataloading",{dataType:"style"}));var D=typeof C.validate=="boolean"?C.validate:!o.isMapboxURL(_);_=this.map._requestManager.normalizeStyleURL(_,C.accessToken);var F=this.map._requestManager.transformRequest(_,o.ResourceType.Style);this._request=o.getJSON(F,function($,j){L._request=null,$?L.fire(new o.ErrorEvent($)):j&&L._load(j,D)})},b.prototype.loadJSON=function(_,C){var L=this;C===void 0&&(C={}),this.fire(new o.Event("dataloading",{dataType:"style"})),this._request=o.browser.frame(function(){L._request=null,L._load(_,C.validate!==!1)})},b.prototype.loadEmpty=function(){this.fire(new o.Event("dataloading",{dataType:"style"})),this._load(hv,!1)},b.prototype._load=function(_,C){if(!C||!vc(this,o.validateStyle(_))){for(var L in this._loaded=!0,this.stylesheet=_,_.sources)this.addSource(L,_.sources[L],{validate:!1});_.sprite?this._loadSprite(_.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(_.glyphs);var D=dr(this.stylesheet.layers);this._order=D.map(function(et){return et.id}),this._layers={},this._serializedLayers={};for(var F=0,$=D;F<$.length;F+=1){var j=$[F];(j=o.createStyleLayer(j)).setEventedParent(this,{layer:{id:j.id}}),this._layers[j.id]=j,this._serializedLayers[j.id]=j.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new tt(this.stylesheet.light),this.fire(new o.Event("data",{dataType:"style"})),this.fire(new o.Event("style.load"))}},b.prototype._loadSprite=function(_){var C=this;this._spriteRequest=function(L,D,F){var $,j,et,ut=o.browser.devicePixelRatio>1?"@2x":"",ht=o.getJSON(D.transformRequest(D.normalizeSpriteURL(L,ut,".json"),o.ResourceType.SpriteJSON),function(At,$t){ht=null,et||(et=At,$=$t,Ot())}),dt=o.getImage(D.transformRequest(D.normalizeSpriteURL(L,ut,".png"),o.ResourceType.SpriteImage),function(At,$t){dt=null,et||(et=At,j=$t,Ot())});function Ot(){if(et)F(et);else if($&&j){var At=o.browser.getImageData(j),$t={};for(var Ct in $){var zt=$[Ct],qt=zt.width,se=zt.height,Ee=zt.x,pe=zt.y,Ae=zt.sdf,Ve=zt.pixelRatio,cr=zt.stretchX,ar=zt.stretchY,Mr=zt.content,sn=new o.RGBAImage({width:qt,height:se});o.RGBAImage.copy(At,sn,{x:Ee,y:pe},{x:0,y:0},{width:qt,height:se}),$t[Ct]={data:sn,pixelRatio:Ve,sdf:Ae,stretchX:cr,stretchY:ar,content:Mr}}F(null,$t)}}return{cancel:function(){ht&&(ht.cancel(),ht=null),dt&&(dt.cancel(),dt=null)}}}(_,this.map._requestManager,function(L,D){if(C._spriteRequest=null,L)C.fire(new o.ErrorEvent(L));else if(D)for(var F in D)C.imageManager.addImage(F,D[F]);C.imageManager.setLoaded(!0),C._availableImages=C.imageManager.listImages(),C.dispatcher.broadcast("setImages",C._availableImages),C.fire(new o.Event("data",{dataType:"style"}))})},b.prototype._validateLayer=function(_){var C=this.sourceCaches[_.source];if(C){var L=_.sourceLayer;if(L){var D=C.getSource();(D.type==="geojson"||D.vectorLayerIds&&D.vectorLayerIds.indexOf(L)===-1)&&this.fire(new o.ErrorEvent(new Error('Source layer "'+L+'" does not exist on source "'+D.id+'" as specified by style layer "'+_.id+'"')))}}},b.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var _ in this.sourceCaches)if(!this.sourceCaches[_].loaded())return!1;return!!this.imageManager.isLoaded()},b.prototype._serializeLayers=function(_){for(var C=[],L=0,D=_;L<D.length;L+=1){var F=this._layers[D[L]];F.type!=="custom"&&C.push(F.serialize())}return C},b.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var _ in this.sourceCaches)if(this.sourceCaches[_].hasTransition())return!0;for(var C in this._layers)if(this._layers[C].hasTransition())return!0;return!1},b.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},b.prototype.update=function(_){if(this._loaded){var C=this._changed;if(this._changed){var L=Object.keys(this._updatedLayers),D=Object.keys(this._removedLayers);for(var F in(L.length||D.length)&&this._updateWorkerLayers(L,D),this._updatedSources){var $=this._updatedSources[F];$==="reload"?this._reloadSource(F):$==="clear"&&this._clearSource(F)}for(var j in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[j].updateTransitions(_);this.light.updateTransitions(_),this._resetUpdates()}var et={};for(var ut in this.sourceCaches){var ht=this.sourceCaches[ut];et[ut]=ht.used,ht.used=!1}for(var dt=0,Ot=this._order;dt<Ot.length;dt+=1){var At=this._layers[Ot[dt]];At.recalculate(_,this._availableImages),!At.isHidden(_.zoom)&&At.source&&(this.sourceCaches[At.source].used=!0)}for(var $t in et){var Ct=this.sourceCaches[$t];et[$t]!==Ct.used&&Ct.fire(new o.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:$t}))}this.light.recalculate(_),this.z=_.zoom,C&&this.fire(new o.Event("data",{dataType:"style"}))}},b.prototype._updateTilesForChangedImages=function(){var _=Object.keys(this._changedImages);if(_.length){for(var C in this.sourceCaches)this.sourceCaches[C].reloadTilesForDependencies(["icons","patterns"],_);this._changedImages={}}},b.prototype._updateWorkerLayers=function(_,C){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(_),removedIds:C})},b.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},b.prototype.setState=function(_){var C=this;if(this._checkLoaded(),vc(this,o.validateStyle(_)))return!1;(_=o.clone$1(_)).layers=dr(_.layers);var L=function(F,$){if(!F)return[{command:gr.setStyle,args:[$]}];var j=[];try{if(!o.deepEqual(F.version,$.version))return[{command:gr.setStyle,args:[$]}];o.deepEqual(F.center,$.center)||j.push({command:gr.setCenter,args:[$.center]}),o.deepEqual(F.zoom,$.zoom)||j.push({command:gr.setZoom,args:[$.zoom]}),o.deepEqual(F.bearing,$.bearing)||j.push({command:gr.setBearing,args:[$.bearing]}),o.deepEqual(F.pitch,$.pitch)||j.push({command:gr.setPitch,args:[$.pitch]}),o.deepEqual(F.sprite,$.sprite)||j.push({command:gr.setSprite,args:[$.sprite]}),o.deepEqual(F.glyphs,$.glyphs)||j.push({command:gr.setGlyphs,args:[$.glyphs]}),o.deepEqual(F.transition,$.transition)||j.push({command:gr.setTransition,args:[$.transition]}),o.deepEqual(F.light,$.light)||j.push({command:gr.setLight,args:[$.light]});var et={},ut=[];(function(dt,Ot,At,$t){var Ct;for(Ct in Ot=Ot||{},dt=dt||{})dt.hasOwnProperty(Ct)&&(Ot.hasOwnProperty(Ct)||wr(Ct,At,$t));for(Ct in Ot)Ot.hasOwnProperty(Ct)&&(dt.hasOwnProperty(Ct)?o.deepEqual(dt[Ct],Ot[Ct])||(dt[Ct].type==="geojson"&&Ot[Ct].type==="geojson"&&ea(dt,Ot,Ct)?At.push({command:gr.setGeoJSONSourceData,args:[Ct,Ot[Ct].data]}):ci(Ct,Ot,At,$t)):kn(Ct,Ot,At))})(F.sources,$.sources,ut,et);var ht=[];F.layers&&F.layers.forEach(function(dt){et[dt.source]?j.push({command:gr.removeLayer,args:[dt.id]}):ht.push(dt)}),j=j.concat(ut),function(dt,Ot,At){Ot=Ot||[];var $t,Ct,zt,qt,se,Ee,pe,Ae=(dt=dt||[]).map(wi),Ve=Ot.map(wi),cr=dt.reduce(zn,{}),ar=Ot.reduce(zn,{}),Mr=Ae.slice(),sn=Object.create(null);for($t=0,Ct=0;$t<Ae.length;$t++)ar.hasOwnProperty(zt=Ae[$t])?Ct++:(At.push({command:gr.removeLayer,args:[zt]}),Mr.splice(Mr.indexOf(zt,Ct),1));for($t=0,Ct=0;$t<Ve.length;$t++)Mr[Mr.length-1-$t]!==(zt=Ve[Ve.length-1-$t])&&(cr.hasOwnProperty(zt)?(At.push({command:gr.removeLayer,args:[zt]}),Mr.splice(Mr.lastIndexOf(zt,Mr.length-Ct),1)):Ct++,At.push({command:gr.addLayer,args:[ar[zt],Ee=Mr[Mr.length-$t]]}),Mr.splice(Mr.length-$t,0,zt),sn[zt]=!0);for($t=0;$t<Ve.length;$t++)if(qt=cr[zt=Ve[$t]],se=ar[zt],!sn[zt]&&!o.deepEqual(qt,se))if(o.deepEqual(qt.source,se.source)&&o.deepEqual(qt["source-layer"],se["source-layer"])&&o.deepEqual(qt.type,se.type)){for(pe in ai(qt.layout,se.layout,At,zt,null,gr.setLayoutProperty),ai(qt.paint,se.paint,At,zt,null,gr.setPaintProperty),o.deepEqual(qt.filter,se.filter)||At.push({command:gr.setFilter,args:[zt,se.filter]}),o.deepEqual(qt.minzoom,se.minzoom)&&o.deepEqual(qt.maxzoom,se.maxzoom)||At.push({command:gr.setLayerZoomRange,args:[zt,se.minzoom,se.maxzoom]}),qt)qt.hasOwnProperty(pe)&&pe!=="layout"&&pe!=="paint"&&pe!=="filter"&&pe!=="metadata"&&pe!=="minzoom"&&pe!=="maxzoom"&&(pe.indexOf("paint.")===0?ai(qt[pe],se[pe],At,zt,pe.slice(6),gr.setPaintProperty):o.deepEqual(qt[pe],se[pe])||At.push({command:gr.setLayerProperty,args:[zt,pe,se[pe]]}));for(pe in se)se.hasOwnProperty(pe)&&!qt.hasOwnProperty(pe)&&pe!=="layout"&&pe!=="paint"&&pe!=="filter"&&pe!=="metadata"&&pe!=="minzoom"&&pe!=="maxzoom"&&(pe.indexOf("paint.")===0?ai(qt[pe],se[pe],At,zt,pe.slice(6),gr.setPaintProperty):o.deepEqual(qt[pe],se[pe])||At.push({command:gr.setLayerProperty,args:[zt,pe,se[pe]]}))}else At.push({command:gr.removeLayer,args:[zt]}),Ee=Mr[Mr.lastIndexOf(zt)+1],At.push({command:gr.addLayer,args:[se,Ee]})}(ht,$.layers,j)}catch(dt){console.warn("Unable to compute style diff:",dt),j=[{command:gr.setStyle,args:[$]}]}return j}(this.serialize(),_).filter(function(F){return!(F.command in ch)});if(L.length===0)return!1;var D=L.filter(function(F){return!(F.command in gc)});if(D.length>0)throw new Error("Unimplemented: "+D.map(function(F){return F.command}).join(", ")+".");return L.forEach(function(F){F.command!=="setTransition"&&C[F.command].apply(C,F.args)}),this.stylesheet=_,!0},b.prototype.addImage=function(_,C){if(this.getImage(_))return this.fire(new o.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(_,C),this._afterImageUpdated(_)},b.prototype.updateImage=function(_,C){this.imageManager.updateImage(_,C)},b.prototype.getImage=function(_){return this.imageManager.getImage(_)},b.prototype.removeImage=function(_){if(!this.getImage(_))return this.fire(new o.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(_),this._afterImageUpdated(_)},b.prototype._afterImageUpdated=function(_){this._availableImages=this.imageManager.listImages(),this._changedImages[_]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.Event("data",{dataType:"style"}))},b.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},b.prototype.addSource=function(_,C,L){var D=this;if(L===void 0&&(L={}),this._checkLoaded(),this.sourceCaches[_]!==void 0)throw new Error("There is already a source with this ID");if(!C.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(C).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(C.type)>=0&&this._validate(o.validateStyle.source,"sources."+_,C,null,L))){this.map&&this.map._collectResourceTiming&&(C.collectResourceTiming=!0);var F=this.sourceCaches[_]=new Pt(_,C,this.dispatcher);F.style=this,F.setEventedParent(this,function(){return{isSourceLoaded:D.loaded(),source:F.serialize(),sourceId:_}}),F.onAdd(this.map),this._changed=!0}},b.prototype.removeSource=function(_){if(this._checkLoaded(),this.sourceCaches[_]===void 0)throw new Error("There is no source with this ID");for(var C in this._layers)if(this._layers[C].source===_)return this.fire(new o.ErrorEvent(new Error('Source "'+_+'" cannot be removed while layer "'+C+'" is using it.')));var L=this.sourceCaches[_];delete this.sourceCaches[_],delete this._updatedSources[_],L.fire(new o.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:_})),L.setEventedParent(null),L.clearTiles(),L.onRemove&&L.onRemove(this.map),this._changed=!0},b.prototype.setGeoJSONSourceData=function(_,C){this._checkLoaded(),this.sourceCaches[_].getSource().setData(C),this._changed=!0},b.prototype.getSource=function(_){return this.sourceCaches[_]&&this.sourceCaches[_].getSource()},b.prototype.addLayer=function(_,C,L){L===void 0&&(L={}),this._checkLoaded();var D=_.id;if(this.getLayer(D))this.fire(new o.ErrorEvent(new Error('Layer with id "'+D+'" already exists on this map')));else{var F;if(_.type==="custom"){if(vc(this,o.validateCustomStyleLayer(_)))return;F=o.createStyleLayer(_)}else{if(typeof _.source=="object"&&(this.addSource(D,_.source),_=o.clone$1(_),_=o.extend(_,{source:D})),this._validate(o.validateStyle.layer,"layers."+D,_,{arrayIndex:-1},L))return;F=o.createStyleLayer(_),this._validateLayer(F),F.setEventedParent(this,{layer:{id:D}}),this._serializedLayers[F.id]=F.serialize()}var $=C?this._order.indexOf(C):this._order.length;if(C&&$===-1)this.fire(new o.ErrorEvent(new Error('Layer with id "'+C+'" does not exist on this map.')));else{if(this._order.splice($,0,D),this._layerOrderChanged=!0,this._layers[D]=F,this._removedLayers[D]&&F.source&&F.type!=="custom"){var j=this._removedLayers[D];delete this._removedLayers[D],j.type!==F.type?this._updatedSources[F.source]="clear":(this._updatedSources[F.source]="reload",this.sourceCaches[F.source].pause())}this._updateLayer(F),F.onAdd&&F.onAdd(this.map)}}},b.prototype.moveLayer=function(_,C){if(this._checkLoaded(),this._changed=!0,this._layers[_]){if(_!==C){var L=this._order.indexOf(_);this._order.splice(L,1);var D=C?this._order.indexOf(C):this._order.length;C&&D===-1?this.fire(new o.ErrorEvent(new Error('Layer with id "'+C+'" does not exist on this map.'))):(this._order.splice(D,0,_),this._layerOrderChanged=!0)}}else this.fire(new o.ErrorEvent(new Error("The layer '"+_+"' does not exist in the map's style and cannot be moved.")))},b.prototype.removeLayer=function(_){this._checkLoaded();var C=this._layers[_];if(C){C.setEventedParent(null);var L=this._order.indexOf(_);this._order.splice(L,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[_]=C,delete this._layers[_],delete this._serializedLayers[_],delete this._updatedLayers[_],delete this._updatedPaintProps[_],C.onRemove&&C.onRemove(this.map)}else this.fire(new o.ErrorEvent(new Error("The layer '"+_+"' does not exist in the map's style and cannot be removed.")))},b.prototype.getLayer=function(_){return this._layers[_]},b.prototype.hasLayer=function(_){return _ in this._layers},b.prototype.setLayerZoomRange=function(_,C,L){this._checkLoaded();var D=this.getLayer(_);D?D.minzoom===C&&D.maxzoom===L||(C!=null&&(D.minzoom=C),L!=null&&(D.maxzoom=L),this._updateLayer(D)):this.fire(new o.ErrorEvent(new Error("The layer '"+_+"' does not exist in the map's style and cannot have zoom extent.")))},b.prototype.setFilter=function(_,C,L){L===void 0&&(L={}),this._checkLoaded();var D=this.getLayer(_);if(D){if(!o.deepEqual(D.filter,C))return C==null?(D.filter=void 0,void this._updateLayer(D)):void(this._validate(o.validateStyle.filter,"layers."+D.id+".filter",C,null,L)||(D.filter=o.clone$1(C),this._updateLayer(D)))}else this.fire(new o.ErrorEvent(new Error("The layer '"+_+"' does not exist in the map's style and cannot be filtered.")))},b.prototype.getFilter=function(_){return o.clone$1(this.getLayer(_).filter)},b.prototype.setLayoutProperty=function(_,C,L,D){D===void 0&&(D={}),this._checkLoaded();var F=this.getLayer(_);F?o.deepEqual(F.getLayoutProperty(C),L)||(F.setLayoutProperty(C,L,D),this._updateLayer(F)):this.fire(new o.ErrorEvent(new Error("The layer '"+_+"' does not exist in the map's style and cannot be styled.")))},b.prototype.getLayoutProperty=function(_,C){var L=this.getLayer(_);if(L)return L.getLayoutProperty(C);this.fire(new o.ErrorEvent(new Error("The layer '"+_+"' does not exist in the map's style.")))},b.prototype.setPaintProperty=function(_,C,L,D){D===void 0&&(D={}),this._checkLoaded();var F=this.getLayer(_);F?o.deepEqual(F.getPaintProperty(C),L)||(F.setPaintProperty(C,L,D)&&this._updateLayer(F),this._changed=!0,this._updatedPaintProps[_]=!0):this.fire(new o.ErrorEvent(new Error("The layer '"+_+"' does not exist in the map's style and cannot be styled.")))},b.prototype.getPaintProperty=function(_,C){return this.getLayer(_).getPaintProperty(C)},b.prototype.setFeatureState=function(_,C){this._checkLoaded();var L=_.source,D=_.sourceLayer,F=this.sourceCaches[L];if(F!==void 0){var $=F.getSource().type;$==="geojson"&&D?this.fire(new o.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):$!=="vector"||D?(_.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),F.setFeatureState(D,_.id,C)):this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error("The source '"+L+"' does not exist in the map's style.")))},b.prototype.removeFeatureState=function(_,C){this._checkLoaded();var L=_.source,D=this.sourceCaches[L];if(D!==void 0){var F=D.getSource().type,$=F==="vector"?_.sourceLayer:void 0;F!=="vector"||$?C&&typeof _.id!="string"&&typeof _.id!="number"?this.fire(new o.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):D.removeFeatureState($,_.id,C):this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error("The source '"+L+"' does not exist in the map's style.")))},b.prototype.getFeatureState=function(_){this._checkLoaded();var C=_.source,L=_.sourceLayer,D=this.sourceCaches[C];if(D!==void 0){if(D.getSource().type!=="vector"||L)return _.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),D.getFeatureState(L,_.id);this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error("The source '"+C+"' does not exist in the map's style.")))},b.prototype.getTransition=function(){return o.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},b.prototype.serialize=function(){return o.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:o.mapObject(this.sourceCaches,function(_){return _.serialize()}),layers:this._serializeLayers(this._order)},function(_){return _!==void 0})},b.prototype._updateLayer=function(_){this._updatedLayers[_.id]=!0,_.source&&!this._updatedSources[_.source]&&this.sourceCaches[_.source].getSource().type!=="raster"&&(this._updatedSources[_.source]="reload",this.sourceCaches[_.source].pause()),this._changed=!0},b.prototype._flattenAndSortRenderedFeatures=function(_){for(var C=this,L=function(cr){return C._layers[cr].type==="fill-extrusion"},D={},F=[],$=this._order.length-1;$>=0;$--){var j=this._order[$];if(L(j)){D[j]=$;for(var et=0,ut=_;et<ut.length;et+=1){var ht=ut[et][j];if(ht)for(var dt=0,Ot=ht;dt<Ot.length;dt+=1)F.push(Ot[dt])}}}F.sort(function(cr,ar){return ar.intersectionZ-cr.intersectionZ});for(var At=[],$t=this._order.length-1;$t>=0;$t--){var Ct=this._order[$t];if(L(Ct))for(var zt=F.length-1;zt>=0;zt--){var qt=F[zt].feature;if(D[qt.layer.id]<$t)break;At.push(qt),F.pop()}else for(var se=0,Ee=_;se<Ee.length;se+=1){var pe=Ee[se][Ct];if(pe)for(var Ae=0,Ve=pe;Ae<Ve.length;Ae+=1)At.push(Ve[Ae].feature)}}return At},b.prototype.queryRenderedFeatures=function(_,C,L){C&&C.filter&&this._validate(o.validateStyle.filter,"queryRenderedFeatures.filter",C.filter,null,C);var D={};if(C&&C.layers){if(!Array.isArray(C.layers))return this.fire(new o.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var F=0,$=C.layers;F<$.length;F+=1){var j=$[F],et=this._layers[j];if(!et)return this.fire(new o.ErrorEvent(new Error("The layer '"+j+"' does not exist in the map's style and cannot be queried for features."))),[];D[et.source]=!0}}var ut=[];for(var ht in C.availableImages=this._availableImages,this.sourceCaches)C.layers&&!D[ht]||ut.push(Gr(this.sourceCaches[ht],this._layers,this._serializedLayers,_,C,L));return this.placement&&ut.push(function(dt,Ot,At,$t,Ct,zt,qt){for(var se={},Ee=zt.queryRenderedSymbols($t),pe=[],Ae=0,Ve=Object.keys(Ee).map(Number);Ae<Ve.length;Ae+=1)pe.push(qt[Ve[Ae]]);pe.sort(Mn);for(var cr=function(){var cn=Mr[ar],Ii=cn.featureIndex.lookupSymbolFeatures(Ee[cn.bucketInstanceId],Ot,cn.bucketIndex,cn.sourceLayerIndex,Ct.filter,Ct.layers,Ct.availableImages,dt);for(var kr in Ii){var Ln=se[kr]=se[kr]||[],Xn=Ii[kr];Xn.sort(function($n,Sn){var bn=cn.featureSortOrder;if(bn){var Mo=bn.indexOf($n.featureIndex);return bn.indexOf(Sn.featureIndex)-Mo}return Sn.featureIndex-$n.featureIndex});for(var Rn=0,Cn=Xn;Rn<Cn.length;Rn+=1)Ln.push(Cn[Rn])}},ar=0,Mr=pe;ar<Mr.length;ar+=1)cr();var sn=function(cn){se[cn].forEach(function(Ii){var kr=Ii.feature,Ln=At[dt[cn].source].getFeatureState(kr.layer["source-layer"],kr.id);kr.source=kr.layer.source,kr.layer["source-layer"]&&(kr.sourceLayer=kr.layer["source-layer"]),kr.state=Ln})};for(var hn in se)sn(hn);return se}(this._layers,this._serializedLayers,this.sourceCaches,_,C,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(ut)},b.prototype.querySourceFeatures=function(_,C){C&&C.filter&&this._validate(o.validateStyle.filter,"querySourceFeatures.filter",C.filter,null,C);var L=this.sourceCaches[_];return L?function(D,F){for(var $=D.getRenderableIds().map(function(Ot){return D.getTileByID(Ot)}),j=[],et={},ut=0;ut<$.length;ut++){var ht=$[ut],dt=ht.tileID.canonical.key;et[dt]||(et[dt]=!0,ht.querySourceFeatures(j,F))}return j}(L,C):[]},b.prototype.addSourceType=function(_,C,L){return b.getSourceType(_)?L(new Error('A source type called "'+_+'" already exists.')):(b.setSourceType(_,C),C.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:_,url:C.workerSourceURL},L):L(null,null))},b.prototype.getLight=function(){return this.light.getLight()},b.prototype.setLight=function(_,C){C===void 0&&(C={}),this._checkLoaded();var L=this.light.getLight(),D=!1;for(var F in _)if(!o.deepEqual(_[F],L[F])){D=!0;break}if(D){var $={now:o.browser.now(),transition:o.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(_,C),this.light.updateTransitions($)}},b.prototype._validate=function(_,C,L,D,F){return F===void 0&&(F={}),(!F||F.validate!==!1)&&vc(this,_.call(o.validateStyle,o.extend({key:C,style:this.serialize(),value:L,styleSpec:o.styleSpec},D)))},b.prototype._remove=function(){for(var _ in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),o.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[_].setEventedParent(null);for(var C in this.sourceCaches)this.sourceCaches[C].clearTiles(),this.sourceCaches[C].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},b.prototype._clearSource=function(_){this.sourceCaches[_].clearTiles()},b.prototype._reloadSource=function(_){this.sourceCaches[_].resume(),this.sourceCaches[_].reload()},b.prototype._updateSources=function(_){for(var C in this.sourceCaches)this.sourceCaches[C].update(_)},b.prototype._generateCollisionBoxes=function(){for(var _ in this.sourceCaches)this._reloadSource(_)},b.prototype._updatePlacement=function(_,C,L,D,F){F===void 0&&(F=!1);for(var $=!1,j=!1,et={},ut=0,ht=this._order;ut<ht.length;ut+=1){var dt=this._layers[ht[ut]];if(dt.type==="symbol"){if(!et[dt.source]){var Ot=this.sourceCaches[dt.source];et[dt.source]=Ot.getRenderableIds(!0).map(function(qt){return Ot.getTileByID(qt)}).sort(function(qt,se){return se.tileID.overscaledZ-qt.tileID.overscaledZ||(qt.tileID.isLessThan(se.tileID)?-1:1)})}var At=this.crossTileSymbolIndex.addLayer(dt,et[dt.source],_.center.lng);$=$||At}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((F=F||this._layerOrderChanged||L===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.browser.now(),_.zoom))&&(this.pauseablePlacement=new cv(_,this._order,F,C,L,D,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,et),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.browser.now()),j=!0),$&&this.pauseablePlacement.placement.setStale()),j||$)for(var $t=0,Ct=this._order;$t<Ct.length;$t+=1){var zt=this._layers[Ct[$t]];zt.type==="symbol"&&this.placement.updateLayerOpacities(zt,et[zt.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.browser.now())},b.prototype._releaseSymbolFadeTiles=function(){for(var _ in this.sourceCaches)this.sourceCaches[_].releaseSymbolFadeTiles()},b.prototype.getImages=function(_,C,L){this.imageManager.getImages(C.icons,L),this._updateTilesForChangedImages();var D=this.sourceCaches[C.source];D&&D.setDependencies(C.tileID.key,C.type,C.icons)},b.prototype.getGlyphs=function(_,C,L){this.glyphManager.getGlyphs(C.stacks,L)},b.prototype.getResource=function(_,C,L){return o.makeRequest(C,L)},b}(o.Evented);Tl.getSourceType=function(y){return De[y]},Tl.setSourceType=function(y,b){De[y]=b},Tl.registerForPluginStateChange=o.registerForPluginStateChange;var no=o.createLayout([{name:"a_pos",type:"Int16",components:2}]),tf=sa(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),hh=sa(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Sg=sa(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),$_=sa(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),Tg=sa("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),T0=sa(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),A0=sa(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),M0=sa("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),H_=sa("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),V_=sa("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Xb=sa(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fv=sa(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),mc=sa(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),G_=sa(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),Cs=sa(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),ad=sa(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),ef=sa(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Zl=sa(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),rf=sa(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),_u=sa(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),fh=sa(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),ql=sa(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),dh=sa(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),nf=sa(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),W_=sa(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),X_=sa(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function sa(y,b){var _=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,C=b.match(/attribute ([\w]+) ([\w]+)/g),L=y.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),D=b.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),F=D?D.concat(L):L,$={};return{fragmentSource:y=y.replace(_,function(j,et,ut,ht,dt){return $[dt]=!0,et==="define"?`
#ifndef HAS_UNIFORM_u_`+dt+`
varying `+ut+" "+ht+" "+dt+`;
#else
uniform `+ut+" "+ht+" u_"+dt+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+dt+`
    `+ut+" "+ht+" "+dt+" = u_"+dt+`;
#endif
`}),vertexSource:b=b.replace(_,function(j,et,ut,ht,dt){var Ot=ht==="float"?"vec2":"vec4",At=dt.match(/color/)?"color":Ot;return $[dt]?et==="define"?`
#ifndef HAS_UNIFORM_u_`+dt+`
uniform lowp float u_`+dt+`_t;
attribute `+ut+" "+Ot+" a_"+dt+`;
varying `+ut+" "+ht+" "+dt+`;
#else
uniform `+ut+" "+ht+" u_"+dt+`;
#endif
`:At==="vec4"?`
#ifndef HAS_UNIFORM_u_`+dt+`
    `+dt+" = a_"+dt+`;
#else
    `+ut+" "+ht+" "+dt+" = u_"+dt+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+dt+`
    `+dt+" = unpack_mix_"+At+"(a_"+dt+", u_"+dt+`_t);
#else
    `+ut+" "+ht+" "+dt+" = u_"+dt+`;
#endif
`:et==="define"?`
#ifndef HAS_UNIFORM_u_`+dt+`
uniform lowp float u_`+dt+`_t;
attribute `+ut+" "+Ot+" a_"+dt+`;
#else
uniform `+ut+" "+ht+" u_"+dt+`;
#endif
`:At==="vec4"?`
#ifndef HAS_UNIFORM_u_`+dt+`
    `+ut+" "+ht+" "+dt+" = a_"+dt+`;
#else
    `+ut+" "+ht+" "+dt+" = u_"+dt+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+dt+`
    `+ut+" "+ht+" "+dt+" = unpack_mix_"+At+"(a_"+dt+", u_"+dt+`_t);
#else
    `+ut+" "+ht+" "+dt+" = u_"+dt+`;
#endif
`}),staticAttributes:C,staticUniforms:F}}var jb=Object.freeze({__proto__:null,prelude:tf,background:hh,backgroundPattern:Sg,circle:$_,clippingMask:Tg,heatmap:T0,heatmapTexture:A0,collisionBox:M0,collisionCircle:H_,debug:V_,fill:Xb,fillOutline:fv,fillOutlinePattern:mc,fillPattern:G_,fillExtrusion:Cs,fillExtrusionPattern:ad,hillshadePrepare:ef,hillshade:Zl,line:rf,lineGradient:_u,linePattern:fh,lineSDF:ql,raster:dh,symbolIcon:nf,symbolSDF:W_,symbolTextAndIcon:X_}),Ag=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function R0(y){for(var b=[],_=0;_<y.length;_++)if(y[_]!==null){var C=y[_].split(" ");b.push(C.pop())}return b}Ag.prototype.bind=function(y,b,_,C,L,D,F,$){this.context=y;for(var j=this.boundPaintVertexBuffers.length!==C.length,et=0;!j&&et<C.length;et++)this.boundPaintVertexBuffers[et]!==C[et]&&(j=!0);y.extVertexArrayObject&&this.vao&&this.boundProgram===b&&this.boundLayoutVertexBuffer===_&&!j&&this.boundIndexBuffer===L&&this.boundVertexOffset===D&&this.boundDynamicVertexBuffer===F&&this.boundDynamicVertexBuffer2===$?(y.bindVertexArrayOES.set(this.vao),F&&F.bind(),L&&L.dynamicDraw&&L.bind(),$&&$.bind()):this.freshBind(b,_,C,L,D,F,$)},Ag.prototype.freshBind=function(y,b,_,C,L,D,F){var $,j=y.numAttributes,et=this.context,ut=et.gl;if(et.extVertexArrayObject)this.vao&&this.destroy(),this.vao=et.extVertexArrayObject.createVertexArrayOES(),et.bindVertexArrayOES.set(this.vao),$=0,this.boundProgram=y,this.boundLayoutVertexBuffer=b,this.boundPaintVertexBuffers=_,this.boundIndexBuffer=C,this.boundVertexOffset=L,this.boundDynamicVertexBuffer=D,this.boundDynamicVertexBuffer2=F;else{$=et.currentNumAttributes||0;for(var ht=j;ht<$;ht++)ut.disableVertexAttribArray(ht)}b.enableAttributes(ut,y);for(var dt=0,Ot=_;dt<Ot.length;dt+=1)Ot[dt].enableAttributes(ut,y);D&&D.enableAttributes(ut,y),F&&F.enableAttributes(ut,y),b.bind(),b.setVertexAttribPointers(ut,y,L);for(var At=0,$t=_;At<$t.length;At+=1){var Ct=$t[At];Ct.bind(),Ct.setVertexAttribPointers(ut,y,L)}D&&(D.bind(),D.setVertexAttribPointers(ut,y,L)),C&&C.bind(),F&&(F.bind(),F.setVertexAttribPointers(ut,y,L)),et.currentNumAttributes=j},Ag.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var io=function(y,b,_,C,L,D){var F=y.gl;this.program=F.createProgram();for(var $=R0(_.staticAttributes),j=C?C.getBinderAttributes():[],et=$.concat(j),ut=_.staticUniforms?R0(_.staticUniforms):[],ht=C?C.getBinderUniforms():[],dt=[],Ot=0,At=ut.concat(ht);Ot<At.length;Ot+=1){var $t=At[Ot];dt.indexOf($t)<0&&dt.push($t)}var Ct=C?C.defines():[];D&&Ct.push("#define OVERDRAW_INSPECTOR;");var zt=Ct.concat(tf.fragmentSource,_.fragmentSource).join(`
`),qt=Ct.concat(tf.vertexSource,_.vertexSource).join(`
`),se=F.createShader(F.FRAGMENT_SHADER);if(F.isContextLost())this.failedToCreate=!0;else{F.shaderSource(se,zt),F.compileShader(se),F.attachShader(this.program,se);var Ee=F.createShader(F.VERTEX_SHADER);if(F.isContextLost())this.failedToCreate=!0;else{F.shaderSource(Ee,qt),F.compileShader(Ee),F.attachShader(this.program,Ee),this.attributes={};var pe={};this.numAttributes=et.length;for(var Ae=0;Ae<this.numAttributes;Ae++)et[Ae]&&(F.bindAttribLocation(this.program,Ae,et[Ae]),this.attributes[et[Ae]]=Ae);F.linkProgram(this.program),F.deleteShader(Ee),F.deleteShader(se);for(var Ve=0;Ve<dt.length;Ve++){var cr=dt[Ve];if(cr&&!pe[cr]){var ar=F.getUniformLocation(this.program,cr);ar&&(pe[cr]=ar)}}this.fixedUniforms=L(y,pe),this.binderUniforms=C?C.getUniforms(y,pe):[]}}};function I0(y,b,_){var C=1/ga(_,1,b.transform.tileZoom),L=Math.pow(2,_.tileID.overscaledZ),D=_.tileSize*Math.pow(2,b.transform.tileZoom)/L,F=D*(_.tileID.canonical.x+_.tileID.wrap*L),$=D*_.tileID.canonical.y;return{u_image:0,u_texsize:_.imageAtlasTexture.size,u_scale:[C,y.fromScale,y.toScale],u_fade:y.t,u_pixel_coord_upper:[F>>16,$>>16],u_pixel_coord_lower:[65535&F,65535&$]}}io.prototype.draw=function(y,b,_,C,L,D,F,$,j,et,ut,ht,dt,Ot,At,$t){var Ct,zt=y.gl;if(!this.failedToCreate){for(var qt in y.program.set(this.program),y.setDepthMode(_),y.setStencilMode(C),y.setColorMode(L),y.setCullFace(D),this.fixedUniforms)this.fixedUniforms[qt].set(F[qt]);Ot&&Ot.setUniforms(y,this.binderUniforms,ht,{zoom:dt});for(var se=(Ct={},Ct[zt.LINES]=2,Ct[zt.TRIANGLES]=3,Ct[zt.LINE_STRIP]=1,Ct)[b],Ee=0,pe=ut.get();Ee<pe.length;Ee+=1){var Ae=pe[Ee],Ve=Ae.vaos||(Ae.vaos={});(Ve[$]||(Ve[$]=new Ag)).bind(y,this,j,Ot?Ot.getPaintVertexBuffers():[],et,Ae.vertexOffset,At,$t),zt.drawElements(b,Ae.primitiveLength*se,zt.UNSIGNED_SHORT,Ae.primitiveOffset*se*2)}}};var j_=function(y,b,_,C){var L=b.style.light,D=L.properties.get("position"),F=[D.x,D.y,D.z],$=o.create$1();L.properties.get("anchor")==="viewport"&&o.fromRotation($,-b.transform.angle),o.transformMat3(F,F,$);var j=L.properties.get("color");return{u_matrix:y,u_lightpos:F,u_lightintensity:L.properties.get("intensity"),u_lightcolor:[j.r,j.g,j.b],u_vertical_gradient:+_,u_opacity:C}},al=function(y,b,_,C,L,D,F){return o.extend(j_(y,b,_,C),I0(D,b,F),{u_height_factor:-Math.pow(2,L.overscaledZ)/F.tileSize/8})},ph=function(y){return{u_matrix:y}},yc=function(y,b,_,C){return o.extend(ph(y),I0(_,b,C))},af=function(y,b){return{u_matrix:y,u_world:b}},Mg=function(y,b,_,C,L){return o.extend(yc(y,b,_,C),{u_world:L})},ep=function(y,b,_,C){var L,D,F=y.transform;if(C.paint.get("circle-pitch-alignment")==="map"){var $=ga(_,1,F.zoom);L=!0,D=[$,$]}else L=!1,D=F.pixelsToGLUnits;return{u_camera_to_center_distance:F.cameraToCenterDistance,u_scale_with_map:+(C.paint.get("circle-pitch-scale")==="map"),u_matrix:y.translatePosMatrix(b.posMatrix,_,C.paint.get("circle-translate"),C.paint.get("circle-translate-anchor")),u_pitch_with_map:+L,u_device_pixel_ratio:o.browser.devicePixelRatio,u_extrude_scale:D}},Wu=function(y,b,_){var C=ga(_,1,b.zoom),L=Math.pow(2,b.zoom-_.tileID.overscaledZ),D=_.tileID.overscaleFactor();return{u_matrix:y,u_camera_to_center_distance:b.cameraToCenterDistance,u_pixels_to_tile_units:C,u_extrude_scale:[b.pixelsToGLUnits[0]/(C*L),b.pixelsToGLUnits[1]/(C*L)],u_overscale_factor:D}},dv=function(y,b,_){return{u_matrix:y,u_inv_matrix:b,u_camera_to_center_distance:_.cameraToCenterDistance,u_viewport_size:[_.width,_.height]}},of=function(y,b,_){return _===void 0&&(_=1),{u_matrix:y,u_color:b,u_overlay:0,u_overlay_scale:_}},vh=function(y){return{u_matrix:y}},L0=function(y,b,_,C){return{u_matrix:y,u_extrude_scale:ga(b,1,_),u_intensity:C}},pv=function(y,b,_){var C=y.transform;return{u_matrix:vv(y,b,_),u_ratio:1/ga(b,1,C.zoom),u_device_pixel_ratio:o.browser.devicePixelRatio,u_units_to_pixels:[1/C.pixelsToGLUnits[0],1/C.pixelsToGLUnits[1]]}},ba=function(y,b,_,C){return o.extend(pv(y,b,_),{u_image:0,u_image_height:C})},Rg=function(y,b,_,C){var L=y.transform,D=sf(b,L);return{u_matrix:vv(y,b,_),u_texsize:b.imageAtlasTexture.size,u_ratio:1/ga(b,1,L.zoom),u_device_pixel_ratio:o.browser.devicePixelRatio,u_image:0,u_scale:[D,C.fromScale,C.toScale],u_fade:C.t,u_units_to_pixels:[1/L.pixelsToGLUnits[0],1/L.pixelsToGLUnits[1]]}},Yb=function(y,b,_,C,L){var D=y.lineAtlas,F=sf(b,y.transform),$=_.layout.get("line-cap")==="round",j=D.getDash(C.from,$),et=D.getDash(C.to,$),ut=j.width*L.fromScale,ht=et.width*L.toScale;return o.extend(pv(y,b,_),{u_patternscale_a:[F/ut,-j.height/2],u_patternscale_b:[F/ht,-et.height/2],u_sdfgamma:D.width/(256*Math.min(ut,ht)*o.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:j.y,u_tex_y_b:et.y,u_mix:L.t})};function sf(y,b){return 1/ga(y,1,b.tileZoom)}function vv(y,b,_){return y.translatePosMatrix(b.tileID.posMatrix,b,_.paint.get("line-translate"),_.paint.get("line-translate-anchor"))}var O0=function(y,b,_,C,L){return{u_matrix:y,u_tl_parent:b,u_scale_parent:_,u_buffer_scale:1,u_fade_t:C.mix,u_opacity:C.opacity*L.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:L.paint.get("raster-brightness-min"),u_brightness_high:L.paint.get("raster-brightness-max"),u_saturation_factor:(F=L.paint.get("raster-saturation"),F>0?1-1/(1.001-F):-F),u_contrast_factor:(D=L.paint.get("raster-contrast"),D>0?1/(1-D):1+D),u_spin_weights:Ig(L.paint.get("raster-hue-rotate"))};var D,F};function Ig(y){y*=Math.PI/180;var b=Math.sin(y),_=Math.cos(y);return[(2*_+1)/3,(-Math.sqrt(3)*b-_+1)/3,(Math.sqrt(3)*b-_+1)/3]}var gh,lf=function(y,b,_,C,L,D,F,$,j,et){var ut=L.transform;return{u_is_size_zoom_constant:+(y==="constant"||y==="source"),u_is_size_feature_constant:+(y==="constant"||y==="camera"),u_size_t:b?b.uSizeT:0,u_size:b?b.uSize:0,u_camera_to_center_distance:ut.cameraToCenterDistance,u_pitch:ut.pitch/360*2*Math.PI,u_rotate_symbol:+_,u_aspect_ratio:ut.width/ut.height,u_fade_change:L.options.fadeDuration?L.symbolFadeChange:1,u_matrix:D,u_label_plane_matrix:F,u_coord_matrix:$,u_is_text:+j,u_pitch_with_map:+C,u_texsize:et,u_texture:0}},od=function(y,b,_,C,L,D,F,$,j,et,ut){var ht=L.transform;return o.extend(lf(y,b,_,C,L,D,F,$,j,et),{u_gamma_scale:C?Math.cos(ht._pitch)*ht.cameraToCenterDistance:1,u_device_pixel_ratio:o.browser.devicePixelRatio,u_is_halo:+ut})},rp=function(y,b,_,C,L,D,F,$,j,et){return o.extend(od(y,b,_,C,L,D,F,$,!0,j,!0),{u_texsize_icon:et,u_texture_icon:1})},sd=function(y,b,_){return{u_matrix:y,u_opacity:b,u_color:_}},ld=function(y,b,_,C,L,D){return o.extend(function(F,$,j,et){var ut=j.imageManager.getPattern(F.from.toString()),ht=j.imageManager.getPattern(F.to.toString()),dt=j.imageManager.getPixelSize(),Ot=dt.width,At=dt.height,$t=Math.pow(2,et.tileID.overscaledZ),Ct=et.tileSize*Math.pow(2,j.transform.tileZoom)/$t,zt=Ct*(et.tileID.canonical.x+et.tileID.wrap*$t),qt=Ct*et.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:ut.tl,u_pattern_br_a:ut.br,u_pattern_tl_b:ht.tl,u_pattern_br_b:ht.br,u_texsize:[Ot,At],u_mix:$.t,u_pattern_size_a:ut.displaySize,u_pattern_size_b:ht.displaySize,u_scale_a:$.fromScale,u_scale_b:$.toScale,u_tile_units_to_pixels:1/ga(et,1,j.transform.tileZoom),u_pixel_coord_upper:[zt>>16,qt>>16],u_pixel_coord_lower:[65535&zt,65535&qt]}}(C,D,_,L),{u_matrix:y,u_opacity:b})},P0={fillExtrusion:function(y,b){return{u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_lightpos:new o.Uniform3f(y,b.u_lightpos),u_lightintensity:new o.Uniform1f(y,b.u_lightintensity),u_lightcolor:new o.Uniform3f(y,b.u_lightcolor),u_vertical_gradient:new o.Uniform1f(y,b.u_vertical_gradient),u_opacity:new o.Uniform1f(y,b.u_opacity)}},fillExtrusionPattern:function(y,b){return{u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_lightpos:new o.Uniform3f(y,b.u_lightpos),u_lightintensity:new o.Uniform1f(y,b.u_lightintensity),u_lightcolor:new o.Uniform3f(y,b.u_lightcolor),u_vertical_gradient:new o.Uniform1f(y,b.u_vertical_gradient),u_height_factor:new o.Uniform1f(y,b.u_height_factor),u_image:new o.Uniform1i(y,b.u_image),u_texsize:new o.Uniform2f(y,b.u_texsize),u_pixel_coord_upper:new o.Uniform2f(y,b.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(y,b.u_pixel_coord_lower),u_scale:new o.Uniform3f(y,b.u_scale),u_fade:new o.Uniform1f(y,b.u_fade),u_opacity:new o.Uniform1f(y,b.u_opacity)}},fill:function(y,b){return{u_matrix:new o.UniformMatrix4f(y,b.u_matrix)}},fillPattern:function(y,b){return{u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_image:new o.Uniform1i(y,b.u_image),u_texsize:new o.Uniform2f(y,b.u_texsize),u_pixel_coord_upper:new o.Uniform2f(y,b.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(y,b.u_pixel_coord_lower),u_scale:new o.Uniform3f(y,b.u_scale),u_fade:new o.Uniform1f(y,b.u_fade)}},fillOutline:function(y,b){return{u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_world:new o.Uniform2f(y,b.u_world)}},fillOutlinePattern:function(y,b){return{u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_world:new o.Uniform2f(y,b.u_world),u_image:new o.Uniform1i(y,b.u_image),u_texsize:new o.Uniform2f(y,b.u_texsize),u_pixel_coord_upper:new o.Uniform2f(y,b.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(y,b.u_pixel_coord_lower),u_scale:new o.Uniform3f(y,b.u_scale),u_fade:new o.Uniform1f(y,b.u_fade)}},circle:function(y,b){return{u_camera_to_center_distance:new o.Uniform1f(y,b.u_camera_to_center_distance),u_scale_with_map:new o.Uniform1i(y,b.u_scale_with_map),u_pitch_with_map:new o.Uniform1i(y,b.u_pitch_with_map),u_extrude_scale:new o.Uniform2f(y,b.u_extrude_scale),u_device_pixel_ratio:new o.Uniform1f(y,b.u_device_pixel_ratio),u_matrix:new o.UniformMatrix4f(y,b.u_matrix)}},collisionBox:function(y,b){return{u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_camera_to_center_distance:new o.Uniform1f(y,b.u_camera_to_center_distance),u_pixels_to_tile_units:new o.Uniform1f(y,b.u_pixels_to_tile_units),u_extrude_scale:new o.Uniform2f(y,b.u_extrude_scale),u_overscale_factor:new o.Uniform1f(y,b.u_overscale_factor)}},collisionCircle:function(y,b){return{u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_inv_matrix:new o.UniformMatrix4f(y,b.u_inv_matrix),u_camera_to_center_distance:new o.Uniform1f(y,b.u_camera_to_center_distance),u_viewport_size:new o.Uniform2f(y,b.u_viewport_size)}},debug:function(y,b){return{u_color:new o.UniformColor(y,b.u_color),u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_overlay:new o.Uniform1i(y,b.u_overlay),u_overlay_scale:new o.Uniform1f(y,b.u_overlay_scale)}},clippingMask:function(y,b){return{u_matrix:new o.UniformMatrix4f(y,b.u_matrix)}},heatmap:function(y,b){return{u_extrude_scale:new o.Uniform1f(y,b.u_extrude_scale),u_intensity:new o.Uniform1f(y,b.u_intensity),u_matrix:new o.UniformMatrix4f(y,b.u_matrix)}},heatmapTexture:function(y,b){return{u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_world:new o.Uniform2f(y,b.u_world),u_image:new o.Uniform1i(y,b.u_image),u_color_ramp:new o.Uniform1i(y,b.u_color_ramp),u_opacity:new o.Uniform1f(y,b.u_opacity)}},hillshade:function(y,b){return{u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_image:new o.Uniform1i(y,b.u_image),u_latrange:new o.Uniform2f(y,b.u_latrange),u_light:new o.Uniform2f(y,b.u_light),u_shadow:new o.UniformColor(y,b.u_shadow),u_highlight:new o.UniformColor(y,b.u_highlight),u_accent:new o.UniformColor(y,b.u_accent)}},hillshadePrepare:function(y,b){return{u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_image:new o.Uniform1i(y,b.u_image),u_dimension:new o.Uniform2f(y,b.u_dimension),u_zoom:new o.Uniform1f(y,b.u_zoom),u_unpack:new o.Uniform4f(y,b.u_unpack)}},line:function(y,b){return{u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_ratio:new o.Uniform1f(y,b.u_ratio),u_device_pixel_ratio:new o.Uniform1f(y,b.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(y,b.u_units_to_pixels)}},lineGradient:function(y,b){return{u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_ratio:new o.Uniform1f(y,b.u_ratio),u_device_pixel_ratio:new o.Uniform1f(y,b.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(y,b.u_units_to_pixels),u_image:new o.Uniform1i(y,b.u_image),u_image_height:new o.Uniform1f(y,b.u_image_height)}},linePattern:function(y,b){return{u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_texsize:new o.Uniform2f(y,b.u_texsize),u_ratio:new o.Uniform1f(y,b.u_ratio),u_device_pixel_ratio:new o.Uniform1f(y,b.u_device_pixel_ratio),u_image:new o.Uniform1i(y,b.u_image),u_units_to_pixels:new o.Uniform2f(y,b.u_units_to_pixels),u_scale:new o.Uniform3f(y,b.u_scale),u_fade:new o.Uniform1f(y,b.u_fade)}},lineSDF:function(y,b){return{u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_ratio:new o.Uniform1f(y,b.u_ratio),u_device_pixel_ratio:new o.Uniform1f(y,b.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(y,b.u_units_to_pixels),u_patternscale_a:new o.Uniform2f(y,b.u_patternscale_a),u_patternscale_b:new o.Uniform2f(y,b.u_patternscale_b),u_sdfgamma:new o.Uniform1f(y,b.u_sdfgamma),u_image:new o.Uniform1i(y,b.u_image),u_tex_y_a:new o.Uniform1f(y,b.u_tex_y_a),u_tex_y_b:new o.Uniform1f(y,b.u_tex_y_b),u_mix:new o.Uniform1f(y,b.u_mix)}},raster:function(y,b){return{u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_tl_parent:new o.Uniform2f(y,b.u_tl_parent),u_scale_parent:new o.Uniform1f(y,b.u_scale_parent),u_buffer_scale:new o.Uniform1f(y,b.u_buffer_scale),u_fade_t:new o.Uniform1f(y,b.u_fade_t),u_opacity:new o.Uniform1f(y,b.u_opacity),u_image0:new o.Uniform1i(y,b.u_image0),u_image1:new o.Uniform1i(y,b.u_image1),u_brightness_low:new o.Uniform1f(y,b.u_brightness_low),u_brightness_high:new o.Uniform1f(y,b.u_brightness_high),u_saturation_factor:new o.Uniform1f(y,b.u_saturation_factor),u_contrast_factor:new o.Uniform1f(y,b.u_contrast_factor),u_spin_weights:new o.Uniform3f(y,b.u_spin_weights)}},symbolIcon:function(y,b){return{u_is_size_zoom_constant:new o.Uniform1i(y,b.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(y,b.u_is_size_feature_constant),u_size_t:new o.Uniform1f(y,b.u_size_t),u_size:new o.Uniform1f(y,b.u_size),u_camera_to_center_distance:new o.Uniform1f(y,b.u_camera_to_center_distance),u_pitch:new o.Uniform1f(y,b.u_pitch),u_rotate_symbol:new o.Uniform1i(y,b.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(y,b.u_aspect_ratio),u_fade_change:new o.Uniform1f(y,b.u_fade_change),u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(y,b.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(y,b.u_coord_matrix),u_is_text:new o.Uniform1i(y,b.u_is_text),u_pitch_with_map:new o.Uniform1i(y,b.u_pitch_with_map),u_texsize:new o.Uniform2f(y,b.u_texsize),u_texture:new o.Uniform1i(y,b.u_texture)}},symbolSDF:function(y,b){return{u_is_size_zoom_constant:new o.Uniform1i(y,b.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(y,b.u_is_size_feature_constant),u_size_t:new o.Uniform1f(y,b.u_size_t),u_size:new o.Uniform1f(y,b.u_size),u_camera_to_center_distance:new o.Uniform1f(y,b.u_camera_to_center_distance),u_pitch:new o.Uniform1f(y,b.u_pitch),u_rotate_symbol:new o.Uniform1i(y,b.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(y,b.u_aspect_ratio),u_fade_change:new o.Uniform1f(y,b.u_fade_change),u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(y,b.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(y,b.u_coord_matrix),u_is_text:new o.Uniform1i(y,b.u_is_text),u_pitch_with_map:new o.Uniform1i(y,b.u_pitch_with_map),u_texsize:new o.Uniform2f(y,b.u_texsize),u_texture:new o.Uniform1i(y,b.u_texture),u_gamma_scale:new o.Uniform1f(y,b.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(y,b.u_device_pixel_ratio),u_is_halo:new o.Uniform1i(y,b.u_is_halo)}},symbolTextAndIcon:function(y,b){return{u_is_size_zoom_constant:new o.Uniform1i(y,b.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(y,b.u_is_size_feature_constant),u_size_t:new o.Uniform1f(y,b.u_size_t),u_size:new o.Uniform1f(y,b.u_size),u_camera_to_center_distance:new o.Uniform1f(y,b.u_camera_to_center_distance),u_pitch:new o.Uniform1f(y,b.u_pitch),u_rotate_symbol:new o.Uniform1i(y,b.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(y,b.u_aspect_ratio),u_fade_change:new o.Uniform1f(y,b.u_fade_change),u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(y,b.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(y,b.u_coord_matrix),u_is_text:new o.Uniform1i(y,b.u_is_text),u_pitch_with_map:new o.Uniform1i(y,b.u_pitch_with_map),u_texsize:new o.Uniform2f(y,b.u_texsize),u_texsize_icon:new o.Uniform2f(y,b.u_texsize_icon),u_texture:new o.Uniform1i(y,b.u_texture),u_texture_icon:new o.Uniform1i(y,b.u_texture_icon),u_gamma_scale:new o.Uniform1f(y,b.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(y,b.u_device_pixel_ratio),u_is_halo:new o.Uniform1i(y,b.u_is_halo)}},background:function(y,b){return{u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_opacity:new o.Uniform1f(y,b.u_opacity),u_color:new o.UniformColor(y,b.u_color)}},backgroundPattern:function(y,b){return{u_matrix:new o.UniformMatrix4f(y,b.u_matrix),u_opacity:new o.Uniform1f(y,b.u_opacity),u_image:new o.Uniform1i(y,b.u_image),u_pattern_tl_a:new o.Uniform2f(y,b.u_pattern_tl_a),u_pattern_br_a:new o.Uniform2f(y,b.u_pattern_br_a),u_pattern_tl_b:new o.Uniform2f(y,b.u_pattern_tl_b),u_pattern_br_b:new o.Uniform2f(y,b.u_pattern_br_b),u_texsize:new o.Uniform2f(y,b.u_texsize),u_mix:new o.Uniform1f(y,b.u_mix),u_pattern_size_a:new o.Uniform2f(y,b.u_pattern_size_a),u_pattern_size_b:new o.Uniform2f(y,b.u_pattern_size_b),u_scale_a:new o.Uniform1f(y,b.u_scale_a),u_scale_b:new o.Uniform1f(y,b.u_scale_b),u_pixel_coord_upper:new o.Uniform2f(y,b.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(y,b.u_pixel_coord_lower),u_tile_units_to_pixels:new o.Uniform1f(y,b.u_tile_units_to_pixels)}}};function ud(y,b,_,C,L,D,F){for(var $=y.context,j=$.gl,et=y.useProgram("collisionBox"),ut=[],ht=0,dt=0,Ot=0;Ot<C.length;Ot++){var At=C[Ot],$t=b.getTile(At),Ct=$t.getBucket(_);if(Ct){var zt=At.posMatrix;L[0]===0&&L[1]===0||(zt=y.translatePosMatrix(At.posMatrix,$t,L,D));var qt=F?Ct.textCollisionBox:Ct.iconCollisionBox,se=Ct.collisionCircleArray;if(se.length>0){var Ee=o.create(),pe=zt;o.mul(Ee,Ct.placementInvProjMatrix,y.transform.glCoordMatrix),o.mul(Ee,Ee,Ct.placementViewportMatrix),ut.push({circleArray:se,circleOffset:dt,transform:pe,invTransform:Ee}),dt=ht+=se.length/4}qt&&et.draw($,j.LINES,mt.disabled,Mt.disabled,y.colorModeForRenderPass(),Qt.disabled,Wu(zt,y.transform,$t),_.id,qt.layoutVertexBuffer,qt.indexBuffer,qt.segments,null,y.transform.zoom,null,null,qt.collisionVertexBuffer)}}if(F&&ut.length){var Ae=y.useProgram("collisionCircle"),Ve=new o.StructArrayLayout2f1f2i16;Ve.resize(4*ht),Ve._trim();for(var cr=0,ar=0,Mr=ut;ar<Mr.length;ar+=1)for(var sn=Mr[ar],hn=0;hn<sn.circleArray.length/4;hn++){var cn=4*hn,Ii=sn.circleArray[cn+0],kr=sn.circleArray[cn+1],Ln=sn.circleArray[cn+2],Xn=sn.circleArray[cn+3];Ve.emplace(cr++,Ii,kr,Ln,Xn,0),Ve.emplace(cr++,Ii,kr,Ln,Xn,1),Ve.emplace(cr++,Ii,kr,Ln,Xn,2),Ve.emplace(cr++,Ii,kr,Ln,Xn,3)}(!gh||gh.length<2*ht)&&(gh=function(ja){var fs=2*ja,Xo=new o.StructArrayLayout3ui6;Xo.resize(fs),Xo._trim();for(var Ga=0;Ga<fs;Ga++){var Ya=6*Ga;Xo.uint16[Ya+0]=4*Ga+0,Xo.uint16[Ya+1]=4*Ga+1,Xo.uint16[Ya+2]=4*Ga+2,Xo.uint16[Ya+3]=4*Ga+2,Xo.uint16[Ya+4]=4*Ga+3,Xo.uint16[Ya+5]=4*Ga+0}return Xo}(ht));for(var Rn=$.createIndexBuffer(gh,!0),Cn=$.createVertexBuffer(Ve,o.collisionCircleLayout.members,!0),$n=0,Sn=ut;$n<Sn.length;$n+=1){var bn=Sn[$n],Mo=dv(bn.transform,bn.invTransform,y.transform);Ae.draw($,j.TRIANGLES,mt.disabled,Mt.disabled,y.colorModeForRenderPass(),Qt.disabled,Mo,_.id,Cn,Rn,o.SegmentVector.simpleSegment(0,2*bn.circleOffset,bn.circleArray.length,bn.circleArray.length/2),null,y.transform.zoom,null,null,null)}Cn.destroy(),Rn.destroy()}}var xu=o.identity(new Float32Array(16));function D0(y,b,_,C,L,D){var F=o.getAnchorAlignment(y),$=-(F.horizontalAlign-.5)*b,j=-(F.verticalAlign-.5)*_,et=o.evaluateVariableOffset(y,C);return new o.Point(($/L+et[0])*D,(j/L+et[1])*D)}function F0(y,b,_,C,L,D,F,$,j,et,ut){var ht=y.text.placedSymbolArray,dt=y.text.dynamicLayoutVertexArray,Ot=y.icon.dynamicLayoutVertexArray,At={};dt.clear();for(var $t=0;$t<ht.length;$t++){var Ct=ht.get($t),zt=Ct.hidden||!Ct.crossTileID||y.allowVerticalPlacement&&!Ct.placedOrientation?null:C[Ct.crossTileID];if(zt){var qt=new o.Point(Ct.anchorX,Ct.anchorY),se=Un(qt,_?$:F),Ee=oi(D.cameraToCenterDistance,se.signedDistanceFromCamera),pe=L.evaluateSizeForFeature(y.textSizeData,et,Ct)*Ee/o.ONE_EM;_&&(pe*=y.tilePixelRatio/j);for(var Ae=D0(zt.anchor,zt.width,zt.height,zt.textOffset,zt.textBoxScale,pe),Ve=_?Un(qt.add(Ae),F).point:se.point.add(b?Ae.rotate(-D.angle):Ae),cr=y.allowVerticalPlacement&&Ct.placedOrientation===o.WritingMode.vertical?Math.PI/2:0,ar=0;ar<Ct.numGlyphs;ar++)o.addDynamicAttributes(dt,Ve,cr);ut&&Ct.associatedIconIndex>=0&&(At[Ct.associatedIconIndex]={shiftedAnchor:Ve,angle:cr})}else Ho(Ct.numGlyphs,dt)}if(ut){Ot.clear();for(var Mr=y.icon.placedSymbolArray,sn=0;sn<Mr.length;sn++){var hn=Mr.get(sn);if(hn.hidden)Ho(hn.numGlyphs,Ot);else{var cn=At[sn];if(cn)for(var Ii=0;Ii<hn.numGlyphs;Ii++)o.addDynamicAttributes(Ot,cn.shiftedAnchor,cn.angle);else Ho(hn.numGlyphs,Ot)}}y.icon.dynamicLayoutVertexBuffer.updateData(Ot)}y.text.dynamicLayoutVertexBuffer.updateData(dt)}function B0(y,b,_){return _.iconsInText&&b?"symbolTextAndIcon":y?"symbolSDF":"symbolIcon"}function uf(y,b,_,C,L,D,F,$,j,et,ut,ht){for(var dt=y.context,Ot=dt.gl,At=y.transform,$t=$==="map",Ct=j==="map",zt=$t&&_.layout.get("symbol-placement")!=="point",qt=$t&&!Ct&&!zt,se=_.layout.get("symbol-sort-key").constantOr(1)!==void 0,Ee=!1,pe=y.depthModeForSublayer(0,mt.ReadOnly),Ae=_.layout.get("text-variable-anchor"),Ve=[],cr=0,ar=C;cr<ar.length;cr+=1){var Mr=ar[cr],sn=b.getTile(Mr),hn=sn.getBucket(_);if(hn){var cn=L?hn.text:hn.icon;if(cn&&cn.segments.get().length){var Ii=cn.programConfigurations.get(_.id),kr=L||hn.sdfIcons,Ln=L?hn.textSizeData:hn.iconSizeData,Xn=Ct||At.pitch!==0,Rn=y.useProgram(B0(kr,L,hn),Ii),Cn=o.evaluateSizeForZoom(Ln,At.zoom),$n=void 0,Sn=[0,0],bn=void 0,Mo=void 0,ja=null,fs=void 0;if(L)bn=sn.glyphAtlasTexture,Mo=Ot.LINEAR,$n=sn.glyphAtlasTexture.size,hn.iconsInText&&(Sn=sn.imageAtlasTexture.size,ja=sn.imageAtlasTexture,fs=Xn||y.options.rotating||y.options.zooming||Ln.kind==="composite"||Ln.kind==="camera"?Ot.LINEAR:Ot.NEAREST);else{var Xo=_.layout.get("icon-size").constantOr(0)!==1||hn.iconsNeedLinear;bn=sn.imageAtlasTexture,Mo=kr||y.options.rotating||y.options.zooming||Xo||Xn?Ot.LINEAR:Ot.NEAREST,$n=sn.imageAtlasTexture.size}var Ga=ga(sn,1,y.transform.zoom),Ya=ra(Mr.posMatrix,Ct,$t,y.transform,Ga),Zs=Di(Mr.posMatrix,Ct,$t,y.transform,Ga),Ns=Ae&&hn.hasTextData(),Cc=_.layout.get("icon-text-fit")!=="none"&&Ns&&hn.hasIconData();zt&&qh(hn,Mr.posMatrix,y,L,Ya,Zs,Ct,et);var qs=y.translatePosMatrix(Mr.posMatrix,sn,D,F),Su=zt||L&&Ae||Cc?xu:Ya,Ll=y.translatePosMatrix(Zs,sn,D,F,!0),hp=kr&&_.paint.get(L?"text-halo-width":"icon-halo-width").constantOr(1)!==0,pd={program:Rn,buffers:cn,uniformValues:kr?hn.iconsInText?rp(Ln.kind,Cn,qt,Ct,y,qs,Su,Ll,$n,Sn):od(Ln.kind,Cn,qt,Ct,y,qs,Su,Ll,L,$n,!0):lf(Ln.kind,Cn,qt,Ct,y,qs,Su,Ll,L,$n),atlasTexture:bn,atlasTextureIcon:ja,atlasInterpolation:Mo,atlasInterpolationIcon:fs,isSDF:kr,hasHalo:hp};if(se&&hn.canOverlap){Ee=!0;for(var Sc=0,mf=cn.segments.get();Sc<mf.length;Sc+=1){var bh=mf[Sc];Ve.push({segments:new o.SegmentVector([bh]),sortKey:bh.sortKey,state:pd})}}else Ve.push({segments:cn.segments,sortKey:0,state:pd})}}}Ee&&Ve.sort(function(Tu,Zu){return Tu.sortKey-Zu.sortKey});for(var Yu=0,yf=Ve;Yu<yf.length;Yu+=1){var Ss=yf[Yu],ao=Ss.state;if(dt.activeTexture.set(Ot.TEXTURE0),ao.atlasTexture.bind(ao.atlasInterpolation,Ot.CLAMP_TO_EDGE),ao.atlasTextureIcon&&(dt.activeTexture.set(Ot.TEXTURE1),ao.atlasTextureIcon&&ao.atlasTextureIcon.bind(ao.atlasInterpolationIcon,Ot.CLAMP_TO_EDGE)),ao.isSDF){var sl=ao.uniformValues;ao.hasHalo&&(sl.u_is_halo=1,_c(ao.buffers,Ss.segments,_,y,ao.program,pe,ut,ht,sl)),sl.u_is_halo=0}_c(ao.buffers,Ss.segments,_,y,ao.program,pe,ut,ht,ao.uniformValues)}}function _c(y,b,_,C,L,D,F,$,j){var et=C.context;L.draw(et,et.gl.TRIANGLES,D,F,$,Qt.disabled,j,_.id,y.layoutVertexBuffer,y.indexBuffer,b,_.paint,C.transform.zoom,y.programConfigurations.get(_.id),y.dynamicLayoutVertexBuffer,y.opacityVertexBuffer)}function np(y,b,_,C,L,D,F){var $,j,et,ut,ht,dt=y.context.gl,Ot=_.paint.get("fill-pattern"),At=Ot&&Ot.constantOr(1),$t=_.getCrossfadeParameters();F?(j=At&&!_.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",$=dt.LINES):(j=At?"fillPattern":"fill",$=dt.TRIANGLES);for(var Ct=0,zt=C;Ct<zt.length;Ct+=1){var qt=zt[Ct],se=b.getTile(qt);if(!At||se.patternsLoaded()){var Ee=se.getBucket(_);if(Ee){var pe=Ee.programConfigurations.get(_.id),Ae=y.useProgram(j,pe);At&&(y.context.activeTexture.set(dt.TEXTURE0),se.imageAtlasTexture.bind(dt.LINEAR,dt.CLAMP_TO_EDGE),pe.updatePaintBuffers($t));var Ve=Ot.constantOr(null);if(Ve&&se.imageAtlas){var cr=se.imageAtlas,ar=cr.patternPositions[Ve.to.toString()],Mr=cr.patternPositions[Ve.from.toString()];ar&&Mr&&pe.setConstantPatternPositions(ar,Mr)}var sn=y.translatePosMatrix(qt.posMatrix,se,_.paint.get("fill-translate"),_.paint.get("fill-translate-anchor"));if(F){ut=Ee.indexBuffer2,ht=Ee.segments2;var hn=[dt.drawingBufferWidth,dt.drawingBufferHeight];et=j==="fillOutlinePattern"&&At?Mg(sn,y,$t,se,hn):af(sn,hn)}else ut=Ee.indexBuffer,ht=Ee.segments,et=At?yc(sn,y,$t,se):ph(sn);Ae.draw(y.context,$,L,y.stencilModeForClipping(qt),D,Qt.disabled,et,_.id,Ee.layoutVertexBuffer,ut,ht,_.paint,y.transform.zoom,pe)}}}}function gv(y,b,_,C,L,D,F){for(var $=y.context,j=$.gl,et=_.paint.get("fill-extrusion-pattern"),ut=et.constantOr(1),ht=_.getCrossfadeParameters(),dt=_.paint.get("fill-extrusion-opacity"),Ot=0,At=C;Ot<At.length;Ot+=1){var $t=At[Ot],Ct=b.getTile($t),zt=Ct.getBucket(_);if(zt){var qt=zt.programConfigurations.get(_.id),se=y.useProgram(ut?"fillExtrusionPattern":"fillExtrusion",qt);ut&&(y.context.activeTexture.set(j.TEXTURE0),Ct.imageAtlasTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE),qt.updatePaintBuffers(ht));var Ee=et.constantOr(null);if(Ee&&Ct.imageAtlas){var pe=Ct.imageAtlas,Ae=pe.patternPositions[Ee.to.toString()],Ve=pe.patternPositions[Ee.from.toString()];Ae&&Ve&&qt.setConstantPatternPositions(Ae,Ve)}var cr=y.translatePosMatrix($t.posMatrix,Ct,_.paint.get("fill-extrusion-translate"),_.paint.get("fill-extrusion-translate-anchor")),ar=_.paint.get("fill-extrusion-vertical-gradient"),Mr=ut?al(cr,y,ar,dt,$t,ht,Ct):j_(cr,y,ar,dt);se.draw($,$.gl.TRIANGLES,L,D,F,Qt.backCCW,Mr,_.id,zt.layoutVertexBuffer,zt.indexBuffer,zt.segments,_.paint,y.transform.zoom,qt)}}}function cf(y,b,_,C,L,D){var F=y.context,$=F.gl,j=b.fbo;if(j){var et=y.useProgram("hillshade");F.activeTexture.set($.TEXTURE0),$.bindTexture($.TEXTURE_2D,j.colorAttachment.get());var ut=function(ht,dt,Ot){var At=Ot.paint.get("hillshade-shadow-color"),$t=Ot.paint.get("hillshade-highlight-color"),Ct=Ot.paint.get("hillshade-accent-color"),zt=Ot.paint.get("hillshade-illumination-direction")*(Math.PI/180);Ot.paint.get("hillshade-illumination-anchor")==="viewport"&&(zt-=ht.transform.angle);var qt,se,Ee,pe=!ht.options.moving;return{u_matrix:ht.transform.calculatePosMatrix(dt.tileID.toUnwrapped(),pe),u_image:0,u_latrange:(qt=dt.tileID,se=Math.pow(2,qt.canonical.z),Ee=qt.canonical.y,[new o.MercatorCoordinate(0,Ee/se).toLngLat().lat,new o.MercatorCoordinate(0,(Ee+1)/se).toLngLat().lat]),u_light:[Ot.paint.get("hillshade-exaggeration"),zt],u_shadow:At,u_highlight:$t,u_accent:Ct}}(y,b,_);et.draw(F,$.TRIANGLES,C,L,D,Qt.disabled,ut,_.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments)}}function Zb(y,b,_,C,L,D){var F=y.context,$=F.gl,j=b.dem;if(j&&j.data){var et=j.dim,ut=j.stride,ht=j.getPixels();if(F.activeTexture.set($.TEXTURE1),F.pixelStoreUnpackPremultiplyAlpha.set(!1),b.demTexture=b.demTexture||y.getTileTexture(ut),b.demTexture){var dt=b.demTexture;dt.update(ht,{premultiply:!1}),dt.bind($.NEAREST,$.CLAMP_TO_EDGE)}else b.demTexture=new o.Texture(F,ht,$.RGBA,{premultiply:!1}),b.demTexture.bind($.NEAREST,$.CLAMP_TO_EDGE);F.activeTexture.set($.TEXTURE0);var Ot=b.fbo;if(!Ot){var At=new o.Texture(F,{width:et,height:et,data:null},$.RGBA);At.bind($.LINEAR,$.CLAMP_TO_EDGE),(Ot=b.fbo=F.createFramebuffer(et,et,!0)).colorAttachment.set(At.texture)}F.bindFramebuffer.set(Ot.framebuffer),F.viewport.set([0,0,et,et]),y.useProgram("hillshadePrepare").draw(F,$.TRIANGLES,C,L,D,Qt.disabled,function($t,Ct){var zt=Ct.stride,qt=o.create();return o.ortho(qt,0,o.EXTENT,-o.EXTENT,0,0,1),o.translate(qt,qt,[0,-o.EXTENT,0]),{u_matrix:qt,u_image:1,u_dimension:[zt,zt],u_zoom:$t.overscaledZ,u_unpack:Ct.getUnpackVector()}}(b.tileID,j),_.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments),b.needsHillshadePrepare=!1}}function Lg(y,b,_,C,L){var D=C.paint.get("raster-fade-duration");if(D>0){var F=o.browser.now(),$=(F-y.timeAdded)/D,j=b?(F-b.timeAdded)/D:-1,et=_.getSource(),ut=L.coveringZoomLevel({tileSize:et.tileSize,roundZoom:et.roundZoom}),ht=!b||Math.abs(b.tileID.overscaledZ-ut)>Math.abs(y.tileID.overscaledZ-ut),dt=ht&&y.refreshedUponExpiration?1:o.clamp(ht?$:1-j,0,1);return y.refreshedUponExpiration&&$>=1&&(y.refreshedUponExpiration=!1),b?{opacity:1,mix:1-dt}:{opacity:dt,mix:0}}return{opacity:1,mix:0}}var N0=new o.Color(1,0,0,1),Og=new o.Color(0,1,0,1),Y_=new o.Color(0,0,1,1),Pg=new o.Color(1,0,1,1),k0=new o.Color(0,1,1,1);function mv(y,b,_,C){cd(y,0,b+_/2,y.transform.width,_,C)}function z0(y,b,_,C){cd(y,b-_/2,0,_,y.transform.height,C)}function cd(y,b,_,C,L,D){var F=y.context,$=F.gl;$.enable($.SCISSOR_TEST),$.scissor(b*o.browser.devicePixelRatio,_*o.browser.devicePixelRatio,C*o.browser.devicePixelRatio,L*o.browser.devicePixelRatio),F.clear({color:D}),$.disable($.SCISSOR_TEST)}function U0(y,b,_){var C=y.context,L=C.gl,D=_.posMatrix,F=y.useProgram("debug"),$=mt.disabled,j=Mt.disabled,et=y.colorModeForRenderPass();C.activeTexture.set(L.TEXTURE0),y.emptyTexture.bind(L.LINEAR,L.CLAMP_TO_EDGE),F.draw(C,L.LINE_STRIP,$,j,et,Qt.disabled,of(D,o.Color.red),"$debug",y.debugBuffer,y.tileBorderIndexBuffer,y.debugSegments);var ut=b.getTileByID(_.key).latestRawTileData,ht=Math.floor((ut&&ut.byteLength||0)/1024),dt=b.getTile(_).tileSize,Ot=512/Math.min(dt,512)*(_.overscaledZ/y.transform.zoom)*.5,At=_.canonical.toString();_.overscaledZ!==_.canonical.z&&(At+=" => "+_.overscaledZ),function($t,Ct){$t.initDebugOverlayCanvas();var zt=$t.debugOverlayCanvas,qt=$t.context.gl,se=$t.debugOverlayCanvas.getContext("2d");se.clearRect(0,0,zt.width,zt.height),se.shadowColor="white",se.shadowBlur=2,se.lineWidth=1.5,se.strokeStyle="white",se.textBaseline="top",se.font="bold 36px Open Sans, sans-serif",se.fillText(Ct,5,5),se.strokeText(Ct,5,5),$t.debugOverlayTexture.update(zt),$t.debugOverlayTexture.bind(qt.LINEAR,qt.CLAMP_TO_EDGE)}(y,At+" "+ht+"kb"),F.draw(C,L.TRIANGLES,$,j,Xt.alphaBlended,Qt.disabled,of(D,o.Color.transparent,Ot),"$debug",y.debugBuffer,y.quadTriangleIndexBuffer,y.debugSegments)}var hf={symbol:function(y,b,_,C,L){if(y.renderPass==="translucent"){var D=Mt.disabled,F=y.colorModeForRenderPass();_.layout.get("text-variable-anchor")&&function($,j,et,ut,ht,dt,Ot){for(var At=j.transform,$t=ht==="map",Ct=dt==="map",zt=0,qt=$;zt<qt.length;zt+=1){var se=qt[zt],Ee=ut.getTile(se),pe=Ee.getBucket(et);if(pe&&pe.text&&pe.text.segments.get().length){var Ae=o.evaluateSizeForZoom(pe.textSizeData,At.zoom),Ve=ga(Ee,1,j.transform.zoom),cr=ra(se.posMatrix,Ct,$t,j.transform,Ve),ar=et.layout.get("icon-text-fit")!=="none"&&pe.hasIconData();if(Ae){var Mr=Math.pow(2,At.zoom-Ee.tileID.overscaledZ);F0(pe,$t,Ct,Ot,o.symbolSize,At,cr,se.posMatrix,Mr,Ae,ar)}}}}(C,y,_,b,_.layout.get("text-rotation-alignment"),_.layout.get("text-pitch-alignment"),L),_.paint.get("icon-opacity").constantOr(1)!==0&&uf(y,b,_,C,!1,_.paint.get("icon-translate"),_.paint.get("icon-translate-anchor"),_.layout.get("icon-rotation-alignment"),_.layout.get("icon-pitch-alignment"),_.layout.get("icon-keep-upright"),D,F),_.paint.get("text-opacity").constantOr(1)!==0&&uf(y,b,_,C,!0,_.paint.get("text-translate"),_.paint.get("text-translate-anchor"),_.layout.get("text-rotation-alignment"),_.layout.get("text-pitch-alignment"),_.layout.get("text-keep-upright"),D,F),b.map.showCollisionBoxes&&(ud(y,b,_,C,_.paint.get("text-translate"),_.paint.get("text-translate-anchor"),!0),ud(y,b,_,C,_.paint.get("icon-translate"),_.paint.get("icon-translate-anchor"),!1))}},circle:function(y,b,_,C){if(y.renderPass==="translucent"){var L=_.paint.get("circle-opacity"),D=_.paint.get("circle-stroke-width"),F=_.paint.get("circle-stroke-opacity"),$=_.layout.get("circle-sort-key").constantOr(1)!==void 0;if(L.constantOr(1)!==0||D.constantOr(1)!==0&&F.constantOr(1)!==0){for(var j=y.context,et=j.gl,ut=y.depthModeForSublayer(0,mt.ReadOnly),ht=Mt.disabled,dt=y.colorModeForRenderPass(),Ot=[],At=0;At<C.length;At++){var $t=C[At],Ct=b.getTile($t),zt=Ct.getBucket(_);if(zt){var qt=zt.programConfigurations.get(_.id),se={programConfiguration:qt,program:y.useProgram("circle",qt),layoutVertexBuffer:zt.layoutVertexBuffer,indexBuffer:zt.indexBuffer,uniformValues:ep(y,$t,Ct,_)};if($)for(var Ee=0,pe=zt.segments.get();Ee<pe.length;Ee+=1){var Ae=pe[Ee];Ot.push({segments:new o.SegmentVector([Ae]),sortKey:Ae.sortKey,state:se})}else Ot.push({segments:zt.segments,sortKey:0,state:se})}}$&&Ot.sort(function(sn,hn){return sn.sortKey-hn.sortKey});for(var Ve=0,cr=Ot;Ve<cr.length;Ve+=1){var ar=cr[Ve],Mr=ar.state;Mr.program.draw(j,et.TRIANGLES,ut,ht,dt,Qt.disabled,Mr.uniformValues,_.id,Mr.layoutVertexBuffer,Mr.indexBuffer,ar.segments,_.paint,y.transform.zoom,Mr.programConfiguration)}}}},heatmap:function(y,b,_,C){if(_.paint.get("heatmap-opacity")!==0)if(y.renderPass==="offscreen"){var L=y.context,D=L.gl,F=Mt.disabled,$=new Xt([D.ONE,D.ONE],o.Color.transparent,[!0,!0,!0,!0]);(function(Ot,At,$t){var Ct=Ot.gl;Ot.activeTexture.set(Ct.TEXTURE1),Ot.viewport.set([0,0,At.width/4,At.height/4]);var zt=$t.heatmapFbo;if(zt)Ct.bindTexture(Ct.TEXTURE_2D,zt.colorAttachment.get()),Ot.bindFramebuffer.set(zt.framebuffer);else{var qt=Ct.createTexture();Ct.bindTexture(Ct.TEXTURE_2D,qt),Ct.texParameteri(Ct.TEXTURE_2D,Ct.TEXTURE_WRAP_S,Ct.CLAMP_TO_EDGE),Ct.texParameteri(Ct.TEXTURE_2D,Ct.TEXTURE_WRAP_T,Ct.CLAMP_TO_EDGE),Ct.texParameteri(Ct.TEXTURE_2D,Ct.TEXTURE_MIN_FILTER,Ct.LINEAR),Ct.texParameteri(Ct.TEXTURE_2D,Ct.TEXTURE_MAG_FILTER,Ct.LINEAR),zt=$t.heatmapFbo=Ot.createFramebuffer(At.width/4,At.height/4,!1),function(se,Ee,pe,Ae){var Ve=se.gl;Ve.texImage2D(Ve.TEXTURE_2D,0,Ve.RGBA,Ee.width/4,Ee.height/4,0,Ve.RGBA,se.extRenderToTextureHalfFloat?se.extTextureHalfFloat.HALF_FLOAT_OES:Ve.UNSIGNED_BYTE,null),Ae.colorAttachment.set(pe)}(Ot,At,qt,zt)}})(L,y,_),L.clear({color:o.Color.transparent});for(var j=0;j<C.length;j++){var et=C[j];if(!b.hasRenderableParent(et)){var ut=b.getTile(et),ht=ut.getBucket(_);if(ht){var dt=ht.programConfigurations.get(_.id);y.useProgram("heatmap",dt).draw(L,D.TRIANGLES,mt.disabled,F,$,Qt.disabled,L0(et.posMatrix,ut,y.transform.zoom,_.paint.get("heatmap-intensity")),_.id,ht.layoutVertexBuffer,ht.indexBuffer,ht.segments,_.paint,y.transform.zoom,dt)}}}L.viewport.set([0,0,y.width,y.height])}else y.renderPass==="translucent"&&(y.context.setColorMode(y.colorModeForRenderPass()),function(Ot,At){var $t=Ot.context,Ct=$t.gl,zt=At.heatmapFbo;if(zt){$t.activeTexture.set(Ct.TEXTURE0),Ct.bindTexture(Ct.TEXTURE_2D,zt.colorAttachment.get()),$t.activeTexture.set(Ct.TEXTURE1);var qt=At.colorRampTexture;qt||(qt=At.colorRampTexture=new o.Texture($t,At.colorRamp,Ct.RGBA)),qt.bind(Ct.LINEAR,Ct.CLAMP_TO_EDGE),Ot.useProgram("heatmapTexture").draw($t,Ct.TRIANGLES,mt.disabled,Mt.disabled,Ot.colorModeForRenderPass(),Qt.disabled,function(se,Ee,pe,Ae){var Ve=o.create();o.ortho(Ve,0,se.width,se.height,0,0,1);var cr=se.context.gl;return{u_matrix:Ve,u_world:[cr.drawingBufferWidth,cr.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Ee.paint.get("heatmap-opacity")}}(Ot,At),At.id,Ot.viewportBuffer,Ot.quadTriangleIndexBuffer,Ot.viewportSegments,At.paint,Ot.transform.zoom)}}(y,_))},line:function(y,b,_,C){if(y.renderPass==="translucent"){var L=_.paint.get("line-opacity"),D=_.paint.get("line-width");if(L.constantOr(1)!==0&&D.constantOr(1)!==0)for(var F=y.depthModeForSublayer(0,mt.ReadOnly),$=y.colorModeForRenderPass(),j=_.paint.get("line-dasharray"),et=_.paint.get("line-pattern"),ut=et.constantOr(1),ht=_.paint.get("line-gradient"),dt=_.getCrossfadeParameters(),Ot=ut?"linePattern":j?"lineSDF":ht?"lineGradient":"line",At=y.context,$t=At.gl,Ct=!0,zt=0,qt=C;zt<qt.length;zt+=1){var se=qt[zt],Ee=b.getTile(se);if(!ut||Ee.patternsLoaded()){var pe=Ee.getBucket(_);if(pe){var Ae=pe.programConfigurations.get(_.id),Ve=y.context.program.get(),cr=y.useProgram(Ot,Ae),ar=Ct||cr.program!==Ve,Mr=et.constantOr(null);if(Mr&&Ee.imageAtlas){var sn=Ee.imageAtlas,hn=sn.patternPositions[Mr.to.toString()],cn=sn.patternPositions[Mr.from.toString()];hn&&cn&&Ae.setConstantPatternPositions(hn,cn)}var Ii=ut?Rg(y,Ee,_,dt):j?Yb(y,Ee,_,j,dt):ht?ba(y,Ee,_,pe.lineClipsArray.length):pv(y,Ee,_);if(ut)At.activeTexture.set($t.TEXTURE0),Ee.imageAtlasTexture.bind($t.LINEAR,$t.CLAMP_TO_EDGE),Ae.updatePaintBuffers(dt);else if(j&&(ar||y.lineAtlas.dirty))At.activeTexture.set($t.TEXTURE0),y.lineAtlas.bind(At);else if(ht){var kr=pe.gradients[_.id],Ln=kr.texture;if(_.gradientVersion!==kr.version){var Xn=256;if(_.stepInterpolant){var Rn=b.getSource().maxzoom,Cn=se.canonical.z===Rn?Math.ceil(1<<y.transform.maxZoom-se.canonical.z):1;Xn=o.clamp(o.nextPowerOfTwo(pe.maxLineLength/o.EXTENT*1024*Cn),256,At.maxTextureSize)}kr.gradient=o.renderColorRamp({expression:_.gradientExpression(),evaluationKey:"lineProgress",resolution:Xn,image:kr.gradient||void 0,clips:pe.lineClipsArray}),kr.texture?kr.texture.update(kr.gradient):kr.texture=new o.Texture(At,kr.gradient,$t.RGBA),kr.version=_.gradientVersion,Ln=kr.texture}At.activeTexture.set($t.TEXTURE0),Ln.bind(_.stepInterpolant?$t.NEAREST:$t.LINEAR,$t.CLAMP_TO_EDGE)}cr.draw(At,$t.TRIANGLES,F,y.stencilModeForClipping(se),$,Qt.disabled,Ii,_.id,pe.layoutVertexBuffer,pe.indexBuffer,pe.segments,_.paint,y.transform.zoom,Ae,pe.layoutVertexBuffer2),Ct=!1}}}}},fill:function(y,b,_,C){var L=_.paint.get("fill-color"),D=_.paint.get("fill-opacity");if(D.constantOr(1)!==0){var F=y.colorModeForRenderPass(),$=_.paint.get("fill-pattern"),j=y.opaquePassEnabledForLayer()&&!$.constantOr(1)&&L.constantOr(o.Color.transparent).a===1&&D.constantOr(0)===1?"opaque":"translucent";if(y.renderPass===j){var et=y.depthModeForSublayer(1,y.renderPass==="opaque"?mt.ReadWrite:mt.ReadOnly);np(y,b,_,C,et,F,!1)}if(y.renderPass==="translucent"&&_.paint.get("fill-antialias")){var ut=y.depthModeForSublayer(_.getPaintProperty("fill-outline-color")?2:0,mt.ReadOnly);np(y,b,_,C,ut,F,!0)}}},"fill-extrusion":function(y,b,_,C){var L=_.paint.get("fill-extrusion-opacity");if(L!==0&&y.renderPass==="translucent"){var D=new mt(y.context.gl.LEQUAL,mt.ReadWrite,y.depthRangeFor3D);if(L!==1||_.paint.get("fill-extrusion-pattern").constantOr(1))gv(y,b,_,C,D,Mt.disabled,Xt.disabled),gv(y,b,_,C,D,y.stencilModeFor3D(),y.colorModeForRenderPass());else{var F=y.colorModeForRenderPass();gv(y,b,_,C,D,Mt.disabled,F)}}},hillshade:function(y,b,_,C){if(y.renderPass==="offscreen"||y.renderPass==="translucent"){for(var L=y.context,D=y.depthModeForSublayer(0,mt.ReadOnly),F=y.colorModeForRenderPass(),$=y.renderPass==="translucent"?y.stencilConfigForOverlap(C):[{},C],j=$[0],et=0,ut=$[1];et<ut.length;et+=1){var ht=ut[et],dt=b.getTile(ht);dt.needsHillshadePrepare&&y.renderPass==="offscreen"?Zb(y,dt,_,D,Mt.disabled,F):y.renderPass==="translucent"&&cf(y,dt,_,D,j[ht.overscaledZ],F)}L.viewport.set([0,0,y.width,y.height])}},raster:function(y,b,_,C){if(y.renderPass==="translucent"&&_.paint.get("raster-opacity")!==0&&C.length)for(var L=y.context,D=L.gl,F=b.getSource(),$=y.useProgram("raster"),j=y.colorModeForRenderPass(),et=F instanceof Oe?[{},C]:y.stencilConfigForOverlap(C),ut=et[0],ht=et[1],dt=ht[ht.length-1].overscaledZ,Ot=!y.options.moving,At=0,$t=ht;At<$t.length;At+=1){var Ct=$t[At],zt=y.depthModeForSublayer(Ct.overscaledZ-dt,_.paint.get("raster-opacity")===1?mt.ReadWrite:mt.ReadOnly,D.LESS),qt=b.getTile(Ct),se=y.transform.calculatePosMatrix(Ct.toUnwrapped(),Ot);qt.registerFadeDuration(_.paint.get("raster-fade-duration"));var Ee=b.findLoadedParent(Ct,0),pe=Lg(qt,Ee,b,_,y.transform),Ae=void 0,Ve=void 0,cr=_.paint.get("raster-resampling")==="nearest"?D.NEAREST:D.LINEAR;L.activeTexture.set(D.TEXTURE0),qt.texture.bind(cr,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST),L.activeTexture.set(D.TEXTURE1),Ee?(Ee.texture.bind(cr,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST),Ae=Math.pow(2,Ee.tileID.overscaledZ-qt.tileID.overscaledZ),Ve=[qt.tileID.canonical.x*Ae%1,qt.tileID.canonical.y*Ae%1]):qt.texture.bind(cr,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST);var ar=O0(se,Ve||[0,0],Ae||1,pe,_);F instanceof Oe?$.draw(L,D.TRIANGLES,zt,Mt.disabled,j,Qt.disabled,ar,_.id,F.boundsBuffer,y.quadTriangleIndexBuffer,F.boundsSegments):$.draw(L,D.TRIANGLES,zt,ut[Ct.overscaledZ],j,Qt.disabled,ar,_.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments)}},background:function(y,b,_){var C=_.paint.get("background-color"),L=_.paint.get("background-opacity");if(L!==0){var D=y.context,F=D.gl,$=y.transform,j=$.tileSize,et=_.paint.get("background-pattern");if(!y.isPatternMissing(et)){var ut=!et&&C.a===1&&L===1&&y.opaquePassEnabledForLayer()?"opaque":"translucent";if(y.renderPass===ut){var ht=Mt.disabled,dt=y.depthModeForSublayer(0,ut==="opaque"?mt.ReadWrite:mt.ReadOnly),Ot=y.colorModeForRenderPass(),At=y.useProgram(et?"backgroundPattern":"background"),$t=$.coveringTiles({tileSize:j});et&&(D.activeTexture.set(F.TEXTURE0),y.imageManager.bind(y.context));for(var Ct=_.getCrossfadeParameters(),zt=0,qt=$t;zt<qt.length;zt+=1){var se=qt[zt],Ee=y.transform.calculatePosMatrix(se.toUnwrapped()),pe=et?ld(Ee,L,y,et,{tileID:se,tileSize:j},Ct):sd(Ee,L,C);At.draw(D,F.TRIANGLES,dt,ht,Ot,Qt.disabled,pe,_.id,y.tileExtentBuffer,y.quadTriangleIndexBuffer,y.tileExtentSegments)}}}}},debug:function(y,b,_){for(var C=0;C<_.length;C++)U0(y,b,_[C])},custom:function(y,b,_){var C=y.context,L=_.implementation;if(y.renderPass==="offscreen"){var D=L.prerender;D&&(y.setCustomLayerDefaults(),C.setColorMode(y.colorModeForRenderPass()),D.call(L,C.gl,y.transform.customLayerMatrix()),C.setDirty(),y.setBaseState())}else if(y.renderPass==="translucent"){y.setCustomLayerDefaults(),C.setColorMode(y.colorModeForRenderPass()),C.setStencilMode(Mt.disabled);var F=L.renderingMode==="3d"?new mt(y.context.gl.LEQUAL,mt.ReadWrite,y.depthRangeFor3D):y.depthModeForSublayer(0,mt.ReadOnly);C.setDepthMode(F),L.render(C.gl,y.transform.customLayerMatrix()),C.setDirty(),y.setBaseState(),C.bindFramebuffer.set(null)}}},Ea=function(y,b){this.context=new ct(y),this.transform=b,this._tileTextures={},this.setup(),this.numSublayers=Pt.maxUnderzooming+Pt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Jh,this.gpuTimers={}};Ea.prototype.resize=function(y,b){if(this.width=y*o.browser.devicePixelRatio,this.height=b*o.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var _=0,C=this.style._order;_<C.length;_+=1)this.style._layers[C[_]].resize()},Ea.prototype.setup=function(){var y=this.context,b=new o.StructArrayLayout2i4;b.emplaceBack(0,0),b.emplaceBack(o.EXTENT,0),b.emplaceBack(0,o.EXTENT),b.emplaceBack(o.EXTENT,o.EXTENT),this.tileExtentBuffer=y.createVertexBuffer(b,no.members),this.tileExtentSegments=o.SegmentVector.simpleSegment(0,0,4,2);var _=new o.StructArrayLayout2i4;_.emplaceBack(0,0),_.emplaceBack(o.EXTENT,0),_.emplaceBack(0,o.EXTENT),_.emplaceBack(o.EXTENT,o.EXTENT),this.debugBuffer=y.createVertexBuffer(_,no.members),this.debugSegments=o.SegmentVector.simpleSegment(0,0,4,5);var C=new o.StructArrayLayout4i8;C.emplaceBack(0,0,0,0),C.emplaceBack(o.EXTENT,0,o.EXTENT,0),C.emplaceBack(0,o.EXTENT,0,o.EXTENT),C.emplaceBack(o.EXTENT,o.EXTENT,o.EXTENT,o.EXTENT),this.rasterBoundsBuffer=y.createVertexBuffer(C,fe.members),this.rasterBoundsSegments=o.SegmentVector.simpleSegment(0,0,4,2);var L=new o.StructArrayLayout2i4;L.emplaceBack(0,0),L.emplaceBack(1,0),L.emplaceBack(0,1),L.emplaceBack(1,1),this.viewportBuffer=y.createVertexBuffer(L,no.members),this.viewportSegments=o.SegmentVector.simpleSegment(0,0,4,2);var D=new o.StructArrayLayout1ui2;D.emplaceBack(0),D.emplaceBack(1),D.emplaceBack(3),D.emplaceBack(2),D.emplaceBack(0),this.tileBorderIndexBuffer=y.createIndexBuffer(D);var F=new o.StructArrayLayout3ui6;F.emplaceBack(0,1,2),F.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=y.createIndexBuffer(F),this.emptyTexture=new o.Texture(y,{width:1,height:1,data:new Uint8Array([0,0,0,0])},y.gl.RGBA);var $=this.context.gl;this.stencilClearMode=new Mt({func:$.ALWAYS,mask:0},0,255,$.ZERO,$.ZERO,$.ZERO)},Ea.prototype.clearStencil=function(){var y=this.context,b=y.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var _=o.create();o.ortho(_,0,this.width,this.height,0,0,1),o.scale(_,_,[b.drawingBufferWidth,b.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(y,b.TRIANGLES,mt.disabled,this.stencilClearMode,Xt.disabled,Qt.disabled,vh(_),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Ea.prototype._renderTileClippingMasks=function(y,b){if(this.currentStencilSource!==y.source&&y.isTileClipped()&&b&&b.length){this.currentStencilSource=y.source;var _=this.context,C=_.gl;this.nextStencilID+b.length>256&&this.clearStencil(),_.setColorMode(Xt.disabled),_.setDepthMode(mt.disabled);var L=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var D=0,F=b;D<F.length;D+=1){var $=F[D],j=this._tileClippingMaskIDs[$.key]=this.nextStencilID++;L.draw(_,C.TRIANGLES,mt.disabled,new Mt({func:C.ALWAYS,mask:0},j,255,C.KEEP,C.KEEP,C.REPLACE),Xt.disabled,Qt.disabled,vh($.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Ea.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var y=this.nextStencilID++,b=this.context.gl;return new Mt({func:b.NOTEQUAL,mask:255},y,255,b.KEEP,b.KEEP,b.REPLACE)},Ea.prototype.stencilModeForClipping=function(y){var b=this.context.gl;return new Mt({func:b.EQUAL,mask:255},this._tileClippingMaskIDs[y.key],0,b.KEEP,b.KEEP,b.REPLACE)},Ea.prototype.stencilConfigForOverlap=function(y){var b,_=this.context.gl,C=y.sort(function(j,et){return et.overscaledZ-j.overscaledZ}),L=C[C.length-1].overscaledZ,D=C[0].overscaledZ-L+1;if(D>1){this.currentStencilSource=void 0,this.nextStencilID+D>256&&this.clearStencil();for(var F={},$=0;$<D;$++)F[$+L]=new Mt({func:_.GEQUAL,mask:255},$+this.nextStencilID,255,_.KEEP,_.KEEP,_.REPLACE);return this.nextStencilID+=D,[F,C]}return[(b={},b[L]=Mt.disabled,b),C]},Ea.prototype.colorModeForRenderPass=function(){var y=this.context.gl;return this._showOverdrawInspector?new Xt([y.CONSTANT_COLOR,y.ONE],new o.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Xt.unblended:Xt.alphaBlended},Ea.prototype.depthModeForSublayer=function(y,b,_){if(!this.opaquePassEnabledForLayer())return mt.disabled;var C=1-((1+this.currentLayer)*this.numSublayers+y)*this.depthEpsilon;return new mt(_||this.context.gl.LEQUAL,b,[C,C])},Ea.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Ea.prototype.render=function(y,b){var _=this;this.style=y,this.options=b,this.lineAtlas=y.lineAtlas,this.imageManager=y.imageManager,this.glyphManager=y.glyphManager,this.symbolFadeChange=y.placement.symbolFadeChange(o.browser.now()),this.imageManager.beginFrame();var C=this.style._order,L=this.style.sourceCaches;for(var D in L){var F=L[D];F.used&&F.prepare(this.context)}var $,j,et={},ut={},ht={};for(var dt in L){var Ot=L[dt];et[dt]=Ot.getVisibleCoordinates(),ut[dt]=et[dt].slice().reverse(),ht[dt]=Ot.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var At=0;At<C.length;At++)if(this.style._layers[C[At]].is3D()){this.opaquePassCutoff=At;break}this.renderPass="offscreen";for(var $t=0,Ct=C;$t<Ct.length;$t+=1){var zt=this.style._layers[Ct[$t]];if(zt.hasOffscreenPass()&&!zt.isHidden(this.transform.zoom)){var qt=ut[zt.source];(zt.type==="custom"||qt.length)&&this.renderLayer(this,L[zt.source],zt,qt)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:b.showOverdrawInspector?o.Color.black:o.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=b.showOverdrawInspector,this.depthRangeFor3D=[0,1-(y._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=C.length-1;this.currentLayer>=0;this.currentLayer--){var se=this.style._layers[C[this.currentLayer]],Ee=L[se.source],pe=et[se.source];this._renderTileClippingMasks(se,pe),this.renderLayer(this,Ee,se,pe)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<C.length;this.currentLayer++){var Ae=this.style._layers[C[this.currentLayer]],Ve=L[Ae.source],cr=(Ae.type==="symbol"?ht:ut)[Ae.source];this._renderTileClippingMasks(Ae,et[Ae.source]),this.renderLayer(this,Ve,Ae,cr)}this.options.showTileBoundaries&&(o.values(this.style._layers).forEach(function(ar){ar.source&&!ar.isHidden(_.transform.zoom)&&(ar.source!==(j&&j.id)&&(j=_.style.sourceCaches[ar.source]),(!$||$.getSource().maxzoom<j.getSource().maxzoom)&&($=j))}),$&&hf.debug(this,$,$.getVisibleCoordinates())),this.options.showPadding&&function(ar){var Mr=ar.transform.padding;mv(ar,ar.transform.height-(Mr.top||0),3,N0),mv(ar,Mr.bottom||0,3,Og),z0(ar,Mr.left||0,3,Y_),z0(ar,ar.transform.width-(Mr.right||0),3,Pg);var sn=ar.transform.centerPoint;(function(hn,cn,Ii,kr){cd(hn,cn-1,Ii-10,2,20,kr),cd(hn,cn-10,Ii-1,20,2,kr)})(ar,sn.x,ar.transform.height-sn.y,k0)}(this),this.context.setDefault()},Ea.prototype.renderLayer=function(y,b,_,C){_.isHidden(this.transform.zoom)||(_.type==="background"||_.type==="custom"||C.length)&&(this.id=_.id,this.gpuTimingStart(_),hf[_.type](y,b,_,C,this.style.placement.variableOffsets),this.gpuTimingEnd())},Ea.prototype.gpuTimingStart=function(y){if(this.options.gpuTiming){var b=this.context.extTimerQuery,_=this.gpuTimers[y.id];_||(_=this.gpuTimers[y.id]={calls:0,cpuTime:0,query:b.createQueryEXT()}),_.calls++,b.beginQueryEXT(b.TIME_ELAPSED_EXT,_.query)}},Ea.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var y=this.context.extTimerQuery;y.endQueryEXT(y.TIME_ELAPSED_EXT)}},Ea.prototype.collectGpuTimers=function(){var y=this.gpuTimers;return this.gpuTimers={},y},Ea.prototype.queryGpuTimers=function(y){var b={};for(var _ in y){var C=y[_],L=this.context.extTimerQuery,D=L.getQueryObjectEXT(C.query,L.QUERY_RESULT_EXT)/1e6;L.deleteQueryEXT(C.query),b[_]=D}return b},Ea.prototype.translatePosMatrix=function(y,b,_,C,L){if(!_[0]&&!_[1])return y;var D=L?C==="map"?this.transform.angle:0:C==="viewport"?-this.transform.angle:0;if(D){var F=Math.sin(D),$=Math.cos(D);_=[_[0]*$-_[1]*F,_[0]*F+_[1]*$]}var j=[L?_[0]:ga(b,_[0],this.transform.zoom),L?_[1]:ga(b,_[1],this.transform.zoom),0],et=new Float32Array(16);return o.translate(et,y,j),et},Ea.prototype.saveTileTexture=function(y){var b=this._tileTextures[y.size[0]];b?b.push(y):this._tileTextures[y.size[0]]=[y]},Ea.prototype.getTileTexture=function(y){var b=this._tileTextures[y];return b&&b.length>0?b.pop():null},Ea.prototype.isPatternMissing=function(y){if(!y)return!1;if(!y.from||!y.to)return!0;var b=this.imageManager.getPattern(y.from.toString()),_=this.imageManager.getPattern(y.to.toString());return!b||!_},Ea.prototype.useProgram=function(y,b){this.cache=this.cache||{};var _=""+y+(b?b.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[_]||(this.cache[_]=new io(this.context,y,jb[y],b,P0[y],this._showOverdrawInspector)),this.cache[_]},Ea.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Ea.prototype.setBaseState=function(){var y=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(y.FUNC_ADD)},Ea.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=o.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Ea.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Dg=function(y,b){this.points=y,this.planes=b};Dg.fromInvProjectionMatrix=function(y,b,_){var C=Math.pow(2,_),L=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(F){return o.transformMat4([],F,y)}).map(function(F){return o.scale$1([],F,1/F[3]/b*C)}),D=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(F){var $=o.sub([],L[F[0]],L[F[1]]),j=o.sub([],L[F[2]],L[F[1]]),et=o.normalize([],o.cross([],$,j)),ut=-o.dot(et,L[F[1]]);return et.concat(ut)});return new Dg(L,D)};var xc=function(y,b){this.min=y,this.max=b,this.center=o.scale$2([],o.add([],this.min,this.max),.5)};xc.prototype.quadrant=function(y){for(var b=[y%2==0,y<2],_=o.clone$2(this.min),C=o.clone$2(this.max),L=0;L<b.length;L++)_[L]=b[L]?this.min[L]:this.center[L],C[L]=b[L]?this.center[L]:this.max[L];return C[2]=this.max[2],new xc(_,C)},xc.prototype.distanceX=function(y){return Math.max(Math.min(this.max[0],y[0]),this.min[0])-y[0]},xc.prototype.distanceY=function(y){return Math.max(Math.min(this.max[1],y[1]),this.min[1])-y[1]},xc.prototype.intersects=function(y){for(var b=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],_=!0,C=0;C<y.planes.length;C++){for(var L=y.planes[C],D=0,F=0;F<b.length;F++)D+=o.dot$1(L,b[F])>=0;if(D===0)return 0;D!==b.length&&(_=!1)}if(_)return 2;for(var $=0;$<3;$++){for(var j=Number.MAX_VALUE,et=-Number.MAX_VALUE,ut=0;ut<y.points.length;ut++){var ht=y.points[ut][$]-this.min[$];j=Math.min(j,ht),et=Math.max(et,ht)}if(et<0||j>this.max[$]-this.min[$])return 0}return 1};var ff=function(y,b,_,C){if(y===void 0&&(y=0),b===void 0&&(b=0),_===void 0&&(_=0),C===void 0&&(C=0),isNaN(y)||y<0||isNaN(b)||b<0||isNaN(_)||_<0||isNaN(C)||C<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=y,this.bottom=b,this.left=_,this.right=C};ff.prototype.interpolate=function(y,b,_){return b.top!=null&&y.top!=null&&(this.top=o.number(y.top,b.top,_)),b.bottom!=null&&y.bottom!=null&&(this.bottom=o.number(y.bottom,b.bottom,_)),b.left!=null&&y.left!=null&&(this.left=o.number(y.left,b.left,_)),b.right!=null&&y.right!=null&&(this.right=o.number(y.right,b.right,_)),this},ff.prototype.getCenter=function(y,b){var _=o.clamp((this.left+y-this.right)/2,0,y),C=o.clamp((this.top+b-this.bottom)/2,0,b);return new o.Point(_,C)},ff.prototype.equals=function(y){return this.top===y.top&&this.bottom===y.bottom&&this.left===y.left&&this.right===y.right},ff.prototype.clone=function(){return new ff(this.top,this.bottom,this.left,this.right)},ff.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Ci=function(y,b,_,C,L){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=L===void 0||L,this._minZoom=y||0,this._maxZoom=b||22,this._minPitch=_??0,this._maxPitch=C??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new o.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new ff,this._posMatrixCache={},this._alignedPosMatrixCache={}},wa={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Ci.prototype.clone=function(){var y=new Ci(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return y.tileSize=this.tileSize,y.latRange=this.latRange,y.width=this.width,y.height=this.height,y._center=this._center,y.zoom=this.zoom,y.angle=this.angle,y._fov=this._fov,y._pitch=this._pitch,y._unmodified=this._unmodified,y._edgeInsets=this._edgeInsets.clone(),y._calcMatrices(),y},wa.minZoom.get=function(){return this._minZoom},wa.minZoom.set=function(y){this._minZoom!==y&&(this._minZoom=y,this.zoom=Math.max(this.zoom,y))},wa.maxZoom.get=function(){return this._maxZoom},wa.maxZoom.set=function(y){this._maxZoom!==y&&(this._maxZoom=y,this.zoom=Math.min(this.zoom,y))},wa.minPitch.get=function(){return this._minPitch},wa.minPitch.set=function(y){this._minPitch!==y&&(this._minPitch=y,this.pitch=Math.max(this.pitch,y))},wa.maxPitch.get=function(){return this._maxPitch},wa.maxPitch.set=function(y){this._maxPitch!==y&&(this._maxPitch=y,this.pitch=Math.min(this.pitch,y))},wa.renderWorldCopies.get=function(){return this._renderWorldCopies},wa.renderWorldCopies.set=function(y){y===void 0?y=!0:y===null&&(y=!1),this._renderWorldCopies=y},wa.worldSize.get=function(){return this.tileSize*this.scale},wa.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},wa.size.get=function(){return new o.Point(this.width,this.height)},wa.bearing.get=function(){return-this.angle/Math.PI*180},wa.bearing.set=function(y){var b=-o.wrap(y,-180,180)*Math.PI/180;this.angle!==b&&(this._unmodified=!1,this.angle=b,this._calcMatrices(),this.rotationMatrix=o.create$2(),o.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},wa.pitch.get=function(){return this._pitch/Math.PI*180},wa.pitch.set=function(y){var b=o.clamp(y,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==b&&(this._unmodified=!1,this._pitch=b,this._calcMatrices())},wa.fov.get=function(){return this._fov/Math.PI*180},wa.fov.set=function(y){y=Math.max(.01,Math.min(60,y)),this._fov!==y&&(this._unmodified=!1,this._fov=y/180*Math.PI,this._calcMatrices())},wa.zoom.get=function(){return this._zoom},wa.zoom.set=function(y){var b=Math.min(Math.max(y,this.minZoom),this.maxZoom);this._zoom!==b&&(this._unmodified=!1,this._zoom=b,this.scale=this.zoomScale(b),this.tileZoom=Math.floor(b),this.zoomFraction=b-this.tileZoom,this._constrain(),this._calcMatrices())},wa.center.get=function(){return this._center},wa.center.set=function(y){y.lat===this._center.lat&&y.lng===this._center.lng||(this._unmodified=!1,this._center=y,this._constrain(),this._calcMatrices())},wa.padding.get=function(){return this._edgeInsets.toJSON()},wa.padding.set=function(y){this._edgeInsets.equals(y)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,y,1),this._calcMatrices())},wa.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Ci.prototype.isPaddingEqual=function(y){return this._edgeInsets.equals(y)},Ci.prototype.interpolatePadding=function(y,b,_){this._unmodified=!1,this._edgeInsets.interpolate(y,b,_),this._constrain(),this._calcMatrices()},Ci.prototype.coveringZoomLevel=function(y){var b=(y.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/y.tileSize));return Math.max(0,b)},Ci.prototype.getVisibleUnwrappedCoordinates=function(y){var b=[new o.UnwrappedTileID(0,y)];if(this._renderWorldCopies)for(var _=this.pointCoordinate(new o.Point(0,0)),C=this.pointCoordinate(new o.Point(this.width,0)),L=this.pointCoordinate(new o.Point(this.width,this.height)),D=this.pointCoordinate(new o.Point(0,this.height)),F=Math.floor(Math.min(_.x,C.x,L.x,D.x)),$=Math.floor(Math.max(_.x,C.x,L.x,D.x)),j=F-1;j<=$+1;j++)j!==0&&b.push(new o.UnwrappedTileID(j,y));return b},Ci.prototype.coveringTiles=function(y){var b=this.coveringZoomLevel(y),_=b;if(y.minzoom!==void 0&&b<y.minzoom)return[];y.maxzoom!==void 0&&b>y.maxzoom&&(b=y.maxzoom);var C=o.MercatorCoordinate.fromLngLat(this.center),L=Math.pow(2,b),D=[L*C.x,L*C.y,0],F=Dg.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,b),$=y.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&($=b);var j=function(ar){return{aabb:new xc([ar*L,0,0],[(ar+1)*L,L,0]),zoom:0,x:0,y:0,wrap:ar,fullyVisible:!1}},et=[],ut=[],ht=b,dt=y.reparseOverscaled?_:b;if(this._renderWorldCopies)for(var Ot=1;Ot<=3;Ot++)et.push(j(-Ot)),et.push(j(Ot));for(et.push(j(0));et.length>0;){var At=et.pop(),$t=At.x,Ct=At.y,zt=At.fullyVisible;if(!zt){var qt=At.aabb.intersects(F);if(qt===0)continue;zt=qt===2}var se=At.aabb.distanceX(D),Ee=At.aabb.distanceY(D),pe=Math.max(Math.abs(se),Math.abs(Ee));if(At.zoom===ht||pe>3+(1<<ht-At.zoom)-2&&At.zoom>=$)ut.push({tileID:new o.OverscaledTileID(At.zoom===ht?dt:At.zoom,At.wrap,At.zoom,$t,Ct),distanceSq:o.sqrLen([D[0]-.5-$t,D[1]-.5-Ct])});else for(var Ae=0;Ae<4;Ae++){var Ve=($t<<1)+Ae%2,cr=(Ct<<1)+(Ae>>1);et.push({aabb:At.aabb.quadrant(Ae),zoom:At.zoom+1,x:Ve,y:cr,wrap:At.wrap,fullyVisible:zt})}}return ut.sort(function(ar,Mr){return ar.distanceSq-Mr.distanceSq}).map(function(ar){return ar.tileID})},Ci.prototype.resize=function(y,b){this.width=y,this.height=b,this.pixelsToGLUnits=[2/y,-2/b],this._constrain(),this._calcMatrices()},wa.unmodified.get=function(){return this._unmodified},Ci.prototype.zoomScale=function(y){return Math.pow(2,y)},Ci.prototype.scaleZoom=function(y){return Math.log(y)/Math.LN2},Ci.prototype.project=function(y){var b=o.clamp(y.lat,-this.maxValidLatitude,this.maxValidLatitude);return new o.Point(o.mercatorXfromLng(y.lng)*this.worldSize,o.mercatorYfromLat(b)*this.worldSize)},Ci.prototype.unproject=function(y){return new o.MercatorCoordinate(y.x/this.worldSize,y.y/this.worldSize).toLngLat()},wa.point.get=function(){return this.project(this.center)},Ci.prototype.setLocationAtPoint=function(y,b){var _=this.pointCoordinate(b),C=this.pointCoordinate(this.centerPoint),L=this.locationCoordinate(y),D=new o.MercatorCoordinate(L.x-(_.x-C.x),L.y-(_.y-C.y));this.center=this.coordinateLocation(D),this._renderWorldCopies&&(this.center=this.center.wrap())},Ci.prototype.locationPoint=function(y){return this.coordinatePoint(this.locationCoordinate(y))},Ci.prototype.pointLocation=function(y){return this.coordinateLocation(this.pointCoordinate(y))},Ci.prototype.locationCoordinate=function(y){return o.MercatorCoordinate.fromLngLat(y)},Ci.prototype.coordinateLocation=function(y){return y.toLngLat()},Ci.prototype.pointCoordinate=function(y){var b=[y.x,y.y,0,1],_=[y.x,y.y,1,1];o.transformMat4(b,b,this.pixelMatrixInverse),o.transformMat4(_,_,this.pixelMatrixInverse);var C=b[3],L=_[3],D=b[1]/C,F=_[1]/L,$=b[2]/C,j=_[2]/L,et=$===j?0:(0-$)/(j-$);return new o.MercatorCoordinate(o.number(b[0]/C,_[0]/L,et)/this.worldSize,o.number(D,F,et)/this.worldSize)},Ci.prototype.coordinatePoint=function(y){var b=[y.x*this.worldSize,y.y*this.worldSize,0,1];return o.transformMat4(b,b,this.pixelMatrix),new o.Point(b[0]/b[3],b[1]/b[3])},Ci.prototype.getBounds=function(){return new o.LngLatBounds().extend(this.pointLocation(new o.Point(0,0))).extend(this.pointLocation(new o.Point(this.width,0))).extend(this.pointLocation(new o.Point(this.width,this.height))).extend(this.pointLocation(new o.Point(0,this.height)))},Ci.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new o.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Ci.prototype.setMaxBounds=function(y){y?(this.lngRange=[y.getWest(),y.getEast()],this.latRange=[y.getSouth(),y.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Ci.prototype.calculatePosMatrix=function(y,b){b===void 0&&(b=!1);var _=y.key,C=b?this._alignedPosMatrixCache:this._posMatrixCache;if(C[_])return C[_];var L=y.canonical,D=this.worldSize/this.zoomScale(L.z),F=L.x+Math.pow(2,L.z)*y.wrap,$=o.identity(new Float64Array(16));return o.translate($,$,[F*D,L.y*D,0]),o.scale($,$,[D/o.EXTENT,D/o.EXTENT,1]),o.multiply($,b?this.alignedProjMatrix:this.projMatrix,$),C[_]=new Float32Array($),C[_]},Ci.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Ci.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var y,b,_,C,L=-90,D=90,F=-180,$=180,j=this.size,et=this._unmodified;if(this.latRange){var ut=this.latRange;L=o.mercatorYfromLat(ut[1])*this.worldSize,y=(D=o.mercatorYfromLat(ut[0])*this.worldSize)-L<j.y?j.y/(D-L):0}if(this.lngRange){var ht=this.lngRange;F=o.mercatorXfromLng(ht[0])*this.worldSize,b=($=o.mercatorXfromLng(ht[1])*this.worldSize)-F<j.x?j.x/($-F):0}var dt=this.point,Ot=Math.max(b||0,y||0);if(Ot)return this.center=this.unproject(new o.Point(b?($+F)/2:dt.x,y?(D+L)/2:dt.y)),this.zoom+=this.scaleZoom(Ot),this._unmodified=et,void(this._constraining=!1);if(this.latRange){var At=dt.y,$t=j.y/2;At-$t<L&&(C=L+$t),At+$t>D&&(C=D-$t)}if(this.lngRange){var Ct=dt.x,zt=j.x/2;Ct-zt<F&&(_=F+zt),Ct+zt>$&&(_=$-zt)}_===void 0&&C===void 0||(this.center=this.unproject(new o.Point(_!==void 0?_:dt.x,C!==void 0?C:dt.y))),this._unmodified=et,this._constraining=!1}},Ci.prototype._calcMatrices=function(){if(this.height){var y=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var b=Math.PI/2+this._pitch,_=this._fov*(.5+y.y/this.height),C=Math.sin(_)*this.cameraToCenterDistance/Math.sin(o.clamp(Math.PI-b-_,.01,Math.PI-.01)),L=this.point,D=L.x,F=L.y,$=1.01*(Math.cos(Math.PI/2-this._pitch)*C+this.cameraToCenterDistance),j=this.height/50,et=new Float64Array(16);o.perspective(et,this._fov,this.width/this.height,j,$),et[8]=2*-y.x/this.width,et[9]=2*y.y/this.height,o.scale(et,et,[1,-1,1]),o.translate(et,et,[0,0,-this.cameraToCenterDistance]),o.rotateX(et,et,this._pitch),o.rotateZ(et,et,this.angle),o.translate(et,et,[-D,-F,0]),this.mercatorMatrix=o.scale([],et,[this.worldSize,this.worldSize,this.worldSize]),o.scale(et,et,[1,1,o.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=et,this.invProjMatrix=o.invert([],this.projMatrix);var ut=this.width%2/2,ht=this.height%2/2,dt=Math.cos(this.angle),Ot=Math.sin(this.angle),At=D-Math.round(D)+dt*ut+Ot*ht,$t=F-Math.round(F)+dt*ht+Ot*ut,Ct=new Float64Array(et);if(o.translate(Ct,Ct,[At>.5?At-1:At,$t>.5?$t-1:$t,0]),this.alignedProjMatrix=Ct,et=o.create(),o.scale(et,et,[this.width/2,-this.height/2,1]),o.translate(et,et,[1,-1,0]),this.labelPlaneMatrix=et,et=o.create(),o.scale(et,et,[1,-1,1]),o.translate(et,et,[-1,-1,0]),o.scale(et,et,[2/this.width,2/this.height,1]),this.glCoordMatrix=et,this.pixelMatrix=o.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(et=o.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=et,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Ci.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var y=this.pointCoordinate(new o.Point(0,0)),b=[y.x*this.worldSize,y.y*this.worldSize,0,1];return o.transformMat4(b,b,this.pixelMatrix)[3]/this.cameraToCenterDistance},Ci.prototype.getCameraPoint=function(){var y=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.Point(0,y))},Ci.prototype.getCameraQueryGeometry=function(y){var b=this.getCameraPoint();if(y.length===1)return[y[0],b];for(var _=b.x,C=b.y,L=b.x,D=b.y,F=0,$=y;F<$.length;F+=1){var j=$[F];_=Math.min(_,j.x),C=Math.min(C,j.y),L=Math.max(L,j.x),D=Math.max(D,j.y)}return[new o.Point(_,C),new o.Point(L,C),new o.Point(L,D),new o.Point(_,D),new o.Point(_,C)]},Object.defineProperties(Ci.prototype,wa);var Kl=function(y){var b,_,C,L;this._hashName=y&&encodeURIComponent(y),o.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(b=this._updateHashUnthrottled.bind(this),_=!1,C=null,L=function(){C=null,_&&(b(),C=setTimeout(L,300),_=!1)},function(){return _=!0,C||L(),C})};Kl.prototype.addTo=function(y){return this._map=y,o.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Kl.prototype.remove=function(){return o.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Kl.prototype.getHashString=function(y){var b=this._map.getCenter(),_=Math.round(100*this._map.getZoom())/100,C=Math.ceil((_*Math.LN2+Math.log(512/360/.5))/Math.LN10),L=Math.pow(10,C),D=Math.round(b.lng*L)/L,F=Math.round(b.lat*L)/L,$=this._map.getBearing(),j=this._map.getPitch(),et="";if(et+=y?"/"+D+"/"+F+"/"+_:_+"/"+F+"/"+D,($||j)&&(et+="/"+Math.round(10*$)/10),j&&(et+="/"+Math.round(j)),this._hashName){var ut=this._hashName,ht=!1,dt=o.window.location.hash.slice(1).split("&").map(function(Ot){var At=Ot.split("=")[0];return At===ut?(ht=!0,At+"="+et):Ot}).filter(function(Ot){return Ot});return ht||dt.push(ut+"="+et),"#"+dt.join("&")}return"#"+et},Kl.prototype._getCurrentHash=function(){var y,b=this,_=o.window.location.hash.replace("#","");return this._hashName?(_.split("&").map(function(C){return C.split("=")}).forEach(function(C){C[0]===b._hashName&&(y=C)}),(y&&y[1]||"").split("/")):_.split("/")},Kl.prototype._onHashChange=function(){var y=this._getCurrentHash();if(y.length>=3&&!y.some(function(_){return isNaN(_)})){var b=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(y[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+y[2],+y[1]],zoom:+y[0],bearing:b,pitch:+(y[4]||0)}),!0}return!1},Kl.prototype._updateHashUnthrottled=function(){var y=o.window.location.href.replace(/(#.+)?$/,this.getHashString());try{o.window.history.replaceState(o.window.history.state,null,y)}catch{}};var yv={linearity:.3,easing:o.bezier(0,0,.3,1)},ip=o.extend({deceleration:2500,maxSpeed:1400},yv),_v=o.extend({deceleration:20,maxSpeed:1400},yv),Z_=o.extend({deceleration:1e3,maxSpeed:360},yv),Fg=o.extend({deceleration:1e3,maxSpeed:90},yv),xv=function(y){this._map=y,this.clear()};function df(y,b){(!y.duration||y.duration<b.duration)&&(y.duration=b.duration,y.easing=b.easing)}function Go(y,b,_){var C=_.maxSpeed,L=_.linearity,D=_.deceleration,F=o.clamp(y*L/(b/1e3),-C,C),$=Math.abs(F)/(D*L);return{easing:_.easing,duration:1e3*$,amount:F*($/2)}}xv.prototype.clear=function(){this._inertiaBuffer=[]},xv.prototype.record=function(y){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.browser.now(),settings:y})},xv.prototype._drainInertiaBuffer=function(){for(var y=this._inertiaBuffer,b=o.browser.now();y.length>0&&b-y[0].time>160;)y.shift()},xv.prototype._onMoveEnd=function(y){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var b={zoom:0,bearing:0,pitch:0,pan:new o.Point(0,0),pinchAround:void 0,around:void 0},_=0,C=this._inertiaBuffer;_<C.length;_+=1){var L=C[_].settings;b.zoom+=L.zoomDelta||0,b.bearing+=L.bearingDelta||0,b.pitch+=L.pitchDelta||0,L.panDelta&&b.pan._add(L.panDelta),L.around&&(b.around=L.around),L.pinchAround&&(b.pinchAround=L.pinchAround)}var D=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,F={};if(b.pan.mag()){var $=Go(b.pan.mag(),D,o.extend({},ip,y||{}));F.offset=b.pan.mult($.amount/b.pan.mag()),F.center=this._map.transform.center,df(F,$)}if(b.zoom){var j=Go(b.zoom,D,_v);F.zoom=this._map.transform.zoom+j.amount,df(F,j)}if(b.bearing){var et=Go(b.bearing,D,Z_);F.bearing=this._map.transform.bearing+o.clamp(et.amount,-179,179),df(F,et)}if(b.pitch){var ut=Go(b.pitch,D,Fg);F.pitch=this._map.transform.pitch+ut.amount,df(F,ut)}if(F.zoom||F.bearing){var ht=b.pinchAround===void 0?b.around:b.pinchAround;F.around=ht?this._map.unproject(ht):this._map.getCenter()}return this.clear(),o.extend(F,{noMoveStart:!0})}};var Ha=function(y){function b(C,L,D,F){F===void 0&&(F={});var $=l.mousePos(L.getCanvasContainer(),D),j=L.unproject($);y.call(this,C,o.extend({point:$,lngLat:j,originalEvent:D},F)),this._defaultPrevented=!1,this.target=L}y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b;var _={defaultPrevented:{configurable:!0}};return b.prototype.preventDefault=function(){this._defaultPrevented=!0},_.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(b.prototype,_),b}(o.Event),ap=function(y){function b(C,L,D){var F=C==="touchend"?D.changedTouches:D.touches,$=l.touchPos(L.getCanvasContainer(),F),j=$.map(function(ht){return L.unproject(ht)}),et=$.reduce(function(ht,dt,Ot,At){return ht.add(dt.div(At.length))},new o.Point(0,0)),ut=L.unproject(et);y.call(this,C,{points:$,point:et,lngLats:j,lngLat:ut,originalEvent:D}),this._defaultPrevented=!1}y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b;var _={defaultPrevented:{configurable:!0}};return b.prototype.preventDefault=function(){this._defaultPrevented=!0},_.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(b.prototype,_),b}(o.Event),$0=function(y){function b(C,L,D){y.call(this,C,{originalEvent:D}),this._defaultPrevented=!1}y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b;var _={defaultPrevented:{configurable:!0}};return b.prototype.preventDefault=function(){this._defaultPrevented=!0},_.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(b.prototype,_),b}(o.Event),vo=function(y,b){this._map=y,this._clickTolerance=b.clickTolerance};vo.prototype.reset=function(){delete this._mousedownPos},vo.prototype.wheel=function(y){return this._firePreventable(new $0(y.type,this._map,y))},vo.prototype.mousedown=function(y,b){return this._mousedownPos=b,this._firePreventable(new Ha(y.type,this._map,y))},vo.prototype.mouseup=function(y){this._map.fire(new Ha(y.type,this._map,y))},vo.prototype.click=function(y,b){this._mousedownPos&&this._mousedownPos.dist(b)>=this._clickTolerance||this._map.fire(new Ha(y.type,this._map,y))},vo.prototype.dblclick=function(y){return this._firePreventable(new Ha(y.type,this._map,y))},vo.prototype.mouseover=function(y){this._map.fire(new Ha(y.type,this._map,y))},vo.prototype.mouseout=function(y){this._map.fire(new Ha(y.type,this._map,y))},vo.prototype.touchstart=function(y){return this._firePreventable(new ap(y.type,this._map,y))},vo.prototype.touchmove=function(y){this._map.fire(new ap(y.type,this._map,y))},vo.prototype.touchend=function(y){this._map.fire(new ap(y.type,this._map,y))},vo.prototype.touchcancel=function(y){this._map.fire(new ap(y.type,this._map,y))},vo.prototype._firePreventable=function(y){if(this._map.fire(y),y.defaultPrevented)return{}},vo.prototype.isEnabled=function(){return!0},vo.prototype.isActive=function(){return!1},vo.prototype.enable=function(){},vo.prototype.disable=function(){};var Wr=function(y){this._map=y};Wr.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},Wr.prototype.mousemove=function(y){this._map.fire(new Ha(y.type,this._map,y))},Wr.prototype.mousedown=function(){this._delayContextMenu=!0},Wr.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ha("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},Wr.prototype.contextmenu=function(y){this._delayContextMenu?this._contextMenuEvent=y:this._map.fire(new Ha(y.type,this._map,y)),this._map.listens("contextmenu")&&y.preventDefault()},Wr.prototype.isEnabled=function(){return!0},Wr.prototype.isActive=function(){return!1},Wr.prototype.enable=function(){},Wr.prototype.disable=function(){};var ol=function(y,b){this._map=y,this._el=y.getCanvasContainer(),this._container=y.getContainer(),this._clickTolerance=b.clickTolerance||1};function bv(y,b){for(var _={},C=0;C<y.length;C++)_[y[C].identifier]=b[C];return _}ol.prototype.isEnabled=function(){return!!this._enabled},ol.prototype.isActive=function(){return!!this._active},ol.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},ol.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},ol.prototype.mousedown=function(y,b){this.isEnabled()&&y.shiftKey&&y.button===0&&(l.disableDrag(),this._startPos=this._lastPos=b,this._active=!0)},ol.prototype.mousemoveWindow=function(y,b){if(this._active){var _=b;if(!(this._lastPos.equals(_)||!this._box&&_.dist(this._startPos)<this._clickTolerance)){var C=this._startPos;this._lastPos=_,this._box||(this._box=l.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",y));var L=Math.min(C.x,_.x),D=Math.max(C.x,_.x),F=Math.min(C.y,_.y),$=Math.max(C.y,_.y);l.setTransform(this._box,"translate("+L+"px,"+F+"px)"),this._box.style.width=D-L+"px",this._box.style.height=$-F+"px"}}},ol.prototype.mouseupWindow=function(y,b){var _=this;if(this._active&&y.button===0){var C=this._startPos,L=b;if(this.reset(),l.suppressClick(),C.x!==L.x||C.y!==L.y)return this._map.fire(new o.Event("boxzoomend",{originalEvent:y})),{cameraAnimation:function(D){return D.fitScreenCoordinates(C,L,_._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",y)}},ol.prototype.keydown=function(y){this._active&&y.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",y))},ol.prototype.blur=function(){this.reset()},ol.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(l.remove(this._box),this._box=null),l.enableDrag(),delete this._startPos,delete this._lastPos},ol.prototype._fireEvent=function(y,b){return this._map.fire(new o.Event(y,{originalEvent:b}))};var op=function(y){this.reset(),this.numTouches=y.numTouches};op.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},op.prototype.touchstart=function(y,b,_){(this.centroid||_.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=y.timeStamp),_.length===this.numTouches&&(this.centroid=function(C){for(var L=new o.Point(0,0),D=0,F=C;D<F.length;D+=1)L._add(F[D]);return L.div(C.length)}(b),this.touches=bv(_,b)))},op.prototype.touchmove=function(y,b,_){if(!this.aborted&&this.centroid){var C=bv(_,b);for(var L in this.touches){var D=C[L];(!D||D.dist(this.touches[L])>30)&&(this.aborted=!0)}}},op.prototype.touchend=function(y,b,_){if((!this.centroid||y.timeStamp-this.startTime>500)&&(this.aborted=!0),_.length===0){var C=!this.aborted&&this.centroid;if(this.reset(),C)return C}};var js=function(y){this.singleTap=new op(y),this.numTaps=y.numTaps,this.reset()};js.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},js.prototype.touchstart=function(y,b,_){this.singleTap.touchstart(y,b,_)},js.prototype.touchmove=function(y,b,_){this.singleTap.touchmove(y,b,_)},js.prototype.touchend=function(y,b,_){var C=this.singleTap.touchend(y,b,_);if(C){var L=y.timeStamp-this.lastTime<500,D=!this.lastTap||this.lastTap.dist(C)<30;if(L&&D||this.reset(),this.count++,this.lastTime=y.timeStamp,this.lastTap=C,this.count===this.numTaps)return this.reset(),C}};var ha=function(){this._zoomIn=new js({numTouches:1,numTaps:2}),this._zoomOut=new js({numTouches:2,numTaps:1}),this.reset()};ha.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},ha.prototype.touchstart=function(y,b,_){this._zoomIn.touchstart(y,b,_),this._zoomOut.touchstart(y,b,_)},ha.prototype.touchmove=function(y,b,_){this._zoomIn.touchmove(y,b,_),this._zoomOut.touchmove(y,b,_)},ha.prototype.touchend=function(y,b,_){var C=this,L=this._zoomIn.touchend(y,b,_),D=this._zoomOut.touchend(y,b,_);return L?(this._active=!0,y.preventDefault(),setTimeout(function(){return C.reset()},0),{cameraAnimation:function(F){return F.easeTo({duration:300,zoom:F.getZoom()+1,around:F.unproject(L)},{originalEvent:y})}}):D?(this._active=!0,y.preventDefault(),setTimeout(function(){return C.reset()},0),{cameraAnimation:function(F){return F.easeTo({duration:300,zoom:F.getZoom()-1,around:F.unproject(D)},{originalEvent:y})}}):void 0},ha.prototype.touchcancel=function(){this.reset()},ha.prototype.enable=function(){this._enabled=!0},ha.prototype.disable=function(){this._enabled=!1,this.reset()},ha.prototype.isEnabled=function(){return this._enabled},ha.prototype.isActive=function(){return this._active};var Bg={0:1,2:2},_r=function(y){this.reset(),this._clickTolerance=y.clickTolerance||1};_r.prototype.blur=function(){this.reset()},_r.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},_r.prototype._correctButton=function(y,b){return!1},_r.prototype._move=function(y,b){return{}},_r.prototype.mousedown=function(y,b){if(!this._lastPoint){var _=l.mouseButton(y);this._correctButton(y,_)&&(this._lastPoint=b,this._eventButton=_)}},_r.prototype.mousemoveWindow=function(y,b){var _=this._lastPoint;if(_){if(y.preventDefault(),function(C,L){var D=Bg[L];return C.buttons===void 0||(C.buttons&D)!==D}(y,this._eventButton))this.reset();else if(this._moved||!(b.dist(_)<this._clickTolerance))return this._moved=!0,this._lastPoint=b,this._move(_,b)}},_r.prototype.mouseupWindow=function(y){this._lastPoint&&l.mouseButton(y)===this._eventButton&&(this._moved&&l.suppressClick(),this.reset())},_r.prototype.enable=function(){this._enabled=!0},_r.prototype.disable=function(){this._enabled=!1,this.reset()},_r.prototype.isEnabled=function(){return this._enabled},_r.prototype.isActive=function(){return this._active};var mh=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.mousedown=function(_,C){y.prototype.mousedown.call(this,_,C),this._lastPoint&&(this._active=!0)},b.prototype._correctButton=function(_,C){return C===0&&!_.ctrlKey},b.prototype._move=function(_,C){return{around:C,panDelta:C.sub(_)}},b}(_r),Ev=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype._correctButton=function(_,C){return C===0&&_.ctrlKey||C===2},b.prototype._move=function(_,C){var L=.8*(C.x-_.x);if(L)return this._active=!0,{bearingDelta:L}},b.prototype.contextmenu=function(_){_.preventDefault()},b}(_r),Ng=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype._correctButton=function(_,C){return C===0&&_.ctrlKey||C===2},b.prototype._move=function(_,C){var L=-.5*(C.y-_.y);if(L)return this._active=!0,{pitchDelta:L}},b.prototype.contextmenu=function(_){_.preventDefault()},b}(_r),bu=function(y){this._minTouches=1,this._clickTolerance=y.clickTolerance||1,this.reset()};bu.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new o.Point(0,0)},bu.prototype.touchstart=function(y,b,_){return this._calculateTransform(y,b,_)},bu.prototype.touchmove=function(y,b,_){if(this._active&&!(_.length<this._minTouches))return y.preventDefault(),this._calculateTransform(y,b,_)},bu.prototype.touchend=function(y,b,_){this._calculateTransform(y,b,_),this._active&&_.length<this._minTouches&&this.reset()},bu.prototype.touchcancel=function(){this.reset()},bu.prototype._calculateTransform=function(y,b,_){_.length>0&&(this._active=!0);var C=bv(_,b),L=new o.Point(0,0),D=new o.Point(0,0),F=0;for(var $ in C){var j=C[$],et=this._touches[$];et&&(L._add(j),D._add(j.sub(et)),F++,C[$]=j)}if(this._touches=C,!(F<this._minTouches)&&D.mag()){var ut=D.div(F);if(this._sum._add(ut),!(this._sum.mag()<this._clickTolerance))return{around:L.div(F),panDelta:ut}}},bu.prototype.enable=function(){this._enabled=!0},bu.prototype.disable=function(){this._enabled=!1,this.reset()},bu.prototype.isEnabled=function(){return this._enabled},bu.prototype.isActive=function(){return this._active};var Al=function(){this.reset()};function kg(y,b,_){for(var C=0;C<y.length;C++)if(y[C].identifier===_)return b[C]}function zg(y,b){return Math.log(y/b)/Math.LN2}Al.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Al.prototype._start=function(y){},Al.prototype._move=function(y,b,_){return{}},Al.prototype.touchstart=function(y,b,_){this._firstTwoTouches||_.length<2||(this._firstTwoTouches=[_[0].identifier,_[1].identifier],this._start([b[0],b[1]]))},Al.prototype.touchmove=function(y,b,_){if(this._firstTwoTouches){y.preventDefault();var C=this._firstTwoTouches,L=C[1],D=kg(_,b,C[0]),F=kg(_,b,L);if(D&&F){var $=this._aroundCenter?null:D.add(F).div(2);return this._move([D,F],$,y)}}},Al.prototype.touchend=function(y,b,_){if(this._firstTwoTouches){var C=this._firstTwoTouches,L=C[1],D=kg(_,b,C[0]),F=kg(_,b,L);D&&F||(this._active&&l.suppressClick(),this.reset())}},Al.prototype.touchcancel=function(){this.reset()},Al.prototype.enable=function(y){this._enabled=!0,this._aroundCenter=!!y&&y.around==="center"},Al.prototype.disable=function(){this._enabled=!1,this.reset()},Al.prototype.isEnabled=function(){return this._enabled},Al.prototype.isActive=function(){return this._active};var Ys=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.reset=function(){y.prototype.reset.call(this),delete this._distance,delete this._startDistance},b.prototype._start=function(_){this._startDistance=this._distance=_[0].dist(_[1])},b.prototype._move=function(_,C){var L=this._distance;if(this._distance=_[0].dist(_[1]),this._active||!(Math.abs(zg(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:zg(this._distance,L),pinchAround:C}},b}(Al);function bc(y,b){return 180*y.angleWith(b)/Math.PI}var q_=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.reset=function(){y.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},b.prototype._start=function(_){this._startVector=this._vector=_[0].sub(_[1]),this._minDiameter=_[0].dist(_[1])},b.prototype._move=function(_,C){var L=this._vector;if(this._vector=_[0].sub(_[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:bc(this._vector,L),pinchAround:C}},b.prototype._isBelowThreshold=function(_){this._minDiameter=Math.min(this._minDiameter,_.mag());var C=25/(Math.PI*this._minDiameter)*360,L=bc(_,this._startVector);return Math.abs(L)<C},b}(Al);function sp(y){return Math.abs(y.y)>Math.abs(y.x)}var Ug=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.reset=function(){y.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},b.prototype._start=function(_){this._lastPoints=_,sp(_[0].sub(_[1]))&&(this._valid=!1)},b.prototype._move=function(_,C,L){var D=_[0].sub(this._lastPoints[0]),F=_[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(D,F,L.timeStamp),this._valid)return this._lastPoints=_,this._active=!0,{pitchDelta:(D.y+F.y)/2*-.5}},b.prototype.gestureBeginsVertically=function(_,C,L){if(this._valid!==void 0)return this._valid;var D=_.mag()>=2,F=C.mag()>=2;if(D||F){if(!D||!F)return this._firstMove===void 0&&(this._firstMove=L),L-this._firstMove<100&&void 0;var $=_.y>0==C.y>0;return sp(_)&&sp(C)&&$}},b}(Al),H0={panStep:100,bearingStep:15,pitchStep:10},Ml=function(){var y=H0;this._panStep=y.panStep,this._bearingStep=y.bearingStep,this._pitchStep=y.pitchStep,this._rotationDisabled=!1};function Ql(y){return y*(2-y)}Ml.prototype.blur=function(){this.reset()},Ml.prototype.reset=function(){this._active=!1},Ml.prototype.keydown=function(y){var b=this;if(!(y.altKey||y.ctrlKey||y.metaKey)){var _=0,C=0,L=0,D=0,F=0;switch(y.keyCode){case 61:case 107:case 171:case 187:_=1;break;case 189:case 109:case 173:_=-1;break;case 37:y.shiftKey?C=-1:(y.preventDefault(),D=-1);break;case 39:y.shiftKey?C=1:(y.preventDefault(),D=1);break;case 38:y.shiftKey?L=1:(y.preventDefault(),F=-1);break;case 40:y.shiftKey?L=-1:(y.preventDefault(),F=1);break;default:return}return this._rotationDisabled&&(C=0,L=0),{cameraAnimation:function($){var j=$.getZoom();$.easeTo({duration:300,easeId:"keyboardHandler",easing:Ql,zoom:_?Math.round(j)+_*(y.shiftKey?2:1):j,bearing:$.getBearing()+C*b._bearingStep,pitch:$.getPitch()+L*b._pitchStep,offset:[-D*b._panStep,-F*b._panStep],center:$.getCenter()},{originalEvent:y})}}}},Ml.prototype.enable=function(){this._enabled=!0},Ml.prototype.disable=function(){this._enabled=!1,this.reset()},Ml.prototype.isEnabled=function(){return this._enabled},Ml.prototype.isActive=function(){return this._active},Ml.prototype.disableRotation=function(){this._rotationDisabled=!0},Ml.prototype.enableRotation=function(){this._rotationDisabled=!1};var Vn=function(y,b){this._map=y,this._el=y.getCanvasContainer(),this._handler=b,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,o.bindAll(["_onTimeout"],this)};Vn.prototype.setZoomRate=function(y){this._defaultZoomRate=y},Vn.prototype.setWheelZoomRate=function(y){this._wheelZoomRate=y},Vn.prototype.isEnabled=function(){return!!this._enabled},Vn.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},Vn.prototype.isZooming=function(){return!!this._zooming},Vn.prototype.enable=function(y){this.isEnabled()||(this._enabled=!0,this._aroundCenter=y&&y.around==="center")},Vn.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Vn.prototype.wheel=function(y){if(this.isEnabled()){var b=y.deltaMode===o.window.WheelEvent.DOM_DELTA_LINE?40*y.deltaY:y.deltaY,_=o.browser.now(),C=_-(this._lastWheelEventTime||0);this._lastWheelEventTime=_,b!==0&&b%4.000244140625==0?this._type="wheel":b!==0&&Math.abs(b)<4?this._type="trackpad":C>400?(this._type=null,this._lastValue=b,this._timeout=setTimeout(this._onTimeout,40,y)):this._type||(this._type=Math.abs(C*b)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,b+=this._lastValue)),y.shiftKey&&b&&(b/=4),this._type&&(this._lastWheelEvent=y,this._delta-=b,this._active||this._start(y)),y.preventDefault()}},Vn.prototype._onTimeout=function(y){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(y)},Vn.prototype._start=function(y){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var b=l.mousePos(this._el,y);this._around=o.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(b)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Vn.prototype.renderFrame=function(){var y=this;if(this._frameId&&(this._frameId=null,this.isActive())){var b=this._map.transform;if(this._delta!==0){var _=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,C=2/(1+Math.exp(-Math.abs(this._delta*_)));this._delta<0&&C!==0&&(C=1/C);var L=typeof this._targetZoom=="number"?b.zoomScale(this._targetZoom):b.scale;this._targetZoom=Math.min(b.maxZoom,Math.max(b.minZoom,b.scaleZoom(L*C))),this._type==="wheel"&&(this._startZoom=b.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var D,F=typeof this._targetZoom=="number"?this._targetZoom:b.zoom,$=this._startZoom,j=this._easing,et=!1;if(this._type==="wheel"&&$&&j){var ut=Math.min((o.browser.now()-this._lastWheelEventTime)/200,1),ht=j(ut);D=o.number($,F,ht),ut<1?this._frameId||(this._frameId=!0):et=!0}else D=F,et=!0;return this._active=!0,et&&(this._active=!1,this._finishTimeout=setTimeout(function(){y._zooming=!1,y._handler._triggerRenderFrame(),delete y._targetZoom,delete y._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!et,zoomDelta:D-b.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Vn.prototype._smoothOutEasing=function(y){var b=o.ease;if(this._prevEase){var _=this._prevEase,C=(o.browser.now()-_.start)/_.duration,L=_.easing(C+.01)-_.easing(C),D=.27/Math.sqrt(L*L+1e-4)*.01,F=Math.sqrt(.0729-D*D);b=o.bezier(D,F,.25,1)}return this._prevEase={start:o.browser.now(),duration:y,easing:b},b},Vn.prototype.blur=function(){this.reset()},Vn.prototype.reset=function(){this._active=!1};var Jl=function(y,b){this._clickZoom=y,this._tapZoom=b};Jl.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Jl.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Jl.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Jl.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var tu=function(){this.reset()};tu.prototype.reset=function(){this._active=!1},tu.prototype.blur=function(){this.reset()},tu.prototype.dblclick=function(y,b){return y.preventDefault(),{cameraAnimation:function(_){_.easeTo({duration:300,zoom:_.getZoom()+(y.shiftKey?-1:1),around:_.unproject(b)},{originalEvent:y})}}},tu.prototype.enable=function(){this._enabled=!0},tu.prototype.disable=function(){this._enabled=!1,this.reset()},tu.prototype.isEnabled=function(){return this._enabled},tu.prototype.isActive=function(){return this._active};var hs=function(){this._tap=new js({numTouches:1,numTaps:1}),this.reset()};hs.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},hs.prototype.touchstart=function(y,b,_){this._swipePoint||(this._tapTime&&y.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?_.length>0&&(this._swipePoint=b[0],this._swipeTouch=_[0].identifier):this._tap.touchstart(y,b,_))},hs.prototype.touchmove=function(y,b,_){if(this._tapTime){if(this._swipePoint){if(_[0].identifier!==this._swipeTouch)return;var C=b[0],L=C.y-this._swipePoint.y;return this._swipePoint=C,y.preventDefault(),this._active=!0,{zoomDelta:L/128}}}else this._tap.touchmove(y,b,_)},hs.prototype.touchend=function(y,b,_){this._tapTime?this._swipePoint&&_.length===0&&this.reset():this._tap.touchend(y,b,_)&&(this._tapTime=y.timeStamp)},hs.prototype.touchcancel=function(){this.reset()},hs.prototype.enable=function(){this._enabled=!0},hs.prototype.disable=function(){this._enabled=!1,this.reset()},hs.prototype.isEnabled=function(){return this._enabled},hs.prototype.isActive=function(){return this._active};var pf=function(y,b,_){this._el=y,this._mousePan=b,this._touchPan=_};pf.prototype.enable=function(y){this._inertiaOptions=y||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},pf.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},pf.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},pf.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var yh=function(y,b,_){this._pitchWithRotate=y.pitchWithRotate,this._mouseRotate=b,this._mousePitch=_};yh.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},yh.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},yh.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},yh.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var Eu=function(y,b,_,C){this._el=y,this._touchZoom=b,this._touchRotate=_,this._tapDragZoom=C,this._rotationDisabled=!1,this._enabled=!0};Eu.prototype.enable=function(y){this._touchZoom.enable(y),this._rotationDisabled||this._touchRotate.enable(y),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},Eu.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},Eu.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},Eu.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},Eu.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},Eu.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var Fs=function(y){return y.zoom||y.drag||y.pitch||y.rotate},lp=function(y){function b(){y.apply(this,arguments)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b}(o.Event);function on(y){return y.panDelta&&y.panDelta.mag()||y.zoomDelta||y.bearingDelta||y.pitchDelta}var Zr=function(y,b){this._map=y,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new xv(y),this._bearingSnap=b.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(b),o.bindAll(["handleEvent","handleWindowEvent"],this);var _=this._el;this._listeners=[[_,"touchstart",{passive:!0}],[_,"touchmove",{passive:!1}],[_,"touchend",void 0],[_,"touchcancel",void 0],[_,"mousedown",void 0],[_,"mousemove",void 0],[_,"mouseup",void 0],[o.window.document,"mousemove",{capture:!0}],[o.window.document,"mouseup",void 0],[_,"mouseover",void 0],[_,"mouseout",void 0],[_,"dblclick",void 0],[_,"click",void 0],[_,"keydown",{capture:!1}],[_,"keyup",void 0],[_,"wheel",{passive:!1}],[_,"contextmenu",void 0],[o.window,"blur",void 0]];for(var C=0,L=this._listeners;C<L.length;C+=1){var D=L[C],F=D[0];l.addEventListener(F,D[1],F===o.window.document?this.handleWindowEvent:this.handleEvent,D[2])}};Zr.prototype.destroy=function(){for(var y=0,b=this._listeners;y<b.length;y+=1){var _=b[y],C=_[0];l.removeEventListener(C,_[1],C===o.window.document?this.handleWindowEvent:this.handleEvent,_[2])}},Zr.prototype._addDefaultHandlers=function(y){var b=this._map,_=b.getCanvasContainer();this._add("mapEvent",new vo(b,y));var C=b.boxZoom=new ol(b,y);this._add("boxZoom",C);var L=new ha,D=new tu;b.doubleClickZoom=new Jl(D,L),this._add("tapZoom",L),this._add("clickZoom",D);var F=new hs;this._add("tapDragZoom",F);var $=b.touchPitch=new Ug;this._add("touchPitch",$);var j=new Ev(y),et=new Ng(y);b.dragRotate=new yh(y,j,et),this._add("mouseRotate",j,["mousePitch"]),this._add("mousePitch",et,["mouseRotate"]);var ut=new mh(y),ht=new bu(y);b.dragPan=new pf(_,ut,ht),this._add("mousePan",ut),this._add("touchPan",ht,["touchZoom","touchRotate"]);var dt=new q_,Ot=new Ys;b.touchZoomRotate=new Eu(_,Ot,dt,F),this._add("touchRotate",dt,["touchPan","touchZoom"]),this._add("touchZoom",Ot,["touchPan","touchRotate"]);var At=b.scrollZoom=new Vn(b,this);this._add("scrollZoom",At,["mousePan"]);var $t=b.keyboard=new Ml;this._add("keyboard",$t),this._add("blockableMapEvent",new Wr(b));for(var Ct=0,zt=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Ct<zt.length;Ct+=1){var qt=zt[Ct];y.interactive&&y[qt]&&b[qt].enable(y[qt])}},Zr.prototype._add=function(y,b,_){this._handlers.push({handlerName:y,handler:b,allowed:_}),this._handlersById[y]=b},Zr.prototype.stop=function(y){if(!this._updatingCamera){for(var b=0,_=this._handlers;b<_.length;b+=1)_[b].handler.reset();this._inertia.clear(),this._fireEvents({},{},y),this._changes=[]}},Zr.prototype.isActive=function(){for(var y=0,b=this._handlers;y<b.length;y+=1)if(b[y].handler.isActive())return!0;return!1},Zr.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Zr.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Zr.prototype.isMoving=function(){return!!Fs(this._eventsInProgress)||this.isZooming()},Zr.prototype._blockedByActive=function(y,b,_){for(var C in y)if(C!==_&&(!b||b.indexOf(C)<0))return!0;return!1},Zr.prototype.handleWindowEvent=function(y){this.handleEvent(y,y.type+"Window")},Zr.prototype._getMapTouches=function(y){for(var b=[],_=0,C=y;_<C.length;_+=1){var L=C[_];this._el.contains(L.target)&&b.push(L)}return b},Zr.prototype.handleEvent=function(y,b){this._updatingCamera=!0;for(var _=y.type==="renderFrame"?void 0:y,C={needsRenderFrame:!1},L={},D={},F=y.touches?this._getMapTouches(y.touches):void 0,$=F?l.touchPos(this._el,F):l.mousePos(this._el,y),j=0,et=this._handlers;j<et.length;j+=1){var ut=et[j],ht=ut.handlerName,dt=ut.handler,Ot=ut.allowed;if(dt.isEnabled()){var At=void 0;this._blockedByActive(D,Ot,ht)?dt.reset():dt[b||y.type]&&(At=dt[b||y.type](y,$,F),this.mergeHandlerResult(C,L,At,ht,_),At&&At.needsRenderFrame&&this._triggerRenderFrame()),(At||dt.isActive())&&(D[ht]=dt)}}var $t={};for(var Ct in this._previousActiveHandlers)D[Ct]||($t[Ct]=_);this._previousActiveHandlers=D,(Object.keys($t).length||on(C))&&(this._changes.push([C,L,$t]),this._triggerRenderFrame()),(Object.keys(D).length||on(C))&&this._map._stop(!0),this._updatingCamera=!1;var zt=C.cameraAnimation;zt&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],zt(this._map))},Zr.prototype.mergeHandlerResult=function(y,b,_,C,L){if(_){o.extend(y,_);var D={handlerName:C,originalEvent:_.originalEvent||L};_.zoomDelta!==void 0&&(b.zoom=D),_.panDelta!==void 0&&(b.drag=D),_.pitchDelta!==void 0&&(b.pitch=D),_.bearingDelta!==void 0&&(b.rotate=D)}},Zr.prototype._applyChanges=function(){for(var y={},b={},_={},C=0,L=this._changes;C<L.length;C+=1){var D=L[C],F=D[0],$=D[1],j=D[2];F.panDelta&&(y.panDelta=(y.panDelta||new o.Point(0,0))._add(F.panDelta)),F.zoomDelta&&(y.zoomDelta=(y.zoomDelta||0)+F.zoomDelta),F.bearingDelta&&(y.bearingDelta=(y.bearingDelta||0)+F.bearingDelta),F.pitchDelta&&(y.pitchDelta=(y.pitchDelta||0)+F.pitchDelta),F.around!==void 0&&(y.around=F.around),F.pinchAround!==void 0&&(y.pinchAround=F.pinchAround),F.noInertia&&(y.noInertia=F.noInertia),o.extend(b,$),o.extend(_,j)}this._updateMapTransform(y,b,_),this._changes=[]},Zr.prototype._updateMapTransform=function(y,b,_){var C=this._map,L=C.transform;if(!on(y))return this._fireEvents(b,_,!0);var D=y.panDelta,F=y.zoomDelta,$=y.bearingDelta,j=y.pitchDelta,et=y.around,ut=y.pinchAround;ut!==void 0&&(et=ut),C._stop(!0),et=et||C.transform.centerPoint;var ht=L.pointLocation(D?et.sub(D):et);$&&(L.bearing+=$),j&&(L.pitch+=j),F&&(L.zoom+=F),L.setLocationAtPoint(ht,et),this._map._update(),y.noInertia||this._inertia.record(y),this._fireEvents(b,_,!0)},Zr.prototype._fireEvents=function(y,b,_){var C=this,L=Fs(this._eventsInProgress),D=Fs(y),F={};for(var $ in y)this._eventsInProgress[$]||(F[$+"start"]=y[$].originalEvent),this._eventsInProgress[$]=y[$];for(var j in!L&&D&&this._fireEvent("movestart",D.originalEvent),F)this._fireEvent(j,F[j]);for(var et in D&&this._fireEvent("move",D.originalEvent),y)this._fireEvent(et,y[et].originalEvent);var ut,ht={};for(var dt in this._eventsInProgress){var Ot=this._eventsInProgress[dt],At=Ot.handlerName,$t=Ot.originalEvent;this._handlersById[At].isActive()||(delete this._eventsInProgress[dt],ht[dt+"end"]=ut=b[At]||$t)}for(var Ct in ht)this._fireEvent(Ct,ht[Ct]);var zt=Fs(this._eventsInProgress);if(_&&(L||D)&&!zt){this._updatingCamera=!0;var qt=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),se=function(Ee){return Ee!==0&&-C._bearingSnap<Ee&&Ee<C._bearingSnap};qt?(se(qt.bearing||this._map.getBearing())&&(qt.bearing=0),this._map.easeTo(qt,{originalEvent:ut})):(this._map.fire(new o.Event("moveend",{originalEvent:ut})),se(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},Zr.prototype._fireEvent=function(y,b){this._map.fire(new o.Event(y,b?{originalEvent:b}:{}))},Zr.prototype._requestFrame=function(){var y=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(b){delete y._frameId,y.handleEvent(new lp("renderFrame",{timeStamp:b})),y._applyChanges()})},Zr.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var Rl=function(y){function b(_,C){y.call(this),this._moving=!1,this._zooming=!1,this.transform=_,this._bearingSnap=C.bearingSnap,o.bindAll(["_renderFrameCallback"],this)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.getCenter=function(){return new o.LngLat(this.transform.center.lng,this.transform.center.lat)},b.prototype.setCenter=function(_,C){return this.jumpTo({center:_},C)},b.prototype.panBy=function(_,C,L){return _=o.Point.convert(_).mult(-1),this.panTo(this.transform.center,o.extend({offset:_},C),L)},b.prototype.panTo=function(_,C,L){return this.easeTo(o.extend({center:_},C),L)},b.prototype.getZoom=function(){return this.transform.zoom},b.prototype.setZoom=function(_,C){return this.jumpTo({zoom:_},C),this},b.prototype.zoomTo=function(_,C,L){return this.easeTo(o.extend({zoom:_},C),L)},b.prototype.zoomIn=function(_,C){return this.zoomTo(this.getZoom()+1,_,C),this},b.prototype.zoomOut=function(_,C){return this.zoomTo(this.getZoom()-1,_,C),this},b.prototype.getBearing=function(){return this.transform.bearing},b.prototype.setBearing=function(_,C){return this.jumpTo({bearing:_},C),this},b.prototype.getPadding=function(){return this.transform.padding},b.prototype.setPadding=function(_,C){return this.jumpTo({padding:_},C),this},b.prototype.rotateTo=function(_,C,L){return this.easeTo(o.extend({bearing:_},C),L)},b.prototype.resetNorth=function(_,C){return this.rotateTo(0,o.extend({duration:1e3},_),C),this},b.prototype.resetNorthPitch=function(_,C){return this.easeTo(o.extend({bearing:0,pitch:0,duration:1e3},_),C),this},b.prototype.snapToNorth=function(_,C){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(_,C):this},b.prototype.getPitch=function(){return this.transform.pitch},b.prototype.setPitch=function(_,C){return this.jumpTo({pitch:_},C),this},b.prototype.cameraForBounds=function(_,C){_=o.LngLatBounds.convert(_);var L=C&&C.bearing||0;return this._cameraForBoxAndBearing(_.getNorthWest(),_.getSouthEast(),L,C)},b.prototype._cameraForBoxAndBearing=function(_,C,L,D){var F={top:0,bottom:0,right:0,left:0};if(typeof(D=o.extend({padding:F,offset:[0,0],maxZoom:this.transform.maxZoom},D)).padding=="number"){var $=D.padding;D.padding={top:$,bottom:$,right:$,left:$}}D.padding=o.extend(F,D.padding);var j=this.transform,et=j.padding,ut=j.project(o.LngLat.convert(_)),ht=j.project(o.LngLat.convert(C)),dt=ut.rotate(-L*Math.PI/180),Ot=ht.rotate(-L*Math.PI/180),At=new o.Point(Math.max(dt.x,Ot.x),Math.max(dt.y,Ot.y)),$t=new o.Point(Math.min(dt.x,Ot.x),Math.min(dt.y,Ot.y)),Ct=At.sub($t),zt=(j.width-(et.left+et.right+D.padding.left+D.padding.right))/Ct.x,qt=(j.height-(et.top+et.bottom+D.padding.top+D.padding.bottom))/Ct.y;if(!(qt<0||zt<0)){var se=Math.min(j.scaleZoom(j.scale*Math.min(zt,qt)),D.maxZoom),Ee=typeof D.offset.x=="number"?new o.Point(D.offset.x,D.offset.y):o.Point.convert(D.offset),pe=new o.Point((D.padding.left-D.padding.right)/2,(D.padding.top-D.padding.bottom)/2).rotate(L*Math.PI/180),Ae=Ee.add(pe).mult(j.scale/j.zoomScale(se));return{center:j.unproject(ut.add(ht).div(2).sub(Ae)),zoom:se,bearing:L}}o.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},b.prototype.fitBounds=function(_,C,L){return this._fitInternal(this.cameraForBounds(_,C),C,L)},b.prototype.fitScreenCoordinates=function(_,C,L,D,F){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(o.Point.convert(_)),this.transform.pointLocation(o.Point.convert(C)),L,D),D,F)},b.prototype._fitInternal=function(_,C,L){return _?(delete(C=o.extend(_,C)).padding,C.linear?this.easeTo(C,L):this.flyTo(C,L)):this},b.prototype.jumpTo=function(_,C){this.stop();var L=this.transform,D=!1,F=!1,$=!1;return"zoom"in _&&L.zoom!==+_.zoom&&(D=!0,L.zoom=+_.zoom),_.center!==void 0&&(L.center=o.LngLat.convert(_.center)),"bearing"in _&&L.bearing!==+_.bearing&&(F=!0,L.bearing=+_.bearing),"pitch"in _&&L.pitch!==+_.pitch&&($=!0,L.pitch=+_.pitch),_.padding==null||L.isPaddingEqual(_.padding)||(L.padding=_.padding),this.fire(new o.Event("movestart",C)).fire(new o.Event("move",C)),D&&this.fire(new o.Event("zoomstart",C)).fire(new o.Event("zoom",C)).fire(new o.Event("zoomend",C)),F&&this.fire(new o.Event("rotatestart",C)).fire(new o.Event("rotate",C)).fire(new o.Event("rotateend",C)),$&&this.fire(new o.Event("pitchstart",C)).fire(new o.Event("pitch",C)).fire(new o.Event("pitchend",C)),this.fire(new o.Event("moveend",C))},b.prototype.easeTo=function(_,C){var L=this;this._stop(!1,_.easeId),((_=o.extend({offset:[0,0],duration:500,easing:o.ease},_)).animate===!1||!_.essential&&o.browser.prefersReducedMotion)&&(_.duration=0);var D=this.transform,F=this.getZoom(),$=this.getBearing(),j=this.getPitch(),et=this.getPadding(),ut="zoom"in _?+_.zoom:F,ht="bearing"in _?this._normalizeBearing(_.bearing,$):$,dt="pitch"in _?+_.pitch:j,Ot="padding"in _?_.padding:D.padding,At=o.Point.convert(_.offset),$t=D.centerPoint.add(At),Ct=D.pointLocation($t),zt=o.LngLat.convert(_.center||Ct);this._normalizeCenter(zt);var qt,se,Ee=D.project(Ct),pe=D.project(zt).sub(Ee),Ae=D.zoomScale(ut-F);_.around&&(qt=o.LngLat.convert(_.around),se=D.locationPoint(qt));var Ve={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||ut!==F,this._rotating=this._rotating||$!==ht,this._pitching=this._pitching||dt!==j,this._padding=!D.isPaddingEqual(Ot),this._easeId=_.easeId,this._prepareEase(C,_.noMoveStart,Ve),this._ease(function(cr){if(L._zooming&&(D.zoom=o.number(F,ut,cr)),L._rotating&&(D.bearing=o.number($,ht,cr)),L._pitching&&(D.pitch=o.number(j,dt,cr)),L._padding&&(D.interpolatePadding(et,Ot,cr),$t=D.centerPoint.add(At)),qt)D.setLocationAtPoint(qt,se);else{var ar=D.zoomScale(D.zoom-F),Mr=ut>F?Math.min(2,Ae):Math.max(.5,Ae),sn=Math.pow(Mr,1-cr),hn=D.unproject(Ee.add(pe.mult(cr*sn)).mult(ar));D.setLocationAtPoint(D.renderWorldCopies?hn.wrap():hn,$t)}L._fireMoveEvents(C)},function(cr){L._afterEase(C,cr)},_),this},b.prototype._prepareEase=function(_,C,L){L===void 0&&(L={}),this._moving=!0,C||L.moving||this.fire(new o.Event("movestart",_)),this._zooming&&!L.zooming&&this.fire(new o.Event("zoomstart",_)),this._rotating&&!L.rotating&&this.fire(new o.Event("rotatestart",_)),this._pitching&&!L.pitching&&this.fire(new o.Event("pitchstart",_))},b.prototype._fireMoveEvents=function(_){this.fire(new o.Event("move",_)),this._zooming&&this.fire(new o.Event("zoom",_)),this._rotating&&this.fire(new o.Event("rotate",_)),this._pitching&&this.fire(new o.Event("pitch",_))},b.prototype._afterEase=function(_,C){if(!this._easeId||!C||this._easeId!==C){delete this._easeId;var L=this._zooming,D=this._rotating,F=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,L&&this.fire(new o.Event("zoomend",_)),D&&this.fire(new o.Event("rotateend",_)),F&&this.fire(new o.Event("pitchend",_)),this.fire(new o.Event("moveend",_))}},b.prototype.flyTo=function(_,C){var L=this;if(!_.essential&&o.browser.prefersReducedMotion){var D=o.pick(_,["center","zoom","bearing","pitch","around"]);return this.jumpTo(D,C)}this.stop(),_=o.extend({offset:[0,0],speed:1.2,curve:1.42,easing:o.ease},_);var F=this.transform,$=this.getZoom(),j=this.getBearing(),et=this.getPitch(),ut=this.getPadding(),ht="zoom"in _?o.clamp(+_.zoom,F.minZoom,F.maxZoom):$,dt="bearing"in _?this._normalizeBearing(_.bearing,j):j,Ot="pitch"in _?+_.pitch:et,At="padding"in _?_.padding:F.padding,$t=F.zoomScale(ht-$),Ct=o.Point.convert(_.offset),zt=F.centerPoint.add(Ct),qt=F.pointLocation(zt),se=o.LngLat.convert(_.center||qt);this._normalizeCenter(se);var Ee=F.project(qt),pe=F.project(se).sub(Ee),Ae=_.curve,Ve=Math.max(F.width,F.height),cr=Ve/$t,ar=pe.mag();if("minZoom"in _){var Mr=o.clamp(Math.min(_.minZoom,$,ht),F.minZoom,F.maxZoom),sn=Ve/F.zoomScale(Mr-$);Ae=Math.sqrt(sn/ar*2)}var hn=Ae*Ae;function cn(Sn){var bn=(cr*cr-Ve*Ve+(Sn?-1:1)*hn*hn*ar*ar)/(2*(Sn?cr:Ve)*hn*ar);return Math.log(Math.sqrt(bn*bn+1)-bn)}function Ii(Sn){return(Math.exp(Sn)-Math.exp(-Sn))/2}function kr(Sn){return(Math.exp(Sn)+Math.exp(-Sn))/2}var Ln=cn(0),Xn=function(Sn){return kr(Ln)/kr(Ln+Ae*Sn)},Rn=function(Sn){return Ve*((kr(Ln)*(Ii(bn=Ln+Ae*Sn)/kr(bn))-Ii(Ln))/hn)/ar;var bn},Cn=(cn(1)-Ln)/Ae;if(Math.abs(ar)<1e-6||!isFinite(Cn)){if(Math.abs(Ve-cr)<1e-6)return this.easeTo(_,C);var $n=cr<Ve?-1:1;Cn=Math.abs(Math.log(cr/Ve))/Ae,Rn=function(){return 0},Xn=function(Sn){return Math.exp($n*Ae*Sn)}}return _.duration="duration"in _?+_.duration:1e3*Cn/("screenSpeed"in _?+_.screenSpeed/Ae:+_.speed),_.maxDuration&&_.duration>_.maxDuration&&(_.duration=0),this._zooming=!0,this._rotating=j!==dt,this._pitching=Ot!==et,this._padding=!F.isPaddingEqual(At),this._prepareEase(C,!1),this._ease(function(Sn){var bn=Sn*Cn,Mo=1/Xn(bn);F.zoom=Sn===1?ht:$+F.scaleZoom(Mo),L._rotating&&(F.bearing=o.number(j,dt,Sn)),L._pitching&&(F.pitch=o.number(et,Ot,Sn)),L._padding&&(F.interpolatePadding(ut,At,Sn),zt=F.centerPoint.add(Ct));var ja=Sn===1?se:F.unproject(Ee.add(pe.mult(Rn(bn))).mult(Mo));F.setLocationAtPoint(F.renderWorldCopies?ja.wrap():ja,zt),L._fireMoveEvents(C)},function(){return L._afterEase(C)},_),this},b.prototype.isEasing=function(){return!!this._easeFrameId},b.prototype.stop=function(){return this._stop()},b.prototype._stop=function(_,C){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var L=this._onEaseEnd;delete this._onEaseEnd,L.call(this,C)}if(!_){var D=this.handlers;D&&D.stop(!1)}return this},b.prototype._ease=function(_,C,L){L.animate===!1||L.duration===0?(_(1),C()):(this._easeStart=o.browser.now(),this._easeOptions=L,this._onEaseFrame=_,this._onEaseEnd=C,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},b.prototype._renderFrameCallback=function(){var _=Math.min((o.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(_)),_<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},b.prototype._normalizeBearing=function(_,C){_=o.wrap(_,-180,180);var L=Math.abs(_-C);return Math.abs(_-360-C)<L&&(_-=360),Math.abs(_+360-C)<L&&(_+=360),_},b.prototype._normalizeCenter=function(_){var C=this.transform;if(C.renderWorldCopies&&!C.lngRange){var L=_.lng-C.center.lng;_.lng+=L>180?-360:L<-180?360:0}},b}(o.Evented),Bs=function(y){y===void 0&&(y={}),this.options=y,o.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};Bs.prototype.getDefaultPosition=function(){return"bottom-right"},Bs.prototype.onAdd=function(y){var b=this.options&&this.options.compact;return this._map=y,this._container=l.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=l.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=l.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),b&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),b===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Bs.prototype.onRemove=function(){l.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Bs.prototype._setElementTitle=function(y,b){var _=this._map._getUIString("AttributionControl."+b);y.title=_,y.setAttribute("aria-label",_)},Bs.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},Bs.prototype._updateEditLink=function(){var y=this._editLink;y||(y=this._editLink=this._container.querySelector(".mapbox-improve-map"));var b=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||o.config.ACCESS_TOKEN}];if(y){var _=b.reduce(function(C,L,D){return L.value&&(C+=L.key+"="+L.value+(D<b.length-1?"&":"")),C},"?");y.href=o.config.FEEDBACK_URL+"/"+_+(this._map._hash?this._map._hash.getHashString(!0):""),y.rel="noopener nofollow",this._setElementTitle(y,"MapFeedback")}},Bs.prototype._updateData=function(y){!y||y.sourceDataType!=="metadata"&&y.sourceDataType!=="visibility"&&y.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},Bs.prototype._updateAttributions=function(){if(this._map.style){var y=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?y=y.concat(this.options.customAttribution.map(function($){return typeof $!="string"?"":$})):typeof this.options.customAttribution=="string"&&y.push(this.options.customAttribution)),this._map.style.stylesheet){var b=this._map.style.stylesheet;this.styleOwner=b.owner,this.styleId=b.id}var _=this._map.style.sourceCaches;for(var C in _){var L=_[C];if(L.used){var D=L.getSource();D.attribution&&y.indexOf(D.attribution)<0&&y.push(D.attribution)}}y.sort(function($,j){return $.length-j.length});var F=(y=y.filter(function($,j){for(var et=j+1;et<y.length;et++)if(y[et].indexOf($)>=0)return!1;return!0})).join(" | ");F!==this._attribHTML&&(this._attribHTML=F,y.length?(this._innerContainer.innerHTML=F,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Bs.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var Xu=function(){o.bindAll(["_updateLogo"],this),o.bindAll(["_updateCompact"],this)};Xu.prototype.onAdd=function(y){this._map=y,this._container=l.create("div","mapboxgl-ctrl");var b=l.create("a","mapboxgl-ctrl-logo");return b.target="_blank",b.rel="noopener nofollow",b.href="https://www.mapbox.com/",b.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),b.setAttribute("rel","noopener nofollow"),this._container.appendChild(b),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Xu.prototype.onRemove=function(){l.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Xu.prototype.getDefaultPosition=function(){return"bottom-left"},Xu.prototype._updateLogo=function(y){y&&y.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},Xu.prototype._logoRequired=function(){if(this._map.style){var y=this._map.style.sourceCaches;for(var b in y)if(y[b].getSource().mapbox_logo)return!0;return!1}},Xu.prototype._updateCompact=function(){var y=this._container.children;if(y.length){var b=y[0];this._map.getCanvasContainer().offsetWidth<250?b.classList.add("mapboxgl-compact"):b.classList.remove("mapboxgl-compact")}};var Va=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Va.prototype.add=function(y){var b=++this._id;return this._queue.push({callback:y,id:b,cancelled:!1}),b},Va.prototype.remove=function(y){for(var b=this._currentlyRunning,_=0,C=b?this._queue.concat(b):this._queue;_<C.length;_+=1){var L=C[_];if(L.id===y)return void(L.cancelled=!0)}},Va.prototype.run=function(y){y===void 0&&(y=0);var b=this._currentlyRunning=this._queue;this._queue=[];for(var _=0,C=b;_<C.length;_+=1){var L=C[_];if(!L.cancelled&&(L.callback(y),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},Va.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var wu={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},_h=o.window.HTMLImageElement,hd=o.window.HTMLElement,Wi=o.window.ImageBitmap,Wo={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},V0=function(y){function b(C){var L=this;if((C=o.extend({},Wo,C)).minZoom!=null&&C.maxZoom!=null&&C.minZoom>C.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(C.minPitch!=null&&C.maxPitch!=null&&C.minPitch>C.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(C.minPitch!=null&&C.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(C.maxPitch!=null&&C.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var D=new Ci(C.minZoom,C.maxZoom,C.minPitch,C.maxPitch,C.renderWorldCopies);if(y.call(this,D,C),this._interactive=C.interactive,this._maxTileCacheSize=C.maxTileCacheSize,this._failIfMajorPerformanceCaveat=C.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=C.preserveDrawingBuffer,this._antialias=C.antialias,this._trackResize=C.trackResize,this._bearingSnap=C.bearingSnap,this._refreshExpiredTiles=C.refreshExpiredTiles,this._fadeDuration=C.fadeDuration,this._crossSourceCollisions=C.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=C.collectResourceTiming,this._renderTaskQueue=new Va,this._controls=[],this._mapId=o.uniqueId(),this._locale=o.extend({},wu,C.locale),this._clickTolerance=C.clickTolerance,this._requestManager=new o.RequestManager(C.transformRequest,C.accessToken),typeof C.container=="string"){if(this._container=o.window.document.getElementById(C.container),!this._container)throw new Error("Container '"+C.container+"' not found.")}else{if(!(C.container instanceof hd))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=C.container}if(C.maxBounds&&this.setMaxBounds(C.maxBounds),o.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return L._update(!1)}),this.on("moveend",function(){return L._update(!1)}),this.on("zoom",function(){return L._update(!0)}),o.window!==void 0&&(o.window.addEventListener("online",this._onWindowOnline,!1),o.window.addEventListener("resize",this._onWindowResize,!1),o.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new Zr(this,C),this._hash=C.hash&&new Kl(typeof C.hash=="string"&&C.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:C.center,zoom:C.zoom,bearing:C.bearing,pitch:C.pitch}),C.bounds&&(this.resize(),this.fitBounds(C.bounds,o.extend({},C.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=C.localIdeographFontFamily,C.style&&this.setStyle(C.style,{localIdeographFontFamily:C.localIdeographFontFamily}),C.attributionControl&&this.addControl(new Bs({customAttribution:C.customAttribution})),this.addControl(new Xu,C.logoPosition),this.on("style.load",function(){L.transform.unmodified&&L.jumpTo(L.style.stylesheet)}),this.on("data",function(F){L._update(F.dataType==="style"),L.fire(new o.Event(F.dataType+"data",F))}),this.on("dataloading",function(F){L.fire(new o.Event(F.dataType+"dataloading",F))})}y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b;var _={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return b.prototype._getMapId=function(){return this._mapId},b.prototype.addControl=function(C,L){if(L===void 0&&(L=C.getDefaultPosition?C.getDefaultPosition():"top-right"),!C||!C.onAdd)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var D=C.onAdd(this);this._controls.push(C);var F=this._controlPositions[L];return L.indexOf("bottom")!==-1?F.insertBefore(D,F.firstChild):F.appendChild(D),this},b.prototype.removeControl=function(C){if(!C||!C.onRemove)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var L=this._controls.indexOf(C);return L>-1&&this._controls.splice(L,1),C.onRemove(this),this},b.prototype.hasControl=function(C){return this._controls.indexOf(C)>-1},b.prototype.resize=function(C){var L=this._containerDimensions(),D=L[0],F=L[1];if(D===this.transform.width&&F===this.transform.height)return this;this._resizeCanvas(D,F),this.transform.resize(D,F),this.painter.resize(D,F);var $=!this._moving;return $&&this.fire(new o.Event("movestart",C)).fire(new o.Event("move",C)),this.fire(new o.Event("resize",C)),$&&this.fire(new o.Event("moveend",C)),this},b.prototype.getBounds=function(){return this.transform.getBounds()},b.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},b.prototype.setMaxBounds=function(C){return this.transform.setMaxBounds(o.LngLatBounds.convert(C)),this._update()},b.prototype.setMinZoom=function(C){if((C=C??-2)>=-2&&C<=this.transform.maxZoom)return this.transform.minZoom=C,this._update(),this.getZoom()<C&&this.setZoom(C),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},b.prototype.getMinZoom=function(){return this.transform.minZoom},b.prototype.setMaxZoom=function(C){if((C=C??22)>=this.transform.minZoom)return this.transform.maxZoom=C,this._update(),this.getZoom()>C&&this.setZoom(C),this;throw new Error("maxZoom must be greater than the current minZoom")},b.prototype.getMaxZoom=function(){return this.transform.maxZoom},b.prototype.setMinPitch=function(C){if((C=C??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(C>=0&&C<=this.transform.maxPitch)return this.transform.minPitch=C,this._update(),this.getPitch()<C&&this.setPitch(C),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},b.prototype.getMinPitch=function(){return this.transform.minPitch},b.prototype.setMaxPitch=function(C){if((C=C??60)>60)throw new Error("maxPitch must be less than or equal to 60");if(C>=this.transform.minPitch)return this.transform.maxPitch=C,this._update(),this.getPitch()>C&&this.setPitch(C),this;throw new Error("maxPitch must be greater than the current minPitch")},b.prototype.getMaxPitch=function(){return this.transform.maxPitch},b.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},b.prototype.setRenderWorldCopies=function(C){return this.transform.renderWorldCopies=C,this._update()},b.prototype.project=function(C){return this.transform.locationPoint(o.LngLat.convert(C))},b.prototype.unproject=function(C){return this.transform.pointLocation(o.Point.convert(C))},b.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},b.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},b.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},b.prototype._createDelegatedListener=function(C,L,D){var F,$=this;if(C==="mouseenter"||C==="mouseover"){var j=!1;return{layer:L,listener:D,delegates:{mousemove:function(ut){var ht=$.getLayer(L)?$.queryRenderedFeatures(ut.point,{layers:[L]}):[];ht.length?j||(j=!0,D.call($,new Ha(C,$,ut.originalEvent,{features:ht}))):j=!1},mouseout:function(){j=!1}}}}if(C==="mouseleave"||C==="mouseout"){var et=!1;return{layer:L,listener:D,delegates:{mousemove:function(ut){($.getLayer(L)?$.queryRenderedFeatures(ut.point,{layers:[L]}):[]).length?et=!0:et&&(et=!1,D.call($,new Ha(C,$,ut.originalEvent)))},mouseout:function(ut){et&&(et=!1,D.call($,new Ha(C,$,ut.originalEvent)))}}}}return{layer:L,listener:D,delegates:(F={},F[C]=function(ut){var ht=$.getLayer(L)?$.queryRenderedFeatures(ut.point,{layers:[L]}):[];ht.length&&(ut.features=ht,D.call($,ut),delete ut.features)},F)}},b.prototype.on=function(C,L,D){if(D===void 0)return y.prototype.on.call(this,C,L);var F=this._createDelegatedListener(C,L,D);for(var $ in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[C]=this._delegatedListeners[C]||[],this._delegatedListeners[C].push(F),F.delegates)this.on($,F.delegates[$]);return this},b.prototype.once=function(C,L,D){if(D===void 0)return y.prototype.once.call(this,C,L);var F=this._createDelegatedListener(C,L,D);for(var $ in F.delegates)this.once($,F.delegates[$]);return this},b.prototype.off=function(C,L,D){var F=this;return D===void 0?y.prototype.off.call(this,C,L):(this._delegatedListeners&&this._delegatedListeners[C]&&function($){for(var j=$[C],et=0;et<j.length;et++){var ut=j[et];if(ut.layer===L&&ut.listener===D){for(var ht in ut.delegates)F.off(ht,ut.delegates[ht]);return j.splice(et,1),F}}}(this._delegatedListeners),this)},b.prototype.queryRenderedFeatures=function(C,L){if(!this.style)return[];var D;if(L!==void 0||C===void 0||C instanceof o.Point||Array.isArray(C)||(L=C,C=void 0),L=L||{},(C=C||[[0,0],[this.transform.width,this.transform.height]])instanceof o.Point||typeof C[0]=="number")D=[o.Point.convert(C)];else{var F=o.Point.convert(C[0]),$=o.Point.convert(C[1]);D=[F,new o.Point($.x,F.y),$,new o.Point(F.x,$.y),F]}return this.style.queryRenderedFeatures(D,L,this.transform)},b.prototype.querySourceFeatures=function(C,L){return this.style.querySourceFeatures(C,L)},b.prototype.setStyle=function(C,L){return(L=o.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},L)).diff!==!1&&L.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&C?(this._diffStyle(C,L),this):(this._localIdeographFontFamily=L.localIdeographFontFamily,this._updateStyle(C,L))},b.prototype._getUIString=function(C){var L=this._locale[C];if(L==null)throw new Error("Missing UI string '"+C+"'");return L},b.prototype._updateStyle=function(C,L){return this.style&&(this.style.setEventedParent(null),this.style._remove()),C?(this.style=new Tl(this,L||{}),this.style.setEventedParent(this,{style:this.style}),typeof C=="string"?this.style.loadURL(C):this.style.loadJSON(C),this):(delete this.style,this)},b.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Tl(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},b.prototype._diffStyle=function(C,L){var D=this;if(typeof C=="string"){var F=this._requestManager.normalizeStyleURL(C),$=this._requestManager.transformRequest(F,o.ResourceType.Style);o.getJSON($,function(j,et){j?D.fire(new o.ErrorEvent(j)):et&&D._updateDiff(et,L)})}else typeof C=="object"&&this._updateDiff(C,L)},b.prototype._updateDiff=function(C,L){try{this.style.setState(C)&&this._update(!0)}catch(D){o.warnOnce("Unable to perform style diff: "+(D.message||D.error||D)+".  Rebuilding the style from scratch."),this._updateStyle(C,L)}},b.prototype.getStyle=function(){if(this.style)return this.style.serialize()},b.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():o.warnOnce("There is no style added to the map.")},b.prototype.addSource=function(C,L){return this._lazyInitEmptyStyle(),this.style.addSource(C,L),this._update(!0)},b.prototype.isSourceLoaded=function(C){var L=this.style&&this.style.sourceCaches[C];if(L!==void 0)return L.loaded();this.fire(new o.ErrorEvent(new Error("There is no source with ID '"+C+"'")))},b.prototype.areTilesLoaded=function(){var C=this.style&&this.style.sourceCaches;for(var L in C){var D=C[L]._tiles;for(var F in D){var $=D[F];if($.state!=="loaded"&&$.state!=="errored")return!1}}return!0},b.prototype.addSourceType=function(C,L,D){return this._lazyInitEmptyStyle(),this.style.addSourceType(C,L,D)},b.prototype.removeSource=function(C){return this.style.removeSource(C),this._update(!0)},b.prototype.getSource=function(C){return this.style.getSource(C)},b.prototype.addImage=function(C,L,D){D===void 0&&(D={});var F=D.pixelRatio;F===void 0&&(F=1);var $=D.sdf;$===void 0&&($=!1);var j=D.stretchX,et=D.stretchY,ut=D.content;if(this._lazyInitEmptyStyle(),L instanceof _h||Wi&&L instanceof Wi){var ht=o.browser.getImageData(L);this.style.addImage(C,{data:new o.RGBAImage({width:ht.width,height:ht.height},ht.data),pixelRatio:F,stretchX:j,stretchY:et,content:ut,sdf:$,version:0})}else{if(L.width===void 0||L.height===void 0)return this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var dt=L;this.style.addImage(C,{data:new o.RGBAImage({width:L.width,height:L.height},new Uint8Array(L.data)),pixelRatio:F,stretchX:j,stretchY:et,content:ut,sdf:$,version:0,userImage:dt}),dt.onAdd&&dt.onAdd(this,C)}},b.prototype.updateImage=function(C,L){var D=this.style.getImage(C);if(!D)return this.fire(new o.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var F=L instanceof _h||Wi&&L instanceof Wi?o.browser.getImageData(L):L,$=F.width,j=F.height,et=F.data;return $===void 0||j===void 0?this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):$!==D.data.width||j!==D.data.height?this.fire(new o.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(D.data.replace(et,!(L instanceof _h||Wi&&L instanceof Wi)),void this.style.updateImage(C,D))},b.prototype.hasImage=function(C){return C?!!this.style.getImage(C):(this.fire(new o.ErrorEvent(new Error("Missing required image id"))),!1)},b.prototype.removeImage=function(C){this.style.removeImage(C)},b.prototype.loadImage=function(C,L){o.getImage(this._requestManager.transformRequest(C,o.ResourceType.Image),L)},b.prototype.listImages=function(){return this.style.listImages()},b.prototype.addLayer=function(C,L){return this._lazyInitEmptyStyle(),this.style.addLayer(C,L),this._update(!0)},b.prototype.moveLayer=function(C,L){return this.style.moveLayer(C,L),this._update(!0)},b.prototype.removeLayer=function(C){return this.style.removeLayer(C),this._update(!0)},b.prototype.getLayer=function(C){return this.style.getLayer(C)},b.prototype.setLayerZoomRange=function(C,L,D){return this.style.setLayerZoomRange(C,L,D),this._update(!0)},b.prototype.setFilter=function(C,L,D){return D===void 0&&(D={}),this.style.setFilter(C,L,D),this._update(!0)},b.prototype.getFilter=function(C){return this.style.getFilter(C)},b.prototype.setPaintProperty=function(C,L,D,F){return F===void 0&&(F={}),this.style.setPaintProperty(C,L,D,F),this._update(!0)},b.prototype.getPaintProperty=function(C,L){return this.style.getPaintProperty(C,L)},b.prototype.setLayoutProperty=function(C,L,D,F){return F===void 0&&(F={}),this.style.setLayoutProperty(C,L,D,F),this._update(!0)},b.prototype.getLayoutProperty=function(C,L){return this.style.getLayoutProperty(C,L)},b.prototype.setLight=function(C,L){return L===void 0&&(L={}),this._lazyInitEmptyStyle(),this.style.setLight(C,L),this._update(!0)},b.prototype.getLight=function(){return this.style.getLight()},b.prototype.setFeatureState=function(C,L){return this.style.setFeatureState(C,L),this._update()},b.prototype.removeFeatureState=function(C,L){return this.style.removeFeatureState(C,L),this._update()},b.prototype.getFeatureState=function(C){return this.style.getFeatureState(C)},b.prototype.getContainer=function(){return this._container},b.prototype.getCanvasContainer=function(){return this._canvasContainer},b.prototype.getCanvas=function(){return this._canvas},b.prototype._containerDimensions=function(){var C=0,L=0;return this._container&&(C=this._container.clientWidth||400,L=this._container.clientHeight||300),[C,L]},b.prototype._detectMissingCSS=function(){o.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&o.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},b.prototype._setupContainer=function(){var C=this._container;C.classList.add("mapboxgl-map"),(this._missingCSSCanary=l.create("div","mapboxgl-canary",C)).style.visibility="hidden",this._detectMissingCSS();var L=this._canvasContainer=l.create("div","mapboxgl-canvas-container",C);this._interactive&&L.classList.add("mapboxgl-interactive"),this._canvas=l.create("canvas","mapboxgl-canvas",L),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var D=this._containerDimensions();this._resizeCanvas(D[0],D[1]);var F=this._controlContainer=l.create("div","mapboxgl-control-container",C),$=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(j){$[j]=l.create("div","mapboxgl-ctrl-"+j,F)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},b.prototype._resizeCanvas=function(C,L){var D=o.browser.devicePixelRatio||1;this._canvas.width=D*C,this._canvas.height=D*L,this._canvas.style.width=C+"px",this._canvas.style.height=L+"px"},b.prototype._setupPainter=function(){var C=o.extend({},s.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),L=this._canvas.getContext("webgl",C)||this._canvas.getContext("experimental-webgl",C);L?(this.painter=new Ea(L,this.transform),o.webpSupported.testSupport(L)):this.fire(new o.ErrorEvent(new Error("Failed to initialize WebGL")))},b.prototype._contextLost=function(C){C.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new o.Event("webglcontextlost",{originalEvent:C}))},b.prototype._contextRestored=function(C){this._setupPainter(),this.resize(),this._update(),this.fire(new o.Event("webglcontextrestored",{originalEvent:C}))},b.prototype._onMapScroll=function(C){if(C.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},b.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},b.prototype._update=function(C){return this.style?(this._styleDirty=this._styleDirty||C,this._sourcesDirty=!0,this.triggerRepaint(),this):this},b.prototype._requestRenderFrame=function(C){return this._update(),this._renderTaskQueue.add(C)},b.prototype._cancelRenderFrame=function(C){this._renderTaskQueue.remove(C)},b.prototype._render=function(C){var L,D=this,F=0,$=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(L=$.createQueryEXT(),$.beginQueryEXT($.TIME_ELAPSED_EXT,L),F=o.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(C),!this._removed){var j=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var et=this.transform.zoom,ut=o.browser.now();this.style.zoomHistory.update(et,ut);var ht=new o.EvaluationParameters(et,{now:ut,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),dt=ht.crossFadingFactor();dt===1&&dt===this._crossFadingFactor||(j=!0,this._crossFadingFactor=dt),this.style.update(ht)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new o.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new o.Event("load"))),this.style&&(this.style.hasTransitions()||j)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var Ot=o.browser.now()-F;$.endQueryEXT($.TIME_ELAPSED_EXT,L),setTimeout(function(){var Ct=$.getQueryObjectEXT(L,$.QUERY_RESULT_EXT)/1e6;$.deleteQueryEXT(L),D.fire(new o.Event("gpu-timing-frame",{cpuTime:Ot,gpuTime:Ct}))},50)}if(this.listens("gpu-timing-layer")){var At=this.painter.collectGpuTimers();setTimeout(function(){var Ct=D.painter.queryGpuTimers(At);D.fire(new o.Event("gpu-timing-layer",{layerTimes:Ct}))},50)}var $t=this._sourcesDirty||this._styleDirty||this._placementDirty;return $t||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.Event("idle")),!this._loaded||this._fullyLoaded||$t||(this._fullyLoaded=!0),this}},b.prototype.remove=function(){this._hash&&this._hash.remove();for(var C=0,L=this._controls;C<L.length;C+=1)L[C].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),o.window!==void 0&&(o.window.removeEventListener("resize",this._onWindowResize,!1),o.window.removeEventListener("orientationchange",this._onWindowResize,!1),o.window.removeEventListener("online",this._onWindowOnline,!1));var D=this.painter.context.gl.getExtension("WEBGL_lose_context");D&&D.loseContext(),vf(this._canvasContainer),vf(this._controlContainer),vf(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new o.Event("remove"))},b.prototype.triggerRepaint=function(){var C=this;this.style&&!this._frame&&(this._frame=o.browser.frame(function(L){C._frame=null,C._render(L)}))},b.prototype._onWindowOnline=function(){this._update()},b.prototype._onWindowResize=function(C){this._trackResize&&this.resize({originalEvent:C})._update()},_.showTileBoundaries.get=function(){return!!this._showTileBoundaries},_.showTileBoundaries.set=function(C){this._showTileBoundaries!==C&&(this._showTileBoundaries=C,this._update())},_.showPadding.get=function(){return!!this._showPadding},_.showPadding.set=function(C){this._showPadding!==C&&(this._showPadding=C,this._update())},_.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},_.showCollisionBoxes.set=function(C){this._showCollisionBoxes!==C&&(this._showCollisionBoxes=C,C?this.style._generateCollisionBoxes():this._update())},_.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},_.showOverdrawInspector.set=function(C){this._showOverdrawInspector!==C&&(this._showOverdrawInspector=C,this._update())},_.repaint.get=function(){return!!this._repaint},_.repaint.set=function(C){this._repaint!==C&&(this._repaint=C,this.triggerRepaint())},_.vertices.get=function(){return!!this._vertices},_.vertices.set=function(C){this._vertices=C,this._update()},b.prototype._setCacheLimits=function(C,L){o.setCacheLimits(C,L)},_.version.get=function(){return o.version},Object.defineProperties(b.prototype,_),b}(Rl);function vf(y){y.parentNode&&y.parentNode.removeChild(y)}var $g={showCompass:!0,showZoom:!0,visualizePitch:!1},xh=function(y){var b=this;this.options=o.extend({},$g,y),this._container=l.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(_){return _.preventDefault()}),this.options.showZoom&&(o.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(_){return b._map.zoomIn({},{originalEvent:_})}),l.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(_){return b._map.zoomOut({},{originalEvent:_})}),l.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(o.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(_){b.options.visualizePitch?b._map.resetNorthPitch({},{originalEvent:_}):b._map.resetNorth({},{originalEvent:_})}),this._compassIcon=l.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};xh.prototype._updateZoomButtons=function(){var y=this._map.getZoom(),b=y===this._map.getMaxZoom(),_=y===this._map.getMinZoom();this._zoomInButton.disabled=b,this._zoomOutButton.disabled=_,this._zoomInButton.setAttribute("aria-disabled",b.toString()),this._zoomOutButton.setAttribute("aria-disabled",_.toString())},xh.prototype._rotateCompassArrow=function(){var y=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=y},xh.prototype.onAdd=function(y){return this._map=y,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Il(this._map,this._compass,this.options.visualizePitch)),this._container},xh.prototype.onRemove=function(){l.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},xh.prototype._createButton=function(y,b){var _=l.create("button",y,this._container);return _.type="button",_.addEventListener("click",b),_},xh.prototype._setButtonTitle=function(y,b){var _=this._map._getUIString("NavigationControl."+b);y.title=_,y.setAttribute("aria-label",_)};var Il=function(y,b,_){_===void 0&&(_=!1),this._clickTolerance=10,this.element=b,this.mouseRotate=new Ev({clickTolerance:y.dragRotate._mouseRotate._clickTolerance}),this.map=y,_&&(this.mousePitch=new Ng({clickTolerance:y.dragRotate._mousePitch._clickTolerance})),o.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),l.addEventListener(b,"mousedown",this.mousedown),l.addEventListener(b,"touchstart",this.touchstart,{passive:!1}),l.addEventListener(b,"touchmove",this.touchmove),l.addEventListener(b,"touchend",this.touchend),l.addEventListener(b,"touchcancel",this.reset)};function up(y,b,_){if(y=new o.LngLat(y.lng,y.lat),b){var C=new o.LngLat(y.lng-360,y.lat),L=new o.LngLat(y.lng+360,y.lat),D=_.locationPoint(y).distSqr(b);_.locationPoint(C).distSqr(b)<D?y=C:_.locationPoint(L).distSqr(b)<D&&(y=L)}for(;Math.abs(y.lng-_.center.lng)>180;){var F=_.locationPoint(y);if(F.x>=0&&F.y>=0&&F.x<=_.width&&F.y<=_.height)break;y.lng>_.center.lng?y.lng-=360:y.lng+=360}return y}Il.prototype.down=function(y,b){this.mouseRotate.mousedown(y,b),this.mousePitch&&this.mousePitch.mousedown(y,b),l.disableDrag()},Il.prototype.move=function(y,b){var _=this.map,C=this.mouseRotate.mousemoveWindow(y,b);if(C&&C.bearingDelta&&_.setBearing(_.getBearing()+C.bearingDelta),this.mousePitch){var L=this.mousePitch.mousemoveWindow(y,b);L&&L.pitchDelta&&_.setPitch(_.getPitch()+L.pitchDelta)}},Il.prototype.off=function(){var y=this.element;l.removeEventListener(y,"mousedown",this.mousedown),l.removeEventListener(y,"touchstart",this.touchstart,{passive:!1}),l.removeEventListener(y,"touchmove",this.touchmove),l.removeEventListener(y,"touchend",this.touchend),l.removeEventListener(y,"touchcancel",this.reset),this.offTemp()},Il.prototype.offTemp=function(){l.enableDrag(),l.removeEventListener(o.window,"mousemove",this.mousemove),l.removeEventListener(o.window,"mouseup",this.mouseup)},Il.prototype.mousedown=function(y){this.down(o.extend({},y,{ctrlKey:!0,preventDefault:function(){return y.preventDefault()}}),l.mousePos(this.element,y)),l.addEventListener(o.window,"mousemove",this.mousemove),l.addEventListener(o.window,"mouseup",this.mouseup)},Il.prototype.mousemove=function(y){this.move(y,l.mousePos(this.element,y))},Il.prototype.mouseup=function(y){this.mouseRotate.mouseupWindow(y),this.mousePitch&&this.mousePitch.mouseupWindow(y),this.offTemp()},Il.prototype.touchstart=function(y){y.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=l.touchPos(this.element,y.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return y.preventDefault()}},this._startPos))},Il.prototype.touchmove=function(y){y.targetTouches.length!==1?this.reset():(this._lastPos=l.touchPos(this.element,y.targetTouches)[0],this.move({preventDefault:function(){return y.preventDefault()}},this._lastPos))},Il.prototype.touchend=function(y){y.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Il.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var Ec={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Hg(y,b,_){var C=y.classList;for(var L in Ec)C.remove("mapboxgl-"+_+"-anchor-"+L);C.add("mapboxgl-"+_+"-anchor-"+b)}var cp,wv=function(y){function b(_,C){if(y.call(this),(_ instanceof o.window.HTMLElement||C)&&(_=o.extend({element:_},C)),o.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=_&&_.anchor||"center",this._color=_&&_.color||"#3FB1CE",this._scale=_&&_.scale||1,this._draggable=_&&_.draggable||!1,this._clickTolerance=_&&_.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=_&&_.rotation||0,this._rotationAlignment=_&&_.rotationAlignment||"auto",this._pitchAlignment=_&&_.pitchAlignment&&_.pitchAlignment!=="auto"?_.pitchAlignment:this._rotationAlignment,_&&_.element)this._element=_.element,this._offset=o.Point.convert(_&&_.offset||[0,0]);else{this._defaultMarker=!0,this._element=l.create("div"),this._element.setAttribute("aria-label","Map marker");var L=l.createNS("http://www.w3.org/2000/svg","svg");L.setAttributeNS(null,"display","block"),L.setAttributeNS(null,"height","41px"),L.setAttributeNS(null,"width","27px"),L.setAttributeNS(null,"viewBox","0 0 27 41");var D=l.createNS("http://www.w3.org/2000/svg","g");D.setAttributeNS(null,"stroke","none"),D.setAttributeNS(null,"stroke-width","1"),D.setAttributeNS(null,"fill","none"),D.setAttributeNS(null,"fill-rule","evenodd");var F=l.createNS("http://www.w3.org/2000/svg","g");F.setAttributeNS(null,"fill-rule","nonzero");var $=l.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"transform","translate(3.0, 29.0)"),$.setAttributeNS(null,"fill","#000000");for(var j=0,et=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];j<et.length;j+=1){var ut=et[j],ht=l.createNS("http://www.w3.org/2000/svg","ellipse");ht.setAttributeNS(null,"opacity","0.04"),ht.setAttributeNS(null,"cx","10.5"),ht.setAttributeNS(null,"cy","5.80029008"),ht.setAttributeNS(null,"rx",ut.rx),ht.setAttributeNS(null,"ry",ut.ry),$.appendChild(ht)}var dt=l.createNS("http://www.w3.org/2000/svg","g");dt.setAttributeNS(null,"fill",this._color);var Ot=l.createNS("http://www.w3.org/2000/svg","path");Ot.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),dt.appendChild(Ot);var At=l.createNS("http://www.w3.org/2000/svg","g");At.setAttributeNS(null,"opacity","0.25"),At.setAttributeNS(null,"fill","#000000");var $t=l.createNS("http://www.w3.org/2000/svg","path");$t.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),At.appendChild($t);var Ct=l.createNS("http://www.w3.org/2000/svg","g");Ct.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Ct.setAttributeNS(null,"fill","#FFFFFF");var zt=l.createNS("http://www.w3.org/2000/svg","g");zt.setAttributeNS(null,"transform","translate(8.0, 8.0)");var qt=l.createNS("http://www.w3.org/2000/svg","circle");qt.setAttributeNS(null,"fill","#000000"),qt.setAttributeNS(null,"opacity","0.25"),qt.setAttributeNS(null,"cx","5.5"),qt.setAttributeNS(null,"cy","5.5"),qt.setAttributeNS(null,"r","5.4999962");var se=l.createNS("http://www.w3.org/2000/svg","circle");se.setAttributeNS(null,"fill","#FFFFFF"),se.setAttributeNS(null,"cx","5.5"),se.setAttributeNS(null,"cy","5.5"),se.setAttributeNS(null,"r","5.4999962"),zt.appendChild(qt),zt.appendChild(se),F.appendChild($),F.appendChild(dt),F.appendChild(At),F.appendChild(Ct),F.appendChild(zt),L.appendChild(F),L.setAttributeNS(null,"height",41*this._scale+"px"),L.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(L),this._offset=o.Point.convert(_&&_.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(Ee){Ee.preventDefault()}),this._element.addEventListener("mousedown",function(Ee){Ee.preventDefault()}),Hg(this._element,this._anchor,"marker"),this._popup=null}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.addTo=function(_){return this.remove(),this._map=_,_.getCanvasContainer().appendChild(this._element),_.on("move",this._update),_.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},b.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),l.remove(this._element),this._popup&&this._popup.remove(),this},b.prototype.getLngLat=function(){return this._lngLat},b.prototype.setLngLat=function(_){return this._lngLat=o.LngLat.convert(_),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},b.prototype.getElement=function(){return this._element},b.prototype.setPopup=function(_){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),_){if(!("offset"in _.options)){var C=Math.sqrt(Math.pow(13.5,2)/2);_.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[C,-1*(24.6+C)],"bottom-right":[-C,-1*(24.6+C)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=_,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},b.prototype._onKeyPress=function(_){var C=_.code,L=_.charCode||_.keyCode;C!=="Space"&&C!=="Enter"&&L!==32&&L!==13||this.togglePopup()},b.prototype._onMapClick=function(_){var C=_.originalEvent.target,L=this._element;this._popup&&(C===L||L.contains(C))&&this.togglePopup()},b.prototype.getPopup=function(){return this._popup},b.prototype.togglePopup=function(){var _=this._popup;return _?(_.isOpen()?_.remove():_.addTo(this._map),this):this},b.prototype._update=function(_){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=up(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var C="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?C="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(C="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var L="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?L="rotateX(0deg)":this._pitchAlignment==="map"&&(L="rotateX("+this._map.getPitch()+"deg)"),_&&_.type!=="moveend"||(this._pos=this._pos.round()),l.setTransform(this._element,Ec[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+L+" "+C)}},b.prototype.getOffset=function(){return this._offset},b.prototype.setOffset=function(_){return this._offset=o.Point.convert(_),this._update(),this},b.prototype._onMove=function(_){if(!this._isDragging){var C=this._clickTolerance||this._map._clickTolerance;this._isDragging=_.point.dist(this._pointerdownPos)>=C}this._isDragging&&(this._pos=_.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.Event("dragstart"))),this.fire(new o.Event("drag")))},b.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.Event("dragend")),this._state="inactive"},b.prototype._addDragHandler=function(_){this._element.contains(_.originalEvent.target)&&(_.preventDefault(),this._positionDelta=_.point.sub(this._pos).add(this._offset),this._pointerdownPos=_.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},b.prototype.setDraggable=function(_){return this._draggable=!!_,this._map&&(_?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},b.prototype.isDraggable=function(){return this._draggable},b.prototype.setRotation=function(_){return this._rotation=_||0,this._update(),this},b.prototype.getRotation=function(){return this._rotation},b.prototype.setRotationAlignment=function(_){return this._rotationAlignment=_||"auto",this._update(),this},b.prototype.getRotationAlignment=function(){return this._rotationAlignment},b.prototype.setPitchAlignment=function(_){return this._pitchAlignment=_&&_!=="auto"?_:this._rotationAlignment,this._update(),this},b.prototype.getPitchAlignment=function(){return this._pitchAlignment},b}(o.Evented),Vg={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},fd=0,dd=!1,G0=function(y){function b(_){y.call(this),this.options=o.extend({},Vg,_),o.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.onAdd=function(_){var C;return this._map=_,this._container=l.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),C=this._setupUI,cp!==void 0?C(cp):o.window.navigator.permissions!==void 0?o.window.navigator.permissions.query({name:"geolocation"}).then(function(L){C(cp=L.state!=="denied")}):C(cp=!!o.window.navigator.geolocation),this._container},b.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(o.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),l.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,fd=0,dd=!1},b.prototype._isOutOfMapMaxBounds=function(_){var C=this._map.getMaxBounds(),L=_.coords;return C&&(L.longitude<C.getWest()||L.longitude>C.getEast()||L.latitude<C.getSouth()||L.latitude>C.getNorth())},b.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},b.prototype._onSuccess=function(_){if(this._map){if(this._isOutOfMapMaxBounds(_))return this._setErrorState(),this.fire(new o.Event("outofmaxbounds",_)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=_,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(_),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(_),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("geolocate",_)),this._finish()}},b.prototype._updateCamera=function(_){var C=new o.LngLat(_.coords.longitude,_.coords.latitude),L=_.coords.accuracy,D=this._map.getBearing(),F=o.extend({bearing:D},this.options.fitBoundsOptions);this._map.fitBounds(C.toBounds(L),F,{geolocateSource:!0})},b.prototype._updateMarker=function(_){if(_){var C=new o.LngLat(_.coords.longitude,_.coords.latitude);this._accuracyCircleMarker.setLngLat(C).addTo(this._map),this._userLocationDotMarker.setLngLat(C).addTo(this._map),this._accuracy=_.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},b.prototype._updateCircleRadius=function(){var _=this._map._container.clientHeight/2,C=this._map.unproject([0,_]),L=this._map.unproject([1,_]),D=C.distanceTo(L),F=Math.ceil(2*this._accuracy/D);this._circleElement.style.width=F+"px",this._circleElement.style.height=F+"px"},b.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},b.prototype._onError=function(_){if(this._map){if(this.options.trackUserLocation)if(_.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var C=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=C,this._geolocateButton.setAttribute("aria-label",C),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(_.code===3&&dd)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("error",_)),this._finish()}},b.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},b.prototype._setupUI=function(_){var C=this;if(this._container.addEventListener("contextmenu",function(F){return F.preventDefault()}),this._geolocateButton=l.create("button","mapboxgl-ctrl-geolocate",this._container),l.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",_===!1){o.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var L=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=L,this._geolocateButton.setAttribute("aria-label",L)}else{var D=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=D,this._geolocateButton.setAttribute("aria-label",D)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=l.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new wv(this._dotElement),this._circleElement=l.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new wv({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(F){F.geolocateSource||C._watchState!=="ACTIVE_LOCK"||F.originalEvent&&F.originalEvent.type==="resize"||(C._watchState="BACKGROUND",C._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),C._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),C.fire(new o.Event("trackuserlocationend")))})},b.prototype.trigger=function(){if(!this._setup)return o.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":fd--,dd=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new o.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var _;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++fd>1?(_={maximumAge:6e5,timeout:0},dd=!0):(_=this.options.positionOptions,dd=!1),this._geolocationWatchID=o.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,_)}}else o.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},b.prototype._clearWatch=function(){o.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},b}(o.Evented),wc={maxWidth:100,unit:"metric"},ju=function(y){this.options=o.extend({},wc,y),o.bindAll(["_onMove","setUnit"],this)};function Gg(y,b,_){var C=_&&_.maxWidth||100,L=y._container.clientHeight/2,D=y.unproject([0,L]),F=y.unproject([C,L]),$=D.distanceTo(F);if(_&&_.unit==="imperial"){var j=3.2808*$;j>5280?gf(b,C,j/5280,y._getUIString("ScaleControl.Miles")):gf(b,C,j,y._getUIString("ScaleControl.Feet"))}else _&&_.unit==="nautical"?gf(b,C,$/1852,y._getUIString("ScaleControl.NauticalMiles")):$>=1e3?gf(b,C,$/1e3,y._getUIString("ScaleControl.Kilometers")):gf(b,C,$,y._getUIString("ScaleControl.Meters"))}function gf(y,b,_,C){var L,D,F,$=(L=_,(D=Math.pow(10,(""+Math.floor(L)).length-1))*(F=(F=L/D)>=10?10:F>=5?5:F>=3?3:F>=2?2:F>=1?1:function(j){var et=Math.pow(10,Math.ceil(-Math.log(j)/Math.LN10));return Math.round(j*et)/et}(F)));y.style.width=b*($/_)+"px",y.innerHTML=$+"&nbsp;"+C}ju.prototype.getDefaultPosition=function(){return"bottom-left"},ju.prototype._onMove=function(){Gg(this._map,this._container,this.options)},ju.prototype.onAdd=function(y){return this._map=y,this._container=l.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",y.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},ju.prototype.onRemove=function(){l.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},ju.prototype.setUnit=function(y){this.options.unit=y,Gg(this._map,this._container,this.options)};var Cu=function(y){this._fullscreen=!1,y&&y.container&&(y.container instanceof o.window.HTMLElement?this._container=y.container:o.warnOnce("Full screen control 'container' must be a DOM element.")),o.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in o.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in o.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in o.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in o.window.document&&(this._fullscreenchange="MSFullscreenChange")};Cu.prototype.onAdd=function(y){return this._map=y,this._container||(this._container=this._map.getContainer()),this._controlContainer=l.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",o.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Cu.prototype.onRemove=function(){l.remove(this._controlContainer),this._map=null,o.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Cu.prototype._checkFullscreenSupport=function(){return!!(o.window.document.fullscreenEnabled||o.window.document.mozFullScreenEnabled||o.window.document.msFullscreenEnabled||o.window.document.webkitFullscreenEnabled)},Cu.prototype._setupUI=function(){var y=this._fullscreenButton=l.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);l.create("span","mapboxgl-ctrl-icon",y).setAttribute("aria-hidden",!0),y.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),o.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Cu.prototype._updateTitle=function(){var y=this._getTitle();this._fullscreenButton.setAttribute("aria-label",y),this._fullscreenButton.title=y},Cu.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Cu.prototype._isFullscreen=function(){return this._fullscreen},Cu.prototype._changeIcon=function(){(o.window.document.fullscreenElement||o.window.document.mozFullScreenElement||o.window.document.webkitFullscreenElement||o.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Cu.prototype._onClickFullscreen=function(){this._isFullscreen()?o.window.document.exitFullscreen?o.window.document.exitFullscreen():o.window.document.mozCancelFullScreen?o.window.document.mozCancelFullScreen():o.window.document.msExitFullscreen?o.window.document.msExitFullscreen():o.window.document.webkitCancelFullScreen&&o.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var W0={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Cv=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),Wg=function(y){function b(_){y.call(this),this.options=o.extend(Object.create(W0),_),o.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return y&&(b.__proto__=y),(b.prototype=Object.create(y&&y.prototype)).constructor=b,b.prototype.addTo=function(_){return this._map&&this.remove(),this._map=_,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new o.Event("open")),this},b.prototype.isOpen=function(){return!!this._map},b.prototype.remove=function(){return this._content&&l.remove(this._content),this._container&&(l.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new o.Event("close")),this},b.prototype.getLngLat=function(){return this._lngLat},b.prototype.setLngLat=function(_){return this._lngLat=o.LngLat.convert(_),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},b.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},b.prototype.getElement=function(){return this._container},b.prototype.setText=function(_){return this.setDOMContent(o.window.document.createTextNode(_))},b.prototype.setHTML=function(_){var C,L=o.window.document.createDocumentFragment(),D=o.window.document.createElement("body");for(D.innerHTML=_;C=D.firstChild;)L.appendChild(C);return this.setDOMContent(L)},b.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},b.prototype.setMaxWidth=function(_){return this.options.maxWidth=_,this._update(),this},b.prototype.setDOMContent=function(_){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=l.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(_),this._createCloseButton(),this._update(),this._focusFirstElement(),this},b.prototype.addClassName=function(_){this._container&&this._container.classList.add(_)},b.prototype.removeClassName=function(_){this._container&&this._container.classList.remove(_)},b.prototype.setOffset=function(_){return this.options.offset=_,this._update(),this},b.prototype.toggleClassName=function(_){if(this._container)return this._container.classList.toggle(_)},b.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=l.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},b.prototype._onMouseUp=function(_){this._update(_.point)},b.prototype._onMouseMove=function(_){this._update(_.point)},b.prototype._onDrag=function(_){this._update(_.point)},b.prototype._update=function(_){var C=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=l.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=l.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(ht){return C._container.classList.add(ht)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=up(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||_)){var L=this._pos=this._trackPointer&&_?_:this._map.project(this._lngLat),D=this.options.anchor,F=function ht(dt){if(dt){if(typeof dt=="number"){var Ot=Math.round(Math.sqrt(.5*Math.pow(dt,2)));return{center:new o.Point(0,0),top:new o.Point(0,dt),"top-left":new o.Point(Ot,Ot),"top-right":new o.Point(-Ot,Ot),bottom:new o.Point(0,-dt),"bottom-left":new o.Point(Ot,-Ot),"bottom-right":new o.Point(-Ot,-Ot),left:new o.Point(dt,0),right:new o.Point(-dt,0)}}if(dt instanceof o.Point||Array.isArray(dt)){var At=o.Point.convert(dt);return{center:At,top:At,"top-left":At,"top-right":At,bottom:At,"bottom-left":At,"bottom-right":At,left:At,right:At}}return{center:o.Point.convert(dt.center||[0,0]),top:o.Point.convert(dt.top||[0,0]),"top-left":o.Point.convert(dt["top-left"]||[0,0]),"top-right":o.Point.convert(dt["top-right"]||[0,0]),bottom:o.Point.convert(dt.bottom||[0,0]),"bottom-left":o.Point.convert(dt["bottom-left"]||[0,0]),"bottom-right":o.Point.convert(dt["bottom-right"]||[0,0]),left:o.Point.convert(dt.left||[0,0]),right:o.Point.convert(dt.right||[0,0])}}return ht(new o.Point(0,0))}(this.options.offset);if(!D){var $,j=this._container.offsetWidth,et=this._container.offsetHeight;$=L.y+F.bottom.y<et?["top"]:L.y>this._map.transform.height-et?["bottom"]:[],L.x<j/2?$.push("left"):L.x>this._map.transform.width-j/2&&$.push("right"),D=$.length===0?"bottom":$.join("-")}var ut=L.add(F[D]).round();l.setTransform(this._container,Ec[D]+" translate("+ut.x+"px,"+ut.y+"px)"),Hg(this._container,D,"popup")}},b.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var _=this._container.querySelector(Cv);_&&_.focus()}},b.prototype._onClose=function(){this.remove()},b}(o.Evented),Xg={version:o.version,supported:s,setRTLTextPlugin:o.setRTLTextPlugin,getRTLTextPluginStatus:o.getRTLTextPluginStatus,Map:V0,NavigationControl:xh,GeolocateControl:G0,AttributionControl:Bs,ScaleControl:ju,FullscreenControl:Cu,Popup:Wg,Marker:wv,Style:Tl,LngLat:o.LngLat,LngLatBounds:o.LngLatBounds,Point:o.Point,MercatorCoordinate:o.MercatorCoordinate,Evented:o.Evented,config:o.config,prewarm:function(){Re().acquire(Te)},clearPrewarmedResources:function(){var y=jr;y&&(y.isPreloaded()&&y.numActive()===1?(y.release(Te),jr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return o.config.ACCESS_TOKEN},set accessToken(y){o.config.ACCESS_TOKEN=y},get baseApiUrl(){return o.config.API_URL},set baseApiUrl(y){o.config.API_URL=y},get workerCount(){return Ze.workerCount},set workerCount(y){Ze.workerCount=y},get maxParallelImageRequests(){return o.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(y){o.config.MAX_PARALLEL_IMAGE_REQUESTS=y},clearStorage:function(y){o.clearTileCache(y)},workerUrl:""};return Xg}),i})})(GJ);var G6t=GJ.exports;const vw=aa(G6t),W6t=["id","attributionControl","style","token","rotation","mapInstance"];function X6t(e,t){var r=typeof my<"u"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,n=typeof wx<"u"&&wx!==null&&(typeof wx.request<"u"||typeof wx.miniProgram<"u");if(!(r||n)&&(t||(t=document),!!t)){var i=t.head||t.getElementsByTagName("head")[0];if(!i){i=t.createElement("head");var a=t.body||t.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(i,a):t.documentElement.appendChild(i)}var o=t.createElement("style");return o.type="text/css",o.styleSheet?o.styleSheet.cssText=e:o.appendChild(t.createTextNode(e)),i.appendChild(o),o}}X6t(`.mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mapboxgl-canvas{position:absolute;left:0;top:0}.mapboxgl-map:-webkit-full-screen{width:100%;height:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:grab;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{position:absolute;pointer-events:none;z-index:2}.mapboxgl-ctrl-top-left{top:0;left:0}.mapboxgl-ctrl-top-right{top:0;right:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{right:0;bottom:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;-webkit-transform:translate(0);transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{margin:10px 0 0 10px;float:left}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{margin:10px 10px 0 0;float:right}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{margin:0 0 10px 10px;float:left}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{margin:0 10px 10px 0;float:right}.mapboxgl-ctrl-group{border-radius:4px;background:#fff}.mapboxgl-ctrl-group:not(:empty){box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{width:29px;height:29px;display:block;padding:0;outline:none;border:0;box-sizing:border-box;background-color:transparent;cursor:pointer}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{display:block;width:100%;height:100%;background-repeat:no-repeat;background-position:50%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl button::-moz-focus-inner{border:0;padding:0}.mapboxgl-ctrl-attrib-button:focus,.mapboxgl-ctrl-group button:focus{box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-group button:focus:focus-visible{box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){box-shadow:none}.mapboxgl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:focus:only-child{border-radius:inherit}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{-webkit-animation:mapboxgl-spin 2s linear infinite;animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}}@-webkit-keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(1turn)}}@keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{width:88px;height:23px;margin:0 0 -4px -4px;display:block;background-repeat:no-repeat;cursor:pointer;overflow:hidden;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg opacity='.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg opacity='.9' fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/svg%3E")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{padding:0 5px;background-color:hsla(0,0%,100%,.5);margin:0}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{min-height:20px;padding:2px 24px 2px 0;margin:10px;position:relative;background-color:#fff;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 28px 2px 8px;visibility:visible}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 8px 2px 28px;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib-button{display:none;cursor:pointer;position:absolute;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E");background-color:hsla(0,0%,100%,.5);width:24px;height:24px;box-sizing:border-box;border-radius:12px;outline:none;top:0;right:0;border:0}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl-attrib-button,.mapboxgl-ctrl-top-left .mapboxgl-ctrl-attrib-button{left:0}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-inner,.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-button{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-button{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;right:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;left:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:hsla(0,0%,100%,.75);font-size:10px;border:2px solid #333;border-top:#333;padding:0 5px;color:#333;box-sizing:border-box}.mapboxgl-popup{position:absolute;top:0;left:0;display:flex;will-change:transform;pointer-events:none}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{flex-direction:column-reverse}.mapboxgl-popup-anchor-left{flex-direction:row}.mapboxgl-popup-anchor-right{flex-direction:row-reverse}.mapboxgl-popup-tip{width:0;height:0;border:10px solid transparent;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{align-self:center;border-top:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{align-self:flex-start;border-top:none;border-left:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{align-self:flex-end;border-top:none;border-right:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{align-self:center;border-right:none;border-left-color:#fff}.mapboxgl-popup-close-button{position:absolute;right:0;top:0;border:0;border-radius:0 3px 0 0;cursor:pointer;background-color:transparent}.mapboxgl-popup-close-button:hover{background-color:rgba(0,0,0,.05)}.mapboxgl-popup-content{position:relative;background:#fff;border-radius:3px;box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{position:absolute;top:0;left:0;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;width:15px;height:15px;border-radius:50%}.mapboxgl-user-location-dot:before{content:"";position:absolute;-webkit-animation:mapboxgl-user-location-dot-pulse 2s infinite;animation:mapboxgl-user-location-dot-pulse 2s infinite}.mapboxgl-user-location-dot:after{border-radius:50%;border:2px solid #fff;content:"";height:19px;left:-2px;position:absolute;top:-2px;width:19px;box-sizing:border-box;box-shadow:0 0 3px rgba(0,0,0,.35)}@-webkit-keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);opacity:0}to{-webkit-transform:scale(1);opacity:0}}@keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);transform:scale(3);opacity:0}to{-webkit-transform:scale(1);transform:scale(1);opacity:0}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:rgba(29,161,242,.2);width:1px;height:1px;border-radius:100%}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{position:absolute;top:0;left:0;width:0;height:0;background:#fff;border:2px dotted #202020;opacity:.5}@media print{.mapbox-improve-map{display:none}}`);window.mapboxgl=vw;let j6t=0;const G$="101MlGsZ2AmmA&access_token=pk.eyJ1IjoiZXhhbXBsZXMiLCJhIjoiY2p0MG01MXRqMW45cjQzb2R6b2ptc3J4MSJ9.zA2W0IkI0c6KaAhJfk9bWg";class Y6t extends DJ{constructor(...t){super(...t),z(this,"version","MAPBOX"),z(this,"viewport",void 0)}getType(){return"mapbox"}lngLatToCoord(t,r={x:0,y:0,z:0}){const{x:n,y:i}=this.lngLatToMercator(t,0);return[n-r.x,i-r.y]}lngLatToMercator(t,r){const{x:n=0,y:i=0,z:a=0}=window.mapboxgl.MercatorCoordinate.fromLngLat(t,r);return{x:n,y:i,z:a}}getModelMatrix(t,r,n,i=[1,1,1],a={x:0,y:0,z:0}){const o=window.mapboxgl.MercatorCoordinate.fromLngLat(t,r),s=o.meterInMercatorCoordinateUnits(),l=xb();return Lf(l,l,ec(o.x-a.x,o.y-a.y,o.z||0-a.z)),Of(l,l,ec(s*i[0],-s*i[1],s*i[2])),bb(l,l,n[0]),cI(l,l,n[1]),ES(l,l,n[2]),l}init(){var t=this;return Pe(function*(){const r=t.config,{id:n="map",attributionControl:i=!1,style:a="light",token:o=G$,rotation:s=0,mapInstance:l}=r,u=Hf(r,W6t);t.viewport=new y4,!l&&!window.mapboxgl&&console.error(t.configService.getSceneWarninfo("SDK")),o===G$&&a!=="blank"&&!window.mapboxgl.accessToken&&!l&&console.warn(t.configService.getSceneWarninfo("MapToken")),!l&&!window.mapboxgl.accessToken&&(window.mapboxgl.accessToken=o),l?(t.map=l,t.$mapContainer=t.map.getContainer()):(t.$mapContainer=t.creatMapContainer(n),t.map=new window.mapboxgl.Map(Ce({container:t.$mapContainer,style:t.getMapStyleValue(a),attributionControl:i,bearing:s},u))),t.map.on("load",()=>{t.handleCameraChanged()}),t.map.on("move",t.handleCameraChanged),t.handleCameraChanged()})()}destroy(){var t;(t=this.$mapContainer)===null||t===void 0||(t=t.parentNode)===null||t===void 0||t.removeChild(this.$mapContainer),this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}emit(t,...r){this.eventEmitter.emit(t,...r)}once(t,...r){this.eventEmitter.once(t,...r)}getMapContainer(){return this.$mapContainer}getCanvasOverlays(){var t;return(t=this.getMapContainer())===null||t===void 0?void 0:t.querySelector(".mapboxgl-canvas-container")}meterToCoord(t,r){const n=new vw.LngLat(t[0],t[1]),i=new vw.LngLat(r[0],r[1]),a=n.distanceTo(i),o=vw.MercatorCoordinate.fromLngLat({lng:t[0],lat:t[1]}),s=vw.MercatorCoordinate.fromLngLat({lng:r[0],lat:r[1]}),{x:l,y:u}=o,{x:c,y:f}=s;return Math.sqrt(Math.pow(l-c,2)+Math.pow(u-f,2))*4194304*2/a}exportMap(t){const r=this.map.getCanvas();return t==="jpg"?r==null?void 0:r.toDataURL("image/jpeg"):r==null?void 0:r.toDataURL("image/png")}creatMapContainer(t){let r=t;typeof t=="string"&&(r=document.getElementById(t));const n=document.createElement("div");return n.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,n.id="l7_mapbox_div"+j6t++,r.appendChild(n),n}}function Z6t(e,t){var r=typeof my<"u"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,n=typeof wx<"u"&&wx!==null&&(typeof wx.request<"u"||typeof wx.miniProgram<"u");if(!(r||n)&&(t||(t=document),!!t)){var i=t.head||t.getElementsByTagName("head")[0];if(!i){i=t.createElement("head");var a=t.body||t.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(i,a):t.documentElement.appendChild(i)}var o=t.createElement("style");return o.type="text/css",o.styleSheet?o.styleSheet.cssText=e:o.appendChild(t.createTextNode(e)),i.appendChild(o),o}}Z6t(`.mapboxgl-ctrl-logo {
  display: none !important;
}
`);class q6t extends g4{getServiceConstructor(){return Y6t}}const K6t=_4,Q6t=_4,J6t=_4;function kf(e){return e==null}var t8t=function(e,t,r){return e<t?t:e>r?r:e};const e8t=t8t;function Y1(e){return typeof e=="number"}var WJ={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function i(l,u,c){this.fn=l,this.context=u,this.once=c||!1}function a(l,u,c,f,d){if(typeof c!="function")throw new TypeError("The listener must be a function");var v=new i(c,f||l,d),g=r?r+u:u;return l._events[g]?l._events[g].fn?l._events[g]=[l._events[g],v]:l._events[g].push(v):(l._events[g]=v,l._eventsCount++),l}function o(l,u){--l._eventsCount===0?l._events=new n:delete l._events[u]}function s(){this._events=new n,this._eventsCount=0}s.prototype.eventNames=function(){var u=[],c,f;if(this._eventsCount===0)return u;for(f in c=this._events)t.call(c,f)&&u.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(c)):u},s.prototype.listeners=function(u){var c=r?r+u:u,f=this._events[c];if(!f)return[];if(f.fn)return[f.fn];for(var d=0,v=f.length,g=new Array(v);d<v;d++)g[d]=f[d].fn;return g},s.prototype.listenerCount=function(u){var c=r?r+u:u,f=this._events[c];return f?f.fn?1:f.length:0},s.prototype.emit=function(u,c,f,d,v,g){var x=r?r+u:u;if(!this._events[x])return!1;var w=this._events[x],S=arguments.length,A,M;if(w.fn){switch(w.once&&this.removeListener(u,w.fn,void 0,!0),S){case 1:return w.fn.call(w.context),!0;case 2:return w.fn.call(w.context,c),!0;case 3:return w.fn.call(w.context,c,f),!0;case 4:return w.fn.call(w.context,c,f,d),!0;case 5:return w.fn.call(w.context,c,f,d,v),!0;case 6:return w.fn.call(w.context,c,f,d,v,g),!0}for(M=1,A=new Array(S-1);M<S;M++)A[M-1]=arguments[M];w.fn.apply(w.context,A)}else{var R=w.length,O;for(M=0;M<R;M++)switch(w[M].once&&this.removeListener(u,w[M].fn,void 0,!0),S){case 1:w[M].fn.call(w[M].context);break;case 2:w[M].fn.call(w[M].context,c);break;case 3:w[M].fn.call(w[M].context,c,f);break;case 4:w[M].fn.call(w[M].context,c,f,d);break;default:if(!A)for(O=1,A=new Array(S-1);O<S;O++)A[O-1]=arguments[O];w[M].fn.apply(w[M].context,A)}}return!0},s.prototype.on=function(u,c,f){return a(this,u,c,f,!1)},s.prototype.once=function(u,c,f){return a(this,u,c,f,!0)},s.prototype.removeListener=function(u,c,f,d){var v=r?r+u:u;if(!this._events[v])return this;if(!c)return o(this,v),this;var g=this._events[v];if(g.fn)g.fn===c&&(!d||g.once)&&(!f||g.context===f)&&o(this,v);else{for(var x=0,w=[],S=g.length;x<S;x++)(g[x].fn!==c||d&&!g[x].once||f&&g[x].context!==f)&&w.push(g[x]);w.length?this._events[v]=w.length===1?w[0]:w:o(this,v)}return this},s.prototype.removeAllListeners=function(u){var c;return u?(c=r?r+u:u,this._events[c]&&o(this,c)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,e.exports=s})(WJ);var r8t=WJ.exports;const XJ=aa(r8t);var Dt;(function(e){e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",e[e.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",e[e.BLEND_EQUATION=32777]="BLEND_EQUATION",e[e.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",e[e.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",e[e.BLEND_DST_RGB=32968]="BLEND_DST_RGB",e[e.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",e[e.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",e[e.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",e[e.BLEND_COLOR=32773]="BLEND_COLOR",e[e.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",e[e.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e.LINE_WIDTH=2849]="LINE_WIDTH",e[e.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",e[e.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",e[e.CULL_FACE_MODE=2885]="CULL_FACE_MODE",e[e.FRONT_FACE=2886]="FRONT_FACE",e[e.DEPTH_RANGE=2928]="DEPTH_RANGE",e[e.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",e[e.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",e[e.DEPTH_FUNC=2932]="DEPTH_FUNC",e[e.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",e[e.STENCIL_FUNC=2962]="STENCIL_FUNC",e[e.STENCIL_FAIL=2964]="STENCIL_FAIL",e[e.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",e[e.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",e[e.STENCIL_REF=2967]="STENCIL_REF",e[e.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",e[e.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",e[e.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",e[e.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",e[e.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",e[e.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",e[e.VIEWPORT=2978]="VIEWPORT",e[e.SCISSOR_BOX=3088]="SCISSOR_BOX",e[e.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",e[e.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",e[e.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",e[e.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e[e.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",e[e.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",e[e.RED_BITS=3410]="RED_BITS",e[e.GREEN_BITS=3411]="GREEN_BITS",e[e.BLUE_BITS=3412]="BLUE_BITS",e[e.ALPHA_BITS=3413]="ALPHA_BITS",e[e.DEPTH_BITS=3414]="DEPTH_BITS",e[e.STENCIL_BITS=3415]="STENCIL_BITS",e[e.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",e[e.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",e[e.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",e[e.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",e[e.SAMPLES=32937]="SAMPLES",e[e.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",e[e.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",e[e.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",e[e.VENDOR=7936]="VENDOR",e[e.RENDERER=7937]="RENDERER",e[e.VERSION=7938]="VERSION",e[e.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",e[e.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",e[e.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.BUFFER_SIZE=34660]="BUFFER_SIZE",e[e.BUFFER_USAGE=34661]="BUFFER_USAGE",e[e.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",e[e.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e.CULL_FACE=2884]="CULL_FACE",e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.BLEND=3042]="BLEND",e[e.DEPTH_TEST=2929]="DEPTH_TEST",e[e.DITHER=3024]="DITHER",e[e.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",e[e.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",e[e.SCISSOR_TEST=3089]="SCISSOR_TEST",e[e.STENCIL_TEST=2960]="STENCIL_TEST",e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e[e.CW=2304]="CW",e[e.CCW=2305]="CCW",e[e.DONT_CARE=4352]="DONT_CARE",e[e.FASTEST=4353]="FASTEST",e[e.NICEST=4354]="NICEST",e[e.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.DOUBLE=5130]="DOUBLE",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER",e[e.COMPILE_STATUS=35713]="COMPILE_STATUS",e[e.DELETE_STATUS=35712]="DELETE_STATUS",e[e.LINK_STATUS=35714]="LINK_STATUS",e[e.VALIDATE_STATUS=35715]="VALIDATE_STATUS",e[e.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",e[e.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",e[e.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",e[e.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",e[e.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",e[e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e.SHADER_TYPE=35663]="SHADER_TYPE",e[e.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",e[e.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",e[e.NEVER=512]="NEVER",e[e.ALWAYS=519]="ALWAYS",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.GEQUAL=518]="GEQUAL",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e[e.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",e[e.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE=5890]="TEXTURE",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e.TEXTURE0=33984]="TEXTURE0",e[e.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",e[e.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.LOW_FLOAT=36336]="LOW_FLOAT",e[e.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",e[e.HIGH_FLOAT=36338]="HIGH_FLOAT",e[e.LOW_INT=36339]="LOW_INT",e[e.MEDIUM_INT=36340]="MEDIUM_INT",e[e.HIGH_INT=36341]="HIGH_INT",e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.RENDERBUFFER=36161]="RENDERBUFFER",e[e.RGBA4=32854]="RGBA4",e[e.RGB5_A1=32855]="RGB5_A1",e[e.RGB565=36194]="RGB565",e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX=6401]="STENCIL_INDEX",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",e[e.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",e[e.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",e[e.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",e[e.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",e[e.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",e[e.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",e[e.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",e[e.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",e[e.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",e[e.NONE=0]="NONE",e[e.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",e[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",e[e.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",e[e.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",e[e.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",e[e.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",e[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e.READ_BUFFER=3074]="READ_BUFFER",e[e.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",e[e.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",e[e.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",e[e.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",e[e.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",e[e.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",e[e.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",e[e.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",e[e.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",e[e.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",e[e.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",e[e.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",e[e.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",e[e.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",e[e.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",e[e.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",e[e.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",e[e.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",e[e.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",e[e.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",e[e.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",e[e.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",e[e.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",e[e.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",e[e.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",e[e.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",e[e.RED=6403]="RED",e[e.RGB8=32849]="RGB8",e[e.RGBA8=32856]="RGBA8",e[e.RGB10_A2=32857]="RGB10_A2",e[e.TEXTURE_3D=32879]="TEXTURE_3D",e[e.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",e[e.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",e[e.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",e[e.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",e[e.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",e[e.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",e[e.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",e[e.SRGB=35904]="SRGB",e[e.SRGB8=35905]="SRGB8",e[e.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",e[e.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",e[e.RGBA32F=34836]="RGBA32F",e[e.RGB32F=34837]="RGB32F",e[e.RGBA16F=34842]="RGBA16F",e[e.RGB16F=34843]="RGB16F",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e[e.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",e[e.R11F_G11F_B10F=35898]="R11F_G11F_B10F",e[e.RGB9_E5=35901]="RGB9_E5",e[e.RGBA32UI=36208]="RGBA32UI",e[e.RGB32UI=36209]="RGB32UI",e[e.RGBA16UI=36214]="RGBA16UI",e[e.RGB16UI=36215]="RGB16UI",e[e.RGBA8UI=36220]="RGBA8UI",e[e.RGB8UI=36221]="RGB8UI",e[e.RGBA32I=36226]="RGBA32I",e[e.RGB32I=36227]="RGB32I",e[e.RGBA16I=36232]="RGBA16I",e[e.RGB16I=36233]="RGB16I",e[e.RGBA8I=36238]="RGBA8I",e[e.RGB8I=36239]="RGB8I",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER",e[e.R8=33321]="R8",e[e.RG8=33323]="RG8",e[e.R16F=33325]="R16F",e[e.R32F=33326]="R32F",e[e.RG16F=33327]="RG16F",e[e.RG32F=33328]="RG32F",e[e.R8I=33329]="R8I",e[e.R8UI=33330]="R8UI",e[e.R16I=33331]="R16I",e[e.R16UI=33332]="R16UI",e[e.R32I=33333]="R32I",e[e.R32UI=33334]="R32UI",e[e.RG8I=33335]="RG8I",e[e.RG8UI=33336]="RG8UI",e[e.RG16I=33337]="RG16I",e[e.RG16UI=33338]="RG16UI",e[e.RG32I=33339]="RG32I",e[e.RG32UI=33340]="RG32UI",e[e.R8_SNORM=36756]="R8_SNORM",e[e.RG8_SNORM=36757]="RG8_SNORM",e[e.RGB8_SNORM=36758]="RGB8_SNORM",e[e.RGBA8_SNORM=36759]="RGBA8_SNORM",e[e.RGB10_A2UI=36975]="RGB10_A2UI",e[e.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",e[e.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.HALF_FLOAT=5131]="HALF_FLOAT",e[e.RG=33319]="RG",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",e[e.CURRENT_QUERY=34917]="CURRENT_QUERY",e[e.QUERY_RESULT=34918]="QUERY_RESULT",e[e.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",e[e.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",e[e.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",e[e.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",e[e.DRAW_BUFFER0=34853]="DRAW_BUFFER0",e[e.DRAW_BUFFER1=34854]="DRAW_BUFFER1",e[e.DRAW_BUFFER2=34855]="DRAW_BUFFER2",e[e.DRAW_BUFFER3=34856]="DRAW_BUFFER3",e[e.DRAW_BUFFER4=34857]="DRAW_BUFFER4",e[e.DRAW_BUFFER5=34858]="DRAW_BUFFER5",e[e.DRAW_BUFFER6=34859]="DRAW_BUFFER6",e[e.DRAW_BUFFER7=34860]="DRAW_BUFFER7",e[e.DRAW_BUFFER8=34861]="DRAW_BUFFER8",e[e.DRAW_BUFFER9=34862]="DRAW_BUFFER9",e[e.DRAW_BUFFER10=34863]="DRAW_BUFFER10",e[e.DRAW_BUFFER11=34864]="DRAW_BUFFER11",e[e.DRAW_BUFFER12=34865]="DRAW_BUFFER12",e[e.DRAW_BUFFER13=34866]="DRAW_BUFFER13",e[e.DRAW_BUFFER14=34867]="DRAW_BUFFER14",e[e.DRAW_BUFFER15=34868]="DRAW_BUFFER15",e[e.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",e[e.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",e[e.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",e[e.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",e[e.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",e[e.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",e[e.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",e[e.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",e[e.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",e[e.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",e[e.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",e[e.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",e[e.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",e[e.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",e[e.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",e[e.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",e[e.SAMPLER_3D=35679]="SAMPLER_3D",e[e.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",e[e.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",e[e.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",e[e.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",e[e.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",e[e.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",e[e.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",e[e.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",e[e.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",e[e.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",e[e.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",e[e.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",e[e.MAX_SAMPLES=36183]="MAX_SAMPLES",e[e.SAMPLER_BINDING=35097]="SAMPLER_BINDING",e[e.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",e[e.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",e[e.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",e[e.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",e[e.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",e[e.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",e[e.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",e[e.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",e[e.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",e[e.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",e[e.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",e[e.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",e[e.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",e[e.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",e[e.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",e[e.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",e[e.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",e[e.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",e[e.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",e[e.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",e[e.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",e[e.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",e[e.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",e[e.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",e[e.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",e[e.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",e[e.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",e[e.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",e[e.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",e[e.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",e[e.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",e[e.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",e[e.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",e[e.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",e[e.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",e[e.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",e[e.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",e[e.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",e[e.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",e[e.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",e[e.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",e[e.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",e[e.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e[e.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",e[e.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",e[e.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",e[e.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",e[e.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",e[e.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",e[e.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",e[e.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",e[e.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",e[e.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",e[e.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",e[e.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",e[e.UNIFORM_TYPE=35383]="UNIFORM_TYPE",e[e.UNIFORM_SIZE=35384]="UNIFORM_SIZE",e[e.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",e[e.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",e[e.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",e[e.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",e[e.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",e[e.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",e[e.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",e[e.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",e[e.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",e[e.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",e[e.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",e[e.OBJECT_TYPE=37138]="OBJECT_TYPE",e[e.SYNC_CONDITION=37139]="SYNC_CONDITION",e[e.SYNC_STATUS=37140]="SYNC_STATUS",e[e.SYNC_FLAGS=37141]="SYNC_FLAGS",e[e.SYNC_FENCE=37142]="SYNC_FENCE",e[e.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",e[e.UNSIGNALED=37144]="UNSIGNALED",e[e.SIGNALED=37145]="SIGNALED",e[e.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",e[e.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",e[e.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",e[e.WAIT_FAILED=37149]="WAIT_FAILED",e[e.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",e[e.COLOR=6144]="COLOR",e[e.DEPTH=6145]="DEPTH",e[e.STENCIL=6146]="STENCIL",e[e.MIN=32775]="MIN",e[e.MAX=32776]="MAX",e[e.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",e[e.STREAM_READ=35041]="STREAM_READ",e[e.STREAM_COPY=35042]="STREAM_COPY",e[e.STATIC_READ=35045]="STATIC_READ",e[e.STATIC_COPY=35046]="STATIC_COPY",e[e.DYNAMIC_READ=35049]="DYNAMIC_READ",e[e.DYNAMIC_COPY=35050]="DYNAMIC_COPY",e[e.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",e[e.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",e[e.INVALID_INDEX=4294967295]="INVALID_INDEX",e[e.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",e[e.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",e[e.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE",e[e.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",e[e.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",e[e.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",e[e.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",e[e.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",e[e.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",e[e.UNSIGNED_INT_24_8_WEBGL=34042]="UNSIGNED_INT_24_8_WEBGL",e[e.HALF_FLOAT_OES=36193]="HALF_FLOAT_OES",e[e.RGBA32F_EXT=34836]="RGBA32F_EXT",e[e.RGB32F_EXT=34837]="RGB32F_EXT",e[e.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT",e[e.UNSIGNED_NORMALIZED_EXT=35863]="UNSIGNED_NORMALIZED_EXT",e[e.MIN_EXT=32775]="MIN_EXT",e[e.MAX_EXT=32776]="MAX_EXT",e[e.SRGB_EXT=35904]="SRGB_EXT",e[e.SRGB_ALPHA_EXT=35906]="SRGB_ALPHA_EXT",e[e.SRGB8_ALPHA8_EXT=35907]="SRGB8_ALPHA8_EXT",e[e.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT",e[e.FRAGMENT_SHADER_DERIVATIVE_HINT_OES=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT_OES",e[e.COLOR_ATTACHMENT0_WEBGL=36064]="COLOR_ATTACHMENT0_WEBGL",e[e.COLOR_ATTACHMENT1_WEBGL=36065]="COLOR_ATTACHMENT1_WEBGL",e[e.COLOR_ATTACHMENT2_WEBGL=36066]="COLOR_ATTACHMENT2_WEBGL",e[e.COLOR_ATTACHMENT3_WEBGL=36067]="COLOR_ATTACHMENT3_WEBGL",e[e.COLOR_ATTACHMENT4_WEBGL=36068]="COLOR_ATTACHMENT4_WEBGL",e[e.COLOR_ATTACHMENT5_WEBGL=36069]="COLOR_ATTACHMENT5_WEBGL",e[e.COLOR_ATTACHMENT6_WEBGL=36070]="COLOR_ATTACHMENT6_WEBGL",e[e.COLOR_ATTACHMENT7_WEBGL=36071]="COLOR_ATTACHMENT7_WEBGL",e[e.COLOR_ATTACHMENT8_WEBGL=36072]="COLOR_ATTACHMENT8_WEBGL",e[e.COLOR_ATTACHMENT9_WEBGL=36073]="COLOR_ATTACHMENT9_WEBGL",e[e.COLOR_ATTACHMENT10_WEBGL=36074]="COLOR_ATTACHMENT10_WEBGL",e[e.COLOR_ATTACHMENT11_WEBGL=36075]="COLOR_ATTACHMENT11_WEBGL",e[e.COLOR_ATTACHMENT12_WEBGL=36076]="COLOR_ATTACHMENT12_WEBGL",e[e.COLOR_ATTACHMENT13_WEBGL=36077]="COLOR_ATTACHMENT13_WEBGL",e[e.COLOR_ATTACHMENT14_WEBGL=36078]="COLOR_ATTACHMENT14_WEBGL",e[e.COLOR_ATTACHMENT15_WEBGL=36079]="COLOR_ATTACHMENT15_WEBGL",e[e.DRAW_BUFFER0_WEBGL=34853]="DRAW_BUFFER0_WEBGL",e[e.DRAW_BUFFER1_WEBGL=34854]="DRAW_BUFFER1_WEBGL",e[e.DRAW_BUFFER2_WEBGL=34855]="DRAW_BUFFER2_WEBGL",e[e.DRAW_BUFFER3_WEBGL=34856]="DRAW_BUFFER3_WEBGL",e[e.DRAW_BUFFER4_WEBGL=34857]="DRAW_BUFFER4_WEBGL",e[e.DRAW_BUFFER5_WEBGL=34858]="DRAW_BUFFER5_WEBGL",e[e.DRAW_BUFFER6_WEBGL=34859]="DRAW_BUFFER6_WEBGL",e[e.DRAW_BUFFER7_WEBGL=34860]="DRAW_BUFFER7_WEBGL",e[e.DRAW_BUFFER8_WEBGL=34861]="DRAW_BUFFER8_WEBGL",e[e.DRAW_BUFFER9_WEBGL=34862]="DRAW_BUFFER9_WEBGL",e[e.DRAW_BUFFER10_WEBGL=34863]="DRAW_BUFFER10_WEBGL",e[e.DRAW_BUFFER11_WEBGL=34864]="DRAW_BUFFER11_WEBGL",e[e.DRAW_BUFFER12_WEBGL=34865]="DRAW_BUFFER12_WEBGL",e[e.DRAW_BUFFER13_WEBGL=34866]="DRAW_BUFFER13_WEBGL",e[e.DRAW_BUFFER14_WEBGL=34867]="DRAW_BUFFER14_WEBGL",e[e.DRAW_BUFFER15_WEBGL=34868]="DRAW_BUFFER15_WEBGL",e[e.MAX_COLOR_ATTACHMENTS_WEBGL=36063]="MAX_COLOR_ATTACHMENTS_WEBGL",e[e.MAX_DRAW_BUFFERS_WEBGL=34852]="MAX_DRAW_BUFFERS_WEBGL",e[e.VERTEX_ARRAY_BINDING_OES=34229]="VERTEX_ARRAY_BINDING_OES",e[e.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",e[e.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",e[e.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",e[e.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",e[e.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",e[e.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",e[e.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT"})(Dt||(Dt={}));var Qi;(function(e){e[e.Buffer=0]="Buffer",e[e.Texture=1]="Texture",e[e.RenderTarget=2]="RenderTarget",e[e.Sampler=3]="Sampler",e[e.Program=4]="Program",e[e.Bindings=5]="Bindings",e[e.InputLayout=6]="InputLayout",e[e.RenderPipeline=7]="RenderPipeline",e[e.ComputePipeline=8]="ComputePipeline",e[e.Readback=9]="Readback",e[e.QueryPool=10]="QueryPool",e[e.RenderBundle=11]="RenderBundle"})(Qi||(Qi={}));var pa;(function(e){e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS"})(pa||(pa={}));var _C;(function(e){e[e.CCW=2305]="CCW",e[e.CW=2304]="CW"})(_C||(_C={}));var Vc;(function(e){e[e.NONE=0]="NONE",e[e.FRONT=1]="FRONT",e[e.BACK=2]="BACK",e[e.FRONT_AND_BACK=3]="FRONT_AND_BACK"})(Vc||(Vc={}));var Li;(function(e){e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC=768]="SRC",e[e.ONE_MINUS_SRC=769]="ONE_MINUS_SRC",e[e.DST=774]="DST",e[e.ONE_MINUS_DST=775]="ONE_MINUS_DST",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.CONST=32769]="CONST",e[e.ONE_MINUS_CONSTANT=32770]="ONE_MINUS_CONSTANT",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE"})(Li||(Li={}));var ml;(function(e){e[e.ADD=32774]="ADD",e[e.SUBSTRACT=32778]="SUBSTRACT",e[e.REVERSE_SUBSTRACT=32779]="REVERSE_SUBSTRACT",e[e.MIN=32775]="MIN",e[e.MAX=32776]="MAX"})(ml||(ml={}));var ac;(function(e){e[e.CLAMP_TO_EDGE=0]="CLAMP_TO_EDGE",e[e.REPEAT=1]="REPEAT",e[e.MIRRORED_REPEAT=2]="MIRRORED_REPEAT"})(ac||(ac={}));var ts;(function(e){e[e.POINT=0]="POINT",e[e.BILINEAR=1]="BILINEAR"})(ts||(ts={}));var el;(function(e){e[e.NO_MIP=0]="NO_MIP",e[e.NEAREST=1]="NEAREST",e[e.LINEAR=2]="LINEAR"})(el||(el={}));var Rs;(function(e){e[e.POINTS=0]="POINTS",e[e.TRIANGLES=1]="TRIANGLES",e[e.TRIANGLE_STRIP=2]="TRIANGLE_STRIP",e[e.LINES=3]="LINES",e[e.LINE_STRIP=4]="LINE_STRIP"})(Rs||(Rs={}));var Na;(function(e){e[e.MAP_READ=1]="MAP_READ",e[e.MAP_WRITE=2]="MAP_WRITE",e[e.COPY_SRC=4]="COPY_SRC",e[e.COPY_DST=8]="COPY_DST",e[e.INDEX=16]="INDEX",e[e.VERTEX=32]="VERTEX",e[e.UNIFORM=64]="UNIFORM",e[e.STORAGE=128]="STORAGE",e[e.INDIRECT=256]="INDIRECT",e[e.QUERY_RESOLVE=512]="QUERY_RESOLVE"})(Na||(Na={}));var Fd;(function(e){e[e.STATIC=1]="STATIC",e[e.DYNAMIC=2]="DYNAMIC"})(Fd||(Fd={}));var Qy;(function(e){e[e.VERTEX=1]="VERTEX",e[e.INSTANCE=2]="INSTANCE"})(Qy||(Qy={}));var W$;(function(e){e.LOADED="loaded"})(W$||(W$={}));var Oi;(function(e){e[e.TEXTURE_2D=0]="TEXTURE_2D",e[e.TEXTURE_2D_ARRAY=1]="TEXTURE_2D_ARRAY",e[e.TEXTURE_3D=2]="TEXTURE_3D",e[e.TEXTURE_CUBE_MAP=3]="TEXTURE_CUBE_MAP"})(Oi||(Oi={}));var Du;(function(e){e[e.SAMPLED=1]="SAMPLED",e[e.RENDER_TARGET=2]="RENDER_TARGET",e[e.STORAGE=4]="STORAGE"})(Du||(Du={}));var dl;(function(e){e[e.NONE=0]="NONE",e[e.RED=1]="RED",e[e.GREEN=2]="GREEN",e[e.BLUE=4]="BLUE",e[e.ALPHA=8]="ALPHA",e[e.RGB=7]="RGB",e[e.ALL=15]="ALL"})(dl||(dl={}));var $o;(function(e){e[e.KEEP=7680]="KEEP",e[e.ZERO=0]="ZERO",e[e.REPLACE=7681]="REPLACE",e[e.INVERT=5386]="INVERT",e[e.INCREMENT_CLAMP=7682]="INCREMENT_CLAMP",e[e.DECREMENT_CLAMP=7683]="DECREMENT_CLAMP",e[e.INCREMENT_WRAP=34055]="INCREMENT_WRAP",e[e.DECREMENT_WRAP=34056]="DECREMENT_WRAP"})($o||($o={}));var Uo;(function(e){e[e.Float=0]="Float",e[e.UnfilterableFloat=1]="UnfilterableFloat",e[e.Uint=2]="Uint",e[e.Sint=3]="Sint",e[e.Depth=4]="Depth"})(Uo||(Uo={}));var Od;(function(e){e[e.LOWER_LEFT=0]="LOWER_LEFT",e[e.UPPER_LEFT=1]="UPPER_LEFT"})(Od||(Od={}));var zx;(function(e){e[e.NEGATIVE_ONE=0]="NEGATIVE_ONE",e[e.ZERO=1]="ZERO"})(zx||(zx={}));var FM;(function(e){e[e.OcclusionConservative=0]="OcclusionConservative"})(FM||(FM={}));var Ge;(function(e){e[e.U8=1]="U8",e[e.U16=2]="U16",e[e.U32=3]="U32",e[e.S8=4]="S8",e[e.S16=5]="S16",e[e.S32=6]="S32",e[e.F16=7]="F16",e[e.F32=8]="F32",e[e.BC1=65]="BC1",e[e.BC2=66]="BC2",e[e.BC3=67]="BC3",e[e.BC4_UNORM=68]="BC4_UNORM",e[e.BC4_SNORM=69]="BC4_SNORM",e[e.BC5_UNORM=70]="BC5_UNORM",e[e.BC5_SNORM=71]="BC5_SNORM",e[e.U16_PACKED_5551=97]="U16_PACKED_5551",e[e.U16_PACKED_565=98]="U16_PACKED_565",e[e.D24=129]="D24",e[e.D32F=130]="D32F",e[e.D24S8=131]="D24S8",e[e.D32FS8=132]="D32FS8"})(Ge||(Ge={}));var Jr;(function(e){e[e.R=1]="R",e[e.RG=2]="RG",e[e.RGB=3]="RGB",e[e.RGBA=4]="RGBA",e[e.A=5]="A"})(Jr||(Jr={}));var Fr;(function(e){e[e.None=0]="None",e[e.Normalized=1]="Normalized",e[e.sRGB=2]="sRGB",e[e.Depth=4]="Depth",e[e.Stencil=8]="Stencil",e[e.RenderTarget=16]="RenderTarget",e[e.Luminance=32]="Luminance"})(Fr||(Fr={}));function yn(e,t,r){return e<<16|t<<8|r}var te;(function(e){e[e.ALPHA=yn(Ge.U8,Jr.A,Fr.None)]="ALPHA",e[e.U8_LUMINANCE=yn(Ge.U8,Jr.A,Fr.Luminance)]="U8_LUMINANCE",e[e.F16_LUMINANCE=yn(Ge.F16,Jr.A,Fr.Luminance)]="F16_LUMINANCE",e[e.F32_LUMINANCE=yn(Ge.F32,Jr.A,Fr.Luminance)]="F32_LUMINANCE",e[e.F16_R=yn(Ge.F16,Jr.R,Fr.None)]="F16_R",e[e.F16_RG=yn(Ge.F16,Jr.RG,Fr.None)]="F16_RG",e[e.F16_RGB=yn(Ge.F16,Jr.RGB,Fr.None)]="F16_RGB",e[e.F16_RGBA=yn(Ge.F16,Jr.RGBA,Fr.None)]="F16_RGBA",e[e.F32_R=yn(Ge.F32,Jr.R,Fr.None)]="F32_R",e[e.F32_RG=yn(Ge.F32,Jr.RG,Fr.None)]="F32_RG",e[e.F32_RGB=yn(Ge.F32,Jr.RGB,Fr.None)]="F32_RGB",e[e.F32_RGBA=yn(Ge.F32,Jr.RGBA,Fr.None)]="F32_RGBA",e[e.U8_R=yn(Ge.U8,Jr.R,Fr.None)]="U8_R",e[e.U8_R_NORM=yn(Ge.U8,Jr.R,Fr.Normalized)]="U8_R_NORM",e[e.U8_RG=yn(Ge.U8,Jr.RG,Fr.None)]="U8_RG",e[e.U8_RG_NORM=yn(Ge.U8,Jr.RG,Fr.Normalized)]="U8_RG_NORM",e[e.U8_RGB=yn(Ge.U8,Jr.RGB,Fr.None)]="U8_RGB",e[e.U8_RGB_NORM=yn(Ge.U8,Jr.RGB,Fr.Normalized)]="U8_RGB_NORM",e[e.U8_RGB_SRGB=yn(Ge.U8,Jr.RGB,Fr.sRGB|Fr.Normalized)]="U8_RGB_SRGB",e[e.U8_RGBA=yn(Ge.U8,Jr.RGBA,Fr.None)]="U8_RGBA",e[e.U8_RGBA_NORM=yn(Ge.U8,Jr.RGBA,Fr.Normalized)]="U8_RGBA_NORM",e[e.U8_RGBA_SRGB=yn(Ge.U8,Jr.RGBA,Fr.sRGB|Fr.Normalized)]="U8_RGBA_SRGB",e[e.U16_R=yn(Ge.U16,Jr.R,Fr.None)]="U16_R",e[e.U16_R_NORM=yn(Ge.U16,Jr.R,Fr.Normalized)]="U16_R_NORM",e[e.U16_RG_NORM=yn(Ge.U16,Jr.RG,Fr.Normalized)]="U16_RG_NORM",e[e.U16_RGBA_NORM=yn(Ge.U16,Jr.RGBA,Fr.Normalized)]="U16_RGBA_NORM",e[e.U16_RGBA=yn(Ge.U16,Jr.RGBA,Fr.None)]="U16_RGBA",e[e.U16_RGB=yn(Ge.U16,Jr.RGB,Fr.None)]="U16_RGB",e[e.U16_RG=yn(Ge.U16,Jr.RG,Fr.None)]="U16_RG",e[e.U32_R=yn(Ge.U32,Jr.R,Fr.None)]="U32_R",e[e.U32_RG=yn(Ge.U32,Jr.RG,Fr.None)]="U32_RG",e[e.U32_RGB=yn(Ge.U32,Jr.RGB,Fr.None)]="U32_RGB",e[e.U32_RGBA=yn(Ge.U32,Jr.RGBA,Fr.None)]="U32_RGBA",e[e.S8_R=yn(Ge.S8,Jr.R,Fr.None)]="S8_R",e[e.S8_R_NORM=yn(Ge.S8,Jr.R,Fr.Normalized)]="S8_R_NORM",e[e.S8_RG_NORM=yn(Ge.S8,Jr.RG,Fr.Normalized)]="S8_RG_NORM",e[e.S8_RGB_NORM=yn(Ge.S8,Jr.RGB,Fr.Normalized)]="S8_RGB_NORM",e[e.S8_RGBA_NORM=yn(Ge.S8,Jr.RGBA,Fr.Normalized)]="S8_RGBA_NORM",e[e.S16_R=yn(Ge.S16,Jr.R,Fr.None)]="S16_R",e[e.S16_RG=yn(Ge.S16,Jr.RG,Fr.None)]="S16_RG",e[e.S16_RG_NORM=yn(Ge.S16,Jr.RG,Fr.Normalized)]="S16_RG_NORM",e[e.S16_RGB_NORM=yn(Ge.S16,Jr.RGB,Fr.Normalized)]="S16_RGB_NORM",e[e.S16_RGBA=yn(Ge.S16,Jr.RGBA,Fr.None)]="S16_RGBA",e[e.S16_RGBA_NORM=yn(Ge.S16,Jr.RGBA,Fr.Normalized)]="S16_RGBA_NORM",e[e.S32_R=yn(Ge.S32,Jr.R,Fr.None)]="S32_R",e[e.S32_RG=yn(Ge.S32,Jr.RG,Fr.None)]="S32_RG",e[e.S32_RGB=yn(Ge.S32,Jr.RGB,Fr.None)]="S32_RGB",e[e.S32_RGBA=yn(Ge.S32,Jr.RGBA,Fr.None)]="S32_RGBA",e[e.U16_RGBA_5551=yn(Ge.U16_PACKED_5551,Jr.RGBA,Fr.Normalized)]="U16_RGBA_5551",e[e.U16_RGB_565=yn(Ge.U16_PACKED_565,Jr.RGB,Fr.Normalized)]="U16_RGB_565",e[e.BC1=yn(Ge.BC1,Jr.RGBA,Fr.Normalized)]="BC1",e[e.BC1_SRGB=yn(Ge.BC1,Jr.RGBA,Fr.Normalized|Fr.sRGB)]="BC1_SRGB",e[e.BC2=yn(Ge.BC2,Jr.RGBA,Fr.Normalized)]="BC2",e[e.BC2_SRGB=yn(Ge.BC2,Jr.RGBA,Fr.Normalized|Fr.sRGB)]="BC2_SRGB",e[e.BC3=yn(Ge.BC3,Jr.RGBA,Fr.Normalized)]="BC3",e[e.BC3_SRGB=yn(Ge.BC3,Jr.RGBA,Fr.Normalized|Fr.sRGB)]="BC3_SRGB",e[e.BC4_UNORM=yn(Ge.BC4_UNORM,Jr.R,Fr.Normalized)]="BC4_UNORM",e[e.BC4_SNORM=yn(Ge.BC4_SNORM,Jr.R,Fr.Normalized)]="BC4_SNORM",e[e.BC5_UNORM=yn(Ge.BC5_UNORM,Jr.RG,Fr.Normalized)]="BC5_UNORM",e[e.BC5_SNORM=yn(Ge.BC5_SNORM,Jr.RG,Fr.Normalized)]="BC5_SNORM",e[e.D24=yn(Ge.D24,Jr.R,Fr.Depth)]="D24",e[e.D24_S8=yn(Ge.D24S8,Jr.RG,Fr.Depth|Fr.Stencil)]="D24_S8",e[e.D32F=yn(Ge.D32F,Jr.R,Fr.Depth)]="D32F",e[e.D32F_S8=yn(Ge.D32FS8,Jr.RG,Fr.Depth|Fr.Stencil)]="D32F_S8",e[e.U8_RGB_RT=yn(Ge.U8,Jr.RGB,Fr.RenderTarget|Fr.Normalized)]="U8_RGB_RT",e[e.U8_RGBA_RT=yn(Ge.U8,Jr.RGBA,Fr.RenderTarget|Fr.Normalized)]="U8_RGBA_RT",e[e.U8_RGBA_RT_SRGB=yn(Ge.U8,Jr.RGBA,Fr.RenderTarget|Fr.Normalized|Fr.sRGB)]="U8_RGBA_RT_SRGB"})(te||(te={}));function I4(e){return e>>>8&255}function Qp(e){return e>>>16&255}function Ux(e){return e&255}function jJ(e){switch(e){case Ge.F32:case Ge.U32:case Ge.S32:return 4;case Ge.U16:case Ge.S16:case Ge.F16:return 2;case Ge.U8:case Ge.S8:return 1;default:throw new Error("whoops")}}function YJ(e){return jJ(Qp(e))}function n8t(e){var t=jJ(Qp(e)),r=I4(e);return t*r}function ZJ(e){var t=Ux(e);if(t&Fr.Depth)return Uo.Depth;if(t&Fr.Normalized)return Uo.Float;var r=Qp(e);if(r===Ge.F16||r===Ge.F32)return Uo.Float;if(r===Ge.U8||r===Ge.U16||r===Ge.U32)return Uo.Uint;if(r===Ge.S8||r===Ge.S16||r===Ge.S32)return Uo.Sint;throw new Error("whoops")}function ri(e,t){if(t===void 0&&(t=""),!e)throw new Error("Assert fail: ".concat(t))}function Ey(e){if(e!=null)return e;throw new Error("Missing object")}function qJ(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a}function KJ(e,t){e.r=t.r,e.g=t.g,e.b=t.b,e.a=t.a}function QJ(e){var t=e.r,r=e.g,n=e.b,i=e.a;return{r:t,g:r,b:n,a:i}}function MS(e,t,r,n){return n===void 0&&(n=1),{r:e,g:t,b:r,a:n}}var _I=MS(0,0,0,0);MS(0,0,0,1);var i8t=MS(1,1,1,0);MS(1,1,1,1);function BM(e){return!!(e&&!(e&e-1))}function im(e,t){return e??t}function a8t(e){return e===void 0?null:e}function NM(e,t){var r=t-1;return e+r&~r}function o8t(e,t){for(var r=new Array(e),n=0;n<e;n++)r[n]=t();return r}function s8t(e,t){t===void 0&&(t=1);var r=e.split(`
`);return r.map(function(n,i){return"".concat(l8t(""+(t+i),4," "),"  ").concat(n)}).join(`
`)}function l8t(e,t,r){for(r===void 0&&(r="0");e.length<t;)e="".concat(r).concat(e);return e}function X$(e,t){e.blendDstFactor=t.blendDstFactor,e.blendSrcFactor=t.blendSrcFactor,e.blendMode=t.blendMode}function kM(e,t){return e===void 0&&(e={}),e.compare=t.compare,e.depthFailOp=t.depthFailOp,e.passOp=t.passOp,e.failOp=t.failOp,e.mask=t.mask,e}function JJ(e,t){return e===void 0&&(e={rgbBlendState:{},alphaBlendState:{},channelWriteMask:0}),X$(e.rgbBlendState,t.rgbBlendState),X$(e.alphaBlendState,t.alphaBlendState),e.channelWriteMask=t.channelWriteMask,e}function ttt(e,t){e.length!==t.length&&(e.length=t.length);for(var r=0;r<t.length;r++)e[r]=JJ(e[r],t[r])}function u8t(e,t){t.attachmentsState!==void 0&&ttt(e.attachmentsState,t.attachmentsState),e.blendConstant&&t.blendConstant&&KJ(e.blendConstant,t.blendConstant),e.depthCompare=im(t.depthCompare,e.depthCompare),e.depthWrite=im(t.depthWrite,e.depthWrite),e.stencilWrite=im(t.stencilWrite,e.stencilWrite),e.stencilFront&&t.stencilFront&&kM(e.stencilFront,t.stencilFront),e.stencilBack&&t.stencilBack&&kM(e.stencilBack,t.stencilBack),e.cullMode=im(t.cullMode,e.cullMode),e.frontFace=im(t.frontFace,e.frontFace),e.polygonOffset=im(t.polygonOffset,e.polygonOffset),e.polygonOffsetFactor=im(t.polygonOffsetFactor,e.polygonOffsetFactor),e.polygonOffsetUnits=im(t.polygonOffsetUnits,e.polygonOffsetUnits)}function $x(e){var t=Object.assign({},e);return t.attachmentsState=[],ttt(t.attachmentsState,e.attachmentsState),t.blendConstant=t.blendConstant&&QJ(t.blendConstant),t.stencilFront=kM(void 0,e.stencilFront),t.stencilBack=kM(void 0,e.stencilBack),t}var j$={blendMode:ml.ADD,blendSrcFactor:Li.ONE,blendDstFactor:Li.ZERO},Hx={attachmentsState:[{channelWriteMask:dl.ALL,rgbBlendState:j$,alphaBlendState:j$}],blendConstant:QJ(_I),depthWrite:!0,depthCompare:pa.LEQUAL,stencilWrite:!1,stencilFront:{compare:pa.ALWAYS,passOp:$o.KEEP,depthFailOp:$o.KEEP,failOp:$o.KEEP},stencilBack:{compare:pa.ALWAYS,passOp:$o.KEEP,depthFailOp:$o.KEEP,failOp:$o.KEEP},cullMode:Vc.NONE,frontFace:_C.CCW,polygonOffset:!1,polygonOffsetFactor:0,polygonOffsetUnits:0};function c8t(e,t){e===void 0&&(e=null),t===void 0&&(t=Hx);var r=$x(t);return e!==null&&u8t(r,e),r}c8t({depthCompare:pa.ALWAYS,depthWrite:!1},Hx);var ett={texture:null,sampler:null,formatKind:Uo.Float,dimension:Oi.TEXTURE_2D};function Am(e,t,r){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!r(e[n],t[n]))return!1;return!0}function Z1(e,t){for(var r=Array(e.length),n=0;n<e.length;n++)r[n]=t(e[n]);return r}function h8t(e,t){return e.texture===t.texture&&e.binding===t.binding}function Y$(e,t){return e.buffer===t.buffer&&e.size===t.size&&e.binding===t.binding&&e.offset===t.offset}function f8t(e,t){return e===null?t===null:t===null?!1:e.sampler===t.sampler&&e.texture===t.texture&&e.dimension===t.dimension&&e.formatKind===t.formatKind&&e.comparison===t.comparison}function d8t(e,t){return e.samplerBindings=e.samplerBindings||[],e.uniformBufferBindings=e.uniformBufferBindings||[],e.storageBufferBindings=e.storageBufferBindings||[],e.storageTextureBindings=e.storageTextureBindings||[],t.samplerBindings=t.samplerBindings||[],t.uniformBufferBindings=t.uniformBufferBindings||[],t.storageBufferBindings=t.storageBufferBindings||[],t.storageTextureBindings=t.storageTextureBindings||[],!(e.samplerBindings.length!==t.samplerBindings.length||!Am(e.samplerBindings,t.samplerBindings,f8t)||!Am(e.uniformBufferBindings,t.uniformBufferBindings,Y$)||!Am(e.storageBufferBindings,t.storageBufferBindings,Y$)||!Am(e.storageTextureBindings,t.storageTextureBindings,h8t))}function Z$(e,t){return e.blendMode==t.blendMode&&e.blendSrcFactor===t.blendSrcFactor&&e.blendDstFactor===t.blendDstFactor}function p8t(e,t){return!(!Z$(e.rgbBlendState,t.rgbBlendState)||!Z$(e.alphaBlendState,t.alphaBlendState)||e.channelWriteMask!==t.channelWriteMask)}function zM(e,t){return e.compare==t.compare&&e.depthFailOp===t.depthFailOp&&e.failOp===t.failOp&&e.passOp===t.passOp&&e.mask===t.mask}function v8t(e,t){return!Am(e.attachmentsState,t.attachmentsState,p8t)||e.blendConstant&&t.blendConstant&&!qJ(e.blendConstant,t.blendConstant)||e.stencilFront&&t.stencilFront&&!zM(e.stencilFront,t.stencilFront)||e.stencilBack&&t.stencilBack&&!zM(e.stencilBack,t.stencilBack)?!1:e.depthCompare===t.depthCompare&&e.depthWrite===t.depthWrite&&e.stencilWrite===t.stencilWrite&&e.cullMode===t.cullMode&&e.frontFace===t.frontFace&&e.polygonOffset===t.polygonOffset&&e.polygonOffsetFactor===t.polygonOffsetFactor&&e.polygonOffsetUnits===t.polygonOffsetUnits}function rtt(e,t){return e.id===t.id}function g8t(e,t){return e===t}function m8t(e,t){return!(e.topology!==t.topology||e.inputLayout!==t.inputLayout||e.sampleCount!==t.sampleCount||e.megaStateDescriptor&&t.megaStateDescriptor&&!v8t(e.megaStateDescriptor,t.megaStateDescriptor)||!rtt(e.program,t.program)||!Am(e.colorAttachmentFormats,t.colorAttachmentFormats,g8t)||e.depthStencilAttachmentFormat!==t.depthStencilAttachmentFormat)}function y8t(e,t){return e.offset===t.offset&&e.shaderLocation===t.shaderLocation&&e.format===t.format&&e.divisor===t.divisor}function _8t(e,t){return kf(e)?kf(t):kf(t)?!1:e.arrayStride===t.arrayStride&&e.stepMode===t.stepMode&&Am(e.attributes,t.attributes,y8t)}function x8t(e,t){return!(e.indexBufferFormat!==t.indexBufferFormat||!Am(e.vertexBufferDescriptors,t.vertexBufferDescriptors,_8t)||!rtt(e.program,t.program))}function b8t(e){var t=e.sampler,r=e.texture,n=e.dimension,i=e.formatKind,a=e.comparison;return{sampler:t,texture:r,dimension:n,formatKind:i,comparison:a}}function q$(e){var t=e.buffer,r=e.size,n=e.binding,i=e.offset;return{binding:n,buffer:t,offset:i,size:r}}function E8t(e){var t=e.binding,r=e.texture;return{binding:t,texture:r}}function w8t(e){var t=e.samplerBindings&&Z1(e.samplerBindings,b8t),r=e.uniformBufferBindings&&Z1(e.uniformBufferBindings,q$),n=e.storageBufferBindings&&Z1(e.storageBufferBindings,q$),i=e.storageTextureBindings&&Z1(e.storageTextureBindings,E8t);return{samplerBindings:t,uniformBufferBindings:r,storageBufferBindings:n,storageTextureBindings:i,pipeline:e.pipeline}}function C8t(e){var t=e.inputLayout,r=e.program,n=e.topology,i=e.megaStateDescriptor&&$x(e.megaStateDescriptor),a=e.colorAttachmentFormats.slice(),o=e.depthStencilAttachmentFormat,s=e.sampleCount;return{inputLayout:t,megaStateDescriptor:i,program:r,topology:n,colorAttachmentFormats:a,depthStencilAttachmentFormat:o,sampleCount:s}}function S8t(e){var t=e.shaderLocation,r=e.format,n=e.offset,i=e.divisor;return{shaderLocation:t,format:r,offset:n,divisor:i}}function T8t(e){if(kf(e))return e;var t=e.arrayStride,r=e.stepMode,n=Z1(e.attributes,S8t);return{arrayStride:t,stepMode:r,attributes:n}}function A8t(e){var t=Z1(e.vertexBufferDescriptors,T8t),r=e.indexBufferFormat,n=e.program;return{vertexBufferDescriptors:t,indexBufferFormat:r,program:n}}var Ni,M8t=/([^[]*)(\[[0-9]+\])?/;function R8t(e){if(e[e.length-1]!=="]")return{name:e,length:1,isArray:!1};var t=e.match(M8t);if(!t||t.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(e));return{name:t[1],length:Number(t[2])||1,isArray:!!t[2]}}function Qu(){var e=null;return function(t,r,n){var i=e!==n;return i&&(t.uniform1i(r,n),e=n),i}}function Bo(e,t,r,n){var i=null,a=null;return function(o,s,l){var u=t(l,r),c=u.length,f=!1;if(i===null)i=new Float32Array(c),a=c,f=!0;else{ri(a===c,"Uniform length cannot change.");for(var d=0;d<c;++d)if(u[d]!==i[d]){f=!0;break}}return f&&(n(o,e,s,u),i.set(u)),f}}function Iu(e,t,r,n){e[t](r,n)}function zv(e,t,r,n){e[t](r,!1,n)}var I8t={},L8t={},O8t={},K$=[0];function L4(e,t,r,n){t===1&&typeof e=="boolean"&&(e=e?1:0),Number.isFinite(e)&&(K$[0]=e,e=K$);var i=e.length;if(e instanceof r)return e;var a=n[i];a||(a=new r(i),n[i]=a);for(var o=0;o<i;o++)a[o]=e[o];return a}function Sh(e,t){return L4(e,t,Float32Array,I8t)}function am(e,t){return L4(e,t,Int32Array,L8t)}function dT(e,t){return L4(e,t,Uint32Array,O8t)}var P8t=(Ni={},Ni[Dt.FLOAT]=Bo.bind(null,"uniform1fv",Sh,1,Iu),Ni[Dt.FLOAT_VEC2]=Bo.bind(null,"uniform2fv",Sh,2,Iu),Ni[Dt.FLOAT_VEC3]=Bo.bind(null,"uniform3fv",Sh,3,Iu),Ni[Dt.FLOAT_VEC4]=Bo.bind(null,"uniform4fv",Sh,4,Iu),Ni[Dt.INT]=Bo.bind(null,"uniform1iv",am,1,Iu),Ni[Dt.INT_VEC2]=Bo.bind(null,"uniform2iv",am,2,Iu),Ni[Dt.INT_VEC3]=Bo.bind(null,"uniform3iv",am,3,Iu),Ni[Dt.INT_VEC4]=Bo.bind(null,"uniform4iv",am,4,Iu),Ni[Dt.BOOL]=Bo.bind(null,"uniform1iv",am,1,Iu),Ni[Dt.BOOL_VEC2]=Bo.bind(null,"uniform2iv",am,2,Iu),Ni[Dt.BOOL_VEC3]=Bo.bind(null,"uniform3iv",am,3,Iu),Ni[Dt.BOOL_VEC4]=Bo.bind(null,"uniform4iv",am,4,Iu),Ni[Dt.FLOAT_MAT2]=Bo.bind(null,"uniformMatrix2fv",Sh,4,zv),Ni[Dt.FLOAT_MAT3]=Bo.bind(null,"uniformMatrix3fv",Sh,9,zv),Ni[Dt.FLOAT_MAT4]=Bo.bind(null,"uniformMatrix4fv",Sh,16,zv),Ni[Dt.UNSIGNED_INT]=Bo.bind(null,"uniform1uiv",dT,1,Iu),Ni[Dt.UNSIGNED_INT_VEC2]=Bo.bind(null,"uniform2uiv",dT,2,Iu),Ni[Dt.UNSIGNED_INT_VEC3]=Bo.bind(null,"uniform3uiv",dT,3,Iu),Ni[Dt.UNSIGNED_INT_VEC4]=Bo.bind(null,"uniform4uiv",dT,4,Iu),Ni[Dt.FLOAT_MAT2x3]=Bo.bind(null,"uniformMatrix2x3fv",Sh,6,zv),Ni[Dt.FLOAT_MAT2x4]=Bo.bind(null,"uniformMatrix2x4fv",Sh,8,zv),Ni[Dt.FLOAT_MAT3x2]=Bo.bind(null,"uniformMatrix3x2fv",Sh,6,zv),Ni[Dt.FLOAT_MAT3x4]=Bo.bind(null,"uniformMatrix3x4fv",Sh,12,zv),Ni[Dt.FLOAT_MAT4x2]=Bo.bind(null,"uniformMatrix4x2fv",Sh,8,zv),Ni[Dt.FLOAT_MAT4x3]=Bo.bind(null,"uniformMatrix4x3fv",Sh,12,zv),Ni[Dt.SAMPLER_2D]=Qu,Ni[Dt.SAMPLER_CUBE]=Qu,Ni[Dt.SAMPLER_3D]=Qu,Ni[Dt.SAMPLER_2D_SHADOW]=Qu,Ni[Dt.SAMPLER_2D_ARRAY]=Qu,Ni[Dt.SAMPLER_2D_ARRAY_SHADOW]=Qu,Ni[Dt.SAMPLER_CUBE_SHADOW]=Qu,Ni[Dt.INT_SAMPLER_2D]=Qu,Ni[Dt.INT_SAMPLER_3D]=Qu,Ni[Dt.INT_SAMPLER_CUBE]=Qu,Ni[Dt.INT_SAMPLER_2D_ARRAY]=Qu,Ni[Dt.UNSIGNED_INT_SAMPLER_2D]=Qu,Ni[Dt.UNSIGNED_INT_SAMPLER_3D]=Qu,Ni[Dt.UNSIGNED_INT_SAMPLER_CUBE]=Qu,Ni[Dt.UNSIGNED_INT_SAMPLER_2D_ARRAY]=Qu,Ni);function Q$(e,t,r){var n=P8t[r.type];if(!n)throw new Error("Unknown GLSL uniform type ".concat(r.type));return n().bind(null,e,t)}var D8t={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121};function F8t(e){return Object.prototype.toString.call(e)in D8t}function UE(e,t){return"#define ".concat(e," ").concat(t)}function B8t(e){var t={};return e.replace(/^\s*#define\s*(\S*)\s*(\S*)\s*$/gm,function(r,n,i){var a=Number(i);return t[n]=isNaN(a)?i:a,""}),t}function N8t(e,t){var r=[];return e.replace(/^\s*layout\(location\s*=\s*(\S*)\)\s*in\s+\S+\s*(.*);$/gm,function(n,i,a){var o=Number(i);return r.push({location:isNaN(o)?t[i]:o,name:a}),""}),r}function J$(e){if(e===void 0)return null;var t=/binding\s*=\s*(\d+)/.exec(e);if(t!==null){var r=parseInt(t[1],10);if(!Number.isNaN(r))return r}return null}function tH(e){var t="",r=e;return[r,t]}function Vx(e,t,r,n,i){var a;n===void 0&&(n=null),i===void 0&&(i=!0);var o=e.glslVersion==="#version 100",s=t==="frag"&&((a=r.match(/^\s*layout\(location\s*=\s*\d*\)\s*out\s+vec4\s*(.*);$/gm))===null||a===void 0?void 0:a.length)>1,l=r.replace(`\r
`,`
`).split(`
`).map(function(N){return N.replace(/[/][/].*$/,"")}).filter(function(N){var k=!N||/^\s+$/.test(N);return!k}),u="";n!==null&&(u=Object.keys(n).map(function(N){return UE(N,n[N])}).join(`
`));var c=l.find(function(N){return N.startsWith("precision")})||"precision mediump float;",f=i?l.filter(function(N){return!N.startsWith("precision")}).join(`
`):l.join(`
`),d="";if(e.viewportOrigin===Od.UPPER_LEFT&&(d+="".concat(UE("VIEWPORT_ORIGIN_TL","1"),`
`)),e.clipSpaceNearZ===zx.ZERO&&(d+="".concat(UE("CLIPSPACE_NEAR_ZERO","1"),`
`)),e.explicitBindingLocations){var v=0,g=0,x=0;f=f.replace(/^\s*(layout\((.*)\))?\s*uniform(.+{)$/gm,function(N,k,V,Q){var Y=V?"".concat(V,", "):"";return"layout(".concat(Y,"set = ").concat(v,", binding = ").concat(g++,") uniform ").concat(Q)}),v++,g=0,ri(e.separateSamplerTextures),f=f.replace(/^\s*(layout\((.*)\))?\s*uniform sampler(\w+) (.*);/gm,function(N,k,V,Q,Y){var X=J$(V);X===null&&(X=g++);var tt=Lr(tH(Q),2),it=tt[0],Et=tt[1];return t==="frag"?`
layout(set = `.concat(v,", binding = ").concat(X*2+0,") uniform texture").concat(it," T_").concat(Y,`;
layout(set = `).concat(v,", binding = ").concat(X*2+1,") uniform sampler").concat(Et," S_").concat(Y,";").trim():""}),f=f.replace(t==="frag"?/^\s*\b(varying|in)\b/gm:/^\s*\b(varying|out)\b/gm,function(N,k){return"layout(location = ".concat(x++,") ").concat(k)}),d+="".concat(UE("gl_VertexID","gl_VertexIndex"),`
`),d+="".concat(UE("gl_InstanceID","gl_InstanceIndex"),`
`),c=c.replace(/^precision (.*) sampler(.*);$/gm,"")}else{var w=0;f=f.replace(/^\s*(layout\((.*)\))?\s*uniform sampler(\w+) (.*);/gm,function(N,k,V,Q,Y){var X=J$(V);return X===null&&(X=w++),"uniform sampler".concat(Q," ").concat(Y,"; // BINDING=").concat(X)})}if(f=f.replace(/\bPU_SAMPLER_(\w+)\((.*?)\)/g,function(N,k,V){return"SAMPLER_".concat(k,"(P_").concat(V,")")}),f=f.replace(/\bPF_SAMPLER_(\w+)\((.*?)\)/g,function(N,k,V){return"PP_SAMPLER_".concat(k,"(P_").concat(V,")")}),f=f.replace(/\bPU_TEXTURE\((.*?)\)/g,function(N,k){return"TEXTURE(P_".concat(k,")")}),e.separateSamplerTextures)f=f.replace(/\bPD_SAMPLER_(\w+)\((.*?)\)/g,function(N,k,V){var Q=Lr(tH(k),2),Y=Q[0],X=Q[1];return"texture".concat(Y," T_P_").concat(V,", sampler").concat(X," S_P_").concat(V)}),f=f.replace(/\bPP_SAMPLER_(\w+)\((.*?)\)/g,function(N,k,V){return"T_".concat(V,", S_").concat(V)}),f=f.replace(/\bSAMPLER_(\w+)\((.*?)\)/g,function(N,k,V){return"sampler".concat(k,"(T_").concat(V,", S_").concat(V,")")}),f=f.replace(/\bTEXTURE\((.*?)\)/g,function(N,k){return"T_".concat(k)});else{var S=[];f=f.replace(/\bPD_SAMPLER_(\w+)\((.*?)\)/g,function(N,k,V){return"sampler".concat(k," P_").concat(V)}),f=f.replace(/\bPP_SAMPLER_(\w+)\((.*?)\)/g,function(N,k,V){return V}),f=f.replace(/\bSAMPLER_(\w+)\((.*?)\)/g,function(N,k,V){return S.push([V,k]),V}),o&&S.forEach(function(N){var k=Lr(N,2),V=k[0],Q=k[1];f=f.replace(new RegExp("texture\\(".concat(V),"g"),function(){return"texture".concat(Q,"(").concat(V)})}),f=f.replace(/\bTEXTURE\((.*?)\)/g,function(N,k){return k})}var A="".concat(o?"":e.glslVersion,`
`).concat(o&&s?`#extension GL_EXT_draw_buffers : require
`:"",`
`).concat(o&&t==="frag"?`#extension GL_OES_standard_derivatives : enable
`:"").concat(i?c:"",`
`).concat(d||"").concat(u?u+`
`:"",`
`).concat(f,`
`).trim();if(e.explicitBindingLocations&&t==="frag"&&(A=A.replace(/^\b(out)\b/g,function(N,k){return"layout(location = 0) ".concat(k)})),o){if(t==="frag"&&(A=A.replace(/^\s*in\s+(\S+)\s*(.*);$/gm,function(N,k,V){return"varying ".concat(k," ").concat(V,`;
`)})),t==="vert"&&(A=A.replace(/^\s*out\s+(\S+)\s*(.*);$/gm,function(N,k,V){return"varying ".concat(k," ").concat(V,`;
`)}),A=A.replace(/^\s*layout\(location\s*=\s*\S*\)\s*in\s+(\S+)\s*(.*);$/gm,function(N,k,V){return"attribute ".concat(k," ").concat(V,`;
`)})),A=A.replace(/\s*uniform\s*.*\s*{((?:\s*.*\s*)*?)};/g,function(N,k){return k.trim().replace(/^.*$/gm,function(V){var Q=V.trim();return Q.startsWith("#")?Q:V?"uniform ".concat(Q):""})}),t==="frag")if(s){var M=[];A=A.replace(/^\s*layout\(location\s*=\s*\d*\)\s*out\s+vec4\s*(.*);$/gm,function(N,k){return M.push(k),"vec4 ".concat(k,`;
`)});var R=A.lastIndexOf("}");A=A.substring(0,R)+`
    `.concat(M.map(function(N,k){return"gl_FragData[".concat(k,"] = ").concat(N,`;
    `)}).join(`
`))+A.substring(R)}else{var O;if(A=A.replace(/^\s*out\s+(\S+)\s*(.*);$/gm,function(N,k,V){return O=V,"".concat(k," ").concat(V,`;
`)}),O){var R=A.lastIndexOf("}");A=A.substring(0,R)+`
  gl_FragColor = vec4(`.concat(O,`);
`)+A.substring(R)}}A=A.replace(/^\s*layout\((.*)\)/gm,"")}return A}var Qf=function(e){Ut(t,e);function t(r){var n=r.id,i=r.device,a=e.call(this)||this;return a.id=n,a.device=i,a.device.resourceCreationTracker!==null&&a.device.resourceCreationTracker.trackResourceCreated(a),a}return t.prototype.destroy=function(){this.device.resourceCreationTracker!==null&&this.device.resourceCreationTracker.trackResourceDestroyed(this)},t}(XJ),k8t=function(e){Ut(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,o=e.call(this,{id:n,device:i})||this;o.type=Qi.Bindings;var s=a.uniformBufferBindings,l=a.samplerBindings;return o.uniformBufferBindings=s||[],o.samplerBindings=l||[],o.bindingLayouts=o.createBindingLayouts(),o}return t.prototype.createBindingLayouts=function(){var r=0,n=0,i=[],a=this.uniformBufferBindings.length,o=this.samplerBindings.length;return i.push({firstUniformBuffer:r,numUniformBuffers:a,firstSampler:n,numSamplers:o}),r+=a,n+=o,{numUniformBuffers:r,numSamplers:n,bindingLayoutTables:i}},t}(Qf),$E;function un(e){return $E!==void 0?$E:typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext?($E=!0,!0):($E=!!(e&&e._version===2),$E)}function ntt(e){var t=Qp(e);switch(t){case Ge.BC1:case Ge.BC2:case Ge.BC3:case Ge.BC4_UNORM:case Ge.BC4_SNORM:case Ge.BC5_UNORM:case Ge.BC5_SNORM:return!0;default:return!1}}function itt(e){var t=Ux(e);if(t&Fr.Normalized)return!1;var r=Qp(e);return r===Ge.S8||r===Ge.S16||r===Ge.S32||r===Ge.U8||r===Ge.U16||r===Ge.U32}function z8t(e){switch(e){case Fd.STATIC:return Dt.STATIC_DRAW;case Fd.DYNAMIC:return Dt.DYNAMIC_DRAW}}function eH(e){if(e&Na.INDEX)return Dt.ELEMENT_ARRAY_BUFFER;if(e&Na.VERTEX)return Dt.ARRAY_BUFFER;if(e&Na.UNIFORM)return Dt.UNIFORM_BUFFER}function U8t(e){switch(e){case Rs.TRIANGLES:return Dt.TRIANGLES;case Rs.POINTS:return Dt.POINTS;case Rs.TRIANGLE_STRIP:return Dt.TRIANGLE_STRIP;case Rs.LINES:return Dt.LINES;case Rs.LINE_STRIP:return Dt.LINE_STRIP;default:throw new Error("Unknown primitive topology mode")}}function $8t(e){switch(e){case Ge.U8:return Dt.UNSIGNED_BYTE;case Ge.U16:return Dt.UNSIGNED_SHORT;case Ge.U32:return Dt.UNSIGNED_INT;case Ge.S8:return Dt.BYTE;case Ge.S16:return Dt.SHORT;case Ge.S32:return Dt.INT;case Ge.F16:return Dt.HALF_FLOAT;case Ge.F32:return Dt.FLOAT;default:throw new Error("whoops")}}function H8t(e){switch(e){case Jr.R:return 1;case Jr.RG:return 2;case Jr.RGB:return 3;case Jr.RGBA:return 4;default:return 1}}function V8t(e){var t=Qp(e),r=I4(e),n=Ux(e),i=$8t(t),a=H8t(r),o=!!(n&Fr.Normalized);return{size:a,type:i,normalized:o}}function G8t(e){switch(e){case te.U8_R:return Dt.UNSIGNED_BYTE;case te.U16_R:return Dt.UNSIGNED_SHORT;case te.U32_R:return Dt.UNSIGNED_INT;default:throw new Error("whoops")}}function HE(e){switch(e){case ac.CLAMP_TO_EDGE:return Dt.CLAMP_TO_EDGE;case ac.REPEAT:return Dt.REPEAT;case ac.MIRRORED_REPEAT:return Dt.MIRRORED_REPEAT;default:throw new Error("whoops")}}function pT(e,t){if(t===el.LINEAR&&e===ts.BILINEAR)return Dt.LINEAR_MIPMAP_LINEAR;if(t===el.LINEAR&&e===ts.POINT)return Dt.NEAREST_MIPMAP_LINEAR;if(t===el.NEAREST&&e===ts.BILINEAR)return Dt.LINEAR_MIPMAP_NEAREST;if(t===el.NEAREST&&e===ts.POINT)return Dt.NEAREST_MIPMAP_NEAREST;if(t===el.NO_MIP&&e===ts.BILINEAR)return Dt.LINEAR;if(t===el.NO_MIP&&e===ts.POINT)return Dt.NEAREST;throw new Error("Unknown texture filter mode")}function fx(e,t){t===void 0&&(t=0);var r=e;return r.gl_buffer_pages[t/r.pageByteSize|0]}function z1(e){var t=e;return t.gl_texture}function ZD(e){var t=e;return t.gl_sampler}function VE(e,t){e.name=t,e.__SPECTOR_Metadata={name:t}}function rH(e,t){for(var r=[];;){var n=t.exec(e);if(!n)break;r.push(n)}return r}function om(e){return e.blendMode==ml.ADD&&e.blendSrcFactor==Li.ONE&&e.blendDstFactor===Li.ZERO}function W8t(e){switch(e){case FM.OcclusionConservative:return Dt.ANY_SAMPLES_PASSED_CONSERVATIVE;default:throw new Error("whoops")}}function X8t(e){if(e===Oi.TEXTURE_2D)return Dt.TEXTURE_2D;if(e===Oi.TEXTURE_2D_ARRAY)return Dt.TEXTURE_2D_ARRAY;if(e===Oi.TEXTURE_CUBE_MAP)return Dt.TEXTURE_CUBE_MAP;if(e===Oi.TEXTURE_3D)return Dt.TEXTURE_3D;throw new Error("whoops")}function AO(e,t,r,n){return!(e%r!==0||t%n!==0)}var j8t=function(e){Ut(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,o=e.call(this,{id:n,device:i})||this;o.type=Qi.Buffer;var s=a.viewOrSize,l=a.usage,u=a.hint,c=u===void 0?Fd.STATIC:u,f=i.uniformBufferMaxPageByteSize,d=i.gl,v=l&Na.UNIFORM;v||(un(d)?d.bindVertexArray(null):i.OES_vertex_array_object.bindVertexArrayOES(null));var g=Y1(s)?NM(s,4):NM(s.byteLength,4);o.gl_buffer_pages=[];var x;if(v){for(var w=g;w>0;)o.gl_buffer_pages.push(o.createBufferPage(Math.min(w,f),l,c)),w-=f;x=f}else o.gl_buffer_pages.push(o.createBufferPage(g,l,c)),x=g;return o.pageByteSize=x,o.byteSize=g,o.usage=l,o.gl_target=eH(l),Y1(s)||o.setSubData(0,new Uint8Array(s.buffer)),v||(un(d)?d.bindVertexArray(o.device.currentBoundVAO):i.OES_vertex_array_object.bindVertexArrayOES(o.device.currentBoundVAO)),o}return t.prototype.setSubData=function(r,n,i,a){i===void 0&&(i=0),a===void 0&&(a=n.byteLength-i);for(var o=this.device.gl,s=this.pageByteSize,l=r+a,u=r,c=r%s;u<l;){var f=un(o)?o.COPY_WRITE_BUFFER:this.gl_target,d=fx(this,u);if(d.ubo)return;o.bindBuffer(f,d),un(o)?o.bufferSubData(f,c,n,i,Math.min(l-u,s)):o.bufferSubData(f,c,n),u+=s,c=0,i+=s,this.device.debugGroupStatisticsBufferUpload()}},t.prototype.destroy=function(){e.prototype.destroy.call(this);for(var r=0;r<this.gl_buffer_pages.length;r++)this.gl_buffer_pages[r].ubo||this.device.gl.deleteBuffer(this.gl_buffer_pages[r]);this.gl_buffer_pages=[]},t.prototype.createBufferPage=function(r,n,i){var a=this.device.gl,o=n&Na.UNIFORM;if(!un(a)&&o)return{ubo:!0};var s=this.device.ensureResourceExists(a.createBuffer()),l=eH(n),u=z8t(i);return a.bindBuffer(l,s),a.bufferData(l,r,u),s},t}(Qf),Y8t=function(e){Ut(t,e);function t(r){var n,i,a,o,s=r.id,l=r.device,u=r.descriptor,c,f=e.call(this,{id:s,device:l})||this;f.type=Qi.InputLayout;var d=u.vertexBufferDescriptors,v=u.indexBufferFormat,g=u.program;ri(v===te.U16_R||v===te.U32_R||v===null);var x=v!==null?G8t(v):null,w=v!==null?YJ(v):null,S=f.device.gl,A=f.device.ensureResourceExists(un(S)?S.createVertexArray():l.OES_vertex_array_object.createVertexArrayOES());un(S)?S.bindVertexArray(A):l.OES_vertex_array_object.bindVertexArrayOES(A),S.bindBuffer(S.ARRAY_BUFFER,fx(f.device.fallbackVertexBuffer));try{for(var M=mi(u.vertexBufferDescriptors),R=M.next();!R.done;R=M.next()){var O=R.value,N=O.stepMode,k=O.attributes;try{for(var V=(a=void 0,mi(k)),Q=V.next();!Q.done;Q=V.next()){var Y=Q.value,X=Y.shaderLocation,tt=Y.format,it=Y.divisor,Et=it===void 0?1:it,Tt=un(S)?X:(c=g.attributes[X])===null||c===void 0?void 0:c.location,pt=V8t(tt);if(Y.vertexFormat=pt,!kf(Tt)){itt(tt);var kt=pt.size,ae=pt.type,Kt=pt.normalized;S.vertexAttribPointer(Tt,kt,ae,Kt,0,0),N===Qy.INSTANCE&&(un(S)?S.vertexAttribDivisor(Tt,Et):l.ANGLE_instanced_arrays.vertexAttribDivisorANGLE(Tt,Et)),S.enableVertexAttribArray(Tt)}}}catch(re){a={error:re}}finally{try{Q&&!Q.done&&(o=V.return)&&o.call(V)}finally{if(a)throw a.error}}}}catch(re){n={error:re}}finally{try{R&&!R.done&&(i=M.return)&&i.call(M)}finally{if(n)throw n.error}}return un(S)?S.bindVertexArray(null):l.OES_vertex_array_object.bindVertexArrayOES(null),f.vertexBufferDescriptors=d,f.vao=A,f.indexBufferFormat=v,f.indexBufferType=x,f.indexBufferCompByteSize=w,f.program=g,f}return t.prototype.destroy=function(){e.prototype.destroy.call(this),this.device.currentBoundVAO===this.vao&&(un(this.device.gl)?(this.device.gl.bindVertexArray(null),this.device.gl.deleteVertexArray(this.vao)):(this.device.OES_vertex_array_object.bindVertexArrayOES(null),this.device.OES_vertex_array_object.deleteVertexArrayOES(this.vao)),this.device.currentBoundVAO=null)},t}(Qf),qD=function(e){Ut(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,o=r.fake,s=e.call(this,{id:n,device:i})||this;s.type=Qi.Texture,a=U({dimension:Oi.TEXTURE_2D,depthOrArrayLayers:1,mipLevelCount:1},a);var l=s.device.gl,u,c,f=s.clampmipLevelCount(a);if(s.immutable=a.usage===Du.RENDER_TARGET,s.pixelStore=a.pixelStore,s.format=a.format,s.dimension=a.dimension,s.formatKind=ZJ(a.format),s.width=a.width,s.height=a.height,s.depthOrArrayLayers=a.depthOrArrayLayers,s.mipmaps=f>=1,!o){c=s.device.ensureResourceExists(l.createTexture());var d=s.device.translateTextureType(a.format),v=s.device.translateTextureInternalFormat(a.format);if(s.device.setActiveTexture(l.TEXTURE0),s.device.currentTextures[0]=null,s.preprocessImage(),a.dimension===Oi.TEXTURE_2D){if(u=Dt.TEXTURE_2D,l.bindTexture(u,c),s.immutable)if(un(l))l.texStorage2D(u,f,v,a.width,a.height);else{var g=(v===Dt.DEPTH_COMPONENT||s.isNPOT(),0);(s.format===te.D32F||s.format===te.D24_S8)&&!un(l)&&!i.WEBGL_depth_texture||(l.texImage2D(u,g,v,a.width,a.height,0,v,d,null),s.mipmaps&&(s.mipmaps=!1,l.texParameteri(Dt.TEXTURE_2D,Dt.TEXTURE_MIN_FILTER,Dt.LINEAR),l.texParameteri(Dt.TEXTURE_2D,Dt.TEXTURE_WRAP_S,Dt.CLAMP_TO_EDGE),l.texParameteri(Dt.TEXTURE_2D,Dt.TEXTURE_WRAP_T,Dt.CLAMP_TO_EDGE)))}ri(a.depthOrArrayLayers===1)}else if(a.dimension===Oi.TEXTURE_2D_ARRAY)u=Dt.TEXTURE_2D_ARRAY,l.bindTexture(u,c),s.immutable&&un(l)&&l.texStorage3D(u,f,v,a.width,a.height,a.depthOrArrayLayers);else if(a.dimension===Oi.TEXTURE_3D)u=Dt.TEXTURE_3D,l.bindTexture(u,c),s.immutable&&un(l)&&l.texStorage3D(u,f,v,a.width,a.height,a.depthOrArrayLayers);else if(a.dimension===Oi.TEXTURE_CUBE_MAP)u=Dt.TEXTURE_CUBE_MAP,l.bindTexture(u,c),s.immutable&&un(l)&&l.texStorage2D(u,f,v,a.width,a.height),ri(a.depthOrArrayLayers===6);else throw new Error("whoops")}return s.gl_texture=c,s.gl_target=u,s.mipLevelCount=f,s}return t.prototype.setImageData=function(r,n){n===void 0&&(n=0);var i=this.device.gl;ntt(this.format);var a=this.gl_target===Dt.TEXTURE_3D||this.gl_target===Dt.TEXTURE_2D_ARRAY,o=this.gl_target===Dt.TEXTURE_CUBE_MAP,s=F8t(r[0]);this.device.setActiveTexture(i.TEXTURE0),this.device.currentTextures[0]=null;var l=r[0],u,c;s?(u=this.width,c=this.height):(u=l.width,c=l.height,this.width=u,this.height=c),i.bindTexture(this.gl_target,this.gl_texture);var f=this.device.translateTextureFormat(this.format),d=un(i)?this.device.translateInternalTextureFormat(this.format):f,v=this.device.translateTextureType(this.format);this.preprocessImage();for(var g=0;g<this.depthOrArrayLayers;g++){var x=r[g],w=this.gl_target;o&&(w=Dt.TEXTURE_CUBE_MAP_POSITIVE_X+g%6),this.immutable?i.texSubImage2D(w,n,0,0,u,c,f,v,x):un(i)?a?i.texImage3D(w,n,d,u,c,this.depthOrArrayLayers,0,f,v,x):i.texImage2D(w,n,d,u,c,0,f,v,x):s?i.texImage2D(w,n,f,u,c,0,f,v,x):i.texImage2D(w,n,f,f,v,x)}this.mipmaps&&this.generateMipmap(a)},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.device.gl.deleteTexture(z1(this))},t.prototype.clampmipLevelCount=function(r){if(r.dimension===Oi.TEXTURE_2D_ARRAY&&r.depthOrArrayLayers>1){var n=Qp(r.format);if(n===Ge.BC1)for(var i=r.width,a=r.height,o=0;o<r.mipLevelCount;o++){if(i<=2||a<=2)return o-1;i=Math.max(i/2|0,1),a=Math.max(a/2|0,1)}}return r.mipLevelCount},t.prototype.preprocessImage=function(){var r=this.device.gl;this.pixelStore&&(this.pixelStore.unpackFlipY&&r.pixelStorei(Dt.UNPACK_FLIP_Y_WEBGL,!0),this.pixelStore.packAlignment&&r.pixelStorei(Dt.PACK_ALIGNMENT,this.pixelStore.packAlignment),this.pixelStore.unpackAlignment&&r.pixelStorei(Dt.UNPACK_ALIGNMENT,this.pixelStore.unpackAlignment))},t.prototype.generateMipmap=function(r){r===void 0&&(r=!1);var n=this.device.gl;return!un(n)&&this.isNPOT()?this:(this.gl_texture&&this.gl_target&&(n.bindTexture(this.gl_target,this.gl_texture),r?(n.texParameteri(this.gl_target,Dt.TEXTURE_BASE_LEVEL,0),n.texParameteri(this.gl_target,Dt.TEXTURE_MAX_LEVEL,Math.log2(this.width)),n.texParameteri(this.gl_target,Dt.TEXTURE_MIN_FILTER,Dt.LINEAR_MIPMAP_LINEAR),n.texParameteri(this.gl_target,Dt.TEXTURE_MAG_FILTER,Dt.LINEAR)):n.texParameteri(Dt.TEXTURE_2D,Dt.TEXTURE_MIN_FILTER,Dt.NEAREST_MIPMAP_LINEAR),n.generateMipmap(this.gl_target),n.bindTexture(this.gl_target,null)),this)},t.prototype.isNPOT=function(){var r=this.device.gl;return un(r)?!1:!BM(this.width)||!BM(this.height)},t}(Qf),Z8t=function(e){Ut(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,o=e.call(this,{id:n,device:i})||this;o.type=Qi.RenderTarget,o.gl_renderbuffer=null,o.texture=null;var s=o.device.gl,l=a.format,u=a.width,c=a.height,f=a.sampleCount,d=f===void 0?1:f,v=a.texture,g=!1;if((l===te.D32F||l===te.D24_S8)&&v&&!un(s)&&!i.WEBGL_depth_texture&&(v.destroy(),o.texture=null,g=!0),!g&&v)o.texture=v;else{o.gl_renderbuffer=o.device.ensureResourceExists(s.createRenderbuffer()),s.bindRenderbuffer(s.RENDERBUFFER,o.gl_renderbuffer);var x=o.device.translateTextureInternalFormat(l,!0);un(s)&&d>1?s.renderbufferStorageMultisample(Dt.RENDERBUFFER,d,x,u,c):s.renderbufferStorage(Dt.RENDERBUFFER,x,u,c)}return o.format=l,o.width=u,o.height=c,o.sampleCount=d,o}return t.prototype.destroy=function(){e.prototype.destroy.call(this),this.gl_renderbuffer!==null&&this.device.gl.deleteRenderbuffer(this.gl_renderbuffer),this.texture&&this.texture.destroy()},t}(Qf),Nc;(function(e){e[e.NeedsCompile=0]="NeedsCompile",e[e.Compiling=1]="Compiling",e[e.NeedsBind=2]="NeedsBind",e[e.ReadyToUse=3]="ReadyToUse"})(Nc||(Nc={}));var q8t=function(e){Ut(t,e);function t(r,n){var i=r.id,a=r.device,o=r.descriptor,s=e.call(this,{id:i,device:a})||this;s.rawVertexGLSL=n,s.type=Qi.Program,s.uniformSetters={},s.attributes=[];var l=s.device.gl;return s.descriptor=o,s.gl_program=s.device.ensureResourceExists(l.createProgram()),s.gl_shader_vert=null,s.gl_shader_frag=null,s.compileState=Nc.NeedsCompile,s.tryCompileProgram(),s}return t.prototype.destroy=function(){e.prototype.destroy.call(this),this.device.gl.deleteProgram(this.gl_program),this.device.gl.deleteShader(this.gl_shader_vert),this.device.gl.deleteShader(this.gl_shader_frag)},t.prototype.tryCompileProgram=function(){ri(this.compileState===Nc.NeedsCompile);var r=this.descriptor,n=r.vertex,i=r.fragment,a=this.device.gl;n!=null&&n.glsl&&(i!=null&&i.glsl)&&(this.gl_shader_vert=this.compileShader(n.postprocess?n.postprocess(n.glsl):n.glsl,a.VERTEX_SHADER),this.gl_shader_frag=this.compileShader(i.postprocess?i.postprocess(i.glsl):i.glsl,a.FRAGMENT_SHADER),a.attachShader(this.gl_program,this.gl_shader_vert),a.attachShader(this.gl_program,this.gl_shader_frag),a.linkProgram(this.gl_program),this.compileState=Nc.Compiling,un(a)||(this.readUniformLocationsFromLinkedProgram(),this.readAttributesFromLinkedProgram()))},t.prototype.readAttributesFromLinkedProgram=function(){for(var r,n=this.device.gl,i=n.getProgramParameter(this.gl_program,n.ACTIVE_ATTRIBUTES),a=B8t(this.descriptor.vertex.glsl),o=N8t(this.rawVertexGLSL,a),s=function(c){var f=n.getActiveAttrib(l.gl_program,c),d=f.name,v=f.type,g=f.size,x=n.getAttribLocation(l.gl_program,d),w=(r=o.find(function(S){return S.name===d}))===null||r===void 0?void 0:r.location;x>=0&&!kf(w)&&(l.attributes[w]={name:d,location:x,type:v,size:g})},l=this,u=0;u<i;u++)s(u)},t.prototype.readUniformLocationsFromLinkedProgram=function(){for(var r=this.device.gl,n=r.getProgramParameter(this.gl_program,r.ACTIVE_UNIFORMS),i=0;i<n;i++){var a=r.getActiveUniform(this.gl_program,i),o=R8t(a.name).name,s=r.getUniformLocation(this.gl_program,o);if(this.uniformSetters[o]=Q$(r,s,a),a&&a.size>1)for(var l=0;l<a.size;l++)s=r.getUniformLocation(this.gl_program,"".concat(o,"[").concat(l,"]")),this.uniformSetters["".concat(o,"[").concat(l,"]")]=Q$(r,s,a)}},t.prototype.compileShader=function(r,n){var i=this.device.gl,a=this.device.ensureResourceExists(i.createShader(n));return i.shaderSource(a,r),i.compileShader(a),a},t.prototype.setUniformsLegacy=function(r){r===void 0&&(r={});var n=this.device.gl;if(!un(n)){var i=!1;for(var a in r){i||(n.useProgram(this.gl_program),i=!0);var o=r[a],s=this.uniformSetters[a];if(s){var l=o;l instanceof qD&&(l=l.textureIndex),s(l)}}}return this},t}(Qf),K8t=function(e){Ut(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,o=e.call(this,{id:n,device:i})||this;o.type=Qi.QueryPool;var s=o.device.gl;if(un(s)){var l=a.elemCount,u=a.type;o.gl_query=o8t(l,function(){return o.device.ensureResourceExists(s.createQuery())}),o.gl_query_type=W8t(u)}return o}return t.prototype.queryResultOcclusion=function(r){var n=this.device.gl;if(un(n)){var i=this.gl_query[r];return n.getQueryParameter(i,n.QUERY_RESULT_AVAILABLE)?!!n.getQueryParameter(i,n.QUERY_RESULT):null}return null},t.prototype.destroy=function(){e.prototype.destroy.call(this);var r=this.device.gl;if(un(r))for(var n=0;n<this.gl_query.length;n++)r.deleteQuery(this.gl_query[n])},t}(Qf),Q8t=function(e){Ut(t,e);function t(r){var n=r.id,i=r.device,a=e.call(this,{id:n,device:i})||this;return a.type=Qi.Readback,a.gl_pbo=null,a.gl_sync=null,a}return t.prototype.clientWaitAsync=function(r,n,i){n===void 0&&(n=0),i===void 0&&(i=10);var a=this.device.gl;return new Promise(function(o,s){function l(){var u=a.clientWaitSync(r,n,0);if(u==a.WAIT_FAILED){s();return}if(u==a.TIMEOUT_EXPIRED){setTimeout(l,e8t(i,0,a.MAX_CLIENT_WAIT_TIMEOUT_WEBGL));return}o()}l()})},t.prototype.getBufferSubDataAsync=function(r,n,i,a,o,s){return au(this,void 0,void 0,function(){var l;return Lh(this,function(u){switch(u.label){case 0:return l=this.device.gl,un(l)?(this.gl_sync=l.fenceSync(l.SYNC_GPU_COMMANDS_COMPLETE,0),l.flush(),[4,this.clientWaitAsync(this.gl_sync,0,10)]):[3,2];case 1:return u.sent(),l.bindBuffer(r,n),l.getBufferSubData(r,i,a,o,s),l.bindBuffer(r,null),[2,a];case 2:return[2]}})})},t.prototype.readTexture=function(r,n,i,a,o,s,l,u){return l===void 0&&(l=0),u===void 0&&(u=s.byteLength||0),au(this,void 0,void 0,function(){var c,f,d,v,g;return Lh(this,function(x){return c=this.device.gl,f=r,d=this.device.translateTextureFormat(f.format),v=this.device.translateTextureType(f.format),g=n8t(f.format),un(c)?(this.gl_pbo=this.device.ensureResourceExists(c.createBuffer()),c.bindBuffer(c.PIXEL_PACK_BUFFER,this.gl_pbo),c.bufferData(c.PIXEL_PACK_BUFFER,u,c.STREAM_READ),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),c.bindFramebuffer(Dt.READ_FRAMEBUFFER,this.device.readbackFramebuffer),c.framebufferTexture2D(Dt.READ_FRAMEBUFFER,Dt.COLOR_ATTACHMENT0,Dt.TEXTURE_2D,f.gl_texture,0),c.bindBuffer(c.PIXEL_PACK_BUFFER,this.gl_pbo),c.readPixels(n,i,a,o,d,v,l*g),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),[2,this.getBufferSubDataAsync(c.PIXEL_PACK_BUFFER,this.gl_pbo,0,s,l,0)]):[2,this.readTextureSync(r,n,i,a,o,s,l,u)]})})},t.prototype.readTextureSync=function(r,n,i,a,o,s,l,u){u===void 0&&(u=s.byteLength||0);var c=this.device.gl,f=r,d=this.device.translateTextureType(f.format);return c.bindFramebuffer(Dt.FRAMEBUFFER,this.device.readbackFramebuffer),c.framebufferTexture2D(Dt.FRAMEBUFFER,Dt.COLOR_ATTACHMENT0,Dt.TEXTURE_2D,f.gl_texture,0),c.pixelStorei(c.PACK_ALIGNMENT,4),c.readPixels(n,i,a,o,c.RGBA,d,s),s},t.prototype.readBuffer=function(r,n,i,a,o){return au(this,void 0,void 0,function(){var s;return Lh(this,function(l){return s=this.device.gl,un(s)?[2,this.getBufferSubDataAsync(s.ARRAY_BUFFER,fx(r,n),n,i,a,o)]:[2,Promise.reject()]})})},t.prototype.destroy=function(){e.prototype.destroy.call(this),un(this.device.gl)&&(this.gl_sync!==null&&this.device.gl.deleteSync(this.gl_sync),this.gl_pbo!==null&&this.device.gl.deleteBuffer(this.gl_pbo))},t}(Qf),J8t=function(e){Ut(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,o,s,l=e.call(this,{id:n,device:i})||this;return l.type=Qi.RenderPipeline,l.drawMode=U8t((o=a.topology)!==null&&o!==void 0?o:Rs.TRIANGLES),l.program=a.program,l.inputLayout=a.inputLayout,l.megaState=U(U({},$x(Hx)),a.megaStateDescriptor),l.colorAttachmentFormats=a.colorAttachmentFormats.slice(),l.depthStencilAttachmentFormat=a.depthStencilAttachmentFormat,l.sampleCount=(s=a.sampleCount)!==null&&s!==void 0?s:1,l}return t}(Qf),t7t=function(e){Ut(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,o=e.call(this,{id:n,device:i})||this;return o.type=Qi.ComputePipeline,o.descriptor=a,o}return t}(Qf),e7t=function(){function e(){this.liveObjects=new Set,this.creationStacks=new Map,this.deletionStacks=new Map}return e.prototype.trackResourceCreated=function(t){this.creationStacks.set(t,new Error().stack),this.liveObjects.add(t)},e.prototype.trackResourceDestroyed=function(t){this.deletionStacks.has(t)&&console.warn("Object double freed:",t,`

Creation stack: `,this.creationStacks.get(t),`

Deletion stack: `,this.deletionStacks.get(t),`

This stack: `,new Error().stack),this.deletionStacks.set(t,new Error().stack),this.liveObjects.delete(t)},e.prototype.checkForLeaks=function(){var t,r;try{for(var n=mi(this.liveObjects.values()),i=n.next();!i.done;i=n.next()){var a=i.value;console.warn("Object leaked:",a,"Creation stack:",this.creationStacks.get(a))}}catch(o){t={error:o}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}},e.prototype.setResourceLeakCheck=function(t,r){r?this.liveObjects.add(t):this.liveObjects.delete(t)},e}(),r7t=function(e){Ut(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,o,s,l=e.call(this,{id:n,device:i})||this;l.type=Qi.Sampler;var u=l.device.gl;if(un(u)){var c=l.device.ensureResourceExists(u.createSampler());u.samplerParameteri(c,Dt.TEXTURE_WRAP_S,HE(a.addressModeU)),u.samplerParameteri(c,Dt.TEXTURE_WRAP_T,HE(a.addressModeV)),u.samplerParameteri(c,Dt.TEXTURE_WRAP_R,HE((o=a.addressModeW)!==null&&o!==void 0?o:a.addressModeU)),u.samplerParameteri(c,Dt.TEXTURE_MIN_FILTER,pT(a.minFilter,a.mipmapFilter)),u.samplerParameteri(c,Dt.TEXTURE_MAG_FILTER,pT(a.magFilter,el.NO_MIP)),a.lodMinClamp!==void 0&&u.samplerParameterf(c,Dt.TEXTURE_MIN_LOD,a.lodMinClamp),a.lodMaxClamp!==void 0&&u.samplerParameterf(c,Dt.TEXTURE_MAX_LOD,a.lodMaxClamp),a.compareFunction!==void 0&&(u.samplerParameteri(c,u.TEXTURE_COMPARE_MODE,u.COMPARE_REF_TO_TEXTURE),u.samplerParameteri(c,u.TEXTURE_COMPARE_FUNC,a.compareFunction));var f=(s=a.maxAnisotropy)!==null&&s!==void 0?s:1;f>1&&l.device.EXT_texture_filter_anisotropic!==null&&(ri(a.minFilter===ts.BILINEAR&&a.magFilter===ts.BILINEAR&&a.mipmapFilter===el.LINEAR),u.samplerParameterf(c,l.device.EXT_texture_filter_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT,f)),l.gl_sampler=c}else l.descriptor=a;return l}return t.prototype.setTextureParameters=function(r,n,i){var a,o=this.device.gl,s=this.descriptor;this.isNPOT(n,i)?o.texParameteri(Dt.TEXTURE_2D,Dt.TEXTURE_MIN_FILTER,Dt.LINEAR):o.texParameteri(r,Dt.TEXTURE_MIN_FILTER,pT(s.minFilter,s.mipmapFilter)),o.texParameteri(Dt.TEXTURE_2D,Dt.TEXTURE_WRAP_S,HE(s.addressModeU)),o.texParameteri(Dt.TEXTURE_2D,Dt.TEXTURE_WRAP_T,HE(s.addressModeV)),o.texParameteri(r,Dt.TEXTURE_MAG_FILTER,pT(s.magFilter,el.NO_MIP));var l=(a=s.maxAnisotropy)!==null&&a!==void 0?a:1;l>1&&this.device.EXT_texture_filter_anisotropic!==null&&(ri(s.minFilter===ts.BILINEAR&&s.magFilter===ts.BILINEAR&&s.mipmapFilter===el.LINEAR),o.texParameteri(r,this.device.EXT_texture_filter_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT,l))},t.prototype.destroy=function(){e.prototype.destroy.call(this),un(this.device.gl)&&this.device.gl.deleteSampler(ZD(this))},t.prototype.isNPOT=function(r,n){return!BM(r)||!BM(n)},t}(Qf),n7t=function(){function e(){}return e.prototype.dispatchWorkgroups=function(t,r,n){},e.prototype.dispatchWorkgroupsIndirect=function(t,r){},e.prototype.setPipeline=function(t){},e.prototype.setBindings=function(t){},e.prototype.pushDebugGroup=function(t){},e.prototype.popDebugGroup=function(){},e.prototype.insertDebugMarker=function(t){},e}(),i7t=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=Qi.RenderBundle,r.commands=[],r}return t.prototype.push=function(r){this.commands.push(r)},t.prototype.replay=function(){this.commands.forEach(function(r){return r()})},t}(Qf),nH=65536,a7t=/uniform(?:\s+)(\w+)(?:\s?){([^]*?)}/g,o7t=function(){function e(t,r){r===void 0&&(r={}),this.shaderDebug=!1,this.OES_vertex_array_object=null,this.ANGLE_instanced_arrays=null,this.OES_texture_float=null,this.OES_draw_buffers_indexed=null,this.WEBGL_draw_buffers=null,this.WEBGL_depth_texture=null,this.WEBGL_color_buffer_float=null,this.EXT_color_buffer_half_float=null,this.WEBGL_compressed_texture_s3tc=null,this.WEBGL_compressed_texture_s3tc_srgb=null,this.EXT_texture_compression_rgtc=null,this.EXT_texture_filter_anisotropic=null,this.KHR_parallel_shader_compile=null,this.EXT_texture_norm16=null,this.EXT_color_buffer_float=null,this.OES_texture_float_linear=null,this.OES_texture_half_float_linear=null,this.scTexture=null,this.scPlatformFramebuffer=null,this.currentActiveTexture=null,this.currentBoundVAO=null,this.currentProgram=null,this.resourceCreationTracker=null,this.resourceUniqueId=0,this.currentColorAttachments=[],this.currentColorAttachmentLevels=[],this.currentColorResolveTos=[],this.currentColorResolveToLevels=[],this.currentSampleCount=-1,this.currentIndexBufferByteOffset=null,this.currentMegaState=$x(Hx),this.currentSamplers=[],this.currentTextures=[],this.currentUniformBuffers=[],this.currentUniformBufferByteOffsets=[],this.currentUniformBufferByteSizes=[],this.currentScissorEnabled=!1,this.currentStencilRef=null,this.currentRenderPassDescriptor=null,this.currentRenderPassDescriptorStack=[],this.debugGroupStack=[],this.resolveColorAttachmentsChanged=!1,this.resolveDepthStencilAttachmentsChanged=!1,this.explicitBindingLocations=!1,this.separateSamplerTextures=!1,this.viewportOrigin=Od.LOWER_LEFT,this.clipSpaceNearZ=zx.NEGATIVE_ONE,this.supportMRT=!1,this.inBlitRenderPass=!1,this.supportedSampleCounts=[],this.occlusionQueriesRecommended=!1,this.computeShadersSupported=!1,this.gl=t,this.contextAttributes=Ey(t.getContextAttributes()),un(t)?(this.EXT_texture_norm16=t.getExtension("EXT_texture_norm16"),this.EXT_color_buffer_float=t.getExtension("EXT_color_buffer_float")):(this.OES_vertex_array_object=t.getExtension("OES_vertex_array_object"),this.ANGLE_instanced_arrays=t.getExtension("ANGLE_instanced_arrays"),this.OES_texture_float=t.getExtension("OES_texture_float"),this.WEBGL_draw_buffers=t.getExtension("WEBGL_draw_buffers"),this.WEBGL_depth_texture=t.getExtension("WEBGL_depth_texture"),this.WEBGL_color_buffer_float=t.getExtension("WEBGL_color_buffer_float"),this.EXT_color_buffer_half_float=t.getExtension("EXT_color_buffer_half_float"),t.getExtension("EXT_frag_depth"),t.getExtension("OES_element_index_uint"),t.getExtension("OES_standard_derivatives")),this.WEBGL_compressed_texture_s3tc=t.getExtension("WEBGL_compressed_texture_s3tc"),this.WEBGL_compressed_texture_s3tc_srgb=t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),this.EXT_texture_compression_rgtc=t.getExtension("EXT_texture_compression_rgtc"),this.EXT_texture_filter_anisotropic=t.getExtension("EXT_texture_filter_anisotropic"),this.EXT_texture_norm16=t.getExtension("EXT_texture_norm16"),this.OES_texture_float_linear=t.getExtension("OES_texture_float_linear"),this.OES_texture_half_float_linear=t.getExtension("OES_texture_half_float_linear"),this.KHR_parallel_shader_compile=t.getExtension("KHR_parallel_shader_compile"),un(t)?(this.platformString="WebGL2",this.glslVersion="#version 300 es"):(this.platformString="WebGL1",this.glslVersion="#version 100"),this.scTexture=new qD({id:this.getNextUniqueId(),device:this,descriptor:{width:0,height:0,depthOrArrayLayers:1,dimension:Oi.TEXTURE_2D,mipLevelCount:1,usage:Du.RENDER_TARGET,format:this.contextAttributes.alpha===!1?te.U8_RGB_RT:te.U8_RGBA_RT},fake:!0}),this.scTexture.formatKind=Uo.Float,this.scTexture.gl_target=null,this.scTexture.gl_texture=null,this.resolveColorReadFramebuffer=this.ensureResourceExists(t.createFramebuffer()),this.resolveColorDrawFramebuffer=this.ensureResourceExists(t.createFramebuffer()),this.resolveDepthStencilReadFramebuffer=this.ensureResourceExists(t.createFramebuffer()),this.resolveDepthStencilDrawFramebuffer=this.ensureResourceExists(t.createFramebuffer()),this.renderPassDrawFramebuffer=this.ensureResourceExists(t.createFramebuffer()),this.readbackFramebuffer=this.ensureResourceExists(t.createFramebuffer()),this.fallbackTexture2D=this.createFallbackTexture(Oi.TEXTURE_2D,Uo.Float),this.fallbackTexture2DDepth=this.createFallbackTexture(Oi.TEXTURE_2D,Uo.Depth),this.fallbackVertexBuffer=this.createBuffer({viewOrSize:1,usage:Na.VERTEX,hint:Fd.STATIC}),un(t)&&(this.fallbackTexture2DArray=this.createFallbackTexture(Oi.TEXTURE_2D_ARRAY,Uo.Float),this.fallbackTexture3D=this.createFallbackTexture(Oi.TEXTURE_3D,Uo.Float),this.fallbackTextureCube=this.createFallbackTexture(Oi.TEXTURE_CUBE_MAP,Uo.Float)),this.currentMegaState.depthCompare=pa.LESS,this.currentMegaState.depthWrite=!1,this.currentMegaState.attachmentsState[0].channelWriteMask=dl.ALL,t.enable(t.DEPTH_TEST),t.enable(t.STENCIL_TEST),this.checkLimits(),r.shaderDebug&&(this.shaderDebug=!0),r.trackResources&&(this.resourceCreationTracker=new e7t)}return e.prototype.destroy=function(){this.blitBindings&&this.blitBindings.destroy(),this.blitInputLayout&&this.blitInputLayout.destroy(),this.blitRenderPipeline&&this.blitRenderPipeline.destroy(),this.blitVertexBuffer&&this.blitVertexBuffer.destroy(),this.blitProgram&&this.blitProgram.destroy()},e.prototype.createFallbackTexture=function(t,r){var n=t===Oi.TEXTURE_CUBE_MAP?6:1,i=r===Uo.Depth?te.D32F:te.U8_RGBA_NORM,a=this.createTexture({dimension:t,format:i,usage:Du.SAMPLED,width:1,height:1,depthOrArrayLayers:n,mipLevelCount:1});return r===Uo.Float&&a.setImageData([new Uint8Array(4*n)]),z1(a)},e.prototype.getNextUniqueId=function(){return++this.resourceUniqueId},e.prototype.checkLimits=function(){var t=this.gl;if(this.maxVertexAttribs=t.getParameter(Dt.MAX_VERTEX_ATTRIBS),un(t)){this.uniformBufferMaxPageByteSize=Math.min(t.getParameter(Dt.MAX_UNIFORM_BLOCK_SIZE),nH),this.uniformBufferWordAlignment=t.getParameter(t.UNIFORM_BUFFER_OFFSET_ALIGNMENT)/4;var r=t.getInternalformatParameter(t.RENDERBUFFER,t.DEPTH32F_STENCIL8,t.SAMPLES);this.supportedSampleCounts=r?an([],Lr(r),!1):[],this.occlusionQueriesRecommended=!0}else this.uniformBufferWordAlignment=64,this.uniformBufferMaxPageByteSize=nH;this.uniformBufferMaxPageWordSize=this.uniformBufferMaxPageByteSize/4,this.supportedSampleCounts.includes(1)||this.supportedSampleCounts.push(1),this.supportedSampleCounts.sort(function(n,i){return n-i})},e.prototype.configureSwapChain=function(t,r,n){var i=this.scTexture;i.width=t,i.height=r,this.scPlatformFramebuffer=a8t(n)},e.prototype.getDevice=function(){return this},e.prototype.getCanvas=function(){return this.gl.canvas},e.prototype.getOnscreenTexture=function(){return this.scTexture},e.prototype.beginFrame=function(){},e.prototype.endFrame=function(){},e.prototype.translateTextureInternalFormat=function(t,r){switch(r===void 0&&(r=!1),t){case te.ALPHA:return Dt.ALPHA;case te.U8_LUMINANCE:case te.F16_LUMINANCE:case te.F32_LUMINANCE:return Dt.LUMINANCE;case te.F16_R:return Dt.R16F;case te.F16_RG:return Dt.RG16F;case te.F16_RGB:return Dt.RGB16F;case te.F16_RGBA:return Dt.RGBA16F;case te.F32_R:return Dt.R32F;case te.F32_RG:return Dt.RG32F;case te.F32_RGB:return Dt.RGB32F;case te.F32_RGBA:return un(this.gl)?Dt.RGBA32F:r?this.WEBGL_color_buffer_float.RGBA32F_EXT:Dt.RGBA;case te.U8_R_NORM:return Dt.R8;case te.U8_RG_NORM:return Dt.RG8;case te.U8_RGB_NORM:case te.U8_RGB_RT:return Dt.RGB8;case te.U8_RGB_SRGB:return Dt.SRGB8;case te.U8_RGBA_NORM:case te.U8_RGBA_RT:return un(this.gl)?Dt.RGBA8:r?Dt.RGBA4:Dt.RGBA;case te.U8_RGBA:return Dt.RGBA;case te.U8_RGBA_SRGB:case te.U8_RGBA_RT_SRGB:return Dt.SRGB8_ALPHA8;case te.U16_R:return Dt.R16UI;case te.U16_R_NORM:return this.EXT_texture_norm16.R16_EXT;case te.U16_RG_NORM:return this.EXT_texture_norm16.RG16_EXT;case te.U16_RGBA_NORM:return this.EXT_texture_norm16.RGBA16_EXT;case te.U16_RGBA_5551:return Dt.RGB5_A1;case te.U16_RGB_565:return Dt.RGB565;case te.U32_R:return Dt.R32UI;case te.S8_RGBA_NORM:return Dt.RGBA8_SNORM;case te.S8_RG_NORM:return Dt.RG8_SNORM;case te.BC1:return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT1_EXT;case te.BC1_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;case te.BC2:return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT3_EXT;case te.BC2_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;case te.BC3:return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT;case te.BC3_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT;case te.BC4_UNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_RED_RGTC1_EXT;case te.BC4_SNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_SIGNED_RED_RGTC1_EXT;case te.BC5_UNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_RED_GREEN_RGTC2_EXT;case te.BC5_SNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT;case te.D32F_S8:return un(this.gl)?Dt.DEPTH32F_STENCIL8:this.WEBGL_depth_texture?Dt.DEPTH_STENCIL:Dt.DEPTH_COMPONENT16;case te.D24_S8:return un(this.gl)?Dt.DEPTH24_STENCIL8:this.WEBGL_depth_texture?Dt.DEPTH_STENCIL:Dt.DEPTH_COMPONENT16;case te.D32F:return un(this.gl)?Dt.DEPTH_COMPONENT32F:this.WEBGL_depth_texture?Dt.DEPTH_COMPONENT:Dt.DEPTH_COMPONENT16;case te.D24:return un(this.gl)?Dt.DEPTH_COMPONENT24:this.WEBGL_depth_texture?Dt.DEPTH_COMPONENT:Dt.DEPTH_COMPONENT16;default:throw new Error("whoops")}},e.prototype.translateTextureType=function(t){var r=Qp(t);switch(r){case Ge.U8:return Dt.UNSIGNED_BYTE;case Ge.U16:return Dt.UNSIGNED_SHORT;case Ge.U32:return Dt.UNSIGNED_INT;case Ge.S8:return Dt.BYTE;case Ge.F16:return Dt.HALF_FLOAT;case Ge.F32:return Dt.FLOAT;case Ge.U16_PACKED_5551:return Dt.UNSIGNED_SHORT_5_5_5_1;case Ge.D32F:return un(this.gl)?Dt.FLOAT:this.WEBGL_depth_texture?Dt.UNSIGNED_INT:Dt.UNSIGNED_BYTE;case Ge.D24:return un(this.gl)?Dt.UNSIGNED_INT_24_8:this.WEBGL_depth_texture?Dt.UNSIGNED_SHORT:Dt.UNSIGNED_BYTE;case Ge.D24S8:return un(this.gl)?Dt.UNSIGNED_INT_24_8:this.WEBGL_depth_texture?Dt.UNSIGNED_INT_24_8_WEBGL:Dt.UNSIGNED_BYTE;case Ge.D32FS8:return Dt.FLOAT_32_UNSIGNED_INT_24_8_REV;default:throw new Error("whoops")}},e.prototype.translateInternalTextureFormat=function(t){switch(t){case te.F32_R:return Dt.R32F;case te.F32_RG:return Dt.RG32F;case te.F32_RGB:return Dt.RGB32F;case te.F32_RGBA:return Dt.RGBA32F;case te.F16_R:return Dt.R16F;case te.F16_RG:return Dt.RG16F;case te.F16_RGB:return Dt.RGB16F;case te.F16_RGBA:return Dt.RGBA16F}return this.translateTextureFormat(t)},e.prototype.translateTextureFormat=function(t){if(ntt(t)||t===te.F32_LUMINANCE||t===te.U8_LUMINANCE)return this.translateTextureInternalFormat(t);var r=un(this.gl)||!un(this.gl)&&!!this.WEBGL_depth_texture;switch(t){case te.D24_S8:case te.D32F_S8:return r?Dt.DEPTH_STENCIL:Dt.RGBA;case te.D24:case te.D32F:return r?Dt.DEPTH_COMPONENT:Dt.RGBA}var n=itt(t),i=I4(t);switch(i){case Jr.A:return Dt.ALPHA;case Jr.R:return n?Dt.RED_INTEGER:Dt.RED;case Jr.RG:return n?Dt.RG_INTEGER:Dt.RG;case Jr.RGB:return n?Dt.RGB_INTEGER:Dt.RGB;case Jr.RGBA:return Dt.RGBA}},e.prototype.setActiveTexture=function(t){this.currentActiveTexture!==t&&(this.gl.activeTexture(t),this.currentActiveTexture=t)},e.prototype.bindVAO=function(t){this.currentBoundVAO!==t&&(un(this.gl)?this.gl.bindVertexArray(t):this.OES_vertex_array_object.bindVertexArrayOES(t),this.currentBoundVAO=t)},e.prototype.programCompiled=function(t){ri(t.compileState!==Nc.NeedsCompile),t.compileState===Nc.Compiling&&(t.compileState=Nc.NeedsBind,this.shaderDebug&&this.checkProgramCompilationForErrors(t))},e.prototype.useProgram=function(t){this.currentProgram!==t&&(this.programCompiled(t),this.gl.useProgram(t.gl_program),this.currentProgram=t)},e.prototype.ensureResourceExists=function(t){if(t===null){var r=this.gl.getError();throw new Error("Created resource is null; GL error encountered: ".concat(r))}else return t},e.prototype.createBuffer=function(t){return new j8t({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createTexture=function(t){return new qD({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createSampler=function(t){return new r7t({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createRenderTarget=function(t){return new Z8t({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createRenderTargetFromTexture=function(t){var r=t,n=r.format,i=r.width,a=r.height,o=r.mipLevelCount;return ri(o===1),this.createRenderTarget({format:n,width:i,height:a,sampleCount:1,texture:t})},e.prototype.createProgram=function(t){var r,n,i,a=(r=t.vertex)===null||r===void 0?void 0:r.glsl;return!((n=t.vertex)===null||n===void 0)&&n.glsl&&(t.vertex.glsl=Vx(this.queryVendorInfo(),"vert",t.vertex.glsl)),!((i=t.fragment)===null||i===void 0)&&i.glsl&&(t.fragment.glsl=Vx(this.queryVendorInfo(),"frag",t.fragment.glsl)),this.createProgramSimple(t,a)},e.prototype.createProgramSimple=function(t,r){var n=new q8t({id:this.getNextUniqueId(),device:this,descriptor:t},r);return n},e.prototype.createBindings=function(t){return new k8t({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createInputLayout=function(t){return new Y8t({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createRenderPipeline=function(t){return new J8t({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createComputePass=function(){return new n7t},e.prototype.createComputePipeline=function(t){return new t7t({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createReadback=function(){return new Q8t({id:this.getNextUniqueId(),device:this})},e.prototype.createQueryPool=function(t,r){return new K8t({id:this.getNextUniqueId(),device:this,descriptor:{type:t,elemCount:r}})},e.prototype.formatRenderPassDescriptor=function(t){var r,n,i,a,o,s,l=t.colorAttachment;t.depthClearValue=(r=t.depthClearValue)!==null&&r!==void 0?r:"load",t.stencilClearValue=(n=t.stencilClearValue)!==null&&n!==void 0?n:"load";for(var u=0;u<l.length;u++)t.colorAttachmentLevel||(t.colorAttachmentLevel=[]),t.colorAttachmentLevel[u]=(i=t.colorAttachmentLevel[u])!==null&&i!==void 0?i:0,t.colorResolveToLevel||(t.colorResolveToLevel=[]),t.colorResolveToLevel[u]=(a=t.colorResolveToLevel[u])!==null&&a!==void 0?a:0,t.colorClearColor||(t.colorClearColor=[]),t.colorClearColor[u]=(o=t.colorClearColor[u])!==null&&o!==void 0?o:"load",t.colorStore||(t.colorStore=[]),t.colorStore[u]=(s=t.colorStore[u])!==null&&s!==void 0?s:!1},e.prototype.createRenderBundle=function(){return new i7t({id:this.getNextUniqueId(),device:this})},e.prototype.beginBundle=function(t){this.renderBundle=t},e.prototype.endBundle=function(){this.renderBundle=void 0},e.prototype.executeBundles=function(t){t.forEach(function(r){r.replay()})},e.prototype.createRenderPass=function(t){this.currentRenderPassDescriptor!==null&&this.currentRenderPassDescriptorStack.push(this.currentRenderPassDescriptor),this.currentRenderPassDescriptor=t,this.formatRenderPassDescriptor(t);var r=t.colorAttachment,n=t.colorAttachmentLevel,i=t.colorClearColor,a=t.colorResolveTo,o=t.colorResolveToLevel,s=t.depthStencilAttachment,l=t.depthClearValue,u=t.stencilClearValue,c=t.depthStencilResolveTo,f=a&&a.length===1&&a[0]===this.scTexture;this.setRenderPassParametersBegin(r.length,f);for(var d=0;d<r.length;d++)this.setRenderPassParametersColor(d,r[d],n[d],a[d],o[d],f);this.setRenderPassParametersDepthStencil(s,c,f),this.validateCurrentAttachments();for(var d=0;d<r.length;d++){var v=i[d];v!=="load"&&this.setRenderPassParametersClearColor(d,v.r,v.g,v.b,v.a)}return this.setRenderPassParametersClearDepthStencil(l,u),this},e.prototype.submitPass=function(t){ri(this.currentRenderPassDescriptor!==null),this.endPass(),this.currentRenderPassDescriptorStack.length?this.currentRenderPassDescriptor=this.currentRenderPassDescriptorStack.pop():this.currentRenderPassDescriptor=null},e.prototype.copySubTexture2D=function(t,r,n,i,a,o){var s=this.gl,l=t,u=i;if(ri(u.mipLevelCount===1),ri(l.mipLevelCount===1),un(s))l===this.scTexture?s.bindFramebuffer(s.DRAW_FRAMEBUFFER,this.scPlatformFramebuffer):(s.bindFramebuffer(s.DRAW_FRAMEBUFFER,this.resolveColorDrawFramebuffer),this.bindFramebufferAttachment(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0,l,0)),s.bindFramebuffer(s.READ_FRAMEBUFFER,this.resolveColorReadFramebuffer),this.bindFramebufferAttachment(s.READ_FRAMEBUFFER,s.COLOR_ATTACHMENT0,u,0),s.blitFramebuffer(a,o,a+u.width,o+u.height,r,n,r+u.width,n+u.height,s.COLOR_BUFFER_BIT,s.LINEAR),s.bindFramebuffer(s.READ_FRAMEBUFFER,null),s.bindFramebuffer(s.DRAW_FRAMEBUFFER,null);else if(l===this.scTexture){var c=this.createRenderTargetFromTexture(i);this.submitBlitRenderPass(c,l)}},e.prototype.queryLimits=function(){return this},e.prototype.queryTextureFormatSupported=function(t,r,n){switch(t){case te.BC1_SRGB:case te.BC2_SRGB:case te.BC3_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb!==null?AO(r,n,4,4):!1;case te.BC1:case te.BC2:case te.BC3:return this.WEBGL_compressed_texture_s3tc!==null?AO(r,n,4,4):!1;case te.BC4_UNORM:case te.BC4_SNORM:case te.BC5_UNORM:case te.BC5_SNORM:return this.EXT_texture_compression_rgtc!==null?AO(r,n,4,4):!1;case te.U16_R_NORM:case te.U16_RG_NORM:case te.U16_RGBA_NORM:return this.EXT_texture_norm16!==null;case te.F32_R:case te.F32_RG:case te.F32_RGB:case te.F32_RGBA:return this.OES_texture_float_linear!==null;case te.F16_R:case te.F16_RG:case te.F16_RGB:case te.F16_RGBA:return this.OES_texture_half_float_linear!==null;default:return!0}},e.prototype.queryProgramReady=function(t){var r=this.gl;if(t.compileState===Nc.NeedsCompile)throw new Error("whoops");if(t.compileState===Nc.Compiling){var n=void 0;return this.KHR_parallel_shader_compile!==null?n=r.getProgramParameter(t.gl_program,this.KHR_parallel_shader_compile.COMPLETION_STATUS_KHR):n=!0,n&&this.programCompiled(t),n}return t.compileState===Nc.NeedsBind||t.compileState===Nc.ReadyToUse},e.prototype.queryPlatformAvailable=function(){return this.gl.isContextLost()},e.prototype.queryVendorInfo=function(){return this},e.prototype.queryRenderPass=function(t){return this.currentRenderPassDescriptor},e.prototype.queryRenderTarget=function(t){var r=t;return r},e.prototype.setResourceName=function(t,r){if(t.name=r,t.type===Qi.Buffer)for(var n=t.gl_buffer_pages,i=0;i<n.length;i++)VE(n[i],"".concat(r," Page ").concat(i));else if(t.type===Qi.Texture)VE(z1(t),r);else if(t.type===Qi.Sampler)VE(ZD(t),r);else if(t.type===Qi.RenderTarget){var a=t.gl_renderbuffer;a!==null&&VE(a,r)}else t.type===Qi.InputLayout&&VE(t.vao,r)},e.prototype.setResourceLeakCheck=function(t,r){this.resourceCreationTracker!==null&&this.resourceCreationTracker.setResourceLeakCheck(t,r)},e.prototype.checkForLeaks=function(){this.resourceCreationTracker!==null&&this.resourceCreationTracker.checkForLeaks()},e.prototype.pushDebugGroup=function(t){},e.prototype.popDebugGroup=function(){},e.prototype.insertDebugMarker=function(t){},e.prototype.programPatched=function(t,r){ri(this.shaderDebug)},e.prototype.getBufferData=function(t,r,n){n===void 0&&(n=0);var i=this.gl;un(i)&&(i.bindBuffer(i.COPY_READ_BUFFER,fx(t,n*4)),i.getBufferSubData(i.COPY_READ_BUFFER,n*4,r))},e.prototype.debugGroupStatisticsDrawCall=function(t){t===void 0&&(t=1);for(var r=this.debugGroupStack.length-1;r>=0;r--)this.debugGroupStack[r].drawCallCount+=t},e.prototype.debugGroupStatisticsBufferUpload=function(t){t===void 0&&(t=1);for(var r=this.debugGroupStack.length-1;r>=0;r--)this.debugGroupStack[r].bufferUploadCount+=t},e.prototype.debugGroupStatisticsTextureBind=function(t){t===void 0&&(t=1);for(var r=this.debugGroupStack.length-1;r>=0;r--)this.debugGroupStack[r].textureBindCount+=t},e.prototype.debugGroupStatisticsTriangles=function(t){for(var r=this.debugGroupStack.length-1;r>=0;r--)this.debugGroupStack[r].triangleCount+=t},e.prototype.reportShaderError=function(t,r){var n=this.gl,i=n.getShaderParameter(t,n.COMPILE_STATUS);if(!i){console.error(s8t(r));var a=n.getExtension("WEBGL_debug_shaders");a&&console.error(a.getTranslatedShaderSource(t)),console.error(n.getShaderInfoLog(t))}return i},e.prototype.checkProgramCompilationForErrors=function(t){var r=this.gl,n=t.gl_program;if(!r.getProgramParameter(n,r.LINK_STATUS)){var i=t.descriptor;if(!this.reportShaderError(t.gl_shader_vert,i.vertex.glsl)||!this.reportShaderError(t.gl_shader_frag,i.fragment.glsl))return;console.error(r.getProgramInfoLog(t.gl_program))}},e.prototype.bindFramebufferAttachment=function(t,r,n,i){var a=this.gl;if(kf(n))a.framebufferRenderbuffer(t,r,a.RENDERBUFFER,null);else if(n.type===Qi.RenderTarget)n.gl_renderbuffer!==null?a.framebufferRenderbuffer(t,r,a.RENDERBUFFER,n.gl_renderbuffer):n.texture!==null&&a.framebufferTexture2D(t,r,Dt.TEXTURE_2D,z1(n.texture),i);else if(n.type===Qi.Texture){var o=z1(n);n.dimension===Oi.TEXTURE_2D?a.framebufferTexture2D(t,r,Dt.TEXTURE_2D,o,i):un(a)&&(n.dimension,Oi.TEXTURE_2D_ARRAY)}},e.prototype.bindFramebufferDepthStencilAttachment=function(t,r){var n=this.gl,i=kf(r)?Fr.Depth|Fr.Stencil:Ux(r.format),a=!!(i&Fr.Depth),o=!!(i&Fr.Stencil);if(a&&o){var s=un(this.gl)||!un(this.gl)&&!!this.WEBGL_depth_texture;s?this.bindFramebufferAttachment(t,n.DEPTH_STENCIL_ATTACHMENT,r,0):this.bindFramebufferAttachment(t,n.DEPTH_ATTACHMENT,r,0)}else a?(this.bindFramebufferAttachment(t,n.DEPTH_ATTACHMENT,r,0),this.bindFramebufferAttachment(t,n.STENCIL_ATTACHMENT,null,0)):o&&(this.bindFramebufferAttachment(t,n.STENCIL_ATTACHMENT,r,0),this.bindFramebufferAttachment(t,n.DEPTH_ATTACHMENT,null,0))},e.prototype.validateCurrentAttachments=function(){for(var t=-1,r=-1,n=-1,i=0;i<this.currentColorAttachments.length;i++){var a=this.currentColorAttachments[i];a!==null&&(t===-1?(t=a.sampleCount,r=a.width,n=a.height):(ri(t===a.sampleCount),ri(r===a.width),ri(n===a.height)))}this.currentDepthStencilAttachment&&(t===-1?t=this.currentDepthStencilAttachment.sampleCount:(ri(t===this.currentDepthStencilAttachment.sampleCount),ri(r===this.currentDepthStencilAttachment.width),ri(n===this.currentDepthStencilAttachment.height))),this.currentSampleCount=t},e.prototype.setRenderPassParametersBegin=function(t,r){r===void 0&&(r=!1);var n=this.gl;if(r)n.bindFramebuffer(Dt.FRAMEBUFFER,null);else if(un(n)?n.bindFramebuffer(Dt.DRAW_FRAMEBUFFER,this.renderPassDrawFramebuffer):this.inBlitRenderPass||n.bindFramebuffer(Dt.FRAMEBUFFER,this.renderPassDrawFramebuffer),un(n)?n.drawBuffers([Dt.COLOR_ATTACHMENT0,Dt.COLOR_ATTACHMENT1,Dt.COLOR_ATTACHMENT2,Dt.COLOR_ATTACHMENT3]):!this.inBlitRenderPass&&this.WEBGL_draw_buffers&&this.WEBGL_draw_buffers.drawBuffersWEBGL([Dt.COLOR_ATTACHMENT0_WEBGL,Dt.COLOR_ATTACHMENT1_WEBGL,Dt.COLOR_ATTACHMENT2_WEBGL,Dt.COLOR_ATTACHMENT3_WEBGL]),!this.inBlitRenderPass)for(var i=t;i<this.currentColorAttachments.length;i++){var a=un(n)?Dt.DRAW_FRAMEBUFFER:Dt.FRAMEBUFFER,o=un(n)?Dt.COLOR_ATTACHMENT0:Dt.COLOR_ATTACHMENT0_WEBGL;n.framebufferRenderbuffer(a,o+i,Dt.RENDERBUFFER,null),n.framebufferTexture2D(a,o+i,Dt.TEXTURE_2D,null,0)}this.currentColorAttachments.length=t},e.prototype.setRenderPassParametersColor=function(t,r,n,i,a,o){o===void 0&&(o=!1);var s=this.gl,l=un(s);(this.currentColorAttachments[t]!==r||this.currentColorAttachmentLevels[t]!==n)&&(this.currentColorAttachments[t]=r,this.currentColorAttachmentLevels[t]=n,!o&&(l||!l&&this.WEBGL_draw_buffers)&&this.bindFramebufferAttachment(l?Dt.DRAW_FRAMEBUFFER:Dt.FRAMEBUFFER,(l?Dt.COLOR_ATTACHMENT0:Dt.COLOR_ATTACHMENT0_WEBGL)+t,r,n),this.resolveColorAttachmentsChanged=!0),(this.currentColorResolveTos[t]!==i||this.currentColorResolveToLevels[t]!==a)&&(this.currentColorResolveTos[t]=i,this.currentColorResolveToLevels[t]=a,i!==null&&(this.resolveColorAttachmentsChanged=!0))},e.prototype.setRenderPassParametersDepthStencil=function(t,r,n){n===void 0&&(n=!1);var i=this.gl;this.currentDepthStencilAttachment!==t&&(this.currentDepthStencilAttachment=t,!n&&!this.inBlitRenderPass&&this.bindFramebufferDepthStencilAttachment(un(i)?Dt.DRAW_FRAMEBUFFER:Dt.FRAMEBUFFER,this.currentDepthStencilAttachment),this.resolveDepthStencilAttachmentsChanged=!0),this.currentDepthStencilResolveTo!==r&&(this.currentDepthStencilResolveTo=r,r&&(this.resolveDepthStencilAttachmentsChanged=!0))},e.prototype.setRenderPassParametersClearColor=function(t,r,n,i,a){var o=this.gl;if(this.OES_draw_buffers_indexed!==null){var s=this.currentMegaState.attachmentsState[t];s&&s.channelWriteMask!==dl.ALL&&(this.OES_draw_buffers_indexed.colorMaskiOES(t,!0,!0,!0,!0),s.channelWriteMask=dl.ALL)}else{var s=this.currentMegaState.attachmentsState[0];s&&s.channelWriteMask!==dl.ALL&&(o.colorMask(!0,!0,!0,!0),s.channelWriteMask=dl.ALL)}this.setScissorRectEnabled(!1),un(o)?o.clearBufferfv(o.COLOR,t,[r,n,i,a]):(o.clearColor(r,n,i,a),o.clear(o.COLOR_BUFFER_BIT))},e.prototype.setRenderPassParametersClearDepthStencil=function(t,r){t===void 0&&(t="load"),r===void 0&&(r="load");var n=this.gl;t!=="load"&&(ri(!!this.currentDepthStencilAttachment),this.currentMegaState.depthWrite||(n.depthMask(!0),this.currentMegaState.depthWrite=!0),un(n)?n.clearBufferfv(n.DEPTH,0,[t]):(n.clearDepth(t),n.clear(n.DEPTH_BUFFER_BIT))),r!=="load"&&(ri(!!this.currentDepthStencilAttachment),this.currentMegaState.stencilWrite||(n.enable(n.STENCIL_TEST),n.stencilMask(255),this.currentMegaState.stencilWrite=!0),un(n)?n.clearBufferiv(n.STENCIL,0,[r]):(n.clearStencil(r),n.clear(n.STENCIL_BUFFER_BIT)))},e.prototype.setBindings=function(t){var r=this,n;if(this.renderBundle){this.renderBundle.push(function(){return r.setBindings(t)});return}var i=this.gl,a=t,o=a.uniformBufferBindings,s=a.samplerBindings,l=a.bindingLayouts;ri(0<l.bindingLayoutTables.length);var u=l.bindingLayoutTables[0];ri(o.length>=u.numUniformBuffers),ri(s.length>=u.numSamplers);for(var c=0;c<o.length;c++){var f=o[c];if(f.size!==0){var d=u.firstUniformBuffer+c,v=f.buffer,g=f.offset||0,x=f.size||v.byteSize;if(v!==this.currentUniformBuffers[d]||g!==this.currentUniformBufferByteOffsets[d]||x!==this.currentUniformBufferByteSizes[d]){var w=g%v.pageByteSize,S=v.gl_buffer_pages[g/v.pageByteSize|0];ri(w+x<=v.pageByteSize),un(i)&&i.bindBufferRange(i.UNIFORM_BUFFER,d,S,w,x),this.currentUniformBuffers[d]=v,this.currentUniformBufferByteOffsets[d]=g,this.currentUniformBufferByteSizes[d]=x}}}for(var c=0;c<u.numSamplers;c++){var f=s[c],A=u.firstSampler+c,M=f!==null&&f.sampler!==null?ZD(f.sampler):null,R=f!==null&&f.texture!==null?z1(f.texture):null;if(this.currentSamplers[A]!==M&&(un(i)&&i.bindSampler(A,M),this.currentSamplers[A]=M),this.currentTextures[A]!==R){if(this.setActiveTexture(i.TEXTURE0+A),R!==null){var O=Ey(f).texture,N=O.gl_target,k=O.width,V=O.height;f.texture.textureIndex=A,i.bindTexture(N,R),un(i)||(n=f.sampler)===null||n===void 0||n.setTextureParameters(N,k,V),this.debugGroupStatisticsTextureBind()}else{var Q=U(U({},f),ett),Y=Q.dimension,X=Q.formatKind,N=X8t(Y);i.bindTexture(N,this.getFallbackTexture(U({gl_target:N,formatKind:X},Q)))}this.currentTextures[A]=R}}},e.prototype.setViewport=function(t,r,n,i){var a=this.gl;a.viewport(t,r,n,i)},e.prototype.setScissorRect=function(t,r,n,i){var a=this.gl;this.setScissorRectEnabled(!0),a.scissor(t,r,n,i)},e.prototype.applyAttachmentStateIndexed=function(t,r,n){var i=this.gl,a=this.OES_draw_buffers_indexed;r.channelWriteMask!==n.channelWriteMask&&(a.colorMaskiOES(t,!!(n.channelWriteMask&dl.RED),!!(n.channelWriteMask&dl.GREEN),!!(n.channelWriteMask&dl.BLUE),!!(n.channelWriteMask&dl.ALPHA)),r.channelWriteMask=n.channelWriteMask);var o=r.rgbBlendState.blendMode!==n.rgbBlendState.blendMode||r.alphaBlendState.blendMode!==n.alphaBlendState.blendMode,s=r.rgbBlendState.blendSrcFactor!==n.rgbBlendState.blendSrcFactor||r.alphaBlendState.blendSrcFactor!==n.alphaBlendState.blendSrcFactor||r.rgbBlendState.blendDstFactor!==n.rgbBlendState.blendDstFactor||r.alphaBlendState.blendDstFactor!==n.alphaBlendState.blendDstFactor;(s||o)&&(om(r.rgbBlendState)&&om(r.alphaBlendState)?a.enableiOES(t,i.BLEND):om(n.rgbBlendState)&&om(n.alphaBlendState)&&a.disableiOES(t,i.BLEND)),o&&(a.blendEquationSeparateiOES(t,n.rgbBlendState.blendMode,n.alphaBlendState.blendMode),r.rgbBlendState.blendMode=n.rgbBlendState.blendMode,r.alphaBlendState.blendMode=n.alphaBlendState.blendMode),s&&(a.blendFuncSeparateiOES(t,n.rgbBlendState.blendSrcFactor,n.rgbBlendState.blendDstFactor,n.alphaBlendState.blendSrcFactor,n.alphaBlendState.blendDstFactor),r.rgbBlendState.blendSrcFactor=n.rgbBlendState.blendSrcFactor,r.alphaBlendState.blendSrcFactor=n.alphaBlendState.blendSrcFactor,r.rgbBlendState.blendDstFactor=n.rgbBlendState.blendDstFactor,r.alphaBlendState.blendDstFactor=n.alphaBlendState.blendDstFactor)},e.prototype.applyAttachmentState=function(t,r){var n=this.gl;t.channelWriteMask!==r.channelWriteMask&&(n.colorMask(!!(r.channelWriteMask&dl.RED),!!(r.channelWriteMask&dl.GREEN),!!(r.channelWriteMask&dl.BLUE),!!(r.channelWriteMask&dl.ALPHA)),t.channelWriteMask=r.channelWriteMask);var i=t.rgbBlendState.blendMode!==r.rgbBlendState.blendMode||t.alphaBlendState.blendMode!==r.alphaBlendState.blendMode,a=t.rgbBlendState.blendSrcFactor!==r.rgbBlendState.blendSrcFactor||t.alphaBlendState.blendSrcFactor!==r.alphaBlendState.blendSrcFactor||t.rgbBlendState.blendDstFactor!==r.rgbBlendState.blendDstFactor||t.alphaBlendState.blendDstFactor!==r.alphaBlendState.blendDstFactor;(a||i)&&(om(t.rgbBlendState)&&om(t.alphaBlendState)?n.enable(n.BLEND):om(r.rgbBlendState)&&om(r.alphaBlendState)&&n.disable(n.BLEND)),i&&(n.blendEquationSeparate(r.rgbBlendState.blendMode,r.alphaBlendState.blendMode),t.rgbBlendState.blendMode=r.rgbBlendState.blendMode,t.alphaBlendState.blendMode=r.alphaBlendState.blendMode),a&&(n.blendFuncSeparate(r.rgbBlendState.blendSrcFactor,r.rgbBlendState.blendDstFactor,r.alphaBlendState.blendSrcFactor,r.alphaBlendState.blendDstFactor),t.rgbBlendState.blendSrcFactor=r.rgbBlendState.blendSrcFactor,t.alphaBlendState.blendSrcFactor=r.alphaBlendState.blendSrcFactor,t.rgbBlendState.blendDstFactor=r.rgbBlendState.blendDstFactor,t.alphaBlendState.blendDstFactor=r.alphaBlendState.blendDstFactor)},e.prototype.setMegaState=function(t){var r=this.gl,n=this.currentMegaState;if(this.OES_draw_buffers_indexed!==null)for(var i=0;i<t.attachmentsState.length;i++)this.applyAttachmentStateIndexed(i,n.attachmentsState[0],t.attachmentsState[0]);else ri(t.attachmentsState.length===1),this.applyAttachmentState(n.attachmentsState[0],t.attachmentsState[0]);qJ(n.blendConstant,t.blendConstant)||(r.blendColor(t.blendConstant.r,t.blendConstant.g,t.blendConstant.b,t.blendConstant.a),KJ(n.blendConstant,t.blendConstant)),n.depthCompare!==t.depthCompare&&(r.depthFunc(t.depthCompare),n.depthCompare=t.depthCompare),!!n.depthWrite!=!!t.depthWrite&&(r.depthMask(t.depthWrite),n.depthWrite=t.depthWrite),!!n.stencilWrite!=!!t.stencilWrite&&(r.stencilMask(t.stencilWrite?255:0),n.stencilWrite=t.stencilWrite);var a=!1;if(!zM(n.stencilFront,t.stencilFront)){a=!0;var o=t.stencilFront,s=o.passOp,l=o.failOp,u=o.depthFailOp,c=o.compare;(n.stencilFront.passOp!==s||n.stencilFront.failOp!==l||n.stencilFront.depthFailOp!==u)&&(r.stencilOpSeparate(r.FRONT,l,u,s),n.stencilFront.passOp=s,n.stencilFront.failOp=l,n.stencilFront.depthFailOp=u),n.stencilFront.compare!==c&&(this.setStencilReference(0),n.stencilFront.compare=c)}if(!zM(n.stencilBack,t.stencilBack)){a=!0;var f=t.stencilBack,s=f.passOp,l=f.failOp,u=f.depthFailOp,c=f.compare;(n.stencilBack.passOp!==s||n.stencilBack.failOp!==l||n.stencilBack.depthFailOp!==u)&&(r.stencilOpSeparate(r.BACK,l,u,s),n.stencilBack.passOp=s,n.stencilBack.failOp=l,n.stencilBack.depthFailOp=u),n.stencilBack.compare!==c&&(this.setStencilReference(0),n.stencilBack.compare=c)}(n.stencilFront.mask!==t.stencilFront.mask||n.stencilBack.mask!==t.stencilBack.mask)&&(a=!0,n.stencilFront.mask=t.stencilFront.mask,n.stencilBack.mask=t.stencilBack.mask),a&&this.applyStencil(),n.cullMode!==t.cullMode&&(n.cullMode===Vc.NONE?r.enable(r.CULL_FACE):t.cullMode===Vc.NONE&&r.disable(r.CULL_FACE),t.cullMode===Vc.BACK?r.cullFace(r.BACK):t.cullMode===Vc.FRONT?r.cullFace(r.FRONT):t.cullMode===Vc.FRONT_AND_BACK&&r.cullFace(r.FRONT_AND_BACK),n.cullMode=t.cullMode),n.frontFace!==t.frontFace&&(r.frontFace(t.frontFace),n.frontFace=t.frontFace),n.polygonOffset!==t.polygonOffset&&(t.polygonOffset?r.enable(r.POLYGON_OFFSET_FILL):r.disable(r.POLYGON_OFFSET_FILL),n.polygonOffset=t.polygonOffset),(n.polygonOffsetFactor!==t.polygonOffsetFactor||n.polygonOffsetUnits!==t.polygonOffsetUnits)&&(r.polygonOffset(t.polygonOffsetFactor,t.polygonOffsetUnits),n.polygonOffsetFactor=t.polygonOffsetFactor,n.polygonOffsetUnits=t.polygonOffsetUnits)},e.prototype.validatePipelineFormats=function(t){for(var r=0;r<this.currentColorAttachments.length;r++)var n=this.currentColorAttachments[r];this.currentDepthStencilAttachment&&ri(this.currentDepthStencilAttachment.format===t.depthStencilAttachmentFormat),this.currentSampleCount!==-1&&ri(this.currentSampleCount===t.sampleCount)},e.prototype.setPipeline=function(t){var r=this;if(this.renderBundle){this.renderBundle.push(function(){return r.setPipeline(t)});return}this.currentPipeline=t,this.validatePipelineFormats(this.currentPipeline),this.setMegaState(this.currentPipeline.megaState);var n=this.currentPipeline.program;if(this.useProgram(n),n.compileState===Nc.NeedsBind){var i=this.gl,a=n.gl_program,o=n.descriptor,s=rH(o.vertex.glsl,a7t);if(un(i))for(var l=0;l<s.length;l++){var u=Lr(s[l],2),c=u[1],f=i.getUniformBlockIndex(a,c);f!==-1&&f!==4294967295&&i.uniformBlockBinding(a,f,l)}for(var d=rH(o.fragment.glsl,/^uniform .*sampler\S+ (\w+);\s* \/\/ BINDING=(\d+)$/gm),l=0;l<d.length;l++){var v=Lr(d[l],3),g=v[1],x=v[2],w=i.getUniformLocation(a,g);i.uniform1i(w,parseInt(x))}n.compileState=Nc.ReadyToUse}},e.prototype.setVertexInput=function(t,r,n){var i,a,o=this,s;if(this.renderBundle){this.renderBundle.push(function(){return o.setVertexInput(t,r,n)});return}if(t!==null){ri(this.currentPipeline.inputLayout===t);var l=t;this.bindVAO(l.vao);for(var u=this.gl,c=0;c<l.vertexBufferDescriptors.length;c++){var f=l.vertexBufferDescriptors[c],d=f.arrayStride,v=f.attributes;try{for(var g=(i=void 0,mi(v)),x=g.next();!x.done;x=g.next()){var w=x.value,S=w.shaderLocation,A=w.offset,M=un(u)?S:(s=l.program.attributes[S])===null||s===void 0?void 0:s.location;if(!kf(M)){var R=r[c];if(R===null)continue;var O=w.vertexFormat;u.bindBuffer(u.ARRAY_BUFFER,fx(R.buffer));var N=(R.offset||0)+A;u.vertexAttribPointer(M,O.size,O.type,O.normalized,d,N)}}}catch(V){i={error:V}}finally{try{x&&!x.done&&(a=g.return)&&a.call(g)}finally{if(i)throw i.error}}}if(ri(n!==null==(l.indexBufferFormat!==null)),n!==null){var k=n.buffer;ri(k.usage===Na.INDEX),u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,fx(k)),this.currentIndexBufferByteOffset=n.offset||0}else this.currentIndexBufferByteOffset=null}else ri(this.currentPipeline.inputLayout===null),ri(n===null),this.bindVAO(null),this.currentIndexBufferByteOffset=0},e.prototype.setStencilReference=function(t){this.currentStencilRef!==t&&(this.currentStencilRef=t,this.applyStencil())},e.prototype.draw=function(t,r,n,i){var a,o=this;if(this.renderBundle){this.renderBundle.push(function(){return o.draw(t,r,n,i)});return}var s=this.gl,l=this.currentPipeline;if(r){var u=[l.drawMode,n||0,t,r];un(s)?s.drawArraysInstanced.apply(s,an([],Lr(u),!1)):(a=this.ANGLE_instanced_arrays).drawArraysInstancedANGLE.apply(a,an([],Lr(u),!1))}else s.drawArrays(l.drawMode,n,t);this.debugGroupStatisticsDrawCall(),this.debugGroupStatisticsTriangles(t/3*Math.max(r,1))},e.prototype.drawIndexed=function(t,r,n,i,a){var o,s=this;if(this.renderBundle){this.renderBundle.push(function(){return s.drawIndexed(t,r,n,i,a)});return}var l=this.gl,u=this.currentPipeline,c=Ey(u.inputLayout),f=Ey(this.currentIndexBufferByteOffset)+n*c.indexBufferCompByteSize;if(r){var d=[u.drawMode,t,c.indexBufferType,f,r];un(l)?l.drawElementsInstanced.apply(l,an([],Lr(d),!1)):(o=this.ANGLE_instanced_arrays).drawElementsInstancedANGLE.apply(o,an([],Lr(d),!1))}else l.drawElements(u.drawMode,t,c.indexBufferType,f);this.debugGroupStatisticsDrawCall(),this.debugGroupStatisticsTriangles(t/3*Math.max(r,1))},e.prototype.drawIndirect=function(t,r){},e.prototype.drawIndexedIndirect=function(t,r){},e.prototype.beginOcclusionQuery=function(t){var r=this.gl;if(un(r)){var n=this.currentRenderPassDescriptor.occlusionQueryPool;r.beginQuery(n.gl_query_type,n.gl_query[t])}},e.prototype.endOcclusionQuery=function(){var t=this.gl;if(un(t)){var r=this.currentRenderPassDescriptor.occlusionQueryPool;t.endQuery(r.gl_query_type)}},e.prototype.pipelineQueryReady=function(t){var r=t;return this.queryProgramReady(r.program)},e.prototype.pipelineForceReady=function(t){},e.prototype.endPass=function(){for(var t=this.gl,r=un(t),n=this.currentColorResolveTos.length===1&&this.currentColorResolveTos[0]===this.scTexture,i=!1,a=0;a<this.currentColorAttachments.length;a++){var o=this.currentColorAttachments[a];if(o!==null){var s=this.currentColorResolveTos[a],l=!1;s!==null&&(ri(o.width===s.width&&o.height===s.height),this.setScissorRectEnabled(!1),n||(r&&t.bindFramebuffer(t.READ_FRAMEBUFFER,this.resolveColorReadFramebuffer),this.resolveColorAttachmentsChanged&&r&&this.bindFramebufferAttachment(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,o,this.currentColorAttachmentLevels[a])),l=!0,n||(s===this.scTexture?t.bindFramebuffer(r?Dt.DRAW_FRAMEBUFFER:Dt.FRAMEBUFFER,this.scPlatformFramebuffer):(t.bindFramebuffer(r?Dt.DRAW_FRAMEBUFFER:Dt.FRAMEBUFFER,this.resolveColorDrawFramebuffer),this.resolveColorAttachmentsChanged&&t.framebufferTexture2D(r?Dt.DRAW_FRAMEBUFFER:Dt.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,s.gl_texture,this.currentColorResolveToLevels[a]))),n||(r?(t.blitFramebuffer(0,0,o.width,o.height,0,0,s.width,s.height,t.COLOR_BUFFER_BIT,t.LINEAR),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null)):this.submitBlitRenderPass(o,s)),i=!0),this.currentRenderPassDescriptor.colorStore[a]||!n&&!l&&(t.bindFramebuffer(r?Dt.READ_FRAMEBUFFER:Dt.FRAMEBUFFER,this.resolveColorReadFramebuffer),this.resolveColorAttachmentsChanged&&this.bindFramebufferAttachment(r?Dt.READ_FRAMEBUFFER:Dt.FRAMEBUFFER,t.COLOR_ATTACHMENT0,o,this.currentColorAttachmentLevels[a])),n||t.bindFramebuffer(r?Dt.READ_FRAMEBUFFER:Dt.FRAMEBUFFER,null)}}this.resolveColorAttachmentsChanged=!1;var u=this.currentDepthStencilAttachment;if(u){var c=this.currentDepthStencilResolveTo,l=!1;c&&(ri(u.width===c.width&&u.height===c.height),this.setScissorRectEnabled(!1),n||(t.bindFramebuffer(r?Dt.READ_FRAMEBUFFER:Dt.FRAMEBUFFER,this.resolveDepthStencilReadFramebuffer),t.bindFramebuffer(r?Dt.DRAW_FRAMEBUFFER:Dt.FRAMEBUFFER,this.resolveDepthStencilDrawFramebuffer),this.resolveDepthStencilAttachmentsChanged&&(this.bindFramebufferDepthStencilAttachment(r?Dt.READ_FRAMEBUFFER:Dt.FRAMEBUFFER,u),this.bindFramebufferDepthStencilAttachment(r?Dt.DRAW_FRAMEBUFFER:Dt.FRAMEBUFFER,c))),l=!0,n||(r&&t.blitFramebuffer(0,0,u.width,u.height,0,0,c.width,c.height,t.DEPTH_BUFFER_BIT,t.NEAREST),t.bindFramebuffer(r?Dt.DRAW_FRAMEBUFFER:Dt.FRAMEBUFFER,null)),i=!0),!n&&!this.currentRenderPassDescriptor.depthStencilStore&&(l||(t.bindFramebuffer(r?Dt.READ_FRAMEBUFFER:Dt.FRAMEBUFFER,this.resolveDepthStencilReadFramebuffer),this.resolveDepthStencilAttachmentsChanged&&this.bindFramebufferDepthStencilAttachment(r?Dt.READ_FRAMEBUFFER:Dt.FRAMEBUFFER,u),l=!0),r&&t.invalidateFramebuffer(t.READ_FRAMEBUFFER,[t.DEPTH_STENCIL_ATTACHMENT])),!n&&l&&t.bindFramebuffer(r?Dt.READ_FRAMEBUFFER:Dt.FRAMEBUFFER,null),this.resolveDepthStencilAttachmentsChanged=!1}!n&&!i&&t.bindFramebuffer(r?Dt.DRAW_FRAMEBUFFER:Dt.FRAMEBUFFER,null)},e.prototype.setScissorRectEnabled=function(t){if(this.currentScissorEnabled!==t){var r=this.gl;t?r.enable(r.SCISSOR_TEST):r.disable(r.SCISSOR_TEST),this.currentScissorEnabled=t}},e.prototype.applyStencil=function(){kf(this.currentStencilRef)||(this.gl.stencilFuncSeparate(Dt.FRONT,this.currentMegaState.stencilFront.compare,this.currentStencilRef,this.currentMegaState.stencilFront.mask||255),this.gl.stencilFuncSeparate(Dt.BACK,this.currentMegaState.stencilBack.compare,this.currentStencilRef,this.currentMegaState.stencilBack.mask||255))},e.prototype.getFallbackTexture=function(t){var r=t.gl_target,n=t.formatKind;if(r===Dt.TEXTURE_2D)return n===Uo.Depth?this.fallbackTexture2DDepth:this.fallbackTexture2D;if(r===Dt.TEXTURE_2D_ARRAY)return this.fallbackTexture2DArray;if(r===Dt.TEXTURE_3D)return this.fallbackTexture3D;if(r===Dt.TEXTURE_CUBE_MAP)return this.fallbackTextureCube;throw new Error("whoops")},e.prototype.submitBlitRenderPass=function(t,r){this.blitRenderPipeline||(this.blitProgram=this.createProgram({vertex:{glsl:`layout(location = 0) in vec2 a_Position;
out vec2 v_TexCoord;
void main() {
  v_TexCoord = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);

  #ifdef VIEWPORT_ORIGIN_TL
    v_TexCoord.y = 1.0 - v_TexCoord.y;
  #endif
}`},fragment:{glsl:`uniform sampler2D u_Texture;
in vec2 v_TexCoord;
out vec4 outputColor;
void main() {
  outputColor = texture(SAMPLER_2D(u_Texture), v_TexCoord);
}`}}),this.blitVertexBuffer=this.createBuffer({usage:Na.VERTEX|Na.COPY_DST,viewOrSize:new Float32Array([-4,-4,4,-4,0,4])}),this.blitInputLayout=this.createInputLayout({vertexBufferDescriptors:[{arrayStride:4*2,stepMode:Qy.VERTEX,attributes:[{format:te.F32_RG,offset:4*0,shaderLocation:0}]}],indexBufferFormat:null,program:this.blitProgram}),this.blitRenderPipeline=this.createRenderPipeline({topology:Rs.TRIANGLES,sampleCount:1,program:this.blitProgram,colorAttachmentFormats:[te.U8_RGBA_RT],depthStencilAttachmentFormat:null,inputLayout:this.blitInputLayout,megaStateDescriptor:$x(Hx)}),this.blitBindings=this.createBindings({samplerBindings:[{sampler:null,texture:t.texture}],uniformBufferBindings:[]}),this.blitProgram.setUniformsLegacy({u_Texture:t}));var n=this.currentRenderPassDescriptor;this.currentRenderPassDescriptor=null,this.inBlitRenderPass=!0;var i=this.createRenderPass({colorAttachment:[t],colorResolveTo:[r],colorClearColor:[i8t]}),a=this.getCanvas(),o=a.width,s=a.height;i.setPipeline(this.blitRenderPipeline),i.setBindings(this.blitBindings),i.setVertexInput(this.blitInputLayout,[{buffer:this.blitVertexBuffer}],null),i.setViewport(0,0,o,s),this.gl.disable(this.gl.BLEND),i.draw(3,0),this.gl.enable(this.gl.BLEND),this.currentRenderPassDescriptor=n,this.inBlitRenderPass=!1},e}(),s7t=function(){function e(t){this.pluginOptions=t}return e.prototype.createSwapChain=function(t){return au(this,void 0,void 0,function(){var r,n,i,a,o,s,l,u,c,f,d,v,g;return Lh(this,function(x){return r=this.pluginOptions,n=r.targets,i=r.xrCompatible,a=r.antialias,o=a===void 0?!1:a,s=r.preserveDrawingBuffer,l=s===void 0?!1:s,u=r.premultipliedAlpha,c=u===void 0?!0:u,f=r.shaderDebug,d=r.trackResources,v={antialias:o,preserveDrawingBuffer:l,stencil:!0,premultipliedAlpha:c,xrCompatible:i},this.handleContextEvents(t),n.includes("webgl2")&&(g=t.getContext("webgl2",v)||t.getContext("experimental-webgl2",v)),!g&&n.includes("webgl1")&&(g=t.getContext("webgl",v)||t.getContext("experimental-webgl",v)),[2,new o7t(g,{shaderDebug:f,trackResources:d})]})})},e.prototype.handleContextEvents=function(t){var r=this.pluginOptions,n=r.onContextLost,i=r.onContextRestored,a=r.onContextCreationError;a&&t.addEventListener("webglcontextcreationerror",a,!1),n&&t.addEventListener("webglcontextlost",n,!1),i&&t.addEventListener("webglcontextrestored",i,!1)},e}();let zo;const att=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&att.decode();let gw=null;function OA(){return(gw===null||gw.byteLength===0)&&(gw=new Uint8Array(zo.memory.buffer)),gw}function UM(e,t){return e=e>>>0,att.decode(OA().subarray(e,e+t))}const Xv=new Array(128).fill(void 0);Xv.push(void 0,null,!0,!1);let Dw=Xv.length;function l7t(e){Dw===Xv.length&&Xv.push(Xv.length+1);const t=Dw;return Dw=Xv[t],Xv[t]=e,t}function PA(e){return Xv[e]}function u7t(e){e<132||(Xv[e]=Dw,Dw=e)}function c7t(e){const t=PA(e);return u7t(e),t}let Gx=0;const DA=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},h7t=typeof DA.encodeInto=="function"?function(e,t){return DA.encodeInto(e,t)}:function(e,t){const r=DA.encode(e);return t.set(r),{read:e.length,written:r.length}};function $M(e,t,r){if(r===void 0){const s=DA.encode(e),l=t(s.length,1)>>>0;return OA().subarray(l,l+s.length).set(s),Gx=s.length,l}let n=e.length,i=t(n,1)>>>0;const a=OA();let o=0;for(;o<n;o++){const s=e.charCodeAt(o);if(s>127)break;a[i+o]=s}if(o!==n){o!==0&&(e=e.slice(o)),i=r(i,n,n=o+e.length*3,1)>>>0;const s=OA().subarray(i+o,i+n),l=h7t(e,s);o+=l.written}return Gx=o,i}let mw=null;function HM(){return(mw===null||mw.byteLength===0)&&(mw=new Int32Array(zo.memory.buffer)),mw}function f7t(e,t,r){let n,i;try{const s=zo.__wbindgen_add_to_stack_pointer(-16),l=$M(e,zo.__wbindgen_malloc,zo.__wbindgen_realloc),u=Gx,c=$M(t,zo.__wbindgen_malloc,zo.__wbindgen_realloc),f=Gx;zo.glsl_compile(s,l,u,c,f,r);var a=HM()[s/4+0],o=HM()[s/4+1];return n=a,i=o,UM(a,o)}finally{zo.__wbindgen_add_to_stack_pointer(16),zo.__wbindgen_free(n,i,1)}}class xC{static __wrap(t){t=t>>>0;const r=Object.create(xC.prototype);return r.__wbg_ptr=t,r}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,t}free(){const t=this.__destroy_into_raw();zo.__wbg_wgslcomposer_free(t)}constructor(){const t=zo.wgslcomposer_new();return xC.__wrap(t)}load_composable(t){const r=$M(t,zo.__wbindgen_malloc,zo.__wbindgen_realloc),n=Gx;zo.wgslcomposer_load_composable(this.__wbg_ptr,r,n)}wgsl_compile(t){let r,n;try{const o=zo.__wbindgen_add_to_stack_pointer(-16),s=$M(t,zo.__wbindgen_malloc,zo.__wbindgen_realloc),l=Gx;zo.wgslcomposer_wgsl_compile(o,this.__wbg_ptr,s,l);var i=HM()[o/4+0],a=HM()[o/4+1];return r=i,n=a,UM(i,a)}finally{zo.__wbindgen_add_to_stack_pointer(16),zo.__wbindgen_free(r,n,1)}}}async function d7t(e,t){if(typeof Response=="function"&&e instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(e,t)}catch(n){if(e.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",n);else throw n}const r=await e.arrayBuffer();return await WebAssembly.instantiate(r,t)}else{const r=await WebAssembly.instantiate(e,t);return r instanceof WebAssembly.Instance?{instance:r,module:e}:r}}function p7t(){const e={};return e.wbg={},e.wbg.__wbindgen_string_new=function(t,r){const n=UM(t,r);return l7t(n)},e.wbg.__wbindgen_object_drop_ref=function(t){c7t(t)},e.wbg.__wbg_log_1d3ae0273d8f4f8a=function(t){console.log(PA(t))},e.wbg.__wbg_log_576ca876af0d4a77=function(t,r){console.log(PA(t),PA(r))},e.wbg.__wbindgen_throw=function(t,r){throw new Error(UM(t,r))},e}function v7t(e,t){return zo=e.exports,ott.__wbindgen_wasm_module=t,mw=null,gw=null,zo}async function ott(e){if(zo!==void 0)return zo;const t=p7t();(typeof e=="string"||typeof Request=="function"&&e instanceof Request||typeof URL=="function"&&e instanceof URL)&&(e=fetch(e));const{instance:r,module:n}=await d7t(await e,t);return v7t(r,n)}var Js;(function(e){e[e.COPY_SRC=1]="COPY_SRC",e[e.COPY_DST=2]="COPY_DST",e[e.TEXTURE_BINDING=4]="TEXTURE_BINDING",e[e.STORAGE_BINDING=8]="STORAGE_BINDING",e[e.STORAGE=8]="STORAGE",e[e.RENDER_ATTACHMENT=16]="RENDER_ATTACHMENT"})(Js||(Js={}));var KD;(function(e){e[e.READ=1]="READ",e[e.WRITE=2]="WRITE"})(KD||(KD={}));function g7t(e){var t=0;return e&Du.SAMPLED&&(t|=Js.TEXTURE_BINDING|Js.COPY_DST|Js.COPY_SRC),e&Du.STORAGE&&(t|=Js.TEXTURE_BINDING|Js.STORAGE_BINDING|Js.COPY_SRC|Js.COPY_DST),e&Du.RENDER_TARGET&&(t|=Js.RENDER_ATTACHMENT|Js.TEXTURE_BINDING|Js.COPY_SRC|Js.COPY_DST),t}function O4(e){if(e===te.U8_R_NORM)return"r8unorm";if(e===te.S8_R_NORM)return"r8snorm";if(e===te.U8_RG_NORM)return"rg8unorm";if(e===te.S8_RG_NORM)return"rg8snorm";if(e===te.U32_R)return"r32uint";if(e===te.S32_R)return"r32sint";if(e===te.F32_R)return"r32float";if(e===te.U16_RG)return"rg16uint";if(e===te.S16_RG)return"rg16sint";if(e===te.F16_RG)return"rg16float";if(e===te.U8_RGBA_RT)return"bgra8unorm";if(e===te.U8_RGBA_RT_SRGB)return"bgra8unorm-srgb";if(e===te.U8_RGBA_NORM)return"rgba8unorm";if(e===te.U8_RGBA_SRGB)return"rgba8unorm-srgb";if(e===te.S8_RGBA_NORM)return"rgba8snorm";if(e===te.U32_RG)return"rg32uint";if(e===te.S32_RG)return"rg32sint";if(e===te.F32_RG)return"rg32float";if(e===te.U16_RGBA)return"rgba16uint";if(e===te.S16_RGBA)return"rgba16sint";if(e===te.F16_RGBA)return"rgba16float";if(e===te.F32_RGBA)return"rgba32float";if(e===te.U32_RGBA)return"rgba32uint";if(e===te.S32_RGBA)return"rgba32sint";if(e===te.D24)return"depth24plus";if(e===te.D24_S8)return"depth24plus-stencil8";if(e===te.D32F)return"depth32float";if(e===te.D32F_S8)return"depth32float-stencil8";if(e===te.BC1)return"bc1-rgba-unorm";if(e===te.BC1_SRGB)return"bc1-rgba-unorm-srgb";if(e===te.BC2)return"bc2-rgba-unorm";if(e===te.BC2_SRGB)return"bc2-rgba-unorm-srgb";if(e===te.BC3)return"bc3-rgba-unorm";if(e===te.BC3_SRGB)return"bc3-rgba-unorm-srgb";if(e===te.BC4_SNORM)return"bc4-r-snorm";if(e===te.BC4_UNORM)return"bc4-r-unorm";if(e===te.BC5_SNORM)return"bc5-rg-snorm";if(e===te.BC5_UNORM)return"bc5-rg-unorm";throw"whoops"}function m7t(e){if(e===Oi.TEXTURE_2D)return"2d";if(e===Oi.TEXTURE_CUBE_MAP)return"2d";if(e===Oi.TEXTURE_2D_ARRAY)return"2d";if(e===Oi.TEXTURE_3D)return"3d";throw new Error("whoops")}function y7t(e){if(e===Oi.TEXTURE_2D)return"2d";if(e===Oi.TEXTURE_CUBE_MAP)return"cube";if(e===Oi.TEXTURE_2D_ARRAY)return"2d-array";if(e===Oi.TEXTURE_3D)return"3d";throw new Error("whoops")}function _7t(e){var t=0;return e&Na.INDEX&&(t|=GPUBufferUsage.INDEX),e&Na.VERTEX&&(t|=GPUBufferUsage.VERTEX),e&Na.UNIFORM&&(t|=GPUBufferUsage.UNIFORM),e&Na.STORAGE&&(t|=GPUBufferUsage.STORAGE),e&Na.COPY_SRC&&(t|=GPUBufferUsage.COPY_SRC),e&Na.INDIRECT&&(t|=GPUBufferUsage.INDIRECT),t|=GPUBufferUsage.COPY_DST,t}function MO(e){if(e===ac.CLAMP_TO_EDGE)return"clamp-to-edge";if(e===ac.REPEAT)return"repeat";if(e===ac.MIRRORED_REPEAT)return"mirror-repeat";throw new Error("whoops")}function iH(e){if(e===ts.BILINEAR)return"linear";if(e===ts.POINT)return"nearest";throw new Error("whoops")}function x7t(e){if(e===el.LINEAR)return"linear";if(e===el.NEAREST)return"nearest";if(e===el.NO_MIP)return"nearest";throw new Error("whoops")}function q1(e){var t=e;return t.gpuBuffer}function b7t(e){var t=e;return t.gpuSampler}function E7t(e){var t=e;return t.querySet}function w7t(e){if(e===FM.OcclusionConservative)return"occlusion";throw new Error("whoops")}function C7t(e){switch(e){case Rs.TRIANGLES:return"triangle-list";case Rs.POINTS:return"point-list";case Rs.TRIANGLE_STRIP:return"triangle-strip";case Rs.LINES:return"line-list";case Rs.LINE_STRIP:return"line-strip";default:throw new Error("Unknown primitive topology mode")}}function S7t(e){if(e===Vc.NONE)return"none";if(e===Vc.FRONT)return"front";if(e===Vc.BACK)return"back";throw new Error("whoops")}function T7t(e){if(e===_C.CCW)return"ccw";if(e===_C.CW)return"cw";throw new Error("whoops")}function A7t(e,t){return{topology:C7t(e),cullMode:S7t(t.cullMode),frontFace:T7t(t.frontFace)}}function aH(e){if(e===Li.ZERO)return"zero";if(e===Li.ONE)return"one";if(e===Li.SRC)return"src";if(e===Li.ONE_MINUS_SRC)return"one-minus-src";if(e===Li.DST)return"dst";if(e===Li.ONE_MINUS_DST)return"one-minus-dst";if(e===Li.SRC_ALPHA)return"src-alpha";if(e===Li.ONE_MINUS_SRC_ALPHA)return"one-minus-src-alpha";if(e===Li.DST_ALPHA)return"dst-alpha";if(e===Li.ONE_MINUS_DST_ALPHA)return"one-minus-dst-alpha";if(e===Li.CONST)return"constant";if(e===Li.ONE_MINUS_CONSTANT)return"one-minus-constant";if(e===Li.SRC_ALPHA_SATURATE)return"src-alpha-saturated";throw new Error("whoops")}function M7t(e){if(e===ml.ADD)return"add";if(e===ml.SUBSTRACT)return"subtract";if(e===ml.REVERSE_SUBSTRACT)return"reverse-subtract";if(e===ml.MIN)return"min";if(e===ml.MAX)return"max";throw new Error("whoops")}function oH(e){return{operation:M7t(e.blendMode),srcFactor:aH(e.blendSrcFactor),dstFactor:aH(e.blendDstFactor)}}function sH(e){return e.blendMode===ml.ADD&&e.blendSrcFactor===Li.ONE&&e.blendDstFactor===Li.ZERO}function R7t(e){if(!(sH(e.rgbBlendState)&&sH(e.alphaBlendState)))return{color:oH(e.rgbBlendState),alpha:oH(e.alphaBlendState)}}function I7t(e,t){return{format:O4(t),blend:R7t(e),writeMask:e.channelWriteMask}}function L7t(e,t){return t.attachmentsState.map(function(r,n){return I7t(r,e[n])})}function FA(e){if(e===pa.NEVER)return"never";if(e===pa.LESS)return"less";if(e===pa.EQUAL)return"equal";if(e===pa.LEQUAL)return"less-equal";if(e===pa.GREATER)return"greater";if(e===pa.NOTEQUAL)return"not-equal";if(e===pa.GEQUAL)return"greater-equal";if(e===pa.ALWAYS)return"always";throw new Error("whoops")}function M1(e){if(e===$o.KEEP)return"keep";if(e===$o.REPLACE)return"replace";if(e===$o.ZERO)return"zero";if(e===$o.DECREMENT_CLAMP)return"decrement-clamp";if(e===$o.DECREMENT_WRAP)return"decrement-wrap";if(e===$o.INCREMENT_CLAMP)return"increment-clamp";if(e===$o.INCREMENT_WRAP)return"increment-wrap";if(e===$o.INVERT)return"invert";throw new Error("whoops")}function O7t(e,t){if(!kf(e))return{format:O4(e),depthWriteEnabled:!!t.depthWrite,depthCompare:FA(t.depthCompare),depthBias:t.polygonOffset?t.polygonOffsetUnits:0,depthBiasSlopeScale:t.polygonOffset?t.polygonOffsetFactor:0,stencilFront:{compare:FA(t.stencilFront.compare),passOp:M1(t.stencilFront.passOp),failOp:M1(t.stencilFront.failOp),depthFailOp:M1(t.stencilFront.depthFailOp)},stencilBack:{compare:FA(t.stencilBack.compare),passOp:M1(t.stencilBack.passOp),failOp:M1(t.stencilBack.failOp),depthFailOp:M1(t.stencilBack.depthFailOp)},stencilReadMask:4294967295,stencilWriteMask:4294967295}}function P7t(e){if(e!==null){if(e===te.U16_R)return"uint16";if(e===te.U32_R)return"uint32";throw new Error("whoops")}}function D7t(e){if(e===Qy.VERTEX)return"vertex";if(e===Qy.INSTANCE)return"instance";throw new Error("whoops")}function F7t(e){if(e===te.U8_R)return"uint8x2";if(e===te.U8_RG)return"uint8x2";if(e===te.U8_RGB)return"uint8x4";if(e===te.U8_RGBA)return"uint8x4";if(e===te.U8_RG_NORM)return"unorm8x2";if(e===te.U8_RGBA_NORM)return"unorm8x4";if(e===te.S8_RGB_NORM)return"snorm8x4";if(e===te.S8_RGBA_NORM)return"snorm8x4";if(e===te.U16_RG_NORM)return"unorm16x2";if(e===te.U16_RGBA_NORM)return"unorm16x4";if(e===te.S16_RG_NORM)return"snorm16x2";if(e===te.S16_RGBA_NORM)return"snorm16x4";if(e===te.S16_RG)return"uint16x2";if(e===te.F16_RG)return"float16x2";if(e===te.F16_RGBA)return"float16x4";if(e===te.F32_R)return"float32";if(e===te.F32_RG)return"float32x2";if(e===te.F32_RGB)return"float32x3";if(e===te.F32_RGBA)return"float32x4";throw"whoops"}function B7t(e){var t=Qp(e);switch(t){case Ge.BC1:case Ge.BC2:case Ge.BC3:case Ge.BC4_SNORM:case Ge.BC4_UNORM:case Ge.BC5_SNORM:case Ge.BC5_UNORM:return!0;default:return!1}}function N7t(e){var t=Qp(e);switch(t){case Ge.BC1:case Ge.BC2:case Ge.BC3:case Ge.BC4_SNORM:case Ge.BC4_UNORM:case Ge.BC5_SNORM:case Ge.BC5_UNORM:return 4;default:return 1}}function lH(e,t,r,n){switch(r===void 0&&(r=!1),e){case te.S8_R:case te.S8_R_NORM:case te.S8_RG_NORM:case te.S8_RGB_NORM:case te.S8_RGBA_NORM:{var i=t instanceof ArrayBuffer?new Int8Array(t):new Int8Array(t);return n&&i.set(new Int8Array(n)),i}case te.U8_R:case te.U8_R_NORM:case te.U8_RG:case te.U8_RG_NORM:case te.U8_RGB:case te.U8_RGB_NORM:case te.U8_RGB_SRGB:case te.U8_RGBA:case te.U8_RGBA_NORM:case te.U8_RGBA_SRGB:{var a=t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t);return n&&a.set(new Uint8Array(n)),a}case te.S16_R:case te.S16_RG:case te.S16_RG_NORM:case te.S16_RGB_NORM:case te.S16_RGBA:case te.S16_RGBA_NORM:{var o=t instanceof ArrayBuffer?new Int16Array(t):new Int16Array(r?t/2:t);return n&&o.set(new Int16Array(n)),o}case te.U16_R:case te.U16_RGB:case te.U16_RGBA_5551:case te.U16_RGBA_NORM:case te.U16_RG_NORM:case te.U16_R_NORM:{var s=t instanceof ArrayBuffer?new Uint16Array(t):new Uint16Array(r?t/2:t);return n&&s.set(new Uint16Array(n)),s}case te.S32_R:{var l=t instanceof ArrayBuffer?new Int32Array(t):new Int32Array(r?t/4:t);return n&&l.set(new Int32Array(n)),l}case te.U32_R:case te.U32_RG:{var u=t instanceof ArrayBuffer?new Uint32Array(t):new Uint32Array(r?t/4:t);return n&&u.set(new Uint32Array(n)),u}case te.F32_R:case te.F32_RG:case te.F32_RGB:case te.F32_RGBA:{var c=t instanceof ArrayBuffer?new Float32Array(t):new Float32Array(r?t/4:t);return n&&c.set(new Float32Array(n)),c}}var f=t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t);return n&&f.set(new Uint8Array(n)),f}function k7t(e){var t=(e&32768)>>15,r=(e&31744)>>10,n=e&1023;return r===0?(t?-1:1)*Math.pow(2,-14)*(n/Math.pow(2,10)):r==31?n?NaN:(t?-1:1)*(1/0):(t?-1:1)*Math.pow(2,r-15)*(1+n/Math.pow(2,10))}function stt(e){switch(e){case"r8unorm":case"r8snorm":case"r8uint":case"r8sint":return{width:1,height:1,length:1};case"r16uint":case"r16sint":case"r16float":case"rg8unorm":case"rg8snorm":case"rg8uint":case"rg8sint":return{width:1,height:1,length:2};case"r32uint":case"r32sint":case"r32float":case"rg16uint":case"rg16sint":case"rg16float":case"rgba8unorm":case"rgba8unorm-srgb":case"rgba8snorm":case"rgba8uint":case"rgba8sint":case"bgra8unorm":case"bgra8unorm-srgb":case"rgb9e5ufloat":case"rgb10a2unorm":case"rg11b10ufloat":return{width:1,height:1,length:4};case"rg32uint":case"rg32sint":case"rg32float":case"rgba16uint":case"rgba16sint":case"rgba16float":return{width:1,height:1,length:8};case"rgba32uint":case"rgba32sint":case"rgba32float":return{width:1,height:1,length:16};case"stencil8":throw new Error("No fixed size for Stencil8 format!");case"depth16unorm":return{width:1,height:1,length:2};case"depth24plus":throw new Error("No fixed size for Depth24Plus format!");case"depth24plus-stencil8":throw new Error("No fixed size for Depth24PlusStencil8 format!");case"depth32float":return{width:1,height:1,length:4};case"depth32float-stencil8":return{width:1,height:1,length:5};case"bc7-rgba-unorm":case"bc7-rgba-unorm-srgb":case"bc6h-rgb-ufloat":case"bc6h-rgb-float":case"bc2-rgba-unorm":case"bc2-rgba-unorm-srgb":case"bc3-rgba-unorm":case"bc3-rgba-unorm-srgb":case"bc5-rg-unorm":case"bc5-rg-snorm":return{width:4,height:4,length:16};case"bc4-r-unorm":case"bc4-r-snorm":case"bc1-rgba-unorm":case"bc1-rgba-unorm-srgb":return{width:4,height:4,length:8};default:return{width:1,height:1,length:4}}}var Yd=function(e){Ut(t,e);function t(r){var n=r.id,i=r.device,a=e.call(this)||this;return a.id=n,a.device=i,a}return t.prototype.destroy=function(){},t}(XJ),z7t=function(e){Ut(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,o,s,l=e.call(this,{id:n,device:i})||this;l.type=Qi.Bindings;var u=a.pipeline;ri(!!u);var c=a.uniformBufferBindings,f=a.storageBufferBindings,d=a.samplerBindings,v=a.storageTextureBindings;l.numUniformBuffers=(c==null?void 0:c.length)||0;var g=[[],[],[],[]],x=0;if(c&&c.length)for(var w=0;w<c.length;w++){var S=a.uniformBufferBindings[w],A=S.binding,M=S.size,R=S.offset,O=S.buffer,N={buffer:q1(O),offset:R??0,size:M};g[0].push({binding:A??x++,resource:N})}if(d&&d.length){x=0;for(var w=0;w<d.length;w++){var k=U(U({},d[w]),ett),A=a.samplerBindings[w],V=A.texture!==null?A.texture:l.device.getFallbackTexture(k);k.dimension=V.dimension,k.formatKind=ZJ(V.format);var Q=V.gpuTextureView;if(g[1].push({binding:(o=A.textureBinding)!==null&&o!==void 0?o:x++,resource:Q}),A.samplerBinding!==-1){var Y=A.sampler!==null?A.sampler:l.device.getFallbackSampler(k),X=b7t(Y);g[1].push({binding:(s=A.samplerBinding)!==null&&s!==void 0?s:x++,resource:X})}}}if(f&&f.length){x=0;for(var w=0;w<f.length;w++){var tt=a.storageBufferBindings[w],A=tt.binding,M=tt.size,R=tt.offset,O=tt.buffer,N={buffer:q1(O),offset:R??0,size:M};g[2].push({binding:A??x++,resource:N})}}if(v&&v.length){x=0;for(var w=0;w<v.length;w++){var it=a.storageTextureBindings[w],A=it.binding,V=it.texture,Q=V.gpuTextureView;g[3].push({binding:A??x++,resource:Q})}}var Et=g.findLastIndex(function(Tt){return!!Tt.length});return l.gpuBindGroup=g.map(function(Tt,pt){return pt<=Et&&l.device.device.createBindGroup({layout:u.getBindGroupLayout(pt),entries:Tt})}),l}return t}(Yd),U7t=function(e){Ut(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,o=e.call(this,{id:n,device:i})||this;o.type=Qi.Buffer;var s=a.usage,l=a.viewOrSize,u=!!(s&Na.MAP_READ);o.usage=_7t(s),u&&(o.usage=Na.MAP_READ|Na.COPY_DST);var c=!Y1(l);if(o.view=Y1(l)?null:l,o.size=Y1(l)?NM(l,4):NM(l.byteLength,4),Y1(l))o.gpuBuffer=o.device.device.createBuffer({usage:o.usage,size:o.size,mappedAtCreation:u?c:!1});else{o.gpuBuffer=o.device.device.createBuffer({usage:o.usage,size:o.size,mappedAtCreation:!0});var f=l&&l.constructor||Float32Array;new f(o.gpuBuffer.getMappedRange()).set(l),o.gpuBuffer.unmap()}return o}return t.prototype.setSubData=function(r,n,i,a){i===void 0&&(i=0),a===void 0&&(a=0);var o=this.gpuBuffer;a=a||n.byteLength,a=Math.min(a,this.size-r);var s=n.byteOffset+i,l=s+a,u=a+3&-4;if(u!==a){var c=new Uint8Array(n.buffer.slice(s,l));n=new Uint8Array(u),n.set(c),i=0,s=0,l=u,a=u}for(var f=1024*1024*15,d=0;l-(s+d)>f;)this.device.device.queue.writeBuffer(o,r+d,n.buffer,s+d,f),d+=f;this.device.device.queue.writeBuffer(o,r+d,n.buffer,s+d,a-d)},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.gpuBuffer.destroy()},t}(Yd),uH=function(){function e(){this.gpuComputePassEncoder=null}return e.prototype.dispatchWorkgroups=function(t,r,n){this.gpuComputePassEncoder.dispatchWorkgroups(t,r,n)},e.prototype.dispatchWorkgroupsIndirect=function(t,r){this.gpuComputePassEncoder.dispatchWorkgroupsIndirect(t.gpuBuffer,r)},e.prototype.finish=function(){this.gpuComputePassEncoder.end(),this.gpuComputePassEncoder=null,this.frameCommandEncoder=null},e.prototype.beginComputePass=function(t){ri(this.gpuComputePassEncoder===null),this.frameCommandEncoder=t,this.gpuComputePassEncoder=this.frameCommandEncoder.beginComputePass(this.gpuComputePassDescriptor)},e.prototype.setPipeline=function(t){var r=t,n=Ey(r.gpuComputePipeline);this.gpuComputePassEncoder.setPipeline(n)},e.prototype.setBindings=function(t){var r=this,n=t;n.gpuBindGroup.forEach(function(i,a){i&&r.gpuComputePassEncoder.setBindGroup(a,n.gpuBindGroup[a])})},e.prototype.pushDebugGroup=function(t){this.gpuComputePassEncoder.pushDebugGroup(t)},e.prototype.popDebugGroup=function(){this.gpuComputePassEncoder.popDebugGroup()},e.prototype.insertDebugMarker=function(t){this.gpuComputePassEncoder.insertDebugMarker(t)},e}(),$7t=function(e){Ut(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,o=e.call(this,{id:n,device:i})||this;o.type=Qi.ComputePipeline,o.gpuComputePipeline=null,o.descriptor=a;var s=a.program,l=s.computeStage;if(l===null)return o;var u={layout:"auto",compute:U({},l)};return o.gpuComputePipeline=o.device.device.createComputePipeline(u),o.name!==void 0&&(o.gpuComputePipeline.label=o.name),o}return t.prototype.getBindGroupLayout=function(r){return this.gpuComputePipeline.getBindGroupLayout(r)},t}(Yd),H7t=function(e){Ut(t,e);function t(r){var n,i,a,o,s=r.id,l=r.device,u=r.descriptor,c=e.call(this,{id:s,device:l})||this;c.type=Qi.InputLayout;var f=[];try{for(var d=mi(u.vertexBufferDescriptors),v=d.next();!v.done;v=d.next()){var g=v.value,x=g.arrayStride,w=g.stepMode,S=g.attributes;f.push({arrayStride:x,stepMode:D7t(w),attributes:[]});try{for(var A=(a=void 0,mi(S)),M=A.next();!M.done;M=A.next()){var R=M.value,O=R.shaderLocation,N=R.format,k=R.offset;f[f.length-1].attributes.push({shaderLocation:O,format:F7t(N),offset:k})}}catch(V){a={error:V}}finally{try{M&&!M.done&&(o=A.return)&&o.call(A)}finally{if(a)throw a.error}}}}catch(V){n={error:V}}finally{try{v&&!v.done&&(i=d.return)&&i.call(d)}finally{if(n)throw n.error}}return c.indexFormat=P7t(u.indexBufferFormat),c.buffers=f,c}return t}(Yd),cH=function(e){Ut(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,o=e.call(this,{id:n,device:i})||this;return o.type=Qi.Program,o.vertexStage=null,o.fragmentStage=null,o.computeStage=null,o.descriptor=a,a.vertex&&(o.vertexStage=o.createShaderStage(a.vertex,"vertex")),a.fragment&&(o.fragmentStage=o.createShaderStage(a.fragment,"fragment")),a.compute&&(o.computeStage=o.createShaderStage(a.compute,"compute")),o}return t.prototype.setUniformsLegacy=function(r){},t.prototype.createShaderStage=function(r,n){var i,a,o=r.glsl,s=r.wgsl,l=r.entryPoint,u=r.postprocess,c=!1,f=s;if(!f)try{f=this.device.glsl_compile(o,n,c)}catch(S){throw console.error(S,o),new Error("whoops")}var d=function(S){if(!f.includes(S))return"continue";f=f.replace("var T_".concat(S,": texture_2d<f32>;"),"var T_".concat(S,": texture_depth_2d;")),f=f.replace(new RegExp("textureSample\\(T_".concat(S,"(.*)\\);$"),"gm"),function(A,M){return"vec4<f32>(textureSample(T_".concat(S).concat(M,"), 0.0, 0.0, 0.0);")})};try{for(var v=mi(["u_TextureFramebufferDepth"]),g=v.next();!g.done;g=v.next()){var x=g.value;d(x)}}catch(S){i={error:S}}finally{try{g&&!g.done&&(a=v.return)&&a.call(v)}finally{if(i)throw i.error}}u&&(f=u(f));var w=this.device.device.createShaderModule({code:f});return{module:w,entryPoint:l||"main"}},t}(Yd),V7t=function(e){Ut(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,o=e.call(this,{id:n,device:i})||this;o.type=Qi.QueryPool;var s=a.elemCount,l=a.type;return o.querySet=o.device.device.createQuerySet({type:w7t(l),count:s}),o.resolveBuffer=o.device.device.createBuffer({size:s*8,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),o.cpuBuffer=o.device.device.createBuffer({size:s*8,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),o.results=null,o}return t.prototype.queryResultOcclusion=function(r){return this.results===null?null:this.results[r]!==BigInt(0)},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.querySet.destroy(),this.resolveBuffer.destroy(),this.cpuBuffer.destroy()},t}(Yd),G7t=function(e){Ut(t,e);function t(r){var n=r.id,i=r.device,a=e.call(this,{id:n,device:i})||this;return a.type=Qi.Readback,a}return t.prototype.readTexture=function(r,n,i,a,o,s,l,u){return l===void 0&&(l=0),au(this,void 0,void 0,function(){var c,f,d,v,g,x,w,S;return Lh(this,function(A){return c=r,f=0,d=stt(c.gpuTextureformat),v=Math.ceil(a/d.width)*d.length,g=Math.ceil(v/256)*256,x=g*o,w=this.device.createBuffer({usage:Na.STORAGE|Na.MAP_READ|Na.COPY_DST,hint:Fd.STATIC,viewOrSize:x}),S=this.device.device.createCommandEncoder(),S.copyTextureToBuffer({texture:c.gpuTexture,mipLevel:0,origin:{x:n,y:i,z:Math.max(f,0)}},{buffer:w.gpuBuffer,offset:0,bytesPerRow:g},{width:a,height:o,depthOrArrayLayers:1}),this.device.device.queue.submit([S.finish()]),[2,this.readBuffer(w,0,s.byteLength===x?s:null,l,x,c.format,!0,!1,v,g,o)]})})},t.prototype.readTextureSync=function(r,n,i,a,o,s,l,u){throw new Error("ERROR_MSG_METHOD_NOT_IMPLEMENTED")},t.prototype.readBuffer=function(r,n,i,a,o,s,l,u,c,f,d){var v=this;n===void 0&&(n=0),i===void 0&&(i=null),o===void 0&&(o=0),s===void 0&&(s=te.U8_RGB),l===void 0&&(l=!1),c===void 0&&(c=0),f===void 0&&(f=0),d===void 0&&(d=0);var g=r,x=o||g.size,w=i||g.view,S=w&&w.constructor&&w.constructor.BYTES_PER_ELEMENT||YJ(s),A=g;if(!(g.usage&Na.MAP_READ&&g.usage&Na.COPY_DST)){var M=this.device.device.createCommandEncoder();A=this.device.createBuffer({usage:Na.STORAGE|Na.MAP_READ|Na.COPY_DST,hint:Fd.STATIC,viewOrSize:x}),M.copyBufferToBuffer(g.gpuBuffer,n,A.gpuBuffer,0,x),this.device.device.queue.submit([M.finish()])}return new Promise(function(R,O){A.gpuBuffer.mapAsync(KD.READ,n,x).then(function(){var N=A.gpuBuffer.getMappedRange(n,x),k=w;if(l)k===null?k=lH(s,x,!0,N):k=lH(s,k.buffer,void 0,N);else if(k===null)switch(S){case 1:k=new Uint8Array(x),k.set(new Uint8Array(N));break;case 2:k=v.getHalfFloatAsFloatRGBAArrayBuffer(x/2,N);break;case 4:k=new Float32Array(x/4),k.set(new Float32Array(N));break}else switch(S){case 1:k=new Uint8Array(k.buffer),k.set(new Uint8Array(N));break;case 2:k=v.getHalfFloatAsFloatRGBAArrayBuffer(x/2,N,w);break;case 4:var V=w&&w.constructor||Float32Array;k=new V(k.buffer),k.set(new V(N));break}if(c!==f){S===1&&!l&&(c*=2,f*=2);for(var Q=new Uint8Array(k.buffer),Y=c,X=0,tt=1;tt<d;++tt){X=tt*f;for(var it=0;it<c;++it)Q[Y++]=Q[X++]}S!==0&&!l?k=new Float32Array(Q.buffer,0,Y/4):k=new Uint8Array(Q.buffer,0,Y)}A.gpuBuffer.unmap(),R(k)},function(N){return O(N)})})},t.prototype.getHalfFloatAsFloatRGBAArrayBuffer=function(r,n,i){i||(i=new Float32Array(r));for(var a=new Uint16Array(n);r--;)i[r]=k7t(a[r]);return i},t}(Yd),hH=function(){function e(t){this.device=t,this.gpuRenderPassEncoder=null,this.gfxColorAttachment=[],this.gfxColorAttachmentLevel=[],this.gfxColorResolveTo=[],this.gfxColorResolveToLevel=[],this.gfxDepthStencilAttachment=null,this.gfxDepthStencilResolveTo=null,this.gpuColorAttachments=[],this.gpuDepthStencilAttachment={view:null,depthLoadOp:"load",depthStoreOp:"store",stencilLoadOp:"load",stencilStoreOp:"store"},this.gpuRenderPassDescriptor={colorAttachments:this.gpuColorAttachments,depthStencilAttachment:this.gpuDepthStencilAttachment}}return e.prototype.getEncoder=function(){var t;return((t=this.renderBundle)===null||t===void 0?void 0:t.renderBundleEncoder)||this.gpuRenderPassEncoder},e.prototype.getTextureView=function(t,r){return ri(r<t.mipLevelCount),t.mipLevelCount===1?t.gpuTextureView:t.gpuTexture.createView({baseMipLevel:r,mipLevelCount:1})},e.prototype.setRenderPassDescriptor=function(t){var r,n,i,a,o,s;this.descriptor=t,this.gpuRenderPassDescriptor.colorAttachments=this.gpuColorAttachments;var l=t.colorAttachment.length;this.gfxColorAttachment.length=l,this.gfxColorResolveTo.length=l;for(var u=0;u<t.colorAttachment.length;u++){var c=t.colorAttachment[u],f=t.colorResolveTo[u];if(c===null&&f!==null&&(c=f,f=null),this.gfxColorAttachment[u]=c,this.gfxColorResolveTo[u]=f,this.gfxColorAttachmentLevel[u]=((r=t.colorAttachmentLevel)===null||r===void 0?void 0:r[u])||0,this.gfxColorResolveToLevel[u]=((n=t.colorResolveToLevel)===null||n===void 0?void 0:n[u])||0,c!==null){this.gpuColorAttachments[u]===void 0&&(this.gpuColorAttachments[u]={});var d=this.gpuColorAttachments[u];d.view=this.getTextureView(c,((i=this.gfxColorAttachmentLevel)===null||i===void 0?void 0:i[u])||0);var v=(o=(a=t.colorClearColor)===null||a===void 0?void 0:a[u])!==null&&o!==void 0?o:"load";v==="load"?d.loadOp="load":(d.loadOp="clear",d.clearValue=v),d.storeOp=!((s=t.colorStore)===null||s===void 0)&&s[u]?"store":"discard",d.resolveTarget=void 0,f!==null&&(c.sampleCount>1?d.resolveTarget=this.getTextureView(f,this.gfxColorResolveToLevel[u]):d.storeOp="store")}else{this.gpuColorAttachments.length=u,this.gfxColorAttachment.length=u,this.gfxColorResolveTo.length=u;break}}if(this.gfxDepthStencilAttachment=t.depthStencilAttachment,this.gfxDepthStencilResolveTo=t.depthStencilResolveTo,t.depthStencilAttachment){var g=t.depthStencilAttachment,d=this.gpuDepthStencilAttachment;d.view=g.gpuTextureView;var x=!!(Ux(g.format)&Fr.Depth);x?(t.depthClearValue==="load"?d.depthLoadOp="load":(d.depthLoadOp="clear",d.depthClearValue=t.depthClearValue),t.depthStencilStore||this.gfxDepthStencilResolveTo!==null?d.depthStoreOp="store":d.depthStoreOp="discard"):(d.depthLoadOp=void 0,d.depthStoreOp=void 0);var w=!!(Ux(g.format)&Fr.Stencil);w?(t.stencilClearValue==="load"?d.stencilLoadOp="load":(d.stencilLoadOp="clear",d.stencilClearValue=t.stencilClearValue),t.depthStencilStore||this.gfxDepthStencilResolveTo!==null?d.stencilStoreOp="store":d.stencilStoreOp="discard"):(d.stencilLoadOp=void 0,d.stencilStoreOp=void 0),this.gpuRenderPassDescriptor.depthStencilAttachment=this.gpuDepthStencilAttachment}else this.gpuRenderPassDescriptor.depthStencilAttachment=void 0;this.gpuRenderPassDescriptor.occlusionQuerySet=kf(t.occlusionQueryPool)?void 0:E7t(t.occlusionQueryPool)},e.prototype.beginRenderPass=function(t,r){ri(this.gpuRenderPassEncoder===null),this.setRenderPassDescriptor(r),this.frameCommandEncoder=t,this.gpuRenderPassEncoder=this.frameCommandEncoder.beginRenderPass(this.gpuRenderPassDescriptor)},e.prototype.flipY=function(t,r){var n=this.device.swapChainHeight;return n-t-r},e.prototype.setViewport=function(t,r,n,i,a,o){a===void 0&&(a=0),o===void 0&&(o=1),this.gpuRenderPassEncoder.setViewport(t,this.flipY(r,i),n,i,a,o)},e.prototype.setScissorRect=function(t,r,n,i){this.gpuRenderPassEncoder.setScissorRect(t,this.flipY(r,i),n,i)},e.prototype.setPipeline=function(t){var r=t,n=Ey(r.gpuRenderPipeline);this.getEncoder().setPipeline(n)},e.prototype.setVertexInput=function(t,r,n){if(t!==null){var i=this.getEncoder(),a=t;n!==null&&i.setIndexBuffer(q1(n.buffer),Ey(a.indexFormat),n.offset);for(var o=0;o<r.length;o++){var s=r[o];s!==null&&i.setVertexBuffer(o,q1(s.buffer),s.offset)}}},e.prototype.setBindings=function(t){var r=t,n=this.getEncoder();r.gpuBindGroup.forEach(function(i,a){i&&n.setBindGroup(a,r.gpuBindGroup[a])})},e.prototype.setStencilReference=function(t){this.gpuRenderPassEncoder.setStencilReference(t)},e.prototype.draw=function(t,r,n,i){this.getEncoder().draw(t,r,n,i)},e.prototype.drawIndexed=function(t,r,n,i,a){this.getEncoder().drawIndexed(t,r,n,i,a)},e.prototype.drawIndirect=function(t,r){this.getEncoder().drawIndirect(q1(t),r)},e.prototype.drawIndexedIndirect=function(t,r){this.getEncoder().drawIndexedIndirect(q1(t),r)},e.prototype.beginOcclusionQuery=function(t){this.gpuRenderPassEncoder.beginOcclusionQuery(t)},e.prototype.endOcclusionQuery=function(){this.gpuRenderPassEncoder.endOcclusionQuery()},e.prototype.pushDebugGroup=function(t){this.gpuRenderPassEncoder.pushDebugGroup(t)},e.prototype.popDebugGroup=function(){this.gpuRenderPassEncoder.popDebugGroup()},e.prototype.insertDebugMarker=function(t){this.gpuRenderPassEncoder.insertDebugMarker(t)},e.prototype.beginBundle=function(t){this.renderBundle=t},e.prototype.endBundle=function(){this.renderBundle.finish()},e.prototype.executeBundles=function(t){this.gpuRenderPassEncoder.executeBundles(t.map(function(r){return r.renderBundle}))},e.prototype.finish=function(){var t;(t=this.gpuRenderPassEncoder)===null||t===void 0||t.end(),this.gpuRenderPassEncoder=null;for(var r=0;r<this.gfxColorAttachment.length;r++){var n=this.gfxColorAttachment[r],i=this.gfxColorResolveTo[r];n!==null&&i!==null&&n.sampleCount===1&&this.copyAttachment(i,this.gfxColorAttachmentLevel[r],n,this.gfxColorResolveToLevel[r])}this.gfxDepthStencilAttachment&&this.gfxDepthStencilResolveTo&&(this.gfxDepthStencilAttachment.sampleCount>1||this.copyAttachment(this.gfxDepthStencilResolveTo,0,this.gfxDepthStencilAttachment,0)),this.frameCommandEncoder=null},e.prototype.copyAttachment=function(t,r,n,i){ri(n.sampleCount===1);var a={texture:n.gpuTexture,mipLevel:i},o={texture:t.gpuTexture,mipLevel:r};ri(n.width>>>i===t.width>>>r),ri(n.height>>>i===t.height>>>r),ri(!!(n.usage&Js.COPY_SRC)),ri(!!(t.usage&Js.COPY_DST)),this.frameCommandEncoder.copyTextureToTexture(a,o,[t.width,t.height,1])},e}(),W7t=function(e){Ut(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,o=e.call(this,{id:n,device:i})||this;return o.type=Qi.RenderPipeline,o.isCreatingAsync=!1,o.gpuRenderPipeline=null,o.descriptor=a,o.device.createRenderPipelineInternal(o,!1),o}return t.prototype.getBindGroupLayout=function(r){return this.gpuRenderPipeline.getBindGroupLayout(r)},t}(Yd),X7t=function(e){Ut(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,o,s,l=e.call(this,{id:n,device:i})||this;l.type=Qi.Sampler;var u=a.lodMinClamp,c=a.mipmapFilter===el.NO_MIP?a.lodMinClamp:a.lodMaxClamp,f=(o=a.maxAnisotropy)!==null&&o!==void 0?o:1;return f>1&&ri(a.minFilter===ts.BILINEAR&&a.magFilter===ts.BILINEAR&&a.mipmapFilter===el.LINEAR),l.gpuSampler=l.device.device.createSampler({addressModeU:MO(a.addressModeU),addressModeV:MO(a.addressModeV),addressModeW:MO((s=a.addressModeW)!==null&&s!==void 0?s:a.addressModeU),lodMinClamp:u,lodMaxClamp:c,minFilter:iH(a.minFilter),magFilter:iH(a.magFilter),mipmapFilter:x7t(a.mipmapFilter),compare:a.compareFunction!==void 0?FA(a.compareFunction):void 0,maxAnisotropy:f}),l}return t}(Yd),vT=function(e){Ut(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,o=r.skipCreate,s=r.sampleCount,l=e.call(this,{id:n,device:i})||this;l.type=Qi.Texture,l.flipY=!1;var u=a.format,c=a.dimension,f=a.width,d=a.height,v=a.depthOrArrayLayers,g=a.mipLevelCount,x=a.usage,w=a.pixelStore;return l.flipY=!!(w!=null&&w.unpackFlipY),l.device.createTextureShared({format:u,dimension:c??Oi.TEXTURE_2D,width:f,height:d,depthOrArrayLayers:v??1,mipLevelCount:g??1,usage:x,sampleCount:s??1},l,o),l}return t.prototype.textureFromImageBitmapOrCanvas=function(r,n,i){for(var a=n[0].width,o=n[0].height,s={size:{width:a,height:o,depthOrArrayLayers:i},format:"rgba8unorm",usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT},l=r.createTexture(s),u=0;u<n.length;u++)r.queue.copyExternalImageToTexture({source:n[u],flipY:this.flipY},{texture:l,origin:[0,0,u]},[a,o]);return[l,a,o]},t.prototype.isImageBitmapOrCanvases=function(r){var n=r[0];return n instanceof ImageBitmap||n instanceof HTMLCanvasElement||n instanceof OffscreenCanvas},t.prototype.isVideo=function(r){var n=r[0];return n instanceof HTMLVideoElement},t.prototype.setImageData=function(r,n){var i,a=this,o=this.device.device,s,l,u;if(this.isImageBitmapOrCanvases(r))i=Lr(this.textureFromImageBitmapOrCanvas(o,r,this.depthOrArrayLayers),3),s=i[0],l=i[1],u=i[2];else if(this.isVideo(r))s=o.importExternalTexture({source:r[0]});else{var c=stt(this.gpuTextureformat),f=Math.ceil(this.width/c.width)*c.length;r.forEach(function(d){o.queue.writeTexture({texture:a.gpuTexture},d,{bytesPerRow:f},{width:a.width,height:a.height})})}this.width=l,this.height=u,s&&(this.gpuTexture=s),this.gpuTextureView=this.gpuTexture.createView({dimension:y7t(this.dimension)})},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.gpuTexture.destroy()},t}(Yd),j7t=function(e){Ut(t,e);function t(r){var n=r.id,i=r.device,a=e.call(this,{id:n,device:i})||this;return a.type=Qi.RenderBundle,a.renderBundleEncoder=a.device.device.createRenderBundleEncoder({colorFormats:[a.device.swapChainFormat]}),a}return t.prototype.finish=function(){this.renderBundle=this.renderBundleEncoder.finish()},t}(Yd),Y7t=function(){function e(t,r,n,i,a,o){this.swapChainWidth=0,this.swapChainHeight=0,this.swapChainTextureUsage=Js.RENDER_ATTACHMENT|Js.COPY_DST,this._resourceUniqueId=0,this.renderPassPool=[],this.computePassPool=[],this.frameCommandEncoderPool=[],this.featureTextureCompressionBC=!1,this.platformString="WebGPU",this.glslVersion="#version 440",this.explicitBindingLocations=!0,this.separateSamplerTextures=!0,this.viewportOrigin=Od.UPPER_LEFT,this.clipSpaceNearZ=zx.ZERO,this.supportsSyncPipelineCompilation=!1,this.supportMRT=!0,this.device=r,this.canvas=n,this.canvasContext=i,this.glsl_compile=a,this.WGSLComposer=o,this.fallbackTexture2D=this.createFallbackTexture(Oi.TEXTURE_2D,Uo.Float),this.setResourceName(this.fallbackTexture2D,"Fallback Texture2D"),this.fallbackTexture2DDepth=this.createFallbackTexture(Oi.TEXTURE_2D,Uo.Depth),this.setResourceName(this.fallbackTexture2DDepth,"Fallback Depth Texture2D"),this.fallbackTexture2DArray=this.createFallbackTexture(Oi.TEXTURE_2D_ARRAY,Uo.Float),this.setResourceName(this.fallbackTexture2DArray,"Fallback Texture2DArray"),this.fallbackTexture3D=this.createFallbackTexture(Oi.TEXTURE_3D,Uo.Float),this.setResourceName(this.fallbackTexture3D,"Fallback Texture3D"),this.fallbackTextureCube=this.createFallbackTexture(Oi.TEXTURE_CUBE_MAP,Uo.Float),this.setResourceName(this.fallbackTextureCube,"Fallback TextureCube"),this.fallbackSamplerFiltering=this.createSampler({addressModeU:ac.REPEAT,addressModeV:ac.REPEAT,minFilter:ts.POINT,magFilter:ts.POINT,mipmapFilter:el.NEAREST}),this.setResourceName(this.fallbackSamplerFiltering,"Fallback Sampler Filtering"),this.fallbackSamplerComparison=this.createSampler({addressModeU:ac.REPEAT,addressModeV:ac.REPEAT,minFilter:ts.POINT,magFilter:ts.POINT,mipmapFilter:el.NEAREST,compareFunction:pa.ALWAYS}),this.setResourceName(this.fallbackSamplerComparison,"Fallback Sampler Comparison Filtering"),this.device.features&&(this.featureTextureCompressionBC=this.device.features.has("texture-compression-bc")),this.device.onuncapturederror=function(s){console.error(s.error)},this.swapChainFormat=navigator.gpu.getPreferredCanvasFormat(),this.canvasContext.configure({device:this.device,format:this.swapChainFormat,usage:this.swapChainTextureUsage,alphaMode:"premultiplied"})}return e.prototype.destroy=function(){},e.prototype.configureSwapChain=function(t,r){this.swapChainWidth===t&&this.swapChainHeight===r||(this.swapChainWidth=t,this.swapChainHeight=r)},e.prototype.getOnscreenTexture=function(){var t=this.canvasContext.getCurrentTexture(),r=t.createView(),n=new vT({id:0,device:this,descriptor:{format:te.U8_RGBA_RT,width:this.swapChainWidth,height:this.swapChainHeight,depthOrArrayLayers:0,dimension:Oi.TEXTURE_2D,mipLevelCount:1,usage:this.swapChainTextureUsage},skipCreate:!0});return n.depthOrArrayLayers=1,n.sampleCount=1,n.gpuTexture=t,n.gpuTextureView=r,n.name="Onscreen",this.setResourceName(n,"Onscreen Texture"),n},e.prototype.getDevice=function(){return this},e.prototype.getCanvas=function(){return this.canvas},e.prototype.beginFrame=function(){ri(this.frameCommandEncoderPool.length===0)},e.prototype.endFrame=function(){ri(this.frameCommandEncoderPool.every(function(t){return t!==null})),this.device.queue.submit(this.frameCommandEncoderPool.map(function(t){return t.finish()})),this.frameCommandEncoderPool=[]},e.prototype.getNextUniqueId=function(){return++this._resourceUniqueId},e.prototype.createBuffer=function(t){return new U7t({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createTexture=function(t){return new vT({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createSampler=function(t){return new X7t({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createRenderTarget=function(t){var r=new vT({id:this.getNextUniqueId(),device:this,descriptor:U(U({},t),{dimension:Oi.TEXTURE_2D,mipLevelCount:1,depthOrArrayLayers:1,usage:Du.RENDER_TARGET}),sampleCount:t.sampleCount});return r.depthOrArrayLayers=1,r.type=Qi.RenderTarget,r},e.prototype.createRenderTargetFromTexture=function(t){var r=t,n=r.format,i=r.width,a=r.height,o=r.depthOrArrayLayers,s=r.sampleCount,l=r.mipLevelCount,u=r.gpuTexture,c=r.gpuTextureView,f=r.usage;ri(!!(f&Js.RENDER_ATTACHMENT));var d=new vT({id:this.getNextUniqueId(),device:this,descriptor:{format:n,width:i,height:a,depthOrArrayLayers:o,dimension:Oi.TEXTURE_2D,mipLevelCount:l,usage:f},skipCreate:!0});return d.depthOrArrayLayers=o,d.sampleCount=s,d.gpuTexture=u,d.gpuTextureView=c,d},e.prototype.createProgram=function(t){var r,n;return!((r=t.vertex)===null||r===void 0)&&r.glsl&&(t.vertex.glsl=Vx(this.queryVendorInfo(),"vert",t.vertex.glsl)),!((n=t.fragment)===null||n===void 0)&&n.glsl&&(t.fragment.glsl=Vx(this.queryVendorInfo(),"frag",t.fragment.glsl)),new cH({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createProgramSimple=function(t){return new cH({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createTextureShared=function(t,r,n){var i={width:t.width,height:t.height,depthOrArrayLayers:t.depthOrArrayLayers},a=t.mipLevelCount,o=O4(t.format),s=m7t(t.dimension),l=g7t(t.usage);if(r.gpuTextureformat=o,r.dimension=t.dimension,r.format=t.format,r.width=t.width,r.height=t.height,r.depthOrArrayLayers=t.depthOrArrayLayers,r.mipLevelCount=a,r.usage=l,r.sampleCount=t.sampleCount,!n){var u=this.device.createTexture({size:i,mipLevelCount:a,format:o,dimension:s,sampleCount:t.sampleCount,usage:l}),c=u.createView();r.gpuTexture=u,r.gpuTextureView=c}},e.prototype.getFallbackSampler=function(t){var r=t.formatKind;return r===Uo.Depth&&t.comparison?this.fallbackSamplerComparison:this.fallbackSamplerFiltering},e.prototype.getFallbackTexture=function(t){var r=t.dimension,n=t.formatKind;if(r===Oi.TEXTURE_2D)return n===Uo.Depth?this.fallbackTexture2DDepth:this.fallbackTexture2D;if(r===Oi.TEXTURE_2D_ARRAY)return this.fallbackTexture2DArray;if(r===Oi.TEXTURE_3D)return this.fallbackTexture3D;if(r===Oi.TEXTURE_CUBE_MAP)return this.fallbackTextureCube;throw new Error("whoops")},e.prototype.createFallbackTexture=function(t,r){var n=t===Oi.TEXTURE_CUBE_MAP?6:1,i=r===Uo.Float?te.U8_RGBA_NORM:te.D24;return this.createTexture({dimension:t,format:i,usage:Du.SAMPLED,width:1,height:1,depthOrArrayLayers:n,mipLevelCount:1})},e.prototype.createBindings=function(t){return new z7t({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createInputLayout=function(t){return new H7t({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createComputePipeline=function(t){return new $7t({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createRenderPipeline=function(t){return new W7t({id:this.getNextUniqueId(),device:this,descriptor:U({},t)})},e.prototype.createQueryPool=function(t,r){return new V7t({id:this.getNextUniqueId(),device:this,descriptor:{type:t,elemCount:r}})},e.prototype.createRenderPipelineInternal=function(t,r){var n;if(t.gpuRenderPipeline===null){var i=t.descriptor,a=i.program,o=a.vertexStage,s=a.fragmentStage;if(!(o===null||s===null)){var l=i.megaStateDescriptor||{},u=l.stencilBack,c=l.stencilFront,f=hi(l,["stencilBack","stencilFront"]),d=$x(Hx);i.megaStateDescriptor=U(U(U({},d),{stencilBack:U(U({},d.stencilBack),u),stencilFront:U(U({},d.stencilFront),c)}),f);var v=i.megaStateDescriptor.attachmentsState[0];i.colorAttachmentFormats.forEach(function(R,O){i.megaStateDescriptor.attachmentsState[O]||(i.megaStateDescriptor.attachmentsState[O]=JJ(void 0,v))});var g=A7t((n=i.topology)!==null&&n!==void 0?n:Rs.TRIANGLES,i.megaStateDescriptor),x=L7t(i.colorAttachmentFormats,i.megaStateDescriptor),w=O7t(i.depthStencilAttachmentFormat,i.megaStateDescriptor),S=void 0;i.inputLayout!==null&&(S=i.inputLayout.buffers);var A=i.sampleCount,M={layout:"auto",vertex:U(U({},o),{buffers:S}),primitive:g,depthStencil:w,multisample:{count:A},fragment:U(U({},s),{targets:x})};t.gpuRenderPipeline=this.device.createRenderPipeline(M)}}},e.prototype.createReadback=function(){return new G7t({id:this.getNextUniqueId(),device:this})},e.prototype.createRenderBundle=function(){return new j7t({id:this.getNextUniqueId(),device:this})},e.prototype.createRenderPass=function(t){var r=this.renderPassPool.pop();r===void 0&&(r=new hH(this));var n=this.frameCommandEncoderPool.pop();return n===void 0&&(n=this.device.createCommandEncoder()),r.beginRenderPass(n,t),r},e.prototype.createComputePass=function(){var t=this.computePassPool.pop();t===void 0&&(t=new uH);var r=this.frameCommandEncoderPool.pop();return r===void 0&&(r=this.device.createCommandEncoder()),t.beginComputePass(r),t},e.prototype.submitPass=function(t){var r=t;r instanceof hH?(this.frameCommandEncoderPool.push(r.frameCommandEncoder),r.finish(),this.renderPassPool.push(r)):r instanceof uH&&(this.frameCommandEncoderPool.push(r.frameCommandEncoder),r.finish(),this.computePassPool.push(r))},e.prototype.copySubTexture2D=function(t,r,n,i,a,o,s){var l=this.device.createCommandEncoder(),u=t,c=i,f={texture:c.gpuTexture,origin:[a,o,0],mipLevel:0,aspect:"all"},d={texture:u.gpuTexture,origin:[r,n,0],mipLevel:0,aspect:"all"};ri(!!(c.usage&Js.COPY_SRC)),ri(!!(u.usage&Js.COPY_DST)),l.copyTextureToTexture(f,d,[c.width,c.height,s||1]),this.device.queue.submit([l.finish()])},e.prototype.queryLimits=function(){return{uniformBufferMaxPageWordSize:this.device.limits.maxUniformBufferBindingSize>>>2,uniformBufferWordAlignment:this.device.limits.minUniformBufferOffsetAlignment>>>2,supportedSampleCounts:[1],occlusionQueriesRecommended:!0,computeShadersSupported:!0}},e.prototype.queryTextureFormatSupported=function(t,r,n){if(B7t(t)){if(!this.featureTextureCompressionBC)return!1;var i=N7t(t);return r%i!==0||n%i!==0?!1:this.featureTextureCompressionBC}switch(t){case te.U16_RGBA_NORM:return!1;case te.F32_RGBA:return!1}return!0},e.prototype.queryPlatformAvailable=function(){return!0},e.prototype.queryVendorInfo=function(){return this},e.prototype.queryRenderPass=function(t){var r=t;return r.descriptor},e.prototype.queryRenderTarget=function(t){var r=t;return r},e.prototype.setResourceName=function(t,r){if(t.name=r,t.type===Qi.Buffer){var n=t;n.gpuBuffer.label=r}else if(t.type===Qi.Texture){var n=t;n.gpuTexture.label=r,n.gpuTextureView.label=r}else if(t.type===Qi.RenderTarget){var n=t;n.gpuTexture.label=r,n.gpuTextureView.label=r}else if(t.type===Qi.Sampler){var n=t;n.gpuSampler.label=r}else if(t.type===Qi.RenderPipeline){var n=t;n.gpuRenderPipeline!==null&&(n.gpuRenderPipeline.label=r)}},e.prototype.setResourceLeakCheck=function(t,r){},e.prototype.checkForLeaks=function(){},e.prototype.programPatched=function(t){},e.prototype.pipelineQueryReady=function(t){var r=t;return r.gpuRenderPipeline!==null},e.prototype.pipelineForceReady=function(t){var r=t;this.createRenderPipelineInternal(r,!1)},e}(),Z7t=function(){function e(t){this.pluginOptions=t}return e.prototype.createSwapChain=function(t){return au(this,void 0,void 0,function(){var r,n,i,a,o,s,l,u;return Lh(this,function(c){switch(c.label){case 0:if(globalThis.navigator.gpu===void 0)return[2,null];r=null,c.label=1;case 1:return c.trys.push([1,3,,4]),n=this.pluginOptions.xrCompatible,[4,globalThis.navigator.gpu.requestAdapter({xrCompatible:n})];case 2:return r=c.sent(),[3,4];case 3:return i=c.sent(),console.log(i),[3,4];case 4:return r===null?[2,null]:(a=["depth32float-stencil8","texture-compression-bc","float32-filterable"],o=a.filter(function(f){return r.features.has(f)}),[4,r.requestDevice({requiredFeatures:o})]);case 5:if(s=c.sent(),s&&(l=this.pluginOptions.onContextLost,s.lost.then(function(){l&&l()})),s===null)return[2,null];if(u=t.getContext("webgpu"),!u)return[2,null];c.label=6;case 6:return c.trys.push([6,8,,9]),[4,ott(this.pluginOptions.shaderCompilerPath)];case 7:return c.sent(),[3,9];case 8:return c.sent(),[3,9];case 9:return[2,new Y7t(r,s,t,u,f7t,xC&&new xC)]}})})},e}(),q7t=class{constructor(e,t){const{buffer:r,offset:n,stride:i,normalized:a,size:o,divisor:s,shaderLocation:l}=t;this.buffer=r,this.attribute={shaderLocation:l,buffer:r.get(),offset:n||0,stride:i||0,normalized:a||!1,divisor:s||0},o&&(this.attribute.size=o)}get(){return this.buffer}updateBuffer(e){this.buffer.subData(e)}destroy(){this.buffer.destroy()}},VM={[q.FLOAT]:Float32Array,[q.UNSIGNED_BYTE]:Uint8Array,[q.SHORT]:Int16Array,[q.UNSIGNED_SHORT]:Uint16Array,[q.INT]:Int32Array,[q.UNSIGNED_INT]:Uint32Array},K7t={[q.POINTS]:Rs.POINTS,[q.LINES]:Rs.LINES,[q.LINE_LOOP]:Rs.LINES,[q.LINE_STRIP]:Rs.LINE_STRIP,[q.TRIANGLES]:Rs.TRIANGLES,[q.TRIANGLE_FAN]:Rs.TRIANGLES,[q.TRIANGLE_STRIP]:Rs.TRIANGLE_STRIP},Q7t={1:te.F32_R,2:te.F32_RG,3:te.F32_RGB,4:te.F32_RGBA},J7t={[q.STATIC_DRAW]:Fd.STATIC,[q.DYNAMIC_DRAW]:Fd.DYNAMIC,[q.STREAM_DRAW]:Fd.DYNAMIC},fH={[q.REPEAT]:ac.REPEAT,[q.CLAMP_TO_EDGE]:ac.CLAMP_TO_EDGE,[q.MIRRORED_REPEAT]:ac.MIRRORED_REPEAT},tzt={[q.NEVER]:pa.NEVER,[q.ALWAYS]:pa.ALWAYS,[q.LESS]:pa.LESS,[q.LEQUAL]:pa.LEQUAL,[q.GREATER]:pa.GREATER,[q.GEQUAL]:pa.GEQUAL,[q.EQUAL]:pa.EQUAL,[q.NOTEQUAL]:pa.NOTEQUAL},ezt={[q.FRONT]:Vc.FRONT,[q.BACK]:Vc.BACK},dH={[q.FUNC_ADD]:ml.ADD,[q.MIN_EXT]:ml.MIN,[q.MAX_EXT]:ml.MAX,[q.FUNC_SUBTRACT]:ml.SUBSTRACT,[q.FUNC_REVERSE_SUBTRACT]:ml.REVERSE_SUBSTRACT},gT={[q.ZERO]:Li.ZERO,[q.ONE]:Li.ONE,[q.SRC_COLOR]:Li.SRC,[q.ONE_MINUS_SRC_COLOR]:Li.ONE_MINUS_SRC,[q.SRC_ALPHA]:Li.SRC_ALPHA,[q.ONE_MINUS_SRC_ALPHA]:Li.ONE_MINUS_SRC_ALPHA,[q.DST_COLOR]:Li.DST,[q.ONE_MINUS_DST_COLOR]:Li.ONE_MINUS_DST,[q.DST_ALPHA]:Li.DST_ALPHA,[q.ONE_MINUS_DST_ALPHA]:Li.ONE_MINUS_DST_ALPHA,[q.CONSTANT_COLOR]:Li.CONST,[q.ONE_MINUS_CONSTANT_COLOR]:Li.ONE_MINUS_CONSTANT,[q.CONSTANT_ALPHA]:Li.CONST,[q.ONE_MINUS_CONSTANT_ALPHA]:Li.ONE_MINUS_CONSTANT,[q.SRC_ALPHA_SATURATE]:Li.SRC_ALPHA_SATURATE},R1={[q.REPLACE]:$o.REPLACE,[q.KEEP]:$o.KEEP,[q.ZERO]:$o.ZERO,[q.INVERT]:$o.INVERT,[q.INCR]:$o.INCREMENT_CLAMP,[q.DECR]:$o.DECREMENT_CLAMP,[q.INCR_WRAP]:$o.INCREMENT_WRAP,[q.DECR_WRAP]:$o.DECREMENT_WRAP},rzt={[q.ALWAYS]:pa.ALWAYS,[q.EQUAL]:pa.EQUAL,[q.GEQUAL]:pa.GEQUAL,[q.GREATER]:pa.GREATER,[q.LEQUAL]:pa.LEQUAL,[q.LESS]:pa.LESS,[q.NEVER]:pa.NEVER,[q.NOTEQUAL]:pa.NOTEQUAL},nzt={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121};function GM(e){return Object.prototype.toString.call(e)in nzt}function izt(e,t){const r=e.length,n=Math.ceil(r/3),i=r+n,a=new Float32Array(i);for(let o=0;o<i;o+=4)a[o]=e[o/4*3],a[o+1]=e[o/4*3+1],a[o+2]=e[o/4*3+2],a[o+3]=t;return a}var azt=class{constructor(e,t){this.isDestroyed=!1;const{data:r,usage:n,type:i,isUBO:a,label:o}=t;let s;GM(r)?s=r:s=new VM[this.type||q.FLOAT](r),this.type=i,this.size=s.byteLength,this.buffer=e.createBuffer({viewOrSize:s,usage:a?Na.UNIFORM:Na.VERTEX,hint:J7t[n||q.STATIC_DRAW]}),o&&e.setResourceName(this.buffer,o)}get(){return this.buffer}destroy(){this.isDestroyed||this.buffer.destroy(),this.isDestroyed=!0}subData({data:e,offset:t}){let r;GM(e)?r=e:r=new VM[this.type||q.FLOAT](e),this.buffer.setSubData(t,new Uint8Array(r.buffer))}};function _a(e,t=0){return e+=t,e+=e<<10,e+=e>>>6,e>>>0}function ltt(e){return e+=e<<3,e^=e>>>11,e+=e<<15,e>>>0}function pH(){return 0}var ozt=class{constructor(){this.keys=[],this.values=[]}},mT=class{constructor(e,t){this.keyEqualFunc=e,this.keyHashFunc=t,this.buckets=new Map}findBucketIndex(e,t){for(let r=0;r<e.keys.length;r++)if(this.keyEqualFunc(t,e.keys[r]))return r;return-1}findBucket(e){const t=this.keyHashFunc(e);return this.buckets.get(t)}get(e){const t=this.findBucket(e);if(t===void 0)return null;const r=this.findBucketIndex(t,e);return r<0?null:t.values[r]}add(e,t){const r=this.keyHashFunc(e);this.buckets.get(r)===void 0&&this.buckets.set(r,new ozt);const n=this.buckets.get(r);n.keys.push(e),n.values.push(t)}delete(e){const t=this.findBucket(e);if(t===void 0)return;const r=this.findBucketIndex(t,e);r!==-1&&(t.keys.splice(r,1),t.values.splice(r,1))}clear(){this.buckets.clear()}size(){let e=0;for(const t of this.buckets.values())e+=t.values.length;return e}*values(){for(const e of this.buckets.values())for(let t=e.values.length-1;t>=0;t--)yield e.values[t]}};function vH(e,t){return e=_a(e,t.blendMode),e=_a(e,t.blendSrcFactor),e=_a(e,t.blendDstFactor),e}function szt(e,t){return e=vH(e,t.rgbBlendState),e=vH(e,t.alphaBlendState),e=_a(e,t.channelWriteMask),e}function lzt(e,t){return e=_a(e,t.r<<24|t.g<<16|t.b<<8|t.a),e}function uzt(e,t){var r,n,i,a,o,s,l,u;for(let c=0;c<t.attachmentsState.length;c++)e=szt(e,t.attachmentsState[c]);return e=lzt(e,t.blendConstant||_I),e=_a(e,t.depthCompare),e=_a(e,t.depthWrite?1:0),e=_a(e,(r=t.stencilFront)==null?void 0:r.compare),e=_a(e,(n=t.stencilFront)==null?void 0:n.passOp),e=_a(e,(i=t.stencilFront)==null?void 0:i.failOp),e=_a(e,(a=t.stencilFront)==null?void 0:a.depthFailOp),e=_a(e,(o=t.stencilBack)==null?void 0:o.compare),e=_a(e,(s=t.stencilBack)==null?void 0:s.passOp),e=_a(e,(l=t.stencilBack)==null?void 0:l.failOp),e=_a(e,(u=t.stencilBack)==null?void 0:u.depthFailOp),e=_a(e,t.stencilWrite?1:0),e=_a(e,t.cullMode),e=_a(e,t.frontFace?1:0),e=_a(e,t.polygonOffset?1:0),e}function czt(e){let t=0;t=_a(t,e.program.id),e.inputLayout!==null&&(t=_a(t,e.inputLayout.id)),t=uzt(t,e.megaStateDescriptor);for(let r=0;r<e.colorAttachmentFormats.length;r++)t=_a(t,e.colorAttachmentFormats[r]||0);return t=_a(t,e.depthStencilAttachmentFormat||0),ltt(t)}function hzt(e){let t=0;if(e.samplerBindings)for(let r=0;r<e.samplerBindings.length;r++){const n=e.samplerBindings[r];n!==null&&n.texture!==null&&(t=_a(t,n.texture.id))}if(e.uniformBufferBindings)for(let r=0;r<e.uniformBufferBindings.length;r++){const n=e.uniformBufferBindings[r];n!==null&&n.buffer!==null&&(t=_a(t,n.buffer.id),t=_a(t,n.binding),t=_a(t,n.offset),t=_a(t,n.size))}if(e.storageBufferBindings)for(let r=0;r<e.storageBufferBindings.length;r++){const n=e.storageBufferBindings[r];n!==null&&n.buffer!==null&&(t=_a(t,n.buffer.id),t=_a(t,n.binding),t=_a(t,n.offset),t=_a(t,n.size))}if(e.storageTextureBindings)for(let r=0;r<e.storageTextureBindings.length;r++){const n=e.storageTextureBindings[r];n!==null&&n.texture!==null&&(t=_a(t,n.texture.id),t=_a(t,n.binding))}return ltt(t)}function fzt(e,t){var r,n,i,a;return((r=e.vertex)==null?void 0:r.glsl)===((n=t.vertex)==null?void 0:n.glsl)&&((i=e.fragment)==null?void 0:i.glsl)===((a=t.fragment)==null?void 0:a.glsl)}function dzt(e){var t,r;return{vertex:{glsl:(t=e.vertex)==null?void 0:t.glsl},fragment:{glsl:(r=e.fragment)==null?void 0:r.glsl}}}var pzt=class{constructor(e){this.device=e,this.bindingsCache=new mT(d8t,hzt),this.renderPipelinesCache=new mT(m8t,czt),this.inputLayoutsCache=new mT(x8t,pH),this.programCache=new mT(fzt,pH)}createBindings(e){var t;let r=this.bindingsCache.get(e);if(r===null){const n=w8t(e);n.uniformBufferBindings=(t=n.uniformBufferBindings)==null?void 0:t.filter(({size:i})=>i&&i>0),r=this.device.createBindings(n),this.bindingsCache.add(n,r)}return r}createRenderPipeline(e){let t=this.renderPipelinesCache.get(e);if(t===null){const r=C8t(e);r.colorAttachmentFormats=r.colorAttachmentFormats.filter(n=>n),t=this.device.createRenderPipeline(r),this.renderPipelinesCache.add(r,t)}return t}createInputLayout(e){e.vertexBufferDescriptors=e.vertexBufferDescriptors.filter(r=>!!r);let t=this.inputLayoutsCache.get(e);if(t===null){const r=A8t(e);t=this.device.createInputLayout(r),this.inputLayoutsCache.add(r,t)}return t}createProgram(e){let t=this.programCache.get(e);if(t===null){const r=dzt(e);t=this.device.createProgram(e),this.programCache.add(r,t)}return t}destroy(){for(const e of this.bindingsCache.values())e.destroy();for(const e of this.renderPipelinesCache.values())e.destroy();for(const e of this.inputLayoutsCache.values())e.destroy();for(const e of this.programCache.values())e.destroy();this.bindingsCache.clear(),this.renderPipelinesCache.clear(),this.inputLayoutsCache.clear(),this.programCache.clear()}},vzt=class{constructor(e,t){const{data:r,type:n,count:i=0}=t;let a;GM(r)?a=r:a=new VM[this.type||q.UNSIGNED_INT](r),this.type=n,this.count=i,this.indexBuffer=e.createBuffer({viewOrSize:a,usage:Na.INDEX})}get(){return this.indexBuffer}subData({data:e}){let t;GM(e)?t=e:t=new VM[this.type||q.UNSIGNED_INT](e),this.indexBuffer.setSubData(0,new Uint8Array(t.buffer))}destroy(){this.indexBuffer.destroy()}};function gH(e){return!!(e&&e.texture)}var utt=class{constructor(e,t){this.device=e,this.options=t,this.isDestroy=!1;const{wrapS:r=q.CLAMP_TO_EDGE,wrapT:n=q.CLAMP_TO_EDGE,aniso:i,mag:a=q.NEAREST,min:o=q.NEAREST}=t;this.createTexture(t),this.sampler=e.createSampler({addressModeU:fH[r],addressModeV:fH[n],minFilter:o===q.NEAREST?ts.POINT:ts.BILINEAR,magFilter:a===q.NEAREST?ts.POINT:ts.BILINEAR,mipmapFilter:el.NO_MIP,maxAnisotropy:i})}createTexture(e){const{type:t=q.UNSIGNED_BYTE,width:r,height:n,flipY:i=!1,format:a=q.RGBA,alignment:o=1,usage:s=jy.SAMPLED,unorm:l=!1,label:u}=e;let{data:c}=e;this.width=r,this.height=n;let f=te.U8_RGBA_RT;if(t===q.UNSIGNED_BYTE&&a===q.RGBA)f=l?te.U8_RGBA_NORM:te.U8_RGBA_RT;else if(t===q.UNSIGNED_BYTE&&a===q.LUMINANCE)f=te.U8_LUMINANCE;else if(t===q.FLOAT&&a===q.LUMINANCE)f=te.F32_LUMINANCE;else if(t===q.FLOAT&&a===q.RGB)this.device.queryVendorInfo().platformString==="WebGPU"?(c&&(c=izt(c,0)),f=te.F32_RGBA):f=te.F32_RGB;else if(t===q.FLOAT&&a===q.RGBA)f=te.F32_RGBA;else if(t===q.FLOAT&&a===q.RED)f=te.F32_R;else throw new Error(`create texture error, type: ${t}, format: ${a}`);this.texture=this.device.createTexture({format:f,width:r,height:n,usage:s===jy.SAMPLED?Du.SAMPLED:Du.RENDER_TARGET,pixelStore:{unpackFlipY:i,packAlignment:o},mipLevelCount:1}),u&&this.device.setResourceName(this.texture,u),c&&this.texture.setImageData([c])}get(){return this.texture}update(e){const{data:t}=e;this.texture.setImageData([t])}bind(){}resize({width:e,height:t}){(this.width!==e||this.height!==t)&&this.destroy(),this.options.width=e,this.options.height=t,this.createTexture(this.options),this.isDestroy=!1}getSize(){return[this.width,this.height]}destroy(){var e;!this.isDestroy&&!this.texture.destroyed&&((e=this.texture)==null||e.destroy()),this.isDestroy=!0}},ctt=class{constructor(e,t){this.device=e,this.options=t,this.createColorRenderTarget(),this.createDepthRenderTarget()}createColorRenderTarget(e=!1){const{width:t,height:r,color:n}=this.options;n&&(gH(n)?(e&&n.resize({width:t,height:r}),this.colorTexture=n.get(),this.colorRenderTarget=this.device.createRenderTargetFromTexture(this.colorTexture),this.width=n.width,this.height=n.height):t&&r&&(this.colorTexture=this.device.createTexture({format:te.U8_RGBA_RT,usage:Du.RENDER_TARGET,width:t,height:r}),this.colorRenderTarget=this.device.createRenderTargetFromTexture(this.colorTexture),this.width=t,this.height=r))}createDepthRenderTarget(e=!1){const{width:t,height:r,depth:n}=this.options;n&&(gH(n)?(e&&n.resize({width:t,height:r}),this.depthTexture=n.get(),this.depthRenderTarget=this.device.createRenderTargetFromTexture(this.depthTexture),this.width=n.width,this.height=n.height):t&&r&&(this.depthTexture=this.device.createTexture({format:te.D24_S8,usage:Du.RENDER_TARGET,width:t,height:r}),this.depthRenderTarget=this.device.createRenderTargetFromTexture(this.depthTexture),this.width=t,this.height=r))}get(){return this.colorRenderTarget}destroy(){var e,t;(e=this.colorRenderTarget)==null||e.destroy(),(t=this.depthRenderTarget)==null||t.destroy()}resize({width:e,height:t}){(this.width!==e||this.height!==t)&&(this.destroy(),this.colorTexture.destroyed=!0,this.depthTexture.destroyed=!0,this.options.width=e,this.options.height=t,this.createColorRenderTarget(!0),this.createDepthRenderTarget(!0))}},gzt=Object.defineProperty,mzt=Object.defineProperties,yzt=Object.getOwnPropertyDescriptors,mH=Object.getOwnPropertySymbols,_zt=Object.prototype.hasOwnProperty,xzt=Object.prototype.propertyIsEnumerable,yH=(e,t,r)=>t in e?gzt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,iy=(e,t)=>{for(var r in t||(t={}))_zt.call(t,r)&&yH(e,r,t[r]);if(mH)for(var r of mH(t))xzt.call(t,r)&&yH(e,r,t[r]);return e},bzt=(e,t)=>mzt(e,yzt(t)),{isPlainObject:Ezt,isTypedArray:wzt,isNil:_H}=is,Czt=class{constructor(e,t,r){this.device=e,this.options=t,this.service=r,this.destroyed=!1,this.uniforms={},this.vertexBuffers=[];const{vs:n,fs:i,attributes:a,uniforms:o,count:s,elements:l,diagnosticDerivativeUniformityEnabled:u}=t;this.options=t;const c=u?"":this.service.viewportOrigin===Od.UPPER_LEFT?"diagnostic(off,derivative_uniformity);":"";this.program=r.renderCache.createProgram({vertex:{glsl:n},fragment:{glsl:i,postprocess:g=>c+g}}),o&&(this.uniforms=this.extractUniforms(o));const f=[];let d=0;Object.keys(a).forEach(g=>{const x=a[g],w=x.get();this.vertexBuffers.push(w.get());const{offset:S=0,stride:A=0,size:M=1,divisor:R=0,shaderLocation:O=0}=x.attribute;f.push({arrayStride:A||M*4,stepMode:Qy.VERTEX,attributes:[{format:Q7t[M],shaderLocation:O,offset:S,divisor:R}]}),d=w.size/M}),s||(this.options.count=d),l&&(this.indexBuffer=l.get());const v=r.renderCache.createInputLayout({vertexBufferDescriptors:f,indexBufferFormat:l?te.U32_R:null,program:this.program});this.inputLayout=v,this.pipeline=this.createPipeline(t)}createPipeline(e,t){var r;const{primitive:n=q.TRIANGLES,depth:i,cull:a,blend:o,stencil:s}=e,l=this.initDepthDrawParams({depth:i}),u=!!(l&&l.enable),c=this.initCullDrawParams({cull:a}),f=!!(c&&c.enable),d=this.getBlendDrawParams({blend:o}),v=!!(d&&d.enable),g=this.getStencilDrawParams({stencil:s}),x=!!(g&&g.enable),w=this.device.createRenderPipeline({inputLayout:this.inputLayout,program:this.program,topology:K7t[n],colorAttachmentFormats:[te.U8_RGBA_RT],depthStencilAttachmentFormat:te.D24_S8,megaStateDescriptor:{attachmentsState:[t?{channelWriteMask:dl.ALL,rgbBlendState:{blendMode:ml.ADD,blendSrcFactor:Li.ONE,blendDstFactor:Li.ZERO},alphaBlendState:{blendMode:ml.ADD,blendSrcFactor:Li.ONE,blendDstFactor:Li.ZERO}}:{channelWriteMask:x&&g.opFront.zpass===$o.REPLACE?dl.NONE:dl.ALL,rgbBlendState:{blendMode:v&&d.equation.rgb||ml.ADD,blendSrcFactor:v&&d.func.srcRGB||Li.SRC_ALPHA,blendDstFactor:v&&d.func.dstRGB||Li.ONE_MINUS_SRC_ALPHA},alphaBlendState:{blendMode:v&&d.equation.alpha||ml.ADD,blendSrcFactor:v&&d.func.srcAlpha||Li.ONE,blendDstFactor:v&&d.func.dstAlpha||Li.ONE}}],blendConstant:v?_I:void 0,depthWrite:u,depthCompare:u&&l.func||pa.LESS,cullMode:f&&c.face||Vc.NONE,stencilWrite:x,stencilFront:{compare:x?g.func.cmp:pa.ALWAYS,passOp:g.opFront.zpass,failOp:g.opFront.fail,depthFailOp:g.opFront.zfail,mask:g.opFront.mask},stencilBack:{compare:x?g.func.cmp:pa.ALWAYS,passOp:g.opBack.zpass,failOp:g.opBack.fail,depthFailOp:g.opBack.zfail,mask:g.opBack.mask}}});return x&&!_H((r=s==null?void 0:s.func)==null?void 0:r.ref)&&(w.stencilFuncReference=s.func.ref),w}updateAttributesAndElements(){}updateAttributes(){}addUniforms(e){this.uniforms=iy(iy({},this.uniforms),this.extractUniforms(e))}draw(e,t){const r=iy(iy({},this.options),e),{count:n=0,instances:i,elements:a,uniforms:o={},uniformBuffers:s,textures:l}=r;this.uniforms=iy(iy({},this.uniforms),this.extractUniforms(o));const{renderPass:u,currentFramebuffer:c,width:f,height:d}=this.service;this.pipeline=this.createPipeline(r,t);const v=this.service.device,g=v.swapChainHeight;if(v.swapChainHeight=(c==null?void 0:c.height)||d,u.setViewport(0,0,(c==null?void 0:c.width)||f,(c==null?void 0:c.height)||d),v.swapChainHeight=g,u.setPipeline(this.pipeline),_H(this.pipeline.stencilFuncReference)||u.setStencilReference(this.pipeline.stencilFuncReference),u.setVertexInput(this.inputLayout,this.vertexBuffers.map(x=>({buffer:x})),a?{buffer:this.indexBuffer,offset:0}:null),s&&(this.bindings=v.createBindings({pipeline:this.pipeline,uniformBufferBindings:s.map((x,w)=>{const S=x;return{binding:w,buffer:S.get(),size:S.size}}),samplerBindings:l==null?void 0:l.map(x=>({texture:x.texture,sampler:x.sampler}))})),this.bindings&&(u.setBindings(this.bindings),Object.keys(this.uniforms).forEach(x=>{const w=this.uniforms[x];w instanceof utt?this.uniforms[x]=w.get():w instanceof ctt&&(this.uniforms[x]=w.get().texture)}),this.program.setUniformsLegacy(this.uniforms)),a){const x=a.count;x===0?u.draw(n,i):u.drawIndexed(x,i)}else u.draw(n,i)}destroy(){var e,t,r;(e=this.vertexBuffers)==null||e.forEach(n=>n.destroy()),(t=this.indexBuffer)==null||t.destroy(),(r=this.bindings)==null||r.destroy(),this.pipeline.destroy(),this.destroyed=!0}initDepthDrawParams({depth:e}){if(e)return{enable:e.enable===void 0?!0:!!e.enable,mask:e.mask===void 0?!0:!!e.mask,func:tzt[e.func||q.LESS],range:e.range||[0,1]}}getBlendDrawParams({blend:e}){const{enable:t,func:r,equation:n,color:i=[0,0,0,0]}=e||{};return{enable:!!t,func:{srcRGB:gT[r&&r.srcRGB||q.SRC_ALPHA],srcAlpha:gT[r&&r.srcAlpha||q.SRC_ALPHA],dstRGB:gT[r&&r.dstRGB||q.ONE_MINUS_SRC_ALPHA],dstAlpha:gT[r&&r.dstAlpha||q.ONE_MINUS_SRC_ALPHA]},equation:{rgb:dH[n&&n.rgb||q.FUNC_ADD],alpha:dH[n&&n.alpha||q.FUNC_ADD]},color:i}}getStencilDrawParams({stencil:e}){const{enable:t,mask:r=4294967295,func:n={cmp:q.ALWAYS,ref:0,mask:4294967295},opFront:i={fail:q.KEEP,zfail:q.KEEP,zpass:q.KEEP},opBack:a={fail:q.KEEP,zfail:q.KEEP,zpass:q.KEEP}}=e||{};return{enable:!!t,mask:r,func:bzt(iy({},n),{cmp:rzt[n.cmp]}),opFront:{fail:R1[i.fail],zfail:R1[i.zfail],zpass:R1[i.zpass],mask:n.mask},opBack:{fail:R1[a.fail],zfail:R1[a.zfail],zpass:R1[a.zpass],mask:n.mask}}}initCullDrawParams({cull:e}){if(e){const{enable:t,face:r=q.BACK}=e;return{enable:!!t,face:ezt[r]}}}extractUniforms(e){const t={};return Object.keys(e).forEach(r=>{this.extractUniformsRecursively(r,e[r],t,"")}),t}extractUniformsRecursively(e,t,r,n){if(t===null||typeof t=="number"||typeof t=="boolean"||Array.isArray(t)&&typeof t[0]=="number"||wzt(t)||t===""||"resize"in t){r[`${n&&n+"."}${e}`]=t;return}Ezt(t)&&Object.keys(t).forEach(i=>{this.extractUniformsRecursively(i,t[i],r,`${n&&n+"."}${e}`)}),Array.isArray(t)&&t.forEach((i,a)=>{Object.keys(i).forEach(o=>{this.extractUniformsRecursively(o,i[o],r,`${n&&n+"."}${e}[${a}]`)})})}};function Szt(e){return typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext?!0:!!(e&&e._version===2)}var RO=(e,t,r)=>new Promise((n,i)=>{var a=l=>{try{s(r.next(l))}catch(u){i(u)}},o=l=>{try{s(r.throw(l))}catch(u){i(u)}},s=l=>l.done?n(l.value):Promise.resolve(l.value).then(a,o);s((r=r.apply(e,t)).next())}),{isUndefined:yT}=is,Tzt=class{constructor(){this.uniformBuffers=[],this.queryVerdorInfo=()=>this.device.queryVendorInfo().platformString,this.createModel=e=>new Czt(this.device,e,this),this.createAttribute=e=>new q7t(this.device,e),this.createBuffer=e=>new azt(this.device,e),this.createElements=e=>new vzt(this.device,e),this.createTexture2D=e=>new utt(this.device,e),this.createFramebuffer=e=>new ctt(this.device,e),this.useFramebuffer=(e,t)=>{this.currentFramebuffer=e,this.beginFrame(),t(),this.endFrame(),this.currentFramebuffer=null},this.useFramebufferAsync=(e,t)=>RO(this,null,function*(){this.currentFramebuffer=e,this.preRenderPass=this.renderPass,this.beginFrame(),yield t(),this.endFrame(),this.currentFramebuffer=null,this.renderPass=this.preRenderPass}),this.clear=e=>{const{color:t,depth:r,stencil:n,framebuffer:i=null}=e;if(i)i.clearOptions={color:t,depth:r,stencil:n};else{const a=this.queryVerdorInfo();if(a==="WebGL1"){const o=this.getGLContext();yT(n)?yT(r)||(o.clearDepth(r),o.clear(o.DEPTH_BUFFER_BIT)):(o.clearStencil(n),o.clear(o.STENCIL_BUFFER_BIT))}else if(a==="WebGL2"){const o=this.getGLContext();yT(n)?yT(r)||o.clearBufferfv(o.DEPTH,0,[r]):o.clearBufferiv(o.STENCIL,0,[n])}}},this.viewport=({width:e,height:t})=>{this.swapChain.configureSwapChain(e,t),this.createMainColorDepthRT(e,t),this.width=e,this.height=t},this.readPixels=e=>{const{framebuffer:t,x:r,y:n,width:i,height:a}=e,o=this.device.createReadback(),s=t.colorTexture,l=o.readTextureSync(s,r,this.viewportOrigin===Od.LOWER_LEFT?n:this.height-n,i,a,new Uint8Array(i*a*4));if(this.viewportOrigin!==Od.LOWER_LEFT)for(let u=0;u<l.length;u+=4){const c=l[u];l[u]=l[u+2],l[u+2]=c}return o.destroy(),l},this.readPixelsAsync=e=>RO(this,null,function*(){const{framebuffer:t,x:r,y:n,width:i,height:a}=e,o=this.device.createReadback(),s=t.colorTexture,l=yield o.readTexture(s,r,this.viewportOrigin===Od.LOWER_LEFT?n:this.height-n,i,a,new Uint8Array(i*a*4));if(this.viewportOrigin!==Od.LOWER_LEFT)for(let u=0;u<l.length;u+=4){const c=l[u];l[u]=l[u+2],l[u+2]=c}return o.destroy(),l}),this.getViewportSize=()=>({width:this.width,height:this.height}),this.getContainer=()=>{var e;return(e=this.canvas)==null?void 0:e.parentElement},this.getCanvas=()=>this.canvas,this.getGLContext=()=>this.device.gl,this.destroy=()=>{var e;this.canvas=null,(e=this.uniformBuffers)==null||e.forEach(t=>{t.destroy()}),this.device.destroy(),this.renderCache.destroy()}}init(e,t){return RO(this,null,function*(){const{enableWebGPU:r,shaderCompilerPath:n,antialias:i}=t;this.canvas=e;const o=yield(r?new Z7t({shaderCompilerPath:n}):new s7t({targets:["webgl2","webgl1"],antialias:i,onContextLost(l){console.warn("context lost",l)},onContextCreationError(l){console.warn("context creation error",l)},onContextRestored(l){console.warn("context restored",l)}})).createSwapChain(e);o.configureSwapChain(e.width,e.height),this.device=o.getDevice(),this.swapChain=o,this.renderCache=new pzt(this.device),this.currentFramebuffer=null,this.viewportOrigin=this.device.queryVendorInfo().viewportOrigin;const s=this.device.gl;this.extensionObject={OES_texture_float:!Szt(s)&&this.device.OES_texture_float},this.createMainColorDepthRT(e.width,e.height)})}createMainColorDepthRT(e,t){this.mainColorRT&&this.mainColorRT.destroy(),this.mainDepthRT&&this.mainDepthRT.destroy(),this.mainColorRT=this.device.createRenderTargetFromTexture(this.device.createTexture({format:te.U8_RGBA_RT,width:e,height:t,usage:Du.RENDER_TARGET})),this.mainDepthRT=this.device.createRenderTargetFromTexture(this.device.createTexture({format:te.D24_S8,width:e,height:t,usage:Du.RENDER_TARGET}))}beginFrame(){this.device.beginFrame();const{currentFramebuffer:e,swapChain:t,mainColorRT:r,mainDepthRT:n}=this,i=e?e.colorRenderTarget:r,a=e?null:t.getOnscreenTexture(),o=e?e.depthRenderTarget:n,{color:s=[0,0,0,0],depth:l=1,stencil:u=0}=(e==null?void 0:e.clearOptions)||{},c=i?MS(s[0]*255,s[1]*255,s[2]*255,s[3]):_I,f=o?l:void 0,d=o?u:void 0,v=this.device.createRenderPass({colorAttachment:[i],colorResolveTo:[a],colorClearColor:[c],colorStore:[!0],depthStencilAttachment:o,depthClearValue:f,stencilClearValue:d});this.renderPass=v}endFrame(){this.device.submitPass(this.renderPass),this.device.endFrame()}getPointSizeRange(){const e=this.device.gl;return e.getParameter(e.ALIASED_POINT_SIZE_RANGE)}testExtension(e){return!!this.getGLContext().getExtension(e)}setState(){}setBaseState(){}setCustomLayerDefaults(){}setDirty(e){this.isDirty=e}getDirty(){return this.isDirty}},htt={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(Cm,function(){var r=function(W){return W instanceof Uint8Array||W instanceof Uint16Array||W instanceof Uint32Array||W instanceof Int8Array||W instanceof Int16Array||W instanceof Int32Array||W instanceof Float32Array||W instanceof Float64Array||W instanceof Uint8ClampedArray},n=function(W,yt){for(var Ft=Object.keys(yt),ve=0;ve<Ft.length;++ve)W[Ft[ve]]=yt[Ft[ve]];return W},i=`
`;function a(W){return typeof atob<"u"?atob(W):"base64:"+W}function o(W){var yt=new Error("(regl) "+W);throw console.error(yt),yt}function s(W,yt){W||o(yt)}function l(W){return W?": "+W:""}function u(W,yt,Ft){W in yt||o("unknown parameter ("+W+")"+l(Ft)+". possible values: "+Object.keys(yt).join())}function c(W,yt){r(W)||o("invalid parameter type"+l(yt)+". must be a typed array")}function f(W,yt){switch(yt){case"number":return typeof W=="number";case"object":return typeof W=="object";case"string":return typeof W=="string";case"boolean":return typeof W=="boolean";case"function":return typeof W=="function";case"undefined":return typeof W>"u";case"symbol":return typeof W=="symbol"}}function d(W,yt,Ft){f(W,yt)||o("invalid parameter type"+l(Ft)+". expected "+yt+", got "+typeof W)}function v(W,yt){W>=0&&(W|0)===W||o("invalid parameter type, ("+W+")"+l(yt)+". must be a nonnegative integer")}function g(W,yt,Ft){yt.indexOf(W)<0&&o("invalid value"+l(Ft)+". must be one of: "+yt)}var x=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function w(W){Object.keys(W).forEach(function(yt){x.indexOf(yt)<0&&o('invalid regl constructor argument "'+yt+'". must be one of '+x)})}function S(W,yt){for(W=W+"";W.length<yt;)W=" "+W;return W}function A(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function M(W,yt){this.number=W,this.line=yt,this.errors=[]}function R(W,yt,Ft){this.file=W,this.line=yt,this.message=Ft}function O(){var W=new Error,yt=(W.stack||W).toString(),Ft=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(yt);if(Ft)return Ft[1];var ve=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(yt);return ve?ve[1]:"unknown"}function N(){var W=new Error,yt=(W.stack||W).toString(),Ft=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(yt);if(Ft)return Ft[1];var ve=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(yt);return ve?ve[1]:"unknown"}function k(W,yt){var Ft=W.split(`
`),ve=1,Ne=0,ye={unknown:new A,0:new A};ye.unknown.name=ye[0].name=yt||O(),ye.unknown.lines.push(new M(0,""));for(var ue=0;ue<Ft.length;++ue){var nr=Ft[ue],qe=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(nr);if(qe)switch(qe[1]){case"line":var pr=/(\d+)(\s+\d+)?/.exec(qe[2]);pr&&(ve=pr[1]|0,pr[2]&&(Ne=pr[2]|0,Ne in ye||(ye[Ne]=new A)));break;case"define":var or=/SHADER_NAME(_B64)?\s+(.*)$/.exec(qe[2]);or&&(ye[Ne].name=or[1]?a(or[2]):or[2]);break}ye[Ne].lines.push(new M(ve++,nr))}return Object.keys(ye).forEach(function(hr){var mr=ye[hr];mr.lines.forEach(function(Ke){mr.index[Ke.number]=Ke})}),ye}function V(W){var yt=[];return W.split(`
`).forEach(function(Ft){if(!(Ft.length<5)){var ve=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(Ft);ve?yt.push(new R(ve[1]|0,ve[2]|0,ve[3].trim())):Ft.length>0&&yt.push(new R("unknown",0,Ft))}}),yt}function Q(W,yt){yt.forEach(function(Ft){var ve=W[Ft.file];if(ve){var Ne=ve.index[Ft.line];if(Ne){Ne.errors.push(Ft),ve.hasErrors=!0;return}}W.unknown.hasErrors=!0,W.unknown.lines[0].errors.push(Ft)})}function Y(W,yt,Ft,ve,Ne){if(!W.getShaderParameter(yt,W.COMPILE_STATUS)){var ye=W.getShaderInfoLog(yt),ue=ve===W.FRAGMENT_SHADER?"fragment":"vertex";kt(Ft,"string",ue+" shader source must be a string",Ne);var nr=k(Ft,Ne),qe=V(ye);Q(nr,qe),Object.keys(nr).forEach(function(pr){var or=nr[pr];if(!or.hasErrors)return;var hr=[""],mr=[""];function Ke(fr,ie){hr.push(fr),mr.push(ie||"")}Ke("file number "+pr+": "+or.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),or.lines.forEach(function(fr){if(fr.errors.length>0){Ke(S(fr.number,4)+"|  ","background-color:yellow; font-weight:bold"),Ke(fr.line+i,"color:red; background-color:yellow; font-weight:bold");var ie=0;fr.errors.forEach(function(Se){var ir=Se.message,Cr=/^\s*'(.*)'\s*:\s*(.*)$/.exec(ir);if(Cr){var We=Cr[1];switch(ir=Cr[2],We){case"assign":We="=";break}ie=Math.max(fr.line.indexOf(We,ie),0)}else ie=0;Ke(S("| ",6)),Ke(S("^^^",ie+3)+i,"font-weight:bold"),Ke(S("| ",6)),Ke(ir+i,"font-weight:bold")}),Ke(S("| ",6)+i)}else Ke(S(fr.number,4)+"|  "),Ke(fr.line+i,"color:red")}),typeof document<"u"&&!window.chrome?(mr[0]=hr.join("%c"),console.log.apply(console,mr)):console.log(hr.join(""))}),s.raise("Error compiling "+ue+" shader, "+nr[0].name)}}function X(W,yt,Ft,ve,Ne){if(!W.getProgramParameter(yt,W.LINK_STATUS)){var ye=W.getProgramInfoLog(yt),ue=k(Ft,Ne),nr=k(ve,Ne),qe='Error linking program with vertex shader, "'+nr[0].name+'", and fragment shader "'+ue[0].name+'"';typeof document<"u"?console.log("%c"+qe+i+"%c"+ye,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(qe+i+ye),s.raise(qe)}}function tt(W){W._commandRef=O()}function it(W,yt,Ft,ve){tt(W);function Ne(qe){return qe?ve.id(qe):0}W._fragId=Ne(W.static.frag),W._vertId=Ne(W.static.vert);function ye(qe,pr){Object.keys(pr).forEach(function(or){qe[ve.id(or)]=!0})}var ue=W._uniformSet={};ye(ue,yt.static),ye(ue,yt.dynamic);var nr=W._attributeSet={};ye(nr,Ft.static),ye(nr,Ft.dynamic),W._hasCount="count"in W.static||"count"in W.dynamic||"elements"in W.static||"elements"in W.dynamic}function Et(W,yt){var Ft=N();o(W+" in command "+(yt||O())+(Ft==="unknown"?"":" called from "+Ft))}function Tt(W,yt,Ft){W||Et(yt,Ft||O())}function pt(W,yt,Ft,ve){W in yt||Et("unknown parameter ("+W+")"+l(Ft)+". possible values: "+Object.keys(yt).join(),ve||O())}function kt(W,yt,Ft,ve){f(W,yt)||Et("invalid parameter type"+l(Ft)+". expected "+yt+", got "+typeof W,ve||O())}function ae(W){W()}function Kt(W,yt,Ft){W.texture?g(W.texture._texture.internalformat,yt,"unsupported texture format for attachment"):g(W.renderbuffer._renderbuffer.format,Ft,"unsupported renderbuffer format for attachment")}var re=33071,fe=9728,Oe=9984,Ye=9985,Be=9986,De=9987,Yr=5120,Gr=5121,Mn=5122,ee=5123,rr=5124,Nr=5125,Fe=5126,Hr=32819,_n=32820,Kn=33635,vn=34042,xn=36193,ui={};ui[Yr]=ui[Gr]=1,ui[Mn]=ui[ee]=ui[xn]=ui[Kn]=ui[Hr]=ui[_n]=2,ui[rr]=ui[Nr]=ui[Fe]=ui[vn]=4;function Ao(W,yt){return W===_n||W===Hr||W===Kn?2:W===vn?4:ui[W]*yt}function ta(W){return!(W&W-1)&&!!W}function oa(W,yt,Ft){var ve,Ne=yt.width,ye=yt.height,ue=yt.channels;s(Ne>0&&Ne<=Ft.maxTextureSize&&ye>0&&ye<=Ft.maxTextureSize,"invalid texture shape"),(W.wrapS!==re||W.wrapT!==re)&&s(ta(Ne)&&ta(ye),"incompatible wrap mode for texture, both width and height must be power of 2"),yt.mipmask===1?Ne!==1&&ye!==1&&s(W.minFilter!==Oe&&W.minFilter!==Be&&W.minFilter!==Ye&&W.minFilter!==De,"min filter requires mipmap"):(s(ta(Ne)&&ta(ye),"texture must be a square power of 2 to support mipmapping"),s(yt.mipmask===(Ne<<1)-1,"missing or incomplete mipmap data")),yt.type===Fe&&(Ft.extensions.indexOf("oes_texture_float_linear")<0&&s(W.minFilter===fe&&W.magFilter===fe,"filter not supported, must enable oes_texture_float_linear"),s(!W.genMipmaps,"mipmap generation not supported with float textures"));var nr=yt.images;for(ve=0;ve<16;++ve)if(nr[ve]){var qe=Ne>>ve,pr=ye>>ve;s(yt.mipmask&1<<ve,"missing mipmap data");var or=nr[ve];if(s(or.width===qe&&or.height===pr,"invalid shape for mip images"),s(or.format===yt.format&&or.internalformat===yt.internalformat&&or.type===yt.type,"incompatible type for mip image"),!or.compressed)if(or.data){var hr=Math.ceil(Ao(or.type,ue)*qe/or.unpackAlignment)*or.unpackAlignment;s(or.data.byteLength===hr*pr,"invalid data for image, buffer size is inconsistent with image format")}else or.element||or.copy}else W.genMipmaps||s((yt.mipmask&1<<ve)===0,"extra mipmap data");yt.compressed&&s(!W.genMipmaps,"mipmap generation for compressed images not supported")}function as(W,yt,Ft,ve){var Ne=W.width,ye=W.height,ue=W.channels;s(Ne>0&&Ne<=ve.maxTextureSize&&ye>0&&ye<=ve.maxTextureSize,"invalid texture shape"),s(Ne===ye,"cube map must be square"),s(yt.wrapS===re&&yt.wrapT===re,"wrap mode not supported by cube map");for(var nr=0;nr<Ft.length;++nr){var qe=Ft[nr];s(qe.width===Ne&&qe.height===ye,"inconsistent cube map face shape"),yt.genMipmaps&&(s(!qe.compressed,"can not generate mipmap for compressed textures"),s(qe.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var pr=qe.images,or=0;or<16;++or){var hr=pr[or];if(hr){var mr=Ne>>or,Ke=ye>>or;s(qe.mipmask&1<<or,"missing mipmap data"),s(hr.width===mr&&hr.height===Ke,"invalid shape for mip images"),s(hr.format===W.format&&hr.internalformat===W.internalformat&&hr.type===W.type,"incompatible type for mip image"),hr.compressed||(hr.data?s(hr.data.byteLength===mr*Ke*Math.max(Ao(hr.type,ue),hr.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):hr.element||hr.copy)}}}}var bt=n(s,{optional:ae,raise:o,commandRaise:Et,command:Tt,parameter:u,commandParameter:pt,constructor:w,type:d,commandType:kt,isTypedArray:c,nni:v,oneOf:g,shaderError:Y,linkError:X,callSite:N,saveCommandRef:tt,saveDrawInfo:it,framebufferFormat:Kt,guessCommand:O,texture2D:oa,textureCube:as}),os=0,gu=0;function ss(W,yt){this.id=os++,this.type=W,this.data=yt}function Vu(W){return W.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function va(W){if(W.length===0)return[];var yt=W.charAt(0),Ft=W.charAt(W.length-1);if(W.length>1&&yt===Ft&&(yt==='"'||yt==="'"))return['"'+Vu(W.substr(1,W.length-2))+'"'];var ve=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(W);if(ve)return va(W.substr(0,ve.index)).concat(va(ve[1])).concat(va(W.substr(ve.index+ve[0].length)));var Ne=W.split(".");if(Ne.length===1)return['"'+Vu(W)+'"'];for(var ye=[],ue=0;ue<Ne.length;++ue)ye=ye.concat(va(Ne[ue]));return ye}function ls(W){return"["+va(W).join("][")+"]"}function il(W,yt){return new ss(W,ls(yt+""))}function us(W){return typeof W=="function"&&!W._reglType||W instanceof ss}function dc(W,yt){return typeof W=="function"?new ss(gu,W):W}var fo={DynamicVariable:ss,define:il,isDynamic:us,unbox:dc,accessor:ls},Gu={next:typeof requestAnimationFrame=="function"?function(W){return requestAnimationFrame(W)}:function(W){return setTimeout(W,16)},cancel:typeof cancelAnimationFrame=="function"?function(W){return cancelAnimationFrame(W)}:clearTimeout},Cl=typeof performance<"u"&&performance.now?function(){return performance.now()}:function(){return+new Date};function oh(){var W={"":0},yt=[""];return{id:function(Ft){var ve=W[Ft];return ve||(ve=W[Ft]=yt.length,yt.push(Ft),ve)},str:function(Ft){return yt[Ft]}}}function nd(W,yt,Ft){var ve=document.createElement("canvas");n(ve.style,{border:0,margin:0,padding:0,top:0,left:0}),W.appendChild(ve),W===document.body&&(ve.style.position="absolute",n(W.style,{margin:0,padding:0}));function Ne(){var nr=window.innerWidth,qe=window.innerHeight;if(W!==document.body){var pr=W.getBoundingClientRect();nr=pr.right-pr.left,qe=pr.bottom-pr.top}ve.width=Ft*nr,ve.height=Ft*qe,n(ve.style,{width:nr+"px",height:qe+"px"})}var ye;W!==document.body&&typeof ResizeObserver=="function"?(ye=new ResizeObserver(function(){setTimeout(Ne)}),ye.observe(W)):window.addEventListener("resize",Ne,!1);function ue(){ye?ye.disconnect():window.removeEventListener("resize",Ne),W.removeChild(ve)}return Ne(),{canvas:ve,onDestroy:ue}}function sh(W,yt){function Ft(ve){try{return W.getContext(ve,yt)}catch{return null}}return Ft("webgl")||Ft("experimental-webgl")||Ft("webgl-experimental")}function Jd(W){return typeof W.nodeName=="string"&&typeof W.appendChild=="function"&&typeof W.getBoundingClientRect=="function"}function lh(W){return typeof W.drawArrays=="function"||typeof W.drawElements=="function"}function jl(W){return typeof W=="string"?W.split():(bt(Array.isArray(W),"invalid extension array"),W)}function Yl(W){return typeof W=="string"?(bt(typeof document<"u","not supported outside of DOM"),document.querySelector(W)):W}function pc(W){var yt=W||{},Ft,ve,Ne,ye,ue={},nr=[],qe=[],pr=typeof window>"u"?1:window.devicePixelRatio,or=!1,hr=function(fr){fr&&bt.raise(fr)},mr=function(){};if(typeof yt=="string"?(bt(typeof document<"u","selector queries only supported in DOM enviroments"),Ft=document.querySelector(yt),bt(Ft,"invalid query string for element")):typeof yt=="object"?Jd(yt)?Ft=yt:lh(yt)?(ye=yt,Ne=ye.canvas):(bt.constructor(yt),"gl"in yt?ye=yt.gl:"canvas"in yt?Ne=Yl(yt.canvas):"container"in yt&&(ve=Yl(yt.container)),"attributes"in yt&&(ue=yt.attributes,bt.type(ue,"object","invalid context attributes")),"extensions"in yt&&(nr=jl(yt.extensions)),"optionalExtensions"in yt&&(qe=jl(yt.optionalExtensions)),"onDone"in yt&&(bt.type(yt.onDone,"function","invalid or missing onDone callback"),hr=yt.onDone),"profile"in yt&&(or=!!yt.profile),"pixelRatio"in yt&&(pr=+yt.pixelRatio,bt(pr>0,"invalid pixel ratio"))):bt.raise("invalid arguments to regl"),Ft&&(Ft.nodeName.toLowerCase()==="canvas"?Ne=Ft:ve=Ft),!ye){if(!Ne){bt(typeof document<"u","must manually specify webgl context outside of DOM environments");var Ke=nd(ve||document.body,hr,pr);if(!Ke)return null;Ne=Ke.canvas,mr=Ke.onDestroy}ue.premultipliedAlpha===void 0&&(ue.premultipliedAlpha=!0),ye=sh(Ne,ue)}return ye?{gl:ye,canvas:Ne,container:ve,extensions:nr,optionalExtensions:qe,pixelRatio:pr,profile:or,onDone:hr,onDestroy:mr}:(mr(),hr("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function id(W,yt){var Ft={};function ve(ue){bt.type(ue,"string","extension name must be string");var nr=ue.toLowerCase(),qe;try{qe=Ft[nr]=W.getExtension(nr)}catch{}return!!qe}for(var Ne=0;Ne<yt.extensions.length;++Ne){var ye=yt.extensions[Ne];if(!ve(ye))return yt.onDestroy(),yt.onDone('"'+ye+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return yt.optionalExtensions.forEach(ve),{extensions:Ft,restore:function(){Object.keys(Ft).forEach(function(ue){if(Ft[ue]&&!ve(ue))throw new Error("(regl): error restoring extension "+ue)})}}}function $i(W,yt){for(var Ft=Array(W),ve=0;ve<W;++ve)Ft[ve]=yt(ve);return Ft}var J=5120,rt=5121,at=5122,mt=5123,Mt=5124,Xt=5125,Qt=5126;function ct(W){for(var yt=16;yt<=1<<28;yt*=16)if(W<=yt)return yt;return 0}function Pt(W){var yt,Ft;return yt=(W>65535)<<4,W>>>=yt,Ft=(W>255)<<3,W>>>=Ft,yt|=Ft,Ft=(W>15)<<2,W>>>=Ft,yt|=Ft,Ft=(W>3)<<1,W>>>=Ft,yt|=Ft,yt|W>>1}function oe(){var W=$i(8,function(){return[]});function yt(ye){var ue=ct(ye),nr=W[Pt(ue)>>2];return nr.length>0?nr.pop():new ArrayBuffer(ue)}function Ft(ye){W[Pt(ye.byteLength)>>2].push(ye)}function ve(ye,ue){var nr=null;switch(ye){case J:nr=new Int8Array(yt(ue),0,ue);break;case rt:nr=new Uint8Array(yt(ue),0,ue);break;case at:nr=new Int16Array(yt(2*ue),0,ue);break;case mt:nr=new Uint16Array(yt(2*ue),0,ue);break;case Mt:nr=new Int32Array(yt(4*ue),0,ue);break;case Xt:nr=new Uint32Array(yt(4*ue),0,ue);break;case Qt:nr=new Float32Array(yt(4*ue),0,ue);break;default:return null}return nr.length!==ue?nr.subarray(0,ue):nr}function Ne(ye){Ft(ye.buffer)}return{alloc:yt,free:Ft,allocType:ve,freeType:Ne}}var Le=oe();Le.zero=oe();var tr=3408,Te=3410,Ze=3411,jr=3412,Ur=3413,Re=3414,Ar=3415,dr=33901,gr=33902,kn=3379,wr=3386,ci=34921,ea=36347,ai=36348,wi=35661,zn=35660,po=34930,pi=36349,ra=34076,Di=34024,Un=7936,oi=7937,Es=7938,qh=35724,eo=34047,Da=36063,Kh=34852,mu=3553,Ma=34067,uh=34069,Ho=33984,Ra=6408,ro=5126,ga=5121,Xs=36160,Ds=36053,uv=36064,Sl=16384,C0=function(W,yt){var Ft=1;yt.ext_texture_filter_anisotropic&&(Ft=W.getParameter(eo));var ve=1,Ne=1;yt.webgl_draw_buffers&&(ve=W.getParameter(Kh),Ne=W.getParameter(Da));var ye=!!yt.oes_texture_float;if(ye){var ue=W.createTexture();W.bindTexture(mu,ue),W.texImage2D(mu,0,Ra,1,1,0,Ra,ro,null);var nr=W.createFramebuffer();if(W.bindFramebuffer(Xs,nr),W.framebufferTexture2D(Xs,uv,mu,ue,0),W.bindTexture(mu,null),W.checkFramebufferStatus(Xs)!==Ds)ye=!1;else{W.viewport(0,0,1,1),W.clearColor(1,0,0,1),W.clear(Sl);var qe=Le.allocType(ro,4);W.readPixels(0,0,1,1,Ra,ro,qe),W.getError()?ye=!1:(W.deleteFramebuffer(nr),W.deleteTexture(ue),ye=qe[0]===1),Le.freeType(qe)}}var pr=typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),or=!0;if(!pr){var hr=W.createTexture(),mr=Le.allocType(ga,36);W.activeTexture(Ho),W.bindTexture(Ma,hr),W.texImage2D(uh,0,Ra,3,3,0,Ra,ga,mr),Le.freeType(mr),W.bindTexture(Ma,null),W.deleteTexture(hr),or=!W.getError()}return{colorBits:[W.getParameter(Te),W.getParameter(Ze),W.getParameter(jr),W.getParameter(Ur)],depthBits:W.getParameter(Re),stencilBits:W.getParameter(Ar),subpixelBits:W.getParameter(tr),extensions:Object.keys(yt).filter(function(Ke){return!!yt[Ke]}),maxAnisotropic:Ft,maxDrawbuffers:ve,maxColorAttachments:Ne,pointSizeDims:W.getParameter(dr),lineWidthDims:W.getParameter(gr),maxViewportDims:W.getParameter(wr),maxCombinedTextureUnits:W.getParameter(wi),maxCubeMapSize:W.getParameter(ra),maxRenderbufferSize:W.getParameter(Di),maxTextureUnits:W.getParameter(po),maxTextureSize:W.getParameter(kn),maxAttributes:W.getParameter(ci),maxVertexUniforms:W.getParameter(ea),maxVertexTextureUnits:W.getParameter(zn),maxVaryingVectors:W.getParameter(ai),maxFragmentUniforms:W.getParameter(pi),glsl:W.getParameter(qh),renderer:W.getParameter(oi),vendor:W.getParameter(Un),version:W.getParameter(Es),readFloat:ye,npotTextureCube:or}};function ot(W){return!!W&&typeof W=="object"&&Array.isArray(W.shape)&&Array.isArray(W.stride)&&typeof W.offset=="number"&&W.shape.length===W.stride.length&&(Array.isArray(W.data)||r(W.data))}var vt=function(W){return Object.keys(W).map(function(yt){return W[yt]})},Vt={shape:cs,flatten:xo};function me(W,yt,Ft){for(var ve=0;ve<yt;++ve)Ft[ve]=W[ve]}function ur(W,yt,Ft,ve){for(var Ne=0,ye=0;ye<yt;++ye)for(var ue=W[ye],nr=0;nr<Ft;++nr)ve[Ne++]=ue[nr]}function rn(W,yt,Ft,ve,Ne,ye){for(var ue=ye,nr=0;nr<yt;++nr)for(var qe=W[nr],pr=0;pr<Ft;++pr)for(var or=qe[pr],hr=0;hr<ve;++hr)Ne[ue++]=or[hr]}function Ri(W,yt,Ft,ve,Ne){for(var ye=1,ue=Ft+1;ue<yt.length;++ue)ye*=yt[ue];var nr=yt[Ft];if(yt.length-Ft===4){var qe=yt[Ft+1],pr=yt[Ft+2],or=yt[Ft+3];for(ue=0;ue<nr;++ue)rn(W[ue],qe,pr,or,ve,Ne),Ne+=ye}else for(ue=0;ue<nr;++ue)Ri(W[ue],yt,Ft+1,ve,Ne),Ne+=ye}function xo(W,yt,Ft,ve){var Ne=1;if(yt.length)for(var ye=0;ye<yt.length;++ye)Ne*=yt[ye];else Ne=0;var ue=ve||Le.allocType(Ft,Ne);switch(yt.length){case 0:break;case 1:me(W,yt[0],ue);break;case 2:ur(W,yt[0],yt[1],ue);break;case 3:rn(W,yt[0],yt[1],yt[2],ue,0);break;default:Ri(W,yt,0,ue,0)}return ue}function cs(W){for(var yt=[],Ft=W;Ft.length;Ft=Ft[0])yt.push(Ft.length);return yt}var Vo={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},yu=5120,k_=5122,z_=5124,tp=5121,S0=5123,cv=5125,U_=5126,Cg=5126,ws={int8:yu,int16:k_,int32:z_,uint8:tp,uint16:S0,uint32:cv,float:U_,float32:Cg},Qh=35048,Jh=35040,vc={dynamic:Qh,stream:Jh,static:35044},gc=Vt.flatten,ch=Vt.shape,hv=35044,Tl=35040,no=5121,tf=5126,hh=[];hh[5120]=1,hh[5122]=2,hh[5124]=4,hh[5121]=1,hh[5123]=2,hh[5125]=4,hh[5126]=4;function Sg(W){return Vo[Object.prototype.toString.call(W)]|0}function $_(W,yt){for(var Ft=0;Ft<yt.length;++Ft)W[Ft]=yt[Ft]}function Tg(W,yt,Ft,ve,Ne,ye,ue){for(var nr=0,qe=0;qe<Ft;++qe)for(var pr=0;pr<ve;++pr)W[nr++]=yt[Ne*qe+ye*pr+ue]}function T0(W,yt,Ft,ve){var Ne=0,ye={};function ue(ie){this.id=Ne++,this.buffer=W.createBuffer(),this.type=ie,this.usage=hv,this.byteLength=0,this.dimension=1,this.dtype=no,this.persistentData=null,Ft.profile&&(this.stats={size:0})}ue.prototype.bind=function(){W.bindBuffer(this.type,this.buffer)},ue.prototype.destroy=function(){mr(this)};var nr=[];function qe(ie,Se){var ir=nr.pop();return ir||(ir=new ue(ie)),ir.bind(),hr(ir,Se,Tl,0,1,!1),ir}function pr(ie){nr.push(ie)}function or(ie,Se,ir){ie.byteLength=Se.byteLength,W.bufferData(ie.type,Se,ir)}function hr(ie,Se,ir,Cr,We,Rr){var Je;if(ie.usage=ir,Array.isArray(Se)){if(ie.dtype=Cr||tf,Se.length>0){var Sr;if(Array.isArray(Se[0])){Je=ch(Se);for(var Xe=1,br=1;br<Je.length;++br)Xe*=Je[br];ie.dimension=Xe,Sr=gc(Se,Je,ie.dtype),or(ie,Sr,ir),Rr?ie.persistentData=Sr:Le.freeType(Sr)}else if(typeof Se[0]=="number"){ie.dimension=We;var fn=Le.allocType(ie.dtype,Se.length);$_(fn,Se),or(ie,fn,ir),Rr?ie.persistentData=fn:Le.freeType(fn)}else r(Se[0])?(ie.dimension=Se[0].length,ie.dtype=Cr||Sg(Se[0])||tf,Sr=gc(Se,[Se.length,Se[0].length],ie.dtype),or(ie,Sr,ir),Rr?ie.persistentData=Sr:Le.freeType(Sr)):bt.raise("invalid buffer data")}}else if(r(Se))ie.dtype=Cr||Sg(Se),ie.dimension=We,or(ie,Se,ir),Rr&&(ie.persistentData=new Uint8Array(new Uint8Array(Se.buffer)));else if(ot(Se)){Je=Se.shape;var Bn=Se.stride,Er=Se.offset,er=0,Ue=0,dn=0,si=0;Je.length===1?(er=Je[0],Ue=1,dn=Bn[0],si=0):Je.length===2?(er=Je[0],Ue=Je[1],dn=Bn[0],si=Bn[1]):bt.raise("invalid shape"),ie.dtype=Cr||Sg(Se.data)||tf,ie.dimension=Ue;var Ir=Le.allocType(ie.dtype,er*Ue);Tg(Ir,Se.data,er,Ue,dn,si,Er),or(ie,Ir,ir),Rr?ie.persistentData=Ir:Le.freeType(Ir)}else Se instanceof ArrayBuffer?(ie.dtype=no,ie.dimension=We,or(ie,Se,ir),Rr&&(ie.persistentData=new Uint8Array(new Uint8Array(Se)))):bt.raise("invalid buffer data")}function mr(ie){yt.bufferCount--,ve(ie);var Se=ie.buffer;bt(Se,"buffer must not be deleted already"),W.deleteBuffer(Se),ie.buffer=null,delete ye[ie.id]}function Ke(ie,Se,ir,Cr){yt.bufferCount++;var We=new ue(Se);ye[We.id]=We;function Rr(Xe){var br=hv,fn=null,Bn=0,Er=0,er=1;return Array.isArray(Xe)||r(Xe)||ot(Xe)||Xe instanceof ArrayBuffer?fn=Xe:typeof Xe=="number"?Bn=Xe|0:Xe&&(bt.type(Xe,"object","buffer arguments must be an object, a number or an array"),"data"in Xe&&(bt(fn===null||Array.isArray(fn)||r(fn)||ot(fn),"invalid data for buffer"),fn=Xe.data),"usage"in Xe&&(bt.parameter(Xe.usage,vc,"invalid buffer usage"),br=vc[Xe.usage]),"type"in Xe&&(bt.parameter(Xe.type,ws,"invalid buffer type"),Er=ws[Xe.type]),"dimension"in Xe&&(bt.type(Xe.dimension,"number","invalid dimension"),er=Xe.dimension|0),"length"in Xe&&(bt.nni(Bn,"buffer length must be a nonnegative integer"),Bn=Xe.length|0)),We.bind(),fn?hr(We,fn,br,Er,er,Cr):(Bn&&W.bufferData(We.type,Bn,br),We.dtype=Er||no,We.usage=br,We.dimension=er,We.byteLength=Bn),Ft.profile&&(We.stats.size=We.byteLength*hh[We.dtype]),Rr}function Je(Xe,br){bt(br+Xe.byteLength<=We.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+Xe.byteLength+" starting from offset "+br+" to a buffer of size "+We.byteLength),W.bufferSubData(We.type,br,Xe)}function Sr(Xe,br){var fn=(br||0)|0,Bn;if(We.bind(),r(Xe)||Xe instanceof ArrayBuffer)Je(Xe,fn);else if(Array.isArray(Xe)){if(Xe.length>0)if(typeof Xe[0]=="number"){var Er=Le.allocType(We.dtype,Xe.length);$_(Er,Xe),Je(Er,fn),Le.freeType(Er)}else if(Array.isArray(Xe[0])||r(Xe[0])){Bn=ch(Xe);var er=gc(Xe,Bn,We.dtype);Je(er,fn),Le.freeType(er)}else bt.raise("invalid buffer data")}else if(ot(Xe)){Bn=Xe.shape;var Ue=Xe.stride,dn=0,si=0,Ir=0,ti=0;Bn.length===1?(dn=Bn[0],si=1,Ir=Ue[0],ti=0):Bn.length===2?(dn=Bn[0],si=Bn[1],Ir=Ue[0],ti=Ue[1]):bt.raise("invalid shape");var Dn=Array.isArray(Xe.data)?We.dtype:Sg(Xe.data),Tn=Le.allocType(Dn,dn*si);Tg(Tn,Xe.data,dn,si,Ir,ti,Xe.offset),Je(Tn,fn),Le.freeType(Tn)}else bt.raise("invalid data for buffer subdata");return Rr}return ir||Rr(ie),Rr._reglType="buffer",Rr._buffer=We,Rr.subdata=Sr,Ft.profile&&(Rr.stats=We.stats),Rr.destroy=function(){mr(We)},Rr}function fr(){vt(ye).forEach(function(ie){ie.buffer=W.createBuffer(),W.bindBuffer(ie.type,ie.buffer),W.bufferData(ie.type,ie.persistentData||ie.byteLength,ie.usage)})}return Ft.profile&&(yt.getTotalBufferSize=function(){var ie=0;return Object.keys(ye).forEach(function(Se){ie+=ye[Se].stats.size}),ie}),{create:Ke,createStream:qe,destroyStream:pr,clear:function(){vt(ye).forEach(mr),nr.forEach(mr)},getBuffer:function(ie){return ie&&ie._buffer instanceof ue?ie._buffer:null},restore:fr,_initBuffer:hr}}var A0=0,M0=0,H_=1,V_=1,Xb=4,fv=4,mc={points:A0,point:M0,lines:H_,line:V_,triangles:Xb,triangle:fv,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},G_=0,Cs=1,ad=4,ef=5120,Zl=5121,rf=5122,_u=5123,fh=5124,ql=5125,dh=34963,nf=35040,W_=35044;function X_(W,yt,Ft,ve){var Ne={},ye=0,ue={uint8:Zl,uint16:_u};yt.oes_element_index_uint&&(ue.uint32=ql);function nr(fr){this.id=ye++,Ne[this.id]=this,this.buffer=fr,this.primType=ad,this.vertCount=0,this.type=0}nr.prototype.bind=function(){this.buffer.bind()};var qe=[];function pr(fr){var ie=qe.pop();return ie||(ie=new nr(Ft.create(null,dh,!0,!1)._buffer)),hr(ie,fr,nf,-1,-1,0,0),ie}function or(fr){qe.push(fr)}function hr(fr,ie,Se,ir,Cr,We,Rr){fr.buffer.bind();var Je;if(ie){var Sr=Rr;!Rr&&(!r(ie)||ot(ie)&&!r(ie.data))&&(Sr=yt.oes_element_index_uint?ql:_u),Ft._initBuffer(fr.buffer,ie,Se,Sr,3)}else W.bufferData(dh,We,Se),fr.buffer.dtype=Je||Zl,fr.buffer.usage=Se,fr.buffer.dimension=3,fr.buffer.byteLength=We;if(Je=Rr,!Rr){switch(fr.buffer.dtype){case Zl:case ef:Je=Zl;break;case _u:case rf:Je=_u;break;case ql:case fh:Je=ql;break;default:bt.raise("unsupported type for element array")}fr.buffer.dtype=Je}fr.type=Je,bt(Je!==ql||!!yt.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var Xe=Cr;Xe<0&&(Xe=fr.buffer.byteLength,Je===_u?Xe>>=1:Je===ql&&(Xe>>=2)),fr.vertCount=Xe;var br=ir;if(ir<0){br=ad;var fn=fr.buffer.dimension;fn===1&&(br=G_),fn===2&&(br=Cs),fn===3&&(br=ad)}fr.primType=br}function mr(fr){ve.elementsCount--,bt(fr.buffer!==null,"must not double destroy elements"),delete Ne[fr.id],fr.buffer.destroy(),fr.buffer=null}function Ke(fr,ie){var Se=Ft.create(null,dh,!0),ir=new nr(Se._buffer);ve.elementsCount++;function Cr(We){if(!We)Se(),ir.primType=ad,ir.vertCount=0,ir.type=Zl;else if(typeof We=="number")Se(We),ir.primType=ad,ir.vertCount=We|0,ir.type=Zl;else{var Rr=null,Je=W_,Sr=-1,Xe=-1,br=0,fn=0;Array.isArray(We)||r(We)||ot(We)?Rr=We:(bt.type(We,"object","invalid arguments for elements"),"data"in We&&(Rr=We.data,bt(Array.isArray(Rr)||r(Rr)||ot(Rr),"invalid data for element buffer")),"usage"in We&&(bt.parameter(We.usage,vc,"invalid element buffer usage"),Je=vc[We.usage]),"primitive"in We&&(bt.parameter(We.primitive,mc,"invalid element buffer primitive"),Sr=mc[We.primitive]),"count"in We&&(bt(typeof We.count=="number"&&We.count>=0,"invalid vertex count for elements"),Xe=We.count|0),"type"in We&&(bt.parameter(We.type,ue,"invalid buffer type"),fn=ue[We.type]),"length"in We?br=We.length|0:(br=Xe,fn===_u||fn===rf?br*=2:(fn===ql||fn===fh)&&(br*=4))),hr(ir,Rr,Je,Sr,Xe,br,fn)}return Cr}return Cr(fr),Cr._reglType="elements",Cr._elements=ir,Cr.subdata=function(We,Rr){return Se.subdata(We,Rr),Cr},Cr.destroy=function(){mr(ir)},Cr}return{create:Ke,createStream:pr,destroyStream:or,getElements:function(fr){return typeof fr=="function"&&fr._elements instanceof nr?fr._elements:null},clear:function(){vt(Ne).forEach(mr)}}}var sa=new Float32Array(1),jb=new Uint32Array(sa.buffer),Ag=5123;function R0(W){for(var yt=Le.allocType(Ag,W.length),Ft=0;Ft<W.length;++Ft)if(isNaN(W[Ft]))yt[Ft]=65535;else if(W[Ft]===1/0)yt[Ft]=31744;else if(W[Ft]===-1/0)yt[Ft]=64512;else{sa[0]=W[Ft];var ve=jb[0],Ne=ve>>>31<<15,ye=(ve<<1>>>24)-127,ue=ve>>13&1024-1;if(ye<-24)yt[Ft]=Ne;else if(ye<-14){var nr=-14-ye;yt[Ft]=Ne+(ue+1024>>nr)}else ye>15?yt[Ft]=Ne+31744:yt[Ft]=Ne+(ye+15<<10)+ue}return yt}function io(W){return Array.isArray(W)||r(W)}var I0=function(W){return!(W&W-1)&&!!W},j_=34467,al=3553,ph=34067,yc=34069,af=6408,Mg=6406,ep=6407,Wu=6409,dv=6410,of=32854,vh=32855,L0=36194,pv=32819,ba=32820,Rg=33635,Yb=34042,sf=6402,vv=34041,O0=35904,Ig=35906,gh=36193,lf=33776,od=33777,rp=33778,sd=33779,ld=35986,P0=35987,ud=34798,xu=35840,D0=35841,F0=35842,B0=35843,uf=36196,_c=5121,np=5123,gv=5125,cf=5126,Zb=10242,Lg=10243,N0=10497,Og=33071,Y_=33648,Pg=10240,k0=10241,mv=9728,z0=9729,cd=9984,U0=9985,hf=9986,Ea=9987,Dg=33170,xc=4352,ff=4353,Ci=4354,wa=34046,Kl=3317,yv=37440,ip=37441,_v=37443,Z_=37444,Fg=33984,xv=[cd,hf,U0,Ea],df=[0,Wu,dv,ep,af],Go={};Go[Wu]=Go[Mg]=Go[sf]=1,Go[vv]=Go[dv]=2,Go[ep]=Go[O0]=3,Go[af]=Go[Ig]=4;function Ha(W){return"[object "+W+"]"}var ap=Ha("HTMLCanvasElement"),$0=Ha("OffscreenCanvas"),vo=Ha("CanvasRenderingContext2D"),Wr=Ha("ImageBitmap"),ol=Ha("HTMLImageElement"),bv=Ha("HTMLVideoElement"),op=Object.keys(Vo).concat([ap,$0,vo,Wr,ol,bv]),js=[];js[_c]=1,js[cf]=4,js[gh]=2,js[np]=2,js[gv]=4;var ha=[];ha[of]=2,ha[vh]=2,ha[L0]=2,ha[vv]=4,ha[lf]=.5,ha[od]=.5,ha[rp]=1,ha[sd]=1,ha[ld]=.5,ha[P0]=1,ha[ud]=1,ha[xu]=.5,ha[D0]=.25,ha[F0]=.5,ha[B0]=.25,ha[uf]=.5;function Bg(W){return Array.isArray(W)&&(W.length===0||typeof W[0]=="number")}function _r(W){if(!Array.isArray(W))return!1;var yt=W.length;return!(yt===0||!io(W[0]))}function mh(W){return Object.prototype.toString.call(W)}function Ev(W){return mh(W)===ap}function Ng(W){return mh(W)===$0}function bu(W){return mh(W)===vo}function Al(W){return mh(W)===Wr}function kg(W){return mh(W)===ol}function zg(W){return mh(W)===bv}function Ys(W){if(!W)return!1;var yt=mh(W);return op.indexOf(yt)>=0?!0:Bg(W)||_r(W)||ot(W)}function bc(W){return Vo[Object.prototype.toString.call(W)]|0}function q_(W,yt){var Ft=yt.length;switch(W.type){case _c:case np:case gv:case cf:var ve=Le.allocType(W.type,Ft);ve.set(yt),W.data=ve;break;case gh:W.data=R0(yt);break;default:bt.raise("unsupported texture type, must specify a typed array")}}function sp(W,yt){return Le.allocType(W.type===gh?cf:W.type,yt)}function Ug(W,yt){W.type===gh?(W.data=R0(yt),Le.freeType(yt)):W.data=yt}function H0(W,yt,Ft,ve,Ne,ye){for(var ue=W.width,nr=W.height,qe=W.channels,pr=ue*nr*qe,or=sp(W,pr),hr=0,mr=0;mr<nr;++mr)for(var Ke=0;Ke<ue;++Ke)for(var fr=0;fr<qe;++fr)or[hr++]=yt[Ft*Ke+ve*mr+Ne*fr+ye];Ug(W,or)}function Ml(W,yt,Ft,ve,Ne,ye){var ue;if(typeof ha[W]<"u"?ue=ha[W]:ue=Go[W]*js[yt],ye&&(ue*=6),Ne){for(var nr=0,qe=Ft;qe>=1;)nr+=ue*qe*qe,qe/=2;return nr}else return ue*Ft*ve}function Ql(W,yt,Ft,ve,Ne,ye,ue){var nr={"don't care":xc,"dont care":xc,nice:Ci,fast:ff},qe={repeat:N0,clamp:Og,mirror:Y_},pr={nearest:mv,linear:z0},or=n({mipmap:Ea,"nearest mipmap nearest":cd,"linear mipmap nearest":U0,"nearest mipmap linear":hf,"linear mipmap linear":Ea},pr),hr={none:0,browser:Z_},mr={uint8:_c,rgba4:pv,rgb565:Rg,"rgb5 a1":ba},Ke={alpha:Mg,luminance:Wu,"luminance alpha":dv,rgb:ep,rgba:af,rgba4:of,"rgb5 a1":vh,rgb565:L0},fr={};yt.ext_srgb&&(Ke.srgb=O0,Ke.srgba=Ig),yt.oes_texture_float&&(mr.float32=mr.float=cf),yt.oes_texture_half_float&&(mr.float16=mr["half float"]=gh),yt.webgl_depth_texture&&(n(Ke,{depth:sf,"depth stencil":vv}),n(mr,{uint16:np,uint32:gv,"depth stencil":Yb})),yt.webgl_compressed_texture_s3tc&&n(fr,{"rgb s3tc dxt1":lf,"rgba s3tc dxt1":od,"rgba s3tc dxt3":rp,"rgba s3tc dxt5":sd}),yt.webgl_compressed_texture_atc&&n(fr,{"rgb atc":ld,"rgba atc explicit alpha":P0,"rgba atc interpolated alpha":ud}),yt.webgl_compressed_texture_pvrtc&&n(fr,{"rgb pvrtc 4bppv1":xu,"rgb pvrtc 2bppv1":D0,"rgba pvrtc 4bppv1":F0,"rgba pvrtc 2bppv1":B0}),yt.webgl_compressed_texture_etc1&&(fr["rgb etc1"]=uf);var ie=Array.prototype.slice.call(W.getParameter(j_));Object.keys(fr).forEach(function(It){var _e=fr[It];ie.indexOf(_e)>=0&&(Ke[It]=_e)});var Se=Object.keys(Ke);Ft.textureFormats=Se;var ir=[];Object.keys(Ke).forEach(function(It){var _e=Ke[It];ir[_e]=It});var Cr=[];Object.keys(mr).forEach(function(It){var _e=mr[It];Cr[_e]=It});var We=[];Object.keys(pr).forEach(function(It){var _e=pr[It];We[_e]=It});var Rr=[];Object.keys(or).forEach(function(It){var _e=or[It];Rr[_e]=It});var Je=[];Object.keys(qe).forEach(function(It){var _e=qe[It];Je[_e]=It});var Sr=Se.reduce(function(It,_e){var he=Ke[_e];return he===Wu||he===Mg||he===Wu||he===dv||he===sf||he===vv||yt.ext_srgb&&(he===O0||he===Ig)?It[he]=he:he===vh||_e.indexOf("rgba")>=0?It[he]=af:It[he]=ep,It},{});function Xe(){this.internalformat=af,this.format=af,this.type=_c,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Z_,this.width=0,this.height=0,this.channels=0}function br(It,_e){It.internalformat=_e.internalformat,It.format=_e.format,It.type=_e.type,It.compressed=_e.compressed,It.premultiplyAlpha=_e.premultiplyAlpha,It.flipY=_e.flipY,It.unpackAlignment=_e.unpackAlignment,It.colorSpace=_e.colorSpace,It.width=_e.width,It.height=_e.height,It.channels=_e.channels}function fn(It,_e){if(!(typeof _e!="object"||!_e)){if("premultiplyAlpha"in _e&&(bt.type(_e.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),It.premultiplyAlpha=_e.premultiplyAlpha),"flipY"in _e&&(bt.type(_e.flipY,"boolean","invalid texture flip"),It.flipY=_e.flipY),"alignment"in _e&&(bt.oneOf(_e.alignment,[1,2,4,8],"invalid texture unpack alignment"),It.unpackAlignment=_e.alignment),"colorSpace"in _e&&(bt.parameter(_e.colorSpace,hr,"invalid colorSpace"),It.colorSpace=hr[_e.colorSpace]),"type"in _e){var he=_e.type;bt(yt.oes_texture_float||!(he==="float"||he==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),bt(yt.oes_texture_half_float||!(he==="half float"||he==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),bt(yt.webgl_depth_texture||!(he==="uint16"||he==="uint32"||he==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),bt.parameter(he,mr,"invalid texture type"),It.type=mr[he]}var Pr=It.width,ei=It.height,fa=It.channels,st=!1;"shape"in _e?(bt(Array.isArray(_e.shape)&&_e.shape.length>=2,"shape must be an array"),Pr=_e.shape[0],ei=_e.shape[1],_e.shape.length===3&&(fa=_e.shape[2],bt(fa>0&&fa<=4,"invalid number of channels"),st=!0),bt(Pr>=0&&Pr<=Ft.maxTextureSize,"invalid width"),bt(ei>=0&&ei<=Ft.maxTextureSize,"invalid height")):("radius"in _e&&(Pr=ei=_e.radius,bt(Pr>=0&&Pr<=Ft.maxTextureSize,"invalid radius")),"width"in _e&&(Pr=_e.width,bt(Pr>=0&&Pr<=Ft.maxTextureSize,"invalid width")),"height"in _e&&(ei=_e.height,bt(ei>=0&&ei<=Ft.maxTextureSize,"invalid height")),"channels"in _e&&(fa=_e.channels,bt(fa>0&&fa<=4,"invalid number of channels"),st=!0)),It.width=Pr|0,It.height=ei|0,It.channels=fa|0;var wt=!1;if("format"in _e){var Bt=_e.format;bt(yt.webgl_depth_texture||!(Bt==="depth"||Bt==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),bt.parameter(Bt,Ke,"invalid texture format");var de=It.internalformat=Ke[Bt];It.format=Sr[de],Bt in mr&&("type"in _e||(It.type=mr[Bt])),Bt in fr&&(It.compressed=!0),wt=!0}!st&&wt?It.channels=Go[It.format]:st&&!wt?It.channels!==df[It.format]&&(It.format=It.internalformat=df[It.channels]):wt&&st&&bt(It.channels===Go[It.format],"number of channels inconsistent with specified format")}}function Bn(It){W.pixelStorei(yv,It.flipY),W.pixelStorei(ip,It.premultiplyAlpha),W.pixelStorei(_v,It.colorSpace),W.pixelStorei(Kl,It.unpackAlignment)}function Er(){Xe.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function er(It,_e){var he=null;if(Ys(_e)?he=_e:_e&&(bt.type(_e,"object","invalid pixel data type"),fn(It,_e),"x"in _e&&(It.xOffset=_e.x|0),"y"in _e&&(It.yOffset=_e.y|0),Ys(_e.data)&&(he=_e.data)),bt(!It.compressed||he instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),_e.copy){bt(!he,"can not specify copy and data field for the same texture");var Pr=Ne.viewportWidth,ei=Ne.viewportHeight;It.width=It.width||Pr-It.xOffset,It.height=It.height||ei-It.yOffset,It.needsCopy=!0,bt(It.xOffset>=0&&It.xOffset<Pr&&It.yOffset>=0&&It.yOffset<ei&&It.width>0&&It.width<=Pr&&It.height>0&&It.height<=ei,"copy texture read out of bounds")}else if(!he)It.width=It.width||1,It.height=It.height||1,It.channels=It.channels||4;else if(r(he))It.channels=It.channels||4,It.data=he,!("type"in _e)&&It.type===_c&&(It.type=bc(he));else if(Bg(he))It.channels=It.channels||4,q_(It,he),It.alignment=1,It.needsFree=!0;else if(ot(he)){var fa=he.data;!Array.isArray(fa)&&It.type===_c&&(It.type=bc(fa));var st=he.shape,wt=he.stride,Bt,de,ce,Ht,Yt,Jt;st.length===3?(ce=st[2],Jt=wt[2]):(bt(st.length===2,"invalid ndarray pixel data, must be 2 or 3D"),ce=1,Jt=1),Bt=st[0],de=st[1],Ht=wt[0],Yt=wt[1],It.alignment=1,It.width=Bt,It.height=de,It.channels=ce,It.format=It.internalformat=df[ce],It.needsFree=!0,H0(It,fa,Ht,Yt,Jt,he.offset)}else if(Ev(he)||Ng(he)||bu(he))Ev(he)||Ng(he)?It.element=he:It.element=he.canvas,It.width=It.element.width,It.height=It.element.height,It.channels=4;else if(Al(he))It.element=he,It.width=he.width,It.height=he.height,It.channels=4;else if(kg(he))It.element=he,It.width=he.naturalWidth,It.height=he.naturalHeight,It.channels=4;else if(zg(he))It.element=he,It.width=he.videoWidth,It.height=he.videoHeight,It.channels=4;else if(_r(he)){var Lt=It.width||he[0].length,Wt=It.height||he.length,_t=It.channels;io(he[0][0])?_t=_t||he[0][0].length:_t=_t||1;for(var jt=Vt.shape(he),be=1,Ie=0;Ie<jt.length;++Ie)be*=jt[Ie];var je=sp(It,be);Vt.flatten(he,jt,"",je),Ug(It,je),It.alignment=1,It.width=Lt,It.height=Wt,It.channels=_t,It.format=It.internalformat=df[_t],It.needsFree=!0}It.type===cf?bt(Ft.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):It.type===gh&&bt(Ft.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function Ue(It,_e,he){var Pr=It.element,ei=It.data,fa=It.internalformat,st=It.format,wt=It.type,Bt=It.width,de=It.height;Bn(It),Pr?W.texImage2D(_e,he,st,st,wt,Pr):It.compressed?W.compressedTexImage2D(_e,he,fa,Bt,de,0,ei):It.needsCopy?(ve(),W.copyTexImage2D(_e,he,st,It.xOffset,It.yOffset,Bt,de,0)):W.texImage2D(_e,he,st,Bt,de,0,st,wt,ei||null)}function dn(It,_e,he,Pr,ei){var fa=It.element,st=It.data,wt=It.internalformat,Bt=It.format,de=It.type,ce=It.width,Ht=It.height;Bn(It),fa?W.texSubImage2D(_e,ei,he,Pr,Bt,de,fa):It.compressed?W.compressedTexSubImage2D(_e,ei,he,Pr,wt,ce,Ht,st):It.needsCopy?(ve(),W.copyTexSubImage2D(_e,ei,he,Pr,It.xOffset,It.yOffset,ce,Ht)):W.texSubImage2D(_e,ei,he,Pr,ce,Ht,Bt,de,st)}var si=[];function Ir(){return si.pop()||new Er}function ti(It){It.needsFree&&Le.freeType(It.data),Er.call(It),si.push(It)}function Dn(){Xe.call(this),this.genMipmaps=!1,this.mipmapHint=xc,this.mipmask=0,this.images=Array(16)}function Tn(It,_e,he){var Pr=It.images[0]=Ir();It.mipmask=1,Pr.width=It.width=_e,Pr.height=It.height=he,Pr.channels=It.channels=4}function Hi(It,_e){var he=null;if(Ys(_e))he=It.images[0]=Ir(),br(he,It),er(he,_e),It.mipmask=1;else if(fn(It,_e),Array.isArray(_e.mipmap))for(var Pr=_e.mipmap,ei=0;ei<Pr.length;++ei)he=It.images[ei]=Ir(),br(he,It),he.width>>=ei,he.height>>=ei,er(he,Pr[ei]),It.mipmask|=1<<ei;else he=It.images[0]=Ir(),br(he,It),er(he,_e),It.mipmask=1;br(It,It.images[0]),It.compressed&&(It.internalformat===lf||It.internalformat===od||It.internalformat===rp||It.internalformat===sd)&&bt(It.width%4===0&&It.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function Io(It,_e){for(var he=It.images,Pr=0;Pr<he.length;++Pr){if(!he[Pr])return;Ue(he[Pr],_e,Pr)}}var Ts=[];function vi(){var It=Ts.pop()||new Dn;Xe.call(It),It.mipmask=0;for(var _e=0;_e<16;++_e)It.images[_e]=null;return It}function Lo(It){for(var _e=It.images,he=0;he<_e.length;++he)_e[he]&&ti(_e[he]),_e[he]=null;Ts.push(It)}function Ia(){this.minFilter=mv,this.magFilter=mv,this.wrapS=Og,this.wrapT=Og,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=xc}function Yo(It,_e){if("min"in _e){var he=_e.min;bt.parameter(he,or),It.minFilter=or[he],xv.indexOf(It.minFilter)>=0&&!("faces"in _e)&&(It.genMipmaps=!0)}if("mag"in _e){var Pr=_e.mag;bt.parameter(Pr,pr),It.magFilter=pr[Pr]}var ei=It.wrapS,fa=It.wrapT;if("wrap"in _e){var st=_e.wrap;typeof st=="string"?(bt.parameter(st,qe),ei=fa=qe[st]):Array.isArray(st)&&(bt.parameter(st[0],qe),bt.parameter(st[1],qe),ei=qe[st[0]],fa=qe[st[1]])}else{if("wrapS"in _e){var wt=_e.wrapS;bt.parameter(wt,qe),ei=qe[wt]}if("wrapT"in _e){var Bt=_e.wrapT;bt.parameter(Bt,qe),fa=qe[Bt]}}if(It.wrapS=ei,It.wrapT=fa,"anisotropic"in _e){var de=_e.anisotropic;bt(typeof de=="number"&&de>=1&&de<=Ft.maxAnisotropic,"aniso samples must be between 1 and "),It.anisotropic=_e.anisotropic}if("mipmap"in _e){var ce=!1;switch(typeof _e.mipmap){case"string":bt.parameter(_e.mipmap,nr,"invalid mipmap hint"),It.mipmapHint=nr[_e.mipmap],It.genMipmaps=!0,ce=!0;break;case"boolean":ce=It.genMipmaps=_e.mipmap;break;case"object":bt(Array.isArray(_e.mipmap),"invalid mipmap type"),It.genMipmaps=!1,ce=!0;break;default:bt.raise("invalid mipmap type")}ce&&!("min"in _e)&&(It.minFilter=cd)}}function Zo(It,_e){W.texParameteri(_e,k0,It.minFilter),W.texParameteri(_e,Pg,It.magFilter),W.texParameteri(_e,Zb,It.wrapS),W.texParameteri(_e,Lg,It.wrapT),yt.ext_texture_filter_anisotropic&&W.texParameteri(_e,wa,It.anisotropic),It.genMipmaps&&(W.hint(Dg,It.mipmapHint),W.generateMipmap(_e))}var so=0,ps={},Qs=Ft.maxTextureUnits,qo=Array(Qs).map(function(){return null});function Qn(It){Xe.call(this),this.mipmask=0,this.internalformat=af,this.id=so++,this.refCount=1,this.target=It,this.texture=W.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Ia,ue.profile&&(this.stats={size:0})}function ks(It){W.activeTexture(Fg),W.bindTexture(It.target,It.texture)}function Xi(){var It=qo[0];It?W.bindTexture(It.target,It.texture):W.bindTexture(al,null)}function En(It){var _e=It.texture;bt(_e,"must not double destroy texture");var he=It.unit,Pr=It.target;he>=0&&(W.activeTexture(Fg+he),W.bindTexture(Pr,null),qo[he]=null),W.deleteTexture(_e),It.texture=null,It.params=null,It.pixels=null,It.refCount=0,delete ps[It.id],ye.textureCount--}n(Qn.prototype,{bind:function(){var It=this;It.bindCount+=1;var _e=It.unit;if(_e<0){for(var he=0;he<Qs;++he){var Pr=qo[he];if(Pr){if(Pr.bindCount>0)continue;Pr.unit=-1}qo[he]=It,_e=he;break}_e>=Qs&&bt.raise("insufficient number of texture units"),ue.profile&&ye.maxTextureUnits<_e+1&&(ye.maxTextureUnits=_e+1),It.unit=_e,W.activeTexture(Fg+_e),W.bindTexture(It.target,It.texture)}return _e},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&En(this)}});function fi(It,_e){var he=new Qn(al);ps[he.id]=he,ye.textureCount++;function Pr(st,wt){var Bt=he.texInfo;Ia.call(Bt);var de=vi();return typeof st=="number"?typeof wt=="number"?Tn(de,st|0,wt|0):Tn(de,st|0,st|0):st?(bt.type(st,"object","invalid arguments to regl.texture"),Yo(Bt,st),Hi(de,st)):Tn(de,1,1),Bt.genMipmaps&&(de.mipmask=(de.width<<1)-1),he.mipmask=de.mipmask,br(he,de),bt.texture2D(Bt,de,Ft),he.internalformat=de.internalformat,Pr.width=de.width,Pr.height=de.height,ks(he),Io(de,al),Zo(Bt,al),Xi(),Lo(de),ue.profile&&(he.stats.size=Ml(he.internalformat,he.type,de.width,de.height,Bt.genMipmaps,!1)),Pr.format=ir[he.internalformat],Pr.type=Cr[he.type],Pr.mag=We[Bt.magFilter],Pr.min=Rr[Bt.minFilter],Pr.wrapS=Je[Bt.wrapS],Pr.wrapT=Je[Bt.wrapT],Pr}function ei(st,wt,Bt,de){bt(!!st,"must specify image data");var ce=wt|0,Ht=Bt|0,Yt=de|0,Jt=Ir();return br(Jt,he),Jt.width=0,Jt.height=0,er(Jt,st),Jt.width=Jt.width||(he.width>>Yt)-ce,Jt.height=Jt.height||(he.height>>Yt)-Ht,bt(he.type===Jt.type&&he.format===Jt.format&&he.internalformat===Jt.internalformat,"incompatible format for texture.subimage"),bt(ce>=0&&Ht>=0&&ce+Jt.width<=he.width&&Ht+Jt.height<=he.height,"texture.subimage write out of bounds"),bt(he.mipmask&1<<Yt,"missing mipmap data"),bt(Jt.data||Jt.element||Jt.needsCopy,"missing image data"),ks(he),dn(Jt,al,ce,Ht,Yt),Xi(),ti(Jt),Pr}function fa(st,wt){var Bt=st|0,de=wt|0||Bt;if(Bt===he.width&&de===he.height)return Pr;Pr.width=he.width=Bt,Pr.height=he.height=de,ks(he);for(var ce=0;he.mipmask>>ce;++ce){var Ht=Bt>>ce,Yt=de>>ce;if(!Ht||!Yt)break;W.texImage2D(al,ce,he.format,Ht,Yt,0,he.format,he.type,null)}return Xi(),ue.profile&&(he.stats.size=Ml(he.internalformat,he.type,Bt,de,!1,!1)),Pr}return Pr(It,_e),Pr.subimage=ei,Pr.resize=fa,Pr._reglType="texture2d",Pr._texture=he,ue.profile&&(Pr.stats=he.stats),Pr.destroy=function(){he.decRef()},Pr}function Fi(It,_e,he,Pr,ei,fa){var st=new Qn(ph);ps[st.id]=st,ye.cubeCount++;var wt=new Array(6);function Bt(Ht,Yt,Jt,Lt,Wt,_t){var jt,be=st.texInfo;for(Ia.call(be),jt=0;jt<6;++jt)wt[jt]=vi();if(typeof Ht=="number"||!Ht){var Ie=Ht|0||1;for(jt=0;jt<6;++jt)Tn(wt[jt],Ie,Ie)}else if(typeof Ht=="object")if(Yt)Hi(wt[0],Ht),Hi(wt[1],Yt),Hi(wt[2],Jt),Hi(wt[3],Lt),Hi(wt[4],Wt),Hi(wt[5],_t);else if(Yo(be,Ht),fn(st,Ht),"faces"in Ht){var je=Ht.faces;for(bt(Array.isArray(je)&&je.length===6,"cube faces must be a length 6 array"),jt=0;jt<6;++jt)bt(typeof je[jt]=="object"&&!!je[jt],"invalid input for cube map face"),br(wt[jt],st),Hi(wt[jt],je[jt])}else for(jt=0;jt<6;++jt)Hi(wt[jt],Ht);else bt.raise("invalid arguments to cube map");for(br(st,wt[0]),Ft.npotTextureCube||bt(I0(st.width)&&I0(st.height),"your browser does not support non power or two texture dimensions"),be.genMipmaps?st.mipmask=(wt[0].width<<1)-1:st.mipmask=wt[0].mipmask,bt.textureCube(st,be,wt,Ft),st.internalformat=wt[0].internalformat,Bt.width=wt[0].width,Bt.height=wt[0].height,ks(st),jt=0;jt<6;++jt)Io(wt[jt],yc+jt);for(Zo(be,ph),Xi(),ue.profile&&(st.stats.size=Ml(st.internalformat,st.type,Bt.width,Bt.height,be.genMipmaps,!0)),Bt.format=ir[st.internalformat],Bt.type=Cr[st.type],Bt.mag=We[be.magFilter],Bt.min=Rr[be.minFilter],Bt.wrapS=Je[be.wrapS],Bt.wrapT=Je[be.wrapT],jt=0;jt<6;++jt)Lo(wt[jt]);return Bt}function de(Ht,Yt,Jt,Lt,Wt){bt(!!Yt,"must specify image data"),bt(typeof Ht=="number"&&Ht===(Ht|0)&&Ht>=0&&Ht<6,"invalid face");var _t=Jt|0,jt=Lt|0,be=Wt|0,Ie=Ir();return br(Ie,st),Ie.width=0,Ie.height=0,er(Ie,Yt),Ie.width=Ie.width||(st.width>>be)-_t,Ie.height=Ie.height||(st.height>>be)-jt,bt(st.type===Ie.type&&st.format===Ie.format&&st.internalformat===Ie.internalformat,"incompatible format for texture.subimage"),bt(_t>=0&&jt>=0&&_t+Ie.width<=st.width&&jt+Ie.height<=st.height,"texture.subimage write out of bounds"),bt(st.mipmask&1<<be,"missing mipmap data"),bt(Ie.data||Ie.element||Ie.needsCopy,"missing image data"),ks(st),dn(Ie,yc+Ht,_t,jt,be),Xi(),ti(Ie),Bt}function ce(Ht){var Yt=Ht|0;if(Yt!==st.width){Bt.width=st.width=Yt,Bt.height=st.height=Yt,ks(st);for(var Jt=0;Jt<6;++Jt)for(var Lt=0;st.mipmask>>Lt;++Lt)W.texImage2D(yc+Jt,Lt,st.format,Yt>>Lt,Yt>>Lt,0,st.format,st.type,null);return Xi(),ue.profile&&(st.stats.size=Ml(st.internalformat,st.type,Bt.width,Bt.height,!1,!0)),Bt}}return Bt(It,_e,he,Pr,ei,fa),Bt.subimage=de,Bt.resize=ce,Bt._reglType="textureCube",Bt._texture=st,ue.profile&&(Bt.stats=st.stats),Bt.destroy=function(){st.decRef()},Bt}function Oo(){for(var It=0;It<Qs;++It)W.activeTexture(Fg+It),W.bindTexture(al,null),qo[It]=null;vt(ps).forEach(En),ye.cubeCount=0,ye.textureCount=0}ue.profile&&(ye.getTotalTextureSize=function(){var It=0;return Object.keys(ps).forEach(function(_e){It+=ps[_e].stats.size}),It});function wh(){for(var It=0;It<Qs;++It){var _e=qo[It];_e&&(_e.bindCount=0,_e.unit=-1,qo[It]=null)}vt(ps).forEach(function(he){he.texture=W.createTexture(),W.bindTexture(he.target,he.texture);for(var Pr=0;Pr<32;++Pr)if(he.mipmask&1<<Pr)if(he.target===al)W.texImage2D(al,Pr,he.internalformat,he.width>>Pr,he.height>>Pr,0,he.internalformat,he.type,null);else for(var ei=0;ei<6;++ei)W.texImage2D(yc+ei,Pr,he.internalformat,he.width>>Pr,he.height>>Pr,0,he.internalformat,he.type,null);Zo(he.texInfo,he.target)})}return{create2D:fi,createCube:Fi,clear:Oo,getTexture:function(It){return null},restore:wh}}var Vn=36161,Jl=32854,tu=32855,hs=36194,pf=33189,yh=36168,Eu=34041,Fs=35907,lp=34836,on=34842,Zr=34843,Rl=[];Rl[Jl]=2,Rl[tu]=2,Rl[hs]=2,Rl[pf]=2,Rl[yh]=1,Rl[Eu]=4,Rl[Fs]=4,Rl[lp]=16,Rl[on]=8,Rl[Zr]=6;function Bs(W,yt,Ft){return Rl[W]*yt*Ft}var Xu=function(W,yt,Ft,ve,Ne){var ye={rgba4:Jl,rgb565:hs,"rgb5 a1":tu,depth:pf,stencil:yh,"depth stencil":Eu};yt.ext_srgb&&(ye.srgba=Fs),yt.ext_color_buffer_half_float&&(ye.rgba16f=on,ye.rgb16f=Zr),yt.webgl_color_buffer_float&&(ye.rgba32f=lp);var ue=[];Object.keys(ye).forEach(function(Ke){var fr=ye[Ke];ue[fr]=Ke});var nr=0,qe={};function pr(Ke){this.id=nr++,this.refCount=1,this.renderbuffer=Ke,this.format=Jl,this.width=0,this.height=0,Ne.profile&&(this.stats={size:0})}pr.prototype.decRef=function(){--this.refCount<=0&&or(this)};function or(Ke){var fr=Ke.renderbuffer;bt(fr,"must not double destroy renderbuffer"),W.bindRenderbuffer(Vn,null),W.deleteRenderbuffer(fr),Ke.renderbuffer=null,Ke.refCount=0,delete qe[Ke.id],ve.renderbufferCount--}function hr(Ke,fr){var ie=new pr(W.createRenderbuffer());qe[ie.id]=ie,ve.renderbufferCount++;function Se(Cr,We){var Rr=0,Je=0,Sr=Jl;if(typeof Cr=="object"&&Cr){var Xe=Cr;if("shape"in Xe){var br=Xe.shape;bt(Array.isArray(br)&&br.length>=2,"invalid renderbuffer shape"),Rr=br[0]|0,Je=br[1]|0}else"radius"in Xe&&(Rr=Je=Xe.radius|0),"width"in Xe&&(Rr=Xe.width|0),"height"in Xe&&(Je=Xe.height|0);"format"in Xe&&(bt.parameter(Xe.format,ye,"invalid renderbuffer format"),Sr=ye[Xe.format])}else typeof Cr=="number"?(Rr=Cr|0,typeof We=="number"?Je=We|0:Je=Rr):Cr?bt.raise("invalid arguments to renderbuffer constructor"):Rr=Je=1;if(bt(Rr>0&&Je>0&&Rr<=Ft.maxRenderbufferSize&&Je<=Ft.maxRenderbufferSize,"invalid renderbuffer size"),!(Rr===ie.width&&Je===ie.height&&Sr===ie.format))return Se.width=ie.width=Rr,Se.height=ie.height=Je,ie.format=Sr,W.bindRenderbuffer(Vn,ie.renderbuffer),W.renderbufferStorage(Vn,Sr,Rr,Je),bt(W.getError()===0,"invalid render buffer format"),Ne.profile&&(ie.stats.size=Bs(ie.format,ie.width,ie.height)),Se.format=ue[ie.format],Se}function ir(Cr,We){var Rr=Cr|0,Je=We|0||Rr;return Rr===ie.width&&Je===ie.height||(bt(Rr>0&&Je>0&&Rr<=Ft.maxRenderbufferSize&&Je<=Ft.maxRenderbufferSize,"invalid renderbuffer size"),Se.width=ie.width=Rr,Se.height=ie.height=Je,W.bindRenderbuffer(Vn,ie.renderbuffer),W.renderbufferStorage(Vn,ie.format,Rr,Je),bt(W.getError()===0,"invalid render buffer format"),Ne.profile&&(ie.stats.size=Bs(ie.format,ie.width,ie.height))),Se}return Se(Ke,fr),Se.resize=ir,Se._reglType="renderbuffer",Se._renderbuffer=ie,Ne.profile&&(Se.stats=ie.stats),Se.destroy=function(){ie.decRef()},Se}Ne.profile&&(ve.getTotalRenderbufferSize=function(){var Ke=0;return Object.keys(qe).forEach(function(fr){Ke+=qe[fr].stats.size}),Ke});function mr(){vt(qe).forEach(function(Ke){Ke.renderbuffer=W.createRenderbuffer(),W.bindRenderbuffer(Vn,Ke.renderbuffer),W.renderbufferStorage(Vn,Ke.format,Ke.width,Ke.height)}),W.bindRenderbuffer(Vn,null)}return{create:hr,clear:function(){vt(qe).forEach(or)},restore:mr}},Va=36160,wu=36161,_h=3553,hd=34069,Wi=36064,Wo=36096,V0=36128,vf=33306,$g=36053,xh=36054,Il=36055,up=36057,Ec=36061,Hg=36193,cp=5121,wv=5126,Vg=6407,fd=6408,dd=6402,G0=[Vg,fd],wc=[];wc[fd]=4,wc[Vg]=3;var ju=[];ju[cp]=1,ju[wv]=4,ju[Hg]=2;var Gg=32854,gf=32855,Cu=36194,W0=33189,Cv=36168,Wg=34041,Xg=35907,y=34836,b=34842,_=34843,C=[Gg,gf,Cu,Xg,b,_,y],L={};L[$g]="complete",L[xh]="incomplete attachment",L[up]="incomplete dimensions",L[Il]="incomplete, missing attachment",L[Ec]="unsupported";function D(W,yt,Ft,ve,Ne,ye){var ue={cur:null,next:null,dirty:!1,setFBO:null},nr=["rgba"],qe=["rgba4","rgb565","rgb5 a1"];yt.ext_srgb&&qe.push("srgba"),yt.ext_color_buffer_half_float&&qe.push("rgba16f","rgb16f"),yt.webgl_color_buffer_float&&qe.push("rgba32f");var pr=["uint8"];yt.oes_texture_half_float&&pr.push("half float","float16"),yt.oes_texture_float&&pr.push("float","float32");function or(Er,er,Ue){this.target=Er,this.texture=er,this.renderbuffer=Ue;var dn=0,si=0;er?(dn=er.width,si=er.height):Ue&&(dn=Ue.width,si=Ue.height),this.width=dn,this.height=si}function hr(Er){Er&&(Er.texture&&Er.texture._texture.decRef(),Er.renderbuffer&&Er.renderbuffer._renderbuffer.decRef())}function mr(Er,er,Ue){if(Er)if(Er.texture){var dn=Er.texture._texture,si=Math.max(1,dn.width),Ir=Math.max(1,dn.height);bt(si===er&&Ir===Ue,"inconsistent width/height for supplied texture"),dn.refCount+=1}else{var ti=Er.renderbuffer._renderbuffer;bt(ti.width===er&&ti.height===Ue,"inconsistent width/height for renderbuffer"),ti.refCount+=1}}function Ke(Er,er){er&&(er.texture?W.framebufferTexture2D(Va,Er,er.target,er.texture._texture.texture,0):W.framebufferRenderbuffer(Va,Er,wu,er.renderbuffer._renderbuffer.renderbuffer))}function fr(Er){var er=_h,Ue=null,dn=null,si=Er;typeof Er=="object"&&(si=Er.data,"target"in Er&&(er=Er.target|0)),bt.type(si,"function","invalid attachment data");var Ir=si._reglType;return Ir==="texture2d"?(Ue=si,bt(er===_h)):Ir==="textureCube"?(Ue=si,bt(er>=hd&&er<hd+6,"invalid cube map target")):Ir==="renderbuffer"?(dn=si,er=wu):bt.raise("invalid regl object for attachment"),new or(er,Ue,dn)}function ie(Er,er,Ue,dn,si){if(Ue){var Ir=ve.create2D({width:Er,height:er,format:dn,type:si});return Ir._texture.refCount=0,new or(_h,Ir,null)}else{var ti=Ne.create({width:Er,height:er,format:dn});return ti._renderbuffer.refCount=0,new or(wu,null,ti)}}function Se(Er){return Er&&(Er.texture||Er.renderbuffer)}function ir(Er,er,Ue){Er&&(Er.texture?Er.texture.resize(er,Ue):Er.renderbuffer&&Er.renderbuffer.resize(er,Ue),Er.width=er,Er.height=Ue)}var Cr=0,We={};function Rr(){this.id=Cr++,We[this.id]=this,this.framebuffer=W.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function Je(Er){Er.colorAttachments.forEach(hr),hr(Er.depthAttachment),hr(Er.stencilAttachment),hr(Er.depthStencilAttachment)}function Sr(Er){var er=Er.framebuffer;bt(er,"must not double destroy framebuffer"),W.deleteFramebuffer(er),Er.framebuffer=null,ye.framebufferCount--,delete We[Er.id]}function Xe(Er){var er;W.bindFramebuffer(Va,Er.framebuffer);var Ue=Er.colorAttachments;for(er=0;er<Ue.length;++er)Ke(Wi+er,Ue[er]);for(er=Ue.length;er<Ft.maxColorAttachments;++er)W.framebufferTexture2D(Va,Wi+er,_h,null,0);W.framebufferTexture2D(Va,vf,_h,null,0),W.framebufferTexture2D(Va,Wo,_h,null,0),W.framebufferTexture2D(Va,V0,_h,null,0),Ke(Wo,Er.depthAttachment),Ke(V0,Er.stencilAttachment),Ke(vf,Er.depthStencilAttachment);var dn=W.checkFramebufferStatus(Va);!W.isContextLost()&&dn!==$g&&bt.raise("framebuffer configuration not supported, status = "+L[dn]),W.bindFramebuffer(Va,ue.next?ue.next.framebuffer:null),ue.cur=ue.next,W.getError()}function br(Er,er){var Ue=new Rr;ye.framebufferCount++;function dn(Ir,ti){var Dn;bt(ue.next!==Ue,"can not update framebuffer which is currently in use");var Tn=0,Hi=0,Io=!0,Ts=!0,vi=null,Lo=!0,Ia="rgba",Yo="uint8",Zo=1,so=null,ps=null,Qs=null,qo=!1;if(typeof Ir=="number")Tn=Ir|0,Hi=ti|0||Tn;else if(!Ir)Tn=Hi=1;else{bt.type(Ir,"object","invalid arguments for framebuffer");var Qn=Ir;if("shape"in Qn){var ks=Qn.shape;bt(Array.isArray(ks)&&ks.length>=2,"invalid shape for framebuffer"),Tn=ks[0],Hi=ks[1]}else"radius"in Qn&&(Tn=Hi=Qn.radius),"width"in Qn&&(Tn=Qn.width),"height"in Qn&&(Hi=Qn.height);("color"in Qn||"colors"in Qn)&&(vi=Qn.color||Qn.colors,Array.isArray(vi)&&bt(vi.length===1||yt.webgl_draw_buffers,"multiple render targets not supported")),vi||("colorCount"in Qn&&(Zo=Qn.colorCount|0,bt(Zo>0,"invalid color buffer count")),"colorTexture"in Qn&&(Lo=!!Qn.colorTexture,Ia="rgba4"),"colorType"in Qn&&(Yo=Qn.colorType,Lo?(bt(yt.oes_texture_float||!(Yo==="float"||Yo==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),bt(yt.oes_texture_half_float||!(Yo==="half float"||Yo==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):Yo==="half float"||Yo==="float16"?(bt(yt.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),Ia="rgba16f"):(Yo==="float"||Yo==="float32")&&(bt(yt.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),Ia="rgba32f"),bt.oneOf(Yo,pr,"invalid color type")),"colorFormat"in Qn&&(Ia=Qn.colorFormat,nr.indexOf(Ia)>=0?Lo=!0:qe.indexOf(Ia)>=0?Lo=!1:Lo?bt.oneOf(Qn.colorFormat,nr,"invalid color format for texture"):bt.oneOf(Qn.colorFormat,qe,"invalid color format for renderbuffer"))),("depthTexture"in Qn||"depthStencilTexture"in Qn)&&(qo=!!(Qn.depthTexture||Qn.depthStencilTexture),bt(!qo||yt.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in Qn&&(typeof Qn.depth=="boolean"?Io=Qn.depth:(so=Qn.depth,Ts=!1)),"stencil"in Qn&&(typeof Qn.stencil=="boolean"?Ts=Qn.stencil:(ps=Qn.stencil,Io=!1)),"depthStencil"in Qn&&(typeof Qn.depthStencil=="boolean"?Io=Ts=Qn.depthStencil:(Qs=Qn.depthStencil,Io=!1,Ts=!1))}var Xi=null,En=null,fi=null,Fi=null;if(Array.isArray(vi))Xi=vi.map(fr);else if(vi)Xi=[fr(vi)];else for(Xi=new Array(Zo),Dn=0;Dn<Zo;++Dn)Xi[Dn]=ie(Tn,Hi,Lo,Ia,Yo);bt(yt.webgl_draw_buffers||Xi.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),bt(Xi.length<=Ft.maxColorAttachments,"too many color attachments, not supported"),Tn=Tn||Xi[0].width,Hi=Hi||Xi[0].height,so?En=fr(so):Io&&!Ts&&(En=ie(Tn,Hi,qo,"depth","uint32")),ps?fi=fr(ps):Ts&&!Io&&(fi=ie(Tn,Hi,!1,"stencil","uint8")),Qs?Fi=fr(Qs):!so&&!ps&&Ts&&Io&&(Fi=ie(Tn,Hi,qo,"depth stencil","depth stencil")),bt(!!so+!!ps+!!Qs<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var Oo=null;for(Dn=0;Dn<Xi.length;++Dn)if(mr(Xi[Dn],Tn,Hi),bt(!Xi[Dn]||Xi[Dn].texture&&G0.indexOf(Xi[Dn].texture._texture.format)>=0||Xi[Dn].renderbuffer&&C.indexOf(Xi[Dn].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+Dn+" is invalid"),Xi[Dn]&&Xi[Dn].texture){var wh=wc[Xi[Dn].texture._texture.format]*ju[Xi[Dn].texture._texture.type];Oo===null?Oo=wh:bt(Oo===wh,"all color attachments much have the same number of bits per pixel.")}return mr(En,Tn,Hi),bt(!En||En.texture&&En.texture._texture.format===dd||En.renderbuffer&&En.renderbuffer._renderbuffer.format===W0,"invalid depth attachment for framebuffer object"),mr(fi,Tn,Hi),bt(!fi||fi.renderbuffer&&fi.renderbuffer._renderbuffer.format===Cv,"invalid stencil attachment for framebuffer object"),mr(Fi,Tn,Hi),bt(!Fi||Fi.texture&&Fi.texture._texture.format===Wg||Fi.renderbuffer&&Fi.renderbuffer._renderbuffer.format===Wg,"invalid depth-stencil attachment for framebuffer object"),Je(Ue),Ue.width=Tn,Ue.height=Hi,Ue.colorAttachments=Xi,Ue.depthAttachment=En,Ue.stencilAttachment=fi,Ue.depthStencilAttachment=Fi,dn.color=Xi.map(Se),dn.depth=Se(En),dn.stencil=Se(fi),dn.depthStencil=Se(Fi),dn.width=Ue.width,dn.height=Ue.height,Xe(Ue),dn}function si(Ir,ti){bt(ue.next!==Ue,"can not resize a framebuffer which is currently in use");var Dn=Math.max(Ir|0,1),Tn=Math.max(ti|0||Dn,1);if(Dn===Ue.width&&Tn===Ue.height)return dn;for(var Hi=Ue.colorAttachments,Io=0;Io<Hi.length;++Io)ir(Hi[Io],Dn,Tn);return ir(Ue.depthAttachment,Dn,Tn),ir(Ue.stencilAttachment,Dn,Tn),ir(Ue.depthStencilAttachment,Dn,Tn),Ue.width=dn.width=Dn,Ue.height=dn.height=Tn,Xe(Ue),dn}return dn(Er,er),n(dn,{resize:si,_reglType:"framebuffer",_framebuffer:Ue,destroy:function(){Sr(Ue),Je(Ue)},use:function(Ir){ue.setFBO({framebuffer:dn},Ir)}})}function fn(Er){var er=Array(6);function Ue(si){var Ir;bt(er.indexOf(ue.next)<0,"can not update framebuffer which is currently in use");var ti={color:null},Dn=0,Tn=null,Hi="rgba",Io="uint8",Ts=1;if(typeof si=="number")Dn=si|0;else if(!si)Dn=1;else{bt.type(si,"object","invalid arguments for framebuffer");var vi=si;if("shape"in vi){var Lo=vi.shape;bt(Array.isArray(Lo)&&Lo.length>=2,"invalid shape for framebuffer"),bt(Lo[0]===Lo[1],"cube framebuffer must be square"),Dn=Lo[0]}else"radius"in vi&&(Dn=vi.radius|0),"width"in vi?(Dn=vi.width|0,"height"in vi&&bt(vi.height===Dn,"must be square")):"height"in vi&&(Dn=vi.height|0);("color"in vi||"colors"in vi)&&(Tn=vi.color||vi.colors,Array.isArray(Tn)&&bt(Tn.length===1||yt.webgl_draw_buffers,"multiple render targets not supported")),Tn||("colorCount"in vi&&(Ts=vi.colorCount|0,bt(Ts>0,"invalid color buffer count")),"colorType"in vi&&(bt.oneOf(vi.colorType,pr,"invalid color type"),Io=vi.colorType),"colorFormat"in vi&&(Hi=vi.colorFormat,bt.oneOf(vi.colorFormat,nr,"invalid color format for texture"))),"depth"in vi&&(ti.depth=vi.depth),"stencil"in vi&&(ti.stencil=vi.stencil),"depthStencil"in vi&&(ti.depthStencil=vi.depthStencil)}var Ia;if(Tn)if(Array.isArray(Tn))for(Ia=[],Ir=0;Ir<Tn.length;++Ir)Ia[Ir]=Tn[Ir];else Ia=[Tn];else{Ia=Array(Ts);var Yo={radius:Dn,format:Hi,type:Io};for(Ir=0;Ir<Ts;++Ir)Ia[Ir]=ve.createCube(Yo)}for(ti.color=Array(Ia.length),Ir=0;Ir<Ia.length;++Ir){var Zo=Ia[Ir];bt(typeof Zo=="function"&&Zo._reglType==="textureCube","invalid cube map"),Dn=Dn||Zo.width,bt(Zo.width===Dn&&Zo.height===Dn,"invalid cube map shape"),ti.color[Ir]={target:hd,data:Ia[Ir]}}for(Ir=0;Ir<6;++Ir){for(var so=0;so<Ia.length;++so)ti.color[so].target=hd+Ir;Ir>0&&(ti.depth=er[0].depth,ti.stencil=er[0].stencil,ti.depthStencil=er[0].depthStencil),er[Ir]?er[Ir](ti):er[Ir]=br(ti)}return n(Ue,{width:Dn,height:Dn,color:Ia})}function dn(si){var Ir,ti=si|0;if(bt(ti>0&&ti<=Ft.maxCubeMapSize,"invalid radius for cube fbo"),ti===Ue.width)return Ue;var Dn=Ue.color;for(Ir=0;Ir<Dn.length;++Ir)Dn[Ir].resize(ti);for(Ir=0;Ir<6;++Ir)er[Ir].resize(ti);return Ue.width=Ue.height=ti,Ue}return Ue(Er),n(Ue,{faces:er,resize:dn,_reglType:"framebufferCube",destroy:function(){er.forEach(function(si){si.destroy()})}})}function Bn(){ue.cur=null,ue.next=null,ue.dirty=!0,vt(We).forEach(function(Er){Er.framebuffer=W.createFramebuffer(),Xe(Er)})}return n(ue,{getFramebuffer:function(Er){if(typeof Er=="function"&&Er._reglType==="framebuffer"){var er=Er._framebuffer;if(er instanceof Rr)return er}return null},create:br,createCube:fn,clear:function(){vt(We).forEach(Sr)},restore:Bn})}var F=5126,$=34962;function j(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=F,this.offset=0,this.stride=0,this.divisor=0}function et(W,yt,Ft,ve,Ne){for(var ye=Ft.maxAttributes,ue=new Array(ye),nr=0;nr<ye;++nr)ue[nr]=new j;var qe=0,pr={},or={Record:j,scope:{},state:ue,currentVAO:null,targetVAO:null,restore:mr()?We:function(){},createVAO:Rr,getVAO:fr,destroyBuffer:hr,setVAO:mr()?ie:Se,clear:mr()?ir:function(){}};function hr(Je){for(var Sr=0;Sr<ue.length;++Sr){var Xe=ue[Sr];Xe.buffer===Je&&(W.disableVertexAttribArray(Sr),Xe.buffer=null)}}function mr(){return yt.oes_vertex_array_object}function Ke(){return yt.angle_instanced_arrays}function fr(Je){return typeof Je=="function"&&Je._vao?Je._vao:null}function ie(Je){if(Je!==or.currentVAO){var Sr=mr();Je?Sr.bindVertexArrayOES(Je.vao):Sr.bindVertexArrayOES(null),or.currentVAO=Je}}function Se(Je){if(Je!==or.currentVAO){if(Je)Je.bindAttrs();else for(var Sr=Ke(),Xe=0;Xe<ue.length;++Xe){var br=ue[Xe];br.buffer?(W.enableVertexAttribArray(Xe),W.vertexAttribPointer(Xe,br.size,br.type,br.normalized,br.stride,br.offfset),Sr&&Sr.vertexAttribDivisorANGLE(Xe,br.divisor)):(W.disableVertexAttribArray(Xe),W.vertexAttrib4f(Xe,br.x,br.y,br.z,br.w))}or.currentVAO=Je}}function ir(){vt(pr).forEach(function(Je){Je.destroy()})}function Cr(){this.id=++qe,this.attributes=[];var Je=mr();Je?this.vao=Je.createVertexArrayOES():this.vao=null,pr[this.id]=this,this.buffers=[]}Cr.prototype.bindAttrs=function(){for(var Je=Ke(),Sr=this.attributes,Xe=0;Xe<Sr.length;++Xe){var br=Sr[Xe];br.buffer?(W.enableVertexAttribArray(Xe),W.bindBuffer($,br.buffer.buffer),W.vertexAttribPointer(Xe,br.size,br.type,br.normalized,br.stride,br.offset),Je&&Je.vertexAttribDivisorANGLE(Xe,br.divisor)):(W.disableVertexAttribArray(Xe),W.vertexAttrib4f(Xe,br.x,br.y,br.z,br.w))}for(var fn=Sr.length;fn<ye;++fn)W.disableVertexAttribArray(fn)},Cr.prototype.refresh=function(){var Je=mr();Je&&(Je.bindVertexArrayOES(this.vao),this.bindAttrs(),or.currentVAO=this)},Cr.prototype.destroy=function(){if(this.vao){var Je=mr();this===or.currentVAO&&(or.currentVAO=null,Je.bindVertexArrayOES(null)),Je.deleteVertexArrayOES(this.vao),this.vao=null}pr[this.id]&&(delete pr[this.id],ve.vaoCount-=1)};function We(){var Je=mr();Je&&vt(pr).forEach(function(Sr){Sr.refresh()})}function Rr(Je){var Sr=new Cr;ve.vaoCount+=1;function Xe(br){bt(Array.isArray(br),"arguments to vertex array constructor must be an array"),bt(br.length<ye,"too many attributes"),bt(br.length>0,"must specify at least one attribute");for(var fn=0;fn<Sr.buffers.length;++fn)Sr.buffers[fn].destroy();Sr.buffers.length=0;var Bn=Sr.attributes;Bn.length=br.length;for(var Er=0;Er<br.length;++Er){var er=br[Er],Ue=Bn[Er]=new j;if(Array.isArray(er)||r(er)||ot(er)){var dn=Ne.create(er,$,!1,!0);Ue.buffer=Ne.getBuffer(dn),Ue.size=Ue.buffer.dimension|0,Ue.normalized=!1,Ue.type=Ue.buffer.dtype,Ue.offset=0,Ue.stride=0,Ue.divisor=0,Ue.state=1,Sr.buffers.push(dn)}else Ne.getBuffer(er)?(Ue.buffer=Ne.getBuffer(er),Ue.size=Ue.buffer.dimension|0,Ue.normalized=!1,Ue.type=Ue.buffer.dtype,Ue.offset=0,Ue.stride=0,Ue.divisor=0,Ue.state=1):Ne.getBuffer(er.buffer)?(Ue.buffer=Ne.getBuffer(er.buffer),Ue.size=(+er.size||Ue.buffer.dimension)|0,Ue.normalized=!!er.normalized||!1,"type"in er?(bt.parameter(er.type,ws,"invalid buffer type"),Ue.type=ws[er.type]):Ue.type=Ue.buffer.dtype,Ue.offset=(er.offset||0)|0,Ue.stride=(er.stride||0)|0,Ue.divisor=(er.divisor||0)|0,Ue.state=1,bt(Ue.size>=1&&Ue.size<=4,"size must be between 1 and 4"),bt(Ue.offset>=0,"invalid offset"),bt(Ue.stride>=0&&Ue.stride<=255,"stride must be between 0 and 255"),bt(Ue.divisor>=0,"divisor must be positive"),bt(!Ue.divisor||!!yt.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in er?(bt(Er>0,"first attribute must not be a constant"),Ue.x=+er.x||0,Ue.y=+er.y||0,Ue.z=+er.z||0,Ue.w=+er.w||0,Ue.state=2):bt(!1,"invalid attribute spec for location "+Er)}return Sr.refresh(),Xe}return Xe.destroy=function(){Sr.destroy()},Xe._vao=Sr,Xe._reglType="vao",Xe(Je)}return or}var ut=35632,ht=35633,dt=35718,Ot=35721;function At(W,yt,Ft,ve){var Ne={},ye={};function ue(ie,Se,ir,Cr){this.name=ie,this.id=Se,this.location=ir,this.info=Cr}function nr(ie,Se){for(var ir=0;ir<ie.length;++ir)if(ie[ir].id===Se.id){ie[ir].location=Se.location;return}ie.push(Se)}function qe(ie,Se,ir){var Cr=ie===ut?Ne:ye,We=Cr[Se];if(!We){var Rr=yt.str(Se);We=W.createShader(ie),W.shaderSource(We,Rr),W.compileShader(We),bt.shaderError(W,We,Rr,ie,ir),Cr[Se]=We}return We}var pr={},or=[],hr=0;function mr(ie,Se){this.id=hr++,this.fragId=ie,this.vertId=Se,this.program=null,this.uniforms=[],this.attributes=[],ve.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function Ke(ie,Se,ir){var Cr,We,Rr=qe(ut,ie.fragId),Je=qe(ht,ie.vertId),Sr=ie.program=W.createProgram();if(W.attachShader(Sr,Rr),W.attachShader(Sr,Je),ir)for(Cr=0;Cr<ir.length;++Cr){var Xe=ir[Cr];W.bindAttribLocation(Sr,Xe[0],Xe[1])}W.linkProgram(Sr),bt.linkError(W,Sr,yt.str(ie.fragId),yt.str(ie.vertId),Se);var br=W.getProgramParameter(Sr,dt);ve.profile&&(ie.stats.uniformsCount=br);var fn=ie.uniforms;for(Cr=0;Cr<br;++Cr)if(We=W.getActiveUniform(Sr,Cr),We)if(We.size>1)for(var Bn=0;Bn<We.size;++Bn){var Er=We.name.replace("[0]","["+Bn+"]");nr(fn,new ue(Er,yt.id(Er),W.getUniformLocation(Sr,Er),We))}else nr(fn,new ue(We.name,yt.id(We.name),W.getUniformLocation(Sr,We.name),We));var er=W.getProgramParameter(Sr,Ot);ve.profile&&(ie.stats.attributesCount=er);var Ue=ie.attributes;for(Cr=0;Cr<er;++Cr)We=W.getActiveAttrib(Sr,Cr),We&&nr(Ue,new ue(We.name,yt.id(We.name),W.getAttribLocation(Sr,We.name),We))}ve.profile&&(Ft.getMaxUniformsCount=function(){var ie=0;return or.forEach(function(Se){Se.stats.uniformsCount>ie&&(ie=Se.stats.uniformsCount)}),ie},Ft.getMaxAttributesCount=function(){var ie=0;return or.forEach(function(Se){Se.stats.attributesCount>ie&&(ie=Se.stats.attributesCount)}),ie});function fr(){Ne={},ye={};for(var ie=0;ie<or.length;++ie)Ke(or[ie],null,or[ie].attributes.map(function(Se){return[Se.location,Se.name]}))}return{clear:function(){var ie=W.deleteShader.bind(W);vt(Ne).forEach(ie),Ne={},vt(ye).forEach(ie),ye={},or.forEach(function(Se){W.deleteProgram(Se.program)}),or.length=0,pr={},Ft.shaderCount=0},program:function(ie,Se,ir,Cr){bt.command(ie>=0,"missing vertex shader",ir),bt.command(Se>=0,"missing fragment shader",ir);var We=pr[Se];We||(We=pr[Se]={});var Rr=We[ie];if(Rr&&!Cr)return Rr;var Je=new mr(Se,ie);return Ft.shaderCount++,Ke(Je,ir,Cr),Rr||(We[ie]=Je),or.push(Je),Je},restore:fr,shader:qe,frag:-1,vert:-1}}var $t=6408,Ct=5121,zt=3333,qt=5126;function se(W,yt,Ft,ve,Ne,ye,ue){function nr(or){var hr;yt.next===null?(bt(Ne.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),hr=Ct):(bt(yt.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),hr=yt.next.colorAttachments[0].texture._texture.type,ye.oes_texture_float?(bt(hr===Ct||hr===qt,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),hr===qt&&bt(ue.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):bt(hr===Ct,"Reading from a framebuffer is only allowed for the type 'uint8'"));var mr=0,Ke=0,fr=ve.framebufferWidth,ie=ve.framebufferHeight,Se=null;r(or)?Se=or:or&&(bt.type(or,"object","invalid arguments to regl.read()"),mr=or.x|0,Ke=or.y|0,bt(mr>=0&&mr<ve.framebufferWidth,"invalid x offset for regl.read"),bt(Ke>=0&&Ke<ve.framebufferHeight,"invalid y offset for regl.read"),fr=(or.width||ve.framebufferWidth-mr)|0,ie=(or.height||ve.framebufferHeight-Ke)|0,Se=or.data||null),Se&&(hr===Ct?bt(Se instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):hr===qt&&bt(Se instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),bt(fr>0&&fr+mr<=ve.framebufferWidth,"invalid width for read pixels"),bt(ie>0&&ie+Ke<=ve.framebufferHeight,"invalid height for read pixels"),Ft();var ir=fr*ie*4;return Se||(hr===Ct?Se=new Uint8Array(ir):hr===qt&&(Se=Se||new Float32Array(ir))),bt.isTypedArray(Se,"data buffer for regl.read() must be a typedarray"),bt(Se.byteLength>=ir,"data buffer for regl.read() too small"),W.pixelStorei(zt,4),W.readPixels(mr,Ke,fr,ie,$t,hr,Se),Se}function qe(or){var hr;return yt.setFBO({framebuffer:or.framebuffer},function(){hr=nr(or)}),hr}function pr(or){return!or||!("framebuffer"in or)?nr(or):qe(or)}return pr}function Ee(W){return Array.prototype.slice.call(W)}function pe(W){return Ee(W).join("")}function Ae(){var W=0,yt=[],Ft=[];function ve(hr){for(var mr=0;mr<Ft.length;++mr)if(Ft[mr]===hr)return yt[mr];var Ke="g"+W++;return yt.push(Ke),Ft.push(hr),Ke}function Ne(){var hr=[];function mr(){hr.push.apply(hr,Ee(arguments))}var Ke=[];function fr(){var ie="v"+W++;return Ke.push(ie),arguments.length>0&&(hr.push(ie,"="),hr.push.apply(hr,Ee(arguments)),hr.push(";")),ie}return n(mr,{def:fr,toString:function(){return pe([Ke.length>0?"var "+Ke.join(",")+";":"",pe(hr)])}})}function ye(){var hr=Ne(),mr=Ne(),Ke=hr.toString,fr=mr.toString;function ie(Se,ir){mr(Se,ir,"=",hr.def(Se,ir),";")}return n(function(){hr.apply(hr,Ee(arguments))},{def:hr.def,entry:hr,exit:mr,save:ie,set:function(Se,ir,Cr){ie(Se,ir),hr(Se,ir,"=",Cr,";")},toString:function(){return Ke()+fr()}})}function ue(){var hr=pe(arguments),mr=ye(),Ke=ye(),fr=mr.toString,ie=Ke.toString;return n(mr,{then:function(){return mr.apply(mr,Ee(arguments)),this},else:function(){return Ke.apply(Ke,Ee(arguments)),this},toString:function(){var Se=ie();return Se&&(Se="else{"+Se+"}"),pe(["if(",hr,"){",fr(),"}",Se])}})}var nr=Ne(),qe={};function pr(hr,mr){var Ke=[];function fr(){var We="a"+Ke.length;return Ke.push(We),We}mr=mr||0;for(var ie=0;ie<mr;++ie)fr();var Se=ye(),ir=Se.toString,Cr=qe[hr]=n(Se,{arg:fr,toString:function(){return pe(["function(",Ke.join(),"){",ir(),"}"])}});return Cr}function or(){var hr=['"use strict";',nr,"return {"];Object.keys(qe).forEach(function(fr){hr.push('"',fr,'":',qe[fr].toString(),",")}),hr.push("}");var mr=pe(hr).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),Ke=Function.apply(null,yt.concat(mr));return Ke.apply(null,Ft)}return{global:nr,link:ve,block:Ne,proc:pr,scope:ye,cond:ue,compile:or}}var Ve="xyzw".split(""),cr=5121,ar=1,Mr=2,sn=0,hn=1,cn=2,Ii=3,kr=4,Ln="dither",Xn="blend.enable",Rn="blend.color",Cn="blend.equation",$n="blend.func",Sn="depth.enable",bn="depth.func",Mo="depth.range",ja="depth.mask",fs="colorMask",Xo="cull.enable",Ga="cull.face",Ya="frontFace",Zs="lineWidth",Ns="polygonOffset.enable",Cc="polygonOffset.offset",qs="sample.alpha",Su="sample.enable",Ll="sample.coverage",hp="stencil.enable",pd="stencil.mask",Sc="stencil.func",mf="stencil.opFront",bh="stencil.opBack",Yu="scissor.enable",yf="scissor.box",Ss="viewport",ao="profile",sl="framebuffer",Tu="vert",Zu="frag",_i="elements",ds="primitive",Ro="count",Tc="offset",jg="instances",_f="vao",X0="Width",vd="Height",gd=sl+X0,qu=sl+vd,Yg=Ss+X0,qb=Ss+vd,fp="drawingBuffer",ll=fp+X0,l2=fp+vd,u2=[$n,Cn,Sc,mf,bh,Ll,Ss,yf,Cc],Zg=34962,hL=34963,fL=35632,dL=35633,K_=3553,pL=34067,Q_=2884,c2=3042,dp=3024,j0=2960,vL=2929,gL=3089,mL=32823,yL=32926,_L=32928,Kb=5126,J_=35664,qg=35665,t1=35666,pp=5124,e1=35667,oo=35668,Sv=35669,r1=35670,Tv=35671,Av=35672,vp=35673,Kg=35674,Qg=35675,md=35676,Mv=35678,Rv=35680,h2=4,yd=1028,Iv=1029,n1=2304,Qb=2305,Jb=32775,tE=32776,Eh=519,gp=7680,f2=0,d2=1,p2=32774,v2=513,Lv=36160,xL=36064,xf={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},eE=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Ov={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},mp={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},g2={frag:fL,vert:dL},yp={cw:n1,ccw:Qb};function i1(W){return Array.isArray(W)||r(W)||ot(W)}function a1(W){return W.sort(function(yt,Ft){return yt===Ss?-1:Ft===Ss?1:yt<Ft?-1:1})}function ul(W,yt,Ft,ve){this.thisDep=W,this.contextDep=yt,this.propDep=Ft,this.append=ve}function Ks(W){return W&&!(W.thisDep||W.contextDep||W.propDep)}function jo(W){return new ul(!1,!1,!1,W)}function Au(W,yt){var Ft=W.type;if(Ft===sn){var ve=W.data.length;return new ul(!0,ve>=1,ve>=2,yt)}else if(Ft===kr){var Ne=W.data;return new ul(Ne.thisDep,Ne.contextDep,Ne.propDep,yt)}else return new ul(Ft===Ii,Ft===cn,Ft===hn,yt)}var m2=new ul(!1,!1,!1,function(){});function Y0(W,yt,Ft,ve,Ne,ye,ue,nr,qe,pr,or,hr,mr,Ke,fr){var ie=pr.Record,Se={add:32774,subtract:32778,"reverse subtract":32779};Ft.ext_blend_minmax&&(Se.min=Jb,Se.max=tE);var ir=Ft.angle_instanced_arrays,Cr=Ft.webgl_draw_buffers,We={dirty:!0,profile:fr.profile},Rr={},Je=[],Sr={},Xe={};function br(st){return st.replace(".","_")}function fn(st,wt,Bt){var de=br(st);Je.push(st),Rr[de]=We[de]=!!Bt,Sr[de]=wt}function Bn(st,wt,Bt){var de=br(st);Je.push(st),Array.isArray(Bt)?(We[de]=Bt.slice(),Rr[de]=Bt.slice()):We[de]=Rr[de]=Bt,Xe[de]=wt}fn(Ln,dp),fn(Xn,c2),Bn(Rn,"blendColor",[0,0,0,0]),Bn(Cn,"blendEquationSeparate",[p2,p2]),Bn($n,"blendFuncSeparate",[d2,f2,d2,f2]),fn(Sn,vL,!0),Bn(bn,"depthFunc",v2),Bn(Mo,"depthRange",[0,1]),Bn(ja,"depthMask",!0),Bn(fs,fs,[!0,!0,!0,!0]),fn(Xo,Q_),Bn(Ga,"cullFace",Iv),Bn(Ya,Ya,Qb),Bn(Zs,Zs,1),fn(Ns,mL),Bn(Cc,"polygonOffset",[0,0]),fn(qs,yL),fn(Su,_L),Bn(Ll,"sampleCoverage",[1,!1]),fn(hp,j0),Bn(pd,"stencilMask",-1),Bn(Sc,"stencilFunc",[Eh,0,-1]),Bn(mf,"stencilOpSeparate",[yd,gp,gp,gp]),Bn(bh,"stencilOpSeparate",[Iv,gp,gp,gp]),fn(Yu,gL),Bn(yf,"scissor",[0,0,W.drawingBufferWidth,W.drawingBufferHeight]),Bn(Ss,Ss,[0,0,W.drawingBufferWidth,W.drawingBufferHeight]);var Er={gl:W,context:mr,strings:yt,next:Rr,current:We,draw:hr,elements:ye,buffer:Ne,shader:or,attributes:pr.state,vao:pr,uniforms:qe,framebuffer:nr,extensions:Ft,timer:Ke,isBufferArgs:i1},er={primTypes:mc,compareFuncs:Ov,blendFuncs:xf,blendEquations:Se,stencilOps:mp,glTypes:ws,orientationType:yp};bt.optional(function(){Er.isArrayLike=io}),Cr&&(er.backBuffer=[Iv],er.drawBuffer=$i(ve.maxDrawbuffers,function(st){return st===0?[0]:$i(st,function(wt){return xL+wt})}));var Ue=0;function dn(){var st=Ae(),wt=st.link,Bt=st.global;st.id=Ue++,st.batchId="0";var de=wt(Er),ce=st.shared={props:"a0"};Object.keys(Er).forEach(function(Wt){ce[Wt]=Bt.def(de,".",Wt)}),bt.optional(function(){st.CHECK=wt(bt),st.commandStr=bt.guessCommand(),st.command=wt(st.commandStr),st.assert=function(Wt,_t,jt){Wt("if(!(",_t,"))",this.CHECK,".commandRaise(",wt(jt),",",this.command,");")},er.invalidBlendCombinations=eE});var Ht=st.next={},Yt=st.current={};Object.keys(Xe).forEach(function(Wt){Array.isArray(We[Wt])&&(Ht[Wt]=Bt.def(ce.next,".",Wt),Yt[Wt]=Bt.def(ce.current,".",Wt))});var Jt=st.constants={};Object.keys(er).forEach(function(Wt){Jt[Wt]=Bt.def(JSON.stringify(er[Wt]))}),st.invoke=function(Wt,_t){switch(_t.type){case sn:var jt=["this",ce.context,ce.props,st.batchId];return Wt.def(wt(_t.data),".call(",jt.slice(0,Math.max(_t.data.length+1,4)),")");case hn:return Wt.def(ce.props,_t.data);case cn:return Wt.def(ce.context,_t.data);case Ii:return Wt.def("this",_t.data);case kr:return _t.data.append(st,Wt),_t.data.ref}},st.attribCache={};var Lt={};return st.scopeAttrib=function(Wt){var _t=yt.id(Wt);if(_t in Lt)return Lt[_t];var jt=pr.scope[_t];jt||(jt=pr.scope[_t]=new ie);var be=Lt[_t]=wt(jt);return be},st}function si(st){var wt=st.static,Bt=st.dynamic,de;if(ao in wt){var ce=!!wt[ao];de=jo(function(Yt,Jt){return ce}),de.enable=ce}else if(ao in Bt){var Ht=Bt[ao];de=Au(Ht,function(Yt,Jt){return Yt.invoke(Jt,Ht)})}return de}function Ir(st,wt){var Bt=st.static,de=st.dynamic;if(sl in Bt){var ce=Bt[sl];return ce?(ce=nr.getFramebuffer(ce),bt.command(ce,"invalid framebuffer object"),jo(function(Yt,Jt){var Lt=Yt.link(ce),Wt=Yt.shared;Jt.set(Wt.framebuffer,".next",Lt);var _t=Wt.context;return Jt.set(_t,"."+gd,Lt+".width"),Jt.set(_t,"."+qu,Lt+".height"),Lt})):jo(function(Yt,Jt){var Lt=Yt.shared;Jt.set(Lt.framebuffer,".next","null");var Wt=Lt.context;return Jt.set(Wt,"."+gd,Wt+"."+ll),Jt.set(Wt,"."+qu,Wt+"."+l2),"null"})}else if(sl in de){var Ht=de[sl];return Au(Ht,function(Yt,Jt){var Lt=Yt.invoke(Jt,Ht),Wt=Yt.shared,_t=Wt.framebuffer,jt=Jt.def(_t,".getFramebuffer(",Lt,")");bt.optional(function(){Yt.assert(Jt,"!"+Lt+"||"+jt,"invalid framebuffer object")}),Jt.set(_t,".next",jt);var be=Wt.context;return Jt.set(be,"."+gd,jt+"?"+jt+".width:"+be+"."+ll),Jt.set(be,"."+qu,jt+"?"+jt+".height:"+be+"."+l2),jt})}else return null}function ti(st,wt,Bt){var de=st.static,ce=st.dynamic;function Ht(Lt){if(Lt in de){var Wt=de[Lt];bt.commandType(Wt,"object","invalid "+Lt,Bt.commandStr);var _t=!0,jt=Wt.x|0,be=Wt.y|0,Ie,je;return"width"in Wt?(Ie=Wt.width|0,bt.command(Ie>=0,"invalid "+Lt,Bt.commandStr)):_t=!1,"height"in Wt?(je=Wt.height|0,bt.command(je>=0,"invalid "+Lt,Bt.commandStr)):_t=!1,new ul(!_t&&wt&&wt.thisDep,!_t&&wt&&wt.contextDep,!_t&&wt&&wt.propDep,function(tn,Xr){var qr=tn.shared.context,wn=Ie;"width"in Wt||(wn=Xr.def(qr,".",gd,"-",jt));var Pn=je;return"height"in Wt||(Pn=Xr.def(qr,".",qu,"-",be)),[jt,be,wn,Pn]})}else if(Lt in ce){var He=ce[Lt],Qe=Au(He,function(tn,Xr){var qr=tn.invoke(Xr,He);bt.optional(function(){tn.assert(Xr,qr+"&&typeof "+qr+'==="object"',"invalid "+Lt)});var wn=tn.shared.context,Pn=Xr.def(qr,".x|0"),ji=Xr.def(qr,".y|0"),Ko=Xr.def('"width" in ',qr,"?",qr,".width|0:","(",wn,".",gd,"-",Pn,")"),Ch=Xr.def('"height" in ',qr,"?",qr,".height|0:","(",wn,".",qu,"-",ji,")");return bt.optional(function(){tn.assert(Xr,Ko+">=0&&"+Ch+">=0","invalid "+Lt)}),[Pn,ji,Ko,Ch]});return wt&&(Qe.thisDep=Qe.thisDep||wt.thisDep,Qe.contextDep=Qe.contextDep||wt.contextDep,Qe.propDep=Qe.propDep||wt.propDep),Qe}else return wt?new ul(wt.thisDep,wt.contextDep,wt.propDep,function(tn,Xr){var qr=tn.shared.context;return[0,0,Xr.def(qr,".",gd),Xr.def(qr,".",qu)]}):null}var Yt=Ht(Ss);if(Yt){var Jt=Yt;Yt=new ul(Yt.thisDep,Yt.contextDep,Yt.propDep,function(Lt,Wt){var _t=Jt.append(Lt,Wt),jt=Lt.shared.context;return Wt.set(jt,"."+Yg,_t[2]),Wt.set(jt,"."+qb,_t[3]),_t})}return{viewport:Yt,scissor_box:Ht(yf)}}function Dn(st,wt){var Bt=st.static,de=typeof Bt[Zu]=="string"&&typeof Bt[Tu]=="string";if(de){if(Object.keys(wt.dynamic).length>0)return null;var ce=wt.static,Ht=Object.keys(ce);if(Ht.length>0&&typeof ce[Ht[0]]=="number"){for(var Yt=[],Jt=0;Jt<Ht.length;++Jt)bt(typeof ce[Ht[Jt]]=="number","must specify all vertex attribute locations when using vaos"),Yt.push([ce[Ht[Jt]]|0,Ht[Jt]]);return Yt}}return null}function Tn(st,wt,Bt){var de=st.static,ce=st.dynamic;function Ht(_t){if(_t in de){var jt=yt.id(de[_t]);bt.optional(function(){or.shader(g2[_t],jt,bt.guessCommand())});var be=jo(function(){return jt});return be.id=jt,be}else if(_t in ce){var Ie=ce[_t];return Au(Ie,function(je,He){var Qe=je.invoke(He,Ie),tn=He.def(je.shared.strings,".id(",Qe,")");return bt.optional(function(){He(je.shared.shader,".shader(",g2[_t],",",tn,",",je.command,");")}),tn})}return null}var Yt=Ht(Zu),Jt=Ht(Tu),Lt=null,Wt;return Ks(Yt)&&Ks(Jt)?(Lt=or.program(Jt.id,Yt.id,null,Bt),Wt=jo(function(_t,jt){return _t.link(Lt)})):Wt=new ul(Yt&&Yt.thisDep||Jt&&Jt.thisDep,Yt&&Yt.contextDep||Jt&&Jt.contextDep,Yt&&Yt.propDep||Jt&&Jt.propDep,function(_t,jt){var be=_t.shared.shader,Ie;Yt?Ie=Yt.append(_t,jt):Ie=jt.def(be,".",Zu);var je;Jt?je=Jt.append(_t,jt):je=jt.def(be,".",Tu);var He=be+".program("+je+","+Ie;return bt.optional(function(){He+=","+_t.command}),jt.def(He+")")}),{frag:Yt,vert:Jt,progVar:Wt,program:Lt}}function Hi(st,wt){var Bt=st.static,de=st.dynamic;function ce(){if(_i in Bt){var _t=Bt[_i];i1(_t)?_t=ye.getElements(ye.create(_t,!0)):_t&&(_t=ye.getElements(_t),bt.command(_t,"invalid elements",wt.commandStr));var jt=jo(function(Ie,je){if(_t){var He=Ie.link(_t);return Ie.ELEMENTS=He,He}return Ie.ELEMENTS=null,null});return jt.value=_t,jt}else if(_i in de){var be=de[_i];return Au(be,function(Ie,je){var He=Ie.shared,Qe=He.isBufferArgs,tn=He.elements,Xr=Ie.invoke(je,be),qr=je.def("null"),wn=je.def(Qe,"(",Xr,")"),Pn=Ie.cond(wn).then(qr,"=",tn,".createStream(",Xr,");").else(qr,"=",tn,".getElements(",Xr,");");return bt.optional(function(){Ie.assert(Pn.else,"!"+Xr+"||"+qr,"invalid elements")}),je.entry(Pn),je.exit(Ie.cond(wn).then(tn,".destroyStream(",qr,");")),Ie.ELEMENTS=qr,qr})}return null}var Ht=ce();function Yt(){if(ds in Bt){var _t=Bt[ds];return bt.commandParameter(_t,mc,"invalid primitve",wt.commandStr),jo(function(be,Ie){return mc[_t]})}else if(ds in de){var jt=de[ds];return Au(jt,function(be,Ie){var je=be.constants.primTypes,He=be.invoke(Ie,jt);return bt.optional(function(){be.assert(Ie,He+" in "+je,"invalid primitive, must be one of "+Object.keys(mc))}),Ie.def(je,"[",He,"]")})}else if(Ht)return Ks(Ht)?Ht.value?jo(function(be,Ie){return Ie.def(be.ELEMENTS,".primType")}):jo(function(){return h2}):new ul(Ht.thisDep,Ht.contextDep,Ht.propDep,function(be,Ie){var je=be.ELEMENTS;return Ie.def(je,"?",je,".primType:",h2)});return null}function Jt(_t,jt){if(_t in Bt){var be=Bt[_t]|0;return bt.command(!jt||be>=0,"invalid "+_t,wt.commandStr),jo(function(je,He){return jt&&(je.OFFSET=be),be})}else if(_t in de){var Ie=de[_t];return Au(Ie,function(je,He){var Qe=je.invoke(He,Ie);return jt&&(je.OFFSET=Qe,bt.optional(function(){je.assert(He,Qe+">=0","invalid "+_t)})),Qe})}else if(jt&&Ht)return jo(function(je,He){return je.OFFSET="0",0});return null}var Lt=Jt(Tc,!0);function Wt(){if(Ro in Bt){var _t=Bt[Ro]|0;return bt.command(typeof _t=="number"&&_t>=0,"invalid vertex count",wt.commandStr),jo(function(){return _t})}else if(Ro in de){var jt=de[Ro];return Au(jt,function(je,He){var Qe=je.invoke(He,jt);return bt.optional(function(){je.assert(He,"typeof "+Qe+'==="number"&&'+Qe+">=0&&"+Qe+"===("+Qe+"|0)","invalid vertex count")}),Qe})}else if(Ht)if(Ks(Ht)){if(Ht)return Lt?new ul(Lt.thisDep,Lt.contextDep,Lt.propDep,function(je,He){var Qe=He.def(je.ELEMENTS,".vertCount-",je.OFFSET);return bt.optional(function(){je.assert(He,Qe+">=0","invalid vertex offset/element buffer too small")}),Qe}):jo(function(je,He){return He.def(je.ELEMENTS,".vertCount")});var be=jo(function(){return-1});return bt.optional(function(){be.MISSING=!0}),be}else{var Ie=new ul(Ht.thisDep||Lt.thisDep,Ht.contextDep||Lt.contextDep,Ht.propDep||Lt.propDep,function(je,He){var Qe=je.ELEMENTS;return je.OFFSET?He.def(Qe,"?",Qe,".vertCount-",je.OFFSET,":-1"):He.def(Qe,"?",Qe,".vertCount:-1")});return bt.optional(function(){Ie.DYNAMIC=!0}),Ie}return null}return{elements:Ht,primitive:Yt(),count:Wt(),instances:Jt(jg,!1),offset:Lt}}function Io(st,wt){var Bt=st.static,de=st.dynamic,ce={};return Je.forEach(function(Ht){var Yt=br(Ht);function Jt(Lt,Wt){if(Ht in Bt){var _t=Lt(Bt[Ht]);ce[Yt]=jo(function(){return _t})}else if(Ht in de){var jt=de[Ht];ce[Yt]=Au(jt,function(be,Ie){return Wt(be,Ie,be.invoke(Ie,jt))})}}switch(Ht){case Xo:case Xn:case Ln:case hp:case Sn:case Yu:case Ns:case qs:case Su:case ja:return Jt(function(Lt){return bt.commandType(Lt,"boolean",Ht,wt.commandStr),Lt},function(Lt,Wt,_t){return bt.optional(function(){Lt.assert(Wt,"typeof "+_t+'==="boolean"',"invalid flag "+Ht,Lt.commandStr)}),_t});case bn:return Jt(function(Lt){return bt.commandParameter(Lt,Ov,"invalid "+Ht,wt.commandStr),Ov[Lt]},function(Lt,Wt,_t){var jt=Lt.constants.compareFuncs;return bt.optional(function(){Lt.assert(Wt,_t+" in "+jt,"invalid "+Ht+", must be one of "+Object.keys(Ov))}),Wt.def(jt,"[",_t,"]")});case Mo:return Jt(function(Lt){return bt.command(io(Lt)&&Lt.length===2&&typeof Lt[0]=="number"&&typeof Lt[1]=="number"&&Lt[0]<=Lt[1],"depth range is 2d array",wt.commandStr),Lt},function(Lt,Wt,_t){bt.optional(function(){Lt.assert(Wt,Lt.shared.isArrayLike+"("+_t+")&&"+_t+".length===2&&typeof "+_t+'[0]==="number"&&typeof '+_t+'[1]==="number"&&'+_t+"[0]<="+_t+"[1]","depth range must be a 2d array")});var jt=Wt.def("+",_t,"[0]"),be=Wt.def("+",_t,"[1]");return[jt,be]});case $n:return Jt(function(Lt){bt.commandType(Lt,"object","blend.func",wt.commandStr);var Wt="srcRGB"in Lt?Lt.srcRGB:Lt.src,_t="srcAlpha"in Lt?Lt.srcAlpha:Lt.src,jt="dstRGB"in Lt?Lt.dstRGB:Lt.dst,be="dstAlpha"in Lt?Lt.dstAlpha:Lt.dst;return bt.commandParameter(Wt,xf,Yt+".srcRGB",wt.commandStr),bt.commandParameter(_t,xf,Yt+".srcAlpha",wt.commandStr),bt.commandParameter(jt,xf,Yt+".dstRGB",wt.commandStr),bt.commandParameter(be,xf,Yt+".dstAlpha",wt.commandStr),bt.command(eE.indexOf(Wt+", "+jt)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+Wt+", "+jt+")",wt.commandStr),[xf[Wt],xf[jt],xf[_t],xf[be]]},function(Lt,Wt,_t){var jt=Lt.constants.blendFuncs;bt.optional(function(){Lt.assert(Wt,_t+"&&typeof "+_t+'==="object"',"invalid blend func, must be an object")});function be(qr,wn){var Pn=Wt.def('"',qr,wn,'" in ',_t,"?",_t,".",qr,wn,":",_t,".",qr);return bt.optional(function(){Lt.assert(Wt,Pn+" in "+jt,"invalid "+Ht+"."+qr+wn+", must be one of "+Object.keys(xf))}),Pn}var Ie=be("src","RGB"),je=be("dst","RGB");bt.optional(function(){var qr=Lt.constants.invalidBlendCombinations;Lt.assert(Wt,qr+".indexOf("+Ie+'+", "+'+je+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var He=Wt.def(jt,"[",Ie,"]"),Qe=Wt.def(jt,"[",be("src","Alpha"),"]"),tn=Wt.def(jt,"[",je,"]"),Xr=Wt.def(jt,"[",be("dst","Alpha"),"]");return[He,tn,Qe,Xr]});case Cn:return Jt(function(Lt){if(typeof Lt=="string")return bt.commandParameter(Lt,Se,"invalid "+Ht,wt.commandStr),[Se[Lt],Se[Lt]];if(typeof Lt=="object")return bt.commandParameter(Lt.rgb,Se,Ht+".rgb",wt.commandStr),bt.commandParameter(Lt.alpha,Se,Ht+".alpha",wt.commandStr),[Se[Lt.rgb],Se[Lt.alpha]];bt.commandRaise("invalid blend.equation",wt.commandStr)},function(Lt,Wt,_t){var jt=Lt.constants.blendEquations,be=Wt.def(),Ie=Wt.def(),je=Lt.cond("typeof ",_t,'==="string"');return bt.optional(function(){function He(Qe,tn,Xr){Lt.assert(Qe,Xr+" in "+jt,"invalid "+tn+", must be one of "+Object.keys(Se))}He(je.then,Ht,_t),Lt.assert(je.else,_t+"&&typeof "+_t+'==="object"',"invalid "+Ht),He(je.else,Ht+".rgb",_t+".rgb"),He(je.else,Ht+".alpha",_t+".alpha")}),je.then(be,"=",Ie,"=",jt,"[",_t,"];"),je.else(be,"=",jt,"[",_t,".rgb];",Ie,"=",jt,"[",_t,".alpha];"),Wt(je),[be,Ie]});case Rn:return Jt(function(Lt){return bt.command(io(Lt)&&Lt.length===4,"blend.color must be a 4d array",wt.commandStr),$i(4,function(Wt){return+Lt[Wt]})},function(Lt,Wt,_t){return bt.optional(function(){Lt.assert(Wt,Lt.shared.isArrayLike+"("+_t+")&&"+_t+".length===4","blend.color must be a 4d array")}),$i(4,function(jt){return Wt.def("+",_t,"[",jt,"]")})});case pd:return Jt(function(Lt){return bt.commandType(Lt,"number",Yt,wt.commandStr),Lt|0},function(Lt,Wt,_t){return bt.optional(function(){Lt.assert(Wt,"typeof "+_t+'==="number"',"invalid stencil.mask")}),Wt.def(_t,"|0")});case Sc:return Jt(function(Lt){bt.commandType(Lt,"object",Yt,wt.commandStr);var Wt=Lt.cmp||"keep",_t=Lt.ref||0,jt="mask"in Lt?Lt.mask:-1;return bt.commandParameter(Wt,Ov,Ht+".cmp",wt.commandStr),bt.commandType(_t,"number",Ht+".ref",wt.commandStr),bt.commandType(jt,"number",Ht+".mask",wt.commandStr),[Ov[Wt],_t,jt]},function(Lt,Wt,_t){var jt=Lt.constants.compareFuncs;bt.optional(function(){function He(){Lt.assert(Wt,Array.prototype.join.call(arguments,""),"invalid stencil.func")}He(_t+"&&typeof ",_t,'==="object"'),He('!("cmp" in ',_t,")||(",_t,".cmp in ",jt,")")});var be=Wt.def('"cmp" in ',_t,"?",jt,"[",_t,".cmp]",":",gp),Ie=Wt.def(_t,".ref|0"),je=Wt.def('"mask" in ',_t,"?",_t,".mask|0:-1");return[be,Ie,je]});case mf:case bh:return Jt(function(Lt){bt.commandType(Lt,"object",Yt,wt.commandStr);var Wt=Lt.fail||"keep",_t=Lt.zfail||"keep",jt=Lt.zpass||"keep";return bt.commandParameter(Wt,mp,Ht+".fail",wt.commandStr),bt.commandParameter(_t,mp,Ht+".zfail",wt.commandStr),bt.commandParameter(jt,mp,Ht+".zpass",wt.commandStr),[Ht===bh?Iv:yd,mp[Wt],mp[_t],mp[jt]]},function(Lt,Wt,_t){var jt=Lt.constants.stencilOps;bt.optional(function(){Lt.assert(Wt,_t+"&&typeof "+_t+'==="object"',"invalid "+Ht)});function be(Ie){return bt.optional(function(){Lt.assert(Wt,'!("'+Ie+'" in '+_t+")||("+_t+"."+Ie+" in "+jt+")","invalid "+Ht+"."+Ie+", must be one of "+Object.keys(mp))}),Wt.def('"',Ie,'" in ',_t,"?",jt,"[",_t,".",Ie,"]:",gp)}return[Ht===bh?Iv:yd,be("fail"),be("zfail"),be("zpass")]});case Cc:return Jt(function(Lt){bt.commandType(Lt,"object",Yt,wt.commandStr);var Wt=Lt.factor|0,_t=Lt.units|0;return bt.commandType(Wt,"number",Yt+".factor",wt.commandStr),bt.commandType(_t,"number",Yt+".units",wt.commandStr),[Wt,_t]},function(Lt,Wt,_t){bt.optional(function(){Lt.assert(Wt,_t+"&&typeof "+_t+'==="object"',"invalid "+Ht)});var jt=Wt.def(_t,".factor|0"),be=Wt.def(_t,".units|0");return[jt,be]});case Ga:return Jt(function(Lt){var Wt=0;return Lt==="front"?Wt=yd:Lt==="back"&&(Wt=Iv),bt.command(!!Wt,Yt,wt.commandStr),Wt},function(Lt,Wt,_t){return bt.optional(function(){Lt.assert(Wt,_t+'==="front"||'+_t+'==="back"',"invalid cull.face")}),Wt.def(_t,'==="front"?',yd,":",Iv)});case Zs:return Jt(function(Lt){return bt.command(typeof Lt=="number"&&Lt>=ve.lineWidthDims[0]&&Lt<=ve.lineWidthDims[1],"invalid line width, must be a positive number between "+ve.lineWidthDims[0]+" and "+ve.lineWidthDims[1],wt.commandStr),Lt},function(Lt,Wt,_t){return bt.optional(function(){Lt.assert(Wt,"typeof "+_t+'==="number"&&'+_t+">="+ve.lineWidthDims[0]+"&&"+_t+"<="+ve.lineWidthDims[1],"invalid line width")}),_t});case Ya:return Jt(function(Lt){return bt.commandParameter(Lt,yp,Yt,wt.commandStr),yp[Lt]},function(Lt,Wt,_t){return bt.optional(function(){Lt.assert(Wt,_t+'==="cw"||'+_t+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),Wt.def(_t+'==="cw"?'+n1+":"+Qb)});case fs:return Jt(function(Lt){return bt.command(io(Lt)&&Lt.length===4,"color.mask must be length 4 array",wt.commandStr),Lt.map(function(Wt){return!!Wt})},function(Lt,Wt,_t){return bt.optional(function(){Lt.assert(Wt,Lt.shared.isArrayLike+"("+_t+")&&"+_t+".length===4","invalid color.mask")}),$i(4,function(jt){return"!!"+_t+"["+jt+"]"})});case Ll:return Jt(function(Lt){bt.command(typeof Lt=="object"&&Lt,Yt,wt.commandStr);var Wt="value"in Lt?Lt.value:1,_t=!!Lt.invert;return bt.command(typeof Wt=="number"&&Wt>=0&&Wt<=1,"sample.coverage.value must be a number between 0 and 1",wt.commandStr),[Wt,_t]},function(Lt,Wt,_t){bt.optional(function(){Lt.assert(Wt,_t+"&&typeof "+_t+'==="object"',"invalid sample.coverage")});var jt=Wt.def('"value" in ',_t,"?+",_t,".value:1"),be=Wt.def("!!",_t,".invert");return[jt,be]})}}),ce}function Ts(st,wt){var Bt=st.static,de=st.dynamic,ce={};return Object.keys(Bt).forEach(function(Ht){var Yt=Bt[Ht],Jt;if(typeof Yt=="number"||typeof Yt=="boolean")Jt=jo(function(){return Yt});else if(typeof Yt=="function"){var Lt=Yt._reglType;Lt==="texture2d"||Lt==="textureCube"?Jt=jo(function(Wt){return Wt.link(Yt)}):Lt==="framebuffer"||Lt==="framebufferCube"?(bt.command(Yt.color.length>0,'missing color attachment for framebuffer sent to uniform "'+Ht+'"',wt.commandStr),Jt=jo(function(Wt){return Wt.link(Yt.color[0])})):bt.commandRaise('invalid data for uniform "'+Ht+'"',wt.commandStr)}else io(Yt)?Jt=jo(function(Wt){var _t=Wt.global.def("[",$i(Yt.length,function(jt){return bt.command(typeof Yt[jt]=="number"||typeof Yt[jt]=="boolean","invalid uniform "+Ht,Wt.commandStr),Yt[jt]}),"]");return _t}):bt.commandRaise('invalid or missing data for uniform "'+Ht+'"',wt.commandStr);Jt.value=Yt,ce[Ht]=Jt}),Object.keys(de).forEach(function(Ht){var Yt=de[Ht];ce[Ht]=Au(Yt,function(Jt,Lt){return Jt.invoke(Lt,Yt)})}),ce}function vi(st,wt){var Bt=st.static,de=st.dynamic,ce={};return Object.keys(Bt).forEach(function(Ht){var Yt=Bt[Ht],Jt=yt.id(Ht),Lt=new ie;if(i1(Yt))Lt.state=ar,Lt.buffer=Ne.getBuffer(Ne.create(Yt,Zg,!1,!0)),Lt.type=0;else{var Wt=Ne.getBuffer(Yt);if(Wt)Lt.state=ar,Lt.buffer=Wt,Lt.type=0;else if(bt.command(typeof Yt=="object"&&Yt,"invalid data for attribute "+Ht,wt.commandStr),"constant"in Yt){var _t=Yt.constant;Lt.buffer="null",Lt.state=Mr,typeof _t=="number"?Lt.x=_t:(bt.command(io(_t)&&_t.length>0&&_t.length<=4,"invalid constant for attribute "+Ht,wt.commandStr),Ve.forEach(function(tn,Xr){Xr<_t.length&&(Lt[tn]=_t[Xr])}))}else{i1(Yt.buffer)?Wt=Ne.getBuffer(Ne.create(Yt.buffer,Zg,!1,!0)):Wt=Ne.getBuffer(Yt.buffer),bt.command(!!Wt,'missing buffer for attribute "'+Ht+'"',wt.commandStr);var jt=Yt.offset|0;bt.command(jt>=0,'invalid offset for attribute "'+Ht+'"',wt.commandStr);var be=Yt.stride|0;bt.command(be>=0&&be<256,'invalid stride for attribute "'+Ht+'", must be integer betweeen [0, 255]',wt.commandStr);var Ie=Yt.size|0;bt.command(!("size"in Yt)||Ie>0&&Ie<=4,'invalid size for attribute "'+Ht+'", must be 1,2,3,4',wt.commandStr);var je=!!Yt.normalized,He=0;"type"in Yt&&(bt.commandParameter(Yt.type,ws,"invalid type for attribute "+Ht,wt.commandStr),He=ws[Yt.type]);var Qe=Yt.divisor|0;"divisor"in Yt&&(bt.command(Qe===0||ir,'cannot specify divisor for attribute "'+Ht+'", instancing not supported',wt.commandStr),bt.command(Qe>=0,'invalid divisor for attribute "'+Ht+'"',wt.commandStr)),bt.optional(function(){var tn=wt.commandStr,Xr=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(Yt).forEach(function(qr){bt.command(Xr.indexOf(qr)>=0,'unknown parameter "'+qr+'" for attribute pointer "'+Ht+'" (valid parameters are '+Xr+")",tn)})}),Lt.buffer=Wt,Lt.state=ar,Lt.size=Ie,Lt.normalized=je,Lt.type=He||Wt.dtype,Lt.offset=jt,Lt.stride=be,Lt.divisor=Qe}}ce[Ht]=jo(function(tn,Xr){var qr=tn.attribCache;if(Jt in qr)return qr[Jt];var wn={isStream:!1};return Object.keys(Lt).forEach(function(Pn){wn[Pn]=Lt[Pn]}),Lt.buffer&&(wn.buffer=tn.link(Lt.buffer),wn.type=wn.type||wn.buffer+".dtype"),qr[Jt]=wn,wn})}),Object.keys(de).forEach(function(Ht){var Yt=de[Ht];function Jt(Lt,Wt){var _t=Lt.invoke(Wt,Yt),jt=Lt.shared,be=Lt.constants,Ie=jt.isBufferArgs,je=jt.buffer;bt.optional(function(){Lt.assert(Wt,_t+"&&(typeof "+_t+'==="object"||typeof '+_t+'==="function")&&('+Ie+"("+_t+")||"+je+".getBuffer("+_t+")||"+je+".getBuffer("+_t+".buffer)||"+Ie+"("+_t+'.buffer)||("constant" in '+_t+"&&(typeof "+_t+'.constant==="number"||'+jt.isArrayLike+"("+_t+".constant))))",'invalid dynamic attribute "'+Ht+'"')});var He={isStream:Wt.def(!1)},Qe=new ie;Qe.state=ar,Object.keys(Qe).forEach(function(wn){He[wn]=Wt.def(""+Qe[wn])});var tn=He.buffer,Xr=He.type;Wt("if(",Ie,"(",_t,")){",He.isStream,"=true;",tn,"=",je,".createStream(",Zg,",",_t,");",Xr,"=",tn,".dtype;","}else{",tn,"=",je,".getBuffer(",_t,");","if(",tn,"){",Xr,"=",tn,".dtype;",'}else if("constant" in ',_t,"){",He.state,"=",Mr,";","if(typeof "+_t+'.constant === "number"){',He[Ve[0]],"=",_t,".constant;",Ve.slice(1).map(function(wn){return He[wn]}).join("="),"=0;","}else{",Ve.map(function(wn,Pn){return He[wn]+"="+_t+".constant.length>"+Pn+"?"+_t+".constant["+Pn+"]:0;"}).join(""),"}}else{","if(",Ie,"(",_t,".buffer)){",tn,"=",je,".createStream(",Zg,",",_t,".buffer);","}else{",tn,"=",je,".getBuffer(",_t,".buffer);","}",Xr,'="type" in ',_t,"?",be.glTypes,"[",_t,".type]:",tn,".dtype;",He.normalized,"=!!",_t,".normalized;");function qr(wn){Wt(He[wn],"=",_t,".",wn,"|0;")}return qr("size"),qr("offset"),qr("stride"),qr("divisor"),Wt("}}"),Wt.exit("if(",He.isStream,"){",je,".destroyStream(",tn,");","}"),He}ce[Ht]=Au(Yt,Jt)}),ce}function Lo(st,wt){var Bt=st.static,de=st.dynamic;if(_f in Bt){var ce=Bt[_f];return ce!==null&&pr.getVAO(ce)===null&&(ce=pr.createVAO(ce)),jo(function(Yt){return Yt.link(pr.getVAO(ce))})}else if(_f in de){var Ht=de[_f];return Au(Ht,function(Yt,Jt){var Lt=Yt.invoke(Jt,Ht);return Jt.def(Yt.shared.vao+".getVAO("+Lt+")")})}return null}function Ia(st){var wt=st.static,Bt=st.dynamic,de={};return Object.keys(wt).forEach(function(ce){var Ht=wt[ce];de[ce]=jo(function(Yt,Jt){return typeof Ht=="number"||typeof Ht=="boolean"?""+Ht:Yt.link(Ht)})}),Object.keys(Bt).forEach(function(ce){var Ht=Bt[ce];de[ce]=Au(Ht,function(Yt,Jt){return Yt.invoke(Jt,Ht)})}),de}function Yo(st,wt,Bt,de,ce){var Ht=st.static,Yt=st.dynamic;bt.optional(function(){var qr=[sl,Tu,Zu,_i,ds,Tc,Ro,jg,ao,_f].concat(Je);function wn(Pn){Object.keys(Pn).forEach(function(ji){bt.command(qr.indexOf(ji)>=0,'unknown parameter "'+ji+'"',ce.commandStr)})}wn(Ht),wn(Yt)});var Jt=Dn(st,wt),Lt=Ir(st),Wt=ti(st,Lt,ce),_t=Hi(st,ce),jt=Io(st,ce),be=Tn(st,ce,Jt);function Ie(qr){var wn=Wt[qr];wn&&(jt[qr]=wn)}Ie(Ss),Ie(br(yf));var je=Object.keys(jt).length>0,He={framebuffer:Lt,draw:_t,shader:be,state:jt,dirty:je,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(He.profile=si(st),He.uniforms=Ts(Bt,ce),He.drawVAO=He.scopeVAO=Lo(st),!He.drawVAO&&be.program&&!Jt&&Ft.angle_instanced_arrays){var Qe=!0,tn=be.program.attributes.map(function(qr){var wn=wt.static[qr];return Qe=Qe&&!!wn,wn});if(Qe&&tn.length>0){var Xr=pr.getVAO(pr.createVAO(tn));He.drawVAO=new ul(null,null,null,function(qr,wn){return qr.link(Xr)}),He.useVAO=!0}}return Jt?He.useVAO=!0:He.attributes=vi(wt,ce),He.context=Ia(de),He}function Zo(st,wt,Bt){var de=st.shared,ce=de.context,Ht=st.scope();Object.keys(Bt).forEach(function(Yt){wt.save(ce,"."+Yt);var Jt=Bt[Yt];Ht(ce,".",Yt,"=",Jt.append(st,wt),";")}),wt(Ht)}function so(st,wt,Bt,de){var ce=st.shared,Ht=ce.gl,Yt=ce.framebuffer,Jt;Cr&&(Jt=wt.def(ce.extensions,".webgl_draw_buffers"));var Lt=st.constants,Wt=Lt.drawBuffer,_t=Lt.backBuffer,jt;Bt?jt=Bt.append(st,wt):jt=wt.def(Yt,".next"),de||wt("if(",jt,"!==",Yt,".cur){"),wt("if(",jt,"){",Ht,".bindFramebuffer(",Lv,",",jt,".framebuffer);"),Cr&&wt(Jt,".drawBuffersWEBGL(",Wt,"[",jt,".colorAttachments.length]);"),wt("}else{",Ht,".bindFramebuffer(",Lv,",null);"),Cr&&wt(Jt,".drawBuffersWEBGL(",_t,");"),wt("}",Yt,".cur=",jt,";"),de||wt("}")}function ps(st,wt,Bt){var de=st.shared,ce=de.gl,Ht=st.current,Yt=st.next,Jt=de.current,Lt=de.next,Wt=st.cond(Jt,".dirty");Je.forEach(function(_t){var jt=br(_t);if(!(jt in Bt.state)){var be,Ie;if(jt in Yt){be=Yt[jt],Ie=Ht[jt];var je=$i(We[jt].length,function(Qe){return Wt.def(be,"[",Qe,"]")});Wt(st.cond(je.map(function(Qe,tn){return Qe+"!=="+Ie+"["+tn+"]"}).join("||")).then(ce,".",Xe[jt],"(",je,");",je.map(function(Qe,tn){return Ie+"["+tn+"]="+Qe}).join(";"),";"))}else{be=Wt.def(Lt,".",jt);var He=st.cond(be,"!==",Jt,".",jt);Wt(He),jt in Sr?He(st.cond(be).then(ce,".enable(",Sr[jt],");").else(ce,".disable(",Sr[jt],");"),Jt,".",jt,"=",be,";"):He(ce,".",Xe[jt],"(",be,");",Jt,".",jt,"=",be,";")}}}),Object.keys(Bt.state).length===0&&Wt(Jt,".dirty=false;"),wt(Wt)}function Qs(st,wt,Bt,de){var ce=st.shared,Ht=st.current,Yt=ce.current,Jt=ce.gl;a1(Object.keys(Bt)).forEach(function(Lt){var Wt=Bt[Lt];if(!(de&&!de(Wt))){var _t=Wt.append(st,wt);if(Sr[Lt]){var jt=Sr[Lt];Ks(Wt)?_t?wt(Jt,".enable(",jt,");"):wt(Jt,".disable(",jt,");"):wt(st.cond(_t).then(Jt,".enable(",jt,");").else(Jt,".disable(",jt,");")),wt(Yt,".",Lt,"=",_t,";")}else if(io(_t)){var be=Ht[Lt];wt(Jt,".",Xe[Lt],"(",_t,");",_t.map(function(Ie,je){return be+"["+je+"]="+Ie}).join(";"),";")}else wt(Jt,".",Xe[Lt],"(",_t,");",Yt,".",Lt,"=",_t,";")}})}function qo(st,wt){ir&&(st.instancing=wt.def(st.shared.extensions,".angle_instanced_arrays"))}function Qn(st,wt,Bt,de,ce){var Ht=st.shared,Yt=st.stats,Jt=Ht.current,Lt=Ht.timer,Wt=Bt.profile;function _t(){return typeof performance>"u"?"Date.now()":"performance.now()"}var jt,be;function Ie(qr){jt=wt.def(),qr(jt,"=",_t(),";"),typeof ce=="string"?qr(Yt,".count+=",ce,";"):qr(Yt,".count++;"),Ke&&(de?(be=wt.def(),qr(be,"=",Lt,".getNumPendingQueries();")):qr(Lt,".beginQuery(",Yt,");"))}function je(qr){qr(Yt,".cpuTime+=",_t(),"-",jt,";"),Ke&&(de?qr(Lt,".pushScopeStats(",be,",",Lt,".getNumPendingQueries(),",Yt,");"):qr(Lt,".endQuery();"))}function He(qr){var wn=wt.def(Jt,".profile");wt(Jt,".profile=",qr,";"),wt.exit(Jt,".profile=",wn,";")}var Qe;if(Wt){if(Ks(Wt)){Wt.enable?(Ie(wt),je(wt.exit),He("true")):He("false");return}Qe=Wt.append(st,wt),He(Qe)}else Qe=wt.def(Jt,".profile");var tn=st.block();Ie(tn),wt("if(",Qe,"){",tn,"}");var Xr=st.block();je(Xr),wt.exit("if(",Qe,"){",Xr,"}")}function ks(st,wt,Bt,de,ce){var Ht=st.shared;function Yt(Lt){switch(Lt){case J_:case e1:case Tv:return 2;case qg:case oo:case Av:return 3;case t1:case Sv:case vp:return 4;default:return 1}}function Jt(Lt,Wt,_t){var jt=Ht.gl,be=wt.def(Lt,".location"),Ie=wt.def(Ht.attributes,"[",be,"]"),je=_t.state,He=_t.buffer,Qe=[_t.x,_t.y,_t.z,_t.w],tn=["buffer","normalized","offset","stride"];function Xr(){wt("if(!",Ie,".buffer){",jt,".enableVertexAttribArray(",be,");}");var wn=_t.type,Pn;if(_t.size?Pn=wt.def(_t.size,"||",Wt):Pn=Wt,wt("if(",Ie,".type!==",wn,"||",Ie,".size!==",Pn,"||",tn.map(function(Ko){return Ie+"."+Ko+"!=="+_t[Ko]}).join("||"),"){",jt,".bindBuffer(",Zg,",",He,".buffer);",jt,".vertexAttribPointer(",[be,Pn,wn,_t.normalized,_t.stride,_t.offset],");",Ie,".type=",wn,";",Ie,".size=",Pn,";",tn.map(function(Ko){return Ie+"."+Ko+"="+_t[Ko]+";"}).join(""),"}"),ir){var ji=_t.divisor;wt("if(",Ie,".divisor!==",ji,"){",st.instancing,".vertexAttribDivisorANGLE(",[be,ji],");",Ie,".divisor=",ji,";}")}}function qr(){wt("if(",Ie,".buffer){",jt,".disableVertexAttribArray(",be,");",Ie,".buffer=null;","}if(",Ve.map(function(wn,Pn){return Ie+"."+wn+"!=="+Qe[Pn]}).join("||"),"){",jt,".vertexAttrib4f(",be,",",Qe,");",Ve.map(function(wn,Pn){return Ie+"."+wn+"="+Qe[Pn]+";"}).join(""),"}")}je===ar?Xr():je===Mr?qr():(wt("if(",je,"===",ar,"){"),Xr(),wt("}else{"),qr(),wt("}"))}de.forEach(function(Lt){var Wt=Lt.name,_t=Bt.attributes[Wt],jt;if(_t){if(!ce(_t))return;jt=_t.append(st,wt)}else{if(!ce(m2))return;var be=st.scopeAttrib(Wt);bt.optional(function(){st.assert(wt,be+".state","missing attribute "+Wt)}),jt={},Object.keys(new ie).forEach(function(Ie){jt[Ie]=wt.def(be,".",Ie)})}Jt(st.link(Lt),Yt(Lt.info.type),jt)})}function Xi(st,wt,Bt,de,ce){for(var Ht=st.shared,Yt=Ht.gl,Jt,Lt=0;Lt<de.length;++Lt){var Wt=de[Lt],_t=Wt.name,jt=Wt.info.type,be=Bt.uniforms[_t],Ie=st.link(Wt),je=Ie+".location",He;if(be){if(!ce(be))continue;if(Ks(be)){var Qe=be.value;if(bt.command(Qe!==null&&typeof Qe<"u",'missing uniform "'+_t+'"',st.commandStr),jt===Mv||jt===Rv){bt.command(typeof Qe=="function"&&(jt===Mv&&(Qe._reglType==="texture2d"||Qe._reglType==="framebuffer")||jt===Rv&&(Qe._reglType==="textureCube"||Qe._reglType==="framebufferCube")),"invalid texture for uniform "+_t,st.commandStr);var tn=st.link(Qe._texture||Qe.color[0]._texture);wt(Yt,".uniform1i(",je,",",tn+".bind());"),wt.exit(tn,".unbind();")}else if(jt===Kg||jt===Qg||jt===md){bt.optional(function(){bt.command(io(Qe),"invalid matrix for uniform "+_t,st.commandStr),bt.command(jt===Kg&&Qe.length===4||jt===Qg&&Qe.length===9||jt===md&&Qe.length===16,"invalid length for matrix uniform "+_t,st.commandStr)});var Xr=st.global.def("new Float32Array(["+Array.prototype.slice.call(Qe)+"])"),qr=2;jt===Qg?qr=3:jt===md&&(qr=4),wt(Yt,".uniformMatrix",qr,"fv(",je,",false,",Xr,");")}else{switch(jt){case Kb:bt.commandType(Qe,"number","uniform "+_t,st.commandStr),Jt="1f";break;case J_:bt.command(io(Qe)&&Qe.length===2,"uniform "+_t,st.commandStr),Jt="2f";break;case qg:bt.command(io(Qe)&&Qe.length===3,"uniform "+_t,st.commandStr),Jt="3f";break;case t1:bt.command(io(Qe)&&Qe.length===4,"uniform "+_t,st.commandStr),Jt="4f";break;case r1:bt.commandType(Qe,"boolean","uniform "+_t,st.commandStr),Jt="1i";break;case pp:bt.commandType(Qe,"number","uniform "+_t,st.commandStr),Jt="1i";break;case Tv:bt.command(io(Qe)&&Qe.length===2,"uniform "+_t,st.commandStr),Jt="2i";break;case e1:bt.command(io(Qe)&&Qe.length===2,"uniform "+_t,st.commandStr),Jt="2i";break;case Av:bt.command(io(Qe)&&Qe.length===3,"uniform "+_t,st.commandStr),Jt="3i";break;case oo:bt.command(io(Qe)&&Qe.length===3,"uniform "+_t,st.commandStr),Jt="3i";break;case vp:bt.command(io(Qe)&&Qe.length===4,"uniform "+_t,st.commandStr),Jt="4i";break;case Sv:bt.command(io(Qe)&&Qe.length===4,"uniform "+_t,st.commandStr),Jt="4i";break}wt(Yt,".uniform",Jt,"(",je,",",io(Qe)?Array.prototype.slice.call(Qe):Qe,");")}continue}else He=be.append(st,wt)}else{if(!ce(m2))continue;He=wt.def(Ht.uniforms,"[",yt.id(_t),"]")}jt===Mv?wt("if(",He,"&&",He,'._reglType==="framebuffer"){',He,"=",He,".color[0];","}"):jt===Rv&&wt("if(",He,"&&",He,'._reglType==="framebufferCube"){',He,"=",He,".color[0];","}"),bt.optional(function(){function Ch(_d,aE){st.assert(wt,_d,'bad data or missing for uniform "'+_t+'".  '+aE)}function iE(_d){Ch("typeof "+He+'==="'+_d+'"',"invalid type, expected "+_d)}function Ac(_d,aE){Ch(Ht.isArrayLike+"("+He+")&&"+He+".length==="+_d,"invalid vector, should have length "+_d,st.commandStr)}function S2(_d){Ch("typeof "+He+'==="function"&&'+He+'._reglType==="texture'+(_d===K_?"2d":"Cube")+'"',"invalid texture type",st.commandStr)}switch(jt){case pp:iE("number");break;case e1:Ac(2);break;case oo:Ac(3);break;case Sv:Ac(4);break;case Kb:iE("number");break;case J_:Ac(2);break;case qg:Ac(3);break;case t1:Ac(4);break;case r1:iE("boolean");break;case Tv:Ac(2);break;case Av:Ac(3);break;case vp:Ac(4);break;case Kg:Ac(4);break;case Qg:Ac(9);break;case md:Ac(16);break;case Mv:S2(K_);break;case Rv:S2(pL);break}});var wn=1;switch(jt){case Mv:case Rv:var Pn=wt.def(He,"._texture");wt(Yt,".uniform1i(",je,",",Pn,".bind());"),wt.exit(Pn,".unbind();");continue;case pp:case r1:Jt="1i";break;case e1:case Tv:Jt="2i",wn=2;break;case oo:case Av:Jt="3i",wn=3;break;case Sv:case vp:Jt="4i",wn=4;break;case Kb:Jt="1f";break;case J_:Jt="2f",wn=2;break;case qg:Jt="3f",wn=3;break;case t1:Jt="4f",wn=4;break;case Kg:Jt="Matrix2fv";break;case Qg:Jt="Matrix3fv";break;case md:Jt="Matrix4fv";break}if(wt(Yt,".uniform",Jt,"(",je,","),Jt.charAt(0)==="M"){var ji=Math.pow(jt-Kg+2,2),Ko=st.global.def("new Float32Array(",ji,")");wt("false,(Array.isArray(",He,")||",He," instanceof Float32Array)?",He,":(",$i(ji,function(Ch){return Ko+"["+Ch+"]="+He+"["+Ch+"]"}),",",Ko,")")}else wn>1?wt($i(wn,function(Ch){return He+"["+Ch+"]"})):wt(He);wt(");")}}function En(st,wt,Bt,de){var ce=st.shared,Ht=ce.gl,Yt=ce.draw,Jt=de.draw;function Lt(){var Pn=Jt.elements,ji,Ko=wt;return Pn?((Pn.contextDep&&de.contextDynamic||Pn.propDep)&&(Ko=Bt),ji=Pn.append(st,Ko)):ji=Ko.def(Yt,".",_i),ji&&Ko("if("+ji+")"+Ht+".bindBuffer("+hL+","+ji+".buffer.buffer);"),ji}function Wt(){var Pn=Jt.count,ji,Ko=wt;return Pn?((Pn.contextDep&&de.contextDynamic||Pn.propDep)&&(Ko=Bt),ji=Pn.append(st,Ko),bt.optional(function(){Pn.MISSING&&st.assert(wt,"false","missing vertex count"),Pn.DYNAMIC&&st.assert(Ko,ji+">=0","missing vertex count")})):(ji=Ko.def(Yt,".",Ro),bt.optional(function(){st.assert(Ko,ji+">=0","missing vertex count")})),ji}var _t=Lt();function jt(Pn){var ji=Jt[Pn];return ji?ji.contextDep&&de.contextDynamic||ji.propDep?ji.append(st,Bt):ji.append(st,wt):wt.def(Yt,".",Pn)}var be=jt(ds),Ie=jt(Tc),je=Wt();if(typeof je=="number"){if(je===0)return}else Bt("if(",je,"){"),Bt.exit("}");var He,Qe;ir&&(He=jt(jg),Qe=st.instancing);var tn=_t+".type",Xr=Jt.elements&&Ks(Jt.elements);function qr(){function Pn(){Bt(Qe,".drawElementsInstancedANGLE(",[be,je,tn,Ie+"<<(("+tn+"-"+cr+")>>1)",He],");")}function ji(){Bt(Qe,".drawArraysInstancedANGLE(",[be,Ie,je,He],");")}_t?Xr?Pn():(Bt("if(",_t,"){"),Pn(),Bt("}else{"),ji(),Bt("}")):ji()}function wn(){function Pn(){Bt(Ht+".drawElements("+[be,je,tn,Ie+"<<(("+tn+"-"+cr+")>>1)"]+");")}function ji(){Bt(Ht+".drawArrays("+[be,Ie,je]+");")}_t?Xr?Pn():(Bt("if(",_t,"){"),Pn(),Bt("}else{"),ji(),Bt("}")):ji()}ir&&(typeof He!="number"||He>=0)?typeof He=="string"?(Bt("if(",He,">0){"),qr(),Bt("}else if(",He,"<0){"),wn(),Bt("}")):qr():wn()}function fi(st,wt,Bt,de,ce){var Ht=dn(),Yt=Ht.proc("body",ce);return bt.optional(function(){Ht.commandStr=wt.commandStr,Ht.command=Ht.link(wt.commandStr)}),ir&&(Ht.instancing=Yt.def(Ht.shared.extensions,".angle_instanced_arrays")),st(Ht,Yt,Bt,de),Ht.compile().body}function Fi(st,wt,Bt,de){qo(st,wt),Bt.useVAO?Bt.drawVAO?wt(st.shared.vao,".setVAO(",Bt.drawVAO.append(st,wt),");"):wt(st.shared.vao,".setVAO(",st.shared.vao,".targetVAO);"):(wt(st.shared.vao,".setVAO(null);"),ks(st,wt,Bt,de.attributes,function(){return!0})),Xi(st,wt,Bt,de.uniforms,function(){return!0}),En(st,wt,wt,Bt)}function Oo(st,wt){var Bt=st.proc("draw",1);qo(st,Bt),Zo(st,Bt,wt.context),so(st,Bt,wt.framebuffer),ps(st,Bt,wt),Qs(st,Bt,wt.state),Qn(st,Bt,wt,!1,!0);var de=wt.shader.progVar.append(st,Bt);if(Bt(st.shared.gl,".useProgram(",de,".program);"),wt.shader.program)Fi(st,Bt,wt,wt.shader.program);else{Bt(st.shared.vao,".setVAO(null);");var ce=st.global.def("{}"),Ht=Bt.def(de,".id"),Yt=Bt.def(ce,"[",Ht,"]");Bt(st.cond(Yt).then(Yt,".call(this,a0);").else(Yt,"=",ce,"[",Ht,"]=",st.link(function(Jt){return fi(Fi,st,wt,Jt,1)}),"(",de,");",Yt,".call(this,a0);"))}Object.keys(wt.state).length>0&&Bt(st.shared.current,".dirty=true;")}function wh(st,wt,Bt,de){st.batchId="a1",qo(st,wt);function ce(){return!0}ks(st,wt,Bt,de.attributes,ce),Xi(st,wt,Bt,de.uniforms,ce),En(st,wt,wt,Bt)}function It(st,wt,Bt,de){qo(st,wt);var ce=Bt.contextDep,Ht=wt.def(),Yt="a0",Jt="a1",Lt=wt.def();st.shared.props=Lt,st.batchId=Ht;var Wt=st.scope(),_t=st.scope();wt(Wt.entry,"for(",Ht,"=0;",Ht,"<",Jt,";++",Ht,"){",Lt,"=",Yt,"[",Ht,"];",_t,"}",Wt.exit);function jt(tn){return tn.contextDep&&ce||tn.propDep}function be(tn){return!jt(tn)}if(Bt.needsContext&&Zo(st,_t,Bt.context),Bt.needsFramebuffer&&so(st,_t,Bt.framebuffer),Qs(st,_t,Bt.state,jt),Bt.profile&&jt(Bt.profile)&&Qn(st,_t,Bt,!1,!0),de)Bt.useVAO?Bt.drawVAO?jt(Bt.drawVAO)?_t(st.shared.vao,".setVAO(",Bt.drawVAO.append(st,_t),");"):Wt(st.shared.vao,".setVAO(",Bt.drawVAO.append(st,Wt),");"):Wt(st.shared.vao,".setVAO(",st.shared.vao,".targetVAO);"):(Wt(st.shared.vao,".setVAO(null);"),ks(st,Wt,Bt,de.attributes,be),ks(st,_t,Bt,de.attributes,jt)),Xi(st,Wt,Bt,de.uniforms,be),Xi(st,_t,Bt,de.uniforms,jt),En(st,Wt,_t,Bt);else{var Ie=st.global.def("{}"),je=Bt.shader.progVar.append(st,_t),He=_t.def(je,".id"),Qe=_t.def(Ie,"[",He,"]");_t(st.shared.gl,".useProgram(",je,".program);","if(!",Qe,"){",Qe,"=",Ie,"[",He,"]=",st.link(function(tn){return fi(wh,st,Bt,tn,2)}),"(",je,");}",Qe,".call(this,a0[",Ht,"],",Ht,");")}}function _e(st,wt){var Bt=st.proc("batch",2);st.batchId="0",qo(st,Bt);var de=!1,ce=!0;Object.keys(wt.context).forEach(function(Ie){de=de||wt.context[Ie].propDep}),de||(Zo(st,Bt,wt.context),ce=!1);var Ht=wt.framebuffer,Yt=!1;Ht?(Ht.propDep?de=Yt=!0:Ht.contextDep&&de&&(Yt=!0),Yt||so(st,Bt,Ht)):so(st,Bt,null),wt.state.viewport&&wt.state.viewport.propDep&&(de=!0);function Jt(Ie){return Ie.contextDep&&de||Ie.propDep}ps(st,Bt,wt),Qs(st,Bt,wt.state,function(Ie){return!Jt(Ie)}),(!wt.profile||!Jt(wt.profile))&&Qn(st,Bt,wt,!1,"a1"),wt.contextDep=de,wt.needsContext=ce,wt.needsFramebuffer=Yt;var Lt=wt.shader.progVar;if(Lt.contextDep&&de||Lt.propDep)It(st,Bt,wt,null);else{var Wt=Lt.append(st,Bt);if(Bt(st.shared.gl,".useProgram(",Wt,".program);"),wt.shader.program)It(st,Bt,wt,wt.shader.program);else{Bt(st.shared.vao,".setVAO(null);");var _t=st.global.def("{}"),jt=Bt.def(Wt,".id"),be=Bt.def(_t,"[",jt,"]");Bt(st.cond(be).then(be,".call(this,a0,a1);").else(be,"=",_t,"[",jt,"]=",st.link(function(Ie){return fi(It,st,wt,Ie,2)}),"(",Wt,");",be,".call(this,a0,a1);"))}}Object.keys(wt.state).length>0&&Bt(st.shared.current,".dirty=true;")}function he(st,wt){var Bt=st.proc("scope",3);st.batchId="a2";var de=st.shared,ce=de.current;Zo(st,Bt,wt.context),wt.framebuffer&&wt.framebuffer.append(st,Bt),a1(Object.keys(wt.state)).forEach(function(Yt){var Jt=wt.state[Yt],Lt=Jt.append(st,Bt);io(Lt)?Lt.forEach(function(Wt,_t){Bt.set(st.next[Yt],"["+_t+"]",Wt)}):Bt.set(de.next,"."+Yt,Lt)}),Qn(st,Bt,wt,!0,!0),[_i,Tc,Ro,jg,ds].forEach(function(Yt){var Jt=wt.draw[Yt];Jt&&Bt.set(de.draw,"."+Yt,""+Jt.append(st,Bt))}),Object.keys(wt.uniforms).forEach(function(Yt){Bt.set(de.uniforms,"["+yt.id(Yt)+"]",wt.uniforms[Yt].append(st,Bt))}),Object.keys(wt.attributes).forEach(function(Yt){var Jt=wt.attributes[Yt].append(st,Bt),Lt=st.scopeAttrib(Yt);Object.keys(new ie).forEach(function(Wt){Bt.set(Lt,"."+Wt,Jt[Wt])})}),wt.scopeVAO&&Bt.set(de.vao,".targetVAO",wt.scopeVAO.append(st,Bt));function Ht(Yt){var Jt=wt.shader[Yt];Jt&&Bt.set(de.shader,"."+Yt,Jt.append(st,Bt))}Ht(Tu),Ht(Zu),Object.keys(wt.state).length>0&&(Bt(ce,".dirty=true;"),Bt.exit(ce,".dirty=true;")),Bt("a1(",st.shared.context,",a0,",st.batchId,");")}function Pr(st){if(!(typeof st!="object"||io(st))){for(var wt=Object.keys(st),Bt=0;Bt<wt.length;++Bt)if(fo.isDynamic(st[wt[Bt]]))return!0;return!1}}function ei(st,wt,Bt){var de=wt.static[Bt];if(!de||!Pr(de))return;var ce=st.global,Ht=Object.keys(de),Yt=!1,Jt=!1,Lt=!1,Wt=st.global.def("{}");Ht.forEach(function(jt){var be=de[jt];if(fo.isDynamic(be)){typeof be=="function"&&(be=de[jt]=fo.unbox(be));var Ie=Au(be,null);Yt=Yt||Ie.thisDep,Lt=Lt||Ie.propDep,Jt=Jt||Ie.contextDep}else{switch(ce(Wt,".",jt,"="),typeof be){case"number":ce(be);break;case"string":ce('"',be,'"');break;case"object":Array.isArray(be)&&ce("[",be.join(),"]");break;default:ce(st.link(be));break}ce(";")}});function _t(jt,be){Ht.forEach(function(Ie){var je=de[Ie];if(fo.isDynamic(je)){var He=jt.invoke(be,je);be(Wt,".",Ie,"=",He,";")}})}wt.dynamic[Bt]=new fo.DynamicVariable(kr,{thisDep:Yt,contextDep:Jt,propDep:Lt,ref:Wt,append:_t}),delete wt.static[Bt]}function fa(st,wt,Bt,de,ce){var Ht=dn();Ht.stats=Ht.link(ce),Object.keys(wt.static).forEach(function(Jt){ei(Ht,wt,Jt)}),u2.forEach(function(Jt){ei(Ht,st,Jt)});var Yt=Yo(st,wt,Bt,de,Ht);return Oo(Ht,Yt),he(Ht,Yt),_e(Ht,Yt),Ht.compile()}return{next:Rr,current:We,procs:function(){var st=dn(),wt=st.proc("poll"),Bt=st.proc("refresh"),de=st.block();wt(de),Bt(de);var ce=st.shared,Ht=ce.gl,Yt=ce.next,Jt=ce.current;de(Jt,".dirty=false;"),so(st,wt),so(st,Bt,null,!0);var Lt;ir&&(Lt=st.link(ir)),Ft.oes_vertex_array_object&&Bt(st.link(Ft.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var Wt=0;Wt<ve.maxAttributes;++Wt){var _t=Bt.def(ce.attributes,"[",Wt,"]"),jt=st.cond(_t,".buffer");jt.then(Ht,".enableVertexAttribArray(",Wt,");",Ht,".bindBuffer(",Zg,",",_t,".buffer.buffer);",Ht,".vertexAttribPointer(",Wt,",",_t,".size,",_t,".type,",_t,".normalized,",_t,".stride,",_t,".offset);").else(Ht,".disableVertexAttribArray(",Wt,");",Ht,".vertexAttrib4f(",Wt,",",_t,".x,",_t,".y,",_t,".z,",_t,".w);",_t,".buffer=null;"),Bt(jt),ir&&Bt(Lt,".vertexAttribDivisorANGLE(",Wt,",",_t,".divisor);")}return Bt(st.shared.vao,".currentVAO=null;",st.shared.vao,".setVAO(",st.shared.vao,".targetVAO);"),Object.keys(Sr).forEach(function(be){var Ie=Sr[be],je=de.def(Yt,".",be),He=st.block();He("if(",je,"){",Ht,".enable(",Ie,")}else{",Ht,".disable(",Ie,")}",Jt,".",be,"=",je,";"),Bt(He),wt("if(",je,"!==",Jt,".",be,"){",He,"}")}),Object.keys(Xe).forEach(function(be){var Ie=Xe[be],je=We[be],He,Qe,tn=st.block();if(tn(Ht,".",Ie,"("),io(je)){var Xr=je.length;He=st.global.def(Yt,".",be),Qe=st.global.def(Jt,".",be),tn($i(Xr,function(qr){return He+"["+qr+"]"}),");",$i(Xr,function(qr){return Qe+"["+qr+"]="+He+"["+qr+"];"}).join("")),wt("if(",$i(Xr,function(qr){return He+"["+qr+"]!=="+Qe+"["+qr+"]"}).join("||"),"){",tn,"}")}else He=de.def(Yt,".",be),Qe=de.def(Jt,".",be),tn(He,");",Jt,".",be,"=",He,";"),wt("if(",He,"!==",Qe,"){",tn,"}");Bt(tn)}),st.compile()}(),compile:fa}}function y2(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var bL=34918,EL=34919,_2=35007,wL=function(W,yt){if(!yt.ext_disjoint_timer_query)return null;var Ft=[];function ve(){return Ft.pop()||yt.ext_disjoint_timer_query.createQueryEXT()}function Ne(ir){Ft.push(ir)}var ye=[];function ue(ir){var Cr=ve();yt.ext_disjoint_timer_query.beginQueryEXT(_2,Cr),ye.push(Cr),Ke(ye.length-1,ye.length,ir)}function nr(){yt.ext_disjoint_timer_query.endQueryEXT(_2)}function qe(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var pr=[];function or(){return pr.pop()||new qe}function hr(ir){pr.push(ir)}var mr=[];function Ke(ir,Cr,We){var Rr=or();Rr.startQueryIndex=ir,Rr.endQueryIndex=Cr,Rr.sum=0,Rr.stats=We,mr.push(Rr)}var fr=[],ie=[];function Se(){var ir,Cr,We=ye.length;if(We!==0){ie.length=Math.max(ie.length,We+1),fr.length=Math.max(fr.length,We+1),fr[0]=0,ie[0]=0;var Rr=0;for(ir=0,Cr=0;Cr<ye.length;++Cr){var Je=ye[Cr];yt.ext_disjoint_timer_query.getQueryObjectEXT(Je,EL)?(Rr+=yt.ext_disjoint_timer_query.getQueryObjectEXT(Je,bL),Ne(Je)):ye[ir++]=Je,fr[Cr+1]=Rr,ie[Cr+1]=ir}for(ye.length=ir,ir=0,Cr=0;Cr<mr.length;++Cr){var Sr=mr[Cr],Xe=Sr.startQueryIndex,br=Sr.endQueryIndex;Sr.sum+=fr[br]-fr[Xe];var fn=ie[Xe],Bn=ie[br];Bn===fn?(Sr.stats.gpuTime+=Sr.sum/1e6,hr(Sr)):(Sr.startQueryIndex=fn,Sr.endQueryIndex=Bn,mr[ir++]=Sr)}mr.length=ir}}return{beginQuery:ue,endQuery:nr,pushScopeStats:Ke,update:Se,getNumPendingQueries:function(){return ye.length},clear:function(){Ft.push.apply(Ft,ye);for(var ir=0;ir<Ft.length;ir++)yt.ext_disjoint_timer_query.deleteQueryEXT(Ft[ir]);ye.length=0,Ft.length=0},restore:function(){ye.length=0,Ft.length=0}}},x2=16384,cl=256,CL=1024,b2=34962,rE="webglcontextlost",E2="webglcontextrestored",nE=1,SL=2,TL=3;function w2(W,yt){for(var Ft=0;Ft<W.length;++Ft)if(W[Ft]===yt)return Ft;return-1}function C2(W){var yt=pc(W);if(!yt)return null;var Ft=yt.gl,ve=Ft.getContextAttributes(),Ne=Ft.isContextLost(),ye=id(Ft,yt);if(!ye)return null;var ue=oh(),nr=y2(),qe=ye.extensions,pr=wL(Ft,qe),or=Cl(),hr=Ft.drawingBufferWidth,mr=Ft.drawingBufferHeight,Ke={tick:0,time:0,viewportWidth:hr,viewportHeight:mr,framebufferWidth:hr,framebufferHeight:mr,drawingBufferWidth:hr,drawingBufferHeight:mr,pixelRatio:yt.pixelRatio},fr={},ie={elements:null,primitive:4,count:-1,offset:0,instances:-1},Se=C0(Ft,qe),ir=T0(Ft,nr,yt,We),Cr=et(Ft,qe,Se,nr,ir);function We(En){return Cr.destroyBuffer(En)}var Rr=X_(Ft,qe,ir,nr),Je=At(Ft,ue,nr,yt),Sr=Ql(Ft,qe,Se,function(){fn.procs.poll()},Ke,nr,yt),Xe=Xu(Ft,qe,Se,nr,yt),br=D(Ft,qe,Se,Sr,Xe,nr),fn=Y0(Ft,ue,qe,Se,ir,Rr,Sr,br,fr,Cr,Je,ie,Ke,pr,yt),Bn=se(Ft,br,fn.procs.poll,Ke,ve,qe,Se),Er=fn.next,er=Ft.canvas,Ue=[],dn=[],si=[],Ir=[yt.onDestroy],ti=null;function Dn(){if(Ue.length===0){pr&&pr.update(),ti=null;return}ti=Gu.next(Dn),Qs();for(var En=Ue.length-1;En>=0;--En){var fi=Ue[En];fi&&fi(Ke,null,0)}Ft.flush(),pr&&pr.update()}function Tn(){!ti&&Ue.length>0&&(ti=Gu.next(Dn))}function Hi(){ti&&(Gu.cancel(Dn),ti=null)}function Io(En){En.preventDefault(),Ne=!0,Hi(),dn.forEach(function(fi){fi()})}function Ts(En){Ft.getError(),Ne=!1,ye.restore(),Je.restore(),ir.restore(),Sr.restore(),Xe.restore(),br.restore(),Cr.restore(),pr&&pr.restore(),fn.procs.refresh(),Tn(),si.forEach(function(fi){fi()})}er&&(er.addEventListener(rE,Io,!1),er.addEventListener(E2,Ts,!1));function vi(){Ue.length=0,Hi(),er&&(er.removeEventListener(rE,Io),er.removeEventListener(E2,Ts)),Je.clear(),br.clear(),Xe.clear(),Sr.clear(),Rr.clear(),ir.clear(),Cr.clear(),pr&&pr.clear(),Ir.forEach(function(En){En()})}function Lo(En){bt(!!En,"invalid args to regl({...})"),bt.type(En,"object","invalid args to regl({...})");function fi(ce){var Ht=n({},ce);delete Ht.uniforms,delete Ht.attributes,delete Ht.context,delete Ht.vao,"stencil"in Ht&&Ht.stencil.op&&(Ht.stencil.opBack=Ht.stencil.opFront=Ht.stencil.op,delete Ht.stencil.op);function Yt(Jt){if(Jt in Ht){var Lt=Ht[Jt];delete Ht[Jt],Object.keys(Lt).forEach(function(Wt){Ht[Jt+"."+Wt]=Lt[Wt]})}}return Yt("blend"),Yt("depth"),Yt("cull"),Yt("stencil"),Yt("polygonOffset"),Yt("scissor"),Yt("sample"),"vao"in ce&&(Ht.vao=ce.vao),Ht}function Fi(ce){var Ht={},Yt={};return Object.keys(ce).forEach(function(Jt){var Lt=ce[Jt];fo.isDynamic(Lt)?Yt[Jt]=fo.unbox(Lt,Jt):Ht[Jt]=Lt}),{dynamic:Yt,static:Ht}}var Oo=Fi(En.context||{}),wh=Fi(En.uniforms||{}),It=Fi(En.attributes||{}),_e=Fi(fi(En)),he={gpuTime:0,cpuTime:0,count:0},Pr=fn.compile(_e,It,wh,Oo,he),ei=Pr.draw,fa=Pr.batch,st=Pr.scope,wt=[];function Bt(ce){for(;wt.length<ce;)wt.push(null);return wt}function de(ce,Ht){var Yt;if(Ne&&bt.raise("context lost"),typeof ce=="function")return st.call(this,null,ce,0);if(typeof Ht=="function")if(typeof ce=="number")for(Yt=0;Yt<ce;++Yt)st.call(this,null,Ht,Yt);else if(Array.isArray(ce))for(Yt=0;Yt<ce.length;++Yt)st.call(this,ce[Yt],Ht,Yt);else return st.call(this,ce,Ht,0);else if(typeof ce=="number"){if(ce>0)return fa.call(this,Bt(ce|0),ce|0)}else if(Array.isArray(ce)){if(ce.length)return fa.call(this,ce,ce.length)}else return ei.call(this,ce)}return n(de,{stats:he})}var Ia=br.setFBO=Lo({framebuffer:fo.define.call(null,nE,"framebuffer")});function Yo(En,fi){var Fi=0;fn.procs.poll();var Oo=fi.color;Oo&&(Ft.clearColor(+Oo[0]||0,+Oo[1]||0,+Oo[2]||0,+Oo[3]||0),Fi|=x2),"depth"in fi&&(Ft.clearDepth(+fi.depth),Fi|=cl),"stencil"in fi&&(Ft.clearStencil(fi.stencil|0),Fi|=CL),bt(!!Fi,"called regl.clear with no buffer specified"),Ft.clear(Fi)}function Zo(En){if(bt(typeof En=="object"&&En,"regl.clear() takes an object as input"),"framebuffer"in En)if(En.framebuffer&&En.framebuffer_reglType==="framebufferCube")for(var fi=0;fi<6;++fi)Ia(n({framebuffer:En.framebuffer.faces[fi]},En),Yo);else Ia(En,Yo);else Yo(null,En)}function so(En){bt.type(En,"function","regl.frame() callback must be a function"),Ue.push(En);function fi(){var Fi=w2(Ue,En);bt(Fi>=0,"cannot cancel a frame twice");function Oo(){var wh=w2(Ue,Oo);Ue[wh]=Ue[Ue.length-1],Ue.length-=1,Ue.length<=0&&Hi()}Ue[Fi]=Oo}return Tn(),{cancel:fi}}function ps(){var En=Er.viewport,fi=Er.scissor_box;En[0]=En[1]=fi[0]=fi[1]=0,Ke.viewportWidth=Ke.framebufferWidth=Ke.drawingBufferWidth=En[2]=fi[2]=Ft.drawingBufferWidth,Ke.viewportHeight=Ke.framebufferHeight=Ke.drawingBufferHeight=En[3]=fi[3]=Ft.drawingBufferHeight}function Qs(){Ke.tick+=1,Ke.time=Qn(),ps(),fn.procs.poll()}function qo(){ps(),fn.procs.refresh(),pr&&pr.update()}function Qn(){return(Cl()-or)/1e3}qo();function ks(En,fi){bt.type(fi,"function","listener callback must be a function");var Fi;switch(En){case"frame":return so(fi);case"lost":Fi=dn;break;case"restore":Fi=si;break;case"destroy":Fi=Ir;break;default:bt.raise("invalid event, must be one of frame,lost,restore,destroy")}return Fi.push(fi),{cancel:function(){for(var Oo=0;Oo<Fi.length;++Oo)if(Fi[Oo]===fi){Fi[Oo]=Fi[Fi.length-1],Fi.pop();return}}}}var Xi=n(Lo,{clear:Zo,prop:fo.define.bind(null,nE),context:fo.define.bind(null,SL),this:fo.define.bind(null,TL),draw:Lo({}),buffer:function(En){return ir.create(En,b2,!1,!1)},elements:function(En){return Rr.create(En,!1)},texture:Sr.create2D,cube:Sr.createCube,renderbuffer:Xe.create,framebuffer:br.create,framebufferCube:br.createCube,vao:Cr.createVAO,attributes:ve,frame:so,on:ks,limits:Se,hasExtension:function(En){return Se.extensions.indexOf(En.toLowerCase())>=0},read:Bn,destroy:vi,_gl:Ft,_refresh:qo,poll:function(){Qs(),pr&&pr.update()},now:Qn,stats:nr});return yt.onDone(null,Xi),Xi}return C2})})(htt);var Azt=htt.exports;const Mzt=aa(Azt);var Rzt=class{constructor(e,t){const{buffer:r,offset:n,stride:i,normalized:a,size:o,divisor:s}=t;this.buffer=r,this.attribute={buffer:r.get(),offset:n||0,stride:i||0,normalized:a||!1,divisor:s||0},o&&(this.attribute.size=o)}get(){return this.attribute}updateBuffer(e){this.buffer.subData(e)}destroy(){this.buffer.destroy()}},Izt={[q.POINTS]:"points",[q.LINES]:"lines",[q.LINE_LOOP]:"line loop",[q.LINE_STRIP]:"line strip",[q.TRIANGLES]:"triangles",[q.TRIANGLE_FAN]:"triangle fan",[q.TRIANGLE_STRIP]:"triangle strip"},ftt={[q.STATIC_DRAW]:"static",[q.DYNAMIC_DRAW]:"dynamic",[q.STREAM_DRAW]:"stream"},P4={[q.BYTE]:"int8",[q.INT]:"int32",[q.UNSIGNED_BYTE]:"uint8",[q.UNSIGNED_SHORT]:"uint16",[q.UNSIGNED_INT]:"uint32",[q.FLOAT]:"float"},Lzt={[q.ALPHA]:"alpha",[q.LUMINANCE]:"luminance",[q.LUMINANCE_ALPHA]:"luminance alpha",[q.RGB]:"rgb",[q.RGBA]:"rgba",[q.RGBA4]:"rgba4",[q.RGB5_A1]:"rgb5 a1",[q.RGB565]:"rgb565",[q.DEPTH_COMPONENT]:"depth",[q.DEPTH_STENCIL]:"depth stencil"},Ozt={[q.DONT_CARE]:"dont care",[q.NICEST]:"nice",[q.FASTEST]:"fast"},xH={[q.NEAREST]:"nearest",[q.LINEAR]:"linear",[q.LINEAR_MIPMAP_LINEAR]:"mipmap",[q.NEAREST_MIPMAP_LINEAR]:"nearest mipmap linear",[q.LINEAR_MIPMAP_NEAREST]:"linear mipmap nearest",[q.NEAREST_MIPMAP_NEAREST]:"nearest mipmap nearest"},bH={[q.REPEAT]:"repeat",[q.CLAMP_TO_EDGE]:"clamp",[q.MIRRORED_REPEAT]:"mirror"},Pzt={[q.NONE]:"none",[q.BROWSER_DEFAULT_WEBGL]:"browser"},Dzt={[q.NEVER]:"never",[q.ALWAYS]:"always",[q.LESS]:"less",[q.LEQUAL]:"lequal",[q.GREATER]:"greater",[q.GEQUAL]:"gequal",[q.EQUAL]:"equal",[q.NOTEQUAL]:"notequal"},EH={[q.FUNC_ADD]:"add",[q.MIN_EXT]:"min",[q.MAX_EXT]:"max",[q.FUNC_SUBTRACT]:"subtract",[q.FUNC_REVERSE_SUBTRACT]:"reverse subtract"},_T={[q.ZERO]:"zero",[q.ONE]:"one",[q.SRC_COLOR]:"src color",[q.ONE_MINUS_SRC_COLOR]:"one minus src color",[q.SRC_ALPHA]:"src alpha",[q.ONE_MINUS_SRC_ALPHA]:"one minus src alpha",[q.DST_COLOR]:"dst color",[q.ONE_MINUS_DST_COLOR]:"one minus dst color",[q.DST_ALPHA]:"dst alpha",[q.ONE_MINUS_DST_ALPHA]:"one minus dst alpha",[q.CONSTANT_COLOR]:"constant color",[q.ONE_MINUS_CONSTANT_COLOR]:"one minus constant color",[q.CONSTANT_ALPHA]:"constant alpha",[q.ONE_MINUS_CONSTANT_ALPHA]:"one minus constant alpha",[q.SRC_ALPHA_SATURATE]:"src alpha saturate"},Fzt={[q.NEVER]:"never",[q.ALWAYS]:"always",[q.LESS]:"less",[q.LEQUAL]:"lequal",[q.GREATER]:"greater",[q.GEQUAL]:"gequal",[q.EQUAL]:"equal",[q.NOTEQUAL]:"notequal"},I1={[q.ZERO]:"zero",[q.KEEP]:"keep",[q.REPLACE]:"replace",[q.INVERT]:"invert",[q.INCR]:"increment",[q.DECR]:"decrement",[q.INCR_WRAP]:"increment wrap",[q.DECR_WRAP]:"decrement wrap"},Bzt={[q.FRONT]:"front",[q.BACK]:"back"},Nzt=class{constructor(e,t){this.isDestroyed=!1;const{data:r,usage:n,type:i}=t;this.buffer=e.buffer({data:r,usage:ftt[n||q.STATIC_DRAW],type:P4[i||q.UNSIGNED_BYTE]})}get(){return this.buffer}destroy(){this.isDestroyed||this.buffer.destroy(),this.isDestroyed=!0}subData({data:e,offset:t}){this.buffer.subdata(e,t)}},kzt=class{constructor(e,t){const{data:r,usage:n,type:i,count:a}=t;this.elements=e.elements({data:r,usage:ftt[n||q.STATIC_DRAW],type:P4[i||q.UNSIGNED_BYTE],count:a})}get(){return this.elements}subData({data:e}){this.elements.subdata(e)}destroy(){}},zzt=class{constructor(e,t){const{width:r,height:n,color:i,colors:a}=t,o={width:r,height:n};Array.isArray(a)&&(o.colors=a.map(s=>s.get())),i&&typeof i!="boolean"&&(o.color=i.get()),this.framebuffer=e.framebuffer(o)}get(){return this.framebuffer}destroy(){this.framebuffer.destroy()}resize({width:e,height:t}){this.framebuffer.resize(e,t)}},Uzt=Object.defineProperty,$zt=Object.defineProperties,Hzt=Object.getOwnPropertyDescriptors,wH=Object.getOwnPropertySymbols,Vzt=Object.prototype.hasOwnProperty,Gzt=Object.prototype.propertyIsEnumerable,CH=(e,t,r)=>t in e?Uzt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,GE=(e,t)=>{for(var r in t||(t={}))Vzt.call(t,r)&&CH(e,r,t[r]);if(wH)for(var r of wH(t))Gzt.call(t,r)&&CH(e,r,t[r]);return e},Wzt=(e,t)=>$zt(e,Hzt(t)),{isPlainObject:Xzt,isTypedArray:jzt}=is,Yzt=class{constructor(e,t){this.destroyed=!1,this.uniforms={},this.reGl=e;const{vs:r,fs:n,attributes:i,uniforms:a,primitive:o,count:s,elements:l,depth:u,cull:c,instances:f}=t,d={platformString:"WebGL1",glslVersion:"#version 100",explicitBindingLocations:!1,separateSamplerTextures:!1,viewportOrigin:Od.LOWER_LEFT,clipSpaceNearZ:zx.NEGATIVE_ONE,supportMRT:!1},v={};this.options=t,a&&(this.uniforms=this.extractUniforms(a),Object.keys(a).forEach(A=>{v[A]=e.prop(A)}));const g={};Object.keys(i).forEach(A=>{g[A]=i[A].get()});const x=iU(Vx(d,"frag",n,null,!1)),w=iU(Vx(d,"vert",r,null,!1)),S={attributes:g,frag:x,uniforms:v,vert:w,colorMask:e.prop("colorMask"),lineWidth:1,blend:{enable:e.prop("blend.enable"),func:e.prop("blend.func"),equation:e.prop("blend.equation"),color:e.prop("blend.color")},stencil:{enable:e.prop("stencil.enable"),mask:e.prop("stencil.mask"),func:e.prop("stencil.func"),opFront:e.prop("stencil.opFront"),opBack:e.prop("stencil.opBack")},primitive:Izt[o===void 0?q.TRIANGLES:o]};f&&(S.instances=f),s?S.count=s:l&&(S.elements=l.get()),this.initDepthDrawParams({depth:u},S),this.initCullDrawParams({cull:c},S),this.drawCommand=e(S),this.drawParams=S}updateAttributesAndElements(e,t){const r={};Object.keys(e).forEach(n=>{r[n]=e[n].get()}),this.drawParams.attributes=r,this.drawParams.elements=t.get(),this.drawCommand=this.reGl(this.drawParams)}updateAttributes(e){const t={};Object.keys(e).forEach(r=>{t[r]=e[r].get()}),this.drawParams.attributes=t,this.drawCommand=this.reGl(this.drawParams)}addUniforms(e){this.uniforms=GE(GE({},this.uniforms),this.extractUniforms(e))}draw(e,t){if(this.drawParams.attributes&&Object.keys(this.drawParams.attributes).length===0)return;const r=GE(GE({},this.uniforms),this.extractUniforms(e.uniforms||{})),n={};Object.keys(r).forEach(i=>{const a=typeof r[i];a==="boolean"||a==="number"||Array.isArray(r[i])||r[i].BYTES_PER_ELEMENT?n[i]=r[i]:n[i]=r[i].get()}),n.blend=t?this.getBlendDrawParams({blend:{enable:!1}}):this.getBlendDrawParams(e),n.stencil=this.getStencilDrawParams(e),n.colorMask=this.getColorMaskDrawParams(e,t),this.drawCommand(n)}destroy(){var e,t;(t=(e=this.drawParams)==null?void 0:e.elements)==null||t.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach(r=>{r==null||r.destroy()}),this.destroyed=!0}initDepthDrawParams({depth:e},t){e&&(t.depth={enable:e.enable===void 0?!0:!!e.enable,mask:e.mask===void 0?!0:!!e.mask,func:Dzt[e.func||q.LESS],range:e.range||[0,1]})}getBlendDrawParams({blend:e}){const{enable:t,func:r,equation:n,color:i=[0,0,0,0]}=e||{};return{enable:!!t,func:{srcRGB:_T[r&&r.srcRGB||q.SRC_ALPHA],srcAlpha:_T[r&&r.srcAlpha||q.SRC_ALPHA],dstRGB:_T[r&&r.dstRGB||q.ONE_MINUS_SRC_ALPHA],dstAlpha:_T[r&&r.dstAlpha||q.ONE_MINUS_SRC_ALPHA]},equation:{rgb:EH[n&&n.rgb||q.FUNC_ADD],alpha:EH[n&&n.alpha||q.FUNC_ADD]},color:i}}getStencilDrawParams({stencil:e}){const{enable:t,mask:r=-1,func:n={cmp:q.ALWAYS,ref:0,mask:-1},opFront:i={fail:q.KEEP,zfail:q.KEEP,zpass:q.KEEP},opBack:a={fail:q.KEEP,zfail:q.KEEP,zpass:q.KEEP}}=e||{};return{enable:!!t,mask:r,func:Wzt(GE({},n),{cmp:Fzt[n.cmp]}),opFront:{fail:I1[i.fail],zfail:I1[i.zfail],zpass:I1[i.zpass]},opBack:{fail:I1[a.fail],zfail:I1[a.zfail],zpass:I1[a.zpass]}}}getColorMaskDrawParams({stencil:e},t){return e!=null&&e.enable&&e.opFront&&!t?[!1,!1,!1,!1]:[!0,!0,!0,!0]}initCullDrawParams({cull:e},t){if(e){const{enable:r,face:n=q.BACK}=e;t.cull={enable:!!r,face:Bzt[n]}}}extractUniforms(e){const t={};return Object.keys(e).forEach(r=>{this.extractUniformsRecursively(r,e[r],t,"")}),t}extractUniformsRecursively(e,t,r,n){if(t===null||typeof t=="number"||typeof t=="boolean"||Array.isArray(t)&&typeof t[0]=="number"||jzt(t)||t===""||"resize"in t){r[`${n&&n+"."}${e}`]=t;return}Xzt(t)&&Object.keys(t).forEach(i=>{this.extractUniformsRecursively(i,t[i],r,`${n&&n+"."}${e}`)}),Array.isArray(t)&&t.forEach((i,a)=>{Object.keys(i).forEach(o=>{this.extractUniformsRecursively(o,i[o],r,`${n&&n+"."}${e}[${a}]`)})})}},Zzt=class{constructor(e,t){this.isDestroy=!1;const{data:r,type:n=q.UNSIGNED_BYTE,width:i,height:a,flipY:o=!1,format:s=q.RGBA,mipmap:l=!1,wrapS:u=q.CLAMP_TO_EDGE,wrapT:c=q.CLAMP_TO_EDGE,aniso:f=0,alignment:d=1,premultiplyAlpha:v=!1,mag:g=q.NEAREST,min:x=q.NEAREST,colorSpace:w=q.BROWSER_DEFAULT_WEBGL,x:S=0,y:A=0,copy:M=!1}=t;this.width=i,this.height=a;const R={width:i,height:a,type:P4[n],format:Lzt[s],wrapS:bH[u],wrapT:bH[c],mag:xH[g],min:xH[x],alignment:d,flipY:o,colorSpace:Pzt[w],premultiplyAlpha:v,aniso:f,x:S,y:A,copy:M};r&&(R.data=r),typeof l=="number"?R.mipmap=Ozt[l]:typeof l=="boolean"&&(R.mipmap=l),this.texture=e.texture(R)}get(){return this.texture}update(e={}){this.texture(e)}bind(){this.texture._texture.bind()}resize({width:e,height:t}){this.texture.resize(e,t),this.width=e,this.height=t}getSize(){return[this.width,this.height]}destroy(){var e;this.isDestroy||(e=this.texture)==null||e.destroy(),this.isDestroy=!0}},IO=(e,t,r)=>new Promise((n,i)=>{var a=l=>{try{s(r.next(l))}catch(u){i(u)}},o=l=>{try{s(r.throw(l))}catch(u){i(u)}},s=l=>l.done?n(l.value):Promise.resolve(l.value).then(a,o);s((r=r.apply(e,t)).next())}),qzt=class{constructor(){this.uniformBuffers=[],this.queryVerdorInfo=()=>"WebGL1",this.createModel=e=>new Yzt(this.gl,e),this.createAttribute=e=>new Rzt(this.gl,e),this.createBuffer=e=>new Nzt(this.gl,e),this.createElements=e=>new kzt(this.gl,e),this.createTexture2D=e=>new Zzt(this.gl,e),this.createFramebuffer=e=>new zzt(this.gl,e),this.useFramebuffer=(e,t)=>{this.gl({framebuffer:e?e.get():null})(t)},this.useFramebufferAsync=(e,t)=>IO(this,null,function*(){this.gl({framebuffer:e?e.get():null})(t)}),this.clear=e=>{var t;const{color:r,depth:n,stencil:i,framebuffer:a=null}=e,o={color:r,depth:n,stencil:i};o.framebuffer=a===null?a:a.get(),(t=this.gl)==null||t.clear(o)},this.viewport=({x:e,y:t,width:r,height:n})=>{this.gl._gl.viewport(e,t,r,n),this.width=r,this.height=n,this.gl._refresh()},this.readPixels=e=>{const{framebuffer:t,x:r,y:n,width:i,height:a}=e,o={x:r,y:n,width:i,height:a};return t&&(o.framebuffer=t.get()),this.gl.read(o)},this.readPixelsAsync=e=>IO(this,null,function*(){return this.readPixels(e)}),this.getViewportSize=()=>({width:this.gl._gl.drawingBufferWidth,height:this.gl._gl.drawingBufferHeight}),this.getContainer=()=>{var e;return(e=this.canvas)==null?void 0:e.parentElement},this.getCanvas=()=>this.canvas,this.getGLContext=()=>this.gl._gl,this.destroy=()=>{var e,t,r;this.canvas=null,(r=(t=(e=this.gl)==null?void 0:e._gl)==null?void 0:t.getExtension("WEBGL_lose_context"))==null||r.loseContext(),this.gl.destroy(),this.gl=null}}init(e,t,r){return IO(this,null,function*(){this.canvas=e,r?this.gl=r:this.gl=yield new Promise((n,i)=>{Mzt({canvas:this.canvas,attributes:{alpha:!0,antialias:t.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,stencil:t.stencil},extensions:["OES_element_index_uint","OES_standard_derivatives","ANGLE_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture","WEBGL_lose_context"],profile:!0,onDone:(a,o)=>{(a||!o)&&i(a),n(o)}})}),this.extensionObject={OES_texture_float:this.testExtension("OES_texture_float")}})}getPointSizeRange(){return this.gl._gl.getParameter(this.gl._gl.ALIASED_POINT_SIZE_RANGE)}testExtension(e){return!!this.getGLContext().getExtension(e)}setState(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!0,equation:"add"},framebuffer:null}),this.gl._refresh()}setBaseState(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}setCustomLayerDefaults(){const e=this.getGLContext();e.disable(e.CULL_FACE)}setDirty(e){this.isDirty=e}getDirty(){return this.isDirty}beginFrame(){}endFrame(){}},LO=["selectstart","selecting","selectend"],Kzt=class extends $u.EventEmitter{constructor(e,t={}){super(),this.isEnable=!1,this.onDragStart=r=>{this.box.style.display="block",this.startEvent=this.endEvent=r,this.syncBoxBound(),this.emit("selectstart",this.getLngLatBox(),this.startEvent,this.endEvent)},this.onDragging=r=>{this.endEvent=r,this.syncBoxBound(),this.emit("selecting",this.getLngLatBox(),this.startEvent,this.endEvent)},this.onDragEnd=r=>{this.endEvent=r,this.box.style.display="none",this.emit("selectend",this.getLngLatBox(),this.startEvent,this.endEvent)},this.scene=e,this.options=t}get container(){return this.scene.getMapService().getMarkerContainer()}enable(){if(this.isEnable)return;const{className:e}=this.options;if(this.scene.setMapStatus({dragEnable:!1}),this.container.style.cursor="crosshair",!this.box){const t=uo("div",void 0,this.container);t.classList.add("l7-select-box"),e&&t.classList.add(e),t.style.display="none",this.box=t}this.scene.on("dragstart",this.onDragStart),this.scene.on("dragging",this.onDragging),this.scene.on("dragend",this.onDragEnd),this.isEnable=!0}disable(){this.isEnable&&(this.scene.setMapStatus({dragEnable:!0}),this.container.style.cursor="auto",this.scene.off("dragstart",this.onDragStart),this.scene.off("dragging",this.onDragging),this.scene.off("dragend",this.onDragEnd),this.isEnable=!1)}syncBoxBound(){const{x:e,y:t}=this.startEvent,{x:r,y:n}=this.endEvent,i=Math.min(e,r),a=Math.min(t,n),o=Math.abs(e-r),s=Math.abs(t-n);this.box.style.top=`${a}px`,this.box.style.left=`${i}px`,this.box.style.width=`${o}px`,this.box.style.height=`${s}px`}getLngLatBox(){const{lngLat:{lng:e,lat:t}}=this.startEvent,{lngLat:{lng:r,lat:n}}=this.endEvent;return MTt([[e,t],[r,n]])}},Qzt=Object.defineProperty,Jzt=Object.defineProperties,tUt=Object.getOwnPropertyDescriptors,SH=Object.getOwnPropertySymbols,eUt=Object.prototype.hasOwnProperty,rUt=Object.prototype.propertyIsEnumerable,TH=(e,t,r)=>t in e?Qzt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,nUt=(e,t)=>{for(var r in t||(t={}))eUt.call(t,r)&&TH(e,r,t[r]);if(SH)for(var r of SH(t))rUt.call(t,r)&&TH(e,r,t[r]);return e},iUt=(e,t)=>Jzt(e,tUt(t)),WE=(e,t,r)=>new Promise((n,i)=>{var a=l=>{try{s(r.next(l))}catch(u){i(u)}},o=l=>{try{s(r.throw(l))}catch(u){i(u)}},s=l=>l.done?n(l.value):Promise.resolve(l.value).then(a,o);s((r=r.apply(e,t)).next())}),aUt=class{constructor(e){const{id:t,map:r,renderer:n="device"}=e,i=yLt();this.container=i,r.setContainer(i,t),n==="regl"?i.rendererService=new qzt:i.rendererService=new Tzt,this.sceneService=i.sceneService,this.mapService=i.mapService,this.iconService=i.iconService,this.fontService=i.fontService,this.controlService=i.controlService,this.layerService=i.layerService,this.debugService=i.debugService,this.debugService.setEnable(e.debug),this.markerService=i.markerService,this.interactionService=i.interactionService,this.popupService=i.popupService,this.boxSelect=new Kzt(this,{}),this.initComponent(t),this.sceneService.init(e),this.initControl()}get map(){return this.mapService.map}get loaded(){return this.sceneService.loaded}getServiceContainer(){return this.container}getSize(){return this.mapService.getSize()}getMinZoom(){return this.mapService.getMinZoom()}getMaxZoom(){return this.mapService.getMaxZoom()}getType(){return this.mapService.getType()}getMapContainer(){return this.mapService.getMapContainer()}getMapCanvasContainer(){return this.mapService.getMapCanvasContainer()}getMapService(){return this.mapService}getDebugService(){return this.debugService}exportPng(e){return WE(this,null,function*(){return this.sceneService.exportPng(e)})}exportMap(e){return WE(this,null,function*(){return this.sceneService.exportPng(e)})}registerRenderService(e){this.sceneService.loaded?new e(this).init():this.on("loaded",()=>{new e(this).init()})}setBgColor(e){this.mapService.setBgColor(e)}addLayer(e){this.loaded?this.preAddLayer(e):this.once("loaded",()=>{this.preAddLayer(e)})}preAddLayer(e){const t=Ow(this.container);if(e.setContainer(t),this.sceneService.addLayer(e),e.inited){this.initTileLayer(e);const r=this.initMask(e);this.addMask(r,e.id)}else e.on("inited",()=>{this.initTileLayer(e);const r=this.initMask(e);this.addMask(r,e.id)})}initMask(e){const{mask:t,maskfence:r,maskColor:n="#000",maskOpacity:i=0}=e.getLayerConfig();return!t||!r?void 0:new SJ().source(r).shape("fill").style({color:n,opacity:i})}addMask(e,t){if(!e)return;const r=this.getLayer(t);if(r){const n=Ow(this.container);e.setContainer(n),r.addMaskLayer(e),this.sceneService.addMask(e)}else console.warn("parent layer not find!")}getPickedLayer(){return this.layerService.pickedLayerId}getLayers(){return this.layerService.getLayers()}getLayer(e){return this.layerService.getLayer(e)}getLayerByName(e){return this.layerService.getLayerByName(e)}removeLayer(e,t){return WE(this,null,function*(){yield this.layerService.remove(e,t)})}removeAllLayer(){return WE(this,null,function*(){yield this.layerService.removeAllLayers()})}render(){this.sceneService.render()}setEnableRender(e){this.layerService.setEnableRender(e)}addIconFont(e,t){this.fontService.addIconFont(e,t)}addIconFonts(e){e.forEach(([t,r])=>{this.fontService.addIconFont(t,r)})}addFontFace(e,t){this.fontService.once("fontloaded",r=>{this.emit("fontloaded",r)}),this.fontService.addFontFace(e,t)}addImage(e,t){return WE(this,null,function*(){yield this.iconService.addImage(e,t)})}hasImage(e){return this.iconService.hasImage(e)}removeImage(e){this.iconService.removeImage(e)}addIconFontGlyphs(e,t){this.fontService.addIconGlyphs(t)}addControl(e){this.controlService.addControl(e,this.container)}removeControl(e){this.controlService.removeControl(e)}getControlByName(e){return this.controlService.getControlByName(e)}addMarker(e){this.markerService.addMarker(e)}addMarkerLayer(e){this.markerService.addMarkerLayer(e)}removeMarkerLayer(e){this.markerService.removeMarkerLayer(e)}removeAllMarkers(){this.markerService.removeAllMarkers()}removeAllMakers(){console.warn("removeAllMakers 已废弃，请使用 removeAllMarkers"),this.markerService.removeAllMarkers()}addPopup(e){this.popupService.addPopup(e)}removePopup(e){this.popupService.removePopup(e)}on(e,t){var r;LO.includes(e)?(r=this.boxSelect)==null||r.on(e,t):q2.includes(e)?this.sceneService.on(e,t):this.mapService.on(e,t)}once(e,t){var r;LO.includes(e)?(r=this.boxSelect)==null||r.once(e,t):q2.includes(e)?this.sceneService.once(e,t):this.mapService.once(e,t)}emit(e,t){q2.indexOf(e)===-1?this.mapService.on(e,t):this.sceneService.emit(e,t)}off(e,t){var r;LO.includes(e)?(r=this.boxSelect)==null||r.off(e,t):q2.includes(e)?this.sceneService.off(e,t):this.mapService.off(e,t)}getZoom(){return this.mapService.getZoom()}getCenter(e){return this.mapService.getCenter(e)}setCenter(e,t){return this.mapService.setCenter(e,t)}getPitch(){return this.mapService.getPitch()}setPitch(e){return this.mapService.setPitch(e)}getRotation(){return this.mapService.getRotation()}getBounds(){return this.mapService.getBounds()}setRotation(e){this.mapService.setRotation(e)}zoomIn(){this.mapService.zoomIn()}zoomOut(){this.mapService.zoomOut()}panTo(e){this.mapService.panTo(e)}panBy(e,t){this.mapService.panBy(e,t)}getContainer(){return this.mapService.getContainer()}setZoom(e){this.mapService.setZoom(e)}fitBounds(e,t){const{fitBoundsOptions:r,animate:n}=this.sceneService.getSceneConfig();this.mapService.fitBounds(e,t||iUt(nUt({},r),{animate:n}))}setZoomAndCenter(e,t){this.mapService.setZoomAndCenter(e,t)}setMapStyle(e){this.mapService.setMapStyle(e)}setMapStatus(e){this.mapService.setMapStatus(e)}pixelToLngLat(e){return this.mapService.pixelToLngLat(e)}lngLatToPixel(e){return this.mapService.lngLatToPixel(e)}containerToLngLat(e){return this.mapService.containerToLngLat(e)}lngLatToContainer(e){return this.mapService.lngLatToContainer(e)}destroy(){this.sceneService.destroy()}registerPostProcessingPass(e){this.container.postProcessingPass.name=new e}enableShaderPick(){this.layerService.enableShaderPick()}diasbleShaderPick(){this.layerService.disableShaderPick()}enableBoxSelect(e=!0){this.boxSelect.enable(),e&&this.boxSelect.once("selectend",()=>{this.disableBoxSelect()})}disableBoxSelect(){this.boxSelect.disable()}static addProtocol(e,t){xA.REGISTERED_PROTOCOLS[e]=t}static removeProtocol(e){delete xA.REGISTERED_PROTOCOLS[e]}getProtocol(e){return xA.REGISTERED_PROTOCOLS[e]}startAnimate(){this.layerService.startAnimate()}stopAnimate(){this.layerService.stopAnimate()}getPointSizeRange(){return this.sceneService.getPointSizeRange()}initComponent(e){this.controlService.init({container:sTt(e)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}initControl(){const{logoVisible:e,logoPosition:t}=this.sceneService.getSceneConfig();e&&this.addControl(new hPt({position:t}))}initTileLayer(e){e.getSource().isTile&&(e.tileLayer=new rkt(e))}},Bh=function(e){return e!==null&&typeof e!="function"&&isFinite(e.length)},yy=function(e,t){return Bh(e)?e.indexOf(t)>-1:!1},Wl=function(e,t){if(!Bh(e))return e;for(var r=[],n=0;n<e.length;n++){var i=e[n];t(i,n)&&r.push(i)}return r},oUt=function(e,t){return t===void 0&&(t=[]),Wl(e,function(r){return!yy(t,r)})},sUt={}.toString,d0=function(e,t){return sUt.call(e)==="[object "+t+"]"};const $r=function(e){return d0(e,"Function")};var ke=function(e){return e==null};const ze=function(e){return Array.isArray?Array.isArray(e):d0(e,"Array")},qi=function(e){var t=typeof e;return e!==null&&t==="object"||t==="function"};function ft(e,t){if(e){var r;if(ze(e))for(var n=0,i=e.length;n<i&&(r=t(e[n],n),r!==!1);n++);else if(qi(e)){for(var a in e)if(e.hasOwnProperty(a)&&(r=t(e[a],a),r===!1))break}}}var Eb=Object.keys?function(e){return Object.keys(e)}:function(e){var t=[];return ft(e,function(r,n){$r(e)&&n==="prototype"||t.push(n)}),t};function dtt(e,t){var r=Eb(t),n=r.length;if(ke(e))return!n;for(var i=0;i<n;i+=1){var a=r[i];if(t[a]!==e[a]||!(a in e))return!1}return!0}var QD=function(e){return typeof e=="object"&&e!==null},zp=function(e){if(!QD(e)||!d0(e,"Object"))return!1;if(Object.getPrototypeOf(e)===null)return!0;for(var t=e;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t};function Bd(e,t){if(!ze(e))return null;var r;if($r(t)&&(r=t),zp(t)&&(r=function(i){return dtt(i,t)}),r){for(var n=0;n<e.length;n+=1)if(r(e[n]))return e[n]}return null}function ptt(e,t,r){r===void 0&&(r=0);for(var n=r;n<e.length;n++)if(t(e[n],n))return n;return-1}var lUt=function(e,t){for(var r=null,n=0;n<e.length;n++){var i=e[n],a=i[t];if(!ke(a)){ze(a)?r=a[0]:r=a;break}}return r},Nh=function(e){if(!ze(e))return[];for(var t=[],r=0;r<e.length;r++)t=t.concat(e[r]);return t};const kh=function(e){if(ze(e))return e.reduce(function(t,r){return Math.max(t,r)},e[0])},Vf=function(e){if(ze(e))return e.reduce(function(t,r){return Math.min(t,r)},e[0])};var vtt=function(e){var t=e.filter(function(o){return!isNaN(o)});if(!t.length)return{min:0,max:0};if(ze(e[0])){for(var r=[],n=0;n<e.length;n++)r=r.concat(e[n]);t=r}var i=kh(t),a=Vf(t);return{min:a,max:i}},uUt=Array.prototype.splice,cUt=function(t,r){if(!Bh(t))return[];for(var n=t?r.length:0,i=n-1;n--;){var a=void 0,o=r[n];(n===i||o!==a)&&(a=o,uUt.call(t,o,1))}return t},Fu=function(e,t,r){if(!ze(e)&&!zp(e))return e;var n=r;return ft(e,function(i,a){n=t(n,i,a)}),n},hUt=function(e,t){var r=[];if(!Bh(e))return r;for(var n=-1,i=[],a=e.length;++n<a;){var o=e[n];t(o,n,e)&&(r.push(o),i.push(n))}return cUt(e,i),r};const nn=function(e){return d0(e,"String")};function fUt(e,t){var r;if($r(t))r=function(i,a){return t(i)-t(a)};else{var n=[];nn(t)?n.push(t):ze(t)&&(n=t),r=function(i,a){for(var o=0;o<n.length;o+=1){var s=n[o];if(i[s]>a[s])return 1;if(i[s]<a[s])return-1}return 0}}return e.sort(r),e}function Jy(e,t){t===void 0&&(t=new Map);var r=[];if(Array.isArray(e))for(var n=0,i=e.length;n<i;n++){var a=e[n];t.has(a)||(r.push(a),t.set(a,!0))}return r}const $d=function(e,t){for(var r=[],n={},i=0;i<e.length;i++){var a=e[i],o=a[t];if(!ke(o)){ze(o)||(o=[o]);for(var s=0;s<o.length;s++){var l=o[s];n[l]||(r.push(l),n[l]=!0)}}}return r};function Oh(e){if(Bh(e))return e[0]}function Gs(e){if(Bh(e)){var t=e;return t[t.length-1]}}var D4=function(e,t){for(var r=0;r<e.length;r++)if(!t(e[r],r))return!1;return!0},xI=function(e,t){for(var r=0;r<e.length;r++)if(t(e[r],r))return!0;return!1},dUt=Object.prototype.hasOwnProperty;function Ph(e,t){if(!t||!ze(e))return{};for(var r={},n=$r(t)?t:function(s){return s[t]},i,a=0;a<e.length;a++){var o=e[a];i=n(o),dUt.call(r,i)?r[i].push(o):r[i]=[o]}return r}function gtt(e,t){if(!t)return{0:e};if(!$r(t)){var r=ze(t)?t:t.replace(/\s+/g,"").split("*");t=function(n){for(var i="_",a=0,o=r.length;a<o;a++)i+=n[r[a]]&&n[r[a]].toString();return i}}return Ph(e,t)}const pUt=function(e,t){if(!t)return[e];var r=gtt(e,t),n=[];for(var i in r)n.push(r[i]);return n};var lo=function(e,t,r){return e<t?t:e>r?r:e},OO=function(e,t){var r=t.toString(),n=r.indexOf(".");if(n===-1)return Math.round(e);var i=r.substr(n+1).length;return i>20&&(i=20),parseFloat(e.toFixed(i))},Gn=function(e){return d0(e,"Number")},vUt=1e-5;function Ul(e,t,r){return r===void 0&&(r=vUt),Math.abs(e-t)<r}const mtt=function(e,t){if(ze(e)){for(var r,n=-1/0,i=0;i<e.length;i++){var a=e[i],o=$r(t)?t(a):a[t];o>n&&(r=a,n=o)}return r}},gUt=function(e,t){if(ze(e)){for(var r,n=1/0,i=0;i<e.length;i++){var a=e[i],o=$r(t)?t(a):a[t];o<n&&(r=a,n=o)}return r}};var bI=function(e,t){return(e%t+t)%t},mUt=Math.PI/180,EI=function(e){return mUt*e};const jm=function(e,t){return e.hasOwnProperty(t)};var wI=Object.values?function(e){return Object.values(e)}:function(e){var t=[];return ft(e,function(r,n){$r(e)&&n==="prototype"||t.push(r)}),t};const RS=function(e){return ke(e)?"":e.toString()};var w_=function(e){return RS(e).toLowerCase()},C_=function(e){var t=RS(e);return t.charAt(0).toUpperCase()+t.substring(1)},yUt={}.toString,_Ut=function(e){return yUt.call(e).replace(/^\[object /,"").replace(/]$/,"")},Ym=function(e){return d0(e,"Boolean")},ytt=function(e){return d0(e,"Date")},xUt=function(e){return e===null},bUt=Object.prototype,EUt=function(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||bUt;return e===r},iu=function(e){return e===void 0},_tt=function(e){return e instanceof Element||e instanceof HTMLDocument};function wUt(e){var t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(r){return setTimeout(r,16)};return t(e)}function CUt(e){var t=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame||clearTimeout;t(e)}function PO(e,t){for(var r in t)t.hasOwnProperty(r)&&r!=="constructor"&&t[r]!==void 0&&(e[r]=t[r])}function Sa(e,t,r,n){return t&&PO(e,t),r&&PO(e,r),n&&PO(e,n),e}var $l=function(e){if(typeof e!="object"||e===null)return e;var t;if(ze(e)){t=[];for(var r=0,n=e.length;r<n;r++)typeof e[r]=="object"&&e[r]!=null?t[r]=$l(e[r]):t[r]=e[r]}else{t={};for(var i in e)typeof e[i]=="object"&&e[i]!=null?t[i]=$l(e[i]):t[i]=e[i]}return t};function xtt(e,t,r){var n;return function(){var i=this,a=arguments,o=function(){n=null,r||e.apply(i,a)},s=r&&!n;clearTimeout(n),n=setTimeout(o,t),s&&e.apply(i,a)}}const wb=function(e,t){if(!$r(e))throw new TypeError("Expected a function");var r=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var a=t?t.apply(this,n):n[0],o=r.cache;if(o.has(a))return o.get(a);var s=e.apply(this,n);return o.set(a,s),s};return r.cache=new Map,r};var SUt=5;function btt(e,t,r,n){r=r||0,n=n||SUt;for(var i in t)if(t.hasOwnProperty(i)){var a=t[i];a!==null&&zp(a)?(zp(e[i])||(e[i]={}),r<n?btt(e[i],a,r+1,n):e[i]=t[i]):ze(a)?(e[i]=[],e[i]=e[i].concat(a)):a!==void 0&&(e[i]=a)}}var Tr=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n=0;n<t.length;n+=1)btt(e,t[n]);return e},Ett=function(e,t){if(!Bh(e))return-1;var r=Array.prototype.indexOf;if(r)return r.call(e,t);for(var n=-1,i=0;i<e.length;i++)if(e[i]===t){n=i;break}return n},TUt=Object.prototype.hasOwnProperty;function Kc(e){if(ke(e))return!0;if(Bh(e))return!e.length;var t=_Ut(e);if(t==="Map"||t==="Set")return!e.size;if(EUt(e))return!Object.keys(e).length;for(var r in e)if(TUt.call(e,r))return!1;return!0}var zi=function(e,t){if(e===t)return!0;if(!e||!t||nn(e)||nn(t))return!1;if(Bh(e)||Bh(t)){if(e.length!==t.length)return!1;for(var r=!0,n=0;n<e.length&&(r=zi(e[n],t[n]),!!r);n++);return r}if(QD(e)||QD(t)){var i=Object.keys(e),a=Object.keys(t);if(i.length!==a.length)return!1;for(var r=!0,n=0;n<i.length&&(r=zi(e[i[n]],t[i[n]]),!!r);n++);return r}return!1},mo=function(e,t){if(!Bh(e))return e;for(var r=[],n=0;n<e.length;n++){var i=e[n];r.push(t(i,n))}return r},AUt=function(e){return e};const MUt=function(e,t){t===void 0&&(t=AUt);var r={};return qi(e)&&!ke(e)&&Object.keys(e).forEach(function(n){r[n]=t(e[n],n)}),r},xt=function(e,t,r){for(var n=0,i=nn(t)?t.split("."):t;e&&n<i.length;)e=e[i[n++]];return e===void 0||n<i.length?r:e},Hs=function(e,t,r){var n=e,i=nn(t)?t.split("."):t;return i.forEach(function(a,o){o<i.length-1?(qi(n[a])||(n[a]=Gn(i[o+1])?[]:{}),n=n[a]):n[a]=r}),e};var RUt=Object.prototype.hasOwnProperty;const Up=function(e,t){if(e===null||!zp(e))return{};var r={};return ft(t,function(n){RUt.call(e,n)&&(r[n]=e[n])}),r},CI=function(e,t){return Fu(e,function(r,n,i){return t.includes(i)||(r[i]=n),r},{})},F4=function(e,t,r){var n,i,a,o,s=0;r||(r={});var l=function(){s=r.leading===!1?0:Date.now(),n=null,o=e.apply(i,a),n||(i=a=null)},u=function(){var c=Date.now();!s&&r.leading===!1&&(s=c);var f=t-(c-s);return i=this,a=arguments,f<=0||f>t?(n&&(clearTimeout(n),n=null),s=c,o=e.apply(i,a),n||(i=a=null)):!n&&r.trailing!==!1&&(n=setTimeout(l,f)),o};return u.cancel=function(){clearTimeout(n),s=0,n=i=a=null},u},IUt=function(e){return Bh(e)?Array.prototype.slice.call(e):[]};var xT={};const Gh=function(e){return e=e||"g",xT[e]?xT[e]+=1:xT[e]=1,e+xT[e]},Mm=function(){};function _l(e){return ke(e)?0:Bh(e)?e.length:Object.keys(e).length}var bT;const ET=wb(function(e,t){t===void 0&&(t={});var r=t.fontSize,n=t.fontFamily,i=t.fontWeight,a=t.fontStyle,o=t.fontVariant;return bT||(bT=document.createElement("canvas").getContext("2d")),bT.font=[a,o,i,r+"px",n].join(" "),bT.measureText(nn(e)?e:"").width},function(e,t){return t===void 0&&(t={}),Wy([e],wI(t)).join("")}),LUt=function(e,t,r,n){n===void 0&&(n="...");var i=16,a=ET(n,r),o=nn(e)?e:RS(e),s=t,l=[],u,c;if(ET(e,r)<=t)return e;for(;u=o.substr(0,i),c=ET(u,r),!(c+a>s&&c>s);)if(l.push(u),s-=c,o=o.substr(i),!o)return l.join("");for(;u=o.substr(0,1),c=ET(u,r),!(c+a>s);)if(l.push(u),s-=c,o=o.substr(1),!o)return l.join("");return""+l.join("")+n};var OUt=function(){function e(){this.map={}}return e.prototype.has=function(t){return this.map[t]!==void 0},e.prototype.get=function(t,r){var n=this.map[t];return n===void 0?r:n},e.prototype.set=function(t,r){this.map[t]=r},e.prototype.clear=function(){this.map={}},e.prototype.delete=function(t){delete this.map[t]},e.prototype.size=function(){return Object.keys(this.map).length},e}(),Fw=`	
\v\f\r   ᠎             　\u2028\u2029`,PUt=new RegExp("([a-z])["+Fw+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+Fw+"]*,?["+Fw+"]*)+)","ig"),DUt=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+Fw+"]*,?["+Fw+"]*","ig"),K1=function(e){if(!e)return null;if(ze(e))return e;var t={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},r=[];return String(e).replace(PUt,function(n,i,a){var o=[],s=i.toLowerCase();if(a.replace(DUt,function(l,u){u&&o.push(+u)}),s==="m"&&o.length>2&&(r.push([i].concat(o.splice(0,2))),s="l",i=i==="m"?"l":"L"),s==="o"&&o.length===1&&r.push([i,o[0]]),s==="r")r.push([i].concat(o));else for(;o.length>=t[s]&&(r.push([i].concat(o.splice(0,t[s]))),!!t[s]););return e}),r},JD=function(e,t){for(var r=[],n=0,i=e.length;i-2*!t>n;n+=2){var a=[{x:+e[n-2],y:+e[n-1]},{x:+e[n],y:+e[n+1]},{x:+e[n+2],y:+e[n+3]},{x:+e[n+4],y:+e[n+5]}];t?n?i-4===n?a[3]={x:+e[0],y:+e[1]}:i-2===n&&(a[2]={x:+e[0],y:+e[1]},a[3]={x:+e[2],y:+e[3]}):a[0]={x:+e[i-2],y:+e[i-1]}:i-4===n?a[3]=a[2]:n||(a[0]={x:+e[n],y:+e[n+1]}),r.push(["C",(-a[0].x+6*a[1].x+a[2].x)/6,(-a[0].y+6*a[1].y+a[2].y)/6,(a[1].x+6*a[2].x-a[3].x)/6,(a[1].y+6*a[2].y-a[3].y)/6,a[2].x,a[2].y])}return r},wT=function(e,t,r,n,i){var a=[];if(i===null&&n===null&&(n=r),e=+e,t=+t,r=+r,n=+n,i!==null){var o=Math.PI/180,s=e+r*Math.cos(-n*o),l=e+r*Math.cos(-i*o),u=t+r*Math.sin(-n*o),c=t+r*Math.sin(-i*o);a=[["M",s,u],["A",r,r,0,+(i-n>180),0,l,c]]}else a=[["M",e,t],["m",0,-n],["a",r,n,0,1,1,0,2*n],["a",r,n,0,1,1,0,-2*n],["z"]];return a},tF=function(e){if(e=K1(e),!e||!e.length)return[["M",0,0]];var t=[],r=0,n=0,i=0,a=0,o=0,s,l;e[0][0]==="M"&&(r=+e[0][1],n=+e[0][2],i=r,a=n,o++,t[0]=["M",r,n]);for(var u=e.length===3&&e[0][0]==="M"&&e[1][0].toUpperCase()==="R"&&e[2][0].toUpperCase()==="Z",c=void 0,f=void 0,d=o,v=e.length;d<v;d++){if(t.push(c=[]),f=e[d],s=f[0],s!==s.toUpperCase())switch(c[0]=s.toUpperCase(),c[0]){case"A":c[1]=f[1],c[2]=f[2],c[3]=f[3],c[4]=f[4],c[5]=f[5],c[6]=+f[6]+r,c[7]=+f[7]+n;break;case"V":c[1]=+f[1]+n;break;case"H":c[1]=+f[1]+r;break;case"R":l=[r,n].concat(f.slice(1));for(var g=2,x=l.length;g<x;g++)l[g]=+l[g]+r,l[++g]=+l[g]+n;t.pop(),t=t.concat(JD(l,u));break;case"O":t.pop(),l=wT(r,n,f[1],f[2]),l.push(l[0]),t=t.concat(l);break;case"U":t.pop(),t=t.concat(wT(r,n,f[1],f[2],f[3])),c=["U"].concat(t[t.length-1].slice(-2));break;case"M":i=+f[1]+r,a=+f[2]+n;break;default:for(var g=1,x=f.length;g<x;g++)c[g]=+f[g]+(g%2?r:n)}else if(s==="R")l=[r,n].concat(f.slice(1)),t.pop(),t=t.concat(JD(l,u)),c=["R"].concat(f.slice(-2));else if(s==="O")t.pop(),l=wT(r,n,f[1],f[2]),l.push(l[0]),t=t.concat(l);else if(s==="U")t.pop(),t=t.concat(wT(r,n,f[1],f[2],f[3])),c=["U"].concat(t[t.length-1].slice(-2));else for(var w=0,S=f.length;w<S;w++)c[w]=f[w];if(s=s.toUpperCase(),s!=="O")switch(c[0]){case"Z":r=+i,n=+a;break;case"H":r=c[1];break;case"V":n=c[1];break;case"M":i=c[c.length-2],a=c[c.length-1];break;default:r=c[c.length-2],n=c[c.length-1]}}return t},CT=function(e,t,r,n){return[e,t,r,n,r,n]},AH=function(e,t,r,n,i,a){var o=.3333333333333333,s=2/3;return[o*e+s*r,o*t+s*n,o*i+s*r,o*a+s*n,i,a]},wtt=function(e,t,r,n,i,a,o,s,l,u){r===n&&(r+=1);var c=Math.PI*120/180,f=Math.PI/180*(+i||0),d=[],v,g,x,w,S,A=function(Gr,Mn,ee){var rr=Gr*Math.cos(ee)-Mn*Math.sin(ee),Nr=Gr*Math.sin(ee)+Mn*Math.cos(ee);return{x:rr,y:Nr}};if(u)g=u[0],x=u[1],w=u[2],S=u[3];else{v=A(e,t,-f),e=v.x,t=v.y,v=A(s,l,-f),s=v.x,l=v.y,e===s&&t===l&&(s+=1,l+=1);var M=(e-s)/2,R=(t-l)/2,O=M*M/(r*r)+R*R/(n*n);O>1&&(O=Math.sqrt(O),r=O*r,n=O*n);var N=r*r,k=n*n,V=(a===o?-1:1)*Math.sqrt(Math.abs((N*k-N*R*R-k*M*M)/(N*R*R+k*M*M)));w=V*r*R/n+(e+s)/2,S=V*-n*M/r+(t+l)/2,g=Math.asin(((t-S)/n).toFixed(9)),x=Math.asin(((l-S)/n).toFixed(9)),g=e<w?Math.PI-g:g,x=s<w?Math.PI-x:x,g<0&&(g=Math.PI*2+g),x<0&&(x=Math.PI*2+x),o&&g>x&&(g=g-Math.PI*2),!o&&x>g&&(x=x-Math.PI*2)}var Q=x-g;if(Math.abs(Q)>c){var Y=x,X=s,tt=l;x=g+c*(o&&x>g?1:-1),s=w+r*Math.cos(x),l=S+n*Math.sin(x),d=wtt(s,l,r,n,i,0,o,X,tt,[x,Y,w,S])}Q=x-g;var it=Math.cos(g),Et=Math.sin(g),Tt=Math.cos(x),pt=Math.sin(x),kt=Math.tan(Q/4),ae=4/3*r*kt,Kt=4/3*n*kt,re=[e,t],fe=[e+ae*Et,t-Kt*it],Oe=[s+ae*pt,l-Kt*Tt],Ye=[s,l];if(fe[0]=2*re[0]-fe[0],fe[1]=2*re[1]-fe[1],u)return[fe,Oe,Ye].concat(d);d=[fe,Oe,Ye].concat(d).join().split(",");for(var Be=[],De=0,Yr=d.length;De<Yr;De++)Be[De]=De%2?A(d[De-1],d[De],f).y:A(d[De],d[De+1],f).x;return Be},eF=function(e,t){var r=tF(e),n=t&&tF(t),i={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},a={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},o=[],s=[],l="",u="",c,f=function(M,R,O){var N,k;if(!M)return["C",R.x,R.y,R.x,R.y,R.x,R.y];switch(!(M[0]in{T:1,Q:1})&&(R.qx=R.qy=null),M[0]){case"M":R.X=M[1],R.Y=M[2];break;case"A":M=["C"].concat(wtt.apply(0,[R.x,R.y].concat(M.slice(1))));break;case"S":O==="C"||O==="S"?(N=R.x*2-R.bx,k=R.y*2-R.by):(N=R.x,k=R.y),M=["C",N,k].concat(M.slice(1));break;case"T":O==="Q"||O==="T"?(R.qx=R.x*2-R.qx,R.qy=R.y*2-R.qy):(R.qx=R.x,R.qy=R.y),M=["C"].concat(AH(R.x,R.y,R.qx,R.qy,M[1],M[2]));break;case"Q":R.qx=M[1],R.qy=M[2],M=["C"].concat(AH(R.x,R.y,M[1],M[2],M[3],M[4]));break;case"L":M=["C"].concat(CT(R.x,R.y,M[1],M[2]));break;case"H":M=["C"].concat(CT(R.x,R.y,M[1],R.y));break;case"V":M=["C"].concat(CT(R.x,R.y,R.x,M[1]));break;case"Z":M=["C"].concat(CT(R.x,R.y,R.X,R.Y));break}return M},d=function(M,R){if(M[R].length>7){M[R].shift();for(var O=M[R];O.length;)o[R]="A",n&&(s[R]="A"),M.splice(R++,0,["C"].concat(O.splice(0,6)));M.splice(R,1),c=Math.max(r.length,n&&n.length||0)}},v=function(M,R,O,N,k){M&&R&&M[k][0]==="M"&&R[k][0]!=="M"&&(R.splice(k,0,["M",N.x,N.y]),O.bx=0,O.by=0,O.x=M[k][1],O.y=M[k][2],c=Math.max(r.length,n&&n.length||0))};c=Math.max(r.length,n&&n.length||0);for(var g=0;g<c;g++){r[g]&&(l=r[g][0]),l!=="C"&&(o[g]=l,g&&(u=o[g-1])),r[g]=f(r[g],i,u),o[g]!=="A"&&l==="C"&&(o[g]="C"),d(r,g),n&&(n[g]&&(l=n[g][0]),l!=="C"&&(s[g]=l,g&&(u=s[g-1])),n[g]=f(n[g],a,u),s[g]!=="A"&&l==="C"&&(s[g]="C"),d(n,g)),v(r,n,i,a,g),v(n,r,a,i,g);var x=r[g],w=n&&n[g],S=x.length,A=n&&w.length;i.x=x[S-2],i.y=x[S-1],i.bx=parseFloat(x[S-4])||i.x,i.by=parseFloat(x[S-3])||i.y,a.bx=n&&(parseFloat(w[A-4])||a.x),a.by=n&&(parseFloat(w[A-3])||a.y),a.x=n&&w[A-2],a.y=n&&w[A-1]}return n?[r,n]:r},FUt=/,?([a-z]),?/gi,Ctt=function(e){return e.join(",").replace(FUt,"$1")},MH=function(e,t,r,n,i){var a=-3*t+9*r-9*n+3*i,o=e*a+6*t-12*r+6*n;return e*o-3*t+3*r},RH=function(e,t,r,n,i,a,o,s,l){l===null&&(l=1),l=l>1?1:l<0?0:l;for(var u=l/2,c=12,f=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],d=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],v=0,g=0;g<c;g++){var x=u*f[g]+u,w=MH(x,e,r,i,o),S=MH(x,t,n,a,s),A=w*w+S*S;v+=d[g]*Math.sqrt(A)}return u*v},BUt=function(e,t,r,n,i,a,o,s){for(var l=[],u=[[],[]],c,f,d,v,g=0;g<2;++g){if(g===0?(f=6*e-12*r+6*i,c=-3*e+9*r-9*i+3*o,d=3*r-3*e):(f=6*t-12*n+6*a,c=-3*t+9*n-9*a+3*s,d=3*n-3*t),Math.abs(c)<1e-12){if(Math.abs(f)<1e-12)continue;v=-d/f,v>0&&v<1&&l.push(v);continue}var x=f*f-4*d*c,w=Math.sqrt(x);if(!(x<0)){var S=(-f+w)/(2*c);S>0&&S<1&&l.push(S);var A=(-f-w)/(2*c);A>0&&A<1&&l.push(A)}}for(var M=l.length,R=M,O;M--;)v=l[M],O=1-v,u[0][M]=O*O*O*e+3*O*O*v*r+3*O*v*v*i+v*v*v*o,u[1][M]=O*O*O*t+3*O*O*v*n+3*O*v*v*a+v*v*v*s;return u[0][R]=e,u[1][R]=t,u[0][R+1]=o,u[1][R+1]=s,u[0].length=u[1].length=R+2,{min:{x:Math.min.apply(0,u[0]),y:Math.min.apply(0,u[1])},max:{x:Math.max.apply(0,u[0]),y:Math.max.apply(0,u[1])}}},NUt=function(e,t,r,n,i,a,o,s){if(!(Math.max(e,r)<Math.min(i,o)||Math.min(e,r)>Math.max(i,o)||Math.max(t,n)<Math.min(a,s)||Math.min(t,n)>Math.max(a,s))){var l=(e*n-t*r)*(i-o)-(e-r)*(i*s-a*o),u=(e*n-t*r)*(a-s)-(t-n)*(i*s-a*o),c=(e-r)*(a-s)-(t-n)*(i-o);if(c){var f=l/c,d=u/c,v=+f.toFixed(2),g=+d.toFixed(2);if(!(v<+Math.min(e,r).toFixed(2)||v>+Math.max(e,r).toFixed(2)||v<+Math.min(i,o).toFixed(2)||v>+Math.max(i,o).toFixed(2)||g<+Math.min(t,n).toFixed(2)||g>+Math.max(t,n).toFixed(2)||g<+Math.min(a,s).toFixed(2)||g>+Math.max(a,s).toFixed(2)))return{x:f,y:d}}}},sm=function(e,t,r){return t>=e.x&&t<=e.x+e.width&&r>=e.y&&r<=e.y+e.height},Stt=function(e,t,r,n,i){if(i)return[["M",+e+ +i,t],["l",r-i*2,0],["a",i,i,0,0,1,i,i],["l",0,n-i*2],["a",i,i,0,0,1,-i,i],["l",i*2-r,0],["a",i,i,0,0,1,-i,-i],["l",0,i*2-n],["a",i,i,0,0,1,i,-i],["z"]];var a=[["M",e,t],["l",r,0],["l",0,n],["l",-r,0],["z"]];return a.parsePathArray=Ctt,a},rF=function(e,t,r,n){return e===null&&(e=t=r=n=0),t===null&&(t=e.y,r=e.width,n=e.height,e=e.x),{x:e,y:t,width:r,w:r,height:n,h:n,x2:e+r,y2:t+n,cx:e+r/2,cy:t+n/2,r1:Math.min(r,n)/2,r2:Math.max(r,n)/2,r0:Math.sqrt(r*r+n*n)/2,path:Stt(e,t,r,n),vb:[e,t,r,n].join(" ")}},kUt=function(e,t){return e=rF(e),t=rF(t),sm(t,e.x,e.y)||sm(t,e.x2,e.y)||sm(t,e.x,e.y2)||sm(t,e.x2,e.y2)||sm(e,t.x,t.y)||sm(e,t.x2,t.y)||sm(e,t.x,t.y2)||sm(e,t.x2,t.y2)||(e.x<t.x2&&e.x>t.x||t.x<e.x2&&t.x>e.x)&&(e.y<t.y2&&e.y>t.y||t.y<e.y2&&t.y>e.y)},IH=function(e,t,r,n,i,a,o,s){ze(e)||(e=[e,t,r,n,i,a,o,s]);var l=BUt.apply(null,e);return rF(l.min.x,l.min.y,l.max.x-l.min.x,l.max.y-l.min.y)},LH=function(e,t,r,n,i,a,o,s,l){var u=1-l,c=Math.pow(u,3),f=Math.pow(u,2),d=l*l,v=d*l,g=c*e+f*3*l*r+u*3*l*l*i+v*o,x=c*t+f*3*l*n+u*3*l*l*a+v*s,w=e+2*l*(r-e)+d*(i-2*r+e),S=t+2*l*(n-t)+d*(a-2*n+t),A=r+2*l*(i-r)+d*(o-2*i+r),M=n+2*l*(a-n)+d*(s-2*a+n),R=u*e+l*r,O=u*t+l*n,N=u*i+l*o,k=u*a+l*s,V=90-Math.atan2(w-A,S-M)*180/Math.PI;return{x:g,y:x,m:{x:w,y:S},n:{x:A,y:M},start:{x:R,y:O},end:{x:N,y:k},alpha:V}},zUt=function(e,t,r){var n=IH(e),i=IH(t);if(!kUt(n,i))return r?0:[];for(var a=RH.apply(0,e),o=RH.apply(0,t),s=~~(a/8),l=~~(o/8),u=[],c=[],f={},d=r?0:[],v=0;v<s+1;v++){var g=LH.apply(0,e.concat(v/s));u.push({x:g.x,y:g.y,t:v/s})}for(var v=0;v<l+1;v++){var g=LH.apply(0,t.concat(v/l));c.push({x:g.x,y:g.y,t:v/l})}for(var v=0;v<s;v++)for(var x=0;x<l;x++){var w=u[v],S=u[v+1],A=c[x],M=c[x+1],R=Math.abs(S.x-w.x)<.001?"y":"x",O=Math.abs(M.x-A.x)<.001?"y":"x",N=NUt(w.x,w.y,S.x,S.y,A.x,A.y,M.x,M.y);if(N){if(f[N.x.toFixed(4)]===N.y.toFixed(4))continue;f[N.x.toFixed(4)]=N.y.toFixed(4);var k=w.t+Math.abs((N[R]-w[R])/(S[R]-w[R]))*(S.t-w.t),V=A.t+Math.abs((N[O]-A[O])/(M[O]-A[O]))*(M.t-A.t);k>=0&&k<=1&&V>=0&&V<=1&&(r?d+=1:d.push({x:N.x,y:N.y,t1:k,t2:V}))}}return d},UUt=function(e,t,r){e=eF(e),t=eF(t);for(var n,i,a,o,s,l,u,c,f,d,v=r?0:[],g=0,x=e.length;g<x;g++){var w=e[g];if(w[0]==="M")n=s=w[1],i=l=w[2];else{w[0]==="C"?(f=[n,i].concat(w.slice(1)),n=f[6],i=f[7]):(f=[n,i,n,i,s,l,s,l],n=s,i=l);for(var S=0,A=t.length;S<A;S++){var M=t[S];if(M[0]==="M")a=u=M[1],o=c=M[2];else{M[0]==="C"?(d=[a,o].concat(M.slice(1)),a=d[6],o=d[7]):(d=[a,o,a,o,u,c,u,c],a=u,o=c);var R=zUt(f,d,r);if(r)v+=R;else{for(var O=0,N=R.length;O<N;O++)R[O].segment1=g,R[O].segment2=S,R[O].bez1=f,R[O].bez2=d;v=v.concat(R)}}}}}return v},$Ut=function(e,t){return UUt(e,t)};function HUt(e,t){var r=[],n=[];function i(a,o){if(a.length===1)r.push(a[0]),n.push(a[0]);else{for(var s=[],l=0;l<a.length-1;l++)l===0&&r.push(a[0]),l===a.length-2&&n.push(a[l+1]),s[l]=[(1-o)*a[l][0]+o*a[l+1][0],(1-o)*a[l][1]+o*a[l+1][1]];i(s,o)}}return e.length&&i(e,t),{left:r,right:n.reverse()}}function VUt(e,t,r){var n=[[e[1],e[2]]];r=r||2;var i=[];t[0]==="A"?(n.push(t[6]),n.push(t[7])):t[0]==="C"?(n.push([t[1],t[2]]),n.push([t[3],t[4]]),n.push([t[5],t[6]])):t[0]==="S"||t[0]==="Q"?(n.push([t[1],t[2]]),n.push([t[3],t[4]])):n.push([t[1],t[2]]);for(var a=n,o=1/r,s=0;s<r-1;s++){var l=o/(1-o*s),u=HUt(a,l);i.push(u.left),a=u.right}i.push(a);var c=i.map(function(f){var d=[];return f.length===4&&(d.push("C"),d=d.concat(f[2])),f.length>=3&&(f.length===3&&d.push("Q"),d=d.concat(f[1])),f.length===2&&d.push("L"),d=d.concat(f[f.length-1]),d});return c}var GUt=function(e,t,r){if(r===1)return[[].concat(e)];var n=[];if(t[0]==="L"||t[0]==="C"||t[0]==="Q")n=n.concat(VUt(e,t,r));else{var i=[].concat(e);i[0]==="M"&&(i[0]="L");for(var a=0;a<=r-1;a++)n.push(i)}return n},WUt=function(e,t){if(e.length===1)return e;var r=e.length-1,n=t.length-1,i=r/n,a=[];if(e.length===1&&e[0][0]==="M"){for(var o=0;o<n-r;o++)e.push(e[0]);return e}for(var o=0;o<n;o++){var s=Math.floor(i*o);a[s]=(a[s]||0)+1}var l=a.reduce(function(u,c,f){return f===r?u.concat(e[r]):u.concat(GUt(e[f],e[f+1],c))},[]);return l.unshift(e[0]),(t[n]==="Z"||t[n]==="z")&&l.push("Z"),l},XUt=function(e,t){if(e.length!==t.length)return!1;var r=!0;return ft(e,function(n,i){if(n!==t[i])return r=!1,!1}),r};function jUt(e,t,r){var n=null,i=r;return t<i&&(i=t,n="add"),e<i&&(i=e,n="del"),{type:n,min:i}}var YUt=function(e,t){var r=e.length,n=t.length,i,a,o=0;if(r===0||n===0)return null;for(var s=[],l=0;l<=r;l++)s[l]=[],s[l][0]={min:l};for(var u=0;u<=n;u++)s[0][u]={min:u};for(var l=1;l<=r;l++){i=e[l-1];for(var u=1;u<=n;u++){a=t[u-1],XUt(i,a)?o=0:o=1;var c=s[l-1][u].min+1,f=s[l][u-1].min+1,d=s[l-1][u-1].min+o;s[l][u]=jUt(c,f,d)}}return s},Ttt=function(e,t){var r=YUt(e,t),n=e.length,i=t.length,a=[],o=1,s=1;if(r[n][i].min!==n){for(var l=1;l<=n;l++){var u=r[l][l].min;s=l;for(var c=o;c<=i;c++)r[l][c].min<u&&(u=r[l][c].min,s=c);o=s,r[l][o].type&&a.push({index:l-1,type:r[l][o].type})}for(var l=a.length-1;l>=0;l--)o=a[l].index,a[l].type==="add"?e.splice(o,0,[].concat(e[o])):e.splice(o,1)}n=e.length;var f=i-n;if(n<i)for(var l=0;l<f;l++)e[n-1][0]==="z"||e[n-1][0]==="Z"?e.splice(n-2,0,e[n-2]):e.push(e[n-1]),n+=1;return e};function DO(e,t,r){for(var n=[].concat(e),i,a=1/(r+1),o=Att(t)[0],s=1;s<=r;s++)a*=s,i=Math.floor(e.length*a),i===0?n.unshift([o[0]*a+e[i][0]*(1-a),o[1]*a+e[i][1]*(1-a)]):n.splice(i,0,[o[0]*a+e[i][0]*(1-a),o[1]*a+e[i][1]*(1-a)]);return n}function Att(e){var t=[];switch(e[0]){case"M":t.push([e[1],e[2]]);break;case"L":t.push([e[1],e[2]]);break;case"A":t.push([e[6],e[7]]);break;case"Q":t.push([e[3],e[4]]),t.push([e[1],e[2]]);break;case"T":t.push([e[1],e[2]]);break;case"C":t.push([e[5],e[6]]),t.push([e[1],e[2]]),t.push([e[3],e[4]]);break;case"S":t.push([e[3],e[4]]),t.push([e[1],e[2]]);break;case"H":t.push([e[1],e[1]]);break;case"V":t.push([e[1],e[1]]);break}return t}var nF=function(e,t){if(e.length<=1)return e;for(var r,n=0;n<t.length;n++)if(e[n][0]!==t[n][0])switch(r=Att(e[n]),t[n][0]){case"M":e[n]=["M"].concat(r[0]);break;case"L":e[n]=["L"].concat(r[0]);break;case"A":e[n]=[].concat(t[n]),e[n][6]=r[0][0],e[n][7]=r[0][1];break;case"Q":if(r.length<2)if(n>0)r=DO(r,e[n-1],1);else{e[n]=t[n];break}e[n]=["Q"].concat(r.reduce(function(i,a){return i.concat(a)},[]));break;case"T":e[n]=["T"].concat(r[0]);break;case"C":if(r.length<3)if(n>0)r=DO(r,e[n-1],2);else{e[n]=t[n];break}e[n]=["C"].concat(r.reduce(function(i,a){return i.concat(a)},[]));break;case"S":if(r.length<2)if(n>0)r=DO(r,e[n-1],1);else{e[n]=t[n];break}e[n]=["S"].concat(r.reduce(function(i,a){return i.concat(a)},[]));break;default:e[n]=t[n]}return e};const B4=Object.freeze(Object.defineProperty({__proto__:null,catmullRomToBezier:JD,fillPath:WUt,fillPathByDiff:Ttt,formatPath:nF,intersection:$Ut,parsePathArray:Ctt,parsePathString:K1,pathToAbsolute:tF,pathToCurve:eF,rectPath:Stt},Symbol.toStringTag,{value:"Module"}));var IS=function(){function e(t,r){this.bubbles=!0,this.target=null,this.currentTarget=null,this.delegateTarget=null,this.delegateObject=null,this.defaultPrevented=!1,this.propagationStopped=!1,this.shape=null,this.fromShape=null,this.toShape=null,this.propagationPath=[],this.type=t,this.name=t,this.originalEvent=r,this.timeStamp=r.timeStamp}return e.prototype.preventDefault=function(){this.defaultPrevented=!0,this.originalEvent.preventDefault&&this.originalEvent.preventDefault()},e.prototype.stopPropagation=function(){this.propagationStopped=!0},e.prototype.toString=function(){var t=this.type;return"[Event (type="+t+")]"},e.prototype.save=function(){},e.prototype.restore=function(){},e}(),ZUt="*",S_=function(){function e(){this._events={}}return e.prototype.on=function(t,r,n){return this._events[t]||(this._events[t]=[]),this._events[t].push({callback:r,once:!!n}),this},e.prototype.once=function(t,r){return this.on(t,r,!0)},e.prototype.emit=function(t){for(var r=this,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var a=this._events[t]||[],o=this._events[ZUt]||[],s=function(l){for(var u=l.length,c=0;c<u;c++)if(l[c]){var f=l[c],d=f.callback,v=f.once;v&&(l.splice(c,1),l.length===0&&delete r._events[t],u--,c--),d.apply(r,n)}};s(a),s(o)},e.prototype.off=function(t,r){if(!t)this._events={};else if(!r)delete this._events[t];else{for(var n=this._events[t]||[],i=n.length,a=0;a<i;a++)n[a].callback===r&&(n.splice(a,1),i--,a--);n.length===0&&delete this._events[t]}return this},e.prototype.getEvents=function(){return this._events},e}();function Mtt(e,t){var r=e.indexOf(t);r!==-1&&e.splice(r,1)}var OH=typeof window<"u"&&typeof window.document<"u";function Rtt(e,t){if(e.isCanvas())return!0;for(var r=t.getParent(),n=!1;r;){if(r===e){n=!0;break}r=r.getParent()}return n}function bC(e){return e.cfg.visible&&e.cfg.capture}var SI=function(e){Ut(t,e);function t(r){var n=e.call(this)||this;n.destroyed=!1;var i=n.getDefaultCfg();return n.cfg=Sa(i,r),n}return t.prototype.getDefaultCfg=function(){return{}},t.prototype.get=function(r){return this.cfg[r]},t.prototype.set=function(r,n){this.cfg[r]=n},t.prototype.destroy=function(){this.cfg={destroyed:!0},this.off(),this.destroyed=!0},t}(S_),PH=globalThis&&globalThis.__spreadArray||function(e,t,r){if(r||arguments.length===2)for(var n=0,i=t.length,a;n<i;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))},qUt=function(){function e(t,r,n){this.name=t,this.version=r,this.os=n,this.type="browser"}return e}(),KUt=function(){function e(t){this.version=t,this.type="node",this.name="node",this.os=process.platform}return e}(),QUt=function(){function e(t,r,n,i){this.name=t,this.version=r,this.os=n,this.bot=i,this.type="bot-device"}return e}(),JUt=function(){function e(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return e}(),t9t=function(){function e(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return e}(),e9t=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,r9t=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,DH=3,n9t=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",e9t]],FH=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Itt(e){return e?BH(e):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new t9t:typeof navigator<"u"?BH(navigator.userAgent):o9t()}function i9t(e){return e!==""&&n9t.reduce(function(t,r){var n=r[0],i=r[1];if(t)return t;var a=i.exec(e);return!!a&&[n,a]},!1)}function BH(e){var t=i9t(e);if(!t)return null;var r=t[0],n=t[1];if(r==="searchbot")return new JUt;var i=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);i?i.length<DH&&(i=PH(PH([],i,!0),s9t(DH-i.length),!0)):i=[];var a=i.join("."),o=a9t(e),s=r9t.exec(e);return s&&s[1]?new QUt(r,a,o,s[1]):new qUt(r,a,o)}function a9t(e){for(var t=0,r=FH.length;t<r;t++){var n=FH[t],i=n[0],a=n[1],o=a.exec(e);if(o)return i}return null}function o9t(){var e=typeof process<"u"&&process.version;return e?new KUt(process.version.slice(1)):null}function s9t(e){for(var t=[],r=0;r<e;r++)t.push("0");return t}function U1(e,t,r){var n=[0,0,0,0,0,0,0,0,0];return XRt(n,r),uI(e,n,t)}function N4(e,t,r){var n=[0,0,0,0,0,0,0,0,0];return jRt(n,r),uI(e,n,t)}function Ltt(e,t,r){var n=[0,0,0,0,0,0,0,0,0];return YRt(n,r),uI(e,n,t)}function l9t(e,t,r){return uI(e,r,t)}function Vs(e,t){for(var r=e?[].concat(e):[1,0,0,0,1,0,0,0,1],n=0,i=t.length;n<i;n++){var a=t[n];switch(a[0]){case"t":U1(r,r,[a[1],a[2]]);break;case"s":Ltt(r,r,[a[1],a[2]]);break;case"r":N4(r,r,a[1]);break;case"m":l9t(r,r,a[1]);break}}return r}function u9t(e,t){return e[0]*t[1]-t[0]*e[1]}function k4(e,t,r){var n=dD(e,t),i=u9t(e,t)>=0;return r?i?Math.PI*2-n:n:i?n:Math.PI*2-n}function NH(e,t){var r=[],n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],f=e[8],d=t[0],v=t[1],g=t[2],x=t[3],w=t[4],S=t[5],A=t[6],M=t[7],R=t[8];return r[0]=d*n+v*o+g*u,r[1]=d*i+v*s+g*c,r[2]=d*a+v*l+g*f,r[3]=x*n+w*o+S*u,r[4]=x*i+w*s+S*c,r[5]=x*a+w*l+S*f,r[6]=A*n+M*o+R*u,r[7]=A*i+M*s+R*c,r[8]=A*a+M*l+R*f,r}function Zv(e,t){var r=[],n=t[0],i=t[1];return r[0]=e[0]*n+e[3]*i+e[6],r[1]=e[1]*n+e[4]*i+e[7],r}function TI(e){var t=[],r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],f=c*o-s*u,d=-c*a+s*l,v=u*a-o*l,g=r*f+n*d+i*v;return g?(g=1/g,t[0]=f*g,t[1]=(-c*n+i*u)*g,t[2]=(s*n-i*o)*g,t[3]=d*g,t[4]=(c*r-i*l)*g,t[5]=(-s*r+i*a)*g,t[6]=v*g,t[7]=(-u*r+n*l)*g,t[8]=(o*r-n*a)*g,t):null}var XE=Vs,FO="matrix",c9t=["zIndex","capture","visible","type"],h9t=["repeat"],f9t=":",d9t="*";function p9t(e){for(var t=[],r=0;r<e.length;r++)ze(e[r])?t.push([].concat(e[r])):t.push(e[r]);return t}function v9t(e,t){var r={},n=t.attrs;for(var i in e)r[i]=n[i];return r}function g9t(e,t){var r={},n=t.attr();return ft(e,function(i,a){h9t.indexOf(a)===-1&&!zi(n[a],i)&&(r[a]=i)}),r}function m9t(e,t){if(t.onFrame)return e;var r=t.startTime,n=t.delay,i=t.duration,a=Object.prototype.hasOwnProperty;return ft(e,function(o){r+n<o.startTime+o.delay+o.duration&&i>o.delay&&ft(t.toAttrs,function(s,l){a.call(o.toAttrs,l)&&(delete o.toAttrs[l],delete o.fromAttrs[l])})}),e}var Ott=function(e){Ut(t,e);function t(r){var n=e.call(this,r)||this;n.attrs={};var i=n.getDefaultAttrs();return Sa(i,r.attrs),n.attrs=i,n.initAttrs(i),n.initAnimate(),n}return t.prototype.getDefaultCfg=function(){return{visible:!0,capture:!0,zIndex:0}},t.prototype.getDefaultAttrs=function(){return{matrix:this.getDefaultMatrix(),opacity:1}},t.prototype.onCanvasChange=function(r){},t.prototype.initAttrs=function(r){},t.prototype.initAnimate=function(){this.set("animable",!0),this.set("animating",!1)},t.prototype.isGroup=function(){return!1},t.prototype.getParent=function(){return this.get("parent")},t.prototype.getCanvas=function(){return this.get("canvas")},t.prototype.attr=function(){for(var r,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var a=n[0],o=n[1];if(!a)return this.attrs;if(qi(a)){for(var s in a)this.setAttr(s,a[s]);return this.afterAttrsChange(a),this}return n.length===2?(this.setAttr(a,o),this.afterAttrsChange((r={},r[a]=o,r)),this):this.attrs[a]},t.prototype.isClipped=function(r,n){var i=this.getClip();return i&&!i.isHit(r,n)},t.prototype.setAttr=function(r,n){var i=this.attrs[r];i!==n&&(this.attrs[r]=n,this.onAttrChange(r,n,i))},t.prototype.onAttrChange=function(r,n,i){r==="matrix"&&this.set("totalMatrix",null)},t.prototype.afterAttrsChange=function(r){if(this.cfg.isClipShape){var n=this.cfg.applyTo;n&&n.onCanvasChange("clip")}else this.onCanvasChange("attr")},t.prototype.show=function(){return this.set("visible",!0),this.onCanvasChange("show"),this},t.prototype.hide=function(){return this.set("visible",!1),this.onCanvasChange("hide"),this},t.prototype.setZIndex=function(r){this.set("zIndex",r);var n=this.getParent();return n&&n.sort(),this},t.prototype.toFront=function(){var r=this.getParent();if(r){var n=r.getChildren();this.get("el");var i=n.indexOf(this);n.splice(i,1),n.push(this),this.onCanvasChange("zIndex")}},t.prototype.toBack=function(){var r=this.getParent();if(r){var n=r.getChildren();this.get("el");var i=n.indexOf(this);n.splice(i,1),n.unshift(this),this.onCanvasChange("zIndex")}},t.prototype.remove=function(r){r===void 0&&(r=!0);var n=this.getParent();n?(Mtt(n.getChildren(),this),n.get("clearing")||this.onCanvasChange("remove")):this.onCanvasChange("remove"),r&&this.destroy()},t.prototype.resetMatrix=function(){this.attr(FO,this.getDefaultMatrix()),this.onCanvasChange("matrix")},t.prototype.getMatrix=function(){return this.attr(FO)},t.prototype.setMatrix=function(r){this.attr(FO,r),this.onCanvasChange("matrix")},t.prototype.getTotalMatrix=function(){var r=this.cfg.totalMatrix;if(!r){var n=this.attr("matrix"),i=this.cfg.parentMatrix;i&&n?r=NH(i,n):r=n||i,this.set("totalMatrix",r)}return r},t.prototype.applyMatrix=function(r){var n=this.attr("matrix"),i=null;r&&n?i=NH(r,n):i=n||r,this.set("totalMatrix",i),this.set("parentMatrix",r)},t.prototype.getDefaultMatrix=function(){return null},t.prototype.applyToMatrix=function(r){var n=this.attr("matrix");return n?Zv(n,r):r},t.prototype.invertFromMatrix=function(r){var n=this.attr("matrix");if(n){var i=TI(n);if(i)return Zv(i,r)}return r},t.prototype.setClip=function(r){var n=this.getCanvas(),i=null;if(r){var a=this.getShapeBase(),o=C_(r.type),s=a[o];s&&(i=new s({type:r.type,isClipShape:!0,applyTo:this,attrs:r.attrs,canvas:n}))}return this.set("clipShape",i),this.onCanvasChange("clip"),i},t.prototype.getClip=function(){var r=this.cfg.clipShape;return r||null},t.prototype.clone=function(){var r=this,n=this.attrs,i={};ft(n,function(s,l){ze(n[l])?i[l]=p9t(n[l]):i[l]=n[l]});var a=this.constructor,o=new a({attrs:i});return ft(c9t,function(s){o.set(s,r.get(s))}),o},t.prototype.destroy=function(){var r=this.destroyed;r||(this.attrs={},e.prototype.destroy.call(this))},t.prototype.isAnimatePaused=function(){return this.get("_pause").isPaused},t.prototype.animate=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];if(!(!this.get("timeline")&&!this.get("canvas"))){this.set("animating",!0);var i=this.get("timeline");i||(i=this.get("canvas").get("timeline"),this.set("timeline",i));var a=this.get("animations")||[];i.timer||i.initTimer();var o=r[0],s=r[1],l=r[2],u=l===void 0?"easeLinear":l,c=r[3],f=c===void 0?Mm:c,d=r[4],v=d===void 0?0:d,g,x,w,S,A;$r(o)?(g=o,o={}):qi(o)&&o.onFrame&&(g=o.onFrame,x=o.repeat),qi(s)?(A=s,s=A.duration,u=A.easing||"easeLinear",v=A.delay||0,x=A.repeat||x||!1,f=A.callback||Mm,w=A.pauseCallback||Mm,S=A.resumeCallback||Mm):(Gn(f)&&(v=f,f=null),$r(u)?(f=u,u="easeLinear"):u=u||"easeLinear");var M=g9t(o,this),R={fromAttrs:v9t(M,this),toAttrs:M,duration:s,easing:u,repeat:x,callback:f,pauseCallback:w,resumeCallback:S,delay:v,startTime:i.getTime(),id:Gh(),onFrame:g,pathFormatted:!1};a.length>0?a=m9t(a,R):i.addAnimator(this),a.push(R),this.set("animations",a),this.set("_pause",{isPaused:!1})}},t.prototype.stopAnimate=function(r){var n=this;r===void 0&&(r=!0);var i=this.get("animations");ft(i,function(a){r&&(a.onFrame?n.attr(a.onFrame(1)):n.attr(a.toAttrs)),a.callback&&a.callback()}),this.set("animating",!1),this.set("animations",[])},t.prototype.pauseAnimate=function(){var r=this.get("timeline"),n=this.get("animations"),i=r.getTime();return ft(n,function(a){a._paused=!0,a._pauseTime=i,a.pauseCallback&&a.pauseCallback()}),this.set("_pause",{isPaused:!0,pauseTime:i}),this},t.prototype.resumeAnimate=function(){var r=this.get("timeline"),n=r.getTime(),i=this.get("animations"),a=this.get("_pause").pauseTime;return ft(i,function(o){o.startTime=o.startTime+(n-a),o._paused=!1,o._pauseTime=null,o.resumeCallback&&o.resumeCallback()}),this.set("_pause",{isPaused:!1}),this.set("animations",i),this},t.prototype.emitDelegation=function(r,n){var i=this,a=n.propagationPath;this.getEvents();var o;r==="mouseenter"?o=n.fromShape:r==="mouseleave"&&(o=n.toShape);for(var s=function(f){var d=a[f],v=d.get("name");if(v){if((d.isGroup()||d.isCanvas&&d.isCanvas())&&o&&Rtt(d,o))return"break";ze(v)?ft(v,function(g){i.emitDelegateEvent(d,g,n)}):l.emitDelegateEvent(d,v,n)}},l=this,u=0;u<a.length;u++){var c=s(u);if(c==="break")break}},t.prototype.emitDelegateEvent=function(r,n,i){var a=this.getEvents(),o=n+f9t+i.type;(a[o]||a[d9t])&&(i.name=o,i.currentTarget=r,i.delegateTarget=this,i.delegateObject=r.get("delegateObject"),this.emit(o,i))},t.prototype.translate=function(r,n){r===void 0&&(r=0),n===void 0&&(n=0);var i=this.getMatrix(),a=XE(i,[["t",r,n]]);return this.setMatrix(a),this},t.prototype.move=function(r,n){var i=this.attr("x")||0,a=this.attr("y")||0;return this.translate(r-i,n-a),this},t.prototype.moveTo=function(r,n){return this.move(r,n)},t.prototype.scale=function(r,n){var i=this.getMatrix(),a=XE(i,[["s",r,n||r]]);return this.setMatrix(a),this},t.prototype.rotate=function(r){var n=this.getMatrix(),i=XE(n,[["r",r]]);return this.setMatrix(i),this},t.prototype.rotateAtStart=function(r){var n=this.attr(),i=n.x,a=n.y,o=this.getMatrix(),s=XE(o,[["t",-i,-a],["r",r],["t",i,a]]);return this.setMatrix(s),this},t.prototype.rotateAtPoint=function(r,n,i){var a=this.getMatrix(),o=XE(a,[["t",-r,-n],["r",i],["t",r,n]]);return this.setMatrix(o),this},t}(SI),kH={},iF="_INDEX";function Ptt(e,t){if(e.set("canvas",t),e.isGroup()){var r=e.get("children");r.length&&r.forEach(function(n){Ptt(n,t)})}}function Dtt(e,t){if(e.set("timeline",t),e.isGroup()){var r=e.get("children");r.length&&r.forEach(function(n){Dtt(n,t)})}}function y9t(e,t,r){r===void 0&&(r=!0),r?t.destroy():(t.set("parent",null),t.set("canvas",null)),Mtt(e.getChildren(),t)}function _9t(e){return function(t,r){var n=e(t,r);return n===0?t[iF]-r[iF]:n}}var Ftt=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.isCanvas=function(){return!1},t.prototype.getBBox=function(){var r=1/0,n=-1/0,i=1/0,a=-1/0,o=this.getChildren().filter(function(l){return l.get("visible")&&(!l.isGroup()||l.isGroup()&&l.getChildren().length>0)});o.length>0?ft(o,function(l){var u=l.getBBox(),c=u.minX,f=u.maxX,d=u.minY,v=u.maxY;c<r&&(r=c),f>n&&(n=f),d<i&&(i=d),v>a&&(a=v)}):(r=0,n=0,i=0,a=0);var s={x:r,y:i,minX:r,minY:i,maxX:n,maxY:a,width:n-r,height:a-i};return s},t.prototype.getCanvasBBox=function(){var r=1/0,n=-1/0,i=1/0,a=-1/0,o=this.getChildren().filter(function(l){return l.get("visible")&&(!l.isGroup()||l.isGroup()&&l.getChildren().length>0)});o.length>0?ft(o,function(l){var u=l.getCanvasBBox(),c=u.minX,f=u.maxX,d=u.minY,v=u.maxY;c<r&&(r=c),f>n&&(n=f),d<i&&(i=d),v>a&&(a=v)}):(r=0,n=0,i=0,a=0);var s={x:r,y:i,minX:r,minY:i,maxX:n,maxY:a,width:n-r,height:a-i};return s},t.prototype.getDefaultCfg=function(){var r=e.prototype.getDefaultCfg.call(this);return r.children=[],r},t.prototype.onAttrChange=function(r,n,i){if(e.prototype.onAttrChange.call(this,r,n,i),r==="matrix"){var a=this.getTotalMatrix();this._applyChildrenMarix(a)}},t.prototype.applyMatrix=function(r){var n=this.getTotalMatrix();e.prototype.applyMatrix.call(this,r);var i=this.getTotalMatrix();i!==n&&this._applyChildrenMarix(i)},t.prototype._applyChildrenMarix=function(r){var n=this.getChildren();ft(n,function(i){i.applyMatrix(r)})},t.prototype.addShape=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i=r[0],a=r[1];qi(i)?a=i:a.type=i;var o=kH[a.type];o||(o=C_(a.type),kH[a.type]=o);var s=this.getShapeBase(),l=new s[o](a);return this.add(l),l},t.prototype.addGroup=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i=r[0],a=r[1],o;if($r(i))a?o=new i(a):o=new i({parent:this});else{var s=i||{},l=this.getGroupBase();o=new l(s)}return this.add(o),o},t.prototype.getCanvas=function(){var r;return this.isCanvas()?r=this:r=this.get("canvas"),r},t.prototype.getShape=function(r,n,i){if(!bC(this))return null;var a=this.getChildren(),o;if(this.isCanvas())o=this._findShape(a,r,n,i);else{var s=[r,n,1];s=this.invertFromMatrix(s),this.isClipped(s[0],s[1])||(o=this._findShape(a,s[0],s[1],i))}return o},t.prototype._findShape=function(r,n,i,a){for(var o=null,s=r.length-1;s>=0;s--){var l=r[s];if(bC(l)&&(l.isGroup()?o=l.getShape(n,i,a):l.isHit(n,i)&&(o=l)),o)break}return o},t.prototype.add=function(r){var n=this.getCanvas(),i=this.getChildren(),a=this.get("timeline"),o=r.getParent();o&&y9t(o,r,!1),r.set("parent",this),n&&Ptt(r,n),a&&Dtt(r,a),i.push(r),r.onCanvasChange("add"),this._applyElementMatrix(r)},t.prototype._applyElementMatrix=function(r){var n=this.getTotalMatrix();n&&r.applyMatrix(n)},t.prototype.getChildren=function(){return this.get("children")||[]},t.prototype.sort=function(){var r=this.getChildren();ft(r,function(n,i){return n[iF]=i,n}),r.sort(_9t(function(n,i){return n.get("zIndex")-i.get("zIndex")})),this.onCanvasChange("sort")},t.prototype.clear=function(){if(this.set("clearing",!0),!this.destroyed){for(var r=this.getChildren(),n=r.length-1;n>=0;n--)r[n].destroy();this.set("children",[]),this.onCanvasChange("clear"),this.set("clearing",!1)}},t.prototype.destroy=function(){this.get("destroyed")||(this.clear(),e.prototype.destroy.call(this))},t.prototype.getFirst=function(){return this.getChildByIndex(0)},t.prototype.getLast=function(){var r=this.getChildren();return this.getChildByIndex(r.length-1)},t.prototype.getChildByIndex=function(r){var n=this.getChildren();return n[r]},t.prototype.getCount=function(){var r=this.getChildren();return r.length},t.prototype.contain=function(r){var n=this.getChildren();return n.indexOf(r)>-1},t.prototype.removeChild=function(r,n){n===void 0&&(n=!0),this.contain(r)&&r.remove(n)},t.prototype.findAll=function(r){var n=[],i=this.getChildren();return ft(i,function(a){r(a)&&n.push(a),a.isGroup()&&(n=n.concat(a.findAll(r)))}),n},t.prototype.find=function(r){var n=null,i=this.getChildren();return ft(i,function(a){if(r(a)?n=a:a.isGroup()&&(n=a.find(r)),n)return!1}),n},t.prototype.findById=function(r){return this.find(function(n){return n.get("id")===r})},t.prototype.findByClassName=function(r){return this.find(function(n){return n.get("className")===r})},t.prototype.findAllByName=function(r){return this.findAll(function(n){return n.get("name")===r})},t}(Ott),Wx=0,yw=0,jE=0,Btt=1e3,WM,_w,XM=0,t_=0,AI=0,EC=typeof performance=="object"&&performance.now?performance:Date,Ntt=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function ktt(){return t_||(Ntt(x9t),t_=EC.now()+AI)}function x9t(){t_=0}function aF(){this._call=this._time=this._next=null}aF.prototype=ztt.prototype={constructor:aF,restart:function(e,t,r){if(typeof e!="function")throw new TypeError("callback is not a function");r=(r==null?ktt():+r)+(t==null?0:+t),!this._next&&_w!==this&&(_w?_w._next=this:WM=this,_w=this),this._call=e,this._time=r,oF()},stop:function(){this._call&&(this._call=null,this._time=1/0,oF())}};function ztt(e,t,r){var n=new aF;return n.restart(e,t,r),n}function b9t(){ktt(),++Wx;for(var e=WM,t;e;)(t=t_-e._time)>=0&&e._call.call(null,t),e=e._next;--Wx}function zH(){t_=(XM=EC.now())+AI,Wx=yw=0;try{b9t()}finally{Wx=0,w9t(),t_=0}}function E9t(){var e=EC.now(),t=e-XM;t>Btt&&(AI-=t,XM=e)}function w9t(){for(var e,t=WM,r,n=1/0;t;)t._call?(n>t._time&&(n=t._time),e=t,t=t._next):(r=t._next,t._next=null,t=e?e._next=r:WM=r);_w=e,oF(n)}function oF(e){if(!Wx){yw&&(yw=clearTimeout(yw));var t=e-t_;t>24?(e<1/0&&(yw=setTimeout(zH,e-EC.now()-AI)),jE&&(jE=clearInterval(jE))):(jE||(XM=EC.now(),jE=setInterval(E9t,Btt)),Wx=1,Ntt(zH))}}const z4=e=>()=>e;function C9t(e,t){return function(r){return e+r*t}}function S9t(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function T9t(e){return(e=+e)==1?Utt:function(t,r){return r-t?S9t(t,r,e):z4(isNaN(t)?r:t)}}function Utt(e,t){var r=t-e;return r?C9t(e,r):z4(isNaN(e)?t:e)}const UH=function e(t){var r=T9t(t);function n(i,a){var o=r((i=Gm(i)).r,(a=Gm(a)).r),s=r(i.g,a.g),l=r(i.b,a.b),u=Utt(i.opacity,a.opacity);return function(c){return i.r=o(c),i.g=s(c),i.b=l(c),i.opacity=u(c),i+""}}return n.gamma=e,n}(1);function $tt(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),i;return function(a){for(i=0;i<r;++i)n[i]=e[i]*(1-a)+t[i]*a;return n}}function Htt(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function A9t(e,t){return(Htt(t)?$tt:Vtt)(e,t)}function Vtt(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,i=new Array(n),a=new Array(r),o;for(o=0;o<n;++o)i[o]=jM(e[o],t[o]);for(;o<r;++o)a[o]=t[o];return function(s){for(o=0;o<n;++o)a[o]=i[o](s);return a}}function M9t(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function sF(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function R9t(e,t){var r={},n={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?r[i]=jM(e[i],t[i]):n[i]=t[i];return function(a){for(i in r)n[i]=r[i](a);return n}}var lF=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,BO=new RegExp(lF.source,"g");function I9t(e){return function(){return e}}function L9t(e){return function(t){return e(t)+""}}function O9t(e,t){var r=lF.lastIndex=BO.lastIndex=0,n,i,a,o=-1,s=[],l=[];for(e=e+"",t=t+"";(n=lF.exec(e))&&(i=BO.exec(t));)(a=i.index)>r&&(a=t.slice(r,a),s[o]?s[o]+=a:s[++o]=a),(n=n[0])===(i=i[0])?s[o]?s[o]+=i:s[++o]=i:(s[++o]=null,l.push({i:o,x:sF(n,i)})),r=BO.lastIndex;return r<t.length&&(a=t.slice(r),s[o]?s[o]+=a:s[++o]=a),s.length<2?l[0]?L9t(l[0].x):I9t(t):(t=l.length,function(u){for(var c=0,f;c<t;++c)s[(f=l[c]).i]=f.x(u);return s.join("")})}function jM(e,t){var r=typeof t,n;return t==null||r==="boolean"?z4(t):(r==="number"?sF:r==="string"?(n=Vm(t))?(t=n,UH):O9t:t instanceof Vm?UH:t instanceof Date?M9t:Htt(t)?$tt:Array.isArray(t)?Vtt:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?R9t:sF)(e,t)}function P9t(e){return+e}function D9t(e){return e*e}function F9t(e){return e*(2-e)}function $H(e){return((e*=2)<=1?e*e:--e*(2-e)+1)/2}function B9t(e){return e*e*e}function N9t(e){return--e*e*e+1}function HH(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var U4=3,k9t=function e(t){t=+t;function r(n){return Math.pow(n,t)}return r.exponent=e,r}(U4),z9t=function e(t){t=+t;function r(n){return 1-Math.pow(1-n,t)}return r.exponent=e,r}(U4),VH=function e(t){t=+t;function r(n){return((n*=2)<=1?Math.pow(n,t):2-Math.pow(2-n,t))/2}return r.exponent=e,r}(U4),Gtt=Math.PI,Wtt=Gtt/2;function U9t(e){return+e==1?1:1-Math.cos(e*Wtt)}function $9t(e){return Math.sin(e*Wtt)}function GH(e){return(1-Math.cos(Gtt*e))/2}function Zm(e){return(Math.pow(2,-10*e)-.0009765625)*1.0009775171065494}function H9t(e){return Zm(1-+e)}function V9t(e){return 1-Zm(e)}function WH(e){return((e*=2)<=1?Zm(1-e):2-Zm(e-1))/2}function G9t(e){return 1-Math.sqrt(1-e*e)}function W9t(e){return Math.sqrt(1- --e*e)}function XH(e){return((e*=2)<=1?1-Math.sqrt(1-e*e):Math.sqrt(1-(e-=2)*e)+1)/2}var uF=4/11,X9t=6/11,j9t=8/11,Y9t=3/4,Z9t=9/11,q9t=10/11,K9t=15/16,Q9t=21/22,J9t=63/64,ST=1/uF/uF;function t$t(e){return 1-wC(1-e)}function wC(e){return(e=+e)<uF?ST*e*e:e<j9t?ST*(e-=X9t)*e+Y9t:e<q9t?ST*(e-=Z9t)*e+K9t:ST*(e-=Q9t)*e+J9t}function e$t(e){return((e*=2)<=1?1-wC(1-e):wC(e-1)+1)/2}var $4=1.70158,r$t=function e(t){t=+t;function r(n){return(n=+n)*n*(t*(n-1)+n)}return r.overshoot=e,r}($4),n$t=function e(t){t=+t;function r(n){return--n*n*((n+1)*t+n)+1}return r.overshoot=e,r}($4),jH=function e(t){t=+t;function r(n){return((n*=2)<1?n*n*((t+1)*n-t):(n-=2)*n*((t+1)*n+t)+2)/2}return r.overshoot=e,r}($4),Xx=2*Math.PI,H4=1,V4=.3,i$t=function e(t,r){var n=Math.asin(1/(t=Math.max(1,t)))*(r/=Xx);function i(a){return t*Zm(- --a)*Math.sin((n-a)/r)}return i.amplitude=function(a){return e(a,r*Xx)},i.period=function(a){return e(t,a)},i}(H4,V4),YH=function e(t,r){var n=Math.asin(1/(t=Math.max(1,t)))*(r/=Xx);function i(a){return 1-t*Zm(a=+a)*Math.sin((a+n)/r)}return i.amplitude=function(a){return e(a,r*Xx)},i.period=function(a){return e(t,a)},i}(H4,V4),a$t=function e(t,r){var n=Math.asin(1/(t=Math.max(1,t)))*(r/=Xx);function i(a){return((a=a*2-1)<0?t*Zm(-a)*Math.sin((n-a)/r):2-t*Zm(a)*Math.sin((n+a)/r))/2}return i.amplitude=function(a){return e(a,r*Xx)},i.period=function(a){return e(t,a)},i}(H4,V4);const o$t=Object.freeze(Object.defineProperty({__proto__:null,easeBack:jH,easeBackIn:r$t,easeBackInOut:jH,easeBackOut:n$t,easeBounce:wC,easeBounceIn:t$t,easeBounceInOut:e$t,easeBounceOut:wC,easeCircle:XH,easeCircleIn:G9t,easeCircleInOut:XH,easeCircleOut:W9t,easeCubic:HH,easeCubicIn:B9t,easeCubicInOut:HH,easeCubicOut:N9t,easeElastic:YH,easeElasticIn:i$t,easeElasticInOut:a$t,easeElasticOut:YH,easeExp:WH,easeExpIn:H9t,easeExpInOut:WH,easeExpOut:V9t,easeLinear:P9t,easePoly:VH,easePolyIn:k9t,easePolyInOut:VH,easePolyOut:z9t,easeQuad:$H,easeQuadIn:D9t,easeQuadInOut:$H,easeQuadOut:F9t,easeSin:GH,easeSinIn:U9t,easeSinInOut:GH,easeSinOut:$9t},Symbol.toStringTag,{value:"Module"}));var Xtt={};function s$t(e){return Xtt[e.toLowerCase()]||o$t[e]}function jtt(e,t){Xtt[e.toLowerCase()]=t}var l$t=function(e){return["fill","stroke","fillStyle","strokeStyle"].includes(e)},u$t=function(e){return/^[r,R,L,l]{1}[\s]*\(/.test(e)},ZH=[1,0,0,0,1,0,0,0,1];function c$t(e,t,r){var n={},i=t.fromAttrs,a=t.toAttrs;if(!e.destroyed){var o;for(var s in a)if(!zi(i[s],a[s]))if(s==="path"){var l=a[s],u=i[s];l.length>u.length?(l=K1(a[s]),u=K1(i[s]),u=Ttt(u,l),u=nF(u,l),t.fromAttrs.path=u,t.toAttrs.path=l):t.pathFormatted||(l=K1(a[s]),u=K1(i[s]),u=nF(u,l),t.fromAttrs.path=u,t.toAttrs.path=l,t.pathFormatted=!0),n[s]=[];for(var c=0;c<l.length;c++){for(var f=l[c],d=u[c],v=[],g=0;g<f.length;g++)Gn(f[g])&&d&&Gn(d[g])?(o=jM(d[g],f[g]),v.push(o(r))):v.push(f[g]);n[s].push(v)}}else if(s==="matrix"){var x=A9t(i[s]||ZH,a[s]||ZH),w=x(r);n[s]=w}else l$t(s)&&u$t(a[s])?n[s]=a[s]:$r(a[s])||(o=jM(i[s],a[s]),n[s]=o(r));e.attr(n)}}function h$t(e,t,r){var n=t.startTime,i=t.delay;if(r<n+i||t._paused)return!1;var a,o=t.duration,s=t.easing,l=s$t(s);if(r=r-n-t.delay,t.repeat)a=r%o/o,a=l(a);else if(a=r/o,a<1)a=l(a);else return t.onFrame?e.attr(t.onFrame(1)):e.attr(t.toAttrs),!0;if(t.onFrame){var u=t.onFrame(a);e.attr(u)}else c$t(e,t,a);return!1}var f$t=function(){function e(t){this.animators=[],this.current=0,this.timer=null,this.canvas=t}return e.prototype.initTimer=function(){var t=this,r=!1,n,i,a;this.timer=ztt(function(o){if(t.current=o,t.animators.length>0){for(var s=t.animators.length-1;s>=0;s--){if(n=t.animators[s],n.destroyed){t.removeAnimator(s);continue}if(!n.isAnimatePaused()){i=n.get("animations");for(var l=i.length-1;l>=0;l--)a=i[l],r=h$t(n,a,o),r&&(i.splice(l,1),r=!1,a.callback&&a.callback())}i.length===0&&t.removeAnimator(s)}var u=t.canvas.get("autoDraw");u||t.canvas.draw()}})},e.prototype.addAnimator=function(t){this.animators.push(t)},e.prototype.removeAnimator=function(t){this.animators.splice(t,1)},e.prototype.isAnimating=function(){return!!this.animators.length},e.prototype.stop=function(){this.timer&&this.timer.stop()},e.prototype.stopAllAnimations=function(t){t===void 0&&(t=!0),this.animators.forEach(function(r){r.stopAnimate(t)}),this.animators=[],this.canvas.draw()},e.prototype.getTime=function(){return this.current},e}(),d$t=40,qH=0,KH=["mousedown","mouseup","dblclick","mouseout","mouseover","mousemove","mouseleave","mouseenter","touchstart","touchmove","touchend","dragenter","dragover","dragleave","drop","contextmenu","mousewheel"];function QH(e,t,r){r.name=t,r.target=e,r.currentTarget=e,r.delegateTarget=e,e.emit(t,r)}function p$t(e,t,r){if(r.bubbles){var n=void 0,i=!1;if(t==="mouseenter"?(n=r.fromShape,i=!0):t==="mouseleave"&&(i=!0,n=r.toShape),e.isCanvas()&&i)return;if(n&&Rtt(e,n)){r.bubbles=!1;return}r.name=t,r.currentTarget=e,r.delegateTarget=e,e.emit(t,r)}}var v$t=function(){function e(t){var r=this;this.draggingShape=null,this.dragging=!1,this.currentShape=null,this.mousedownShape=null,this.mousedownPoint=null,this._eventCallback=function(n){var i=n.type;r._triggerEvent(i,n)},this._onDocumentMove=function(n){var i=r.canvas,a=i.get("el");if(a!==n.target&&(r.dragging||r.currentShape)){var o=r._getPointInfo(n);r.dragging&&r._emitEvent("drag",n,o,r.draggingShape)}},this._onDocumentMouseUp=function(n){var i=r.canvas,a=i.get("el");if(a!==n.target&&r.dragging){var o=r._getPointInfo(n);r.draggingShape&&r._emitEvent("drop",n,o,null),r._emitEvent("dragend",n,o,r.draggingShape),r._afterDrag(r.draggingShape,o,n)}},this.canvas=t.canvas}return e.prototype.init=function(){this._bindEvents()},e.prototype._bindEvents=function(){var t=this,r=this.canvas.get("el");ft(KH,function(n){r.addEventListener(n,t._eventCallback)}),document&&(document.addEventListener("mousemove",this._onDocumentMove),document.addEventListener("mouseup",this._onDocumentMouseUp))},e.prototype._clearEvents=function(){var t=this,r=this.canvas.get("el");ft(KH,function(n){r.removeEventListener(n,t._eventCallback)}),document&&(document.removeEventListener("mousemove",this._onDocumentMove),document.removeEventListener("mouseup",this._onDocumentMouseUp))},e.prototype._getEventObj=function(t,r,n,i,a,o){var s=new IS(t,r);return s.fromShape=a,s.toShape=o,s.x=n.x,s.y=n.y,s.clientX=n.clientX,s.clientY=n.clientY,s.propagationPath.push(i),s},e.prototype._getShape=function(t,r){return this.canvas.getShape(t.x,t.y,r)},e.prototype._getPointInfo=function(t){var r=this.canvas,n=r.getClientByEvent(t),i=r.getPointByEvent(t);return{x:i.x,y:i.y,clientX:n.x,clientY:n.y}},e.prototype._triggerEvent=function(t,r){var n=this._getPointInfo(r),i=this._getShape(n,r),a=this["_on"+t],o=!1;if(a)a.call(this,n,i,r);else{var s=this.currentShape;t==="mouseenter"||t==="dragenter"||t==="mouseover"?(this._emitEvent(t,r,n,null,null,i),i&&this._emitEvent(t,r,n,i,null,i),t==="mouseenter"&&this.draggingShape&&this._emitEvent("dragenter",r,n,null)):t==="mouseleave"||t==="dragleave"||t==="mouseout"?(o=!0,s&&this._emitEvent(t,r,n,s,s,null),this._emitEvent(t,r,n,null,s,null),t==="mouseleave"&&this.draggingShape&&this._emitEvent("dragleave",r,n,null)):this._emitEvent(t,r,n,i,null,null)}if(o||(this.currentShape=i),i&&!i.get("destroyed")){var l=this.canvas,u=l.get("el");u.style.cursor=i.attr("cursor")||l.get("cursor")}},e.prototype._onmousedown=function(t,r,n){n.button===qH&&(this.mousedownShape=r,this.mousedownPoint=t,this.mousedownTimeStamp=n.timeStamp),this._emitEvent("mousedown",n,t,r,null,null)},e.prototype._emitMouseoverEvents=function(t,r,n,i){var a=this.canvas.get("el");n!==i&&(n&&(this._emitEvent("mouseout",t,r,n,n,i),this._emitEvent("mouseleave",t,r,n,n,i),(!i||i.get("destroyed"))&&(a.style.cursor=this.canvas.get("cursor"))),i&&(this._emitEvent("mouseover",t,r,i,n,i),this._emitEvent("mouseenter",t,r,i,n,i)))},e.prototype._emitDragoverEvents=function(t,r,n,i,a){i?(i!==n&&(n&&this._emitEvent("dragleave",t,r,n,n,i),this._emitEvent("dragenter",t,r,i,n,i)),a||this._emitEvent("dragover",t,r,i)):n&&this._emitEvent("dragleave",t,r,n,n,i),a&&this._emitEvent("dragover",t,r,i)},e.prototype._afterDrag=function(t,r,n){t&&(t.set("capture",!0),this.draggingShape=null),this.dragging=!1;var i=this._getShape(r,n);i!==t&&this._emitMouseoverEvents(n,r,t,i),this.currentShape=i},e.prototype._onmouseup=function(t,r,n){if(n.button===qH){var i=this.draggingShape;this.dragging?(i&&this._emitEvent("drop",n,t,r),this._emitEvent("dragend",n,t,i),this._afterDrag(i,t,n)):(this._emitEvent("mouseup",n,t,r),r===this.mousedownShape&&this._emitEvent("click",n,t,r),this.mousedownShape=null,this.mousedownPoint=null)}},e.prototype._ondragover=function(t,r,n){n.preventDefault();var i=this.currentShape;this._emitDragoverEvents(n,t,i,r,!0)},e.prototype._onmousemove=function(t,r,n){var i=this.canvas,a=this.currentShape,o=this.draggingShape;if(this.dragging)o&&this._emitDragoverEvents(n,t,a,r,!1),this._emitEvent("drag",n,t,o);else{var s=this.mousedownPoint;if(s){var l=this.mousedownShape,u=n.timeStamp,c=u-this.mousedownTimeStamp,f=s.clientX-t.clientX,d=s.clientY-t.clientY,v=f*f+d*d;c>120||v>d$t?l&&l.get("draggable")?(o=this.mousedownShape,o.set("capture",!1),this.draggingShape=o,this.dragging=!0,this._emitEvent("dragstart",n,t,o),this.mousedownShape=null,this.mousedownPoint=null):!l&&i.get("draggable")?(this.dragging=!0,this._emitEvent("dragstart",n,t,null),this.mousedownShape=null,this.mousedownPoint=null):(this._emitMouseoverEvents(n,t,a,r),this._emitEvent("mousemove",n,t,r)):(this._emitMouseoverEvents(n,t,a,r),this._emitEvent("mousemove",n,t,r))}else this._emitMouseoverEvents(n,t,a,r),this._emitEvent("mousemove",n,t,r)}},e.prototype._emitEvent=function(t,r,n,i,a,o){var s=this._getEventObj(t,r,n,i,a,o);if(i){s.shape=i,QH(i,t,s);for(var l=i.getParent();l;)l.emitDelegation(t,s),s.propagationStopped||p$t(l,t,s),s.propagationPath.push(l),l=l.getParent()}else{var u=this.canvas;QH(u,t,s)}},e.prototype.destroy=function(){this._clearEvents(),this.canvas=null,this.currentShape=null,this.draggingShape=null,this.mousedownPoint=null,this.mousedownShape=null,this.mousedownTimeStamp=null},e}(),JH="px",tV=Itt(),g$t=tV&&tV.name==="firefox",MI=function(e){Ut(t,e);function t(r){var n=e.call(this,r)||this;return n.initContainer(),n.initDom(),n.initEvents(),n.initTimeline(),n}return t.prototype.getDefaultCfg=function(){var r=e.prototype.getDefaultCfg.call(this);return r.cursor="default",r.supportCSSTransform=!1,r},t.prototype.initContainer=function(){var r=this.get("container");nn(r)&&(r=document.getElementById(r),this.set("container",r))},t.prototype.initDom=function(){var r=this.createDom();this.set("el",r);var n=this.get("container");n.appendChild(r),this.setDOMSize(this.get("width"),this.get("height"))},t.prototype.initEvents=function(){var r=new v$t({canvas:this});r.init(),this.set("eventController",r)},t.prototype.initTimeline=function(){var r=new f$t(this);this.set("timeline",r)},t.prototype.setDOMSize=function(r,n){var i=this.get("el");OH&&(i.style.width=r+JH,i.style.height=n+JH)},t.prototype.changeSize=function(r,n){this.setDOMSize(r,n),this.set("width",r),this.set("height",n),this.onCanvasChange("changeSize")},t.prototype.getRenderer=function(){return this.get("renderer")},t.prototype.getCursor=function(){return this.get("cursor")},t.prototype.setCursor=function(r){this.set("cursor",r);var n=this.get("el");OH&&n&&(n.style.cursor=r)},t.prototype.getPointByEvent=function(r){var n=this.get("supportCSSTransform");if(n){if(g$t&&!ke(r.layerX)&&r.layerX!==r.offsetX)return{x:r.layerX,y:r.layerY};if(!ke(r.offsetX))return{x:r.offsetX,y:r.offsetY}}var i=this.getClientByEvent(r),a=i.x,o=i.y;return this.getPointByClient(a,o)},t.prototype.getClientByEvent=function(r){var n=r;return r.touches&&(r.type==="touchend"?n=r.changedTouches[0]:n=r.touches[0]),{x:n.clientX,y:n.clientY}},t.prototype.getPointByClient=function(r,n){var i=this.get("el"),a=i.getBoundingClientRect();return{x:r-a.left,y:n-a.top}},t.prototype.getClientByPoint=function(r,n){var i=this.get("el"),a=i.getBoundingClientRect();return{x:r+a.left,y:n+a.top}},t.prototype.draw=function(){},t.prototype.removeDom=function(){var r=this.get("el");r.parentNode.removeChild(r)},t.prototype.clearEvents=function(){var r=this.get("eventController");r.destroy()},t.prototype.isCanvas=function(){return!0},t.prototype.getParent=function(){return null},t.prototype.destroy=function(){var r=this.get("timeline");this.get("destroyed")||(this.clear(),r&&r.stop(),this.clearEvents(),this.removeDom(),e.prototype.destroy.call(this))},t}(Ftt),RI=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.isGroup=function(){return!0},t.prototype.isEntityGroup=function(){return!1},t.prototype.clone=function(){for(var r=e.prototype.clone.call(this),n=this.getChildren(),i=0;i<n.length;i++){var a=n[i];r.add(a.clone())}return r},t}(Ftt),II=function(e){Ut(t,e);function t(r){return e.call(this,r)||this}return t.prototype._isInBBox=function(r,n){var i=this.getBBox();return i.minX<=r&&i.maxX>=r&&i.minY<=n&&i.maxY>=n},t.prototype.afterAttrsChange=function(r){e.prototype.afterAttrsChange.call(this,r),this.clearCacheBBox()},t.prototype.getBBox=function(){var r=this.cfg.bbox;return r||(r=this.calculateBBox(),this.set("bbox",r)),r},t.prototype.getCanvasBBox=function(){var r=this.cfg.canvasBBox;return r||(r=this.calculateCanvasBBox(),this.set("canvasBBox",r)),r},t.prototype.applyMatrix=function(r){e.prototype.applyMatrix.call(this,r),this.set("canvasBBox",null)},t.prototype.calculateCanvasBBox=function(){var r=this.getBBox(),n=this.getTotalMatrix(),i=r.minX,a=r.minY,o=r.maxX,s=r.maxY;if(n){var l=Zv(n,[r.minX,r.minY]),u=Zv(n,[r.maxX,r.minY]),c=Zv(n,[r.minX,r.maxY]),f=Zv(n,[r.maxX,r.maxY]);i=Math.min(l[0],u[0],c[0],f[0]),o=Math.max(l[0],u[0],c[0],f[0]),a=Math.min(l[1],u[1],c[1],f[1]),s=Math.max(l[1],u[1],c[1],f[1])}var d=this.attrs;if(d.shadowColor){var v=d.shadowBlur,g=v===void 0?0:v,x=d.shadowOffsetX,w=x===void 0?0:x,S=d.shadowOffsetY,A=S===void 0?0:S,M=i-g+w,R=o+g+w,O=a-g+A,N=s+g+A;i=Math.min(i,M),o=Math.max(o,R),a=Math.min(a,O),s=Math.max(s,N)}return{x:i,y:a,minX:i,minY:a,maxX:o,maxY:s,width:o-i,height:s-a}},t.prototype.clearCacheBBox=function(){this.set("bbox",null),this.set("canvasBBox",null)},t.prototype.isClipShape=function(){return this.get("isClipShape")},t.prototype.isInShape=function(r,n){return!1},t.prototype.isOnlyHitBox=function(){return!1},t.prototype.isHit=function(r,n){var i=this.get("startArrowShape"),a=this.get("endArrowShape"),o=[r,n,1];o=this.invertFromMatrix(o);var s=o[0],l=o[1],u=this._isInBBox(s,l);return this.isOnlyHitBox()?u:!!(u&&!this.isClipped(s,l)&&(this.isInShape(s,l)||i&&i.isHit(s,l)||a&&a.isHit(s,l)))},t}(Ott),Ytt=new Map;function Jf(e,t){Ytt.set(e,t)}function LI(e){return Ytt.get(e)}function Ztt(e){var t=e.attr(),r=t.x,n=t.y,i=t.width,a=t.height;return{x:r,y:n,width:i,height:a}}function qtt(e){var t=e.attr(),r=t.x,n=t.y,i=t.r;return{x:r-i,y:n-i,width:i*2,height:i*2}}function Bu(e,t,r,n){var i=e-r,a=t-n;return Math.sqrt(i*i+a*a)}function BA(e,t){return Math.abs(e-t)<.001}function Cb(e,t){var r=Vf(e),n=Vf(t),i=kh(e),a=kh(t);return{x:r,y:n,width:i-r,height:a-n}}function OI(e){return(e+Math.PI*2)%(Math.PI*2)}const Hl={box:function(e,t,r,n){return Cb([e,r],[t,n])},length:function(e,t,r,n){return Bu(e,t,r,n)},pointAt:function(e,t,r,n,i){return{x:(1-i)*e+i*r,y:(1-i)*t+i*n}},pointDistance:function(e,t,r,n,i,a){var o=(r-e)*(i-e)+(n-t)*(a-t);if(o<0)return Bu(e,t,i,a);var s=(r-e)*(r-e)+(n-t)*(n-t);return o>s?Bu(r,n,i,a):this.pointToLine(e,t,r,n,i,a)},pointToLine:function(e,t,r,n,i,a){var o=[r-e,n-t];if(sIt(o,[0,0]))return Math.sqrt((i-e)*(i-e)+(a-t)*(a-t));var s=[-o[1],o[0]];Dx(s,s);var l=[i-e,a-t];return Math.abs(vM(l,s))},tangentAngle:function(e,t,r,n){return Math.atan2(n-t,r-e)}};var m$t=1e-4;function Ktt(e,t,r,n,i,a){var o,s=1/0,l=[r,n],u=20;a&&a>200&&(u=a/10);for(var c=1/u,f=c/10,d=0;d<=u;d++){var v=d*c,g=[i.apply(null,e.concat([v])),i.apply(null,t.concat([v]))],x=Bu(l[0],l[1],g[0],g[1]);x<s&&(o=v,s=x)}if(o===0)return{x:e[0],y:t[0]};if(o===1){var w=e.length;return{x:e[w-1],y:t[w-1]}}s=1/0;for(var d=0;d<32&&!(f<m$t);d++){var S=o-f,A=o+f,g=[i.apply(null,e.concat([S])),i.apply(null,t.concat([S]))],x=Bu(l[0],l[1],g[0],g[1]);if(S>=0&&x<s)o=S,s=x;else{var M=[i.apply(null,e.concat([A])),i.apply(null,t.concat([A]))],R=Bu(l[0],l[1],M[0],M[1]);A<=1&&R<s?(o=A,s=R):f*=.5}}return{x:i.apply(null,e.concat([o])),y:i.apply(null,t.concat([o]))}}function y$t(e,t){for(var r=0,n=e.length,i=0;i<n;i++){var a=e[i],o=t[i],s=e[(i+1)%n],l=t[(i+1)%n];r+=Bu(a,o,s,l)}return r/2}function vm(e,t,r,n){var i=1-n;return i*i*e+2*n*i*t+n*n*r}function eV(e,t,r){var n=e+r-2*t;if(BA(n,0))return[.5];var i=(e-t)/n;return i<=1&&i>=0?[i]:[]}function rV(e,t,r,n){return 2*(1-n)*(t-e)+2*n*(r-t)}function Qtt(e,t,r,n,i,a,o){var s=vm(e,r,i,o),l=vm(t,n,a,o),u=Hl.pointAt(e,t,r,n,o),c=Hl.pointAt(r,n,i,a,o);return[[e,t,u.x,u.y,s,l],[s,l,c.x,c.y,i,a]]}function cF(e,t,r,n,i,a,o){if(o===0)return(Bu(e,t,r,n)+Bu(r,n,i,a)+Bu(e,t,i,a))/2;var s=Qtt(e,t,r,n,i,a,.5),l=s[0],u=s[1];return l.push(o-1),u.push(o-1),cF.apply(null,l)+cF.apply(null,u)}const Jtt={box:function(e,t,r,n,i,a){var o=eV(e,r,i)[0],s=eV(t,n,a)[0],l=[e,i],u=[t,a];return o!==void 0&&l.push(vm(e,r,i,o)),s!==void 0&&u.push(vm(t,n,a,s)),Cb(l,u)},length:function(e,t,r,n,i,a){return cF(e,t,r,n,i,a,3)},nearestPoint:function(e,t,r,n,i,a,o,s){return Ktt([e,r,i],[t,n,a],o,s,vm)},pointDistance:function(e,t,r,n,i,a,o,s){var l=this.nearestPoint(e,t,r,n,i,a,o,s);return Bu(l.x,l.y,o,s)},interpolationAt:vm,pointAt:function(e,t,r,n,i,a,o){return{x:vm(e,r,i,o),y:vm(t,n,a,o)}},divide:function(e,t,r,n,i,a,o){return Qtt(e,t,r,n,i,a,o)},tangentAngle:function(e,t,r,n,i,a,o){var s=rV(e,r,i,o),l=rV(t,n,a,o),u=Math.atan2(l,s);return OI(u)}};function gm(e,t,r,n,i){var a=1-i;return a*a*a*e+3*t*i*a*a+3*r*i*i*a+n*i*i*i}function nV(e,t,r,n,i){var a=1-i;return 3*(a*a*(t-e)+2*a*i*(r-t)+i*i*(n-r))}function NO(e,t,r,n){var i=-3*e+9*t-9*r+3*n,a=6*e-12*t+6*r,o=3*t-3*e,s=[],l,u,c;if(BA(i,0))BA(a,0)||(l=-o/a,l>=0&&l<=1&&s.push(l));else{var f=a*a-4*i*o;BA(f,0)?s.push(-a/(2*i)):f>0&&(c=Math.sqrt(f),l=(-a+c)/(2*i),u=(-a-c)/(2*i),l>=0&&l<=1&&s.push(l),u>=0&&u<=1&&s.push(u))}return s}function tet(e,t,r,n,i,a,o,s,l){var u=gm(e,r,i,o,l),c=gm(t,n,a,s,l),f=Hl.pointAt(e,t,r,n,l),d=Hl.pointAt(r,n,i,a,l),v=Hl.pointAt(i,a,o,s,l),g=Hl.pointAt(f.x,f.y,d.x,d.y,l),x=Hl.pointAt(d.x,d.y,v.x,v.y,l);return[[e,t,f.x,f.y,g.x,g.y,u,c],[u,c,x.x,x.y,v.x,v.y,o,s]]}function hF(e,t,r,n,i,a,o,s,l){if(l===0)return y$t([e,r,i,o],[t,n,a,s]);var u=tet(e,t,r,n,i,a,o,s,.5),c=u[0],f=u[1];return c.push(l-1),f.push(l-1),hF.apply(null,c)+hF.apply(null,f)}const Bw={extrema:NO,box:function(e,t,r,n,i,a,o,s){for(var l=[e,o],u=[t,s],c=NO(e,r,i,o),f=NO(t,n,a,s),d=0;d<c.length;d++)l.push(gm(e,r,i,o,c[d]));for(var d=0;d<f.length;d++)u.push(gm(t,n,a,s,f[d]));return Cb(l,u)},length:function(e,t,r,n,i,a,o,s){return hF(e,t,r,n,i,a,o,s,3)},nearestPoint:function(e,t,r,n,i,a,o,s,l,u,c){return Ktt([e,r,i,o],[t,n,a,s],l,u,gm,c)},pointDistance:function(e,t,r,n,i,a,o,s,l,u,c){var f=this.nearestPoint(e,t,r,n,i,a,o,s,l,u,c);return Bu(f.x,f.y,l,u)},interpolationAt:gm,pointAt:function(e,t,r,n,i,a,o,s,l){return{x:gm(e,r,i,o,l),y:gm(t,n,a,s,l)}},divide:function(e,t,r,n,i,a,o,s,l){return tet(e,t,r,n,i,a,o,s,l)},tangentAngle:function(e,t,r,n,i,a,o,s,l){var u=nV(e,r,i,o,l),c=nV(t,n,a,s,l);return OI(Math.atan2(c,u))}};function iV(e,t){var r=Math.abs(e);return t>0?r:r*-1}const _$t={box:function(e,t,r,n){return{x:e-r,y:t-n,width:r*2,height:n*2}},length:function(e,t,r,n){return Math.PI*(3*(r+n)-Math.sqrt((3*r+n)*(r+3*n)))},nearestPoint:function(e,t,r,n,i,a){var o=r,s=n;if(o===0||s===0)return{x:e,y:t};for(var l=i-e,u=a-t,c=Math.abs(l),f=Math.abs(u),d=o*o,v=s*s,g=Math.PI/4,x,w,S=0;S<4;S++){x=o*Math.cos(g),w=s*Math.sin(g);var A=(d-v)*Math.pow(Math.cos(g),3)/o,M=(v-d)*Math.pow(Math.sin(g),3)/s,R=x-A,O=w-M,N=c-A,k=f-M,V=Math.hypot(O,R),Q=Math.hypot(k,N),Y=V*Math.asin((R*k-O*N)/(V*Q)),X=Y/Math.sqrt(d+v-x*x-w*w);g+=X,g=Math.min(Math.PI/2,Math.max(0,g))}return{x:e+iV(x,l),y:t+iV(w,u)}},pointDistance:function(e,t,r,n,i,a){var o=this.nearestPoint(e,t,r,n,i,a);return Bu(o.x,o.y,i,a)},pointAt:function(e,t,r,n,i){var a=2*Math.PI*i;return{x:e+r*Math.cos(a),y:t+n*Math.sin(a)}},tangentAngle:function(e,t,r,n,i){var a=2*Math.PI*i,o=Math.atan2(n*Math.cos(a),-r*Math.sin(a));return OI(o)}};function x$t(e,t,r,n,i,a,o,s){return-1*r*Math.cos(i)*Math.sin(s)-n*Math.sin(i)*Math.cos(s)}function b$t(e,t,r,n,i,a,o,s){return-1*r*Math.sin(i)*Math.sin(s)+n*Math.cos(i)*Math.cos(s)}function E$t(e,t,r){return Math.atan(-t/e*Math.tan(r))}function w$t(e,t,r){return Math.atan(t/(e*Math.tan(r)))}function aV(e,t,r,n,i,a){return r*Math.cos(i)*Math.cos(a)-n*Math.sin(i)*Math.sin(a)+e}function oV(e,t,r,n,i,a){return r*Math.sin(i)*Math.cos(a)+n*Math.cos(i)*Math.sin(a)+t}function C$t(e,t,r,n){var i=Math.atan2(n*e,r*t);return(i+Math.PI*2)%(Math.PI*2)}function sV(e,t,r){return{x:e*Math.cos(r),y:t*Math.sin(r)}}function lV(e,t,r){var n=Math.cos(r),i=Math.sin(r);return[e*n-t*i,e*i+t*n]}const S$t={box:function(e,t,r,n,i,a,o){for(var s=E$t(r,n,i),l=1/0,u=-1/0,c=[a,o],f=-Math.PI*2;f<=Math.PI*2;f+=Math.PI){var d=s+f;a<o?a<d&&d<o&&c.push(d):o<d&&d<a&&c.push(d)}for(var f=0;f<c.length;f++){var v=aV(e,t,r,n,i,c[f]);v<l&&(l=v),v>u&&(u=v)}for(var g=w$t(r,n,i),x=1/0,w=-1/0,S=[a,o],f=-Math.PI*2;f<=Math.PI*2;f+=Math.PI){var A=g+f;a<o?a<A&&A<o&&S.push(A):o<A&&A<a&&S.push(A)}for(var f=0;f<S.length;f++){var M=oV(e,t,r,n,i,S[f]);M<x&&(x=M),M>w&&(w=M)}return{x:l,y:x,width:u-l,height:w-x}},length:function(e,t,r,n,i,a,o){},nearestPoint:function(e,t,r,n,i,a,o,s,l){var u=lV(s-e,l-t,-i),c=u[0],f=u[1],d=_$t.nearestPoint(0,0,r,n,c,f),v=C$t(r,n,d.x,d.y);v<a?d=sV(r,n,a):v>o&&(d=sV(r,n,o));var g=lV(d.x,d.y,i);return{x:g[0]+e,y:g[1]+t}},pointDistance:function(e,t,r,n,i,a,o,s,l){var u=this.nearestPoint(e,t,r,n,s,l);return Bu(u.x,u.y,s,l)},pointAt:function(e,t,r,n,i,a,o,s){var l=(o-a)*s+a;return{x:aV(e,t,r,n,i,l),y:oV(e,t,r,n,i,l)}},tangentAngle:function(e,t,r,n,i,a,o,s){var l=(o-a)*s+a,u=x$t(e,t,r,n,i,a,o,l),c=b$t(e,t,r,n,i,a,o,l);return OI(Math.atan2(c,u))}};function eet(e){for(var t=0,r=[],n=0;n<e.length-1;n++){var i=e[n],a=e[n+1],o=Bu(i[0],i[1],a[0],a[1]),s={from:i,to:a,length:o};r.push(s),t+=o}return{segments:r,totalLength:t}}function T$t(e){if(e.length<2)return 0;for(var t=0,r=0;r<e.length-1;r++){var n=e[r],i=e[r+1];t+=Bu(n[0],n[1],i[0],i[1])}return t}function A$t(e,t){if(t>1||t<0||e.length<2)return null;var r=eet(e),n=r.segments,i=r.totalLength;if(i===0)return{x:e[0][0],y:e[0][1]};for(var a=0,o=null,s=0;s<n.length;s++){var l=n[s],u=l.from,c=l.to,f=l.length/i;if(t>=a&&t<=a+f){var d=(t-a)/f;o=Hl.pointAt(u[0],u[1],c[0],c[1],d);break}a+=f}return o}function M$t(e,t){if(t>1||t<0||e.length<2)return 0;for(var r=eet(e),n=r.segments,i=r.totalLength,a=0,o=0,s=0;s<n.length;s++){var l=n[s],u=l.from,c=l.to,f=l.length/i;if(t>=a&&t<=a+f){o=Math.atan2(c[1]-u[1],c[0]-u[0]);break}a+=f}return o}function R$t(e,t,r){for(var n=1/0,i=0;i<e.length-1;i++){var a=e[i],o=e[i+1],s=Hl.pointDistance(a[0],a[1],o[0],o[1],t,r);s<n&&(n=s)}return n}const ret={box:function(e){for(var t=[],r=[],n=0;n<e.length;n++){var i=e[n];t.push(i[0]),r.push(i[1])}return Cb(t,r)},length:function(e){return T$t(e)},pointAt:function(e,t){return A$t(e,t)},pointDistance:function(e,t,r){return R$t(e,t,r)},tangentAngle:function(e,t){return M$t(e,t)}};function uV(e,t){return!e||!t?e||t:{minX:Math.min(e.minX,t.minX),minY:Math.min(e.minY,t.minY),maxX:Math.max(e.maxX,t.maxX),maxY:Math.max(e.maxY,t.maxY)}}function G4(e,t){var r=e.get("startArrowShape"),n=e.get("endArrowShape"),i=null,a=null;return r&&(i=r.getCanvasBBox(),t=uV(t,i)),n&&(a=n.getCanvasBBox(),t=uV(t,a)),t}function I$t(e){for(var t=e.attr(),r=t.points,n=[],i=[],a=0;a<r.length;a++){var o=r[a];n.push(o[0]),i.push(o[1])}var s=Cb(n,i),l=s.x,u=s.y,c=s.width,f=s.height,d={minX:l,minY:u,maxX:l+c,maxY:u+f};return d=G4(e,d),{x:d.minX,y:d.minY,width:d.maxX-d.minX,height:d.maxY-d.minY}}function L$t(e){for(var t=e.attr(),r=t.points,n=[],i=[],a=0;a<r.length;a++){var o=r[a];n.push(o[0]),i.push(o[1])}return Cb(n,i)}var kO=null;function PI(){if(!kO){var e=document.createElement("canvas");e.width=1,e.height=1,kO=e.getContext("2d")}return kO}function DI(e,t,r){var n=1;if(nn(e)&&(n=e.split(`
`).length),n>1){var i=O$t(t,r);return t*n+i*(n-1)}return t}function O$t(e,t){return t?t-e:e*.14}function P$t(e,t){var r=PI(),n=0;if(ke(e)||e==="")return n;if(r.save(),r.font=t,nn(e)&&e.includes(`
`)){var i=e.split(`
`);ft(i,function(a){var o=r.measureText(a).width;n<o&&(n=o)})}else n=r.measureText(e).width;return r.restore(),n}function FI(e){var t=e.fontSize,r=e.fontFamily,n=e.fontWeight,i=e.fontStyle,a=e.fontVariant;return[i,a,n,t+"px",r].join(" ").trim()}function D$t(e){var t=e.attr(),r=t.x,n=t.y,i=t.text,a=t.fontSize,o=t.lineHeight,s=t.font;s||(s=FI(t));var l=P$t(i,s),u;if(!l)u={x:r,y:n,width:0,height:0};else{var c=t.textAlign,f=t.textBaseline,d=DI(i,a,o),v={x:r,y:n-d};c&&(c==="end"||c==="right"?v.x-=l:c==="center"&&(v.x-=l/2)),f&&(f==="top"?v.y+=d:f==="middle"&&(v.y+=d/2)),u={x:v.x,y:v.y,width:l,height:d}}return u}var F$t=/[MLHVQTCSAZ]([^MLHVQTCSAZ]*)/ig,B$t=/[^\s\,]+/ig;function N$t(e){var t=e||[];if(ze(t))return t;if(nn(t))return t=t.match(F$t),ft(t,function(r,n){if(r=r.match(B$t),r[0].length>1){var i=r[0].charAt(0);r.splice(1,0,r[0].substr(1)),r[0]=i}ft(r,function(a,o){isNaN(a)||(r[o]=+a)}),t[n]=r}),t}function TT(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function fF(e,t){return TT(e)*TT(t)?(e[0]*t[0]+e[1]*t[1])/(TT(e)*TT(t)):1}function cV(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(fF(e,t))}function dF(e,t){return e[0]===t[0]&&e[1]===t[1]}function k$t(e,t){var r=t[1],n=t[2],i=bI(EI(t[3]),Math.PI*2),a=t[4],o=t[5],s=e[0],l=e[1],u=t[6],c=t[7],f=Math.cos(i)*(s-u)/2+Math.sin(i)*(l-c)/2,d=-1*Math.sin(i)*(s-u)/2+Math.cos(i)*(l-c)/2,v=f*f/(r*r)+d*d/(n*n);v>1&&(r*=Math.sqrt(v),n*=Math.sqrt(v));var g=r*r*(d*d)+n*n*(f*f),x=g?Math.sqrt((r*r*(n*n)-g)/g):1;a===o&&(x*=-1),isNaN(x)&&(x=0);var w=n?x*r*d/n:0,S=r?x*-n*f/r:0,A=(s+u)/2+Math.cos(i)*w-Math.sin(i)*S,M=(l+c)/2+Math.sin(i)*w+Math.cos(i)*S,R=[(f-w)/r,(d-S)/n],O=[(-1*f-w)/r,(-1*d-S)/n],N=cV([1,0],R),k=cV(R,O);return fF(R,O)<=-1&&(k=Math.PI),fF(R,O)>=1&&(k=0),o===0&&k>0&&(k=k-2*Math.PI),o===1&&k<0&&(k=k+2*Math.PI),{cx:A,cy:M,rx:dF(e,[u,c])?0:r,ry:dF(e,[u,c])?0:n,startAngle:N,endAngle:N+k,xRotation:i,arcFlag:a,sweepFlag:o}}function hV(e,t){return[t[0]+(t[0]-e[0]),t[1]+(t[1]-e[1])]}function z$t(e){e=N$t(e);for(var t=[],r=null,n=null,i=null,a=0,o=e.length,s=0;s<o;s++){var l=e[s];n=e[s+1];var u=l[0],c={command:u,prePoint:r,params:l,startTangent:null,endTangent:null};switch(u){case"M":i=[l[1],l[2]],a=s;break;case"A":var f=k$t(r,l);c.arcParams=f;break}if(u==="Z")r=i,n=e[a+1];else{var d=l.length;r=[l[d-2],l[d-1]]}n&&n[0]==="Z"&&(n=e[a],t[a]&&(t[a].prePoint=r)),c.currentPoint=r,t[a]&&dF(r,t[a].currentPoint)&&(t[a].prePoint=c.prePoint);var v=n?[n[n.length-2],n[n.length-1]]:null;c.nextPoint=v;var g=c.prePoint;if(["L","H","V"].includes(u))c.startTangent=[g[0]-r[0],g[1]-r[1]],c.endTangent=[r[0]-g[0],r[1]-g[1]];else if(u==="Q"){var x=[l[1],l[2]];c.startTangent=[g[0]-x[0],g[1]-x[1]],c.endTangent=[r[0]-x[0],r[1]-x[1]]}else if(u==="T"){var w=t[s-1],x=hV(w.currentPoint,g);w.command==="Q"?(c.command="Q",c.startTangent=[g[0]-x[0],g[1]-x[1]],c.endTangent=[r[0]-x[0],r[1]-x[1]]):(c.command="TL",c.startTangent=[g[0]-r[0],g[1]-r[1]],c.endTangent=[r[0]-g[0],r[1]-g[1]])}else if(u==="C"){var S=[l[1],l[2]],A=[l[3],l[4]];c.startTangent=[g[0]-S[0],g[1]-S[1]],c.endTangent=[r[0]-A[0],r[1]-A[1]],c.startTangent[0]===0&&c.startTangent[1]===0&&(c.startTangent=[S[0]-A[0],S[1]-A[1]]),c.endTangent[0]===0&&c.endTangent[1]===0&&(c.endTangent=[A[0]-S[0],A[1]-S[1]])}else if(u==="S"){var w=t[s-1],S=hV(w.currentPoint,g),A=[l[1],l[2]];w.command==="C"?(c.command="C",c.startTangent=[g[0]-S[0],g[1]-S[1]],c.endTangent=[r[0]-A[0],r[1]-A[1]]):(c.command="SQ",c.startTangent=[g[0]-A[0],g[1]-A[1]],c.endTangent=[r[0]-A[0],r[1]-A[1]])}else if(u==="A"){var M=.001,R=c.arcParams||{},O=R.cx,N=O===void 0?0:O,k=R.cy,V=k===void 0?0:k,Q=R.rx,Y=Q===void 0?0:Q,X=R.ry,tt=X===void 0?0:X,it=R.sweepFlag,Et=it===void 0?0:it,Tt=R.startAngle,pt=Tt===void 0?0:Tt,kt=R.endAngle,ae=kt===void 0?0:kt;Et===0&&(M*=-1);var Kt=Y*Math.cos(pt-M)+N,re=tt*Math.sin(pt-M)+V;c.startTangent=[Kt-i[0],re-i[1]];var fe=Y*Math.cos(pt+ae+M)+N,Oe=tt*Math.sin(pt+ae-M)+V;c.endTangent=[g[0]-fe,g[1]-Oe]}t.push(c)}return t}function U$t(e,t){for(var r=[],n=[],i=[],a=0;a<e.length;a++){var o=e[a],s=o.currentPoint,l=o.params,u=o.prePoint,c=void 0;switch(o.command){case"Q":c=Jtt.box(u[0],u[1],l[1],l[2],l[3],l[4]);break;case"C":c=Bw.box(u[0],u[1],l[1],l[2],l[3],l[4],l[5],l[6]);break;case"A":var f=o.arcParams;c=S$t.box(f.cx,f.cy,f.rx,f.ry,f.xRotation,f.startAngle,f.endAngle);break;default:r.push(s[0]),n.push(s[1]);break}c&&(o.box=c,r.push(c.x,c.x+c.width),n.push(c.y,c.y+c.height)),t&&(o.command==="L"||o.command==="M")&&o.prePoint&&o.nextPoint&&i.push(o)}r=r.filter(function(S){return!Number.isNaN(S)&&S!==1/0&&S!==-1/0}),n=n.filter(function(S){return!Number.isNaN(S)&&S!==1/0&&S!==-1/0});var d=Vf(r),v=Vf(n),g=kh(r),x=kh(n);if(i.length===0)return{x:d,y:v,width:g-d,height:x-v};for(var a=0;a<i.length;a++){var o=i[a],s=o.currentPoint,w=void 0;s[0]===d?(w=AT(o,t),d=d-w.xExtra):s[0]===g&&(w=AT(o,t),g=g+w.xExtra),s[1]===v?(w=AT(o,t),v=v-w.yExtra):s[1]===x&&(w=AT(o,t),x=x+w.yExtra)}return{x:d,y:v,width:g-d,height:x-v}}function AT(e,t){var r=e.prePoint,n=e.currentPoint,i=e.nextPoint,a=Math.pow(n[0]-r[0],2)+Math.pow(n[1]-r[1],2),o=Math.pow(n[0]-i[0],2)+Math.pow(n[1]-i[1],2),s=Math.pow(r[0]-i[0],2)+Math.pow(r[1]-i[1],2),l=Math.acos((a+o-s)/(2*Math.sqrt(a)*Math.sqrt(o)));if(!l||Math.sin(l)===0||Ul(l,0))return{xExtra:0,yExtra:0};var u=Math.abs(Math.atan2(i[1]-n[1],i[0]-n[0])),c=Math.abs(Math.atan2(i[0]-n[0],i[1]-n[1]));u=u>Math.PI/2?Math.PI-u:u,c=c>Math.PI/2?Math.PI-c:c;var f={xExtra:Math.cos(l/2-u)*(t/2*(1/Math.sin(l/2)))-t/2||0,yExtra:Math.cos(c-l/2)*(t/2*(1/Math.sin(l/2)))-t/2||0};return f}function $$t(e){var t=e.attr(),r=t.path,n=t.stroke,i=n?t.lineWidth:0,a=e.get("segments")||z$t(r),o=U$t(a,i),s=o.x,l=o.y,u=o.width,c=o.height,f={minX:s,minY:l,maxX:s+u,maxY:l+c};return f=G4(e,f),{x:f.minX,y:f.minY,width:f.maxX-f.minX,height:f.maxY-f.minY}}function H$t(e){var t=e.attr(),r=t.x1,n=t.y1,i=t.x2,a=t.y2,o=Math.min(r,i),s=Math.max(r,i),l=Math.min(n,a),u=Math.max(n,a),c={minX:o,maxX:s,minY:l,maxY:u};return c=G4(e,c),{x:c.minX,y:c.minY,width:c.maxX-c.minX,height:c.maxY-c.minY}}function V$t(e){var t=e.attr(),r=t.x,n=t.y,i=t.rx,a=t.ry;return{x:r-i,y:n-a,width:i*2,height:a*2}}Jf("rect",Ztt);Jf("image",Ztt);Jf("circle",qtt);Jf("marker",qtt);Jf("polyline",I$t);Jf("polygon",L$t);Jf("text",D$t);Jf("path",$$t);Jf("line",H$t);Jf("ellipse",V$t);function G$t(){return window?window.devicePixelRatio:1}function net(e,t,r,n){var i=e-r,a=t-n;return Math.sqrt(i*i+a*a)}function wy(e,t,r,n,i,a){return i>=e&&i<=e+r&&a>=t&&a<=t+n}function CC(e,t){return!(t.minX>e.maxX||t.maxX<e.minX||t.minY>e.maxY||t.maxY<e.minY)}function W$t(e,t){return!e||!t?e||t:{minX:Math.min(e.minX,t.minX),minY:Math.min(e.minY,t.minY),maxX:Math.max(e.maxX,t.maxX),maxY:Math.max(e.maxY,t.maxY)}}function fV(e,t){return e[0]===t[0]&&e[1]===t[1]}var X$t=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,j$t=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,Y$t=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,iet=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;function aet(e,t){var r=e.match(iet);ft(r,function(n){var i=n.split(":");t.addColorStop(i[0],i[1])})}function Z$t(e,t,r){var n=X$t.exec(r),i=parseFloat(n[1])%360*(Math.PI/180),a=n[2],o=t.getBBox(),s,l;i>=0&&i<1/2*Math.PI?(s={x:o.minX,y:o.minY},l={x:o.maxX,y:o.maxY}):1/2*Math.PI<=i&&i<Math.PI?(s={x:o.maxX,y:o.minY},l={x:o.minX,y:o.maxY}):Math.PI<=i&&i<3/2*Math.PI?(s={x:o.maxX,y:o.maxY},l={x:o.minX,y:o.minY}):(s={x:o.minX,y:o.maxY},l={x:o.maxX,y:o.minY});var u=Math.tan(i),c=u*u,f=(l.x-s.x+u*(l.y-s.y))/(c+1)+s.x,d=u*(l.x-s.x+u*(l.y-s.y))/(c+1)+s.y,v=e.createLinearGradient(s.x,s.y,f,d);return aet(a,v),v}function q$t(e,t,r){var n=j$t.exec(r),i=parseFloat(n[1]),a=parseFloat(n[2]),o=parseFloat(n[3]),s=n[4];if(o===0){var l=s.match(iet);return l[l.length-1].split(":")[1]}var u=t.getBBox(),c=u.maxX-u.minX,f=u.maxY-u.minY,d=Math.sqrt(c*c+f*f)/2,v=e.createRadialGradient(u.minX+c*i,u.minY+f*a,0,u.minX+c/2,u.minY+f/2,o*d);return aet(s,v),v}function K$t(e,t,r){if(t.get("patternSource")&&t.get("patternSource")===r)return t.get("pattern");var n,i,a=Y$t.exec(r),o=a[1],s=a[2];function l(){n=e.createPattern(i,o),t.set("pattern",n),t.set("patternSource",r)}switch(o){case"a":o="repeat";break;case"x":o="repeat-x";break;case"y":o="repeat-y";break;case"n":o="no-repeat";break;default:o="no-repeat"}return i=new Image,s.match(/^data:/i)||(i.crossOrigin="Anonymous"),i.src=s,i.complete?l():(i.onload=l,i.src=i.src),n}function Q$t(e,t,r){var n=t.getBBox();if(isNaN(n.x)||isNaN(n.y)||isNaN(n.width)||isNaN(n.height))return r;if(nn(r)){if(r[1]==="("||r[2]==="("){if(r[0]==="l")return Z$t(e,t,r);if(r[0]==="r")return q$t(e,t,r);if(r[0]==="p")return K$t(e,t,r)}return r}if(r instanceof CanvasPattern)return r}function J$t(e){var t=0,r=0,n=0,i=0;return ze(e)?e.length===1?t=r=n=i=e[0]:e.length===2?(t=n=e[0],r=i=e[1]):e.length===3?(t=e[0],r=i=e[1],n=e[2]):(t=e[0],r=e[1],n=e[2],i=e[3]):t=r=n=i=e,[t,r,n,i]}function MT(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function pF(e,t){return MT(e)*MT(t)?(e[0]*t[0]+e[1]*t[1])/(MT(e)*MT(t)):1}function dV(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(pF(e,t))}function YM(e,t){var r=t[1],n=t[2],i=bI(EI(t[3]),Math.PI*2),a=t[4],o=t[5],s=e[0],l=e[1],u=t[6],c=t[7],f=Math.cos(i)*(s-u)/2+Math.sin(i)*(l-c)/2,d=-1*Math.sin(i)*(s-u)/2+Math.cos(i)*(l-c)/2,v=f*f/(r*r)+d*d/(n*n);v>1&&(r*=Math.sqrt(v),n*=Math.sqrt(v));var g=r*r*(d*d)+n*n*(f*f),x=g?Math.sqrt((r*r*(n*n)-g)/g):1;a===o&&(x*=-1),isNaN(x)&&(x=0);var w=n?x*r*d/n:0,S=r?x*-n*f/r:0,A=(s+u)/2+Math.cos(i)*w-Math.sin(i)*S,M=(l+c)/2+Math.sin(i)*w+Math.cos(i)*S,R=[(f-w)/r,(d-S)/n],O=[(-1*f-w)/r,(-1*d-S)/n],N=dV([1,0],R),k=dV(R,O);return pF(R,O)<=-1&&(k=Math.PI),pF(R,O)>=1&&(k=0),o===0&&k>0&&(k=k-2*Math.PI),o===1&&k<0&&(k=k+2*Math.PI),{cx:A,cy:M,rx:fV(e,[u,c])?0:r,ry:fV(e,[u,c])?0:n,startAngle:N,endAngle:N+k,xRotation:i,arcFlag:a,sweepFlag:o}}var ZM=Math.sin,qM=Math.cos,W4=Math.atan2,RT=Math.PI;function oet(e,t,r,n,i,a,o){var s=t.stroke,l=t.lineWidth,u=r-i,c=n-a,f=W4(c,u),d=new q4({type:"path",canvas:e.get("canvas"),isArrowShape:!0,attrs:{path:"M"+10*qM(RT/6)+","+10*ZM(RT/6)+" L0,0 L"+10*qM(RT/6)+",-"+10*ZM(RT/6),stroke:s,lineWidth:l}});d.translate(i,a),d.rotateAtPoint(i,a,f),e.set(o?"startArrowShape":"endArrowShape",d)}function set(e,t,r,n,i,a,o){var s=t.startArrow,l=t.endArrow,u=t.stroke,c=t.lineWidth,f=o?s:l,d=f.d,v=f.fill,g=f.stroke,x=f.lineWidth,w=hi(f,["d","fill","stroke","lineWidth"]),S=r-i,A=n-a,M=W4(A,S);d&&(i=i-qM(M)*d,a=a-ZM(M)*d);var R=new q4({type:"path",canvas:e.get("canvas"),isArrowShape:!0,attrs:U(U({},w),{stroke:g||u,lineWidth:x||c,fill:v})});R.translate(i,a),R.rotateAtPoint(i,a,M),e.set(o?"startArrowShape":"endArrowShape",R)}function Dy(e,t,r,n,i){var a=W4(n-t,r-e);return{dx:qM(a)*i,dy:ZM(a)*i}}function X4(e,t,r,n,i,a){typeof t.startArrow=="object"?set(e,t,r,n,i,a,!0):t.startArrow?oet(e,t,r,n,i,a,!0):e.set("startArrowShape",null)}function j4(e,t,r,n,i,a){typeof t.endArrow=="object"?set(e,t,r,n,i,a,!1):t.endArrow?oet(e,t,r,n,i,a,!1):e.set("startArrowShape",null)}var pV={fill:"fillStyle",stroke:"strokeStyle",opacity:"globalAlpha"};function jx(e,t){var r=t.attr();for(var n in r){var i=r[n],a=pV[n]?pV[n]:n;a==="matrix"&&i?e.transform(i[0],i[1],i[3],i[4],i[6],i[7]):a==="lineDash"&&e.setLineDash?ze(i)&&e.setLineDash(i):(a==="strokeStyle"||a==="fillStyle"?i=Q$t(e,t,i):a==="globalAlpha"&&(i=i*e.globalAlpha),e[a]=i)}}function vF(e,t,r){for(var n=0;n<t.length;n++){var i=t[n];i.cfg.visible?i.draw(e,r):i.skipDraw()}}function tHt(e,t,r){var n=e.get("refreshElements");ft(n,function(i){if(i!==e)for(var a=i.cfg.parent;a&&a!==e&&!a.cfg.refresh;)a.cfg.refresh=!0,a=a.cfg.parent}),n[0]===e?Y4(t):gF(t,r)}function gF(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(n.cfg.visible)if(n.cfg.hasChanged)n.cfg.refresh=!0,n.isGroup()&&Y4(n.cfg.children);else if(n.cfg.refresh)n.isGroup()&&gF(n.cfg.children,t);else{var i=eHt(n,t);n.cfg.refresh=i,i&&n.isGroup()&&gF(n.cfg.children,t)}}}function uet(e){for(var t=0;t<e.length;t++){var r=e[t];r.cfg.hasChanged=!1,r.isGroup()&&!r.destroyed&&uet(r.cfg.children)}}function Y4(e,t){for(var r=0;r<e.length;r++){var n=e[r];n.cfg.visible&&(n.cfg.refresh=!0,n.isGroup()&&Y4(n.get("children")))}}function eHt(e,t){var r=e.cfg.cacheCanvasBBox,n=e.cfg.isInView&&r&&CC(r,t);return n}function cet(e,t,r,n){var i=r.path,a=r.startArrow,o=r.endArrow;if(i){var s=[0,0],l=[0,0],u={dx:0,dy:0};t.beginPath();for(var c=0;c<i.length;c++){var f=i[c],d=f[0];if(c===0&&a&&a.d){var v=e.getStartTangent();u=Dy(v[0][0],v[0][1],v[1][0],v[1][1],a.d)}else if(c===i.length-2&&i[c+1][0]==="Z"&&o&&o.d){var g=i[c+1];if(g[0]==="Z"){var v=e.getEndTangent();u=Dy(v[0][0],v[0][1],v[1][0],v[1][1],o.d)}}else if(c===i.length-1&&o&&o.d&&i[0]!=="Z"){var v=e.getEndTangent();u=Dy(v[0][0],v[0][1],v[1][0],v[1][1],o.d)}var x=u.dx,w=u.dy;switch(d){case"M":t.moveTo(f[1]-x,f[2]-w),l=[f[1],f[2]];break;case"L":t.lineTo(f[1]-x,f[2]-w);break;case"Q":t.quadraticCurveTo(f[1],f[2],f[3]-x,f[4]-w);break;case"C":t.bezierCurveTo(f[1],f[2],f[3],f[4],f[5]-x,f[6]-w);break;case"A":{var S=void 0;n?(S=n[c],S||(S=YM(s,f),n[c]=S)):S=YM(s,f);var A=S.cx,M=S.cy,R=S.rx,O=S.ry,N=S.startAngle,k=S.endAngle,V=S.xRotation,Q=S.sweepFlag;if(t.ellipse)t.ellipse(A,M,R,O,V,N,k,1-Q);else{var Y=R>O?R:O,X=R>O?1:R/O,tt=R>O?O/R:1;t.translate(A,M),t.rotate(V),t.scale(X,tt),t.arc(0,0,Y,N,k,1-Q),t.scale(1/X,1/tt),t.rotate(-V),t.translate(-A,-M)}break}case"Z":t.closePath();break}if(d==="Z")s=l;else{var it=f.length;s=[f[it-2],f[it-1]]}}}}function het(e,t){var r=e.get("canvas");r&&(t==="remove"&&(e._cacheCanvasBBox=e.get("cacheCanvasBBox")),e.get("hasChanged")||(e.set("hasChanged",!0),e.cfg.parent&&e.cfg.parent.get("hasChanged")||(r.refreshElement(e,t,r),r.get("autoDraw")&&r.draw())))}function rHt(e){var t;if(e.destroyed)t=e._cacheCanvasBBox;else{var r=e.get("cacheCanvasBBox"),n=r&&!!(r.width&&r.height),i=e.getCanvasBBox(),a=i&&!!(i.width&&i.height);n&&a?t=W$t(r,i):n?t=r:a&&(t=i)}return t}function nHt(e){if(!e.length)return null;var t=[],r=[],n=[],i=[];return ft(e,function(a){var o=rHt(a);o&&(t.push(o.minX),r.push(o.minY),n.push(o.maxX),i.push(o.maxY))}),{minX:Vf(t),minY:Vf(r),maxX:kh(n),maxY:kh(i)}}function iHt(e,t){return!e||!t||!CC(e,t)?null:{minX:Math.max(e.minX,t.minX),minY:Math.max(e.minY,t.minY),maxX:Math.min(e.maxX,t.maxX),maxY:Math.min(e.maxY,t.maxY)}}var Z4=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.onCanvasChange=function(r){het(this,r)},t.prototype.getShapeBase=function(){return WR},t.prototype.getGroupBase=function(){return t},t.prototype._applyClip=function(r,n){n&&(r.save(),jx(r,n),n.createPath(r),r.restore(),r.clip(),n._afterDraw())},t.prototype.cacheCanvasBBox=function(){var r=this.cfg.children,n=[],i=[];ft(r,function(d){var v=d.cfg.cacheCanvasBBox;v&&d.cfg.isInView&&(n.push(v.minX,v.maxX),i.push(v.minY,v.maxY))});var a=null;if(n.length){var o=Vf(n),s=kh(n),l=Vf(i),u=kh(i);a={minX:o,minY:l,x:o,y:l,maxX:s,maxY:u,width:s-o,height:u-l};var c=this.cfg.canvas;if(c){var f=c.getViewRange();this.set("isInView",CC(a,f))}}else this.set("isInView",!1);this.set("cacheCanvasBBox",a)},t.prototype.draw=function(r,n){var i=this.cfg.children,a=n?this.cfg.refresh:!0;i.length&&a&&(r.save(),jx(r,this),this._applyClip(r,this.getClip()),vF(r,i,n),r.restore(),this.cacheCanvasBBox()),this.cfg.refresh=null,this.set("hasChanged",!1)},t.prototype.skipDraw=function(){this.set("cacheCanvasBBox",null),this.set("hasChanged",!1)},t}(RI),Zd=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultAttrs=function(){var r=e.prototype.getDefaultAttrs.call(this);return U(U({},r),{lineWidth:1,lineAppendWidth:0,strokeOpacity:1,fillOpacity:1})},t.prototype.getShapeBase=function(){return WR},t.prototype.getGroupBase=function(){return Z4},t.prototype.onCanvasChange=function(r){het(this,r)},t.prototype.calculateBBox=function(){var r=this.get("type"),n=this.getHitLineWidth(),i=LI(r),a=i(this),o=n/2,s=a.x-o,l=a.y-o,u=a.x+a.width+o,c=a.y+a.height+o;return{x:s,minX:s,y:l,minY:l,width:a.width+n,height:a.height+n,maxX:u,maxY:c}},t.prototype.isFill=function(){return!!this.attrs.fill||this.isClipShape()},t.prototype.isStroke=function(){return!!this.attrs.stroke},t.prototype._applyClip=function(r,n){n&&(r.save(),jx(r,n),n.createPath(r),r.restore(),r.clip(),n._afterDraw())},t.prototype.draw=function(r,n){var i=this.cfg.clipShape;if(n){if(this.cfg.refresh===!1){this.set("hasChanged",!1);return}var a=this.getCanvasBBox();if(!CC(n,a)){this.set("hasChanged",!1),this.cfg.isInView&&this._afterDraw();return}}r.save(),jx(r,this),this._applyClip(r,i),this.drawPath(r),r.restore(),this._afterDraw()},t.prototype.getCanvasViewBox=function(){var r=this.cfg.canvas;return r?r.getViewRange():null},t.prototype.cacheCanvasBBox=function(){var r=this.getCanvasViewBox();if(r){var n=this.getCanvasBBox(),i=CC(n,r);this.set("isInView",i),i?this.set("cacheCanvasBBox",n):this.set("cacheCanvasBBox",null)}},t.prototype._afterDraw=function(){this.cacheCanvasBBox(),this.set("hasChanged",!1),this.set("refresh",null)},t.prototype.skipDraw=function(){this.set("cacheCanvasBBox",null),this.set("isInView",null),this.set("hasChanged",!1)},t.prototype.drawPath=function(r){this.createPath(r),this.strokeAndFill(r),this.afterDrawPath(r)},t.prototype.fill=function(r){r.fill()},t.prototype.stroke=function(r){r.stroke()},t.prototype.strokeAndFill=function(r){var n=this.attrs,i=n.lineWidth,a=n.opacity,o=n.strokeOpacity,s=n.fillOpacity;this.isFill()&&(!ke(s)&&s!==1?(r.globalAlpha=s,this.fill(r),r.globalAlpha=a):this.fill(r)),this.isStroke()&&i>0&&(!ke(o)&&o!==1&&(r.globalAlpha=o),this.stroke(r)),this.afterDrawPath(r)},t.prototype.createPath=function(r){},t.prototype.afterDrawPath=function(r){},t.prototype.isInShape=function(r,n){var i=this.isStroke(),a=this.isFill(),o=this.getHitLineWidth();return this.isInStrokeOrPath(r,n,i,a,o)},t.prototype.isInStrokeOrPath=function(r,n,i,a,o){return!1},t.prototype.getHitLineWidth=function(){if(!this.isStroke())return 0;var r=this.attrs;return r.lineWidth+r.lineAppendWidth},t}(II),aHt=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultAttrs=function(){var r=e.prototype.getDefaultAttrs.call(this);return U(U({},r),{x:0,y:0,r:0})},t.prototype.isInStrokeOrPath=function(r,n,i,a,o){var s=this.attr(),l=s.x,u=s.y,c=s.r,f=o/2,d=net(l,u,r,n);return a&&i?d<=c+f:a?d<=c:i?d>=c-f&&d<=c+f:!1},t.prototype.createPath=function(r){var n=this.attr(),i=n.x,a=n.y,o=n.r;r.beginPath(),r.arc(i,a,o,0,Math.PI*2,!1),r.closePath()},t}(Zd);function IT(e,t,r,n){return e/(r*r)+t/(n*n)}var oHt=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultAttrs=function(){var r=e.prototype.getDefaultAttrs.call(this);return U(U({},r),{x:0,y:0,rx:0,ry:0})},t.prototype.isInStrokeOrPath=function(r,n,i,a,o){var s=this.attr(),l=o/2,u=s.x,c=s.y,f=s.rx,d=s.ry,v=(r-u)*(r-u),g=(n-c)*(n-c);return a&&i?IT(v,g,f+l,d+l)<=1:a?IT(v,g,f,d)<=1:i?IT(v,g,f-l,d-l)>=1&&IT(v,g,f+l,d+l)<=1:!1},t.prototype.createPath=function(r){var n=this.attr(),i=n.x,a=n.y,o=n.rx,s=n.ry;if(r.beginPath(),r.ellipse)r.ellipse(i,a,o,s,0,0,Math.PI*2,!1);else{var l=o>s?o:s,u=o>s?1:o/s,c=o>s?s/o:1;r.save(),r.translate(i,a),r.scale(u,c),r.arc(0,0,l,0,Math.PI*2),r.restore(),r.closePath()}},t}(Zd);function vV(e){return e instanceof HTMLElement&&nn(e.nodeName)&&e.nodeName.toUpperCase()==="CANVAS"}var sHt=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultAttrs=function(){var r=e.prototype.getDefaultAttrs.call(this);return U(U({},r),{x:0,y:0,width:0,height:0})},t.prototype.initAttrs=function(r){this._setImage(r.img)},t.prototype.isStroke=function(){return!1},t.prototype.isOnlyHitBox=function(){return!0},t.prototype._afterLoading=function(){if(this.get("toDraw")===!0){var r=this.get("canvas");r?r.draw():this.createPath(this.get("context"))}},t.prototype._setImage=function(r){var n=this,i=this.attrs;if(nn(r)){var a=new Image;a.onload=function(){if(n.destroyed)return!1;n.attr("img",a),n.set("loading",!1),n._afterLoading();var o=n.get("callback");o&&o.call(n)},a.crossOrigin="Anonymous",a.src=r,this.set("loading",!0)}else r instanceof Image?(i.width||(i.width=r.width),i.height||(i.height=r.height)):vV(r)&&(i.width||(i.width=Number(r.getAttribute("width"))),i.height||(i.height,Number(r.getAttribute("height"))))},t.prototype.onAttrChange=function(r,n,i){e.prototype.onAttrChange.call(this,r,n,i),r==="img"&&this._setImage(n)},t.prototype.createPath=function(r){if(this.get("loading")){this.set("toDraw",!0),this.set("context",r);return}var n=this.attr(),i=n.x,a=n.y,o=n.width,s=n.height,l=n.sx,u=n.sy,c=n.swidth,f=n.sheight,d=n.img;(d instanceof Image||vV(d))&&(!ke(l)&&!ke(u)&&!ke(c)&&!ke(f)?r.drawImage(d,l,u,c,f,i,a,o,s):r.drawImage(d,i,a,o,s))},t}(Zd);function Rm(e,t,r,n,i,a,o){var s=Math.min(e,r),l=Math.max(e,r),u=Math.min(t,n),c=Math.max(t,n),f=i/2;return a>=s-f&&a<=l+f&&o>=u-f&&o<=c+f?Hl.pointToLine(e,t,r,n,a,o)<=i/2:!1}var lHt=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultAttrs=function(){var r=e.prototype.getDefaultAttrs.call(this);return U(U({},r),{x1:0,y1:0,x2:0,y2:0,startArrow:!1,endArrow:!1})},t.prototype.initAttrs=function(r){this.setArrow()},t.prototype.onAttrChange=function(r,n,i){e.prototype.onAttrChange.call(this,r,n,i),this.setArrow()},t.prototype.setArrow=function(){var r=this.attr(),n=r.x1,i=r.y1,a=r.x2,o=r.y2,s=r.startArrow,l=r.endArrow;s&&X4(this,r,a,o,n,i),l&&j4(this,r,n,i,a,o)},t.prototype.isInStrokeOrPath=function(r,n,i,a,o){if(!i||!o)return!1;var s=this.attr(),l=s.x1,u=s.y1,c=s.x2,f=s.y2;return Rm(l,u,c,f,o,r,n)},t.prototype.createPath=function(r){var n=this.attr(),i=n.x1,a=n.y1,o=n.x2,s=n.y2,l=n.startArrow,u=n.endArrow,c={dx:0,dy:0},f={dx:0,dy:0};l&&l.d&&(c=Dy(i,a,o,s,n.startArrow.d)),u&&u.d&&(f=Dy(i,a,o,s,n.endArrow.d)),r.beginPath(),r.moveTo(i+c.dx,a+c.dy),r.lineTo(o-f.dx,s-f.dy)},t.prototype.afterDrawPath=function(r){var n=this.get("startArrowShape"),i=this.get("endArrowShape");n&&n.draw(r),i&&i.draw(r)},t.prototype.getTotalLength=function(){var r=this.attr(),n=r.x1,i=r.y1,a=r.x2,o=r.y2;return Hl.length(n,i,a,o)},t.prototype.getPoint=function(r){var n=this.attr(),i=n.x1,a=n.y1,o=n.x2,s=n.y2;return Hl.pointAt(i,a,o,s,r)},t}(Zd),uHt=/[MLHVQTCSAZ]([^MLHVQTCSAZ]*)/ig,cHt=/[^\s\,]+/ig;function hHt(e){var t=e||[];if(ze(t))return t;if(nn(t))return t=t.match(uHt),ft(t,function(r,n){if(r=r.match(cHt),r[0].length>1){var i=r[0].charAt(0);r.splice(1,0,r[0].substr(1)),r[0]=i}ft(r,function(a,o){isNaN(a)||(r[o]=+a)}),t[n]=r}),t}var Nw=`	
\v\f\r   ᠎             　\u2028\u2029`,fHt=new RegExp("([a-z])["+Nw+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+Nw+"]*,?["+Nw+"]*)+)","ig"),dHt=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+Nw+"]*,?["+Nw+"]*","ig");function pHt(e){if(!e)return null;if(ze(e))return e;var t={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},r=[];return String(e).replace(fHt,function(n,i,a){var o=[],s=i.toLowerCase();if(a.replace(dHt,function(l,u){u&&o.push(+u)}),s==="m"&&o.length>2&&(r.push([i].concat(o.splice(0,2))),s="l",i=i==="m"?"l":"L"),s==="o"&&o.length===1&&r.push([i,o[0]]),s==="r")r.push([i].concat(o));else for(;o.length>=t[s]&&(r.push([i].concat(o.splice(0,t[s]))),!!t[s]););return""}),r}var vHt=/[a-z]/;function gV(e,t){return[t[0]+(t[0]-e[0]),t[1]+(t[1]-e[1])]}function fet(e){var t=pHt(e);if(!t||!t.length)return[["M",0,0]];for(var r=!1,n=0;n<t.length;n++){var i=t[n][0];if(vHt.test(i)||["V","H","T","S"].indexOf(i)>=0){r=!0;break}}if(!r)return t;var a=[],o=0,s=0,l=0,u=0,c=0,f=t[0];(f[0]==="M"||f[0]==="m")&&(o=+f[1],s=+f[2],l=o,u=s,c++,a[0]=["M",o,s]);for(var n=c,d=t.length;n<d;n++){var v=t[n],g=a[n-1],x=[],i=v[0],w=i.toUpperCase();if(i!==w)switch(x[0]=w,w){case"A":x[1]=v[1],x[2]=v[2],x[3]=v[3],x[4]=v[4],x[5]=v[5],x[6]=+v[6]+o,x[7]=+v[7]+s;break;case"V":x[1]=+v[1]+s;break;case"H":x[1]=+v[1]+o;break;case"M":l=+v[1]+o,u=+v[2]+s,x[1]=l,x[2]=u;break;default:for(var S=1,A=v.length;S<A;S++)x[S]=+v[S]+(S%2?o:s)}else x=t[n];switch(w){case"Z":o=+l,s=+u;break;case"H":o=x[1],x=["L",o,s];break;case"V":s=x[1],x=["L",o,s];break;case"T":o=x[1],s=x[2];var M=gV([g[1],g[2]],[g[3],g[4]]);x=["Q",M[0],M[1],o,s];break;case"S":o=x[x.length-2],s=x[x.length-1];var R=g.length,O=gV([g[R-4],g[R-3]],[g[R-2],g[R-1]]);x=["C",O[0],O[1],x[1],x[2],o,s];break;case"M":l=x[x.length-2],u=x[x.length-1];break;default:o=x[x.length-2],s=x[x.length-1]}a.push(x)}return a}function LT(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function mF(e,t){return LT(e)*LT(t)?(e[0]*t[0]+e[1]*t[1])/(LT(e)*LT(t)):1}function mV(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(mF(e,t))}function yF(e,t){return e[0]===t[0]&&e[1]===t[1]}function gHt(e,t){var r=t[1],n=t[2],i=bI(EI(t[3]),Math.PI*2),a=t[4],o=t[5],s=e[0],l=e[1],u=t[6],c=t[7],f=Math.cos(i)*(s-u)/2+Math.sin(i)*(l-c)/2,d=-1*Math.sin(i)*(s-u)/2+Math.cos(i)*(l-c)/2,v=f*f/(r*r)+d*d/(n*n);v>1&&(r*=Math.sqrt(v),n*=Math.sqrt(v));var g=r*r*(d*d)+n*n*(f*f),x=g?Math.sqrt((r*r*(n*n)-g)/g):1;a===o&&(x*=-1),isNaN(x)&&(x=0);var w=n?x*r*d/n:0,S=r?x*-n*f/r:0,A=(s+u)/2+Math.cos(i)*w-Math.sin(i)*S,M=(l+c)/2+Math.sin(i)*w+Math.cos(i)*S,R=[(f-w)/r,(d-S)/n],O=[(-1*f-w)/r,(-1*d-S)/n],N=mV([1,0],R),k=mV(R,O);return mF(R,O)<=-1&&(k=Math.PI),mF(R,O)>=1&&(k=0),o===0&&k>0&&(k=k-2*Math.PI),o===1&&k<0&&(k=k+2*Math.PI),{cx:A,cy:M,rx:yF(e,[u,c])?0:r,ry:yF(e,[u,c])?0:n,startAngle:N,endAngle:N+k,xRotation:i,arcFlag:a,sweepFlag:o}}function yV(e,t){return[t[0]+(t[0]-e[0]),t[1]+(t[1]-e[1])]}function mHt(e){e=hHt(e);for(var t=[],r=null,n=null,i=null,a=0,o=e.length,s=0;s<o;s++){var l=e[s];n=e[s+1];var u=l[0],c={command:u,prePoint:r,params:l,startTangent:null,endTangent:null};switch(u){case"M":i=[l[1],l[2]],a=s;break;case"A":var f=gHt(r,l);c.arcParams=f;break}if(u==="Z")r=i,n=e[a+1];else{var d=l.length;r=[l[d-2],l[d-1]]}n&&n[0]==="Z"&&(n=e[a],t[a]&&(t[a].prePoint=r)),c.currentPoint=r,t[a]&&yF(r,t[a].currentPoint)&&(t[a].prePoint=c.prePoint);var v=n?[n[n.length-2],n[n.length-1]]:null;c.nextPoint=v;var g=c.prePoint;if(["L","H","V"].includes(u))c.startTangent=[g[0]-r[0],g[1]-r[1]],c.endTangent=[r[0]-g[0],r[1]-g[1]];else if(u==="Q"){var x=[l[1],l[2]];c.startTangent=[g[0]-x[0],g[1]-x[1]],c.endTangent=[r[0]-x[0],r[1]-x[1]]}else if(u==="T"){var w=t[s-1],x=yV(w.currentPoint,g);w.command==="Q"?(c.command="Q",c.startTangent=[g[0]-x[0],g[1]-x[1]],c.endTangent=[r[0]-x[0],r[1]-x[1]]):(c.command="TL",c.startTangent=[g[0]-r[0],g[1]-r[1]],c.endTangent=[r[0]-g[0],r[1]-g[1]])}else if(u==="C"){var S=[l[1],l[2]],A=[l[3],l[4]];c.startTangent=[g[0]-S[0],g[1]-S[1]],c.endTangent=[r[0]-A[0],r[1]-A[1]],c.startTangent[0]===0&&c.startTangent[1]===0&&(c.startTangent=[S[0]-A[0],S[1]-A[1]]),c.endTangent[0]===0&&c.endTangent[1]===0&&(c.endTangent=[A[0]-S[0],A[1]-S[1]])}else if(u==="S"){var w=t[s-1],S=yV(w.currentPoint,g),A=[l[1],l[2]];w.command==="C"?(c.command="C",c.startTangent=[g[0]-S[0],g[1]-S[1]],c.endTangent=[r[0]-A[0],r[1]-A[1]]):(c.command="SQ",c.startTangent=[g[0]-A[0],g[1]-A[1]],c.endTangent=[r[0]-A[0],r[1]-A[1]])}else if(u==="A"){var M=.001,R=c.arcParams||{},O=R.cx,N=O===void 0?0:O,k=R.cy,V=k===void 0?0:k,Q=R.rx,Y=Q===void 0?0:Q,X=R.ry,tt=X===void 0?0:X,it=R.sweepFlag,Et=it===void 0?0:it,Tt=R.startAngle,pt=Tt===void 0?0:Tt,kt=R.endAngle,ae=kt===void 0?0:kt;Et===0&&(M*=-1);var Kt=Y*Math.cos(pt-M)+N,re=tt*Math.sin(pt-M)+V;c.startTangent=[Kt-i[0],re-i[1]];var fe=Y*Math.cos(pt+ae+M)+N,Oe=tt*Math.sin(pt+ae-M)+V;c.endTangent=[g[0]-fe,g[1]-Oe]}t.push(c)}return t}var yHt={circle:function(e,t,r){return[["M",e-r,t],["A",r,r,0,1,0,e+r,t],["A",r,r,0,1,0,e-r,t]]},square:function(e,t,r){return[["M",e-r,t-r],["L",e+r,t-r],["L",e+r,t+r],["L",e-r,t+r],["Z"]]},diamond:function(e,t,r){return[["M",e-r,t],["L",e,t-r],["L",e+r,t],["L",e,t+r],["Z"]]},triangle:function(e,t,r){var n=r*Math.sin(.3333333333333333*Math.PI);return[["M",e-r,t+n],["L",e,t-n],["L",e+r,t+n],["Z"]]},"triangle-down":function(e,t,r){var n=r*Math.sin(.3333333333333333*Math.PI);return[["M",e-r,t-n],["L",e+r,t-n],["L",e,t+n],["Z"]]}},_Ht=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.initAttrs=function(r){this._resetParamsCache()},t.prototype._resetParamsCache=function(){this.set("paramsCache",{})},t.prototype.onAttrChange=function(r,n,i){e.prototype.onAttrChange.call(this,r,n,i),["symbol","x","y","r","radius"].indexOf(r)!==-1&&this._resetParamsCache()},t.prototype.isOnlyHitBox=function(){return!0},t.prototype._getR=function(r){return ke(r.r)?r.radius:r.r},t.prototype._getPath=function(){var r=this.attr(),n=r.x,i=r.y,a=r.symbol||"circle",o=this._getR(r),s,l;if($r(a))s=a,l=s(n,i,o),l=fet(l);else{if(s=t.Symbols[a],!s)return console.warn(a+" marker is not supported."),null;l=s(n,i,o)}return l},t.prototype.createPath=function(r){var n=this._getPath(),i=this.get("paramsCache");cet(this,r,{path:n},i)},t.Symbols=yHt,t}(Zd);function det(e,t,r){var n=PI();return e.createPath(n),n.isPointInPath(t,r)}var xHt=1e-6;function zO(e){return Math.abs(e)<xHt?0:e<0?-1:1}function bHt(e,t,r){return(r[0]-e[0])*(t[1]-e[1])===(t[0]-e[0])*(r[1]-e[1])&&Math.min(e[0],t[0])<=r[0]&&r[0]<=Math.max(e[0],t[0])&&Math.min(e[1],t[1])<=r[1]&&r[1]<=Math.max(e[1],t[1])}function pet(e,t,r){var n=!1,i=e.length;if(i<=2)return!1;for(var a=0;a<i;a++){var o=e[a],s=e[(a+1)%i];if(bHt(o,s,[t,r]))return!0;zO(o[1]-r)>0!=zO(s[1]-r)>0&&zO(t-(r-o[1])*(o[0]-s[0])/(o[1]-s[1])-o[0])<0&&(n=!n)}return n}function xw(e,t,r,n,i,a,o,s){var l=(Math.atan2(s-t,o-e)+Math.PI*2)%(Math.PI*2);if(l<n||l>i)return!1;var u={x:e+r*Math.cos(l),y:t+r*Math.sin(l)};return net(u.x,u.y,o,s)<=a/2}var EHt=Vs;function wHt(e){for(var t=!1,r=e.length,n=0;n<r;n++){var i=e[n],a=i[0];if(a==="C"||a==="A"||a==="Q"){t=!0;break}}return t}function CHt(e,t,r,n,i){for(var a=!1,o=t/2,s=0;s<e.length;s++){var l=e[s],u=l.currentPoint,c=l.params,f=l.prePoint,d=l.box;if(!(d&&!wy(d.x-o,d.y-o,d.width+t,d.height+t,r,n))){switch(l.command){case"L":case"Z":a=Rm(f[0],f[1],u[0],u[1],t,r,n);break;case"Q":var v=Jtt.pointDistance(f[0],f[1],c[1],c[2],c[3],c[4],r,n);a=v<=t/2;break;case"C":var g=Bw.pointDistance(f[0],f[1],c[1],c[2],c[3],c[4],c[5],c[6],r,n,i);a=g<=t/2;break;case"A":var x=l.arcParams,w=x.cx,S=x.cy,A=x.rx,M=x.ry,R=x.startAngle,O=x.endAngle,N=x.xRotation,k=[r,n,1],V=A>M?A:M,Q=A>M?1:A/M,Y=A>M?M/A:1,X=EHt(null,[["t",-w,-S],["r",-N],["s",1/Q,1/Y]]);oC(k,k,X),a=xw(0,0,V,R,O,t,k[0],k[1]);break}if(a)break}}return a}function SHt(e){for(var t=e.length,r=[],n=[],i=[],a=0;a<t;a++){var o=e[a],s=o[0];s==="M"?(i.length&&(n.push(i),i=[]),i.push([o[1],o[2]])):s==="Z"?i.length&&(r.push(i),i=[]):i.push([o[1],o[2]])}return i.length>0&&n.push(i),{polygons:r,polylines:n}}const OT=U({hasArc:wHt,extractPolygons:SHt,isPointInStroke:CHt},B4);function _V(e,t,r){for(var n=!1,i=0;i<e.length;i++){var a=e[i];if(n=pet(a,t,r),n)break}return n}var q4=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultAttrs=function(){var r=e.prototype.getDefaultAttrs.call(this);return U(U({},r),{startArrow:!1,endArrow:!1})},t.prototype.initAttrs=function(r){this._setPathArr(r.path),this.setArrow()},t.prototype.onAttrChange=function(r,n,i){e.prototype.onAttrChange.call(this,r,n,i),r==="path"&&this._setPathArr(n),this.setArrow()},t.prototype._setPathArr=function(r){this.attrs.path=fet(r);var n=OT.hasArc(r);this.set("hasArc",n),this.set("paramsCache",{}),this.set("segments",null),this.set("curve",null),this.set("tCache",null),this.set("totalLength",null)},t.prototype.getSegments=function(){var r=this.get("segements");return r||(r=mHt(this.attr("path")),this.set("segments",r)),r},t.prototype.setArrow=function(){var r=this.attr(),n=r.startArrow,i=r.endArrow;if(n){var a=this.getStartTangent();X4(this,r,a[0][0],a[0][1],a[1][0],a[1][1])}if(i){var a=this.getEndTangent();j4(this,r,a[0][0],a[0][1],a[1][0],a[1][1])}},t.prototype.isInStrokeOrPath=function(r,n,i,a,o){var s=this.getSegments(),l=this.get("hasArc"),u=!1;if(i){var c=this.getTotalLength();u=OT.isPointInStroke(s,o,r,n,c)}if(!u&&a)if(l)u=det(this,r,n);else{var f=this.attr("path"),d=OT.extractPolygons(f);u=_V(d.polygons,r,n)||_V(d.polylines,r,n)}return u},t.prototype.createPath=function(r){var n=this.attr(),i=this.get("paramsCache");cet(this,r,n,i)},t.prototype.afterDrawPath=function(r){var n=this.get("startArrowShape"),i=this.get("endArrowShape");n&&n.draw(r),i&&i.draw(r)},t.prototype.getTotalLength=function(){var r=this.get("totalLength");return ke(r)?(this._calculateCurve(),this._setTcache(),this.get("totalLength")):r},t.prototype.getPoint=function(r){var n=this.get("tCache");n||(this._calculateCurve(),this._setTcache(),n=this.get("tCache"));var i,a,o=this.get("curve");if(!n||n.length===0)return o?{x:o[0][1],y:o[0][2]}:null;ft(n,function(c,f){r>=c[0]&&r<=c[1]&&(i=(r-c[0])/(c[1]-c[0]),a=f)});var s=o[a];if(ke(s)||ke(a))return null;var l=s.length,u=o[a+1];return Bw.pointAt(s[l-2],s[l-1],u[1],u[2],u[3],u[4],u[5],u[6],i)},t.prototype._calculateCurve=function(){var r=this.attr().path;this.set("curve",OT.pathToCurve(r))},t.prototype._setTcache=function(){var r=0,n=0,i=[],a,o,s,l,u=this.get("curve");if(u){if(ft(u,function(c,f){s=u[f+1],l=c.length,s&&(r+=Bw.length(c[l-2],c[l-1],s[1],s[2],s[3],s[4],s[5],s[6])||0)}),this.set("totalLength",r),r===0){this.set("tCache",[]);return}ft(u,function(c,f){s=u[f+1],l=c.length,s&&(a=[],a[0]=n/r,o=Bw.length(c[l-2],c[l-1],s[1],s[2],s[3],s[4],s[5],s[6]),n+=o||0,a[1]=n/r,i.push(a))}),this.set("tCache",i)}},t.prototype.getStartTangent=function(){var r=this.getSegments(),n;if(r.length>1){var i=r[0].currentPoint,a=r[1].currentPoint,o=r[1].startTangent;n=[],o?(n.push([i[0]-o[0],i[1]-o[1]]),n.push([i[0],i[1]])):(n.push([a[0],a[1]]),n.push([i[0],i[1]]))}return n},t.prototype.getEndTangent=function(){var r=this.getSegments(),n=r.length,i;if(n>1){var a=r[n-2].currentPoint,o=r[n-1].currentPoint,s=r[n-1].endTangent;i=[],s?(i.push([o[0]-s[0],o[1]-s[1]]),i.push([o[0],o[1]])):(i.push([a[0],a[1]]),i.push([o[0],o[1]]))}return i},t}(Zd);function vet(e,t,r,n,i){var a=e.length;if(a<2)return!1;for(var o=0;o<a-1;o++){var s=e[o][0],l=e[o][1],u=e[o+1][0],c=e[o+1][1];if(Rm(s,l,u,c,t,r,n))return!0}if(i){var f=e[0],d=e[a-1];if(Rm(f[0],f[1],d[0],d[1],t,r,n))return!0}return!1}var THt=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.isInStrokeOrPath=function(r,n,i,a,o){var s=this.attr().points,l=!1;return i&&(l=vet(s,o,r,n,!0)),!l&&a&&(l=pet(s,r,n)),l},t.prototype.createPath=function(r){var n=this.attr(),i=n.points;if(!(i.length<2)){r.beginPath();for(var a=0;a<i.length;a++){var o=i[a];a===0?r.moveTo(o[0],o[1]):r.lineTo(o[0],o[1])}r.closePath()}},t}(Zd),AHt=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultAttrs=function(){var r=e.prototype.getDefaultAttrs.call(this);return U(U({},r),{startArrow:!1,endArrow:!1})},t.prototype.initAttrs=function(r){this.setArrow()},t.prototype.onAttrChange=function(r,n,i){e.prototype.onAttrChange.call(this,r,n,i),this.setArrow(),["points"].indexOf(r)!==-1&&this._resetCache()},t.prototype._resetCache=function(){this.set("totalLength",null),this.set("tCache",null)},t.prototype.setArrow=function(){var r=this.attr(),n=this.attrs,i=n.points,a=n.startArrow,o=n.endArrow,s=i.length,l=i[0][0],u=i[0][1],c=i[s-1][0],f=i[s-1][1];a&&X4(this,r,i[1][0],i[1][1],l,u),o&&j4(this,r,i[s-2][0],i[s-2][1],c,f)},t.prototype.isFill=function(){return!1},t.prototype.isInStrokeOrPath=function(r,n,i,a,o){if(!i||!o)return!1;var s=this.attr().points;return vet(s,o,r,n,!1)},t.prototype.isStroke=function(){return!0},t.prototype.createPath=function(r){var n=this.attr(),i=n.points,a=n.startArrow,o=n.endArrow,s=i.length;if(!(i.length<2)){var l=i[0][0],u=i[0][1],c=i[s-1][0],f=i[s-1][1];if(a&&a.d){var d=Dy(l,u,i[1][0],i[1][1],a.d);l+=d.dx,u+=d.dy}if(o&&o.d){var d=Dy(i[s-2][0],i[s-2][1],c,f,o.d);c-=d.dx,f-=d.dy}r.beginPath(),r.moveTo(l,u);for(var v=0;v<s-1;v++){var g=i[v];r.lineTo(g[0],g[1])}r.lineTo(c,f)}},t.prototype.afterDrawPath=function(r){var n=this.get("startArrowShape"),i=this.get("endArrowShape");n&&n.draw(r),i&&i.draw(r)},t.prototype.getTotalLength=function(){var r=this.attr().points,n=this.get("totalLength");return ke(n)?(this.set("totalLength",ret.length(r)),this.get("totalLength")):n},t.prototype.getPoint=function(r){var n=this.attr().points,i=this.get("tCache");i||(this._setTcache(),i=this.get("tCache"));var a,o;return ft(i,function(s,l){r>=s[0]&&r<=s[1]&&(a=(r-s[0])/(s[1]-s[0]),o=l)}),Hl.pointAt(n[o][0],n[o][1],n[o+1][0],n[o+1][1],a)},t.prototype._setTcache=function(){var r=this.attr().points;if(!(!r||r.length===0)){var n=this.getTotalLength();if(!(n<=0)){var i=0,a=[],o,s;ft(r,function(l,u){r[u+1]&&(o=[],o[0]=i/n,s=Hl.length(l[0],l[1],r[u+1][0],r[u+1][1]),i+=s,o[1]=i/n,a.push(o))}),this.set("tCache",a)}}},t.prototype.getStartTangent=function(){var r=this.attr().points,n=[];return n.push([r[1][0],r[1][1]]),n.push([r[0][0],r[0][1]]),n},t.prototype.getEndTangent=function(){var r=this.attr().points,n=r.length-1,i=[];return i.push([r[n-1][0],r[n-1][1]]),i.push([r[n][0],r[n][1]]),i},t}(Zd);function MHt(e,t,r,n,i,a,o){var s=i/2;return wy(e-s,t-s,r,i,a,o)||wy(e+r-s,t-s,i,n,a,o)||wy(e+s,t+n-s,r,i,a,o)||wy(e-s,t+s,i,n,a,o)}function RHt(e,t,r,n,i,a,o,s){return Rm(e+i,t,e+r-i,t,a,o,s)||Rm(e+r,t+i,e+r,t+n-i,a,o,s)||Rm(e+r-i,t+n,e+i,t+n,a,o,s)||Rm(e,t+n-i,e,t+i,a,o,s)||xw(e+r-i,t+i,i,1.5*Math.PI,2*Math.PI,a,o,s)||xw(e+r-i,t+n-i,i,0,.5*Math.PI,a,o,s)||xw(e+i,t+n-i,i,.5*Math.PI,Math.PI,a,o,s)||xw(e+i,t+i,i,Math.PI,1.5*Math.PI,a,o,s)}var IHt=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultAttrs=function(){var r=e.prototype.getDefaultAttrs.call(this);return U(U({},r),{x:0,y:0,width:0,height:0,radius:0})},t.prototype.isInStrokeOrPath=function(r,n,i,a,o){var s=this.attr(),l=s.x,u=s.y,c=s.width,f=s.height,d=s.radius;if(d){var g=!1;return i&&(g=RHt(l,u,c,f,d,o,r,n)),!g&&a&&(g=det(this,r,n)),g}else{var v=o/2;if(a&&i)return wy(l-v,u-v,c+v,f+v,r,n);if(a)return wy(l,u,c,f,r,n);if(i)return MHt(l,u,c,f,o,r,n)}},t.prototype.createPath=function(r){var n=this.attr(),i=n.x,a=n.y,o=n.width,s=n.height,l=n.radius;if(r.beginPath(),l===0)r.rect(i,a,o,s);else{var u=J$t(l),c=u[0],f=u[1],d=u[2],v=u[3];r.moveTo(i+c,a),r.lineTo(i+o-f,a),f!==0&&r.arc(i+o-f,a+f,f,-Math.PI/2,0),r.lineTo(i+o,a+s-d),d!==0&&r.arc(i+o-d,a+s-d,d,0,Math.PI/2),r.lineTo(i+v,a+s),v!==0&&r.arc(i+v,a+s-v,v,Math.PI/2,Math.PI),r.lineTo(i,a+c),c!==0&&r.arc(i+c,a+c,c,Math.PI,Math.PI*1.5),r.closePath()}},t}(Zd),LHt=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultAttrs=function(){var r=e.prototype.getDefaultAttrs.call(this);return U(U({},r),{x:0,y:0,text:null,fontSize:12,fontFamily:"sans-serif",fontStyle:"normal",fontWeight:"normal",fontVariant:"normal",textAlign:"start",textBaseline:"bottom"})},t.prototype.isOnlyHitBox=function(){return!0},t.prototype.initAttrs=function(r){this._assembleFont(),r.text&&this._setText(r.text)},t.prototype._assembleFont=function(){var r=this.attrs;r.font=FI(r)},t.prototype._setText=function(r){var n=null;nn(r)&&r.indexOf(`
`)!==-1&&(n=r.split(`
`)),this.set("textArr",n)},t.prototype.onAttrChange=function(r,n,i){e.prototype.onAttrChange.call(this,r,n,i),r.startsWith("font")&&this._assembleFont(),r==="text"&&this._setText(n)},t.prototype._getSpaceingY=function(){var r=this.attrs,n=r.lineHeight,i=r.fontSize*1;return n?n-i:i*.14},t.prototype._drawTextArr=function(r,n,i){var a=this.attrs,o=a.textBaseline,s=a.x,l=a.y,u=a.fontSize*1,c=this._getSpaceingY(),f=DI(a.text,a.fontSize,a.lineHeight),d;ft(n,function(v,g){d=l+g*(c+u)-f+u,o==="middle"&&(d+=f-u-(f-u)/2),o==="top"&&(d+=f-u),ke(v)||(i?r.fillText(v,s,d):r.strokeText(v,s,d))})},t.prototype._drawText=function(r,n){var i=this.attr(),a=i.x,o=i.y,s=this.get("textArr");if(s)this._drawTextArr(r,s,n);else{var l=i.text;ke(l)||(n?r.fillText(l,a,o):r.strokeText(l,a,o))}},t.prototype.strokeAndFill=function(r){var n=this.attrs,i=n.lineWidth,a=n.opacity,o=n.strokeOpacity,s=n.fillOpacity;this.isStroke()&&i>0&&(!ke(o)&&o!==1&&(r.globalAlpha=a),this.stroke(r)),this.isFill()&&(!ke(s)&&s!==1?(r.globalAlpha=s,this.fill(r),r.globalAlpha=a):this.fill(r)),this.afterDrawPath(r)},t.prototype.fill=function(r){this._drawText(r,!0)},t.prototype.stroke=function(r){this._drawText(r,!1)},t}(Zd);function OHt(e,t){if(t){var r=TI(t);return Zv(r,e)}return e}function get(e,t,r){var n=e.getTotalMatrix();if(n){var i=OHt([t,r,1],n),a=i[0],o=i[1];return[a,o]}return[t,r]}function xV(e,t,r){if(e.isCanvas&&e.isCanvas())return!0;if(!bC(e)||e.cfg.isInView===!1)return!1;if(e.cfg.clipShape){var n=get(e,t,r),i=n[0],a=n[1];if(e.isClipped(i,a))return!1}var o=e.cfg.cacheCanvasBBox||e.getCanvasBBox();return t>=o.minX&&t<=o.maxX&&r>=o.minY&&r<=o.maxY}function met(e,t,r){if(!xV(e,t,r))return null;for(var n=null,i=e.getChildren(),a=i.length,o=a-1;o>=0;o--){var s=i[o];if(s.isGroup())n=met(s,t,r);else if(xV(s,t,r)){var l=s,u=get(s,t,r),c=u[0],f=u[1];l.isInShape(c,f)&&(n=s)}if(n)break}return n}var PHt=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultCfg=function(){var r=e.prototype.getDefaultCfg.call(this);return r.renderer="canvas",r.autoDraw=!0,r.localRefresh=!0,r.refreshElements=[],r.clipView=!0,r.quickHit=!1,r},t.prototype.onCanvasChange=function(r){(r==="attr"||r==="sort"||r==="changeSize")&&(this.set("refreshElements",[this]),this.draw())},t.prototype.getShapeBase=function(){return WR},t.prototype.getGroupBase=function(){return Z4},t.prototype.getPixelRatio=function(){var r=this.get("pixelRatio")||G$t();return r>=1?Math.ceil(r):1},t.prototype.getViewRange=function(){return{minX:0,minY:0,maxX:this.cfg.width,maxY:this.cfg.height}},t.prototype.createDom=function(){var r=document.createElement("canvas"),n=r.getContext("2d");return this.set("context",n),r},t.prototype.setDOMSize=function(r,n){e.prototype.setDOMSize.call(this,r,n);var i=this.get("context"),a=this.get("el"),o=this.getPixelRatio();a.width=o*r,a.height=o*n,o>1&&i.scale(o,o)},t.prototype.clear=function(){e.prototype.clear.call(this),this._clearFrame();var r=this.get("context"),n=this.get("el");r.clearRect(0,0,n.width,n.height)},t.prototype.getShape=function(r,n){var i;return this.get("quickHit")?i=met(this,r,n):i=e.prototype.getShape.call(this,r,n,null),i},t.prototype._getRefreshRegion=function(){var r=this.get("refreshElements"),n=this.getViewRange(),i;if(r.length&&r[0]===this)i=n;else if(i=nHt(r),i){i.minX=Math.floor(i.minX),i.minY=Math.floor(i.minY),i.maxX=Math.ceil(i.maxX),i.maxY=Math.ceil(i.maxY),i.maxY+=1;var a=this.get("clipView");a&&(i=iHt(i,n))}return i},t.prototype.refreshElement=function(r){var n=this.get("refreshElements");n.push(r)},t.prototype._clearFrame=function(){var r=this.get("drawFrame");r&&(CUt(r),this.set("drawFrame",null),this.set("refreshElements",[]))},t.prototype.draw=function(){var r=this.get("drawFrame");this.get("autoDraw")&&r||this._startDraw()},t.prototype._drawAll=function(){var r=this.get("context"),n=this.get("el"),i=this.getChildren();r.clearRect(0,0,n.width,n.height),jx(r,this),vF(r,i),this.set("refreshElements",[])},t.prototype._drawRegion=function(){var r=this.get("context"),n=this.get("refreshElements"),i=this.getChildren(),a=this._getRefreshRegion();a?(r.clearRect(a.minX,a.minY,a.maxX-a.minX,a.maxY-a.minY),r.save(),r.beginPath(),r.rect(a.minX,a.minY,a.maxX-a.minX,a.maxY-a.minY),r.clip(),jx(r,this),tHt(this,i,a),vF(r,i,a),r.restore()):n.length&&uet(n),ft(n,function(o){o.get("hasChanged")&&o.set("hasChanged",!1)}),this.set("refreshElements",[])},t.prototype._startDraw=function(){var r=this,n=this.get("drawFrame"),i=this.get("drawFrameCallback");n||(n=wUt(function(){r.get("localRefresh")?r._drawRegion():r._drawAll(),r.set("drawFrame",null),i&&i()}),this.set("drawFrame",n))},t.prototype.skipDraw=function(){},t.prototype.removeDom=function(){var r=this.get("el");r.width=0,r.height=0,r.parentNode.removeChild(r)},t}(MI),DHt="0.5.12";const FHt=Object.freeze(Object.defineProperty({__proto__:null,AbstractCanvas:MI,AbstractGroup:RI,AbstractShape:II,Base:SI,Canvas:PHt,Event:IS,Group:Z4,PathUtil:B4,Shape:WR,assembleFont:FI,getArcParams:YM,getBBoxMethod:LI,getOffScreenContext:PI,getTextHeight:DI,invert:TI,isAllowCapture:bC,multiplyVec2:Zv,registerBBox:Jf,registerEasing:jtt,version:DHt},Symbol.toStringTag,{value:"Module"}));class K4 extends S_{constructor(t=[],r={}){super(),this.name=r.name?r.name:Gh("layerGroup"),this.layers=t}addTo(t){this.scene=t;let r=0;const n=this.layers.length;this.layers.forEach(i=>{i.once("inited",a=>{r++,this.emit("inited",a),r===n&&this.emit("inited-all")}),i.addTo(t)})}hasLayer(t){return this.layers.some(r=>r===t)}addLayer(t){this.layers.push(t),this.scene&&(t.once("inited",r=>this.emit("inited",r)),t.addTo(this.scene))}removeLayer(t){const r=this.layers.findIndex(n=>n===t);return r===-1?!1:(this.layers.splice(r,1),this.scene&&t.remove(this.scene),!0)}getLayers(){return this.layers}getInteractionLayers(){return this.layers.filter(({interaction:t})=>t)}getLayer(t){return this.layers.find(({layer:r})=>r.id===t)}getLayerByName(t){return this.layers.find(r=>r.name===t)}removeAllLayer(){this.layers.forEach(t=>{this.scene&&t.remove(this.scene)}),this.layers=[]}isEmpty(){return this.layers.length===0}}function L1(e,t,r){if(e){if(typeof e.addEventListener=="function")return e.addEventListener(t,r,!1),{remove:function(){e.removeEventListener(t,r,!1)}};if(typeof e.attachEvent=="function")return e.attachEvent("on"+t,r),{remove:function(){e.detachEvent("on"+t,r)}}}}function Hc(e,t,r){var n;try{n=window.getComputedStyle?window.getComputedStyle(e,null)[t]:e.style[t]}catch{}finally{n=n===void 0?r:n}return n}function BHt(e,t){var r=Hc(e,"height",t);return r==="auto"&&(r=e.offsetHeight),parseFloat(r)}function NHt(e,t){var r=BHt(e,t),n=parseFloat(Hc(e,"borderTopWidth"))||0,i=parseFloat(Hc(e,"paddingTop"))||0,a=parseFloat(Hc(e,"paddingBottom"))||0,o=parseFloat(Hc(e,"borderBottomWidth"))||0,s=parseFloat(Hc(e,"marginTop"))||0,l=parseFloat(Hc(e,"marginBottom"))||0;return r+n+o+i+a+s+l}function kHt(e,t){var r=Hc(e,"width",t);return r==="auto"&&(r=e.offsetWidth),parseFloat(r)}function zHt(e,t){var r=kHt(e,t),n=parseFloat(Hc(e,"borderLeftWidth"))||0,i=parseFloat(Hc(e,"paddingLeft"))||0,a=parseFloat(Hc(e,"paddingRight"))||0,o=parseFloat(Hc(e,"borderRightWidth"))||0,s=parseFloat(Hc(e,"marginRight"))||0,l=parseFloat(Hc(e,"marginLeft"))||0;return r+n+o+i+a+l+s}function ka(e,t){if(e)for(var r in t)t.hasOwnProperty(r)&&(e.style[r]=t[r]);return e}const Q4={fontFamily:`
  "-apple-system", BlinkMacSystemFont, "Segoe UI", Roboto,"Helvetica Neue",
  Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei",
  SimSun, "sans-serif"`},J4="l7plot-tooltip",tN="l7plot-tooltip__title",eN="l7plot-tooltip__list",yet="l7plot-tooltip__list-item",_et="l7plot-tooltip__name",xet="l7plot-tooltip__value",UHt=`<div class="${J4}">
  <div class="${tN}"></div>
  <ul class="${eN}"></ul>
</div>`,bV=`<li class="${yet}" data-index={index}>
  <span class="${_et}">{name}</span>
  <span class="${xet}">{value}</span>
</li>`,$Ht={[J4]:{visibility:"visible",zIndex:999,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)",backgroundColor:"rgba(255, 255, 255, 0.9)",boxShadow:"rgb(0 0 0 / 16%) 0px 6px 12px 0px",borderRadius:"2px",color:"rgb(87, 87, 87)",fontSize:"12px",fontFamily:Q4.fontFamily,lineHeight:"20px",padding:"10px 10px 6px 10px"},[tN]:{marginBottom:"4px"},[eN]:{margin:"0px",listStyleType:"none",padding:"0px"},[yet]:{listStyleType:"none",marginBottom:"4px",whiteSpace:"nowrap",display:"flex",justifyContent:"space-between"},[_et]:{},[xet]:{marginLeft:"30px"}};function HHt(e,t){return!!e.className.match(new RegExp(`(\\s|^)${t}(\\s|$)`))}function rN(e){const t=e.childNodes,r=t.length;for(let n=r-1;n>=0;n--)e.removeChild(t[n])}let nN=class{constructor(t){this.destroyed=!1,this.options=Tr({},this.getDefaultOptions(),t),this.container=this.initContainer(),this.initDom(),this.applyStyles(),this.initEvent(),this.initCapture(),this.initVisible(),this.render()}getDefaultOptions(){return{name:"",containerTpl:"<div></div>",visible:!0,capture:!0,domStyles:{}}}getContainer(){return this.container}getParentContainer(){const t=this.options.parent;let r;if(!t)return r;if(nn(t)){const n=document.getElementById(t);if(n)r=n;else throw new Error(`No parent id ${t}`)}else r=t;return r}initContainer(){const t=this.createDom(this.options.containerTpl),r=this.getParentContainer();return r&&r.appendChild(t),t}initVisible(){this.options.visible?this.show():this.hide()}initCapture(){this.setCapture(this.options.capture)}update(t){this.options=Tr({},this.options,t),this.updateInner(t),this.afterUpdate(t)}updateInner(t){t.domStyles&&this.applyStyles()}afterUpdate(t){t.capture&&this.setCapture(t.capture)}setCapture(t){const r=this.container,n=t?"auto":"none";r.style.pointerEvents=n}applyStyles(){const t=this.options.domStyles;if(!t)return;const r=this.container;this.applyChildrenStyles(r,t);const n=this.options.className;if(n&&HHt(r,n)){const i=t[n];ka(r,i)}}applyChildrenStyles(t,r){ft(r,(n,i)=>{const a=t.getElementsByClassName(i);ft(a,o=>{ka(o,n)})})}applyStyle(t,r){const n=this.options.domStyles;n&&ka(r,n[t])}createDom(t="<div></div>"){return eg(t)}removeDom(){const t=this.container;t&&t.parentNode&&t.parentNode.removeChild(t)}destroy(){this.removeEvent(),this.removeDom(),this.destroyed=!0}},VHt=class extends nN{getDefaultOptions(){return Tr({},super.getDefaultOptions(),{id:"l7plot-tooltip",name:"l7plot-tooltip",title:"",showTitle:!0,items:[],containerTpl:UHt,itemTpl:bV,domStyles:$Ht,className:J4})}initContainer(){const{customContent:t}=this.options;if(t){const r=this.getHtmlContentNode(t),n=this.getParentContainer();return n&&n.appendChild(r),r}else return super.initContainer()}initDom(){this.cacheDoms()}initEvent(){}removeEvent(){}cacheDoms(){const t=this.container,r=t.getElementsByClassName(tN)[0],n=t.getElementsByClassName(eN)[0];this.titleDom=r,this.listDom=n}render(){this.options.customContent?this.renderCustomContent(this.options.customContent):(this.resetTitle(),this.renderItems())}show(){const t=this.container;!t||this.destroyed||ka(t,{visibility:"visible"})}hide(){const t=this.container;!t||this.destroyed||ka(t,{visibility:"hidden"})}updateInner(t){this.options.customContent?this.renderCustomContent(this.options.customContent):(t.title&&this.resetTitle(),t.items&&this.renderItems()),super.updateInner(t)}renderCustomContent(t){const r=this.container.parentNode,n=this.getHtmlContentNode(t),i=this.container;r&&r.replaceChild(n,i),this.container=n,this.applyStyles()}getHtmlContentNode(t){let r;const n=t(this.options.title||"",this.options.items);return nn(n)?r=this.createDom(n):r=n,r}resetTitle(){const t=this.options.title;this.options.showTitle&&t?(this.showTitle(),this.setTitle(t)):this.hideTitle()}showTitle(){const t=this.titleDom;t&&ka(t,{display:"block"})}hideTitle(){const t=this.titleDom;t&&ka(t,{display:"none"})}setTitle(t){const r=this.titleDom;r&&(r.innerHTML=t)}renderItems(){this.clearItemDoms();const t=this.options.items,r=this.options.itemTpl||bV,n=this.listDom;n&&(t.forEach(i=>{const a=Object.assign({},i),o=dS(r,a),s=this.createDom(o);n.appendChild(s)}),this.applyChildrenStyles(n,this.options.domStyles))}clearItemDoms(){this.listDom&&rN(this.listDom)}clear(){this.setTitle(""),this.clearItemDoms()}};const GHt={[g5]:{visibility:"visible",zIndex:1,backgroundColor:"rgba(255, 255, 255, 0.9)",boxShadow:"rgb(0 0 0 / 16%) 0px 6px 12px 0px",borderRadius:"2px",color:"rgb(87, 87, 87)",fontFamily:Q4.fontFamily,padding:"10px 10px 6px 10px",lineHeight:1,fontSize:"12px"},[m5]:{fontSize:"13px",lineHeight:"19px",marginBottom:"8px"},[y5]:{margin:"0px",listStyleType:"none",padding:"0px"},[FZ]:{listStyleType:"none",display:"flex",alignItems:"center",marginBottom:"2px"},[BZ]:{width:"10px",height:"10px"},[NZ]:{paddingLeft:"8px"}};let WHt=class extends nN{getDefaultOptions(){return Tr({},super.getDefaultOptions(),{id:"l7plot-category-legend",name:"l7plot-category-legend",title:"",items:[],containerTpl:aft,itemTpl:i7,domStyles:GHt,className:g5})}initContainer(){const{customContent:t}=this.options;if(t){const r=this.getHtmlContentNode(t),n=this.getParentContainer();return n&&n.appendChild(r),r}else return super.initContainer()}initDom(){this.cacheDoms()}initEvent(){}removeEvent(){}cacheDoms(){const t=this.container,r=t.getElementsByClassName(m5)[0],n=t.getElementsByClassName(y5)[0];this.titleDom=r,this.listDom=n}render(){this.options.customContent?this.renderCustomContent(this.options.customContent):(this.resetTitle(),this.renderItems())}show(){const t=this.container;!t||this.destroyed||ka(t,{visibility:"visible"})}hide(){const t=this.container;!t||this.destroyed||ka(t,{visibility:"hidden"})}updateInner(t){this.options.customContent?this.renderCustomContent(this.options.customContent):(t.title&&this.resetTitle(),t.items&&this.renderItems()),super.updateInner(t)}renderCustomContent(t){const r=this.container.parentNode,n=this.getHtmlContentNode(t),i=this.container;r&&r.replaceChild(n,i),this.container=n,this.applyStyles()}getHtmlContentNode(t){let r;const n=t(this.options.title||"",this.options.items);return nn(n)?r=this.createDom(n):r=n,r}resetTitle(){const t=this.options.title;t?(this.showTitle(),this.setTitle(t)):this.hideTitle()}showTitle(){const t=this.titleDom;t&&ka(t,{display:"block"})}hideTitle(){const t=this.titleDom;t&&ka(t,{display:"none"})}setTitle(t){const r=this.titleDom;r&&(r.innerHTML=t)}renderItems(){this.clearItemDoms();const t=this.options.items.length>30?this.options.items.slice(0,30):this.options.items,r=this.options.itemTpl||i7,n=this.listDom;n&&(t.forEach(i=>{const o=i.value===""?"—":Array.isArray(i.value)?i.value.join(" - "):i.value,s=Object.assign(Object.assign({},i),{value:o}),l=dS(r,s),u=this.createDom(l);n.appendChild(u)}),this.applyChildrenStyles(n,this.options.domStyles))}clearItemDoms(){this.listDom&&rN(this.listDom)}clear(){this.setTitle(""),this.clearItemDoms()}};const iN="l7plot-legend l7plot-legend__continue",aN="l7plot-legend__title",bet="l7plot-legend__ribbon-container",Eet="l7plot-legend__ribbon",wet="l7plot-legend__gradient-bar",_F="l7plot-legend__value-range",XHt=`<div class="${iN}">
  <div class="${aN}"></div>
  <div class="${bet}"></div>
</div>`,EV=`<div class="${Eet}">
  <span class="${_F}">{min}</span>
  <div class="${wet}" style="background-image: {backgroundImage}"></div>
  <span class="${_F}">{max}</span>
</div>`,jHt={[iN]:{visibility:"visible",zIndex:1,backgroundColor:"rgba(255, 255, 255, 0.9)",boxShadow:"rgb(0 0 0 / 16%) 0px 6px 12px 0px",borderRadius:"2px",color:"rgb(87, 87, 87)",fontFamily:Q4.fontFamily,padding:"10px",lineHeight:1,fontSize:"12px"},[aN]:{fontSize:"13px",lineHeight:"19px",marginBottom:"8px"},[Eet]:{display:"flex",alignItems:"center"},[wet]:{width:"140px",height:"14px",margin:"0px 5px"},[_F]:{padding:"0px"}};let YHt=class extends nN{getDefaultOptions(){return Tr({},super.getDefaultOptions(),{id:"l7plot-continue-legend",name:"l7plot-continue-legend",title:"",containerTpl:XHt,ribbonTpl:EV,domStyles:jHt,className:iN})}initContainer(){const{customContent:t}=this.options;if(t){const r=this.getHtmlContentNode(t),n=this.getParentContainer();return n&&n.appendChild(r),r}else return super.initContainer()}initDom(){this.cacheDoms()}initEvent(){}removeEvent(){}cacheDoms(){const t=this.container,r=t.getElementsByClassName(aN)[0],n=t.getElementsByClassName(bet)[0];this.titleDom=r,this.ribbonContainerDom=n}render(){this.options.customContent?this.renderCustomContent(this.options.customContent):(this.resetTitle(),this.renderRibbon())}show(){const t=this.container;!t||this.destroyed||ka(t,{visibility:"visible"})}hide(){const t=this.container;!t||this.destroyed||ka(t,{visibility:"hidden"})}updateInner(t){this.options.customContent?this.renderCustomContent(this.options.customContent):(t.title&&this.resetTitle(),t.colors&&this.renderRibbon()),super.updateInner(t)}renderCustomContent(t){const r=this.container.parentNode,n=this.getHtmlContentNode(t),i=this.container;r&&r.replaceChild(n,i),this.container=n,this.applyStyles()}getHtmlContentNode(t){let r;const n=t(this.options.title||"",this.options.min,this.options.max,this.options.colors);return nn(n)?r=this.createDom(n):r=n,r}resetTitle(){const t=this.options.title;t?(this.showTitle(),this.setTitle(t)):this.hideTitle()}showTitle(){const t=this.titleDom;t&&ka(t,{display:"block"})}hideTitle(){const t=this.titleDom;t&&ka(t,{display:"none"})}setTitle(t){const r=this.titleDom;r&&(r.innerHTML=t)}renderRibbon(){this.clearRibbonContainerDoms();const{min:t,max:r,colors:n,ribbonTpl:i=EV}=this.options,a=this.ribbonContainerDom;if(a){const o=`linear-gradient(to right, ${n.join(", ")})`,l=dS(i,{min:t,max:r,backgroundImage:o}),u=this.createDom(l);a.appendChild(u),this.applyChildrenStyles(a,this.options.domStyles)}}clearRibbonContainerDoms(){this.ribbonContainerDom&&rN(this.ribbonContainerDom)}clear(){this.setTitle(""),this.clearRibbonContainerDoms()}},ZHt=class extends Wm{constructor(t){super(t),this.legendComponents=[],this.options=t,this.legendComponents=this.initLegendComponents(t.items)}initLegendComponents(t){const r=[];for(let n=0;n<t.length;n++){const i=t[n];if(i.type==="category"){const a=new WHt({title:i.options.title,items:i.options.items,className:i.options.className,customContent:i.options.customContent,domStyles:i.options.domStyles});r.push(a)}else if(i.type==="continue"){const a=new YHt({title:i.options.title,min:i.options.min,max:i.options.max,colors:i.options.colors,className:i.options.className,customContent:i.options.customContent,domStyles:i.options.domStyles});r.push(a)}}return r}getDefaultOptions(){return{position:"bottomleft"}}onAdd(){const t=window.document.createElement("div");return t.className="l7plot-legend-container",this.legendComponents.forEach(r=>{const n=r.getContainer();t.appendChild(n)}),t}onRemove(){this.legendComponents.forEach(t=>{t.destroy()})}};var wV;(function(e){e[e.solid=0]="solid",e[e.dash=1]="dash"})(wV||(wV={}));var xF;(function(e){e.TextLayer="textLayer",e.DotLayer="dotLayer",e.IconLayer="iconLayer",e.DotDensity="dotDensityLayer",e.ColumnLayer="columnLayer",e.HeatmapLayer="heatmapLayer",e.GridLayer="gridLayer",e.HexbinLayer="hexbinLayer",e.LinesLayer="linesLayer",e.PathLayer="pathLayer",e.ArcLayer="arcLayer",e.AreaLayer="areaLayer",e.PrismLayer="prismLayer"})(xF||(xF={}));var Cd;(function(e){e.Map="map",e.Amap="amap",e.AmapV1="amapv1",e.AmapV2="amapv2",e.Mapbox="mapbox"})(Cd||(Cd={}));var bF;(function(e){e.Dot="dot",e.DotDensity="dotDensity",e.Heatmap="heatmap",e.Grid="grid",e.Hexbin="hexbin",e.Path="path",e.Flow="flow",e.Area="area",e.Choropleth="choropleth"})(bF||(bF={}));const qHt=5,KHt=new Object().toString,Cet=(e,t)=>KHt.call(e)==="[object "+t+"]",QHt=e=>Cet(e,"Array"),JHt=e=>typeof e=="object"&&e!==null,CV=e=>{if(!JHt(e)||!Cet(e,"Object"))return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t},Tet=(e,t,r,n)=>{r=r||0,n=n||qHt;for(const i in t)if(Object.prototype.hasOwnProperty.call(t,i)){const a=t[i];a?CV(a)?(CV(e[i])||(e[i]={}),r<n?Tet(e[i],a,r+1,n):e[i]=t[i]):QHt(a)?(e[i]=[],e[i]=e[i].concat(a)):e[i]=a:e[i]=a}},Is=(e,...t)=>{for(let r=0;r<t.length;r+=1)Tet(e,t[r]);return e},tVt=["mousemove","click"];let eVt=class extends S_{constructor(t,r,n){super(),this.currentVisible=!1,this.interactionTriggerHander=f=>{const{feature:d,featureId:v}=f,{title:g,customTitle:x,items:w,customItems:S}=this.options,M=d.type==="Feature"&&d.geometry&&d.properties?d.properties:d;let R=[];if(S){const N=S(d);if(Array.isArray(N))R=N;else throw new Error("customItems return array")}else w&&w.forEach(N=>{if(nn(N)){const k=N.split(".").pop()||N,V=r7(M,N);V!==void 0&&R.push({name:k,value:V})}else{const{field:k,alias:V,customValue:Q}=N,Y=V||k.split(".").pop()||k,X=r7(M,k);X!==void 0&&R.push({name:Y,value:Q?Q(X,M,v):X})}});const O={title:x?x(M):g,items:R};this.updateTooltip(f,O)},this.interactionUntriggerHander=()=>{this.hideTooltip()},this.scene=t,this.interactionLayers=r,this.options=Is({},this.getDefaultOptions(),n);const{offsets:i,title:a,showTitle:o,customContent:s,domStyles:l,anchor:u,className:c}=this.options;this.marker=new u9({offsets:i,anchor:u,draggable:!1}),this.tooltipComponent=new VHt({title:a,showTitle:o,items:[],customContent:s,domStyles:l,className:c}),this.setComponent(),this.initInteractionEvent()}getDefaultOptions(){return{showTitle:!0,showComponent:!0,items:[],offsets:[15,0],trigger:"mousemove",anchor:YR["TOP-LEFT"]}}update(t){this.marker.remove(),this.currentVisible=!1,this.options=Is({},this.options,t);const{offsets:r,showTitle:n,customContent:i,domStyles:a,anchor:o,className:s}=this.options;this.marker=new u9({offsets:r,anchor:o,draggable:!1}),this.tooltipComponent.update({showTitle:n,customContent:i,domStyles:a,className:s}),this.setComponent()}initInteractionEvent(){const t=this.options.trigger||"mousemove";if(!tVt.includes(t))throw new Error("trigger is mousemove or click");this.interactionLayers.forEach(({layer:r})=>{r.on(t,this.interactionTriggerHander),r.on(`un${t}`,this.interactionUntriggerHander)})}unBindInteractionEvent(){const t=this.options.trigger||"mousemove";this.interactionLayers.forEach(({layer:r})=>{r.off(t,this.interactionTriggerHander),r.off(`un${t}`,this.interactionUntriggerHander)})}updateTooltip(t,r){const{lngLat:n,x:i,y:a}=t;if(this.options.showComponent&&(this.updateComponent(r),this.setPostion(n)),this.currentVisible){const o={type:"tooltip:change",data:r,lngLat:n,x:i,y:a};this.emit("tooltip:change",o)}else{this.showTooltip();const o={type:"tooltip:show",data:r,lngLat:n,x:i,y:a};this.emit("tooltip:show",o)}}showTooltip(){this.currentVisible||(this.options.showComponent&&this.scene.addMarker(this.marker),this.currentVisible=!0)}hideTooltip(){if(!this.currentVisible)return;this.options.showComponent&&this.marker.remove(),this.currentVisible=!1;const t={type:"tooltip:hide"};this.emit("tooltip:hide",t)}updateComponent(t){zi(this.lastComponentOptions,t)||(this.tooltipComponent.update(t),this.lastComponentOptions=t)}setComponent(){const t=this.tooltipComponent.getContainer(),r=window.document.createElement("div");r.style.cursor="auto",r.style.userSelect="text",r.className="l7plot-tooltip-container",["mousemove","mousedown","mouseup","click","dblclick"].forEach(n=>{r.addEventListener(n,i=>i.stopPropagation())}),r.appendChild(t),this.marker.setElement(r)}setPostion(t){this.marker.setLnglat(t)}destroy(){this.unBindInteractionEvent(),this.off(),this.marker.remove(),this.tooltipComponent.destroy()}};var hy={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ITEM_TPL=e.CONTAINER_TPL=e.VALUE_CLASS=e.NAME_CLASS=e.LIST_ITEM_CLASS=e.LIST_CLASS=e.TITLE_CLASS=e.CONTAINER_CLASS=void 0,e.CONTAINER_CLASS="l7plot-tooltip",e.TITLE_CLASS="l7plot-tooltip__title",e.LIST_CLASS="l7plot-tooltip__list",e.LIST_ITEM_CLASS="l7plot-tooltip__list-item",e.NAME_CLASS="l7plot-tooltip__name",e.VALUE_CLASS="l7plot-tooltip__value",e.CONTAINER_TPL=`<div class="${e.CONTAINER_CLASS}">
  <div class="${e.TITLE_CLASS}"></div>
  <ul class="${e.LIST_CLASS}"></ul>
</div>`,e.ITEM_TPL=`<li class="${e.LIST_ITEM_CLASS}" data-index={index}>
  <span class="${e.NAME_CLASS}">{name}</span>
  <span class="${e.VALUE_CLASS}">{value}</span>
</li>`})(hy);var fy={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ITEM_TPL=e.CONTAINER_TPL=e.VALUE_CLASS=e.MARKER_CLASS=e.LIST_ITEM_CLASS=e.LIST_CLASS=e.TITLE_CLASS=e.CONTAINER_CLASS=void 0,e.CONTAINER_CLASS="l7plot-legend l7plot-legend__category",e.TITLE_CLASS="l7plot-legend__title",e.LIST_CLASS="l7plot-legend__category-list",e.LIST_ITEM_CLASS="l7plot-legend__list-item",e.MARKER_CLASS="l7plot-legend__category-marker",e.VALUE_CLASS="l7plot-legend__category-value",e.CONTAINER_TPL=`<div class="${e.CONTAINER_CLASS}">
  <div class="${e.TITLE_CLASS}"></div>
  <ul class="${e.LIST_CLASS}"></ul>
</div>`,e.ITEM_TPL=`<li class="${e.LIST_ITEM_CLASS}" data-index={index}>
  <span class="${e.MARKER_CLASS}" style="background:{color}"></span>
  <span class="${e.VALUE_CLASS}">{value}</span>
</li>`})(fy);var $1={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.RIBBON_TPL=e.CONTAINER_TPL=e.VALUE_RANGE_CLASS=e.GRADIENT_BAR_CLASS=e.RIBBON_CLASS=e.RIBBON_CONTAINER_CLASS=e.TITLE_CLASS=e.CONTAINER_CLASS=void 0,e.CONTAINER_CLASS="l7plot-legend l7plot-legend__continue",e.TITLE_CLASS="l7plot-legend__title",e.RIBBON_CONTAINER_CLASS="l7plot-legend__ribbon-container",e.RIBBON_CLASS="l7plot-legend__ribbon",e.GRADIENT_BAR_CLASS="l7plot-legend__gradient-bar",e.VALUE_RANGE_CLASS="l7plot-legend__value-range",e.CONTAINER_TPL=`<div class="${e.CONTAINER_CLASS}">
  <div class="${e.TITLE_CLASS}"></div>
  <div class="${e.RIBBON_CONTAINER_CLASS}"></div>
</div>`,e.RIBBON_TPL=`<div class="${e.RIBBON_CLASS}">
  <span class="${e.VALUE_RANGE_CLASS}">{min}</span>
  <div class="${e.GRADIENT_BAR_CLASS}" style="background-image: {backgroundImage}"></div>
  <span class="${e.VALUE_RANGE_CLASS}">{max}</span>
</div>`})($1);function Aet(e){const t={point:{default:{fill:e.pointFillColor,size:e.pointSize,stroke:e.pointBorderColor,lineWidth:e.pointBorder,fillOpacity:e.pointFillOpacity},active:{fill:e.pointActiveFillColor},selected:{fill:e.pointSelectedFillColor}}};return{mapStyle:e.mapStyle,defaultColor:e.brandColor,subColor:e.subColor,semanticRed:e.paletteSemanticRed,semanticGreen:e.paletteSemanticGreen,fontFamily:e.fontFamily,colors10:e.paletteQualitative10,colors20:e.paletteQualitative20,sequenceColors:e.paletteSequence,shapes:{point:["circle","square"],line:["line"]},sizes:[1,10],geometries:{point:{circle:{default:{style:t.point.default},active:{style:t.point.active},selected:{style:t.point.selected}}},line:{},polygon:{}},components:{legend:{category:{domStyles:{[fy.CONTAINER_CLASS]:{visibility:"visible",zIndex:1,backgroundColor:e.legendContainerFillColor,boxShadow:e.legendContainerShadow,borderRadius:`${e.legendContainerBorderRadius}px`,color:e.legendTextFillColor,fontFamily:e.fontFamily,padding:"10px",lineHeight:"1",fontSize:`${e.legendTextFontSize}px`},[fy.TITLE_CLASS]:{fontSize:"13px",lineHeight:"19px",marginBottom:"8px"},[fy.LIST_CLASS]:{margin:"0px",padding:"0px"},[fy.LIST_ITEM_CLASS]:{marginBottom:"2px"},[fy.MARKER_CLASS]:{width:"10px",height:"10px"},[fy.VALUE_CLASS]:{paddingLeft:"8px"}}},continue:{domStyles:{[$1.CONTAINER_CLASS]:{visibility:"visible",zIndex:1,backgroundColor:e.legendContainerFillColor,boxShadow:e.legendContainerShadow,borderRadius:`${e.legendContainerBorderRadius}px`,color:e.legendTextFillColor,fontFamily:e.fontFamily,padding:"10px",lineHeight:1,fontSize:`${e.legendTextFontSize}px`},[$1.TITLE_CLASS]:{fontSize:"13px",lineHeight:"19px",marginBottom:"8px"},[$1.RIBBON_CLASS]:{display:"flex",alignItems:"center"},[$1.GRADIENT_BAR_CLASS]:{width:"140px",height:"14px",margin:"0px 5px"},[$1.VALUE_RANGE_CLASS]:{padding:"0px"}}}},tooltip:{domStyles:{[hy.CONTAINER_CLASS]:{visibility:"visible",zIndex:999,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)",backgroundColor:e.tooltipContainerFillColor,boxShadow:e.tooltipContainerShadow,borderRadius:`${e.tooltipContainerBorderRadius}px`,color:e.tooltipTextFillColor,fontSize:`${e.tooltipTextFontSize}px`,fontFamily:e.fontFamily,lineHeight:e.tooltipTextLineHeight},[hy.TITLE_CLASS]:{marginBottom:"4px"},[hy.LIST_CLASS]:{margin:"0px",padding:"0px"},[hy.LIST_ITEM_CLASS]:{marginBottom:"4px"},[hy.NAME_CLASS]:{color:e.tooltipItemNameFillColor},[hy.VALUE_CLASS]:{color:e.tooltipItemValueFillColor,marginLeft:"30px"}}},label:{style:{textAnchor:"center",textOffset:[0,0],fill:e.labelFillColor,fontSize:e.labelFontSize,fontFamily:e.fontFamily,fillColorDark:e.labelFillColorDark,fillColorLight:e.labelFillColorLight}}}}}const ay={100:"#000",95:"#0D0D0D",85:"#262626",65:"#595959",45:"#8C8C8C",25:"#BFBFBF",15:"#D9D9D9",6:"#F0F0F0"},rVt={100:"#FFFFFF",95:"#F2F2F2",85:"#D9D9D9",65:"#A6A6A6",45:"#737373",25:"#404040",15:"#262626",6:"#0F0F0F"},nVt=["#5B8FF9","#5AD8A6","#5D7092","#F6BD16","#6F5EF9","#6DC8EC","#945FB9","#FF9845","#1E9493","#FF99C3"],iVt=["#5B8FF9","#CDDDFD","#5AD8A6","#CDF3E4","#5D7092","#CED4DE","#F6BD16","#FCEBB9","#6F5EF9","#D3CEFD","#6DC8EC","#D3EEF9","#945FB9","#DECFEA","#FF9845","#FFE0C7","#1E9493","#BBDEDE","#FF99C3","#FFE0ED"],aVt=["#B8E1FF","#9AC5FF","#7DAAFF","#5B8FF9","#3D76DD","#085EC0","#0047A5","#00318A","#001D70"],Met=(e={})=>{const{mapStyle:t="light",subColor:r="rgba(0,0,0,0.05)",paletteQualitative10:n=nVt,paletteQualitative20:i=iVt,paletteSemanticRed:a="#F4664A",paletteSemanticGreen:o="#30BF78",paletteSemanticYellow:s="#FAAD14",paletteSequence:l=aVt,fontFamily:u=`"-apple-system", "Segoe UI", Roboto, "Helvetica Neue", Arial,
    "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol",
    "Noto Color Emoji"`}=e,{brandColor:c=n[0]}=e;return{mapStyle:t,brandColor:c,subColor:r,paletteQualitative10:n,paletteQualitative20:i,paletteSemanticRed:a,paletteSemanticGreen:o,paletteSemanticYellow:s,paletteSequence:l,fontFamily:u,legendContainerFillColor:"rgba(255, 255, 255, 0.85)",legendContainerShadow:"0 2px 8px 0 rgba(166, 166, 166, 0.20)",legendContainerBorderRadius:2,legendTextFillColor:ay[65],legendTextFontSize:12,tooltipContainerFillColor:"rgba(255, 255, 255, 0.9)",tooltipContainerShadow:"rgb(0 0 0 / 16%) 0px 6px 12px 0px",tooltipContainerBorderRadius:2,tooltipTextFillColor:ay[65],tooltipItemNameFillColor:ay[65],tooltipItemValueFillColor:ay[65],tooltipTextFontSize:12,tooltipTextLineHeight:"20px",labelFillColor:ay[65],labelFillColorDark:"#2c3542",labelFillColorLight:"#ffffff",labelFontSize:12,pointFillColor:c,pointFillOpacity:.95,pointSize:4,pointBorder:1,pointBorderColor:rVt[100],pointActiveBorderColor:ay[100],pointSelectedBorderColor:ay[100]}};Met();const oVt={100:"#000",95:"#0D0D0D",85:"#262626",65:"#595959",45:"#8C8C8C",25:"#BFBFBF",15:"#D9D9D9",6:"#F0F0F0"},oy={100:"#FFFFFF",95:"#F2F2F2",85:"#D9D9D9",65:"#A6A6A6",45:"#737373",25:"#404040",15:"#262626",6:"#0F0F0F"},SV=["#5B8FF9","#5AD8A6","#5D7092","#F6BD16","#E86452","#6DC8EC","#945FB9","#FF9845","#1E9493","#FF99C3"],sVt=["#5B8FF9","#CDDDFD","#5AD8A6","#CDF3E4","#5D7092","#CED4DE","#F6BD16","#FCEBB9","#E86452","#F8D0CB","#6DC8EC","#D3EEF9","#945FB9","#DECFEA","#FF9845","#FFE0C7","#1E9493","#BBDEDE","#FF99C3","#FFE0ED"],lVt=["#B8E1FF","#9AC5FF","#7DAAFF","#5B8FF9","#3D76DD","#085EC0","#0047A5","#00318A","#001D70"],Ret=(e={})=>{const{mapStyle:t="dark",subColor:r="rgba(255,255,255,0.05)",paletteQualitative10:n=SV,paletteQualitative20:i=sVt,paletteSemanticRed:a="#F4664A",paletteSemanticGreen:o="#30BF78",paletteSemanticYellow:s="#FAAD14",paletteSequence:l=lVt,fontFamily:u=`"-apple-system", "Segoe UI", Roboto, "Helvetica Neue", Arial,
    "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol",
    "Noto Color Emoji"`}=e,{brandColor:c=n[0]}=e;return{mapStyle:t,brandColor:c,subColor:r,paletteQualitative10:n,paletteQualitative20:i,paletteSemanticRed:a,paletteSemanticGreen:o,paletteSemanticYellow:s,paletteSequence:l,fontFamily:u,legendContainerFillColor:"rgba(31, 31, 31, 0.85)",legendContainerShadow:"0 2px 8px 0 rgba(166, 166, 166, 0.20)",legendContainerBorderRadius:2,legendTextFillColor:oy[65],legendTextFontSize:12,tooltipContainerFillColor:"rgba(31, 31, 31, 0.9)",tooltipContainerShadow:"0px 2px 4px rgba(0, 0, 0, 0.5)",tooltipContainerBorderRadius:2,tooltipTextFillColor:oy[65],tooltipItemNameFillColor:oy[65],tooltipItemValueFillColor:oy[65],tooltipTextFontSize:12,tooltipTextLineHeight:"20px",labelFillColor:oy[65],labelFillColorDark:"#2c3542",labelFillColorLight:"#ffffff",labelFontSize:12,pointFillColor:SV[0],pointFillOpacity:.95,pointSize:4,pointBorder:1,pointBorderColor:oVt[100],pointActiveBorderColor:oy[100],pointSelectedBorderColor:oy[100]}};Ret();function Iet(e){const{styleSheet:t={}}=e,r=hi(e,["styleSheet"]),n=Met(t);return Tr({},Aet(n),r)}function uVt(e){const{styleSheet:t={}}=e,r=hi(e,["styleSheet"]),n=Ret(t);return Tr({},Aet(n),r)}const TV=Iet({}),cVt=uVt({}),AV={default:TV,light:TV,dark:cVt};function EF(e="default"){return xt(AV,w_(e),AV.default)}const hVt=[{original:"loaded",adaptation:"scene-loaded"},{original:"resize",adaptation:"resize"},{original:"destroy",adaptation:"destroy"},{original:"resize",adaptation:"resize"}],fVt=["mapmove","movestart","moveend","zoomchange","zoomstart","zoomend","click","dblclick","contextmenu","mousemove","mousewheel","mouseover","mouseout","mouseup","mousedown","dragstart","dragging","dragend"],NA=["inited","add","remove","dataUpdate","click","unclick","dblclick","undblclick","contextmenu","uncontextmenu","mouseenter","mousemove","unmousemove","mouseout","mouseup","unmouseup","mousedown","uncontextmenu","unpick","legend","legend:color","legend:size"],MV=new Map,RV=new Map,IV=new Map,Let={map:{type:Cd.Amap},logo:!0};let Oet=class Pet extends S_{constructor(t){super(),this.inited=!1,this.sceneLoaded=!1,this.layersLoaded=!1,this.loaded=!1,this.layerGroup=new K4,this.options=Is({},this.getDefaultOptions(),t),this.lastOptions=this.options}getDefaultOptions(){return Pet.DefaultOptions}createContainer(t){const{width:r,height:n}=this.options,i=typeof t=="string"?document.getElementById(t):t;return i.style.position||(i.style.position="relative"),r&&(i.style.width||(i.style.width=`${r}px`)),n&&(i.style.height||(i.style.height=`${n}px`)),i}createTheme(){return qi(this.options.theme)?Is({},EF("default"),Iet(this.options.theme)):EF(this.options.theme)}createMap(){const t=this.options.map?this.options.map:Let.map,{type:r}=t,n=hi(t,["type"]),i=Object.assign({style:this.theme.mapStyle},n);return r===Cd.Amap?new K6t(i):r===Cd.AmapV1?new Q6t(i):r===Cd.AmapV2?new J6t(i):r===Cd.Mapbox?new q6t(i):new V6t(i)}createScene(){const{logo:t,antialias:r,preserveDrawingBuffer:n}=this.options,i=Ym(t)?{logoVisible:t}:{logoVisible:t==null?void 0:t.visible,logoPosition:t==null?void 0:t.position},a=Object.assign({antialias:r,preserveDrawingBuffer:n},i),o=this.createMap();return new aUt(Object.assign({id:this.container,map:o},a))}registerResources(){MV.size&&MV.forEach((t,r)=>{!this.scene.hasImage(r)&&this.scene.addImage(r,t)}),RV.size&&RV.forEach((t,r)=>{this.scene.addFontFace(r,t)}),IV.size&&IV.forEach((t,r)=>{this.scene.addIconFont(r,t)})}update(t){this.updateOption(t),t.map&&!zi(this.lastOptions.map,this.options.map)&&this.updateMap(t.map),this.render(),this.emit("update")}updateOption(t){this.lastOptions=this.options,this.options=Is({},this.options,t)}updateMap(t){var r;if(!this.scene)return;const{style:n,center:i,zoom:a,rotation:o,pitch:s}=t;iu(s)||this.scene.setPitch(s),iu(o)||this.scene.setRotation(o),n&&n!==((r=this.lastOptions.map)===null||r===void 0?void 0:r.style)&&this.scene.setMapStyle(n),a&&i&&this.scene.setZoomAndCenter(a,i)}changeSize(t,r){this.options.width===t&&this.options.height===r||(this.container.style.width=`${t}px`,this.container.style.height=`${r}px`,this.options=Object.assign(this.options,{width:t,height:r}))}on(t,r,n){return this.proxyEventHander("on",t,r,n),this}once(t,r){return this.proxyEventHander("once",t,r),this}off(t,r){return this.proxyEventHander("off",t,r),this}proxyEventHander(t,r,n,i){const a=hVt.find(o=>o.adaptation===r);if(a)this.scene[t](a.original,n);else if(fVt.indexOf(r)!==-1)this.scene[t](r,n);else if(r.includes("Layer:")){const[o,s]=r.split(":");if(this[o]&&this[o][t]&&NA.indexOf(s)!==-1)this[o][t](s,n);else throw new Error(`No event name "${r}"`)}else super[t](r,n,i)}getScene(){return this.scene}getMap(){var t,r,n,i;return((t=this.options.map)===null||t===void 0?void 0:t.type)===Cd.Amap?this.scene.map:((r=this.options.map)===null||r===void 0?void 0:r.type)===Cd.AmapV2?this.scene.map:((n=this.options.map)===null||n===void 0?void 0:n.type)===Cd.Mapbox?this.scene.map:((i=this.options.map)===null||i===void 0?void 0:i.type)===Cd.Map?this.scene.map:this.scene.map}addLayer(t){this.layerGroup.addLayer(t)}getLayes(){return console.warn("Replace to use getLayers()"),this.getLayers()}getLayers(){return this.layerGroup.getLayers()}getLayerByName(t){return this.layerGroup.getLayerByName(t)}removeLayer(t){return this.layerGroup.removeLayer(t)}removeAllLayer(){this.layerGroup.removeAllLayer()}zoomIn(){this.scene.zoomIn()}zoomOut(){this.scene.zoomOut()}setPitch(t){this.scene.setPitch(t)}fitBounds(t){this.scene.fitBounds(t)}setMapStatus(t){this.scene.setMapStatus(t)}setBgColor(t){this.scene.setBgColor(t)}initComponents(){this.initControls(),this.initTooltip()}updateComponents(){this.updateControls(),this.initTooltip()}initControls(){const{zoom:t,scale:r,layerMenu:n,legend:i}=this.options;r&&this.addScaleControl(r),t&&this.addZoomControl(t),n&&this.addLayerMenuControl(n),i&&(this.addLegendControl(i),this.emit("add-legend"))}updateControls(){const{zoom:t,scale:r,layerMenu:n,legend:i}=this.options;zi(this.lastOptions.zoom,t)||(t?this.updateZoomControl(t):this.removeZoomControl()),zi(this.lastOptions.scale,r)||(r?this.updateScaleControl(r):this.removeScaleControl()),zi(this.lastOptions.layerMenu,n)||(n?this.updateLayerMenuControl(n):this.removeLayerMenuControl()),zi(this.lastOptions.legend,i)||(i?this.updateLegendControl(i):this.removeLegendControl())}addZoomControl(t){this.zoomControl||(this.zoomControl=new nkt(t),this.scene.addControl(this.zoomControl))}updateZoomControl(t){if(!this.zoomControl){this.addZoomControl(t);return}this.removeZoomControl(),this.addZoomControl(t)}removeZoomControl(){this.zoomControl&&(this.zoomControl.remove(),this.zoomControl=void 0)}addScaleControl(t){this.scaleControl||(this.scaleControl=new fPt(t),this.scene.addControl(this.scaleControl))}updateScaleControl(t){if(!this.scaleControl){this.addScaleControl(t);return}this.removeScaleControl(),this.addScaleControl(t)}removeScaleControl(){this.scaleControl&&(this.scaleControl.remove(),this.scaleControl=void 0)}addLayerMenuControl(t){this.layerGroup.getLayers().forEach(({name:r,layer:n})=>{})}updateLayerMenuControl(t){this.removeLayerMenuControl(),this.addLayerMenuControl(t)}removeLayerMenuControl(){}getLegendOptions(){return{}}addLegendControl(t){if(this.legendControl)return;const r=this.theme.components.legend,n=Is({},this.getLegendOptions(),t),{type:i,position:a}=n,o=hi(n,["type","position"]),s=[];if(i==="category"){const l=Is({},{domStyles:r.category.domStyles},o);s.push({type:i,options:l})}else if(i==="continue"){const l=Is({},{domStyles:r.continue.domStyles},o);s.push({type:i,options:l})}s.length&&(this.legendControl=new ZHt({position:a,items:s}),this.scene.addControl(this.legendControl))}updateLegendControl(t){if(!this.legendControl){this.addLegendControl(t);return}this.removeLegendControl(),this.addLegendControl(t)}removeLegendControl(){this.legendControl&&(this.legendControl.remove(),this.legendControl=void 0)}initTooltip(){this.tooltip&&this.tooltip.destroy();const{tooltip:t}=this.options;if(t){const r=Is({},{domStyles:this.theme.components.tooltip.domStyles},t),n=this.layerGroup.getInteractionLayers();this.tooltip=new eVt(this.scene,n,r),this.tooltip.on("*",i=>this.emit(i.type,i))}}exportPng(t){return this.scene.exportPng(t)}destroy(){var t;super.off("*"),this.removeScaleControl(),this.removeZoomControl(),this.removeLayerMenuControl(),this.removeLegendControl(),(t=this.tooltip)===null||t===void 0||t.destroy(),this.scene.destroy()}};Oet.DefaultOptions=Let;class wF{static aggregation(t,r){const{type:n="grid",radius:i,method:a,field:o}=r,s={type:n,size:i,method:a,field:o};t.transforms?(t.transforms=t.transforms.filter(l=>l.type!==s.type),t.transforms.push(s)):t.transforms=[s]}}const Det=["name","zIndex","visible","minZoom","maxZoom","pickingBuffer","autoFit","blend"];class Qc extends S_{constructor(t){super(),this.options=Is({},this.getDefaultOptions(),t),this.lastOptions=this.options}getDefaultOptions(){return{}}pickLayerConfig(t){return Up(t,Det)}addTo(t){t.addLayer(this.layer)}remove(t){t.removeLayer(this.layer)}update(t){this.updateOption(t),this.updateConfig(t)}updateOption(t){this.lastOptions=this.options,this.options=Is({},this.options,t)}updateConfig(t){!iu(t.zIndex)&&!zi(this.lastOptions.zIndex,this.options.zIndex)&&this.setIndex(t.zIndex),!iu(t.blend)&&!zi(this.lastOptions.blend,this.options.blend)&&this.setBlend(t.blend),!iu(t.minZoom)&&!zi(this.lastOptions.minZoom,this.options.minZoom)&&this.setMinZoom(t.minZoom),!iu(t.maxZoom)&&!zi(this.lastOptions.maxZoom,this.options.maxZoom)&&this.setMinZoom(t.maxZoom),!iu(t.visible)&&!zi(this.lastOptions.visible,this.options.visible)&&(t.visible?this.show():this.hide())}render(){this.layer.renderLayers()}setSource(t){if(t instanceof fI)this.layer.setSource(t);else{const{data:r,aggregation:n}=t,i=hi(t,["data","aggregation"]);n&&wF.aggregation(i,n),this.layer.getSource()?this.layer.setData(r,i):this.layer.source(r,i)}}changeData(t){this.setSource(t)}setIndex(t){this.layer.setIndex(t)}setBlend(t){this.layer.setBlend(t)}setMinZoom(t){this.layer.setMinZoom(t)}setMaxZoom(t){this.layer.setMaxZoom(t)}show(){this.layer.inited&&this.layer.show()}hide(){this.layer.inited&&this.layer.hide()}toggleVisible(){this.isVisible()?this.hide():this.show()}isVisible(){return this.layer.inited?this.layer.isVisible():this.options.visible}fitBounds(t){this.layer.fitBounds(t)}on(t,r){return NA.indexOf(t)!==-1?this.layer.on(t,r):super.on(t,r),this}once(t,r){return NA.indexOf(t)!==-1?this.layer.once(t,r):super.once(t,r),this}off(t,r){return NA.indexOf(t)!==-1?this.layer.off(t,r):super.off(t,r),this}}Qc.LayerType=xF;Qc.LayerConfigkeys=Det;function sy(e,t){return(...r)=>{const n={};return e.forEach((i,a)=>{n[i]=r[a]}),delete n.undefined,t(n)}}class ki{static shape(t,r){if(nn(r))t.shape(r);else if($r(r)){const n=[];t.shape(n.join("*"),sy(n,r))}else if(qi(r)){const n=r.field?r.field:"";if($r(r.value)){const i=ze(n)?n:n.split("*");t.shape(n,sy(i,r.value))}else t.shape(n,r.value);nn(n)&&r.scale&&ki.scale(t,n,r.scale)}}static size(t,r){if(Gn(r))t.size(r);else if(ze(r))t.size(r);else if($r(r)){const n=[];t.size(n.join("*"),sy(n,r))}else if(qi(r)){const n=r.field?r.field:"";if($r(r.value)){const i=ze(n)?n:n.split("*");t.size(n,sy(i,r.value))}else t.size(n,r.value);nn(n)&&r.scale&&ki.scale(t,n,r.scale)}}static color(t,r){if(nn(r))t.color(r);else if($r(r)){const n=[];t.color(n.join("*"),sy(n,r))}else if(qi(r)){const n=r.field?r.field:"";if($r(r.value)){const i=ze(n)?n:n.split("*");t.color(n,sy(i,r.value))}else t.color(n,r.value);nn(n)&&r.scale&&ki.scale(t,n,r.scale)}}static style(t,r){r&&t.style(r)}static state(t,r){const{active:n,select:i}=r;n&&t.active(n),i&&t.select(i)}static rotate(t,r){nn(r)||$r(r)}static texture(t,r){nn(r)&&t.texture(r)}static animate(t,r){(Ym(r)||qi(r))&&t.animate(r)}static scale(t,r,n){t.scale(r,n)}static filter(t,r){const n=r.field?r.field:"",i=ze(n)?n:n.split("*");t.filter(i.join("*"),sy(i,r.value))}}function dVt(e,t){const{field:r,content:n,style:i={},state:a}=t,{fontSize:o,fill:s}=i,u={field:r||n||"",value:"text"};ki.shape(e,u),o&&ki.size(e,o),s&&ki.color(e,s),i&&ki.style(e,i),a&&ki.state(e,a)}const Fet={style:{fontSize:12}},pVt=[];class BI extends Qc{constructor(t){super(t),this.type=Qc.LayerType.TextLayer,this.interaction=!1;const{name:r,source:n}=this.options,i=this.pickLayerConfig(this.options);this.name=r||Gh(this.type),this.layer=new mC(Object.assign(Object.assign({},i),{name:this.name})),this.mappingLayer(this.layer,this.options),this.setSource(n)}getDefaultOptions(){return Fet}mappingLayer(t,r){dVt(t,r)}update(t){super.update(t),this.mappingLayer(this.layer,this.options)}}BI.DefaultOptions=Fet;BI.LayerOptionsKeys=Qc.LayerConfigkeys.concat(pVt);const vVt={autoFit:!1};let qm=class Bet extends Oet{constructor(t,r){if(typeof t=="string"||t instanceof Element){if(r===void 0)throw new Error("options is undefined");super(r),this.container=this.createContainer(t),this.theme=this.createTheme(),this.scene=this.createScene(),this.registerResources(),this.initSource()}else super(t)}initSource(){this.source=this.createSource(),this.render(),this.inited=!0}initLayersEvent(){}getDefaultOptions(){return Bet.DefaultOptions}createSource(){const t=this.options.source,{data:r,aggregation:n}=t,i=hi(t,["data","aggregation"]);return n&&wF.aggregation(i,n),new fI(r,i)}createLabelLayer(t,r,n){const{visible:i,minZoom:a,maxZoom:o,zIndex:s=0}=n||{};return new BI(Object.assign({name:"labelLayer",visible:i,minZoom:a,maxZoom:o,zIndex:s+.1,source:t},r))}updateLabelLayer(t,r,n,i){r?i?i.update(Object.assign({},r)):(i=this.createLabelLayer(t,r,n),this.layerGroup.addLayer(i)):r===!1&&i&&this.layerGroup.removeLayer(i)}render(){const t=this.createLayers(this.source);this.inited?(this.layerGroup.removeAllLayer(),t.addTo(this.scene),this.layerGroup=t):(this.layerGroup=t,this.scene.sceneService.loaded?this.onSceneLoaded():this.scene.once("loaded",()=>{this.onSceneLoaded()})),this.initLayersEvent()}onSceneLoaded(){this.sceneLoaded=!0,this.layerGroup.isEmpty()?this.onLayersLoaded():this.layerGroup.once("inited-all",()=>{this.onLayersLoaded()}),this.layerGroup.addTo(this.scene)}onLayersLoaded(){this.layersLoaded=!0,this.initComponents(),this.loaded=!0,this.emit("loaded")}attachToScene(t,r){this.scene=t,this.theme=r||EF("default"),this.registerResources(),this.initSource()}unattachFromScene(){var t;this.removeAllLayer(),(t=this.tooltip)===null||t===void 0||t.destroy()}addToScene(t){this.attachToScene(t)}removeFromScene(){var t;this.removeAllLayer(),this.removeScaleControl(),this.removeZoomControl(),this.removeLayerMenuControl(),this.removeLegendControl(),(t=this.tooltip)===null||t===void 0||t.destroy()}update(t){if(this.updateOption(t),t.map&&!zi(this.lastOptions.map,this.options.map)&&this.updateMap(t.map),this.scene.setEnableRender(!1),t.source&&!zi(this.lastOptions.source,this.options.source)){const r=t.source,{data:n}=r,i=hi(r,["data"]);this.changeData(n,i)}this.scene.setEnableRender(!0),this.render(),this.updateComponents(),this.emit("update")}changeData(t,r){this.options.source=Is({},this.options.source,Object.assign({data:t},r));const n=this.options.source,{aggregation:i}=n,a=hi(n,["aggregation"]);i&&wF.aggregation(a,i),this.source.setData(this.options.source.data,a);const o=this.options.legend;o&&setTimeout(()=>{this.updateLegendControl(o)},500),this.emit("change-data")}};qm.DefaultOptions=vVt;qm.PlotType=bF;const LV="#2f54eb",Dl={active:{fill:!1,stroke:LV,lineWidth:1.5,lineOpacity:.8},select:{fill:!1,stroke:LV,lineWidth:1.5,lineOpacity:.8}},bw=e=>(iu(e)||(e.active===!1?Dl.active=Object.assign(Dl.active,{fill:!1,stroke:!1}):typeof e.active=="object"&&(e.active.fill===!1?Dl.active.fill=!1:typeof e.active.fill=="string"&&(Dl.active.fill=e.active.fill),e.active.stroke===!1?Dl.active.stroke=!1:typeof e.active.stroke=="string"&&(Dl.active.stroke=e.active.stroke),typeof e.active.lineWidth=="number"&&(Dl.active.lineWidth=e.active.lineWidth),typeof e.active.lineOpacity=="number"&&(Dl.active.lineOpacity=e.active.lineOpacity)),e.select===!1?Dl.select=Object.assign(Dl.select,{fill:!1,stroke:!1}):typeof e.select=="object"&&(e.select.fill===!1?Dl.select.fill=!1:typeof e.select.fill=="string"&&(Dl.select.fill=e.select.fill),e.select.stroke===!1?Dl.select.stroke=!1:typeof e.select.stroke=="string"&&(Dl.select.stroke=e.select.stroke),typeof e.select.lineWidth=="number"&&(Dl.select.lineWidth=e.select.lineWidth),typeof e.select.lineOpacity=="number"&&(Dl.select.lineOpacity=e.select.lineOpacity))),Dl);function gVt(e,t,r,n,i,a){const{color:o,style:s,state:l}=a,u=bw(l),c={active:u.active.fill===!1?!1:{color:u.active.fill},select:!1},f={opacity:s==null?void 0:s.opacity},d=s==null?void 0:s.lineWidth,v=s==null?void 0:s.stroke,g={opacity:s==null?void 0:s.lineOpacity,dashArray:s==null?void 0:s.lineDash,lineType:s==null?void 0:s.lineType};if(ki.shape(e,"fill"),o&&ki.color(e,o),f&&ki.style(e,f),c&&ki.state(e,c),ki.shape(t,"line"),d&&ki.size(t,d),v&&ki.color(t,v),g&&ki.style(t,g),u.active.stroke){const x=u.active.stroke,w=u.active.lineWidth||d,S={opacity:u.active.lineOpacity};ki.shape(r,"line"),w&&ki.size(r,w),x&&ki.color(r,x),S&&ki.style(r,S)}if(u.select.fill){const x=u.select.fill;ki.shape(n,"fill"),x&&ki.color(n,x),f&&ki.style(n,f),ki.state(n,{select:!1,active:!1})}if(u.select.stroke){const x=u.select.stroke,w=u.select.lineWidth||d,S={opacity:u.select.lineOpacity};ki.shape(i,"line"),w&&ki.size(i,w),x&&ki.color(i,x),S&&ki.style(i,S)}}const mVt=e=>!Array.isArray(e[0].value),oN=e=>mVt(e)?e:e.map(r=>Object.assign(Object.assign({},r),{value:[n7(r.value[0],4),n7(r.value[1],4)]})),Net={visible:!0,state:{active:!1,select:!1},enabledMultiSelect:!1},yVt=["color","style","state","enabledMultiSelect"];class kw extends Qc{constructor(t){super(t),this.selectData=[],this.type=Qc.LayerType.AreaLayer,this.interaction=!0,this.onHighlighHandle=c=>{const{feature:f,featureId:d}=c;this.setHighlightLayerSource(f,d)},this.onUnhighlighHandle=()=>{this.setHighlightLayerSource()},this.onSelectHandle=c=>{const f=this.options.enabledMultiSelect,{feature:d,featureId:v}=c;let g=$l(this.selectData);const x=g.findIndex(w=>w.featureId===v);if(x===-1)f?g.push({feature:d,featureId:v}):g=[{feature:d,featureId:v}],this.emit("select",d,$l(g));else{const w=g[x];f?g.splice(x,1):g=[],this.emit("unselect",w,$l(g))}this.setSelectLayerSource(g)};const{name:r,source:n,visible:i,minZoom:a,maxZoom:o,zIndex:s=0}=this.options,l=this.pickLayerConfig(this.options),u=bw(this.options.state);this.name=r||Gh(this.type),this.layer=new OM(Object.assign(Object.assign({},l),{name:this.name})),this.strokeLayer=new hx({name:"strokeLayer",visible:i,zIndex:s,minZoom:a,maxZoom:o}),this.highlightLayer=new hx({name:"highlightLayer",visible:i&&!!u.active.stroke,zIndex:s+.1,minZoom:a,maxZoom:o}),this.selectFillLayer=new OM({name:"selectFillLayer",visible:i&&!!u.select.fill,zIndex:s+.1,minZoom:a,maxZoom:o}),this.selectStrokeLayer=new hx({name:"selectStrokeLayer",visible:i&&!!u.select.stroke,zIndex:s+.1,minZoom:a,maxZoom:o}),this.mappingLayer(this.options),this.setSource(n),this.initEvent()}getDefaultOptions(){return Net}mappingLayer(t){gVt(this.layer,this.strokeLayer,this.highlightLayer,this.selectFillLayer,this.selectStrokeLayer,t)}setSource(t){super.setSource(t),this.setStrokeLayerSource(),this.setHighlightLayerSource(),this.selectFillLayer.source({type:"FeatureCollection",features:[]},{parser:{type:"geojson"}}),this.selectStrokeLayer.source({type:"FeatureCollection",features:[]},{parser:{type:"geojson"}})}setStrokeLayerSource(){const t=this.layer.getSource();if(t)this.strokeLayer.setSource(t);else{const{data:r,options:n}=this.layer.sourceOption;this.strokeLayer.source(r,n)}}setHighlightLayerSource(t,r=-999){if(this.highlightLayerData===r)return;const n=t?[t]:[];this.highlightLayer.getSource()?this.highlightLayer.setData({type:"FeatureCollection",features:n},{parser:{type:"geojson"}}):this.highlightLayer.source({type:"FeatureCollection",features:[]},{parser:{type:"geojson"}}),this.highlightLayerData=r}setSelectLayerSource(t=[]){if(this.selectData.length===t.length&&zi(this.selectData.map(({featureId:n})=>n),t.map(({featureId:n})=>n)))return;const r=t.map(({feature:n})=>n);this.selectFillLayer.setData({type:"FeatureCollection",features:r},{parser:{type:"geojson"}}),this.selectStrokeLayer.setData({type:"FeatureCollection",features:r},{parser:{type:"geojson"}}),this.selectData=t}initEvent(){this.layer.off("mousemove",this.onHighlighHandle),this.layer.off("unmousemove",this.onHighlighHandle),this.layer.off("click",this.onSelectHandle),this.selectData=[],this.highlightLayerData=null,this.options.state&&(this.options.state.active&&(this.layer.on("mousemove",this.onHighlighHandle),this.layer.on("unmousemove",this.onUnhighlighHandle)),this.options.state.select&&this.layer.on("click",this.onSelectHandle))}addTo(t){t.addLayer(this.layer),t.addLayer(this.strokeLayer),t.addLayer(this.highlightLayer),t.addLayer(this.selectFillLayer),t.addLayer(this.selectStrokeLayer)}remove(t){t.removeLayer(this.layer),t.removeLayer(this.strokeLayer),t.removeLayer(this.highlightLayer),t.removeLayer(this.selectFillLayer),t.removeLayer(this.selectStrokeLayer)}update(t){if(super.update(t),this.mappingLayer(this.options),this.options.visible){!iu(t.state)&&!zi(this.lastOptions.state,this.options.state)&&this.updateHighlightLayer();const r=bw(this.options.state);r.active.stroke&&this.setHighlightLayerSource(),(r.select.fill||r.select.stroke)&&this.setSelectLayerSource()}this.initEvent()}updateHighlightLayer(){const t=bw(this.options.state),r=bw(this.lastOptions.state);r.active.stroke!==t.active.stroke&&(t.active.stroke?this.highlightLayer.show():this.highlightLayer.hide()),r.select.fill!==t.select.fill&&(t.select.fill?this.selectFillLayer.show():this.selectFillLayer.hide()),r.select.stroke!==t.select.stroke&&(t.select.stroke?this.selectStrokeLayer.show():this.selectStrokeLayer.hide())}setIndex(t){this.layer.setIndex(t),this.strokeLayer.setIndex(t),this.highlightLayer.setIndex(t+.1),this.selectFillLayer.setIndex(t+.1),this.selectStrokeLayer.setIndex(t+.1)}setMinZoom(t){this.layer.setMinZoom(t),this.strokeLayer.setMinZoom(t),this.highlightLayer.setMinZoom(t),this.selectFillLayer.setMinZoom(t),this.selectStrokeLayer.setMinZoom(t)}setMaxZoom(t){this.layer.setMaxZoom(t),this.strokeLayer.setMaxZoom(t),this.highlightLayer.setMaxZoom(t),this.selectFillLayer.setMaxZoom(t),this.selectStrokeLayer.setMaxZoom(t)}show(){this.layer.inited&&(this.layer.show(),this.strokeLayer.show(),this.selectFillLayer.show(),this.selectStrokeLayer.show())}hide(){this.layer.inited&&(this.layer.hide(),this.strokeLayer.hide(),this.selectFillLayer.hide(),this.selectStrokeLayer.hide())}getColorLegendItems(){const t=this.layer.getLegendItems("color");return Array.isArray(t)&&t.length!==0?oN(t):[]}setActive(t){}setSelect(t){}}kw.DefaultOptions=Net;kw.LayerOptionsKeys=Qc.LayerConfigkeys.concat(yVt);const ket=new Map;function _Vt(e,t){ket.set(e,t)}function xVt(e){return ket.get(e)}const bVt=Is({},qm.DefaultOptions,{source:{data:[],joinBy:{geoField:"adcode"}},viewLevel:{level:"country",adcode:"100000"},chinaBorder:!0}),O1={world:"country",country:"province",province:"city",city:"district",district:"district"},zet="https://gw.alipayobjects.com/os/alisis/geo-data-v0.1.2",CF=`${zet}/choropleth-data`,OV={national:{color:"red",width:1,opacity:1},dispute:{color:"red",width:1,opacity:.8,dashArray:[2,4]},coast:{color:"blue",width:.7,opacity:.8},hkm:{color:"gray",width:.7,opacity:.8,dashArray:[2,4]}};function EVt(e){return e}function wVt(e){if(e==null)return EVt;var t,r,n=e.scale[0],i=e.scale[1],a=e.translate[0],o=e.translate[1];return function(s,l){l||(t=r=0);var u=2,c=s.length,f=new Array(c);for(f[0]=(t+=s[0])*n+a,f[1]=(r+=s[1])*i+o;u<c;)f[u]=s[u],++u;return f}}function CVt(e,t){for(var r,n=e.length,i=n-t;i<--n;)r=e[i],e[i++]=e[n],e[n]=r}function SVt(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(r){return PV(e,r)})}:PV(e,t)}function PV(e,t){var r=t.id,n=t.bbox,i=t.properties==null?{}:t.properties,a=TVt(e,t);return r==null&&n==null?{type:"Feature",properties:i,geometry:a}:n==null?{type:"Feature",id:r,properties:i,geometry:a}:{type:"Feature",id:r,bbox:n,properties:i,geometry:a}}function TVt(e,t){var r=wVt(e.transform),n=e.arcs;function i(c,f){f.length&&f.pop();for(var d=n[c<0?~c:c],v=0,g=d.length;v<g;++v)f.push(r(d[v],v));c<0&&CVt(f,g)}function a(c){return r(c)}function o(c){for(var f=[],d=0,v=c.length;d<v;++d)i(c[d],f);return f.length<2&&f.push(f[0]),f}function s(c){for(var f=o(c);f.length<4;)f.push(f[0]);return f}function l(c){return c.map(s)}function u(c){var f=c.type,d;switch(f){case"GeometryCollection":return{type:f,geometries:c.geometries.map(u)};case"Point":d=a(c.coordinates);break;case"MultiPoint":d=c.coordinates.map(a);break;case"LineString":d=o(c.arcs);break;case"MultiLineString":d=c.arcs.map(o);break;case"Polygon":d=l(c.arcs);break;case"MultiPolygon":d=c.arcs.map(l);break;default:return null}return{type:f,coordinates:d}}return u(t)}const AVt=e=>{const t={url:CF,type:"topojson",extension:"topo.json"};return iu(e)||(typeof e=="string"?t.url=e:(t.url=(e==null?void 0:e.url)||CF,t.type=e.type,t.extension=e.type==="topojson"?"topo.json":"json")),t},MVt=e=>{try{return SVt(e,"json")}catch{throw new Error('Failed convert to geojson from topojson, topojson default layer name "json"')}},RVt=(e,t)=>{if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++){const{level:n,granularity:i}=e[r];if(t[r].level!==n||t[r].granularity!==i)return!1}return!0},DV=e=>Up(e,["source","color","style","state","label","tooltip"]);function IVt(e,t){const{shape:r,color:n,size:i,style:a,state:o,animate:s,texture:l}=t;r&&ki.shape(e,r),i&&ki.size(e,i),n&&ki.color(e,n),a&&ki.style(e,a),o&&ki.state(e,o),s&&ki.animate(e,s),l&&ki.texture(e,l)}const Uet={},LVt=["shape","color","size","style","state","animate"];class dx extends Qc{constructor(t){super(t),this.type=Qc.LayerType.LinesLayer,this.interaction=!0;const{name:r,source:n}=this.options,i=this.pickLayerConfig(this.options);this.name=r||Gh(this.type),this.layer=new hx(Object.assign(Object.assign({},i),{name:this.name})),this.mappingLayer(this.layer,this.options),this.setSource(n)}getDefaultOptions(){return Uet}mappingLayer(t,r){IVt(t,r)}update(t){super.update(t),this.mappingLayer(this.layer,this.options)}getColorLegendItems(){const t=this.layer.getLegendItems("color");return Array.isArray(t)&&t.length!==0?oN(t):[]}}dx.DefaultOptions=Uet;dx.LayerOptionsKeys=Qc.LayerConfigkeys.concat(LVt);const OVt=["color","size","style","state","animate"];class kA extends dx{constructor(){super(...arguments),this.type=dx.LayerType.PathLayer}getDefaultOptions(){return Is({},dx.DefaultOptions,{shape:"line"})}}kA.LayerOptionsKeys=dx.LayerConfigkeys.concat(OVt);const PVt=(e,t)=>{const{visible:r,minZoom:n,maxZoom:i,zIndex:a=0,chinaBorder:o}=t||{},s=typeof o=="object"?Is({},OV,o):OV,l=e.features.filter(({properties:g})=>["coast","national"].includes(g==null?void 0:g.type)),u=e.features.filter(({properties:g})=>(g==null?void 0:g.type)==="dispute"),c=e.features.filter(({properties:g})=>(g==null?void 0:g.type)==="hkm"),f=new kA({name:"chinaBoundaryLayer",visible:r,minZoom:n,maxZoom:i,zIndex:a+.1,source:{data:{type:"FeatureCollection",features:l},parser:{type:"geojson"}},color:{field:"type",value:({type:g})=>s[g].color},size:{field:"type",value:({type:g})=>s[g].width},style:{opacity:s.national.opacity}}),d=new kA({name:"chinaHkmBoundaryLayer",visible:r,minZoom:n,maxZoom:i,zIndex:a+.1,source:{data:{type:"FeatureCollection",features:c},parser:{type:"geojson"}},color:s.hkm.color,size:s.hkm.width,style:{opacity:s.hkm.opacity,lineType:"dash",dashArray:s.hkm.dashArray}}),v=new kA({name:"chinaDisputeBoundaryLayer",visible:r,minZoom:n,maxZoom:i,zIndex:a+.1,source:{data:{type:"FeatureCollection",features:u},parser:{type:"geojson"}},color:s.dispute.color,size:s.dispute.width,style:{opacity:s.dispute.opacity,lineType:"dash",dashArray:s.dispute.dashArray}});return{chinaBoundaryLayer:f,chinaHkmBoundaryLayer:d,chinaDisputeBoundaryLayer:v}};class Sb extends qm{constructor(){super(...arguments),this.type=qm.PlotType.Choropleth,this.chinaBoundaryData={type:"FeatureCollection",features:[]},this.currentDistrictData={type:"FeatureCollection",features:[]},this.drillSteps=[],this.drillStacks=[],this.onDrillDownHander=t=>{var r;const{steps:n,onDown:i}=this.options.drill,a=(r=t.feature)===null||r===void 0?void 0:r.properties,{adcode:o}=a;if(this.drillStacks.length===n.length+1)return;const s=this.drillStacks.slice(-1)[0],l=this.drillStacks.length-1,u=this.drillSteps[l],{level:c,granularity:f=O1[c]}=u,d=hi(u,["level","granularity"]),v={nativeEvent:!0,from:{level:s.level,adcode:s.adcode,granularity:s.granularity},to:{level:c,adcode:o,granularity:f,properties:a}},g=(x={})=>{const w={level:c,adcode:o,granularity:f},S=Is({},d,x);this.changeView(w,S).then(A=>{A&&(this.drillStacks.push(A),this.emit("drilldown",v))})};i?i(v.from,v.to,g):g()},this.onDrillUpHander=()=>{const{onUp:t}=this.options.drill;if(this.drillStacks.length===0||this.drillStacks.length===1)return;const n=this.drillStacks.length-1,i=this.drillStacks[n],a=this.drillStacks[n-1],o={nativeEvent:!0,from:{level:i.level,adcode:i.adcode,granularity:i.granularity},to:{level:a.level,adcode:a.adcode,granularity:a.granularity}},s=(l={})=>{const u=o.to,c=Is({},a.config,l);this.changeView(u,c).then(f=>{f&&(this.drillStacks.pop(),this.emit("drillup",o))})};t?t(o.from,o.to,s):s()}}initSource(){this.getInitDistrictData().then(()=>{this.source=this.createSource(),this.render(),this.inited=!0})}render(){if(this.inited)this.scene.setEnableRender(!0),this.scene.render();else{const t=this.createLayers(this.source);this.layerGroup=t,this.scene.sceneService.loaded?this.onSceneLoaded():this.scene.once("loaded",()=>{this.onSceneLoaded()}),this.initLayersEvent()}}update(t){var r,n,i;if(this.updateOption(t),t.map&&!zi(this.lastOptions.map,this.options.map)&&this.updateMap(t.map),t.drill&&t.drill.enabled!==!1&&!zi((r=this.lastOptions.drill)===null||r===void 0?void 0:r.steps,(n=this.options.drill)===null||n===void 0?void 0:n.steps)&&(this.drillReset(),this.initDrillEvent()),this.scene.setEnableRender(!1),t.viewLevel&&!zi(this.lastOptions.viewLevel,this.options.viewLevel)){const a=(i=t.source)===null||i===void 0?void 0:i.joinBy.geoData;this.getDistrictData(a).then(()=>{const o=this.options.source,{data:s}=o,l=hi(o,["data"]);this.changeData(s,l),this.updateLayers(t),this.render(),this.updateComponents(),this.emit("update")})}else{if(t.source&&!zi(this.lastOptions.source,this.options.source)){const a=this.options.source,{data:o}=a,s=hi(a,["data"]);this.changeData(o,s)}this.updateLayers(t),this.render(),this.updateComponents(),this.emit("update")}}getDefaultOptions(){return Sb.DefaultOptions}parserSourceConfig(t){const{data:r,joinBy:n}=t,i=hi(t,["data","joinBy"]),{sourceField:a,geoField:o,geoData:s}=n,l=s,u={type:"join",sourceField:a,targetField:o,data:r};return i.transforms?i.transforms.push(u):i.transforms=[u],i.parser&&delete i.parser,{data:l,sourceCFG:i}}createSource(){const{data:t,sourceCFG:r}=this.parserSourceConfig(this.options.source);return new fI(t,r)}changeData(t,r){this.options.source=Is({},this.options.source,Object.assign({data:t},r));const{data:n,sourceCFG:i}=this.parserSourceConfig(this.options.source);this.source.setData(n,i),this.emit("change-data")}createLayers(t){this.fillAreaLayer=new kw(Object.assign({name:"fillAreaLayer",source:t},Up(this.options,kw.LayerOptionsKeys)));const r=new K4([this.fillAreaLayer]);return this.options.chinaBorder&&this.createCountryBoundaryLayer(this.chinaBoundaryData,this.options).forEach(i=>r.addLayer(i)),this.options.label&&(this.labelLayer=this.createLabelLayer(t,this.options.label),r.addLayer(this.labelLayer)),r}createCountryBoundaryLayer(t,r){const{chinaBoundaryLayer:n,chinaHkmBoundaryLayer:i,chinaDisputeBoundaryLayer:a}=PVt(t,r);return this.chinaBoundaryLayer=n,this.chinaHkmBoundaryLayer=i,this.chinaDisputeBoundaryLayer=a,[n,i,a]}createLabelLayer(t,r){const n=t.originData.features.map(({properties:c})=>Object.assign({},c,{centroid:c.centroid||c.center})).filter(({centroid:c})=>c),{visible:i,minZoom:a,maxZoom:o,zIndex:s=0}=this.options,l=new BI(Object.assign({name:"labelLayer",source:{data:n,parser:{type:"json",coordinates:"centroid"},transforms:t.transforms},visible:i,minZoom:a,maxZoom:o,zIndex:s+.1},r)),u=()=>{const c=this.source.originData.features.map(({properties:f})=>f).filter(({centroid:f})=>f);l.layer.setData(c,{transforms:t.transforms})};return t.on("update",u),l.on("remove",()=>{t.off("update",u)}),l}updateLayers(t){const r=Up(t,kw.LayerOptionsKeys);this.fillAreaLayer.update(r);const n=()=>{this.createCountryBoundaryLayer(this.chinaBoundaryData,this.options).forEach(o=>this.layerGroup.addLayer(o))},i=()=>{this.chinaBoundaryLayer&&this.layerGroup.removeLayer(this.chinaBoundaryLayer),this.chinaHkmBoundaryLayer&&this.layerGroup.removeLayer(this.chinaHkmBoundaryLayer),this.chinaDisputeBoundaryLayer&&this.layerGroup.removeLayer(this.chinaDisputeBoundaryLayer)};t.chinaBorder?(this.chinaBoundaryLayer&&i(),n()):t.chinaBorder===!1&&i(),this.updateLabelLayer(this.source,t.label,this.options,this.labelLayer)}initLayersEvent(){this.initDrillEvent(),this.initLegendEvent()}initDrillEvent(){if(this.lastOptions.drill){const{triggerUp:a="unclick",triggerDown:o="click"}=this.lastOptions.drill;this.fillAreaLayer.off(a,this.onDrillUpHander),this.fillAreaLayer.off(o,this.onDrillDownHander)}if(!this.options.drill||this.options.drill.enabled===!1)return;const{steps:t,triggerUp:r="unclick",triggerDown:n="click"}=this.options.drill,i=t.map(a=>typeof a=="string"?{level:a,granularity:O1[a]}:(a.granularity||(a.granularity=O1[a.level]),a));if(RVt(i,this.drillSteps)||(this.drillSteps=i,this.drillStacks=[]),!this.drillStacks.length){const{level:a,adcode:o,granularity:s=O1[a]}=this.options.viewLevel,l=DV(this.options);this.drillStacks=[{level:a,adcode:o,granularity:s,config:l}]}this.fillAreaLayer.on(r,this.onDrillUpHander),this.fillAreaLayer.on(n,this.onDrillDownHander)}initLegendEvent(){const t=this.options.legend;if(!t)return;const r=()=>{this.updateLegendControl(t)};this.fillAreaLayer.on("legend:color",r)}drillReset(){this.drillStacks=[]}getCurrentDrillSteps(){return this.drillStacks.map(r=>Up(r,["level","adcode","granularity"]))}getLegendOptions(){const t=this.fillAreaLayer.getColorLegendItems();return t.length!==0?{type:"category",items:t}:{}}fetchData(t,r,n){return au(this,void 0,void 0,function*(){const i=`${r}_${t}_${n}`,a=xVt(i);if(a)return a;const{url:o,type:s,extension:l}=AVt(this.options.geoArea);let u;const c=this.options.customFetchGeoData;return c?u=yield c({url:o,level:t,adcode:r,granularity:n,extension:l}):u=yield(yield fetch(`${o}/${t}/${i}.${l}`)).json(),s==="topojson"&&(u=MVt(u)),_Vt(i,u),u})}getInitDistrictData(){return au(this,void 0,void 0,function*(){var t;const r=this.fetchData("country","100000","boundary"),n=(t=this.options.source)===null||t===void 0?void 0:t.joinBy.geoData;try{[this.chinaBoundaryData]=yield Promise.all([r,this.getDistrictData(n)])}catch(i){throw new Error(`Failed to get china boundary data，${i}`)}})}getDistrictData(t){return au(this,void 0,void 0,function*(){const{level:r,adcode:n,granularity:i=O1[r]}=this.options.viewLevel,a=t?Promise.resolve(t):this.fetchData(r,n,i);try{this.currentDistrictData=yield a,this.options.source=Is({},this.options.source,{joinBy:{geoData:this.currentDistrictData}})}catch(o){throw new Error(`Failed to get district data，${o}`)}})}drillDown(t,r={}){const n=this.drillStacks.slice(-1)[0],{level:i,adcode:a,granularity:o}=t,s={nativeEvent:!1,from:{level:n.level,adcode:n.adcode,granularity:n.granularity},to:{level:i,adcode:a,granularity:o}};this.changeView(t,r).then(l=>{l&&(this.drillStacks.push(l),this.emit("drilldown",s))})}drillUp(t={},r){const n=this.drillStacks.length;if([0,1].includes(n))return;const a=r?this.drillStacks.findIndex(g=>g.level===r):-1,o=a!==-1,s=o?a:n-2,l=this.drillStacks[s],{config:u}=l,c=hi(l,["config"]),f=Is({},u,t),d=this.drillStacks[this.drillStacks.length-1],v={nativeEvent:!1,from:{level:d.level,adcode:d.adcode,granularity:d.granularity},to:{level:c.level,adcode:c.adcode,granularity:c.granularity}};this.changeView(c,f).then(g=>{g&&(o?this.drillStacks.splice(a+1):this.drillStacks.pop(),this.emit("drillup",v))})}changeView(t){return au(this,arguments,void 0,function*(r,n={}){const{level:i,adcode:a,granularity:o=O1[i]}=r,s=yield this.fetchData(i,a,o);if(!s.features.length)return;const l=Is({},DV(this.options),n,{viewLevel:{level:i,adcode:a,granularity:o},source:{joinBy:{geoData:s}}});return this.update(l),{level:i,adcode:a,granularity:o,config:l}})}}Sb.DefaultOptions=bVt;Sb.GeoDataUrl=zet;Sb.GeoAreaUrl=CF;const G3e=Object.freeze(Object.defineProperty({__proto__:null,Choropleth:Sb},Symbol.toStringTag,{value:"Module"})),DVt=Is({},qm.DefaultOptions,{source:{data:[],parser:{type:"json",x:"x",y:"y"}}});function FVt(e,t){const{shape:r,color:n,size:i,style:a,state:o,animate:s}=t;r&&ki.shape(e,r),i&&ki.size(e,i),n&&ki.color(e,n),a&&ki.style(e,a),o&&ki.state(e,o),s&&ki.animate(e,s)}const $et={source:{data:[],parser:{type:"json",x:"x",y:"y"}},shape:"circle",size:12,color:"#5FD3A6"},BVt=["shape","color","size","style","state","animate"];class zw extends Qc{constructor(t){super(t),this.type=Qc.LayerType.DotLayer,this.interaction=!0;const{name:r,source:n}=this.options,i=this.pickLayerConfig(this.options);this.name=r||Gh(this.type),this.layer=new mC(Object.assign(Object.assign({},i),{name:this.name})),this.mappingLayer(this.layer,this.options),this.setSource(n)}getDefaultOptions(){return $et}mappingLayer(t,r){FVt(t,r)}update(t){super.update(t),this.mappingLayer(this.layer,this.options)}getColorLegendItems(){const t=this.layer.getLegendItems("color");return Array.isArray(t)&&t.length!==0?oN(t):[]}}zw.DefaultOptions=$et;zw.LayerOptionsKeys=Qc.LayerConfigkeys.concat(BVt);class sN extends qm{constructor(){super(...arguments),this.type=qm.PlotType.Dot}getDefaultOptions(){return sN.DefaultOptions}createLayers(t){this.dotLayer=new zw(Object.assign({source:t},Up(this.options,zw.LayerOptionsKeys)));const r=new K4([this.dotLayer]);return this.options.label&&(this.labelLayer=this.createLabelLayer(t,this.options.label,this.options),r.addLayer(this.labelLayer)),r}updateLayers(t){const r=Up(t,zw.LayerOptionsKeys);this.dotLayer.update(r),this.updateLabelLayer(this.source,t.label,this.options,this.labelLayer)}getLegendOptions(){const t=this.dotLayer.getColorLegendItems();return t.length!==0?{type:"category",items:t}:{}}}sN.DefaultOptions=DVt;var lN=Object.freeze({__proto__:null,get Base(){return qd},get Circle(){return njt},get Ellipse(){return ajt},get Image(){return bN},get Line(){return ljt},get Marker(){return hjt},get Path(){return EN},get Polygon(){return xjt},get Polyline(){return Ejt},get Rect(){return Tjt},get Text(){return Mjt}}),SF=function(e,t){return SF=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},SF(e,t)};function en(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");SF(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Zt=function(){return Zt=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},Zt.apply(this,arguments)};function NI(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function Gf(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function lr(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,a=[],o;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a}function NVt(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var a=arguments[t],o=0,s=a.length;o<s;o++,i++)n[i]=a[o];return n}function Vr(e,t,r){if(r||arguments.length===2)for(var n=0,i=t.length,a;n<i;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}var FV=function(e){return e!==null&&typeof e!="function"&&isFinite(e.length)},kVt={}.toString,kI=function(e,t){return kVt.call(e)==="[object "+t+"]"},e_=function(e){return kI(e,"Function")},xl=function(e){return e==null},Wf=function(e){return Array.isArray?Array.isArray(e):kI(e,"Array")},Uw=function(e){var t=typeof e;return e!==null&&t==="object"||t==="function"};function Ta(e,t){if(e){var r;if(Wf(e))for(var n=0,i=e.length;n<i&&(r=t(e[n],n),r!==!1);n++);else if(Uw(e)){for(var a in e)if(e.hasOwnProperty(a)&&(r=t(e[a],a),r===!1))break}}}var BV=function(e){return typeof e=="object"&&e!==null},Km=function(e){if(Wf(e))return e.reduce(function(t,r){return Math.max(t,r)},e[0])},Qm=function(e){if(Wf(e))return e.reduce(function(t,r){return Math.min(t,r)},e[0])},Hd=function(e){return kI(e,"String")},TF=function(e){return kI(e,"Number")},zVt=1e-5;function UVt(e,t,r){return r===void 0&&(r=zVt),Math.abs(e-t)<r}var Het=function(e,t){return(e%t+t)%t},$Vt=Math.PI/180,Vet=function(e){return $Vt*e},HVt=Object.values?function(e){return Object.values(e)}:function(e){var t=[];return Ta(e,function(r,n){e_(e)&&n==="prototype"||t.push(r)}),t},VVt=function(e){return xl(e)?"":e.toString()},Get=function(e){var t=VVt(e);return t.charAt(0).toUpperCase()+t.substring(1)};function GVt(e){var t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(r){return setTimeout(r,16)};return t(e)}function WVt(e){var t=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame||clearTimeout;t(e)}function UO(e,t){for(var r in t)t.hasOwnProperty(r)&&r!=="constructor"&&t[r]!==void 0&&(e[r]=t[r])}function Wet(e,t,r,n){return t&&UO(e,t),r&&UO(e,r),n&&UO(e,n),e}var XVt=function(e,t){if(!e_(e))throw new TypeError("Expected a function");var r=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var a=t?t.apply(this,n):n[0],o=r.cache;if(o.has(a))return o.get(a);var s=e.apply(this,n);return o.set(a,s),s};return r.cache=new Map,r},KM=function(e,t){if(e===t)return!0;if(!e||!t||Hd(e)||Hd(t))return!1;if(FV(e)||FV(t)){if(e.length!==t.length)return!1;for(var r=!0,n=0;n<e.length&&(r=KM(e[n],t[n]),!!r);n++);return r}if(BV(e)||BV(t)){var i=Object.keys(e),a=Object.keys(t);if(i.length!==a.length)return!1;for(var r=!0,n=0;n<i.length&&(r=KM(e[i[n]],t[i[n]]),!!r);n++);return r}return!1},PT={},jVt=function(e){return e=e||"g",PT[e]?PT[e]+=1:PT[e]=1,e+PT[e]},DT=function(){},FT;XVt(function(e,t){t===void 0&&(t={});var r=t.fontSize,n=t.fontFamily,i=t.fontWeight,a=t.fontStyle,o=t.fontVariant;return FT||(FT=document.createElement("canvas").getContext("2d")),FT.font=[a,o,i,r+"px",n].join(" "),FT.measureText(Hd(e)?e:"").width},function(e,t){return t===void 0&&(t={}),NVt([e],HVt(t)).join("")});var $w=`	
\v\f\r   ᠎             　\u2028\u2029`,YVt=new RegExp("([a-z])["+$w+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+$w+"]*,?["+$w+"]*)+)","ig"),ZVt=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+$w+"]*,?["+$w+"]*","ig"),Q1=function(e){if(!e)return null;if(Wf(e))return e;var t={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},r=[];return String(e).replace(YVt,function(n,i,a){var o=[],s=i.toLowerCase();if(a.replace(ZVt,function(l,u){u&&o.push(+u)}),s==="m"&&o.length>2&&(r.push([i].concat(o.splice(0,2))),s="l",i=i==="m"?"l":"L"),s==="o"&&o.length===1&&r.push([i,o[0]]),s==="r")r.push([i].concat(o));else for(;o.length>=t[s]&&(r.push([i].concat(o.splice(0,t[s]))),!!t[s]););return e}),r},AF=function(e,t){for(var r=[],n=0,i=e.length;i-2*!t>n;n+=2){var a=[{x:+e[n-2],y:+e[n-1]},{x:+e[n],y:+e[n+1]},{x:+e[n+2],y:+e[n+3]},{x:+e[n+4],y:+e[n+5]}];t?n?i-4===n?a[3]={x:+e[0],y:+e[1]}:i-2===n&&(a[2]={x:+e[0],y:+e[1]},a[3]={x:+e[2],y:+e[3]}):a[0]={x:+e[i-2],y:+e[i-1]}:i-4===n?a[3]=a[2]:n||(a[0]={x:+e[n],y:+e[n+1]}),r.push(["C",(-a[0].x+6*a[1].x+a[2].x)/6,(-a[0].y+6*a[1].y+a[2].y)/6,(a[1].x+6*a[2].x-a[3].x)/6,(a[1].y+6*a[2].y-a[3].y)/6,a[2].x,a[2].y])}return r},BT=function(e,t,r,n,i){var a=[];if(i===null&&n===null&&(n=r),e=+e,t=+t,r=+r,n=+n,i!==null){var o=Math.PI/180,s=e+r*Math.cos(-n*o),l=e+r*Math.cos(-i*o),u=t+r*Math.sin(-n*o),c=t+r*Math.sin(-i*o);a=[["M",s,u],["A",r,r,0,+(i-n>180),0,l,c]]}else a=[["M",e,t],["m",0,-n],["a",r,n,0,1,1,0,2*n],["a",r,n,0,1,1,0,-2*n],["z"]];return a},MF=function(e){if(e=Q1(e),!e||!e.length)return[["M",0,0]];var t=[],r=0,n=0,i=0,a=0,o=0,s,l;e[0][0]==="M"&&(r=+e[0][1],n=+e[0][2],i=r,a=n,o++,t[0]=["M",r,n]);for(var u=e.length===3&&e[0][0]==="M"&&e[1][0].toUpperCase()==="R"&&e[2][0].toUpperCase()==="Z",c=void 0,f=void 0,d=o,v=e.length;d<v;d++){if(t.push(c=[]),f=e[d],s=f[0],s!==s.toUpperCase())switch(c[0]=s.toUpperCase(),c[0]){case"A":c[1]=f[1],c[2]=f[2],c[3]=f[3],c[4]=f[4],c[5]=f[5],c[6]=+f[6]+r,c[7]=+f[7]+n;break;case"V":c[1]=+f[1]+n;break;case"H":c[1]=+f[1]+r;break;case"R":l=[r,n].concat(f.slice(1));for(var g=2,x=l.length;g<x;g++)l[g]=+l[g]+r,l[++g]=+l[g]+n;t.pop(),t=t.concat(AF(l,u));break;case"O":t.pop(),l=BT(r,n,f[1],f[2]),l.push(l[0]),t=t.concat(l);break;case"U":t.pop(),t=t.concat(BT(r,n,f[1],f[2],f[3])),c=["U"].concat(t[t.length-1].slice(-2));break;case"M":i=+f[1]+r,a=+f[2]+n;break;default:for(var g=1,x=f.length;g<x;g++)c[g]=+f[g]+(g%2?r:n)}else if(s==="R")l=[r,n].concat(f.slice(1)),t.pop(),t=t.concat(AF(l,u)),c=["R"].concat(f.slice(-2));else if(s==="O")t.pop(),l=BT(r,n,f[1],f[2]),l.push(l[0]),t=t.concat(l);else if(s==="U")t.pop(),t=t.concat(BT(r,n,f[1],f[2],f[3])),c=["U"].concat(t[t.length-1].slice(-2));else for(var w=0,S=f.length;w<S;w++)c[w]=f[w];if(s=s.toUpperCase(),s!=="O")switch(c[0]){case"Z":r=+i,n=+a;break;case"H":r=c[1];break;case"V":n=c[1];break;case"M":i=c[c.length-2],a=c[c.length-1];break;default:r=c[c.length-2],n=c[c.length-1]}}return t},NT=function(e,t,r,n){return[e,t,r,n,r,n]},NV=function(e,t,r,n,i,a){var o=.3333333333333333,s=2/3;return[o*e+s*r,o*t+s*n,o*i+s*r,o*a+s*n,i,a]},Xet=function(e,t,r,n,i,a,o,s,l,u){r===n&&(r+=1);var c=Math.PI*120/180,f=Math.PI/180*(+i||0),d=[],v,g,x,w,S,A=function(Gr,Mn,ee){var rr=Gr*Math.cos(ee)-Mn*Math.sin(ee),Nr=Gr*Math.sin(ee)+Mn*Math.cos(ee);return{x:rr,y:Nr}};if(u)g=u[0],x=u[1],w=u[2],S=u[3];else{v=A(e,t,-f),e=v.x,t=v.y,v=A(s,l,-f),s=v.x,l=v.y,e===s&&t===l&&(s+=1,l+=1);var M=(e-s)/2,R=(t-l)/2,O=M*M/(r*r)+R*R/(n*n);O>1&&(O=Math.sqrt(O),r=O*r,n=O*n);var N=r*r,k=n*n,V=(a===o?-1:1)*Math.sqrt(Math.abs((N*k-N*R*R-k*M*M)/(N*R*R+k*M*M)));w=V*r*R/n+(e+s)/2,S=V*-n*M/r+(t+l)/2,g=Math.asin(((t-S)/n).toFixed(9)),x=Math.asin(((l-S)/n).toFixed(9)),g=e<w?Math.PI-g:g,x=s<w?Math.PI-x:x,g<0&&(g=Math.PI*2+g),x<0&&(x=Math.PI*2+x),o&&g>x&&(g=g-Math.PI*2),!o&&x>g&&(x=x-Math.PI*2)}var Q=x-g;if(Math.abs(Q)>c){var Y=x,X=s,tt=l;x=g+c*(o&&x>g?1:-1),s=w+r*Math.cos(x),l=S+n*Math.sin(x),d=Xet(s,l,r,n,i,0,o,X,tt,[x,Y,w,S])}Q=x-g;var it=Math.cos(g),Et=Math.sin(g),Tt=Math.cos(x),pt=Math.sin(x),kt=Math.tan(Q/4),ae=4/3*r*kt,Kt=4/3*n*kt,re=[e,t],fe=[e+ae*Et,t-Kt*it],Oe=[s+ae*pt,l-Kt*Tt],Ye=[s,l];if(fe[0]=2*re[0]-fe[0],fe[1]=2*re[1]-fe[1],u)return[fe,Oe,Ye].concat(d);d=[fe,Oe,Ye].concat(d).join().split(",");for(var Be=[],De=0,Yr=d.length;De<Yr;De++)Be[De]=De%2?A(d[De-1],d[De],f).y:A(d[De],d[De+1],f).x;return Be},RF=function(e,t){var r=MF(e),n=t&&MF(t),i={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},a={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},o=[],s=[],l="",u="",c,f=function(M,R,O){var N,k;if(!M)return["C",R.x,R.y,R.x,R.y,R.x,R.y];switch(!(M[0]in{T:1,Q:1})&&(R.qx=R.qy=null),M[0]){case"M":R.X=M[1],R.Y=M[2];break;case"A":M=["C"].concat(Xet.apply(0,[R.x,R.y].concat(M.slice(1))));break;case"S":O==="C"||O==="S"?(N=R.x*2-R.bx,k=R.y*2-R.by):(N=R.x,k=R.y),M=["C",N,k].concat(M.slice(1));break;case"T":O==="Q"||O==="T"?(R.qx=R.x*2-R.qx,R.qy=R.y*2-R.qy):(R.qx=R.x,R.qy=R.y),M=["C"].concat(NV(R.x,R.y,R.qx,R.qy,M[1],M[2]));break;case"Q":R.qx=M[1],R.qy=M[2],M=["C"].concat(NV(R.x,R.y,M[1],M[2],M[3],M[4]));break;case"L":M=["C"].concat(NT(R.x,R.y,M[1],M[2]));break;case"H":M=["C"].concat(NT(R.x,R.y,M[1],R.y));break;case"V":M=["C"].concat(NT(R.x,R.y,R.x,M[1]));break;case"Z":M=["C"].concat(NT(R.x,R.y,R.X,R.Y));break}return M},d=function(M,R){if(M[R].length>7){M[R].shift();for(var O=M[R];O.length;)o[R]="A",n&&(s[R]="A"),M.splice(R++,0,["C"].concat(O.splice(0,6)));M.splice(R,1),c=Math.max(r.length,n&&n.length||0)}},v=function(M,R,O,N,k){M&&R&&M[k][0]==="M"&&R[k][0]!=="M"&&(R.splice(k,0,["M",N.x,N.y]),O.bx=0,O.by=0,O.x=M[k][1],O.y=M[k][2],c=Math.max(r.length,n&&n.length||0))};c=Math.max(r.length,n&&n.length||0);for(var g=0;g<c;g++){r[g]&&(l=r[g][0]),l!=="C"&&(o[g]=l,g&&(u=o[g-1])),r[g]=f(r[g],i,u),o[g]!=="A"&&l==="C"&&(o[g]="C"),d(r,g),n&&(n[g]&&(l=n[g][0]),l!=="C"&&(s[g]=l,g&&(u=s[g-1])),n[g]=f(n[g],a,u),s[g]!=="A"&&l==="C"&&(s[g]="C"),d(n,g)),v(r,n,i,a,g),v(n,r,a,i,g);var x=r[g],w=n&&n[g],S=x.length,A=n&&w.length;i.x=x[S-2],i.y=x[S-1],i.bx=parseFloat(x[S-4])||i.x,i.by=parseFloat(x[S-3])||i.y,a.bx=n&&(parseFloat(w[A-4])||a.x),a.by=n&&(parseFloat(w[A-3])||a.y),a.x=n&&w[A-2],a.y=n&&w[A-1]}return n?[r,n]:r},qVt=/,?([a-z]),?/gi,jet=function(e){return e.join(",").replace(qVt,"$1")},kV=function(e,t,r,n,i){var a=-3*t+9*r-9*n+3*i,o=e*a+6*t-12*r+6*n;return e*o-3*t+3*r},zV=function(e,t,r,n,i,a,o,s,l){l===null&&(l=1),l=l>1?1:l<0?0:l;for(var u=l/2,c=12,f=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],d=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],v=0,g=0;g<c;g++){var x=u*f[g]+u,w=kV(x,e,r,i,o),S=kV(x,t,n,a,s),A=w*w+S*S;v+=d[g]*Math.sqrt(A)}return u*v},KVt=function(e,t,r,n,i,a,o,s){for(var l=[],u=[[],[]],c,f,d,v,g=0;g<2;++g){if(g===0?(f=6*e-12*r+6*i,c=-3*e+9*r-9*i+3*o,d=3*r-3*e):(f=6*t-12*n+6*a,c=-3*t+9*n-9*a+3*s,d=3*n-3*t),Math.abs(c)<1e-12){if(Math.abs(f)<1e-12)continue;v=-d/f,v>0&&v<1&&l.push(v);continue}var x=f*f-4*d*c,w=Math.sqrt(x);if(!(x<0)){var S=(-f+w)/(2*c);S>0&&S<1&&l.push(S);var A=(-f-w)/(2*c);A>0&&A<1&&l.push(A)}}for(var M=l.length,R=M,O;M--;)v=l[M],O=1-v,u[0][M]=O*O*O*e+3*O*O*v*r+3*O*v*v*i+v*v*v*o,u[1][M]=O*O*O*t+3*O*O*v*n+3*O*v*v*a+v*v*v*s;return u[0][R]=e,u[1][R]=t,u[0][R+1]=o,u[1][R+1]=s,u[0].length=u[1].length=R+2,{min:{x:Math.min.apply(0,u[0]),y:Math.min.apply(0,u[1])},max:{x:Math.max.apply(0,u[0]),y:Math.max.apply(0,u[1])}}},QVt=function(e,t,r,n,i,a,o,s){if(!(Math.max(e,r)<Math.min(i,o)||Math.min(e,r)>Math.max(i,o)||Math.max(t,n)<Math.min(a,s)||Math.min(t,n)>Math.max(a,s))){var l=(e*n-t*r)*(i-o)-(e-r)*(i*s-a*o),u=(e*n-t*r)*(a-s)-(t-n)*(i*s-a*o),c=(e-r)*(a-s)-(t-n)*(i-o);if(c){var f=l/c,d=u/c,v=+f.toFixed(2),g=+d.toFixed(2);if(!(v<+Math.min(e,r).toFixed(2)||v>+Math.max(e,r).toFixed(2)||v<+Math.min(i,o).toFixed(2)||v>+Math.max(i,o).toFixed(2)||g<+Math.min(t,n).toFixed(2)||g>+Math.max(t,n).toFixed(2)||g<+Math.min(a,s).toFixed(2)||g>+Math.max(a,s).toFixed(2)))return{x:f,y:d}}}},lm=function(e,t,r){return t>=e.x&&t<=e.x+e.width&&r>=e.y&&r<=e.y+e.height},Yet=function(e,t,r,n,i){if(i)return[["M",+e+ +i,t],["l",r-i*2,0],["a",i,i,0,0,1,i,i],["l",0,n-i*2],["a",i,i,0,0,1,-i,i],["l",i*2-r,0],["a",i,i,0,0,1,-i,-i],["l",0,i*2-n],["a",i,i,0,0,1,i,-i],["z"]];var a=[["M",e,t],["l",r,0],["l",0,n],["l",-r,0],["z"]];return a.parsePathArray=jet,a},IF=function(e,t,r,n){return e===null&&(e=t=r=n=0),t===null&&(t=e.y,r=e.width,n=e.height,e=e.x),{x:e,y:t,width:r,w:r,height:n,h:n,x2:e+r,y2:t+n,cx:e+r/2,cy:t+n/2,r1:Math.min(r,n)/2,r2:Math.max(r,n)/2,r0:Math.sqrt(r*r+n*n)/2,path:Yet(e,t,r,n),vb:[e,t,r,n].join(" ")}},JVt=function(e,t){return e=IF(e),t=IF(t),lm(t,e.x,e.y)||lm(t,e.x2,e.y)||lm(t,e.x,e.y2)||lm(t,e.x2,e.y2)||lm(e,t.x,t.y)||lm(e,t.x2,t.y)||lm(e,t.x,t.y2)||lm(e,t.x2,t.y2)||(e.x<t.x2&&e.x>t.x||t.x<e.x2&&t.x>e.x)&&(e.y<t.y2&&e.y>t.y||t.y<e.y2&&t.y>e.y)},UV=function(e,t,r,n,i,a,o,s){Wf(e)||(e=[e,t,r,n,i,a,o,s]);var l=KVt.apply(null,e);return IF(l.min.x,l.min.y,l.max.x-l.min.x,l.max.y-l.min.y)},$V=function(e,t,r,n,i,a,o,s,l){var u=1-l,c=Math.pow(u,3),f=Math.pow(u,2),d=l*l,v=d*l,g=c*e+f*3*l*r+u*3*l*l*i+v*o,x=c*t+f*3*l*n+u*3*l*l*a+v*s,w=e+2*l*(r-e)+d*(i-2*r+e),S=t+2*l*(n-t)+d*(a-2*n+t),A=r+2*l*(i-r)+d*(o-2*i+r),M=n+2*l*(a-n)+d*(s-2*a+n),R=u*e+l*r,O=u*t+l*n,N=u*i+l*o,k=u*a+l*s,V=90-Math.atan2(w-A,S-M)*180/Math.PI;return{x:g,y:x,m:{x:w,y:S},n:{x:A,y:M},start:{x:R,y:O},end:{x:N,y:k},alpha:V}},tGt=function(e,t,r){var n=UV(e),i=UV(t);if(!JVt(n,i))return r?0:[];for(var a=zV.apply(0,e),o=zV.apply(0,t),s=~~(a/8),l=~~(o/8),u=[],c=[],f={},d=r?0:[],v=0;v<s+1;v++){var g=$V.apply(0,e.concat(v/s));u.push({x:g.x,y:g.y,t:v/s})}for(var v=0;v<l+1;v++){var g=$V.apply(0,t.concat(v/l));c.push({x:g.x,y:g.y,t:v/l})}for(var v=0;v<s;v++)for(var x=0;x<l;x++){var w=u[v],S=u[v+1],A=c[x],M=c[x+1],R=Math.abs(S.x-w.x)<.001?"y":"x",O=Math.abs(M.x-A.x)<.001?"y":"x",N=QVt(w.x,w.y,S.x,S.y,A.x,A.y,M.x,M.y);if(N){if(f[N.x.toFixed(4)]===N.y.toFixed(4))continue;f[N.x.toFixed(4)]=N.y.toFixed(4);var k=w.t+Math.abs((N[R]-w[R])/(S[R]-w[R]))*(S.t-w.t),V=A.t+Math.abs((N[O]-A[O])/(M[O]-A[O]))*(M.t-A.t);k>=0&&k<=1&&V>=0&&V<=1&&(r?d+=1:d.push({x:N.x,y:N.y,t1:k,t2:V}))}}return d},eGt=function(e,t,r){e=RF(e),t=RF(t);for(var n,i,a,o,s,l,u,c,f,d,v=r?0:[],g=0,x=e.length;g<x;g++){var w=e[g];if(w[0]==="M")n=s=w[1],i=l=w[2];else{w[0]==="C"?(f=[n,i].concat(w.slice(1)),n=f[6],i=f[7]):(f=[n,i,n,i,s,l,s,l],n=s,i=l);for(var S=0,A=t.length;S<A;S++){var M=t[S];if(M[0]==="M")a=u=M[1],o=c=M[2];else{M[0]==="C"?(d=[a,o].concat(M.slice(1)),a=d[6],o=d[7]):(d=[a,o,a,o,u,c,u,c],a=u,o=c);var R=tGt(f,d,r);if(r)v+=R;else{for(var O=0,N=R.length;O<N;O++)R[O].segment1=g,R[O].segment2=S,R[O].bez1=f,R[O].bez2=d;v=v.concat(R)}}}}}return v},rGt=function(e,t){return eGt(e,t)};function nGt(e,t){var r=[],n=[];function i(a,o){if(a.length===1)r.push(a[0]),n.push(a[0]);else{for(var s=[],l=0;l<a.length-1;l++)l===0&&r.push(a[0]),l===a.length-2&&n.push(a[l+1]),s[l]=[(1-o)*a[l][0]+o*a[l+1][0],(1-o)*a[l][1]+o*a[l+1][1]];i(s,o)}}return e.length&&i(e,t),{left:r,right:n.reverse()}}function iGt(e,t,r){var n=[[e[1],e[2]]];r=r||2;var i=[];t[0]==="A"?(n.push(t[6]),n.push(t[7])):t[0]==="C"?(n.push([t[1],t[2]]),n.push([t[3],t[4]]),n.push([t[5],t[6]])):t[0]==="S"||t[0]==="Q"?(n.push([t[1],t[2]]),n.push([t[3],t[4]])):n.push([t[1],t[2]]);for(var a=n,o=1/r,s=0;s<r-1;s++){var l=o/(1-o*s),u=nGt(a,l);i.push(u.left),a=u.right}i.push(a);var c=i.map(function(f){var d=[];return f.length===4&&(d.push("C"),d=d.concat(f[2])),f.length>=3&&(f.length===3&&d.push("Q"),d=d.concat(f[1])),f.length===2&&d.push("L"),d=d.concat(f[f.length-1]),d});return c}var aGt=function(e,t,r){if(r===1)return[[].concat(e)];var n=[];if(t[0]==="L"||t[0]==="C"||t[0]==="Q")n=n.concat(iGt(e,t,r));else{var i=[].concat(e);i[0]==="M"&&(i[0]="L");for(var a=0;a<=r-1;a++)n.push(i)}return n},oGt=function(e,t){if(e.length===1)return e;var r=e.length-1,n=t.length-1,i=r/n,a=[];if(e.length===1&&e[0][0]==="M"){for(var o=0;o<n-r;o++)e.push(e[0]);return e}for(var o=0;o<n;o++){var s=Math.floor(i*o);a[s]=(a[s]||0)+1}var l=a.reduce(function(u,c,f){return f===r?u.concat(e[r]):u.concat(aGt(e[f],e[f+1],c))},[]);return l.unshift(e[0]),(t[n]==="Z"||t[n]==="z")&&l.push("Z"),l},sGt=function(e,t){if(e.length!==t.length)return!1;var r=!0;return Ta(e,function(n,i){if(n!==t[i])return r=!1,!1}),r};function lGt(e,t,r){var n=null,i=r;return t<i&&(i=t,n="add"),e<i&&(i=e,n="del"),{type:n,min:i}}var uGt=function(e,t){var r=e.length,n=t.length,i,a,o=0;if(r===0||n===0)return null;for(var s=[],l=0;l<=r;l++)s[l]=[],s[l][0]={min:l};for(var u=0;u<=n;u++)s[0][u]={min:u};for(var l=1;l<=r;l++){i=e[l-1];for(var u=1;u<=n;u++){a=t[u-1],sGt(i,a)?o=0:o=1;var c=s[l-1][u].min+1,f=s[l][u-1].min+1,d=s[l-1][u-1].min+o;s[l][u]=lGt(c,f,d)}}return s},Zet=function(e,t){var r=uGt(e,t),n=e.length,i=t.length,a=[],o=1,s=1;if(r[n][i].min!==n){for(var l=1;l<=n;l++){var u=r[l][l].min;s=l;for(var c=o;c<=i;c++)r[l][c].min<u&&(u=r[l][c].min,s=c);o=s,r[l][o].type&&a.push({index:l-1,type:r[l][o].type})}for(var l=a.length-1;l>=0;l--)o=a[l].index,a[l].type==="add"?e.splice(o,0,[].concat(e[o])):e.splice(o,1)}n=e.length;var f=i-n;if(n<i)for(var l=0;l<f;l++)e[n-1][0]==="z"||e[n-1][0]==="Z"?e.splice(n-2,0,e[n-2]):e.push(e[n-1]),n+=1;return e};function $O(e,t,r){for(var n=[].concat(e),i,a=1/(r+1),o=qet(t)[0],s=1;s<=r;s++)a*=s,i=Math.floor(e.length*a),i===0?n.unshift([o[0]*a+e[i][0]*(1-a),o[1]*a+e[i][1]*(1-a)]):n.splice(i,0,[o[0]*a+e[i][0]*(1-a),o[1]*a+e[i][1]*(1-a)]);return n}function qet(e){var t=[];switch(e[0]){case"M":t.push([e[1],e[2]]);break;case"L":t.push([e[1],e[2]]);break;case"A":t.push([e[6],e[7]]);break;case"Q":t.push([e[3],e[4]]),t.push([e[1],e[2]]);break;case"T":t.push([e[1],e[2]]);break;case"C":t.push([e[5],e[6]]),t.push([e[1],e[2]]),t.push([e[3],e[4]]);break;case"S":t.push([e[3],e[4]]),t.push([e[1],e[2]]);break;case"H":t.push([e[1],e[1]]);break;case"V":t.push([e[1],e[1]]);break}return t}var LF=function(e,t){if(e.length<=1)return e;for(var r,n=0;n<t.length;n++)if(e[n][0]!==t[n][0])switch(r=qet(e[n]),t[n][0]){case"M":e[n]=["M"].concat(r[0]);break;case"L":e[n]=["L"].concat(r[0]);break;case"A":e[n]=[].concat(t[n]),e[n][6]=r[0][0],e[n][7]=r[0][1];break;case"Q":if(r.length<2)if(n>0)r=$O(r,e[n-1],1);else{e[n]=t[n];break}e[n]=["Q"].concat(r.reduce(function(i,a){return i.concat(a)},[]));break;case"T":e[n]=["T"].concat(r[0]);break;case"C":if(r.length<3)if(n>0)r=$O(r,e[n-1],2);else{e[n]=t[n];break}e[n]=["C"].concat(r.reduce(function(i,a){return i.concat(a)},[]));break;case"S":if(r.length<2)if(n>0)r=$O(r,e[n-1],1);else{e[n]=t[n];break}e[n]=["S"].concat(r.reduce(function(i,a){return i.concat(a)},[]));break;default:e[n]=t[n]}return e},cGt=Object.freeze({__proto__:null,catmullRomToBezier:AF,fillPath:oGt,fillPathByDiff:Zet,formatPath:LF,intersection:rGt,parsePathArray:jet,parsePathString:Q1,pathToAbsolute:MF,pathToCurve:RF,rectPath:Yet}),hGt=function(){function e(t,r){this.bubbles=!0,this.target=null,this.currentTarget=null,this.delegateTarget=null,this.delegateObject=null,this.defaultPrevented=!1,this.propagationStopped=!1,this.shape=null,this.fromShape=null,this.toShape=null,this.propagationPath=[],this.type=t,this.name=t,this.originalEvent=r,this.timeStamp=r.timeStamp}return e.prototype.preventDefault=function(){this.defaultPrevented=!0,this.originalEvent.preventDefault&&this.originalEvent.preventDefault()},e.prototype.stopPropagation=function(){this.propagationStopped=!0},e.prototype.toString=function(){var t=this.type;return"[Event (type="+t+")]"},e.prototype.save=function(){},e.prototype.restore=function(){},e}(),fGt="*",zI=function(){function e(){this._events={}}return e.prototype.on=function(t,r,n){return this._events[t]||(this._events[t]=[]),this._events[t].push({callback:r,once:!!n}),this},e.prototype.once=function(t,r){return this.on(t,r,!0)},e.prototype.emit=function(t){for(var r=this,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var a=this._events[t]||[],o=this._events[fGt]||[],s=function(l){for(var u=l.length,c=0;c<u;c++)if(l[c]){var f=l[c],d=f.callback,v=f.once;v&&(l.splice(c,1),l.length===0&&delete r._events[t],u--,c--),d.apply(r,n)}};s(a),s(o)},e.prototype.off=function(t,r){if(!t)this._events={};else if(!r)delete this._events[t];else{for(var n=this._events[t]||[],i=n.length,a=0;a<i;a++)n[a].callback===r&&(n.splice(a,1),i--,a--);n.length===0&&delete this._events[t]}return this},e.prototype.getEvents=function(){return this._events},e}();function Ket(e,t){var r=e.indexOf(t);r!==-1&&e.splice(r,1)}var HV=typeof window<"u"&&typeof window.document<"u";function Qet(e,t){if(e.isCanvas())return!0;for(var r=t.getParent(),n=!1;r;){if(r===e){n=!0;break}r=r.getParent()}return n}function OF(e){return e.cfg.visible&&e.cfg.capture}var dGt=function(e){en(t,e);function t(r){var n=e.call(this)||this;n.destroyed=!1;var i=n.getDefaultCfg();return n.cfg=Wet(i,r),n}return t.prototype.getDefaultCfg=function(){return{}},t.prototype.get=function(r){return this.cfg[r]},t.prototype.set=function(r,n){this.cfg[r]=n},t.prototype.destroy=function(){this.cfg={destroyed:!0},this.off(),this.destroyed=!0},t}(zI),VV=function(e,t,r){if(r||arguments.length===2)for(var n=0,i=t.length,a;n<i;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))},pGt=function(){function e(t,r,n){this.name=t,this.version=r,this.os=n,this.type="browser"}return e}(),vGt=function(){function e(t){this.version=t,this.type="node",this.name="node",this.os=process.platform}return e}(),gGt=function(){function e(t,r,n,i){this.name=t,this.version=r,this.os=n,this.bot=i,this.type="bot-device"}return e}(),mGt=function(){function e(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return e}(),yGt=function(){function e(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return e}(),_Gt=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,xGt=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,GV=3,bGt=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",_Gt]],WV=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function EGt(e){return e?XV(e):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new yGt:typeof navigator<"u"?XV(navigator.userAgent):SGt()}function wGt(e){return e!==""&&bGt.reduce(function(t,r){var n=r[0],i=r[1];if(t)return t;var a=i.exec(e);return!!a&&[n,a]},!1)}function XV(e){var t=wGt(e);if(!t)return null;var r=t[0],n=t[1];if(r==="searchbot")return new mGt;var i=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);i?i.length<GV&&(i=VV(VV([],i,!0),TGt(GV-i.length),!0)):i=[];var a=i.join("."),o=CGt(e),s=xGt.exec(e);return s&&s[1]?new gGt(r,a,o,s[1]):new pGt(r,a,o)}function CGt(e){for(var t=0,r=WV.length;t<r;t++){var n=WV[t],i=n[0],a=n[1],o=a.exec(e);if(o)return i}return null}function SGt(){var e=typeof process<"u"&&process.version;return e?new vGt(process.version.slice(1)):null}function TGt(e){for(var t=[],r=0;r<e;r++)t.push("0");return t}var QM=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});function UI(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],f=t[8],d=r[0],v=r[1],g=r[2],x=r[3],w=r[4],S=r[5],A=r[6],M=r[7],R=r[8];return e[0]=d*n+v*o+g*u,e[1]=d*i+v*s+g*c,e[2]=d*a+v*l+g*f,e[3]=x*n+w*o+S*u,e[4]=x*i+w*s+S*c,e[5]=x*a+w*l+S*f,e[6]=A*n+M*o+R*u,e[7]=A*i+M*s+R*c,e[8]=A*a+M*l+R*f,e}function AGt(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e}function MGt(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=-r,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function RGt(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function IGt(){var e=new QM(3);return QM!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function LGt(e,t,r){var n=t[0],i=t[1],a=t[2];return e[0]=n*r[0]+i*r[3]+a*r[6],e[1]=n*r[1]+i*r[4]+a*r[7],e[2]=n*r[2]+i*r[5]+a*r[8],e}(function(){var e=IGt();return function(t,r,n,i,a,o){var s,l;for(r||(r=3),n||(n=0),i?l=Math.min(i*r+n,t.length):l=t.length,s=n;s<l;s+=r)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],a(e,e,o),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2];return t}})();function OGt(){var e=new QM(2);return QM!=Float32Array&&(e[0]=0,e[1]=0),e}function PGt(e,t){var r=t[0],n=t[1],i=r*r+n*n;return i>0&&(i=1/Math.sqrt(i)),e[0]=t[0]*i,e[1]=t[1]*i,e}function DGt(e,t){return e[0]*t[0]+e[1]*t[1]}function FGt(e,t){return e[0]===t[0]&&e[1]===t[1]}(function(){var e=OGt();return function(t,r,n,i,a,o){var s,l;for(r||(r=2),n||(n=0),i?l=Math.min(i*r+n,t.length):l=t.length,s=n;s<l;s+=r)e[0]=t[s],e[1]=t[s+1],a(e,e,o),t[s]=e[0],t[s+1]=e[1];return t}})();function BGt(e,t,r){var n=[0,0,0,0,0,0,0,0,0];return AGt(n,r),UI(e,n,t)}function NGt(e,t,r){var n=[0,0,0,0,0,0,0,0,0];return MGt(n,r),UI(e,n,t)}function kGt(e,t,r){var n=[0,0,0,0,0,0,0,0,0];return RGt(n,r),UI(e,n,t)}function zGt(e,t,r){return UI(e,r,t)}function Jet(e,t){for(var r=e?[].concat(e):[1,0,0,0,1,0,0,0,1],n=0,i=t.length;n<i;n++){var a=t[n];switch(a[0]){case"t":BGt(r,r,[a[1],a[2]]);break;case"s":kGt(r,r,[a[1],a[2]]);break;case"r":NGt(r,r,a[1]);break;case"m":zGt(r,r,a[1]);break}}return r}function jV(e,t){var r=[],n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],f=e[8],d=t[0],v=t[1],g=t[2],x=t[3],w=t[4],S=t[5],A=t[6],M=t[7],R=t[8];return r[0]=d*n+v*o+g*u,r[1]=d*i+v*s+g*c,r[2]=d*a+v*l+g*f,r[3]=x*n+w*o+S*u,r[4]=x*i+w*s+S*c,r[5]=x*a+w*l+S*f,r[6]=A*n+M*o+R*u,r[7]=A*i+M*s+R*c,r[8]=A*a+M*l+R*f,r}function Cy(e,t){var r=[],n=t[0],i=t[1];return r[0]=e[0]*n+e[3]*i+e[6],r[1]=e[1]*n+e[4]*i+e[7],r}function trt(e){var t=[],r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],f=c*o-s*u,d=-c*a+s*l,v=u*a-o*l,g=r*f+n*d+i*v;return g?(g=1/g,t[0]=f*g,t[1]=(-c*n+i*u)*g,t[2]=(s*n-i*o)*g,t[3]=d*g,t[4]=(c*r-i*l)*g,t[5]=(-s*r+i*a)*g,t[6]=v*g,t[7]=(-u*r+n*l)*g,t[8]=(o*r-n*a)*g,t):null}var YE=Jet,HO="matrix",UGt=["zIndex","capture","visible","type"],$Gt=["repeat"],HGt=":",VGt="*";function GGt(e){for(var t=[],r=0;r<e.length;r++)Wf(e[r])?t.push([].concat(e[r])):t.push(e[r]);return t}function WGt(e,t){var r={},n=t.attrs;for(var i in e)r[i]=n[i];return r}function XGt(e,t){var r={},n=t.attr();return Ta(e,function(i,a){$Gt.indexOf(a)===-1&&!KM(n[a],i)&&(r[a]=i)}),r}function jGt(e,t){if(t.onFrame)return e;var r=t.startTime,n=t.delay,i=t.duration,a=Object.prototype.hasOwnProperty;return Ta(e,function(o){r+n<o.startTime+o.delay+o.duration&&i>o.delay&&Ta(t.toAttrs,function(s,l){a.call(o.toAttrs,l)&&(delete o.toAttrs[l],delete o.fromAttrs[l])})}),e}var ert=function(e){en(t,e);function t(r){var n=e.call(this,r)||this;n.attrs={};var i=n.getDefaultAttrs();return Wet(i,r.attrs),n.attrs=i,n.initAttrs(i),n.initAnimate(),n}return t.prototype.getDefaultCfg=function(){return{visible:!0,capture:!0,zIndex:0}},t.prototype.getDefaultAttrs=function(){return{matrix:this.getDefaultMatrix(),opacity:1}},t.prototype.onCanvasChange=function(r){},t.prototype.initAttrs=function(r){},t.prototype.initAnimate=function(){this.set("animable",!0),this.set("animating",!1)},t.prototype.isGroup=function(){return!1},t.prototype.getParent=function(){return this.get("parent")},t.prototype.getCanvas=function(){return this.get("canvas")},t.prototype.attr=function(){for(var r,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var a=n[0],o=n[1];if(!a)return this.attrs;if(Uw(a)){for(var s in a)this.setAttr(s,a[s]);return this.afterAttrsChange(a),this}return n.length===2?(this.setAttr(a,o),this.afterAttrsChange((r={},r[a]=o,r)),this):this.attrs[a]},t.prototype.isClipped=function(r,n){var i=this.getClip();return i&&!i.isHit(r,n)},t.prototype.setAttr=function(r,n){var i=this.attrs[r];i!==n&&(this.attrs[r]=n,this.onAttrChange(r,n,i))},t.prototype.onAttrChange=function(r,n,i){r==="matrix"&&this.set("totalMatrix",null)},t.prototype.afterAttrsChange=function(r){if(this.cfg.isClipShape){var n=this.cfg.applyTo;n&&n.onCanvasChange("clip")}else this.onCanvasChange("attr")},t.prototype.show=function(){return this.set("visible",!0),this.onCanvasChange("show"),this},t.prototype.hide=function(){return this.set("visible",!1),this.onCanvasChange("hide"),this},t.prototype.setZIndex=function(r){this.set("zIndex",r);var n=this.getParent();return n&&n.sort(),this},t.prototype.toFront=function(){var r=this.getParent();if(r){var n=r.getChildren();this.get("el");var i=n.indexOf(this);n.splice(i,1),n.push(this),this.onCanvasChange("zIndex")}},t.prototype.toBack=function(){var r=this.getParent();if(r){var n=r.getChildren();this.get("el");var i=n.indexOf(this);n.splice(i,1),n.unshift(this),this.onCanvasChange("zIndex")}},t.prototype.remove=function(r){r===void 0&&(r=!0);var n=this.getParent();n?(Ket(n.getChildren(),this),n.get("clearing")||this.onCanvasChange("remove")):this.onCanvasChange("remove"),r&&this.destroy()},t.prototype.resetMatrix=function(){this.attr(HO,this.getDefaultMatrix()),this.onCanvasChange("matrix")},t.prototype.getMatrix=function(){return this.attr(HO)},t.prototype.setMatrix=function(r){this.attr(HO,r),this.onCanvasChange("matrix")},t.prototype.getTotalMatrix=function(){var r=this.cfg.totalMatrix;if(!r){var n=this.attr("matrix"),i=this.cfg.parentMatrix;i&&n?r=jV(i,n):r=n||i,this.set("totalMatrix",r)}return r},t.prototype.applyMatrix=function(r){var n=this.attr("matrix"),i=null;r&&n?i=jV(r,n):i=n||r,this.set("totalMatrix",i),this.set("parentMatrix",r)},t.prototype.getDefaultMatrix=function(){return null},t.prototype.applyToMatrix=function(r){var n=this.attr("matrix");return n?Cy(n,r):r},t.prototype.invertFromMatrix=function(r){var n=this.attr("matrix");if(n){var i=trt(n);if(i)return Cy(i,r)}return r},t.prototype.setClip=function(r){var n=this.getCanvas(),i=null;if(r){var a=this.getShapeBase(),o=Get(r.type),s=a[o];s&&(i=new s({type:r.type,isClipShape:!0,applyTo:this,attrs:r.attrs,canvas:n}))}return this.set("clipShape",i),this.onCanvasChange("clip"),i},t.prototype.getClip=function(){var r=this.cfg.clipShape;return r||null},t.prototype.clone=function(){var r=this,n=this.attrs,i={};Ta(n,function(s,l){Wf(n[l])?i[l]=GGt(n[l]):i[l]=n[l]});var a=this.constructor,o=new a({attrs:i});return Ta(UGt,function(s){o.set(s,r.get(s))}),o},t.prototype.destroy=function(){var r=this.destroyed;r||(this.attrs={},e.prototype.destroy.call(this))},t.prototype.isAnimatePaused=function(){return this.get("_pause").isPaused},t.prototype.animate=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];if(!(!this.get("timeline")&&!this.get("canvas"))){this.set("animating",!0);var i=this.get("timeline");i||(i=this.get("canvas").get("timeline"),this.set("timeline",i));var a=this.get("animations")||[];i.timer||i.initTimer();var o=r[0],s=r[1],l=r[2],u=l===void 0?"easeLinear":l,c=r[3],f=c===void 0?DT:c,d=r[4],v=d===void 0?0:d,g,x,w,S,A;e_(o)?(g=o,o={}):Uw(o)&&o.onFrame&&(g=o.onFrame,x=o.repeat),Uw(s)?(A=s,s=A.duration,u=A.easing||"easeLinear",v=A.delay||0,x=A.repeat||x||!1,f=A.callback||DT,w=A.pauseCallback||DT,S=A.resumeCallback||DT):(TF(f)&&(v=f,f=null),e_(u)?(f=u,u="easeLinear"):u=u||"easeLinear");var M=XGt(o,this),R={fromAttrs:WGt(M,this),toAttrs:M,duration:s,easing:u,repeat:x,callback:f,pauseCallback:w,resumeCallback:S,delay:v,startTime:i.getTime(),id:jVt(),onFrame:g,pathFormatted:!1};a.length>0?a=jGt(a,R):i.addAnimator(this),a.push(R),this.set("animations",a),this.set("_pause",{isPaused:!1})}},t.prototype.stopAnimate=function(r){var n=this;r===void 0&&(r=!0);var i=this.get("animations");Ta(i,function(a){r&&(a.onFrame?n.attr(a.onFrame(1)):n.attr(a.toAttrs)),a.callback&&a.callback()}),this.set("animating",!1),this.set("animations",[])},t.prototype.pauseAnimate=function(){var r=this.get("timeline"),n=this.get("animations"),i=r.getTime();return Ta(n,function(a){a._paused=!0,a._pauseTime=i,a.pauseCallback&&a.pauseCallback()}),this.set("_pause",{isPaused:!0,pauseTime:i}),this},t.prototype.resumeAnimate=function(){var r=this.get("timeline"),n=r.getTime(),i=this.get("animations"),a=this.get("_pause").pauseTime;return Ta(i,function(o){o.startTime=o.startTime+(n-a),o._paused=!1,o._pauseTime=null,o.resumeCallback&&o.resumeCallback()}),this.set("_pause",{isPaused:!1}),this.set("animations",i),this},t.prototype.emitDelegation=function(r,n){var i=this,a=n.propagationPath;this.getEvents();var o;r==="mouseenter"?o=n.fromShape:r==="mouseleave"&&(o=n.toShape);for(var s=function(f){var d=a[f],v=d.get("name");if(v){if((d.isGroup()||d.isCanvas&&d.isCanvas())&&o&&Qet(d,o))return"break";Wf(v)?Ta(v,function(g){i.emitDelegateEvent(d,g,n)}):l.emitDelegateEvent(d,v,n)}},l=this,u=0;u<a.length;u++){var c=s(u);if(c==="break")break}},t.prototype.emitDelegateEvent=function(r,n,i){var a=this.getEvents(),o=n+HGt+i.type;(a[o]||a[VGt])&&(i.name=o,i.currentTarget=r,i.delegateTarget=this,i.delegateObject=r.get("delegateObject"),this.emit(o,i))},t.prototype.translate=function(r,n){r===void 0&&(r=0),n===void 0&&(n=0);var i=this.getMatrix(),a=YE(i,[["t",r,n]]);return this.setMatrix(a),this},t.prototype.move=function(r,n){var i=this.attr("x")||0,a=this.attr("y")||0;return this.translate(r-i,n-a),this},t.prototype.moveTo=function(r,n){return this.move(r,n)},t.prototype.scale=function(r,n){var i=this.getMatrix(),a=YE(i,[["s",r,n||r]]);return this.setMatrix(a),this},t.prototype.rotate=function(r){var n=this.getMatrix(),i=YE(n,[["r",r]]);return this.setMatrix(i),this},t.prototype.rotateAtStart=function(r){var n=this.attr(),i=n.x,a=n.y,o=this.getMatrix(),s=YE(o,[["t",-i,-a],["r",r],["t",i,a]]);return this.setMatrix(s),this},t.prototype.rotateAtPoint=function(r,n,i){var a=this.getMatrix(),o=YE(a,[["t",-r,-n],["r",i],["t",r,n]]);return this.setMatrix(o),this},t}(dGt),YV={},PF="_INDEX";function rrt(e,t){if(e.set("canvas",t),e.isGroup()){var r=e.get("children");r.length&&r.forEach(function(n){rrt(n,t)})}}function nrt(e,t){if(e.set("timeline",t),e.isGroup()){var r=e.get("children");r.length&&r.forEach(function(n){nrt(n,t)})}}function YGt(e,t,r){r===void 0&&(r=!0),r?t.destroy():(t.set("parent",null),t.set("canvas",null)),Ket(e.getChildren(),t)}function ZGt(e){return function(t,r){var n=e(t,r);return n===0?t[PF]-r[PF]:n}}var irt=function(e){en(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.isCanvas=function(){return!1},t.prototype.getBBox=function(){var r=1/0,n=-1/0,i=1/0,a=-1/0,o=this.getChildren().filter(function(l){return l.get("visible")&&(!l.isGroup()||l.isGroup()&&l.getChildren().length>0)});o.length>0?Ta(o,function(l){var u=l.getBBox(),c=u.minX,f=u.maxX,d=u.minY,v=u.maxY;c<r&&(r=c),f>n&&(n=f),d<i&&(i=d),v>a&&(a=v)}):(r=0,n=0,i=0,a=0);var s={x:r,y:i,minX:r,minY:i,maxX:n,maxY:a,width:n-r,height:a-i};return s},t.prototype.getCanvasBBox=function(){var r=1/0,n=-1/0,i=1/0,a=-1/0,o=this.getChildren().filter(function(l){return l.get("visible")&&(!l.isGroup()||l.isGroup()&&l.getChildren().length>0)});o.length>0?Ta(o,function(l){var u=l.getCanvasBBox(),c=u.minX,f=u.maxX,d=u.minY,v=u.maxY;c<r&&(r=c),f>n&&(n=f),d<i&&(i=d),v>a&&(a=v)}):(r=0,n=0,i=0,a=0);var s={x:r,y:i,minX:r,minY:i,maxX:n,maxY:a,width:n-r,height:a-i};return s},t.prototype.getDefaultCfg=function(){var r=e.prototype.getDefaultCfg.call(this);return r.children=[],r},t.prototype.onAttrChange=function(r,n,i){if(e.prototype.onAttrChange.call(this,r,n,i),r==="matrix"){var a=this.getTotalMatrix();this._applyChildrenMarix(a)}},t.prototype.applyMatrix=function(r){var n=this.getTotalMatrix();e.prototype.applyMatrix.call(this,r);var i=this.getTotalMatrix();i!==n&&this._applyChildrenMarix(i)},t.prototype._applyChildrenMarix=function(r){var n=this.getChildren();Ta(n,function(i){i.applyMatrix(r)})},t.prototype.addShape=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i=r[0],a=r[1];Uw(i)?a=i:a.type=i;var o=YV[a.type];o||(o=Get(a.type),YV[a.type]=o);var s=this.getShapeBase(),l=new s[o](a);return this.add(l),l},t.prototype.addGroup=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i=r[0],a=r[1],o;if(e_(i))a?o=new i(a):o=new i({parent:this});else{var s=i||{},l=this.getGroupBase();o=new l(s)}return this.add(o),o},t.prototype.getCanvas=function(){var r;return this.isCanvas()?r=this:r=this.get("canvas"),r},t.prototype.getShape=function(r,n,i){if(!OF(this))return null;var a=this.getChildren(),o;if(this.isCanvas())o=this._findShape(a,r,n,i);else{var s=[r,n,1];s=this.invertFromMatrix(s),this.isClipped(s[0],s[1])||(o=this._findShape(a,s[0],s[1],i))}return o},t.prototype._findShape=function(r,n,i,a){for(var o=null,s=r.length-1;s>=0;s--){var l=r[s];if(OF(l)&&(l.isGroup()?o=l.getShape(n,i,a):l.isHit(n,i)&&(o=l)),o)break}return o},t.prototype.add=function(r){var n=this.getCanvas(),i=this.getChildren(),a=this.get("timeline"),o=r.getParent();o&&YGt(o,r,!1),r.set("parent",this),n&&rrt(r,n),a&&nrt(r,a),i.push(r),r.onCanvasChange("add"),this._applyElementMatrix(r)},t.prototype._applyElementMatrix=function(r){var n=this.getTotalMatrix();n&&r.applyMatrix(n)},t.prototype.getChildren=function(){return this.get("children")},t.prototype.sort=function(){var r=this.getChildren();Ta(r,function(n,i){return n[PF]=i,n}),r.sort(ZGt(function(n,i){return n.get("zIndex")-i.get("zIndex")})),this.onCanvasChange("sort")},t.prototype.clear=function(){if(this.set("clearing",!0),!this.destroyed){for(var r=this.getChildren(),n=r.length-1;n>=0;n--)r[n].destroy();this.set("children",[]),this.onCanvasChange("clear"),this.set("clearing",!1)}},t.prototype.destroy=function(){this.get("destroyed")||(this.clear(),e.prototype.destroy.call(this))},t.prototype.getFirst=function(){return this.getChildByIndex(0)},t.prototype.getLast=function(){var r=this.getChildren();return this.getChildByIndex(r.length-1)},t.prototype.getChildByIndex=function(r){var n=this.getChildren();return n[r]},t.prototype.getCount=function(){var r=this.getChildren();return r.length},t.prototype.contain=function(r){var n=this.getChildren();return n.indexOf(r)>-1},t.prototype.removeChild=function(r,n){n===void 0&&(n=!0),this.contain(r)&&r.remove(n)},t.prototype.findAll=function(r){var n=[],i=this.getChildren();return Ta(i,function(a){r(a)&&n.push(a),a.isGroup()&&(n=n.concat(a.findAll(r)))}),n},t.prototype.find=function(r){var n=null,i=this.getChildren();return Ta(i,function(a){if(r(a)?n=a:a.isGroup()&&(n=a.find(r)),n)return!1}),n},t.prototype.findById=function(r){return this.find(function(n){return n.get("id")===r})},t.prototype.findByClassName=function(r){return this.find(function(n){return n.get("className")===r})},t.prototype.findAllByName=function(r){return this.findAll(function(n){return n.get("name")===r})},t}(ert),Yx=0,Ew=0,ZE=0,art=1e3,JM,ww,tR=0,r_=0,$I=0,SC=typeof performance=="object"&&performance.now?performance:Date,ort=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function srt(){return r_||(ort(qGt),r_=SC.now()+$I)}function qGt(){r_=0}function DF(){this._call=this._time=this._next=null}DF.prototype=uN.prototype={constructor:DF,restart:function(e,t,r){if(typeof e!="function")throw new TypeError("callback is not a function");r=(r==null?srt():+r)+(t==null?0:+t),!this._next&&ww!==this&&(ww?ww._next=this:JM=this,ww=this),this._call=e,this._time=r,FF()},stop:function(){this._call&&(this._call=null,this._time=1/0,FF())}};function uN(e,t,r){var n=new DF;return n.restart(e,t,r),n}function KGt(){srt(),++Yx;for(var e=JM,t;e;)(t=r_-e._time)>=0&&e._call.call(null,t),e=e._next;--Yx}function ZV(){r_=(tR=SC.now())+$I,Yx=Ew=0;try{KGt()}finally{Yx=0,JGt(),r_=0}}function QGt(){var e=SC.now(),t=e-tR;t>art&&($I-=t,tR=e)}function JGt(){for(var e,t=JM,r,n=1/0;t;)t._call?(n>t._time&&(n=t._time),e=t,t=t._next):(r=t._next,t._next=null,t=e?e._next=r:JM=r);ww=e,FF(n)}function FF(e){if(!Yx){Ew&&(Ew=clearTimeout(Ew));var t=e-r_;t>24?(e<1/0&&(Ew=setTimeout(ZV,e-SC.now()-$I)),ZE&&(ZE=clearInterval(ZE))):(ZE||(tR=SC.now(),ZE=setInterval(QGt,art)),Yx=1,ort(ZV))}}function cN(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function lrt(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function LS(){}var TC=.7,eR=1/TC,px="\\s*([+-]?\\d+)\\s*",AC="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",$p="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",tWt=/^#([0-9a-f]{3,8})$/,eWt=new RegExp(`^rgb\\(${px},${px},${px}\\)$`),rWt=new RegExp(`^rgb\\(${$p},${$p},${$p}\\)$`),nWt=new RegExp(`^rgba\\(${px},${px},${px},${AC}\\)$`),iWt=new RegExp(`^rgba\\(${$p},${$p},${$p},${AC}\\)$`),aWt=new RegExp(`^hsl\\(${AC},${$p},${$p}\\)$`),oWt=new RegExp(`^hsla\\(${AC},${$p},${$p},${AC}\\)$`),qV={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};cN(LS,MC,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:KV,formatHex:KV,formatHex8:sWt,formatHsl:lWt,formatRgb:QV,toString:QV});function KV(){return this.rgb().formatHex()}function sWt(){return this.rgb().formatHex8()}function lWt(){return urt(this).formatHsl()}function QV(){return this.rgb().formatRgb()}function MC(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=tWt.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?JV(t):r===3?new Xc(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?kT(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?kT(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=eWt.exec(e))?new Xc(t[1],t[2],t[3],1):(t=rWt.exec(e))?new Xc(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=nWt.exec(e))?kT(t[1],t[2],t[3],t[4]):(t=iWt.exec(e))?kT(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=aWt.exec(e))?rG(t[1],t[2]/100,t[3]/100,1):(t=oWt.exec(e))?rG(t[1],t[2]/100,t[3]/100,t[4]):qV.hasOwnProperty(e)?JV(qV[e]):e==="transparent"?new Xc(NaN,NaN,NaN,0):null}function JV(e){return new Xc(e>>16&255,e>>8&255,e&255,1)}function kT(e,t,r,n){return n<=0&&(e=t=r=NaN),new Xc(e,t,r,n)}function uWt(e){return e instanceof LS||(e=MC(e)),e?(e=e.rgb(),new Xc(e.r,e.g,e.b,e.opacity)):new Xc}function BF(e,t,r,n){return arguments.length===1?uWt(e):new Xc(e,t,r,n??1)}function Xc(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}cN(Xc,BF,lrt(LS,{brighter(e){return e=e==null?eR:Math.pow(eR,e),new Xc(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?TC:Math.pow(TC,e),new Xc(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Xc(Fy(this.r),Fy(this.g),Fy(this.b),rR(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:tG,formatHex:tG,formatHex8:cWt,formatRgb:eG,toString:eG}));function tG(){return`#${Sy(this.r)}${Sy(this.g)}${Sy(this.b)}`}function cWt(){return`#${Sy(this.r)}${Sy(this.g)}${Sy(this.b)}${Sy((isNaN(this.opacity)?1:this.opacity)*255)}`}function eG(){const e=rR(this.opacity);return`${e===1?"rgb(":"rgba("}${Fy(this.r)}, ${Fy(this.g)}, ${Fy(this.b)}${e===1?")":`, ${e})`}`}function rR(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Fy(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Sy(e){return e=Fy(e),(e<16?"0":"")+e.toString(16)}function rG(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Md(e,t,r,n)}function urt(e){if(e instanceof Md)return new Md(e.h,e.s,e.l,e.opacity);if(e instanceof LS||(e=MC(e)),!e)return new Md;if(e instanceof Md)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),a=Math.max(t,r,n),o=NaN,s=a-i,l=(a+i)/2;return s?(t===a?o=(r-n)/s+(r<n)*6:r===a?o=(n-t)/s+2:o=(t-r)/s+4,s/=l<.5?a+i:2-a-i,o*=60):s=l>0&&l<1?0:o,new Md(o,s,l,e.opacity)}function hWt(e,t,r,n){return arguments.length===1?urt(e):new Md(e,t,r,n??1)}function Md(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}cN(Md,hWt,lrt(LS,{brighter(e){return e=e==null?eR:Math.pow(eR,e),new Md(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?TC:Math.pow(TC,e),new Md(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new Xc(VO(e>=240?e-240:e+120,i,n),VO(e,i,n),VO(e<120?e+240:e-120,i,n),this.opacity)},clamp(){return new Md(nG(this.h),zT(this.s),zT(this.l),rR(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=rR(this.opacity);return`${e===1?"hsl(":"hsla("}${nG(this.h)}, ${zT(this.s)*100}%, ${zT(this.l)*100}%${e===1?")":`, ${e})`}`}}));function nG(e){return e=(e||0)%360,e<0?e+360:e}function zT(e){return Math.max(0,Math.min(1,e||0))}function VO(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}var hN=e=>()=>e;function fWt(e,t){return function(r){return e+r*t}}function dWt(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function pWt(e){return(e=+e)==1?crt:function(t,r){return r-t?dWt(t,r,e):hN(isNaN(t)?r:t)}}function crt(e,t){var r=t-e;return r?fWt(e,r):hN(isNaN(e)?t:e)}var iG=function e(t){var r=pWt(t);function n(i,a){var o=r((i=BF(i)).r,(a=BF(a)).r),s=r(i.g,a.g),l=r(i.b,a.b),u=crt(i.opacity,a.opacity);return function(c){return i.r=o(c),i.g=s(c),i.b=l(c),i.opacity=u(c),i+""}}return n.gamma=e,n}(1);function hrt(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),i;return function(a){for(i=0;i<r;++i)n[i]=e[i]*(1-a)+t[i]*a;return n}}function frt(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function vWt(e,t){return(frt(t)?hrt:drt)(e,t)}function drt(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,i=new Array(n),a=new Array(r),o;for(o=0;o<n;++o)i[o]=nR(e[o],t[o]);for(;o<r;++o)a[o]=t[o];return function(s){for(o=0;o<n;++o)a[o]=i[o](s);return a}}function gWt(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function NF(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function mWt(e,t){var r={},n={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?r[i]=nR(e[i],t[i]):n[i]=t[i];return function(a){for(i in r)n[i]=r[i](a);return n}}var kF=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,GO=new RegExp(kF.source,"g");function yWt(e){return function(){return e}}function _Wt(e){return function(t){return e(t)+""}}function xWt(e,t){var r=kF.lastIndex=GO.lastIndex=0,n,i,a,o=-1,s=[],l=[];for(e=e+"",t=t+"";(n=kF.exec(e))&&(i=GO.exec(t));)(a=i.index)>r&&(a=t.slice(r,a),s[o]?s[o]+=a:s[++o]=a),(n=n[0])===(i=i[0])?s[o]?s[o]+=i:s[++o]=i:(s[++o]=null,l.push({i:o,x:NF(n,i)})),r=GO.lastIndex;return r<t.length&&(a=t.slice(r),s[o]?s[o]+=a:s[++o]=a),s.length<2?l[0]?_Wt(l[0].x):yWt(t):(t=l.length,function(u){for(var c=0,f;c<t;++c)s[(f=l[c]).i]=f.x(u);return s.join("")})}function nR(e,t){var r=typeof t,n;return t==null||r==="boolean"?hN(t):(r==="number"?NF:r==="string"?(n=MC(t))?(t=n,iG):xWt:t instanceof MC?iG:t instanceof Date?gWt:frt(t)?hrt:Array.isArray(t)?drt:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?mWt:NF)(e,t)}function bWt(e){return+e}function EWt(e){return e*e}function wWt(e){return e*(2-e)}function aG(e){return((e*=2)<=1?e*e:--e*(2-e)+1)/2}function prt(e){return e*e*e}function CWt(e){return--e*e*e+1}function oG(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var fN=3,SWt=function e(t){t=+t;function r(n){return Math.pow(n,t)}return r.exponent=e,r}(fN),TWt=function e(t){t=+t;function r(n){return 1-Math.pow(1-n,t)}return r.exponent=e,r}(fN),sG=function e(t){t=+t;function r(n){return((n*=2)<=1?Math.pow(n,t):2-Math.pow(2-n,t))/2}return r.exponent=e,r}(fN),vrt=Math.PI,grt=vrt/2;function AWt(e){return+e==1?1:1-Math.cos(e*grt)}function MWt(e){return Math.sin(e*grt)}function lG(e){return(1-Math.cos(vrt*e))/2}function Jm(e){return(Math.pow(2,-10*e)-.0009765625)*1.0009775171065494}function RWt(e){return Jm(1-+e)}function IWt(e){return 1-Jm(e)}function uG(e){return((e*=2)<=1?Jm(1-e):2-Jm(e-1))/2}function LWt(e){return 1-Math.sqrt(1-e*e)}function OWt(e){return Math.sqrt(1- --e*e)}function cG(e){return((e*=2)<=1?1-Math.sqrt(1-e*e):Math.sqrt(1-(e-=2)*e)+1)/2}var zF=4/11,PWt=6/11,DWt=8/11,FWt=3/4,BWt=9/11,NWt=10/11,kWt=15/16,zWt=21/22,UWt=63/64,UT=1/zF/zF;function $Wt(e){return 1-RC(1-e)}function RC(e){return(e=+e)<zF?UT*e*e:e<DWt?UT*(e-=PWt)*e+FWt:e<NWt?UT*(e-=BWt)*e+kWt:UT*(e-=zWt)*e+UWt}function HWt(e){return((e*=2)<=1?1-RC(1-e):RC(e-1)+1)/2}var dN=1.70158,VWt=function e(t){t=+t;function r(n){return(n=+n)*n*(t*(n-1)+n)}return r.overshoot=e,r}(dN),GWt=function e(t){t=+t;function r(n){return--n*n*((n+1)*t+n)+1}return r.overshoot=e,r}(dN),hG=function e(t){t=+t;function r(n){return((n*=2)<1?n*n*((t+1)*n-t):(n-=2)*n*((t+1)*n+t)+2)/2}return r.overshoot=e,r}(dN),Zx=2*Math.PI,pN=1,vN=.3,WWt=function e(t,r){var n=Math.asin(1/(t=Math.max(1,t)))*(r/=Zx);function i(a){return t*Jm(- --a)*Math.sin((n-a)/r)}return i.amplitude=function(a){return e(a,r*Zx)},i.period=function(a){return e(t,a)},i}(pN,vN),fG=function e(t,r){var n=Math.asin(1/(t=Math.max(1,t)))*(r/=Zx);function i(a){return 1-t*Jm(a=+a)*Math.sin((a+n)/r)}return i.amplitude=function(a){return e(a,r*Zx)},i.period=function(a){return e(t,a)},i}(pN,vN),XWt=function e(t,r){var n=Math.asin(1/(t=Math.max(1,t)))*(r/=Zx);function i(a){return((a=a*2-1)<0?t*Jm(-a)*Math.sin((n-a)/r):2-t*Jm(a)*Math.sin((n+a)/r))/2}return i.amplitude=function(a){return e(a,r*Zx)},i.period=function(a){return e(t,a)},i}(pN,vN),jWt=Object.freeze({__proto__:null,easeLinear:bWt,easeQuad:aG,easeQuadIn:EWt,easeQuadOut:wWt,easeQuadInOut:aG,easeCubic:oG,easeCubicIn:prt,easeCubicOut:CWt,easeCubicInOut:oG,easePoly:sG,easePolyIn:SWt,easePolyOut:TWt,easePolyInOut:sG,easeSin:lG,easeSinIn:AWt,easeSinOut:MWt,easeSinInOut:lG,easeExp:uG,easeExpIn:RWt,easeExpOut:IWt,easeExpInOut:uG,easeCircle:cG,easeCircleIn:LWt,easeCircleOut:OWt,easeCircleInOut:cG,easeBounce:RC,easeBounceIn:$Wt,easeBounceOut:RC,easeBounceInOut:HWt,easeBack:hG,easeBackIn:VWt,easeBackOut:GWt,easeBackInOut:hG,easeElastic:fG,easeElasticIn:WWt,easeElasticOut:fG,easeElasticInOut:XWt}),YWt={};function ZWt(e){return YWt[e.toLowerCase()]||jWt[e]}var qWt=function(e){return["fill","stroke","fillStyle","strokeStyle"].includes(e)},KWt=function(e){return/^[r,R,L,l]{1}[\s]*\(/.test(e)},dG=[1,0,0,0,1,0,0,0,1];function QWt(e,t,r){var n={},i=t.fromAttrs,a=t.toAttrs;if(!e.destroyed){var o;for(var s in a)if(!KM(i[s],a[s]))if(s==="path"){var l=a[s],u=i[s];l.length>u.length?(l=Q1(a[s]),u=Q1(i[s]),u=Zet(u,l),u=LF(u,l),t.fromAttrs.path=u,t.toAttrs.path=l):t.pathFormatted||(l=Q1(a[s]),u=Q1(i[s]),u=LF(u,l),t.fromAttrs.path=u,t.toAttrs.path=l,t.pathFormatted=!0),n[s]=[];for(var c=0;c<l.length;c++){for(var f=l[c],d=u[c],v=[],g=0;g<f.length;g++)TF(f[g])&&d&&TF(d[g])?(o=nR(d[g],f[g]),v.push(o(r))):v.push(f[g]);n[s].push(v)}}else if(s==="matrix"){var x=vWt(i[s]||dG,a[s]||dG),w=x(r);n[s]=w}else qWt(s)&&KWt(a[s])?n[s]=a[s]:e_(a[s])||(o=nR(i[s],a[s]),n[s]=o(r));e.attr(n)}}function JWt(e,t,r){var n=t.startTime,i=t.delay;if(r<n+i||t._paused)return!1;var a,o=t.duration,s=t.easing,l=ZWt(s);if(r=r-n-t.delay,t.repeat)a=r%o/o,a=l(a);else if(a=r/o,a<1)a=l(a);else return t.onFrame?e.attr(t.onFrame(1)):e.attr(t.toAttrs),!0;if(t.onFrame){var u=t.onFrame(a);e.attr(u)}else QWt(e,t,a);return!1}var tXt=function(){function e(t){this.animators=[],this.current=0,this.timer=null,this.canvas=t}return e.prototype.initTimer=function(){var t=this,r=!1,n,i,a;this.timer=uN(function(o){if(t.current=o,t.animators.length>0){for(var s=t.animators.length-1;s>=0;s--){if(n=t.animators[s],n.destroyed){t.removeAnimator(s);continue}if(!n.isAnimatePaused()){i=n.get("animations");for(var l=i.length-1;l>=0;l--)a=i[l],r=JWt(n,a,o),r&&(i.splice(l,1),r=!1,a.callback&&a.callback())}i.length===0&&t.removeAnimator(s)}var u=t.canvas.get("autoDraw");u||t.canvas.draw()}})},e.prototype.addAnimator=function(t){this.animators.push(t)},e.prototype.removeAnimator=function(t){this.animators.splice(t,1)},e.prototype.isAnimating=function(){return!!this.animators.length},e.prototype.stop=function(){this.timer&&this.timer.stop()},e.prototype.stopAllAnimations=function(t){t===void 0&&(t=!0),this.animators.forEach(function(r){r.stopAnimate(t)}),this.animators=[],this.canvas.draw()},e.prototype.getTime=function(){return this.current},e}(),eXt=40,pG=0,vG=["mousedown","mouseup","dblclick","mouseout","mouseover","mousemove","mouseleave","mouseenter","touchstart","touchmove","touchend","dragenter","dragover","dragleave","drop","contextmenu","mousewheel"];function gG(e,t,r){r.name=t,r.target=e,r.currentTarget=e,r.delegateTarget=e,e.emit(t,r)}function rXt(e,t,r){if(r.bubbles){var n=void 0,i=!1;if(t==="mouseenter"?(n=r.fromShape,i=!0):t==="mouseleave"&&(i=!0,n=r.toShape),e.isCanvas()&&i)return;if(n&&Qet(e,n)){r.bubbles=!1;return}r.name=t,r.currentTarget=e,r.delegateTarget=e,e.emit(t,r)}}var nXt=function(){function e(t){var r=this;this.draggingShape=null,this.dragging=!1,this.currentShape=null,this.mousedownShape=null,this.mousedownPoint=null,this._eventCallback=function(n){var i=n.type;r._triggerEvent(i,n)},this._onDocumentMove=function(n){var i=r.canvas,a=i.get("el");if(a!==n.target&&(r.dragging||r.currentShape)){var o=r._getPointInfo(n);r.dragging&&r._emitEvent("drag",n,o,r.draggingShape)}},this._onDocumentMouseUp=function(n){var i=r.canvas,a=i.get("el");if(a!==n.target&&r.dragging){var o=r._getPointInfo(n);r.draggingShape&&r._emitEvent("drop",n,o,null),r._emitEvent("dragend",n,o,r.draggingShape),r._afterDrag(r.draggingShape,o,n)}},this.canvas=t.canvas}return e.prototype.init=function(){this._bindEvents()},e.prototype._bindEvents=function(){var t=this,r=this.canvas.get("el");Ta(vG,function(n){r.addEventListener(n,t._eventCallback)}),document&&(document.addEventListener("mousemove",this._onDocumentMove),document.addEventListener("mouseup",this._onDocumentMouseUp))},e.prototype._clearEvents=function(){var t=this,r=this.canvas.get("el");Ta(vG,function(n){r.removeEventListener(n,t._eventCallback)}),document&&(document.removeEventListener("mousemove",this._onDocumentMove),document.removeEventListener("mouseup",this._onDocumentMouseUp))},e.prototype._getEventObj=function(t,r,n,i,a,o){var s=new hGt(t,r);return s.fromShape=a,s.toShape=o,s.x=n.x,s.y=n.y,s.clientX=n.clientX,s.clientY=n.clientY,s.propagationPath.push(i),s},e.prototype._getShape=function(t,r){return this.canvas.getShape(t.x,t.y,r)},e.prototype._getPointInfo=function(t){var r=this.canvas,n=r.getClientByEvent(t),i=r.getPointByEvent(t);return{x:i.x,y:i.y,clientX:n.x,clientY:n.y}},e.prototype._triggerEvent=function(t,r){var n=this._getPointInfo(r),i=this._getShape(n,r),a=this["_on"+t],o=!1;if(a)a.call(this,n,i,r);else{var s=this.currentShape;t==="mouseenter"||t==="dragenter"||t==="mouseover"?(this._emitEvent(t,r,n,null,null,i),i&&this._emitEvent(t,r,n,i,null,i),t==="mouseenter"&&this.draggingShape&&this._emitEvent("dragenter",r,n,null)):t==="mouseleave"||t==="dragleave"||t==="mouseout"?(o=!0,s&&this._emitEvent(t,r,n,s,s,null),this._emitEvent(t,r,n,null,s,null),t==="mouseleave"&&this.draggingShape&&this._emitEvent("dragleave",r,n,null)):this._emitEvent(t,r,n,i,null,null)}if(o||(this.currentShape=i),i&&!i.get("destroyed")){var l=this.canvas,u=l.get("el");u.style.cursor=i.attr("cursor")||l.get("cursor")}},e.prototype._onmousedown=function(t,r,n){n.button===pG&&(this.mousedownShape=r,this.mousedownPoint=t,this.mousedownTimeStamp=n.timeStamp),this._emitEvent("mousedown",n,t,r,null,null)},e.prototype._emitMouseoverEvents=function(t,r,n,i){var a=this.canvas.get("el");n!==i&&(n&&(this._emitEvent("mouseout",t,r,n,n,i),this._emitEvent("mouseleave",t,r,n,n,i),(!i||i.get("destroyed"))&&(a.style.cursor=this.canvas.get("cursor"))),i&&(this._emitEvent("mouseover",t,r,i,n,i),this._emitEvent("mouseenter",t,r,i,n,i)))},e.prototype._emitDragoverEvents=function(t,r,n,i,a){i?(i!==n&&(n&&this._emitEvent("dragleave",t,r,n,n,i),this._emitEvent("dragenter",t,r,i,n,i)),a||this._emitEvent("dragover",t,r,i)):n&&this._emitEvent("dragleave",t,r,n,n,i),a&&this._emitEvent("dragover",t,r,i)},e.prototype._afterDrag=function(t,r,n){t&&(t.set("capture",!0),this.draggingShape=null),this.dragging=!1;var i=this._getShape(r,n);i!==t&&this._emitMouseoverEvents(n,r,t,i),this.currentShape=i},e.prototype._onmouseup=function(t,r,n){if(n.button===pG){var i=this.draggingShape;this.dragging?(i&&this._emitEvent("drop",n,t,r),this._emitEvent("dragend",n,t,i),this._afterDrag(i,t,n)):(this._emitEvent("mouseup",n,t,r),r===this.mousedownShape&&this._emitEvent("click",n,t,r),this.mousedownShape=null,this.mousedownPoint=null)}},e.prototype._ondragover=function(t,r,n){n.preventDefault();var i=this.currentShape;this._emitDragoverEvents(n,t,i,r,!0)},e.prototype._onmousemove=function(t,r,n){var i=this.canvas,a=this.currentShape,o=this.draggingShape;if(this.dragging)o&&this._emitDragoverEvents(n,t,a,r,!1),this._emitEvent("drag",n,t,o);else{var s=this.mousedownPoint;if(s){var l=this.mousedownShape,u=n.timeStamp,c=u-this.mousedownTimeStamp,f=s.clientX-t.clientX,d=s.clientY-t.clientY,v=f*f+d*d;c>120||v>eXt?l&&l.get("draggable")?(o=this.mousedownShape,o.set("capture",!1),this.draggingShape=o,this.dragging=!0,this._emitEvent("dragstart",n,t,o),this.mousedownShape=null,this.mousedownPoint=null):!l&&i.get("draggable")?(this.dragging=!0,this._emitEvent("dragstart",n,t,null),this.mousedownShape=null,this.mousedownPoint=null):(this._emitMouseoverEvents(n,t,a,r),this._emitEvent("mousemove",n,t,r)):(this._emitMouseoverEvents(n,t,a,r),this._emitEvent("mousemove",n,t,r))}else this._emitMouseoverEvents(n,t,a,r),this._emitEvent("mousemove",n,t,r)}},e.prototype._emitEvent=function(t,r,n,i,a,o){var s=this._getEventObj(t,r,n,i,a,o);if(i){s.shape=i,gG(i,t,s);for(var l=i.getParent();l;)l.emitDelegation(t,s),s.propagationStopped||rXt(l,t,s),s.propagationPath.push(l),l=l.getParent()}else{var u=this.canvas;gG(u,t,s)}},e.prototype.destroy=function(){this._clearEvents(),this.canvas=null,this.currentShape=null,this.draggingShape=null,this.mousedownPoint=null,this.mousedownShape=null,this.mousedownTimeStamp=null},e}(),mG="px",yG=EGt(),iXt=yG&&yG.name==="firefox",aXt=function(e){en(t,e);function t(r){var n=e.call(this,r)||this;return n.initContainer(),n.initDom(),n.initEvents(),n.initTimeline(),n}return t.prototype.getDefaultCfg=function(){var r=e.prototype.getDefaultCfg.call(this);return r.cursor="default",r.supportCSSTransform=!1,r},t.prototype.initContainer=function(){var r=this.get("container");Hd(r)&&(r=document.getElementById(r),this.set("container",r))},t.prototype.initDom=function(){var r=this.createDom();this.set("el",r);var n=this.get("container");n.appendChild(r),this.setDOMSize(this.get("width"),this.get("height"))},t.prototype.initEvents=function(){var r=new nXt({canvas:this});r.init(),this.set("eventController",r)},t.prototype.initTimeline=function(){var r=new tXt(this);this.set("timeline",r)},t.prototype.setDOMSize=function(r,n){var i=this.get("el");HV&&(i.style.width=r+mG,i.style.height=n+mG)},t.prototype.changeSize=function(r,n){this.setDOMSize(r,n),this.set("width",r),this.set("height",n),this.onCanvasChange("changeSize")},t.prototype.getRenderer=function(){return this.get("renderer")},t.prototype.getCursor=function(){return this.get("cursor")},t.prototype.setCursor=function(r){this.set("cursor",r);var n=this.get("el");HV&&n&&(n.style.cursor=r)},t.prototype.getPointByEvent=function(r){var n=this.get("supportCSSTransform");if(n){if(iXt&&!xl(r.layerX)&&r.layerX!==r.offsetX)return{x:r.layerX,y:r.layerY};if(!xl(r.offsetX))return{x:r.offsetX,y:r.offsetY}}var i=this.getClientByEvent(r),a=i.x,o=i.y;return this.getPointByClient(a,o)},t.prototype.getClientByEvent=function(r){var n=r;return r.touches&&(r.type==="touchend"?n=r.changedTouches[0]:n=r.touches[0]),{x:n.clientX,y:n.clientY}},t.prototype.getPointByClient=function(r,n){var i=this.get("el"),a=i.getBoundingClientRect();return{x:r-a.left,y:n-a.top}},t.prototype.getClientByPoint=function(r,n){var i=this.get("el"),a=i.getBoundingClientRect();return{x:r+a.left,y:n+a.top}},t.prototype.draw=function(){},t.prototype.removeDom=function(){var r=this.get("el");r.parentNode.removeChild(r)},t.prototype.clearEvents=function(){var r=this.get("eventController");r.destroy()},t.prototype.isCanvas=function(){return!0},t.prototype.getParent=function(){return null},t.prototype.destroy=function(){var r=this.get("timeline");this.get("destroyed")||(this.clear(),r&&r.stop(),this.clearEvents(),this.removeDom(),e.prototype.destroy.call(this))},t}(irt),oXt=function(e){en(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.isGroup=function(){return!0},t.prototype.isEntityGroup=function(){return!1},t.prototype.clone=function(){for(var r=e.prototype.clone.call(this),n=this.getChildren(),i=0;i<n.length;i++){var a=n[i];r.add(a.clone())}return r},t}(irt),sXt=function(e){en(t,e);function t(r){return e.call(this,r)||this}return t.prototype._isInBBox=function(r,n){var i=this.getBBox();return i.minX<=r&&i.maxX>=r&&i.minY<=n&&i.maxY>=n},t.prototype.afterAttrsChange=function(r){e.prototype.afterAttrsChange.call(this,r),this.clearCacheBBox()},t.prototype.getBBox=function(){var r=this.cfg.bbox;return r||(r=this.calculateBBox(),this.set("bbox",r)),r},t.prototype.getCanvasBBox=function(){var r=this.cfg.canvasBBox;return r||(r=this.calculateCanvasBBox(),this.set("canvasBBox",r)),r},t.prototype.applyMatrix=function(r){e.prototype.applyMatrix.call(this,r),this.set("canvasBBox",null)},t.prototype.calculateCanvasBBox=function(){var r=this.getBBox(),n=this.getTotalMatrix(),i=r.minX,a=r.minY,o=r.maxX,s=r.maxY;if(n){var l=Cy(n,[r.minX,r.minY]),u=Cy(n,[r.maxX,r.minY]),c=Cy(n,[r.minX,r.maxY]),f=Cy(n,[r.maxX,r.maxY]);i=Math.min(l[0],u[0],c[0],f[0]),o=Math.max(l[0],u[0],c[0],f[0]),a=Math.min(l[1],u[1],c[1],f[1]),s=Math.max(l[1],u[1],c[1],f[1])}var d=this.attrs;if(d.shadowColor){var v=d.shadowBlur,g=v===void 0?0:v,x=d.shadowOffsetX,w=x===void 0?0:x,S=d.shadowOffsetY,A=S===void 0?0:S,M=i-g+w,R=o+g+w,O=a-g+A,N=s+g+A;i=Math.min(i,M),o=Math.max(o,R),a=Math.min(a,O),s=Math.max(s,N)}return{x:i,y:a,minX:i,minY:a,maxX:o,maxY:s,width:o-i,height:s-a}},t.prototype.clearCacheBBox=function(){this.set("bbox",null),this.set("canvasBBox",null)},t.prototype.isClipShape=function(){return this.get("isClipShape")},t.prototype.isInShape=function(r,n){return!1},t.prototype.isOnlyHitBox=function(){return!1},t.prototype.isHit=function(r,n){var i=this.get("startArrowShape"),a=this.get("endArrowShape"),o=[r,n,1];o=this.invertFromMatrix(o);var s=o[0],l=o[1],u=this._isInBBox(s,l);return this.isOnlyHitBox()?u:!!(u&&!this.isClipped(s,l)&&(this.isInShape(s,l)||i&&i.isHit(s,l)||a&&a.isHit(s,l)))},t}(ert),mrt=new Map;function Jp(e,t){mrt.set(e,t)}function lXt(e){return mrt.get(e)}function yrt(e){var t=e.attr(),r=t.x,n=t.y,i=t.width,a=t.height;return{x:r,y:n,width:i,height:a}}function _rt(e){var t=e.attr(),r=t.x,n=t.y,i=t.r;return{x:r-i,y:n-i,width:i*2,height:i*2}}function Nu(e,t,r,n){var i=e-r,a=t-n;return Math.sqrt(i*i+a*a)}function zA(e,t){return Math.abs(e-t)<.001}function Tb(e,t){var r=Qm(e),n=Qm(t),i=Km(e),a=Km(t);return{x:r,y:n,width:i-r,height:a-n}}function HI(e){return(e+Math.PI*2)%(Math.PI*2)}var Gc={box:function(e,t,r,n){return Tb([e,r],[t,n])},length:function(e,t,r,n){return Nu(e,t,r,n)},pointAt:function(e,t,r,n,i){return{x:(1-i)*e+i*r,y:(1-i)*t+i*n}},pointDistance:function(e,t,r,n,i,a){var o=(r-e)*(i-e)+(n-t)*(a-t);if(o<0)return Nu(e,t,i,a);var s=(r-e)*(r-e)+(n-t)*(n-t);return o>s?Nu(r,n,i,a):this.pointToLine(e,t,r,n,i,a)},pointToLine:function(e,t,r,n,i,a){var o=[r-e,n-t];if(FGt(o,[0,0]))return Math.sqrt((i-e)*(i-e)+(a-t)*(a-t));var s=[-o[1],o[0]];PGt(s,s);var l=[i-e,a-t];return Math.abs(DGt(l,s))},tangentAngle:function(e,t,r,n){return Math.atan2(n-t,r-e)}},uXt=1e-4;function xrt(e,t,r,n,i,a){var o,s=1/0,l=[r,n],u=20;a&&a>200&&(u=a/10);for(var c=1/u,f=c/10,d=0;d<=u;d++){var v=d*c,g=[i.apply(null,e.concat([v])),i.apply(null,t.concat([v]))],x=Nu(l[0],l[1],g[0],g[1]);x<s&&(o=v,s=x)}if(o===0)return{x:e[0],y:t[0]};if(o===1){var w=e.length;return{x:e[w-1],y:t[w-1]}}s=1/0;for(var d=0;d<32&&!(f<uXt);d++){var S=o-f,A=o+f,g=[i.apply(null,e.concat([S])),i.apply(null,t.concat([S]))],x=Nu(l[0],l[1],g[0],g[1]);if(S>=0&&x<s)o=S,s=x;else{var M=[i.apply(null,e.concat([A])),i.apply(null,t.concat([A]))],R=Nu(l[0],l[1],M[0],M[1]);A<=1&&R<s?(o=A,s=R):f*=.5}}return{x:i.apply(null,e.concat([o])),y:i.apply(null,t.concat([o]))}}function cXt(e,t){for(var r=0,n=e.length,i=0;i<n;i++){var a=e[i],o=t[i],s=e[(i+1)%n],l=t[(i+1)%n];r+=Nu(a,o,s,l)}return r/2}function mm(e,t,r,n){var i=1-n;return i*i*e+2*n*i*t+n*n*r}function _G(e,t,r){var n=e+r-2*t;if(zA(n,0))return[.5];var i=(e-t)/n;return i<=1&&i>=0?[i]:[]}function xG(e,t,r,n){return 2*(1-n)*(t-e)+2*n*(r-t)}function brt(e,t,r,n,i,a,o){var s=mm(e,r,i,o),l=mm(t,n,a,o),u=Gc.pointAt(e,t,r,n,o),c=Gc.pointAt(r,n,i,a,o);return[[e,t,u.x,u.y,s,l],[s,l,c.x,c.y,i,a]]}function UF(e,t,r,n,i,a,o){if(o===0)return(Nu(e,t,r,n)+Nu(r,n,i,a)+Nu(e,t,i,a))/2;var s=brt(e,t,r,n,i,a,.5),l=s[0],u=s[1];return l.push(o-1),u.push(o-1),UF.apply(null,l)+UF.apply(null,u)}var Ert={box:function(e,t,r,n,i,a){var o=_G(e,r,i)[0],s=_G(t,n,a)[0],l=[e,i],u=[t,a];return o!==void 0&&l.push(mm(e,r,i,o)),s!==void 0&&u.push(mm(t,n,a,s)),Tb(l,u)},length:function(e,t,r,n,i,a){return UF(e,t,r,n,i,a,3)},nearestPoint:function(e,t,r,n,i,a,o,s){return xrt([e,r,i],[t,n,a],o,s,mm)},pointDistance:function(e,t,r,n,i,a,o,s){var l=this.nearestPoint(e,t,r,n,i,a,o,s);return Nu(l.x,l.y,o,s)},interpolationAt:mm,pointAt:function(e,t,r,n,i,a,o){return{x:mm(e,r,i,o),y:mm(t,n,a,o)}},divide:function(e,t,r,n,i,a,o){return brt(e,t,r,n,i,a,o)},tangentAngle:function(e,t,r,n,i,a,o){var s=xG(e,r,i,o),l=xG(t,n,a,o),u=Math.atan2(l,s);return HI(u)}};function ym(e,t,r,n,i){var a=1-i;return a*a*a*e+3*t*i*a*a+3*r*i*i*a+n*i*i*i}function bG(e,t,r,n,i){var a=1-i;return 3*(a*a*(t-e)+2*a*i*(r-t)+i*i*(n-r))}function WO(e,t,r,n){var i=-3*e+9*t-9*r+3*n,a=6*e-12*t+6*r,o=3*t-3*e,s=[],l,u,c;if(zA(i,0))zA(a,0)||(l=-o/a,l>=0&&l<=1&&s.push(l));else{var f=a*a-4*i*o;zA(f,0)?s.push(-a/(2*i)):f>0&&(c=Math.sqrt(f),l=(-a+c)/(2*i),u=(-a-c)/(2*i),l>=0&&l<=1&&s.push(l),u>=0&&u<=1&&s.push(u))}return s}function wrt(e,t,r,n,i,a,o,s,l){var u=ym(e,r,i,o,l),c=ym(t,n,a,s,l),f=Gc.pointAt(e,t,r,n,l),d=Gc.pointAt(r,n,i,a,l),v=Gc.pointAt(i,a,o,s,l),g=Gc.pointAt(f.x,f.y,d.x,d.y,l),x=Gc.pointAt(d.x,d.y,v.x,v.y,l);return[[e,t,f.x,f.y,g.x,g.y,u,c],[u,c,x.x,x.y,v.x,v.y,o,s]]}function $F(e,t,r,n,i,a,o,s,l){if(l===0)return cXt([e,r,i,o],[t,n,a,s]);var u=wrt(e,t,r,n,i,a,o,s,.5),c=u[0],f=u[1];return c.push(l-1),f.push(l-1),$F.apply(null,c)+$F.apply(null,f)}var Hw={extrema:WO,box:function(e,t,r,n,i,a,o,s){for(var l=[e,o],u=[t,s],c=WO(e,r,i,o),f=WO(t,n,a,s),d=0;d<c.length;d++)l.push(ym(e,r,i,o,c[d]));for(var d=0;d<f.length;d++)u.push(ym(t,n,a,s,f[d]));return Tb(l,u)},length:function(e,t,r,n,i,a,o,s){return $F(e,t,r,n,i,a,o,s,3)},nearestPoint:function(e,t,r,n,i,a,o,s,l,u,c){return xrt([e,r,i,o],[t,n,a,s],l,u,ym,c)},pointDistance:function(e,t,r,n,i,a,o,s,l,u,c){var f=this.nearestPoint(e,t,r,n,i,a,o,s,l,u,c);return Nu(f.x,f.y,l,u)},interpolationAt:ym,pointAt:function(e,t,r,n,i,a,o,s,l){return{x:ym(e,r,i,o,l),y:ym(t,n,a,s,l)}},divide:function(e,t,r,n,i,a,o,s,l){return wrt(e,t,r,n,i,a,o,s,l)},tangentAngle:function(e,t,r,n,i,a,o,s,l){var u=bG(e,r,i,o,l),c=bG(t,n,a,s,l);return HI(Math.atan2(c,u))}};function EG(e,t){var r=Math.abs(e);return t>0?r:r*-1}var hXt={box:function(e,t,r,n){return{x:e-r,y:t-n,width:r*2,height:n*2}},length:function(e,t,r,n){return Math.PI*(3*(r+n)-Math.sqrt((3*r+n)*(r+3*n)))},nearestPoint:function(e,t,r,n,i,a){var o=r,s=n;if(o===0||s===0)return{x:e,y:t};for(var l=i-e,u=a-t,c=Math.abs(l),f=Math.abs(u),d=o*o,v=s*s,g=Math.PI/4,x,w,S=0;S<4;S++){x=o*Math.cos(g),w=s*Math.sin(g);var A=(d-v)*Math.pow(Math.cos(g),3)/o,M=(v-d)*Math.pow(Math.sin(g),3)/s,R=x-A,O=w-M,N=c-A,k=f-M,V=Math.hypot(O,R),Q=Math.hypot(k,N),Y=V*Math.asin((R*k-O*N)/(V*Q)),X=Y/Math.sqrt(d+v-x*x-w*w);g+=X,g=Math.min(Math.PI/2,Math.max(0,g))}return{x:e+EG(x,l),y:t+EG(w,u)}},pointDistance:function(e,t,r,n,i,a){var o=this.nearestPoint(e,t,r,n,i,a);return Nu(o.x,o.y,i,a)},pointAt:function(e,t,r,n,i){var a=2*Math.PI*i;return{x:e+r*Math.cos(a),y:t+n*Math.sin(a)}},tangentAngle:function(e,t,r,n,i){var a=2*Math.PI*i,o=Math.atan2(n*Math.cos(a),-r*Math.sin(a));return HI(o)}};function fXt(e,t,r,n,i,a,o,s){return-1*r*Math.cos(i)*Math.sin(s)-n*Math.sin(i)*Math.cos(s)}function dXt(e,t,r,n,i,a,o,s){return-1*r*Math.sin(i)*Math.sin(s)+n*Math.cos(i)*Math.cos(s)}function pXt(e,t,r){return Math.atan(-t/e*Math.tan(r))}function vXt(e,t,r){return Math.atan(t/(e*Math.tan(r)))}function wG(e,t,r,n,i,a){return r*Math.cos(i)*Math.cos(a)-n*Math.sin(i)*Math.sin(a)+e}function CG(e,t,r,n,i,a){return r*Math.sin(i)*Math.cos(a)+n*Math.cos(i)*Math.sin(a)+t}function gXt(e,t,r,n){var i=Math.atan2(n*e,r*t);return(i+Math.PI*2)%(Math.PI*2)}function SG(e,t,r){return{x:e*Math.cos(r),y:t*Math.sin(r)}}function TG(e,t,r){var n=Math.cos(r),i=Math.sin(r);return[e*n-t*i,e*i+t*n]}var mXt={box:function(e,t,r,n,i,a,o){for(var s=pXt(r,n,i),l=1/0,u=-1/0,c=[a,o],f=-Math.PI*2;f<=Math.PI*2;f+=Math.PI){var d=s+f;a<o?a<d&&d<o&&c.push(d):o<d&&d<a&&c.push(d)}for(var f=0;f<c.length;f++){var v=wG(e,t,r,n,i,c[f]);v<l&&(l=v),v>u&&(u=v)}for(var g=vXt(r,n,i),x=1/0,w=-1/0,S=[a,o],f=-Math.PI*2;f<=Math.PI*2;f+=Math.PI){var A=g+f;a<o?a<A&&A<o&&S.push(A):o<A&&A<a&&S.push(A)}for(var f=0;f<S.length;f++){var M=CG(e,t,r,n,i,S[f]);M<x&&(x=M),M>w&&(w=M)}return{x:l,y:x,width:u-l,height:w-x}},length:function(e,t,r,n,i,a,o){},nearestPoint:function(e,t,r,n,i,a,o,s,l){var u=TG(s-e,l-t,-i),c=u[0],f=u[1],d=hXt.nearestPoint(0,0,r,n,c,f),v=gXt(r,n,d.x,d.y);v<a?d=SG(r,n,a):v>o&&(d=SG(r,n,o));var g=TG(d.x,d.y,i);return{x:g[0]+e,y:g[1]+t}},pointDistance:function(e,t,r,n,i,a,o,s,l){var u=this.nearestPoint(e,t,r,n,s,l);return Nu(u.x,u.y,s,l)},pointAt:function(e,t,r,n,i,a,o,s){var l=(o-a)*s+a;return{x:wG(e,t,r,n,i,l),y:CG(e,t,r,n,i,l)}},tangentAngle:function(e,t,r,n,i,a,o,s){var l=(o-a)*s+a,u=fXt(e,t,r,n,i,a,o,l),c=dXt(e,t,r,n,i,a,o,l);return HI(Math.atan2(c,u))}};function Crt(e){for(var t=0,r=[],n=0;n<e.length-1;n++){var i=e[n],a=e[n+1],o=Nu(i[0],i[1],a[0],a[1]),s={from:i,to:a,length:o};r.push(s),t+=o}return{segments:r,totalLength:t}}function yXt(e){if(e.length<2)return 0;for(var t=0,r=0;r<e.length-1;r++){var n=e[r],i=e[r+1];t+=Nu(n[0],n[1],i[0],i[1])}return t}function _Xt(e,t){if(t>1||t<0||e.length<2)return null;var r=Crt(e),n=r.segments,i=r.totalLength;if(i===0)return{x:e[0][0],y:e[0][1]};for(var a=0,o=null,s=0;s<n.length;s++){var l=n[s],u=l.from,c=l.to,f=l.length/i;if(t>=a&&t<=a+f){var d=(t-a)/f;o=Gc.pointAt(u[0],u[1],c[0],c[1],d);break}a+=f}return o}function xXt(e,t){if(t>1||t<0||e.length<2)return 0;for(var r=Crt(e),n=r.segments,i=r.totalLength,a=0,o=0,s=0;s<n.length;s++){var l=n[s],u=l.from,c=l.to,f=l.length/i;if(t>=a&&t<=a+f){o=Math.atan2(c[1]-u[1],c[0]-u[0]);break}a+=f}return o}function bXt(e,t,r){for(var n=1/0,i=0;i<e.length-1;i++){var a=e[i],o=e[i+1],s=Gc.pointDistance(a[0],a[1],o[0],o[1],t,r);s<n&&(n=s)}return n}var EXt={box:function(e){for(var t=[],r=[],n=0;n<e.length;n++){var i=e[n];t.push(i[0]),r.push(i[1])}return Tb(t,r)},length:function(e){return yXt(e)},pointAt:function(e,t){return _Xt(e,t)},pointDistance:function(e,t,r){return bXt(e,t,r)},tangentAngle:function(e,t){return xXt(e,t)}};function AG(e,t){return!e||!t?e||t:{minX:Math.min(e.minX,t.minX),minY:Math.min(e.minY,t.minY),maxX:Math.max(e.maxX,t.maxX),maxY:Math.max(e.maxY,t.maxY)}}function gN(e,t){var r=e.get("startArrowShape"),n=e.get("endArrowShape"),i=null,a=null;return r&&(i=r.getCanvasBBox(),t=AG(t,i)),n&&(a=n.getCanvasBBox(),t=AG(t,a)),t}function wXt(e){for(var t=e.attr(),r=t.points,n=[],i=[],a=0;a<r.length;a++){var o=r[a];n.push(o[0]),i.push(o[1])}var s=Tb(n,i),l=s.x,u=s.y,c=s.width,f=s.height,d={minX:l,minY:u,maxX:l+c,maxY:u+f};return d=gN(e,d),{x:d.minX,y:d.minY,width:d.maxX-d.minX,height:d.maxY-d.minY}}function CXt(e){for(var t=e.attr(),r=t.points,n=[],i=[],a=0;a<r.length;a++){var o=r[a];n.push(o[0]),i.push(o[1])}return Tb(n,i)}var XO=null;function Srt(){if(!XO){var e=document.createElement("canvas");e.width=1,e.height=1,XO=e.getContext("2d")}return XO}function Trt(e,t,r){var n=1;if(Hd(e)&&(n=e.split(`
`).length),n>1){var i=SXt(t,r);return t*n+i*(n-1)}return t}function SXt(e,t){return t?t-e:e*.14}function TXt(e,t){var r=Srt(),n=0;if(xl(e)||e==="")return n;if(r.save(),r.font=t,Hd(e)&&e.includes(`
`)){var i=e.split(`
`);Ta(i,function(a){var o=r.measureText(a).width;n<o&&(n=o)})}else n=r.measureText(e).width;return r.restore(),n}function Art(e){var t=e.fontSize,r=e.fontFamily,n=e.fontWeight,i=e.fontStyle,a=e.fontVariant;return[i,a,n,t+"px",r].join(" ").trim()}function AXt(e){var t=e.attr(),r=t.x,n=t.y,i=t.text,a=t.fontSize,o=t.lineHeight,s=t.font;s||(s=Art(t));var l=TXt(i,s),u;if(!l)u={x:r,y:n,width:0,height:0};else{var c=t.textAlign,f=t.textBaseline,d=Trt(i,a,o),v={x:r,y:n-d};c&&(c==="end"||c==="right"?v.x-=l:c==="center"&&(v.x-=l/2)),f&&(f==="top"?v.y+=d:f==="middle"&&(v.y+=d/2)),u={x:v.x,y:v.y,width:l,height:d}}return u}var MXt=/[MLHVQTCSAZ]([^MLHVQTCSAZ]*)/ig,RXt=/[^\s\,]+/ig;function IXt(e){var t=e||[];if(Wf(t))return t;if(Hd(t))return t=t.match(MXt),Ta(t,function(r,n){if(r=r.match(RXt),r[0].length>1){var i=r[0].charAt(0);r.splice(1,0,r[0].substr(1)),r[0]=i}Ta(r,function(a,o){isNaN(a)||(r[o]=+a)}),t[n]=r}),t}var Vw=`	
\v\f\r   ᠎             　\u2028\u2029`,LXt=new RegExp("([a-z])["+Vw+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+Vw+"]*,?["+Vw+"]*)+)","ig"),OXt=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+Vw+"]*,?["+Vw+"]*","ig");function PXt(e){if(!e)return null;if(Wf(e))return e;var t={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},r=[];return String(e).replace(LXt,function(n,i,a){var o=[],s=i.toLowerCase();if(a.replace(OXt,function(l,u){u&&o.push(+u)}),s==="m"&&o.length>2&&(r.push([i].concat(o.splice(0,2))),s="l",i=i==="m"?"l":"L"),s==="o"&&o.length===1&&r.push([i,o[0]]),s==="r")r.push([i].concat(o));else for(;o.length>=t[s]&&(r.push([i].concat(o.splice(0,t[s]))),!!t[s]););return""}),r}var DXt=/[a-z]/;function MG(e,t){return[t[0]+(t[0]-e[0]),t[1]+(t[1]-e[1])]}function Mrt(e){var t=PXt(e);if(!t||!t.length)return[["M",0,0]];for(var r=!1,n=0;n<t.length;n++){var i=t[n][0];if(DXt.test(i)||["V","H","T","S"].indexOf(i)>=0){r=!0;break}}if(!r)return t;var a=[],o=0,s=0,l=0,u=0,c=0,f=t[0];(f[0]==="M"||f[0]==="m")&&(o=+f[1],s=+f[2],l=o,u=s,c++,a[0]=["M",o,s]);for(var n=c,d=t.length;n<d;n++){var v=t[n],g=a[n-1],x=[],i=v[0],w=i.toUpperCase();if(i!==w)switch(x[0]=w,w){case"A":x[1]=v[1],x[2]=v[2],x[3]=v[3],x[4]=v[4],x[5]=v[5],x[6]=+v[6]+o,x[7]=+v[7]+s;break;case"V":x[1]=+v[1]+s;break;case"H":x[1]=+v[1]+o;break;case"M":l=+v[1]+o,u=+v[2]+s,x[1]=l,x[2]=u;break;default:for(var S=1,A=v.length;S<A;S++)x[S]=+v[S]+(S%2?o:s)}else x=t[n];switch(w){case"Z":o=+l,s=+u;break;case"H":o=x[1],x=["L",o,s];break;case"V":s=x[1],x=["L",o,s];break;case"T":o=x[1],s=x[2];var M=MG([g[1],g[2]],[g[3],g[4]]);x=["Q",M[0],M[1],o,s];break;case"S":o=x[x.length-2],s=x[x.length-1];var R=g.length,O=MG([g[R-4],g[R-3]],[g[R-2],g[R-1]]);x=["C",O[0],O[1],x[1],x[2],o,s];break;case"M":l=x[x.length-2],u=x[x.length-1];break;default:o=x[x.length-2],s=x[x.length-1]}a.push(x)}return a}function $T(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function HF(e,t){return $T(e)*$T(t)?(e[0]*t[0]+e[1]*t[1])/($T(e)*$T(t)):1}function RG(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(HF(e,t))}function VF(e,t){return e[0]===t[0]&&e[1]===t[1]}function FXt(e,t){var r=t[1],n=t[2],i=Het(Vet(t[3]),Math.PI*2),a=t[4],o=t[5],s=e[0],l=e[1],u=t[6],c=t[7],f=Math.cos(i)*(s-u)/2+Math.sin(i)*(l-c)/2,d=-1*Math.sin(i)*(s-u)/2+Math.cos(i)*(l-c)/2,v=f*f/(r*r)+d*d/(n*n);v>1&&(r*=Math.sqrt(v),n*=Math.sqrt(v));var g=r*r*(d*d)+n*n*(f*f),x=g?Math.sqrt((r*r*(n*n)-g)/g):1;a===o&&(x*=-1),isNaN(x)&&(x=0);var w=n?x*r*d/n:0,S=r?x*-n*f/r:0,A=(s+u)/2+Math.cos(i)*w-Math.sin(i)*S,M=(l+c)/2+Math.sin(i)*w+Math.cos(i)*S,R=[(f-w)/r,(d-S)/n],O=[(-1*f-w)/r,(-1*d-S)/n],N=RG([1,0],R),k=RG(R,O);return HF(R,O)<=-1&&(k=Math.PI),HF(R,O)>=1&&(k=0),o===0&&k>0&&(k=k-2*Math.PI),o===1&&k<0&&(k=k+2*Math.PI),{cx:A,cy:M,rx:VF(e,[u,c])?0:r,ry:VF(e,[u,c])?0:n,startAngle:N,endAngle:N+k,xRotation:i,arcFlag:a,sweepFlag:o}}function IG(e,t){return[t[0]+(t[0]-e[0]),t[1]+(t[1]-e[1])]}function Rrt(e){e=IXt(e);for(var t=[],r=null,n=null,i=null,a=0,o=e.length,s=0;s<o;s++){var l=e[s];n=e[s+1];var u=l[0],c={command:u,prePoint:r,params:l,startTangent:null,endTangent:null};switch(u){case"M":i=[l[1],l[2]],a=s;break;case"A":var f=FXt(r,l);c.arcParams=f;break}if(u==="Z")r=i,n=e[a+1];else{var d=l.length;r=[l[d-2],l[d-1]]}n&&n[0]==="Z"&&(n=e[a],t[a]&&(t[a].prePoint=r)),c.currentPoint=r,t[a]&&VF(r,t[a].currentPoint)&&(t[a].prePoint=c.prePoint);var v=n?[n[n.length-2],n[n.length-1]]:null;c.nextPoint=v;var g=c.prePoint;if(["L","H","V"].includes(u))c.startTangent=[g[0]-r[0],g[1]-r[1]],c.endTangent=[r[0]-g[0],r[1]-g[1]];else if(u==="Q"){var x=[l[1],l[2]];c.startTangent=[g[0]-x[0],g[1]-x[1]],c.endTangent=[r[0]-x[0],r[1]-x[1]]}else if(u==="T"){var w=t[s-1],x=IG(w.currentPoint,g);w.command==="Q"?(c.command="Q",c.startTangent=[g[0]-x[0],g[1]-x[1]],c.endTangent=[r[0]-x[0],r[1]-x[1]]):(c.command="TL",c.startTangent=[g[0]-r[0],g[1]-r[1]],c.endTangent=[r[0]-g[0],r[1]-g[1]])}else if(u==="C"){var S=[l[1],l[2]],A=[l[3],l[4]];c.startTangent=[g[0]-S[0],g[1]-S[1]],c.endTangent=[r[0]-A[0],r[1]-A[1]],c.startTangent[0]===0&&c.startTangent[1]===0&&(c.startTangent=[S[0]-A[0],S[1]-A[1]]),c.endTangent[0]===0&&c.endTangent[1]===0&&(c.endTangent=[A[0]-S[0],A[1]-S[1]])}else if(u==="S"){var w=t[s-1],S=IG(w.currentPoint,g),A=[l[1],l[2]];w.command==="C"?(c.command="C",c.startTangent=[g[0]-S[0],g[1]-S[1]],c.endTangent=[r[0]-A[0],r[1]-A[1]]):(c.command="SQ",c.startTangent=[g[0]-A[0],g[1]-A[1]],c.endTangent=[r[0]-A[0],r[1]-A[1]])}else if(u==="A"){var M=.001,R=c.arcParams||{},O=R.cx,N=O===void 0?0:O,k=R.cy,V=k===void 0?0:k,Q=R.rx,Y=Q===void 0?0:Q,X=R.ry,tt=X===void 0?0:X,it=R.sweepFlag,Et=it===void 0?0:it,Tt=R.startAngle,pt=Tt===void 0?0:Tt,kt=R.endAngle,ae=kt===void 0?0:kt;Et===0&&(M*=-1);var Kt=Y*Math.cos(pt-M)+N,re=tt*Math.sin(pt-M)+V;c.startTangent=[Kt-i[0],re-i[1]];var fe=Y*Math.cos(pt+ae+M)+N,Oe=tt*Math.sin(pt+ae-M)+V;c.endTangent=[g[0]-fe,g[1]-Oe]}t.push(c)}return t}function BXt(e,t){for(var r=[],n=[],i=[],a=0;a<e.length;a++){var o=e[a],s=o.currentPoint,l=o.params,u=o.prePoint,c=void 0;switch(o.command){case"Q":c=Ert.box(u[0],u[1],l[1],l[2],l[3],l[4]);break;case"C":c=Hw.box(u[0],u[1],l[1],l[2],l[3],l[4],l[5],l[6]);break;case"A":var f=o.arcParams;c=mXt.box(f.cx,f.cy,f.rx,f.ry,f.xRotation,f.startAngle,f.endAngle);break;default:r.push(s[0]),n.push(s[1]);break}c&&(o.box=c,r.push(c.x,c.x+c.width),n.push(c.y,c.y+c.height)),t&&(o.command==="L"||o.command==="M")&&o.prePoint&&o.nextPoint&&i.push(o)}r=r.filter(function(S){return!Number.isNaN(S)&&S!==1/0&&S!==-1/0}),n=n.filter(function(S){return!Number.isNaN(S)&&S!==1/0&&S!==-1/0});var d=Qm(r),v=Qm(n),g=Km(r),x=Km(n);if(i.length===0)return{x:d,y:v,width:g-d,height:x-v};for(var a=0;a<i.length;a++){var o=i[a],s=o.currentPoint,w=void 0;s[0]===d?(w=HT(o,t),d=d-w.xExtra):s[0]===g&&(w=HT(o,t),g=g+w.xExtra),s[1]===v?(w=HT(o,t),v=v-w.yExtra):s[1]===x&&(w=HT(o,t),x=x+w.yExtra)}return{x:d,y:v,width:g-d,height:x-v}}function HT(e,t){var r=e.prePoint,n=e.currentPoint,i=e.nextPoint,a=Math.pow(n[0]-r[0],2)+Math.pow(n[1]-r[1],2),o=Math.pow(n[0]-i[0],2)+Math.pow(n[1]-i[1],2),s=Math.pow(r[0]-i[0],2)+Math.pow(r[1]-i[1],2),l=Math.acos((a+o-s)/(2*Math.sqrt(a)*Math.sqrt(o)));if(!l||Math.sin(l)===0||UVt(l,0))return{xExtra:0,yExtra:0};var u=Math.abs(Math.atan2(i[1]-n[1],i[0]-n[0])),c=Math.abs(Math.atan2(i[0]-n[0],i[1]-n[1]));u=u>Math.PI/2?Math.PI-u:u,c=c>Math.PI/2?Math.PI-c:c;var f={xExtra:Math.cos(l/2-u)*(t/2*(1/Math.sin(l/2)))-t/2||0,yExtra:Math.cos(c-l/2)*(t/2*(1/Math.sin(l/2)))-t/2||0};return f}function NXt(e){var t=e.attr(),r=t.path,n=t.stroke,i=n?t.lineWidth:0,a=e.get("segments")||Rrt(r),o=BXt(a,i),s=o.x,l=o.y,u=o.width,c=o.height,f={minX:s,minY:l,maxX:s+u,maxY:l+c};return f=gN(e,f),{x:f.minX,y:f.minY,width:f.maxX-f.minX,height:f.maxY-f.minY}}function kXt(e){var t=e.attr(),r=t.x1,n=t.y1,i=t.x2,a=t.y2,o=Math.min(r,i),s=Math.max(r,i),l=Math.min(n,a),u=Math.max(n,a),c={minX:o,maxX:s,minY:l,maxY:u};return c=gN(e,c),{x:c.minX,y:c.minY,width:c.maxX-c.minX,height:c.maxY-c.minY}}function zXt(e){var t=e.attr(),r=t.x,n=t.y,i=t.rx,a=t.ry;return{x:r-i,y:n-a,width:i*2,height:a*2}}Jp("rect",yrt);Jp("image",yrt);Jp("circle",_rt);Jp("marker",_rt);Jp("polyline",wXt);Jp("polygon",CXt);Jp("text",AXt);Jp("path",NXt);Jp("line",kXt);Jp("ellipse",zXt);function UXt(){return window?window.devicePixelRatio:1}function Irt(e,t,r,n){var i=e-r,a=t-n;return Math.sqrt(i*i+a*a)}function Ty(e,t,r,n,i,a){return i>=e&&i<=e+r&&a>=t&&a<=t+n}function IC(e,t){return!(t.minX>e.maxX||t.maxX<e.minX||t.minY>e.maxY||t.maxY<e.minY)}function $Xt(e,t){return!e||!t?e||t:{minX:Math.min(e.minX,t.minX),minY:Math.min(e.minY,t.minY),maxX:Math.max(e.maxX,t.maxX),maxY:Math.max(e.maxY,t.maxY)}}function LG(e,t){return e[0]===t[0]&&e[1]===t[1]}var HXt=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,VXt=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,GXt=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,Lrt=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;function Ort(e,t){var r=e.match(Lrt);Ta(r,function(n){var i=n.split(":");t.addColorStop(i[0],i[1])})}function WXt(e,t,r){var n=HXt.exec(r),i=parseFloat(n[1])%360*(Math.PI/180),a=n[2],o=t.getBBox(),s,l;i>=0&&i<1/2*Math.PI?(s={x:o.minX,y:o.minY},l={x:o.maxX,y:o.maxY}):1/2*Math.PI<=i&&i<Math.PI?(s={x:o.maxX,y:o.minY},l={x:o.minX,y:o.maxY}):Math.PI<=i&&i<3/2*Math.PI?(s={x:o.maxX,y:o.maxY},l={x:o.minX,y:o.minY}):(s={x:o.minX,y:o.maxY},l={x:o.maxX,y:o.minY});var u=Math.tan(i),c=u*u,f=(l.x-s.x+u*(l.y-s.y))/(c+1)+s.x,d=u*(l.x-s.x+u*(l.y-s.y))/(c+1)+s.y,v=e.createLinearGradient(s.x,s.y,f,d);return Ort(a,v),v}function XXt(e,t,r){var n=VXt.exec(r),i=parseFloat(n[1]),a=parseFloat(n[2]),o=parseFloat(n[3]),s=n[4];if(o===0){var l=s.match(Lrt);return l[l.length-1].split(":")[1]}var u=t.getBBox(),c=u.maxX-u.minX,f=u.maxY-u.minY,d=Math.sqrt(c*c+f*f)/2,v=e.createRadialGradient(u.minX+c*i,u.minY+f*a,0,u.minX+c/2,u.minY+f/2,o*d);return Ort(s,v),v}function jXt(e,t,r){if(t.get("patternSource")&&t.get("patternSource")===r)return t.get("pattern");var n,i,a=GXt.exec(r),o=a[1],s=a[2];function l(){n=e.createPattern(i,o),t.set("pattern",n),t.set("patternSource",r)}switch(o){case"a":o="repeat";break;case"x":o="repeat-x";break;case"y":o="repeat-y";break;case"n":o="no-repeat";break;default:o="no-repeat"}return i=new Image,s.match(/^data:/i)||(i.crossOrigin="Anonymous"),i.src=s,i.complete?l():(i.onload=l,i.src=i.src),n}function YXt(e,t,r){var n=t.getBBox();if(isNaN(n.x)||isNaN(n.y)||isNaN(n.width)||isNaN(n.height))return r;if(Hd(r)){if(r[1]==="("||r[2]==="("){if(r[0]==="l")return WXt(e,t,r);if(r[0]==="r")return XXt(e,t,r);if(r[0]==="p")return jXt(e,t,r)}return r}if(r instanceof CanvasPattern)return r}function ZXt(e){var t=0,r=0,n=0,i=0;return Wf(e)?e.length===1?t=r=n=i=e[0]:e.length===2?(t=n=e[0],r=i=e[1]):e.length===3?(t=e[0],r=i=e[1],n=e[2]):(t=e[0],r=e[1],n=e[2],i=e[3]):t=r=n=i=e,[t,r,n,i]}function VT(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function GF(e,t){return VT(e)*VT(t)?(e[0]*t[0]+e[1]*t[1])/(VT(e)*VT(t)):1}function OG(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(GF(e,t))}function PG(e,t){var r=t[1],n=t[2],i=Het(Vet(t[3]),Math.PI*2),a=t[4],o=t[5],s=e[0],l=e[1],u=t[6],c=t[7],f=Math.cos(i)*(s-u)/2+Math.sin(i)*(l-c)/2,d=-1*Math.sin(i)*(s-u)/2+Math.cos(i)*(l-c)/2,v=f*f/(r*r)+d*d/(n*n);v>1&&(r*=Math.sqrt(v),n*=Math.sqrt(v));var g=r*r*(d*d)+n*n*(f*f),x=g?Math.sqrt((r*r*(n*n)-g)/g):1;a===o&&(x*=-1),isNaN(x)&&(x=0);var w=n?x*r*d/n:0,S=r?x*-n*f/r:0,A=(s+u)/2+Math.cos(i)*w-Math.sin(i)*S,M=(l+c)/2+Math.sin(i)*w+Math.cos(i)*S,R=[(f-w)/r,(d-S)/n],O=[(-1*f-w)/r,(-1*d-S)/n],N=OG([1,0],R),k=OG(R,O);return GF(R,O)<=-1&&(k=Math.PI),GF(R,O)>=1&&(k=0),o===0&&k>0&&(k=k-2*Math.PI),o===1&&k<0&&(k=k+2*Math.PI),{cx:A,cy:M,rx:LG(e,[u,c])?0:r,ry:LG(e,[u,c])?0:n,startAngle:N,endAngle:N+k,xRotation:i,arcFlag:a,sweepFlag:o}}var iR=Math.sin,aR=Math.cos,mN=Math.atan2,GT=Math.PI;function Prt(e,t,r,n,i,a,o){var s=t.stroke,l=t.lineWidth,u=r-i,c=n-a,f=mN(c,u),d=new EN({type:"path",canvas:e.get("canvas"),isArrowShape:!0,attrs:{path:"M"+10*aR(GT/6)+","+10*iR(GT/6)+" L0,0 L"+10*aR(GT/6)+",-"+10*iR(GT/6),stroke:s,lineWidth:l}});d.translate(i,a),d.rotateAtPoint(i,a,f),e.set(o?"startArrowShape":"endArrowShape",d)}function Drt(e,t,r,n,i,a,o){var s=t.startArrow,l=t.endArrow,u=t.stroke,c=t.lineWidth,f=o?s:l,d=f.d,v=f.fill,g=f.stroke,x=f.lineWidth,w=NI(f,["d","fill","stroke","lineWidth"]),S=r-i,A=n-a,M=mN(A,S);d&&(i=i-aR(M)*d,a=a-iR(M)*d);var R=new EN({type:"path",canvas:e.get("canvas"),isArrowShape:!0,attrs:Zt(Zt({},w),{stroke:g||u,lineWidth:x||c,fill:v})});R.translate(i,a),R.rotateAtPoint(i,a,M),e.set(o?"startArrowShape":"endArrowShape",R)}function By(e,t,r,n,i){var a=mN(n-t,r-e);return{dx:aR(a)*i,dy:iR(a)*i}}function yN(e,t,r,n,i,a){typeof t.startArrow=="object"?Drt(e,t,r,n,i,a,!0):t.startArrow?Prt(e,t,r,n,i,a,!0):e.set("startArrowShape",null)}function _N(e,t,r,n,i,a){typeof t.endArrow=="object"?Drt(e,t,r,n,i,a,!1):t.endArrow?Prt(e,t,r,n,i,a,!1):e.set("startArrowShape",null)}var DG={fill:"fillStyle",stroke:"strokeStyle",opacity:"globalAlpha"};function qx(e,t){var r=t.attr();for(var n in r){var i=r[n],a=DG[n]?DG[n]:n;a==="matrix"&&i?e.transform(i[0],i[1],i[3],i[4],i[6],i[7]):a==="lineDash"&&e.setLineDash?Wf(i)&&e.setLineDash(i):(a==="strokeStyle"||a==="fillStyle"?i=YXt(e,t,i):a==="globalAlpha"&&(i=i*e.globalAlpha),e[a]=i)}}function WF(e,t,r){for(var n=0;n<t.length;n++){var i=t[n];i.cfg.visible?i.draw(e,r):i.skipDraw()}}function qXt(e,t,r){var n=e.get("refreshElements");Ta(n,function(i){if(i!==e)for(var a=i.cfg.parent;a&&a!==e&&!a.cfg.refresh;)a.cfg.refresh=!0,a=a.cfg.parent}),n[0]===e?xN(t):XF(t,r)}function XF(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(n.cfg.visible)if(n.cfg.hasChanged)n.cfg.refresh=!0,n.isGroup()&&xN(n.cfg.children);else if(n.cfg.refresh)n.isGroup()&&XF(n.cfg.children,t);else{var i=KXt(n,t);n.cfg.refresh=i,i&&n.isGroup()&&XF(n.cfg.children,t)}}}function Frt(e){for(var t=0;t<e.length;t++){var r=e[t];r.cfg.hasChanged=!1,r.isGroup()&&!r.destroyed&&Frt(r.cfg.children)}}function xN(e,t){for(var r=0;r<e.length;r++){var n=e[r];n.cfg.visible&&(n.cfg.refresh=!0,n.isGroup()&&xN(n.get("children")))}}function KXt(e,t){var r=e.cfg.cacheCanvasBBox,n=e.cfg.isInView&&r&&IC(r,t);return n}function Brt(e,t,r,n){var i=r.path,a=r.startArrow,o=r.endArrow;if(i){var s=[0,0],l=[0,0],u={dx:0,dy:0};t.beginPath();for(var c=0;c<i.length;c++){var f=i[c],d=f[0];if(c===0&&a&&a.d){var v=e.getStartTangent();u=By(v[0][0],v[0][1],v[1][0],v[1][1],a.d)}else if(c===i.length-2&&i[c+1][0]==="Z"&&o&&o.d){var g=i[c+1];if(g[0]==="Z"){var v=e.getEndTangent();u=By(v[0][0],v[0][1],v[1][0],v[1][1],o.d)}}else if(c===i.length-1&&o&&o.d&&i[0]!=="Z"){var v=e.getEndTangent();u=By(v[0][0],v[0][1],v[1][0],v[1][1],o.d)}var x=u.dx,w=u.dy;switch(d){case"M":t.moveTo(f[1]-x,f[2]-w),l=[f[1],f[2]];break;case"L":t.lineTo(f[1]-x,f[2]-w);break;case"Q":t.quadraticCurveTo(f[1],f[2],f[3]-x,f[4]-w);break;case"C":t.bezierCurveTo(f[1],f[2],f[3],f[4],f[5]-x,f[6]-w);break;case"A":{var S=void 0;n?(S=n[c],S||(S=PG(s,f),n[c]=S)):S=PG(s,f);var A=S.cx,M=S.cy,R=S.rx,O=S.ry,N=S.startAngle,k=S.endAngle,V=S.xRotation,Q=S.sweepFlag;if(t.ellipse)t.ellipse(A,M,R,O,V,N,k,1-Q);else{var Y=R>O?R:O,X=R>O?1:R/O,tt=R>O?O/R:1;t.translate(A,M),t.rotate(V),t.scale(X,tt),t.arc(0,0,Y,N,k,1-Q),t.scale(1/X,1/tt),t.rotate(-V),t.translate(-A,-M)}break}case"Z":t.closePath();break}if(d==="Z")s=l;else{var it=f.length;s=[f[it-2],f[it-1]]}}}}function Nrt(e,t){var r=e.get("canvas");r&&(t==="remove"&&(e._cacheCanvasBBox=e.get("cacheCanvasBBox")),e.get("hasChanged")||(e.set("hasChanged",!0),e.cfg.parent&&e.cfg.parent.get("hasChanged")||(r.refreshElement(e,t,r),r.get("autoDraw")&&r.draw())))}function QXt(e){var t;if(e.destroyed)t=e._cacheCanvasBBox;else{var r=e.get("cacheCanvasBBox"),n=r&&!!(r.width&&r.height),i=e.getCanvasBBox(),a=i&&!!(i.width&&i.height);n&&a?t=$Xt(r,i):n?t=r:a&&(t=i)}return t}function JXt(e){if(!e.length)return null;var t=[],r=[],n=[],i=[];return Ta(e,function(a){var o=QXt(a);o&&(t.push(o.minX),r.push(o.minY),n.push(o.maxX),i.push(o.maxY))}),{minX:Qm(t),minY:Qm(r),maxX:Km(n),maxY:Km(i)}}function tjt(e,t){return!e||!t||!IC(e,t)?null:{minX:Math.max(e.minX,t.minX),minY:Math.max(e.minY,t.minY),maxX:Math.min(e.maxX,t.maxX),maxY:Math.min(e.maxY,t.maxY)}}var tv=function(e){en(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.onCanvasChange=function(r){Nrt(this,r)},t.prototype.getShapeBase=function(){return lN},t.prototype.getGroupBase=function(){return t},t.prototype._applyClip=function(r,n){n&&(r.save(),qx(r,n),n.createPath(r),r.restore(),r.clip(),n._afterDraw())},t.prototype.cacheCanvasBBox=function(){var r=this.cfg.children,n=[],i=[];Ta(r,function(d){var v=d.cfg.cacheCanvasBBox;v&&d.cfg.isInView&&(n.push(v.minX,v.maxX),i.push(v.minY,v.maxY))});var a=null;if(n.length){var o=Qm(n),s=Km(n),l=Qm(i),u=Km(i);a={minX:o,minY:l,x:o,y:l,maxX:s,maxY:u,width:s-o,height:u-l};var c=this.cfg.canvas;if(c){var f=c.getViewRange();this.set("isInView",IC(a,f))}}else this.set("isInView",!1);this.set("cacheCanvasBBox",a)},t.prototype.draw=function(r,n){var i=this.cfg.children,a=n?this.cfg.refresh:!0;i.length&&a&&(r.save(),qx(r,this),this._applyClip(r,this.getClip()),WF(r,i,n),r.restore(),this.cacheCanvasBBox()),this.cfg.refresh=null,this.set("hasChanged",!1)},t.prototype.skipDraw=function(){this.set("cacheCanvasBBox",null),this.set("hasChanged",!1)},t}(oXt),ejt=function(e){en(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultAttrs=function(){var r=e.prototype.getDefaultAttrs.call(this);return Zt(Zt({},r),{lineWidth:1,lineAppendWidth:0,strokeOpacity:1,fillOpacity:1})},t.prototype.getShapeBase=function(){return lN},t.prototype.getGroupBase=function(){return tv},t.prototype.onCanvasChange=function(r){Nrt(this,r)},t.prototype.calculateBBox=function(){var r=this.get("type"),n=this.getHitLineWidth(),i=lXt(r),a=i(this),o=n/2,s=a.x-o,l=a.y-o,u=a.x+a.width+o,c=a.y+a.height+o;return{x:s,minX:s,y:l,minY:l,width:a.width+n,height:a.height+n,maxX:u,maxY:c}},t.prototype.isFill=function(){return!!this.attrs.fill||this.isClipShape()},t.prototype.isStroke=function(){return!!this.attrs.stroke},t.prototype._applyClip=function(r,n){n&&(r.save(),qx(r,n),n.createPath(r),r.restore(),r.clip(),n._afterDraw())},t.prototype.draw=function(r,n){var i=this.cfg.clipShape;if(n){if(this.cfg.refresh===!1){this.set("hasChanged",!1);return}var a=this.getCanvasBBox();if(!IC(n,a)){this.set("hasChanged",!1),this.cfg.isInView&&this._afterDraw();return}}r.save(),qx(r,this),this._applyClip(r,i),this.drawPath(r),r.restore(),this._afterDraw()},t.prototype.getCanvasViewBox=function(){var r=this.cfg.canvas;return r?r.getViewRange():null},t.prototype.cacheCanvasBBox=function(){var r=this.getCanvasViewBox();if(r){var n=this.getCanvasBBox(),i=IC(n,r);this.set("isInView",i),i?this.set("cacheCanvasBBox",n):this.set("cacheCanvasBBox",null)}},t.prototype._afterDraw=function(){this.cacheCanvasBBox(),this.set("hasChanged",!1),this.set("refresh",null)},t.prototype.skipDraw=function(){this.set("cacheCanvasBBox",null),this.set("isInView",null),this.set("hasChanged",!1)},t.prototype.drawPath=function(r){this.createPath(r),this.strokeAndFill(r),this.afterDrawPath(r)},t.prototype.fill=function(r){r.fill()},t.prototype.stroke=function(r){r.stroke()},t.prototype.strokeAndFill=function(r){var n=this.attrs,i=n.lineWidth,a=n.opacity,o=n.strokeOpacity,s=n.fillOpacity;this.isFill()&&(!xl(s)&&s!==1?(r.globalAlpha=s,this.fill(r),r.globalAlpha=a):this.fill(r)),this.isStroke()&&i>0&&(!xl(o)&&o!==1&&(r.globalAlpha=o),this.stroke(r)),this.afterDrawPath(r)},t.prototype.createPath=function(r){},t.prototype.afterDrawPath=function(r){},t.prototype.isInShape=function(r,n){var i=this.isStroke(),a=this.isFill(),o=this.getHitLineWidth();return this.isInStrokeOrPath(r,n,i,a,o)},t.prototype.isInStrokeOrPath=function(r,n,i,a,o){return!1},t.prototype.getHitLineWidth=function(){if(!this.isStroke())return 0;var r=this.attrs;return r.lineWidth+r.lineAppendWidth},t}(sXt),qd=ejt,rjt=function(e){en(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultAttrs=function(){var r=e.prototype.getDefaultAttrs.call(this);return Zt(Zt({},r),{x:0,y:0,r:0})},t.prototype.isInStrokeOrPath=function(r,n,i,a,o){var s=this.attr(),l=s.x,u=s.y,c=s.r,f=o/2,d=Irt(l,u,r,n);return a&&i?d<=c+f:a?d<=c:i?d>=c-f&&d<=c+f:!1},t.prototype.createPath=function(r){var n=this.attr(),i=n.x,a=n.y,o=n.r;r.beginPath(),r.arc(i,a,o,0,Math.PI*2,!1),r.closePath()},t}(qd),njt=rjt;function WT(e,t,r,n){return e/(r*r)+t/(n*n)}var ijt=function(e){en(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultAttrs=function(){var r=e.prototype.getDefaultAttrs.call(this);return Zt(Zt({},r),{x:0,y:0,rx:0,ry:0})},t.prototype.isInStrokeOrPath=function(r,n,i,a,o){var s=this.attr(),l=o/2,u=s.x,c=s.y,f=s.rx,d=s.ry,v=(r-u)*(r-u),g=(n-c)*(n-c);return a&&i?WT(v,g,f+l,d+l)<=1:a?WT(v,g,f,d)<=1:i?WT(v,g,f-l,d-l)>=1&&WT(v,g,f+l,d+l)<=1:!1},t.prototype.createPath=function(r){var n=this.attr(),i=n.x,a=n.y,o=n.rx,s=n.ry;if(r.beginPath(),r.ellipse)r.ellipse(i,a,o,s,0,0,Math.PI*2,!1);else{var l=o>s?o:s,u=o>s?1:o/s,c=o>s?s/o:1;r.save(),r.translate(i,a),r.scale(u,c),r.arc(0,0,l,0,Math.PI*2),r.restore(),r.closePath()}},t}(qd),ajt=ijt;function FG(e){return e instanceof HTMLElement&&Hd(e.nodeName)&&e.nodeName.toUpperCase()==="CANVAS"}var ojt=function(e){en(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultAttrs=function(){var r=e.prototype.getDefaultAttrs.call(this);return Zt(Zt({},r),{x:0,y:0,width:0,height:0})},t.prototype.initAttrs=function(r){this._setImage(r.img)},t.prototype.isStroke=function(){return!1},t.prototype.isOnlyHitBox=function(){return!0},t.prototype._afterLoading=function(){if(this.get("toDraw")===!0){var r=this.get("canvas");r?r.draw():this.createPath(this.get("context"))}},t.prototype._setImage=function(r){var n=this,i=this.attrs;if(Hd(r)){var a=new Image;a.onload=function(){if(n.destroyed)return!1;n.attr("img",a),n.set("loading",!1),n._afterLoading();var o=n.get("callback");o&&o.call(n)},a.crossOrigin="Anonymous",a.src=r,this.set("loading",!0)}else r instanceof Image?(i.width||(i.width=r.width),i.height||(i.height=r.height)):FG(r)&&(i.width||(i.width=Number(r.getAttribute("width"))),i.height||(i.height,Number(r.getAttribute("height"))))},t.prototype.onAttrChange=function(r,n,i){e.prototype.onAttrChange.call(this,r,n,i),r==="img"&&this._setImage(n)},t.prototype.createPath=function(r){if(this.get("loading")){this.set("toDraw",!0),this.set("context",r);return}var n=this.attr(),i=n.x,a=n.y,o=n.width,s=n.height,l=n.sx,u=n.sy,c=n.swidth,f=n.sheight,d=n.img;(d instanceof Image||FG(d))&&(!xl(l)&&!xl(u)&&!xl(c)&&!xl(f)?r.drawImage(d,l,u,c,f,i,a,o,s):r.drawImage(d,i,a,o,s))},t}(qd),bN=ojt;function Im(e,t,r,n,i,a,o){var s=Math.min(e,r),l=Math.max(e,r),u=Math.min(t,n),c=Math.max(t,n),f=i/2;return a>=s-f&&a<=l+f&&o>=u-f&&o<=c+f?Gc.pointToLine(e,t,r,n,a,o)<=i/2:!1}var sjt=function(e){en(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultAttrs=function(){var r=e.prototype.getDefaultAttrs.call(this);return Zt(Zt({},r),{x1:0,y1:0,x2:0,y2:0,startArrow:!1,endArrow:!1})},t.prototype.initAttrs=function(r){this.setArrow()},t.prototype.onAttrChange=function(r,n,i){e.prototype.onAttrChange.call(this,r,n,i),this.setArrow()},t.prototype.setArrow=function(){var r=this.attr(),n=r.x1,i=r.y1,a=r.x2,o=r.y2,s=r.startArrow,l=r.endArrow;s&&yN(this,r,a,o,n,i),l&&_N(this,r,n,i,a,o)},t.prototype.isInStrokeOrPath=function(r,n,i,a,o){if(!i||!o)return!1;var s=this.attr(),l=s.x1,u=s.y1,c=s.x2,f=s.y2;return Im(l,u,c,f,o,r,n)},t.prototype.createPath=function(r){var n=this.attr(),i=n.x1,a=n.y1,o=n.x2,s=n.y2,l=n.startArrow,u=n.endArrow,c={dx:0,dy:0},f={dx:0,dy:0};l&&l.d&&(c=By(i,a,o,s,n.startArrow.d)),u&&u.d&&(f=By(i,a,o,s,n.endArrow.d)),r.beginPath(),r.moveTo(i+c.dx,a+c.dy),r.lineTo(o-f.dx,s-f.dy)},t.prototype.afterDrawPath=function(r){var n=this.get("startArrowShape"),i=this.get("endArrowShape");n&&n.draw(r),i&&i.draw(r)},t.prototype.getTotalLength=function(){var r=this.attr(),n=r.x1,i=r.y1,a=r.x2,o=r.y2;return Gc.length(n,i,a,o)},t.prototype.getPoint=function(r){var n=this.attr(),i=n.x1,a=n.y1,o=n.x2,s=n.y2;return Gc.pointAt(i,a,o,s,r)},t}(qd),ljt=sjt,ujt={circle:function(e,t,r){return[["M",e-r,t],["A",r,r,0,1,0,e+r,t],["A",r,r,0,1,0,e-r,t]]},square:function(e,t,r){return[["M",e-r,t-r],["L",e+r,t-r],["L",e+r,t+r],["L",e-r,t+r],["Z"]]},diamond:function(e,t,r){return[["M",e-r,t],["L",e,t-r],["L",e+r,t],["L",e,t+r],["Z"]]},triangle:function(e,t,r){var n=r*Math.sin(.3333333333333333*Math.PI);return[["M",e-r,t+n],["L",e,t-n],["L",e+r,t+n],["Z"]]},"triangle-down":function(e,t,r){var n=r*Math.sin(.3333333333333333*Math.PI);return[["M",e-r,t-n],["L",e+r,t-n],["L",e,t+n],["Z"]]}},cjt=function(e){en(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.initAttrs=function(r){this._resetParamsCache()},t.prototype._resetParamsCache=function(){this.set("paramsCache",{})},t.prototype.onAttrChange=function(r,n,i){e.prototype.onAttrChange.call(this,r,n,i),["symbol","x","y","r","radius"].indexOf(r)!==-1&&this._resetParamsCache()},t.prototype.isOnlyHitBox=function(){return!0},t.prototype._getR=function(r){return xl(r.r)?r.radius:r.r},t.prototype._getPath=function(){var r=this.attr(),n=r.x,i=r.y,a=r.symbol||"circle",o=this._getR(r),s,l;if(e_(a))s=a,l=s(n,i,o),l=Mrt(l);else{if(s=t.Symbols[a],!s)return console.warn(a+" marker is not supported."),null;l=s(n,i,o)}return l},t.prototype.createPath=function(r){var n=this._getPath(),i=this.get("paramsCache");Brt(this,r,{path:n},i)},t.Symbols=ujt,t}(qd),hjt=cjt;function krt(e,t,r){var n=Srt();return e.createPath(n),n.isPointInPath(t,r)}var fjt=1e-6;function jO(e){return Math.abs(e)<fjt?0:e<0?-1:1}function djt(e,t,r){return(r[0]-e[0])*(t[1]-e[1])===(t[0]-e[0])*(r[1]-e[1])&&Math.min(e[0],t[0])<=r[0]&&r[0]<=Math.max(e[0],t[0])&&Math.min(e[1],t[1])<=r[1]&&r[1]<=Math.max(e[1],t[1])}function zrt(e,t,r){var n=!1,i=e.length;if(i<=2)return!1;for(var a=0;a<i;a++){var o=e[a],s=e[(a+1)%i];if(djt(o,s,[t,r]))return!0;jO(o[1]-r)>0!=jO(s[1]-r)>0&&jO(t-(r-o[1])*(o[0]-s[0])/(o[1]-s[1])-o[0])<0&&(n=!n)}return n}function Cw(e,t,r,n,i,a,o,s){var l=(Math.atan2(s-t,o-e)+Math.PI*2)%(Math.PI*2);if(l<n||l>i)return!1;var u={x:e+r*Math.cos(l),y:t+r*Math.sin(l)};return Irt(u.x,u.y,o,s)<=a/2}var pjt=Jet;function vjt(e){for(var t=!1,r=e.length,n=0;n<r;n++){var i=e[n],a=i[0];if(a==="C"||a==="A"||a==="Q"){t=!0;break}}return t}function gjt(e,t,r,n,i){for(var a=!1,o=t/2,s=0;s<e.length;s++){var l=e[s],u=l.currentPoint,c=l.params,f=l.prePoint,d=l.box;if(!(d&&!Ty(d.x-o,d.y-o,d.width+t,d.height+t,r,n))){switch(l.command){case"L":case"Z":a=Im(f[0],f[1],u[0],u[1],t,r,n);break;case"Q":var v=Ert.pointDistance(f[0],f[1],c[1],c[2],c[3],c[4],r,n);a=v<=t/2;break;case"C":var g=Hw.pointDistance(f[0],f[1],c[1],c[2],c[3],c[4],c[5],c[6],r,n,i);a=g<=t/2;break;case"A":var x=l.arcParams,w=x.cx,S=x.cy,A=x.rx,M=x.ry,R=x.startAngle,O=x.endAngle,N=x.xRotation,k=[r,n,1],V=A>M?A:M,Q=A>M?1:A/M,Y=A>M?M/A:1,X=pjt(null,[["t",-w,-S],["r",-N],["s",1/Q,1/Y]]);LGt(k,k,X),a=Cw(0,0,V,R,O,t,k[0],k[1]);break}if(a)break}}return a}function mjt(e){for(var t=e.length,r=[],n=[],i=[],a=0;a<t;a++){var o=e[a],s=o[0];s==="M"?(i.length&&(n.push(i),i=[]),i.push([o[1],o[2]])):s==="Z"?i.length&&(r.push(i),i=[]):i.push([o[1],o[2]])}return i.length>0&&n.push(i),{polygons:r,polylines:n}}var XT=Zt({hasArc:vjt,extractPolygons:mjt,isPointInStroke:gjt},cGt);function BG(e,t,r){for(var n=!1,i=0;i<e.length;i++){var a=e[i];if(n=zrt(a,t,r),n)break}return n}var yjt=function(e){en(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultAttrs=function(){var r=e.prototype.getDefaultAttrs.call(this);return Zt(Zt({},r),{startArrow:!1,endArrow:!1})},t.prototype.initAttrs=function(r){this._setPathArr(r.path),this.setArrow()},t.prototype.onAttrChange=function(r,n,i){e.prototype.onAttrChange.call(this,r,n,i),r==="path"&&this._setPathArr(n),this.setArrow()},t.prototype._setPathArr=function(r){this.attrs.path=Mrt(r);var n=XT.hasArc(r);this.set("hasArc",n),this.set("paramsCache",{}),this.set("segments",null),this.set("curve",null),this.set("tCache",null),this.set("totalLength",null)},t.prototype.getSegments=function(){var r=this.get("segements");return r||(r=Rrt(this.attr("path")),this.set("segments",r)),r},t.prototype.setArrow=function(){var r=this.attr(),n=r.startArrow,i=r.endArrow;if(n){var a=this.getStartTangent();yN(this,r,a[0][0],a[0][1],a[1][0],a[1][1])}if(i){var a=this.getEndTangent();_N(this,r,a[0][0],a[0][1],a[1][0],a[1][1])}},t.prototype.isInStrokeOrPath=function(r,n,i,a,o){var s=this.getSegments(),l=this.get("hasArc"),u=!1;if(i){var c=this.getTotalLength();u=XT.isPointInStroke(s,o,r,n,c)}if(!u&&a)if(l)u=krt(this,r,n);else{var f=this.attr("path"),d=XT.extractPolygons(f);u=BG(d.polygons,r,n)||BG(d.polylines,r,n)}return u},t.prototype.createPath=function(r){var n=this.attr(),i=this.get("paramsCache");Brt(this,r,n,i)},t.prototype.afterDrawPath=function(r){var n=this.get("startArrowShape"),i=this.get("endArrowShape");n&&n.draw(r),i&&i.draw(r)},t.prototype.getTotalLength=function(){var r=this.get("totalLength");return xl(r)?(this._calculateCurve(),this._setTcache(),this.get("totalLength")):r},t.prototype.getPoint=function(r){var n=this.get("tCache");n||(this._calculateCurve(),this._setTcache(),n=this.get("tCache"));var i,a,o=this.get("curve");if(!n||n.length===0)return o?{x:o[0][1],y:o[0][2]}:null;Ta(n,function(c,f){r>=c[0]&&r<=c[1]&&(i=(r-c[0])/(c[1]-c[0]),a=f)});var s=o[a];if(xl(s)||xl(a))return null;var l=s.length,u=o[a+1];return Hw.pointAt(s[l-2],s[l-1],u[1],u[2],u[3],u[4],u[5],u[6],i)},t.prototype._calculateCurve=function(){var r=this.attr().path;this.set("curve",XT.pathToCurve(r))},t.prototype._setTcache=function(){var r=0,n=0,i=[],a,o,s,l,u=this.get("curve");if(u){if(Ta(u,function(c,f){s=u[f+1],l=c.length,s&&(r+=Hw.length(c[l-2],c[l-1],s[1],s[2],s[3],s[4],s[5],s[6])||0)}),this.set("totalLength",r),r===0){this.set("tCache",[]);return}Ta(u,function(c,f){s=u[f+1],l=c.length,s&&(a=[],a[0]=n/r,o=Hw.length(c[l-2],c[l-1],s[1],s[2],s[3],s[4],s[5],s[6]),n+=o||0,a[1]=n/r,i.push(a))}),this.set("tCache",i)}},t.prototype.getStartTangent=function(){var r=this.getSegments(),n;if(r.length>1){var i=r[0].currentPoint,a=r[1].currentPoint,o=r[1].startTangent;n=[],o?(n.push([i[0]-o[0],i[1]-o[1]]),n.push([i[0],i[1]])):(n.push([a[0],a[1]]),n.push([i[0],i[1]]))}return n},t.prototype.getEndTangent=function(){var r=this.getSegments(),n=r.length,i;if(n>1){var a=r[n-2].currentPoint,o=r[n-1].currentPoint,s=r[n-1].endTangent;i=[],s?(i.push([o[0]-s[0],o[1]-s[1]]),i.push([o[0],o[1]])):(i.push([a[0],a[1]]),i.push([o[0],o[1]]))}return i},t}(qd),EN=yjt;function Urt(e,t,r,n,i){var a=e.length;if(a<2)return!1;for(var o=0;o<a-1;o++){var s=e[o][0],l=e[o][1],u=e[o+1][0],c=e[o+1][1];if(Im(s,l,u,c,t,r,n))return!0}if(i){var f=e[0],d=e[a-1];if(Im(f[0],f[1],d[0],d[1],t,r,n))return!0}return!1}var _jt=function(e){en(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.isInStrokeOrPath=function(r,n,i,a,o){var s=this.attr().points,l=!1;return i&&(l=Urt(s,o,r,n,!0)),!l&&a&&(l=zrt(s,r,n)),l},t.prototype.createPath=function(r){var n=this.attr(),i=n.points;if(!(i.length<2)){r.beginPath();for(var a=0;a<i.length;a++){var o=i[a];a===0?r.moveTo(o[0],o[1]):r.lineTo(o[0],o[1])}r.closePath()}},t}(qd),xjt=_jt,bjt=function(e){en(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultAttrs=function(){var r=e.prototype.getDefaultAttrs.call(this);return Zt(Zt({},r),{startArrow:!1,endArrow:!1})},t.prototype.initAttrs=function(r){this.setArrow()},t.prototype.onAttrChange=function(r,n,i){e.prototype.onAttrChange.call(this,r,n,i),this.setArrow(),["points"].indexOf(r)!==-1&&this._resetCache()},t.prototype._resetCache=function(){this.set("totalLength",null),this.set("tCache",null)},t.prototype.setArrow=function(){var r=this.attr(),n=this.attrs,i=n.points,a=n.startArrow,o=n.endArrow,s=i.length,l=i[0][0],u=i[0][1],c=i[s-1][0],f=i[s-1][1];a&&yN(this,r,i[1][0],i[1][1],l,u),o&&_N(this,r,i[s-2][0],i[s-2][1],c,f)},t.prototype.isFill=function(){return!1},t.prototype.isInStrokeOrPath=function(r,n,i,a,o){if(!i||!o)return!1;var s=this.attr().points;return Urt(s,o,r,n,!1)},t.prototype.isStroke=function(){return!0},t.prototype.createPath=function(r){var n=this.attr(),i=n.points,a=n.startArrow,o=n.endArrow,s=i.length;if(!(i.length<2)){var l=i[0][0],u=i[0][1],c=i[s-1][0],f=i[s-1][1];if(a&&a.d){var d=By(l,u,i[1][0],i[1][1],a.d);l+=d.dx,u+=d.dy}if(o&&o.d){var d=By(i[s-2][0],i[s-2][1],c,f,o.d);c-=d.dx,f-=d.dy}r.beginPath(),r.moveTo(l,u);for(var v=0;v<s-1;v++){var g=i[v];r.lineTo(g[0],g[1])}r.lineTo(c,f)}},t.prototype.afterDrawPath=function(r){var n=this.get("startArrowShape"),i=this.get("endArrowShape");n&&n.draw(r),i&&i.draw(r)},t.prototype.getTotalLength=function(){var r=this.attr().points,n=this.get("totalLength");return xl(n)?(this.set("totalLength",EXt.length(r)),this.get("totalLength")):n},t.prototype.getPoint=function(r){var n=this.attr().points,i=this.get("tCache");i||(this._setTcache(),i=this.get("tCache"));var a,o;return Ta(i,function(s,l){r>=s[0]&&r<=s[1]&&(a=(r-s[0])/(s[1]-s[0]),o=l)}),Gc.pointAt(n[o][0],n[o][1],n[o+1][0],n[o+1][1],a)},t.prototype._setTcache=function(){var r=this.attr().points;if(!(!r||r.length===0)){var n=this.getTotalLength();if(!(n<=0)){var i=0,a=[],o,s;Ta(r,function(l,u){r[u+1]&&(o=[],o[0]=i/n,s=Gc.length(l[0],l[1],r[u+1][0],r[u+1][1]),i+=s,o[1]=i/n,a.push(o))}),this.set("tCache",a)}}},t.prototype.getStartTangent=function(){var r=this.attr().points,n=[];return n.push([r[1][0],r[1][1]]),n.push([r[0][0],r[0][1]]),n},t.prototype.getEndTangent=function(){var r=this.attr().points,n=r.length-1,i=[];return i.push([r[n-1][0],r[n-1][1]]),i.push([r[n][0],r[n][1]]),i},t}(qd),Ejt=bjt;function wjt(e,t,r,n,i,a,o){var s=i/2;return Ty(e-s,t-s,r,i,a,o)||Ty(e+r-s,t-s,i,n,a,o)||Ty(e+s,t+n-s,r,i,a,o)||Ty(e-s,t+s,i,n,a,o)}function Cjt(e,t,r,n,i,a,o,s){return Im(e+i,t,e+r-i,t,a,o,s)||Im(e+r,t+i,e+r,t+n-i,a,o,s)||Im(e+r-i,t+n,e+i,t+n,a,o,s)||Im(e,t+n-i,e,t+i,a,o,s)||Cw(e+r-i,t+i,i,1.5*Math.PI,2*Math.PI,a,o,s)||Cw(e+r-i,t+n-i,i,0,.5*Math.PI,a,o,s)||Cw(e+i,t+n-i,i,.5*Math.PI,Math.PI,a,o,s)||Cw(e+i,t+i,i,Math.PI,1.5*Math.PI,a,o,s)}var Sjt=function(e){en(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultAttrs=function(){var r=e.prototype.getDefaultAttrs.call(this);return Zt(Zt({},r),{x:0,y:0,width:0,height:0,radius:0})},t.prototype.isInStrokeOrPath=function(r,n,i,a,o){var s=this.attr(),l=s.x,u=s.y,c=s.width,f=s.height,d=s.radius;if(d){var g=!1;return i&&(g=Cjt(l,u,c,f,d,o,r,n)),!g&&a&&(g=krt(this,r,n)),g}else{var v=o/2;if(a&&i)return Ty(l-v,u-v,c+v,f+v,r,n);if(a)return Ty(l,u,c,f,r,n);if(i)return wjt(l,u,c,f,o,r,n)}},t.prototype.createPath=function(r){var n=this.attr(),i=n.x,a=n.y,o=n.width,s=n.height,l=n.radius;if(r.beginPath(),l===0)r.rect(i,a,o,s);else{var u=ZXt(l),c=u[0],f=u[1],d=u[2],v=u[3];r.moveTo(i+c,a),r.lineTo(i+o-f,a),f!==0&&r.arc(i+o-f,a+f,f,-Math.PI/2,0),r.lineTo(i+o,a+s-d),d!==0&&r.arc(i+o-d,a+s-d,d,0,Math.PI/2),r.lineTo(i+v,a+s),v!==0&&r.arc(i+v,a+s-v,v,Math.PI/2,Math.PI),r.lineTo(i,a+c),c!==0&&r.arc(i+c,a+c,c,Math.PI,Math.PI*1.5),r.closePath()}},t}(qd),Tjt=Sjt,Ajt=function(e){en(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultAttrs=function(){var r=e.prototype.getDefaultAttrs.call(this);return Zt(Zt({},r),{x:0,y:0,text:null,fontSize:12,fontFamily:"sans-serif",fontStyle:"normal",fontWeight:"normal",fontVariant:"normal",textAlign:"start",textBaseline:"bottom"})},t.prototype.isOnlyHitBox=function(){return!0},t.prototype.initAttrs=function(r){this._assembleFont(),r.text&&this._setText(r.text)},t.prototype._assembleFont=function(){var r=this.attrs;r.font=Art(r)},t.prototype._setText=function(r){var n=null;Hd(r)&&r.indexOf(`
`)!==-1&&(n=r.split(`
`)),this.set("textArr",n)},t.prototype.onAttrChange=function(r,n,i){e.prototype.onAttrChange.call(this,r,n,i),r.startsWith("font")&&this._assembleFont(),r==="text"&&this._setText(n)},t.prototype._getSpaceingY=function(){var r=this.attrs,n=r.lineHeight,i=r.fontSize*1;return n?n-i:i*.14},t.prototype._drawTextArr=function(r,n,i){var a=this.attrs,o=a.textBaseline,s=a.x,l=a.y,u=a.fontSize*1,c=this._getSpaceingY(),f=Trt(a.text,a.fontSize,a.lineHeight),d;Ta(n,function(v,g){d=l+g*(c+u)-f+u,o==="middle"&&(d+=f-u-(f-u)/2),o==="top"&&(d+=f-u),xl(v)||(i?r.fillText(v,s,d):r.strokeText(v,s,d))})},t.prototype._drawText=function(r,n){var i=this.attr(),a=i.x,o=i.y,s=this.get("textArr");if(s)this._drawTextArr(r,s,n);else{var l=i.text;xl(l)||(n?r.fillText(l,a,o):r.strokeText(l,a,o))}},t.prototype.strokeAndFill=function(r){var n=this.attrs,i=n.lineWidth,a=n.opacity,o=n.strokeOpacity,s=n.fillOpacity;this.isStroke()&&i>0&&(!xl(o)&&o!==1&&(r.globalAlpha=a),this.stroke(r)),this.isFill()&&(!xl(s)&&s!==1?(r.globalAlpha=s,this.fill(r),r.globalAlpha=a):this.fill(r)),this.afterDrawPath(r)},t.prototype.fill=function(r){this._drawText(r,!0)},t.prototype.stroke=function(r){this._drawText(r,!1)},t}(qd),Mjt=Ajt;function Rjt(e,t){if(t){var r=trt(t);return Cy(r,e)}return e}function $rt(e,t,r){var n=e.getTotalMatrix();if(n){var i=Rjt([t,r,1],n),a=i[0],o=i[1];return[a,o]}return[t,r]}function NG(e,t,r){if(e.isCanvas&&e.isCanvas())return!0;if(!OF(e)||e.cfg.isInView===!1)return!1;if(e.cfg.clipShape){var n=$rt(e,t,r),i=n[0],a=n[1];if(e.isClipped(i,a))return!1}var o=e.cfg.cacheCanvasBBox||e.getCanvasBBox();return t>=o.minX&&t<=o.maxX&&r>=o.minY&&r<=o.maxY}function Hrt(e,t,r){if(!NG(e,t,r))return null;for(var n=null,i=e.getChildren(),a=i.length,o=a-1;o>=0;o--){var s=i[o];if(s.isGroup())n=Hrt(s,t,r);else if(NG(s,t,r)){var l=s,u=$rt(s,t,r),c=u[0],f=u[1];l.isInShape(c,f)&&(n=s)}if(n)break}return n}var kG=function(e){en(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultCfg=function(){var r=e.prototype.getDefaultCfg.call(this);return r.renderer="canvas",r.autoDraw=!0,r.localRefresh=!0,r.refreshElements=[],r.clipView=!0,r.quickHit=!1,r},t.prototype.onCanvasChange=function(r){(r==="attr"||r==="sort"||r==="changeSize")&&(this.set("refreshElements",[this]),this.draw())},t.prototype.getShapeBase=function(){return lN},t.prototype.getGroupBase=function(){return tv},t.prototype.getPixelRatio=function(){var r=this.get("pixelRatio")||UXt();return r>=1?Math.ceil(r):1},t.prototype.getViewRange=function(){return{minX:0,minY:0,maxX:this.cfg.width,maxY:this.cfg.height}},t.prototype.createDom=function(){var r=document.createElement("canvas"),n=r.getContext("2d");return this.set("context",n),r},t.prototype.setDOMSize=function(r,n){e.prototype.setDOMSize.call(this,r,n);var i=this.get("context"),a=this.get("el"),o=this.getPixelRatio();a.width=o*r,a.height=o*n,o>1&&i.scale(o,o)},t.prototype.clear=function(){e.prototype.clear.call(this),this._clearFrame();var r=this.get("context"),n=this.get("el");r.clearRect(0,0,n.width,n.height)},t.prototype.getShape=function(r,n){var i;return this.get("quickHit")?i=Hrt(this,r,n):i=e.prototype.getShape.call(this,r,n,null),i},t.prototype._getRefreshRegion=function(){var r=this.get("refreshElements"),n=this.getViewRange(),i;if(r.length&&r[0]===this)i=n;else if(i=JXt(r),i){i.minX=Math.floor(i.minX),i.minY=Math.floor(i.minY),i.maxX=Math.ceil(i.maxX),i.maxY=Math.ceil(i.maxY),i.maxY+=1;var a=this.get("clipView");a&&(i=tjt(i,n))}return i},t.prototype.refreshElement=function(r){var n=this.get("refreshElements");n.push(r)},t.prototype._clearFrame=function(){var r=this.get("drawFrame");r&&(WVt(r),this.set("drawFrame",null),this.set("refreshElements",[]))},t.prototype.draw=function(){var r=this.get("drawFrame");this.get("autoDraw")&&r||this._startDraw()},t.prototype._drawAll=function(){var r=this.get("context"),n=this.get("el"),i=this.getChildren();r.clearRect(0,0,n.width,n.height),qx(r,this),WF(r,i),this.set("refreshElements",[])},t.prototype._drawRegion=function(){var r=this.get("context"),n=this.get("refreshElements"),i=this.getChildren(),a=this._getRefreshRegion();a?(r.clearRect(a.minX,a.minY,a.maxX-a.minX,a.maxY-a.minY),r.save(),r.beginPath(),r.rect(a.minX,a.minY,a.maxX-a.minX,a.maxY-a.minY),r.clip(),qx(r,this),qXt(this,i,a),WF(r,i,a),r.restore()):n.length&&Frt(n),Ta(n,function(o){o.get("hasChanged")&&o.set("hasChanged",!1)}),this.set("refreshElements",[])},t.prototype._startDraw=function(){var r=this,n=this.get("drawFrame");n||(n=GVt(function(){r.get("localRefresh")?r._drawRegion():r._drawAll(),r.set("drawFrame",null)}),this.set("drawFrame",n))},t.prototype.skipDraw=function(){},t.prototype.removeDom=function(){var r=this.get("el");r.width=0,r.height=0,r.parentNode.removeChild(r)},t}(aXt),jc="$$value$$",Pi="$$extra$$",wN="$$origin$$",Ijt="$$extra_column$$",jp="$$total$$",UA="$$multi$$",n_="$$series_number$$",T_="$$empty_field_value$$",CN="$$empty_extra_placeholder$$",zG;(function(e){e.DATA_CELL_CLICK_EVENT="interaction:data-cell-click",e.MERGED_CELLS_CLICK_EVENT="interaction:merged-cells-click",e.CORNER_TEXT_CLICK_EVENT="interaction:corner-cell-text-click",e.ROW_COLUMN_CLICK_EVENT="interaction:row-column-click",e.ROW_TEXT_CLICK_EVENT="interaction:row-text-click",e.HOVER_EVENT="interaction:hover",e.TREND_ICON_CLICK="interaction:trend-icon-click"})(zG||(zG={}));var tc;(function(e){e.MOUSE_DOWN="mousedown",e.MOUSE_MOVE="mousemove",e.MOUSE_OUT="mouseout",e.MOUSE_LEAVE="mouseleave",e.MOUSE_UP="mouseup",e.KEY_DOWN="keydown",e.KEY_UP="keyup",e.CLICK="click",e.HOVER="hover",e.DOUBLE_CLICK="dblclick",e.CONTEXT_MENU="contextmenu"})(tc||(tc={}));var Me;(function(e){e.ROW_CELL_HOVER="row-cell:hover",e.ROW_CELL_CLICK="row-cell:click",e.ROW_CELL_DOUBLE_CLICK="row-cell:double-click",e.ROW_CELL_CONTEXT_MENU="row-cell:context-menu",e.ROW_CELL_MOUSE_DOWN="row-cell:mouse-down",e.ROW_CELL_MOUSE_UP="row-cell:mouse-up",e.ROW_CELL_MOUSE_MOVE="row-cell:mouse-move",e.ROW_CELL_COLLAPSE_TREE_ROWS="row-cell:collapsed-tree-rows",e.ROW_CELL_SCROLL="row-cell:scroll",e.ROW_CELL_BRUSH_SELECTION="row-cell:brush-selection",e.COL_CELL_HOVER="col-cell:hover",e.COL_CELL_CLICK="col-cell:click",e.COL_CELL_DOUBLE_CLICK="col-cell:double-click",e.COL_CELL_CONTEXT_MENU="col-cell:context-menu",e.COL_CELL_MOUSE_DOWN="col-cell:mouse-down",e.COL_CELL_MOUSE_UP="col-cell:mouse-up",e.COL_CELL_MOUSE_MOVE="col-cell:mouse-move",e.COL_CELL_BRUSH_SELECTION="col-cell:brush-selection",e.DATA_CELL_HOVER="data-cell:hover",e.DATA_CELL_CLICK="data-cell:click",e.DATA_CELL_DOUBLE_CLICK="data-cell:double-click",e.DATA_CELL_CONTEXT_MENU="data-cell:context-menu",e.DATA_CELL_MOUSE_UP="data-cell:mouse-up",e.DATA_CELL_MOUSE_DOWN="data-cell:mouse-down",e.DATA_CELL_MOUSE_MOVE="data-cell:mouse-move",e.DATA_CELL_TREND_ICON_CLICK="data-cell:trend-icon-click",e.DATA_CELL_BRUSH_SELECTION="data-cell:brush-selection",e.DATA_CELL_SELECT_MOVE="data-cell:select-move",e.CORNER_CELL_HOVER="corner-cell:hover",e.CORNER_CELL_CLICK="corner-cell:click",e.CORNER_CELL_DOUBLE_CLICK="corner-cell:double-click",e.CORNER_CELL_CONTEXT_MENU="corner-cell:context-menu",e.CORNER_CELL_MOUSE_DOWN="corner-cell:mouse-down",e.CORNER_CELL_MOUSE_UP="corner-cell:mouse-up",e.CORNER_CELL_MOUSE_MOVE="corner-cell:mouse-move",e.MERGED_CELLS_HOVER="merged-cells:hover",e.MERGED_CELLS_CLICK="merged-cells:click",e.MERGED_CELLS_DOUBLE_CLICK="merged-cells:double-click",e.MERGED_CELLS_CONTEXT_MENU="merged-cell:context-menu",e.MERGED_CELLS_MOUSE_DOWN="merged-cells:mouse-down",e.MERGED_CELLS_MOUSE_UP="merged-cells:mouse-up",e.MERGED_CELLS_MOUSE_MOVE="merged-cells:mouse-move",e.RANGE_SORT="sort:range-sort",e.RANGE_SORTED="sort:range-sorted",e.RANGE_FILTER="filter:range-filter",e.RANGE_FILTERED="filter:range-filtered",e.LAYOUT_AFTER_HEADER_LAYOUT="layout:after-header-layout",e.LAYOUT_CELL_SCROLL="layout:cell-scroll",e.LAYOUT_PAGINATION="layout:pagination",e.LAYOUT_COLLAPSE_ROWS="layout:collapsed-rows",e.LAYOUT_AFTER_COLLAPSE_ROWS="layout:after-collapsed-rows",e.LAYOUT_AFTER_REAL_DATA_CELL_RENDER="layout:after-real-data-cell-render",e.LAYOUT_TREE_ROWS_COLLAPSE_ALL="layout:toggle-collapse-all",e.LAYOUT_COLS_EXPANDED="layout:table-col-expanded",e.LAYOUT_COLS_HIDDEN="layout:table-col-hidden",e.LAYOUT_AFTER_RENDER="layout:after-render",e.LAYOUT_BEFORE_RENDER="layout:before-render",e.LAYOUT_DESTROY="layout:destroy",e.LAYOUT_RESIZE="layout:resize",e.LAYOUT_RESIZE_SERIES_WIDTH="layout:resize-series-width",e.LAYOUT_RESIZE_ROW_WIDTH="layout:resize-row-width",e.LAYOUT_RESIZE_ROW_HEIGHT="layout:resize-row-height",e.LAYOUT_RESIZE_COL_WIDTH="layout:resize-column-width",e.LAYOUT_RESIZE_COL_HEIGHT="layout:resize-column-height",e.LAYOUT_RESIZE_TREE_WIDTH="layout:resize-tree-width",e.LAYOUT_RESIZE_MOUSE_DOWN="layout:resize:mouse-down",e.LAYOUT_RESIZE_MOUSE_MOVE="layout:resize:mouse-move",e.LAYOUT_RESIZE_MOUSE_UP="layout:resize-mouse-up",e.GLOBAL_KEYBOARD_DOWN="global:keyboard-down",e.GLOBAL_KEYBOARD_UP="global:keyboard-up",e.GLOBAL_COPIED="global:copied",e.GLOBAL_MOUSE_UP="global:mouse-up",e.GLOBAL_MOUSE_MOVE="global:mouse-move",e.GLOBAL_ACTION_ICON_CLICK="global:action-icon-click",e.GLOBAL_ACTION_ICON_HOVER="global:action-icon-hover",e.GLOBAL_ACTION_ICON_HOVER_OFF="global:action-icon-hover-off",e.GLOBAL_CONTEXT_MENU="global:context-menu",e.GLOBAL_CLICK="global:click",e.GLOBAL_DOUBLE_CLICK="global:double-click",e.GLOBAL_SELECTED="global:selected",e.GLOBAL_HOVER="global:hover",e.GLOBAL_RESET="global:reset",e.GLOBAL_LINK_FIELD_JUMP="global:link-field-jump",e.GLOBAL_SCROLL="global:scroll"})(Me||(Me={}));var Ljt=0,Ojt=3,Vrt=3,LC=4,Pjt=5,Djt=5,Fjt=1,Bjt=1,Grt=2,Njt="backGroundGroup",kjt="foreGroundGroup",zjt="panelGroup",Ujt="panelScrollGroup",UG="mergedCellsGroup",Wrt="frozenRowGroup",Xrt="frozenColGroup",$jt="frozenTrailingRowGroup",Hjt="frozenTrailingColGroup",Vjt="frozenTopGroup",Gjt="frozenBottomGroup",Kx="rowResizeAreaGroup",jrt="rowFrozenResizeAreaGroup",oR="frozenSplitLine",$G="rowIndexResizeAreaGroup",jF="cornerResizeAreaGroup",Yrt="colResizeAreaGroup",Zrt="colFrozenResizeAreaGroup",Wjt="colScrollGroup",Xjt="colFrozenGroup",jjt="colFrozenTrailingGroup",HG="gridGroup",Yjt="rowScrollGroup",Zjt="rowHeaderFrozenGroup",qjt="series-number-node",qrt="horizontal-resize-area-",Krt="root",sc="[&]",YF="-",VI="-",VG=28,GG=16,Qrt=16,Kjt=.5,YO=50,Qx;(function(e){e.Line="line",e.Bar="bar",e.Bullet="bullet"})(Qx||(Qx={}));var WG="square",vx="...",Qjt="antv-s2",sR="valueRanges",SN={},Jrt="#000000",ZF="#FFFFFF",Jjt={data:[],totalData:[],fields:{rows:[],columns:[],values:[],customTreeItems:[],valueInCols:!0},meta:[],sortParams:[],filterParams:[]},Uv,tl;(function(e){e.ROW="row",e.COL="col",e.TRAILING_ROW="trailingRow",e.TRAILING_COL="trailingCol",e.SCROLL="scroll",e.TOP="top",e.BOTTOM="bottom"})(tl||(tl={}));var Af;(function(e){e.FROZEN_COL="frozenCol",e.FROZEN_ROW="frozenRow",e.FROZEN_TRAILING_COL="frozenTrailingCol",e.FROZEN_TRAILING_ROW="frozenTrailingRow"})(Af||(Af={}));var tnt=(Uv={},Uv[tl.ROW]="frozenRowGroup",Uv[tl.COL]="frozenColGroup",Uv[tl.TRAILING_COL]="frozenTrailingColGroup",Uv[tl.TRAILING_ROW]="frozenTrailingRowGroup",Uv[tl.SCROLL]="panelScrollGroup",Uv[tl.TOP]="frozenTopGroup",Uv[tl.BOTTOM]="frozenBottomGroup",Uv),Ju;(function(e){e.CORNER_CELL_CLICK="cornerCellClick",e.DATA_CELL_CLICK="dataCellClick",e.MERGED_CELLS_CLICK="mergedCellsClick",e.ROW_COLUMN_CLICK="rowColumnClick",e.ROW_TEXT_CLICK="rowTextClick",e.HOVER="hover",e.BRUSH_SELECTION="brushSelection",e.ROW_BRUSH_SELECTION="rowBrushSelection",e.COL_BRUSH_SELECTION="colBrushSelection",e.COL_ROW_RESIZE="rowColResize",e.DATA_CELL_MULTI_SELECTION="dataCellMultiSelection",e.RANGE_SELECTION="rangeSelection",e.SELECTED_CELL_MOVE="selectedCellMove"})(Ju||(Ju={}));var On;(function(e){e.ALL_SELECTED="allSelected",e.SELECTED="selected",e.BRUSH_SELECTED="brushSelected",e.UNSELECTED="unselected",e.HOVER="hover",e.HOVER_FOCUS="hoverFocus",e.HIGHLIGHT="highlight",e.SEARCH_RESULT="searchResult",e.PREPARE_SELECT="prepareSelect"})(On||(On={}));var Br;(function(e){e.DATA_CELL="dataCell",e.HEADER_CELL="headerCell",e.ROW_CELL="rowCell",e.COL_CELL="colCell",e.CORNER_CELL="cornerCell",e.MERGED_CELL="mergedCell"})(Br||(Br={}));var qF=800,Mh={textOpacity:"fillOpacity",backgroundOpacity:"fillOpacity",backgroundColor:"fill",borderOpacity:"strokeOpacity",borderColor:"stroke",borderWidth:"lineWidth",opacity:"opacity"},tYt={textShape:["textOpacity"],textShapes:["textOpacity"],linkFieldShape:["opacity"],interactiveBgShape:["backgroundColor","backgroundOpacity"],interactiveBorderShape:["borderColor","borderOpacity","borderWidth"]},KF="interactionStateInfo",Lu;(function(e){e.CLICK="click",e.UN_DRAGGED="unDragged",e.DRAGGED="dragged"})(Lu||(Lu={}));var Pu;(function(e){e.SHIFT="Shift",e.COPY="c",e.ESC="Escape",e.META="Meta",e.CONTROL="Control",e.ARROW_UP="ArrowUp",e.ARROW_DOWN="ArrowDown",e.ARROW_LEFT="ArrowLeft",e.ARROW_RIGHT="ArrowRight"})(Pu||(Pu={}));var XG;(function(e){e.ASC="ASC",e.DESC="DESC"})(XG||(XG={}));var Ti;(function(e){e.HOVER="hover",e.CLICK="click",e.BRUSH_SELECTION="brushSelection",e.ROW_BRUSH_SELECTION="rowBrushSelection",e.COL_BRUSH_SELECTION="colBrushSelection",e.MULTI_SELECTION="multiSelection",e.RESIZE="resize"})(Ti||(Ti={}));var jG={x:{value:0,scroll:!1},y:{value:0,scroll:!1}},lR;(function(e){e.CONTENT="content",e.CANVAS="canvas"})(lR||(lR={}));var Fl;(function(e){e.SCROLL_UP="scrollUp",e.SCROLL_DOWN="scrollDown"})(Fl||(Fl={}));var uR;(function(e){e[e.SCROLL_UP=-1]="SCROLL_UP",e[e.SCROLL_DOWN=1]="SCROLL_DOWN"})(uR||(uR={}));var eYt="RESIZE_START_GUIDE_LINE",rYt="RESIZE_END_GUIDE_LINE",nYt="RESIZE_MASK",Uf;(function(e){e.Horizontal="col",e.Vertical="row"})(Uf||(Uf={}));var rc;(function(e){e.Field="field",e.Cell="cell",e.Tree="tree",e.Series="series"})(rc||(rc={}));var cR;(function(e){e.ALL="all",e.CURRENT="current"})(cR||(cR={}));var ent=1,i_;(function(e){e.Adaptive="adaptive",e.ColAdaptive="colAdaptive",e.Compact="compact"})(i_||(i_={}));var YG=120,iYt={layoutWidthType:i_.Adaptive,showTreeLeafNodeAlignDot:!1,collapsedRows:{},collapsedCols:{},cellCfg:{width:96,height:30},rowCfg:{width:null,widthByField:{},heightByField:{}},colCfg:{height:30,widthByFieldValue:{},heightByField:{}},device:"pc"},aYt={width:600,height:480,debug:!1,hierarchyType:"grid",conditions:{},totals:{},tooltip:{showTooltip:!1,autoAdjustBoundary:"body",operation:{hiddenColumns:!1,trend:!1,sort:!1,menus:[]}},interaction:{linkFields:[],hiddenColumnFields:[],selectedCellsSpotlight:!1,hoverHighlight:!0,hoverFocus:{duration:qF},scrollSpeedRatio:{horizontal:1,vertical:1},autoResetSheetStyle:!0,brushSelection:{data:!0,row:!1,col:!1},multiSelection:!0,rangeSelection:!0,scrollbarPosition:lR.CONTENT,resize:{rowCellVertical:!0,cornerCellHorizontal:!0,colCellHorizontal:!0,colCellVertical:!0,rowResizeType:cR.ALL},eventListenerOptions:!1,selectedCellHighlight:!1,overscrollBehavior:"auto"},showSeriesNumber:!1,customSVGIcons:[],showDefaultHeaderActionIcon:!1,headerActionIcons:[],style:iYt,frozenRowHeader:!0,frozenRowCount:0,frozenColCount:0,frozenTrailingRowCount:0,frozenTrailingColCount:0,hdAdapter:!0,cornerText:"",cornerExtraFieldText:"",placeholder:VI,supportCSSTransform:!1,devicePixelRatio:window.devicePixelRatio},oYt=typeof global=="object"&&global&&global.Object===Object&&global,rnt=oYt,sYt=typeof self=="object"&&self&&self.Object===Object&&self,lYt=rnt||sYt||Function("return this")(),Xl=lYt,uYt=Xl.Symbol,ku=uYt,nnt=Object.prototype,cYt=nnt.hasOwnProperty,hYt=nnt.toString,qE=ku?ku.toStringTag:void 0;function fYt(e){var t=cYt.call(e,qE),r=e[qE];try{e[qE]=void 0;var n=!0}catch{}var i=hYt.call(e);return n&&(t?e[qE]=r:delete e[qE]),i}var dYt=Object.prototype,pYt=dYt.toString;function vYt(e){return pYt.call(e)}var gYt="[object Null]",mYt="[object Undefined]",ZG=ku?ku.toStringTag:void 0;function hc(e){return e==null?e===void 0?mYt:gYt:ZG&&ZG in Object(e)?fYt(e):vYt(e)}function Os(e){return e!=null&&typeof e=="object"}var yYt="[object Symbol]";function zh(e){return typeof e=="symbol"||Os(e)&&hc(e)==yYt}var _Yt=0/0;function qG(e){return typeof e=="number"?e:zh(e)?_Yt:+e}function es(e,t){for(var r=-1,n=e==null?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}var xYt=Array.isArray,Wn=xYt,bYt=1/0,KG=ku?ku.prototype:void 0,QG=KG?KG.toString:void 0;function Uh(e){if(typeof e=="string")return e;if(Wn(e))return es(e,Uh)+"";if(zh(e))return QG?QG.call(e):"";var t=e+"";return t=="0"&&1/e==-bYt?"-0":t}function GI(e,t){return function(r,n){var i;if(r===void 0&&n===void 0)return t;if(r!==void 0&&(i=r),n!==void 0){if(i===void 0)return n;typeof r=="string"||typeof n=="string"?(r=Uh(r),n=Uh(n)):(r=qG(r),n=qG(n)),i=e(r,n)}return i}}var EYt=GI(function(e,t){return e+t},0),wYt=EYt,CYt=/\s/;function int(e){for(var t=e.length;t--&&CYt.test(e.charAt(t)););return t}var SYt=/^\s+/;function ant(e){return e&&e.slice(0,int(e)+1).replace(SYt,"")}function Ja(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var JG=0/0,TYt=/^[-+]0x[0-9a-f]+$/i,AYt=/^0b[01]+$/i,MYt=/^0o[0-7]+$/i,RYt=parseInt;function Dh(e){if(typeof e=="number")return e;if(zh(e))return JG;if(Ja(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Ja(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=ant(e);var r=AYt.test(e);return r||MYt.test(e)?RYt(e.slice(2),r?2:8):TYt.test(e)?JG:+e}var tW=1/0,IYt=17976931348623157e292;function ag(e){if(!e)return e===0?e:0;if(e=Dh(e),e===tW||e===-tW){var t=e<0?-1:1;return t*IYt}return e===e?e:0}function Ui(e){var t=ag(e),r=t%1;return t===t?r?t-r:t:0}var LYt="Expected a function";function OYt(e,t){if(typeof t!="function")throw new TypeError(LYt);return e=Ui(e),function(){if(--e<1)return t.apply(this,arguments)}}function Hu(e){return e}var PYt="[object AsyncFunction]",DYt="[object Function]",FYt="[object GeneratorFunction]",BYt="[object Proxy]";function hu(e){if(!Ja(e))return!1;var t=hc(e);return t==DYt||t==FYt||t==PYt||t==BYt}var NYt=Xl["__core-js_shared__"],$A=NYt,eW=function(){var e=/[^.]+$/.exec($A&&$A.keys&&$A.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function kYt(e){return!!eW&&eW in e}var zYt=Function.prototype,UYt=zYt.toString;function A_(e){if(e!=null){try{return UYt.call(e)}catch{}try{return e+""}catch{}}return""}var $Yt=/[\\^$.*+?()[\]{}|]/g,HYt=/^\[object .+?Constructor\]$/,VYt=Function.prototype,GYt=Object.prototype,WYt=VYt.toString,XYt=GYt.hasOwnProperty,jYt=RegExp("^"+WYt.call(XYt).replace($Yt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function ont(e){if(!Ja(e)||kYt(e))return!1;var t=hu(e)?jYt:HYt;return t.test(A_(e))}function YYt(e,t){return e==null?void 0:e[t]}function M_(e,t){var r=YYt(e,t);return ont(r)?r:void 0}var ZYt=M_(Xl,"WeakMap"),OC=ZYt,qYt=OC&&new OC,hR=qYt,KYt=hR?function(e,t){return hR.set(e,t),e}:Hu,snt=KYt,rW=Object.create,QYt=function(){function e(){}return function(t){if(!Ja(t))return{};if(rW)return rW(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),Ab=QYt;function PC(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var r=Ab(e.prototype),n=e.apply(r,t);return Ja(n)?n:r}}var JYt=1;function tZt(e,t,r){var n=t&JYt,i=PC(e);function a(){var o=this&&this!==Xl&&this instanceof a?i:e;return o.apply(n?r:this,arguments)}return a}function $h(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var eZt=Math.max;function lnt(e,t,r,n){for(var i=-1,a=e.length,o=r.length,s=-1,l=t.length,u=eZt(a-o,0),c=Array(l+u),f=!n;++s<l;)c[s]=t[s];for(;++i<o;)(f||i<a)&&(c[r[i]]=e[i]);for(;u--;)c[s++]=e[i++];return c}var rZt=Math.max;function unt(e,t,r,n){for(var i=-1,a=e.length,o=-1,s=r.length,l=-1,u=t.length,c=rZt(a-s,0),f=Array(c+u),d=!n;++i<c;)f[i]=e[i];for(var v=i;++l<u;)f[v+l]=t[l];for(;++o<s;)(d||i<a)&&(f[v+r[o]]=e[i++]);return f}function nZt(e,t){for(var r=e.length,n=0;r--;)e[r]===t&&++n;return n}function WI(){}var iZt=4294967295;function ua(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=iZt,this.__views__=[]}ua.prototype=Ab(WI.prototype);ua.prototype.constructor=ua;function XI(){}var aZt=hR?function(e){return hR.get(e)}:XI,TN=aZt,oZt={},gx=oZt,sZt=Object.prototype,lZt=sZt.hasOwnProperty;function HA(e){for(var t=e.name+"",r=gx[t],n=lZt.call(gx,t)?r.length:0;n--;){var i=r[n],a=i.func;if(a==null||a==e)return i.name}return t}function Xf(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}Xf.prototype=Ab(WI.prototype);Xf.prototype.constructor=Xf;function Zc(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}function cnt(e){if(e instanceof ua)return e.clone();var t=new Xf(e.__wrapped__,e.__chain__);return t.__actions__=Zc(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var uZt=Object.prototype,cZt=uZt.hasOwnProperty;function gt(e){if(Os(e)&&!Wn(e)&&!(e instanceof ua)){if(e instanceof Xf)return e;if(cZt.call(e,"__wrapped__"))return cnt(e)}return new Xf(e)}gt.prototype=WI.prototype;gt.prototype.constructor=gt;function QF(e){var t=HA(e),r=gt[t];if(typeof r!="function"||!(t in ua.prototype))return!1;if(e===r)return!0;var n=TN(r);return!!n&&e===n[0]}var hZt=800,fZt=16,dZt=Date.now;function hnt(e){var t=0,r=0;return function(){var n=dZt(),i=fZt-(n-r);if(r=n,i>0){if(++t>=hZt)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var pZt=hnt(snt),fnt=pZt,vZt=/\{\n\/\* \[wrapped with (.+)\] \*/,gZt=/,? & /;function mZt(e){var t=e.match(vZt);return t?t[1].split(gZt):[]}var yZt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;function _Zt(e,t){var r=t.length;if(!r)return e;var n=r-1;return t[n]=(r>1?"& ":"")+t[n],t=t.join(r>2?", ":" "),e.replace(yZt,`{
/* [wrapped with `+t+`] */
`)}function mx(e){return function(){return e}}var xZt=function(){try{var e=M_(Object,"defineProperty");return e({},"",{}),e}catch{}}(),fR=xZt,bZt=fR?function(e,t){return fR(e,"toString",{configurable:!0,enumerable:!1,value:mx(t),writable:!0})}:Hu,EZt=bZt,wZt=hnt(EZt),AN=wZt;function td(e,t){for(var r=-1,n=e==null?0:e.length;++r<n&&t(e[r],r,e)!==!1;);return e}function jI(e,t,r,n){for(var i=e.length,a=r+(n?1:-1);n?a--:++a<i;)if(t(e[a],a,e))return a;return-1}function dnt(e){return e!==e}function CZt(e,t,r){for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1}function Mb(e,t,r){return t===t?CZt(e,t,r):jI(e,dnt,r)}function YI(e,t){var r=e==null?0:e.length;return!!r&&Mb(e,t,0)>-1}var SZt=1,TZt=2,AZt=8,MZt=16,RZt=32,IZt=64,LZt=128,OZt=256,PZt=512,DZt=[["ary",LZt],["bind",SZt],["bindKey",TZt],["curry",AZt],["curryRight",MZt],["flip",PZt],["partial",RZt],["partialRight",IZt],["rearg",OZt]];function FZt(e,t){return td(DZt,function(r){var n="_."+r[0];t&r[1]&&!YI(e,n)&&e.push(n)}),e.sort()}function pnt(e,t,r){var n=t+"";return AN(e,_Zt(n,FZt(mZt(n),r)))}var BZt=1,NZt=2,kZt=4,zZt=8,nW=32,iW=64;function vnt(e,t,r,n,i,a,o,s,l,u){var c=t&zZt,f=c?o:void 0,d=c?void 0:o,v=c?a:void 0,g=c?void 0:a;t|=c?nW:iW,t&=~(c?iW:nW),t&kZt||(t&=~(BZt|NZt));var x=[e,t,i,v,f,g,d,s,l,u],w=r.apply(void 0,x);return QF(e)&&fnt(w,x),w.placeholder=n,pnt(w,e,t)}function Rb(e){var t=e;return t.placeholder}var UZt=9007199254740991,$Zt=/^(?:0|[1-9]\d*)$/;function gg(e,t){var r=typeof e;return t=t??UZt,!!t&&(r=="number"||r!="symbol"&&$Zt.test(e))&&e>-1&&e%1==0&&e<t}var HZt=Math.min;function VZt(e,t){for(var r=e.length,n=HZt(t.length,r),i=Zc(e);n--;){var a=t[n];e[n]=gg(a,r)?i[a]:void 0}return e}var aW="__lodash_placeholder__";function t0(e,t){for(var r=-1,n=e.length,i=0,a=[];++r<n;){var o=e[r];(o===t||o===aW)&&(e[r]=aW,a[i++]=r)}return a}var GZt=1,WZt=2,XZt=8,jZt=16,YZt=128,ZZt=512;function ZI(e,t,r,n,i,a,o,s,l,u){var c=t&YZt,f=t&GZt,d=t&WZt,v=t&(XZt|jZt),g=t&ZZt,x=d?void 0:PC(e);function w(){for(var S=arguments.length,A=Array(S),M=S;M--;)A[M]=arguments[M];if(v)var R=Rb(w),O=nZt(A,R);if(n&&(A=lnt(A,n,i,v)),a&&(A=unt(A,a,o,v)),S-=O,v&&S<u){var N=t0(A,R);return vnt(e,t,ZI,w.placeholder,r,A,N,s,l,u-S)}var k=f?r:this,V=d?k[e]:e;return S=A.length,s?A=VZt(A,s):g&&S>1&&A.reverse(),c&&l<S&&(A.length=l),this&&this!==Xl&&this instanceof w&&(V=x||PC(V)),V.apply(k,A)}return w}function qZt(e,t,r){var n=PC(e);function i(){for(var a=arguments.length,o=Array(a),s=a,l=Rb(i);s--;)o[s]=arguments[s];var u=a<3&&o[0]!==l&&o[a-1]!==l?[]:t0(o,l);if(a-=u.length,a<r)return vnt(e,t,ZI,i.placeholder,void 0,o,u,void 0,void 0,r-a);var c=this&&this!==Xl&&this instanceof i?n:e;return $h(c,this,o)}return i}var KZt=1;function QZt(e,t,r,n){var i=t&KZt,a=PC(e);function o(){for(var s=-1,l=arguments.length,u=-1,c=n.length,f=Array(c+l),d=this&&this!==Xl&&this instanceof o?a:e;++u<c;)f[u]=n[u];for(;l--;)f[u++]=arguments[++s];return $h(d,i?r:this,f)}return o}var oW="__lodash_placeholder__",ZO=1,JZt=2,tqt=4,sW=8,KE=128,lW=256,eqt=Math.min;function rqt(e,t){var r=e[1],n=t[1],i=r|n,a=i<(ZO|JZt|KE),o=n==KE&&r==sW||n==KE&&r==lW&&e[7].length<=t[8]||n==(KE|lW)&&t[7].length<=t[8]&&r==sW;if(!(a||o))return e;n&ZO&&(e[2]=t[2],i|=r&ZO?0:tqt);var s=t[3];if(s){var l=e[3];e[3]=l?lnt(l,s,t[4]):s,e[4]=l?t0(e[3],oW):t[4]}return s=t[5],s&&(l=e[5],e[5]=l?unt(l,s,t[6]):s,e[6]=l?t0(e[5],oW):t[6]),s=t[7],s&&(e[7]=s),n&KE&&(e[8]=e[8]==null?t[8]:eqt(e[8],t[8])),e[9]==null&&(e[9]=t[9]),e[0]=t[0],e[1]=i,e}var nqt="Expected a function",uW=1,iqt=2,qO=8,KO=16,QO=32,cW=64,hW=Math.max;function mg(e,t,r,n,i,a,o,s){var l=t&iqt;if(!l&&typeof e!="function")throw new TypeError(nqt);var u=n?n.length:0;if(u||(t&=~(QO|cW),n=i=void 0),o=o===void 0?o:hW(Ui(o),0),s=s===void 0?s:Ui(s),u-=i?i.length:0,t&cW){var c=n,f=i;n=i=void 0}var d=l?void 0:TN(e),v=[e,t,r,n,i,c,f,a,o,s];if(d&&rqt(v,d),e=v[0],t=v[1],r=v[2],n=v[3],i=v[4],s=v[9]=v[9]===void 0?l?0:e.length:hW(v[9]-u,0),!s&&t&(qO|KO)&&(t&=~(qO|KO)),!t||t==uW)var g=tZt(e,t,r);else t==qO||t==KO?g=qZt(e,t,s):(t==QO||t==(uW|QO))&&!i.length?g=QZt(e,t,r,n):g=ZI.apply(void 0,v);var x=d?snt:fnt;return pnt(x(g,v),e,t)}var aqt=128;function gnt(e,t,r){return t=r?void 0:t,t=e&&t==null?e.length:t,mg(e,aqt,void 0,void 0,void 0,void 0,t)}function yg(e,t,r){t=="__proto__"&&fR?fR(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}function Kd(e,t){return e===t||e!==e&&t!==t}var oqt=Object.prototype,sqt=oqt.hasOwnProperty;function OS(e,t,r){var n=e[t];(!(sqt.call(e,t)&&Kd(n,r))||r===void 0&&!(t in e))&&yg(e,t,r)}function ev(e,t,r,n){var i=!r;r||(r={});for(var a=-1,o=t.length;++a<o;){var s=t[a],l=n?n(r[s],e[s],s,r,e):void 0;l===void 0&&(l=e[s]),i?yg(r,s,l):OS(r,s,l)}return r}var fW=Math.max;function mnt(e,t,r){return t=fW(t===void 0?e.length-1:t,0),function(){for(var n=arguments,i=-1,a=fW(n.length-t,0),o=Array(a);++i<a;)o[i]=n[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=n[i];return s[t]=r(o),$h(e,this,s)}}function Ki(e,t){return AN(mnt(e,t,Hu),e+"")}var lqt=9007199254740991;function qI(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=lqt}function rh(e){return e!=null&&qI(e.length)&&!hu(e)}function uc(e,t,r){if(!Ja(r))return!1;var n=typeof t;return(n=="number"?rh(r)&&gg(t,r.length):n=="string"&&t in r)?Kd(r[t],e):!1}function Ib(e){return Ki(function(t,r){var n=-1,i=r.length,a=i>1?r[i-1]:void 0,o=i>2?r[2]:void 0;for(a=e.length>3&&typeof a=="function"?(i--,a):void 0,o&&uc(r[0],r[1],o)&&(a=i<3?void 0:a,i=1),t=Object(t);++n<i;){var s=r[n];s&&e(t,s,n,a)}return t})}var uqt=Object.prototype;function PS(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||uqt;return e===r}function MN(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var cqt="[object Arguments]";function dW(e){return Os(e)&&hc(e)==cqt}var ynt=Object.prototype,hqt=ynt.hasOwnProperty,fqt=ynt.propertyIsEnumerable,dqt=dW(function(){return arguments}())?dW:function(e){return Os(e)&&hqt.call(e,"callee")&&!fqt.call(e,"callee")},a_=dqt;function RN(){return!1}var _nt=typeof exports=="object"&&exports&&!exports.nodeType&&exports,pW=_nt&&typeof module=="object"&&module&&!module.nodeType&&module,pqt=pW&&pW.exports===_nt,vW=pqt?Xl.Buffer:void 0,vqt=vW?vW.isBuffer:void 0,gqt=vqt||RN,e0=gqt,mqt="[object Arguments]",yqt="[object Array]",_qt="[object Boolean]",xqt="[object Date]",bqt="[object Error]",Eqt="[object Function]",wqt="[object Map]",Cqt="[object Number]",Sqt="[object Object]",Tqt="[object RegExp]",Aqt="[object Set]",Mqt="[object String]",Rqt="[object WeakMap]",Iqt="[object ArrayBuffer]",Lqt="[object DataView]",Oqt="[object Float32Array]",Pqt="[object Float64Array]",Dqt="[object Int8Array]",Fqt="[object Int16Array]",Bqt="[object Int32Array]",Nqt="[object Uint8Array]",kqt="[object Uint8ClampedArray]",zqt="[object Uint16Array]",Uqt="[object Uint32Array]",ko={};ko[Oqt]=ko[Pqt]=ko[Dqt]=ko[Fqt]=ko[Bqt]=ko[Nqt]=ko[kqt]=ko[zqt]=ko[Uqt]=!0;ko[mqt]=ko[yqt]=ko[Iqt]=ko[_qt]=ko[Lqt]=ko[xqt]=ko[bqt]=ko[Eqt]=ko[wqt]=ko[Cqt]=ko[Sqt]=ko[Tqt]=ko[Aqt]=ko[Mqt]=ko[Rqt]=!1;function $qt(e){return Os(e)&&qI(e.length)&&!!ko[hc(e)]}function Hh(e){return function(t){return e(t)}}var xnt=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Gw=xnt&&typeof module=="object"&&module&&!module.nodeType&&module,Hqt=Gw&&Gw.exports===xnt,JO=Hqt&&rnt.process,Vqt=function(){try{var e=Gw&&Gw.require&&Gw.require("util").types;return e||JO&&JO.binding&&JO.binding("util")}catch{}}(),jf=Vqt,gW=jf&&jf.isTypedArray,Gqt=gW?Hh(gW):$qt,Lb=Gqt,Wqt=Object.prototype,Xqt=Wqt.hasOwnProperty;function bnt(e,t){var r=Wn(e),n=!r&&a_(e),i=!r&&!n&&e0(e),a=!r&&!n&&!i&&Lb(e),o=r||n||i||a,s=o?MN(e.length,String):[],l=s.length;for(var u in e)(t||Xqt.call(e,u))&&!(o&&(u=="length"||i&&(u=="offset"||u=="parent")||a&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||gg(u,l)))&&s.push(u);return s}function Ent(e,t){return function(r){return e(t(r))}}var jqt=Ent(Object.keys,Object),Yqt=jqt,Zqt=Object.prototype,qqt=Zqt.hasOwnProperty;function IN(e){if(!PS(e))return Yqt(e);var t=[];for(var r in Object(e))qqt.call(e,r)&&r!="constructor"&&t.push(r);return t}function xs(e){return rh(e)?bnt(e):IN(e)}var Kqt=Object.prototype,Qqt=Kqt.hasOwnProperty,Jqt=Ib(function(e,t){if(PS(t)||rh(t)){ev(t,xs(t),e);return}for(var r in t)Qqt.call(t,r)&&OS(e,r,t[r])}),wnt=Jqt;function tKt(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var eKt=Object.prototype,rKt=eKt.hasOwnProperty;function nKt(e){if(!Ja(e))return tKt(e);var t=PS(e),r=[];for(var n in e)n=="constructor"&&(t||!rKt.call(e,n))||r.push(n);return r}function nh(e){return rh(e)?bnt(e,!0):nKt(e)}var iKt=Ib(function(e,t){ev(t,nh(t),e)}),mW=iKt,aKt=Ib(function(e,t,r,n){ev(t,nh(t),e,n)}),dR=aKt,oKt=Ib(function(e,t,r,n){ev(t,xs(t),e,n)}),sKt=oKt,lKt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,uKt=/^\w*$/;function LN(e,t){if(Wn(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||zh(e)?!0:uKt.test(e)||!lKt.test(e)||t!=null&&e in Object(t)}var cKt=M_(Object,"create"),DC=cKt;function hKt(){this.__data__=DC?DC(null):{},this.size=0}function fKt(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var dKt="__lodash_hash_undefined__",pKt=Object.prototype,vKt=pKt.hasOwnProperty;function gKt(e){var t=this.__data__;if(DC){var r=t[e];return r===dKt?void 0:r}return vKt.call(t,e)?t[e]:void 0}var mKt=Object.prototype,yKt=mKt.hasOwnProperty;function _Kt(e){var t=this.__data__;return DC?t[e]!==void 0:yKt.call(t,e)}var xKt="__lodash_hash_undefined__";function bKt(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=DC&&t===void 0?xKt:t,this}function o_(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}o_.prototype.clear=hKt;o_.prototype.delete=fKt;o_.prototype.get=gKt;o_.prototype.has=_Kt;o_.prototype.set=bKt;function EKt(){this.__data__=[],this.size=0}function KI(e,t){for(var r=e.length;r--;)if(Kd(e[r][0],t))return r;return-1}var wKt=Array.prototype,CKt=wKt.splice;function SKt(e){var t=this.__data__,r=KI(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():CKt.call(t,r,1),--this.size,!0}function TKt(e){var t=this.__data__,r=KI(t,e);return r<0?void 0:t[r][1]}function AKt(e){return KI(this.__data__,e)>-1}function MKt(e,t){var r=this.__data__,n=KI(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}function _g(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}_g.prototype.clear=EKt;_g.prototype.delete=SKt;_g.prototype.get=TKt;_g.prototype.has=AKt;_g.prototype.set=MKt;var RKt=M_(Xl,"Map"),FC=RKt;function IKt(){this.size=0,this.__data__={hash:new o_,map:new(FC||_g),string:new o_}}function LKt(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function QI(e,t){var r=e.__data__;return LKt(t)?r[typeof t=="string"?"string":"hash"]:r.map}function OKt(e){var t=QI(this,e).delete(e);return this.size-=t?1:0,t}function PKt(e){return QI(this,e).get(e)}function DKt(e){return QI(this,e).has(e)}function FKt(e,t){var r=QI(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}function xg(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}xg.prototype.clear=IKt;xg.prototype.delete=OKt;xg.prototype.get=PKt;xg.prototype.has=DKt;xg.prototype.set=FKt;var BKt="Expected a function";function R_(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(BKt);var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],a=r.cache;if(a.has(i))return a.get(i);var o=e.apply(this,n);return r.cache=a.set(i,o)||a,o};return r.cache=new(R_.Cache||xg),r}R_.Cache=xg;var NKt=500;function kKt(e){var t=R_(e,function(n){return r.size===NKt&&r.clear(),n}),r=t.cache;return t}var zKt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,UKt=/\\(\\)?/g,$Kt=kKt(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(zKt,function(r,n,i,a){t.push(i?a.replace(UKt,"$1"):n||r)}),t}),Cnt=$Kt;function za(e){return e==null?"":Uh(e)}function p0(e,t){return Wn(e)?e:LN(e,t)?[e]:Cnt(za(e))}var HKt=1/0;function rv(e){if(typeof e=="string"||zh(e))return e;var t=e+"";return t=="0"&&1/e==-HKt?"-0":t}function I_(e,t){t=p0(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[rv(t[r++])];return r&&r==n?e:void 0}function ii(e,t,r){var n=e==null?void 0:I_(e,t);return n===void 0?r:n}function ON(e,t){for(var r=-1,n=t.length,i=Array(n),a=e==null;++r<n;)i[r]=a?void 0:ii(e,t[r]);return i}function v0(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}var yW=ku?ku.isConcatSpreadable:void 0;function VKt(e){return Wn(e)||a_(e)||!!(yW&&e&&e[yW])}function pu(e,t,r,n,i){var a=-1,o=e.length;for(r||(r=VKt),i||(i=[]);++a<o;){var s=e[a];t>0&&r(s)?t>1?pu(s,t-1,r,n,i):v0(i,s):n||(i[i.length]=s)}return i}function Snt(e){var t=e==null?0:e.length;return t?pu(e,1):[]}function bg(e){return AN(mnt(e,void 0,Snt),e+"")}var GKt=bg(ON),WKt=GKt,XKt=Ent(Object.getPrototypeOf,Object),JI=XKt,jKt="[object Object]",YKt=Function.prototype,ZKt=Object.prototype,Tnt=YKt.toString,qKt=ZKt.hasOwnProperty,KKt=Tnt.call(Object);function DS(e){if(!Os(e)||hc(e)!=jKt)return!1;var t=JI(e);if(t===null)return!0;var r=qKt.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&Tnt.call(r)==KKt}var QKt="[object DOMException]",JKt="[object Error]";function PN(e){if(!Os(e))return!1;var t=hc(e);return t==JKt||t==QKt||typeof e.message=="string"&&typeof e.name=="string"&&!DS(e)}var tQt=Ki(function(e,t){try{return $h(e,void 0,t)}catch(r){return PN(r)?r:new Error(r)}}),Ant=tQt,eQt="Expected a function";function Mnt(e,t){var r;if(typeof t!="function")throw new TypeError(eQt);return e=Ui(e),function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=void 0),r}}var rQt=1,nQt=32,DN=Ki(function(e,t,r){var n=rQt;if(r.length){var i=t0(r,Rb(DN));n|=nQt}return mg(e,n,t,r,i)});DN.placeholder={};var Rnt=DN,iQt=bg(function(e,t){return td(t,function(r){r=rv(r),yg(e,r,Rnt(e[r],e))}),e}),aQt=iQt,oQt=1,sQt=2,lQt=32,FN=Ki(function(e,t,r){var n=oQt|sQt;if(r.length){var i=t0(r,Rb(FN));n|=lQt}return mg(t,n,e,r,i)});FN.placeholder={};var uQt=FN;function Yf(e,t,r){var n=-1,i=e.length;t<0&&(t=-t>i?0:i+t),r=r>i?i:r,r<0&&(r+=i),i=t>r?0:r-t>>>0,t>>>=0;for(var a=Array(i);++n<i;)a[n]=e[n+t];return a}function g0(e,t,r){var n=e.length;return r=r===void 0?n:r,!t&&r>=n?e:Yf(e,t,r)}var cQt="\\ud800-\\udfff",hQt="\\u0300-\\u036f",fQt="\\ufe20-\\ufe2f",dQt="\\u20d0-\\u20ff",pQt=hQt+fQt+dQt,vQt="\\ufe0e\\ufe0f",gQt="\\u200d",mQt=RegExp("["+gQt+cQt+pQt+vQt+"]");function Ob(e){return mQt.test(e)}function yQt(e){return e.split("")}var Int="\\ud800-\\udfff",_Qt="\\u0300-\\u036f",xQt="\\ufe20-\\ufe2f",bQt="\\u20d0-\\u20ff",EQt=_Qt+xQt+bQt,wQt="\\ufe0e\\ufe0f",CQt="["+Int+"]",JF="["+EQt+"]",tB="\\ud83c[\\udffb-\\udfff]",SQt="(?:"+JF+"|"+tB+")",Lnt="[^"+Int+"]",Ont="(?:\\ud83c[\\udde6-\\uddff]){2}",Pnt="[\\ud800-\\udbff][\\udc00-\\udfff]",TQt="\\u200d",Dnt=SQt+"?",Fnt="["+wQt+"]?",AQt="(?:"+TQt+"(?:"+[Lnt,Ont,Pnt].join("|")+")"+Fnt+Dnt+")*",MQt=Fnt+Dnt+AQt,RQt="(?:"+[Lnt+JF+"?",JF,Ont,Pnt,CQt].join("|")+")",IQt=RegExp(tB+"(?="+tB+")|"+RQt+MQt,"g");function LQt(e){return e.match(IQt)||[]}function Vd(e){return Ob(e)?LQt(e):yQt(e)}function Bnt(e){return function(t){t=za(t);var r=Ob(t)?Vd(t):void 0,n=r?r[0]:t.charAt(0),i=r?g0(r,1).join(""):t.slice(1);return n[e]()+i}}var OQt=Bnt("toUpperCase"),BN=OQt;function Nnt(e){return BN(za(e).toLowerCase())}function NN(e,t,r,n){var i=-1,a=e==null?0:e.length;for(n&&a&&(r=e[++i]);++i<a;)r=t(r,e[i],i,e);return r}function kN(e){return function(t){return e==null?void 0:e[t]}}var PQt={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},DQt=kN(PQt),FQt=DQt,BQt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,NQt="\\u0300-\\u036f",kQt="\\ufe20-\\ufe2f",zQt="\\u20d0-\\u20ff",UQt=NQt+kQt+zQt,$Qt="["+UQt+"]",HQt=RegExp($Qt,"g");function knt(e){return e=za(e),e&&e.replace(BQt,FQt).replace(HQt,"")}var VQt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function GQt(e){return e.match(VQt)||[]}var WQt=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function XQt(e){return WQt.test(e)}var znt="\\ud800-\\udfff",jQt="\\u0300-\\u036f",YQt="\\ufe20-\\ufe2f",ZQt="\\u20d0-\\u20ff",qQt=jQt+YQt+ZQt,Unt="\\u2700-\\u27bf",$nt="a-z\\xdf-\\xf6\\xf8-\\xff",KQt="\\xac\\xb1\\xd7\\xf7",QQt="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",JQt="\\u2000-\\u206f",tJt=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Hnt="A-Z\\xc0-\\xd6\\xd8-\\xde",eJt="\\ufe0e\\ufe0f",Vnt=KQt+QQt+JQt+tJt,Gnt="['’]",_W="["+Vnt+"]",rJt="["+qQt+"]",Wnt="\\d+",nJt="["+Unt+"]",Xnt="["+$nt+"]",jnt="[^"+znt+Vnt+Wnt+Unt+$nt+Hnt+"]",iJt="\\ud83c[\\udffb-\\udfff]",aJt="(?:"+rJt+"|"+iJt+")",oJt="[^"+znt+"]",Ynt="(?:\\ud83c[\\udde6-\\uddff]){2}",Znt="[\\ud800-\\udbff][\\udc00-\\udfff]",H1="["+Hnt+"]",sJt="\\u200d",xW="(?:"+Xnt+"|"+jnt+")",lJt="(?:"+H1+"|"+jnt+")",bW="(?:"+Gnt+"(?:d|ll|m|re|s|t|ve))?",EW="(?:"+Gnt+"(?:D|LL|M|RE|S|T|VE))?",qnt=aJt+"?",Knt="["+eJt+"]?",uJt="(?:"+sJt+"(?:"+[oJt,Ynt,Znt].join("|")+")"+Knt+qnt+")*",cJt="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",hJt="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",fJt=Knt+qnt+uJt,dJt="(?:"+[nJt,Ynt,Znt].join("|")+")"+fJt,pJt=RegExp([H1+"?"+Xnt+"+"+bW+"(?="+[_W,H1,"$"].join("|")+")",lJt+"+"+EW+"(?="+[_W,H1+xW,"$"].join("|")+")",H1+"?"+xW+"+"+bW,H1+"+"+EW,hJt,cJt,Wnt,dJt].join("|"),"g");function vJt(e){return e.match(pJt)||[]}function Qnt(e,t,r){return e=za(e),t=r?void 0:t,t===void 0?XQt(e)?vJt(e):GQt(e):e.match(t)||[]}var gJt="['’]",mJt=RegExp(gJt,"g");function Pb(e){return function(t){return NN(Qnt(knt(t).replace(mJt,"")),e,"")}}var yJt=Pb(function(e,t,r){return t=t.toLowerCase(),e+(r?Nnt(t):t)}),_Jt=yJt;function xJt(){if(!arguments.length)return[];var e=arguments[0];return Wn(e)?e:[e]}var bJt=Xl.isFinite,EJt=Math.min;function zN(e){var t=Math[e];return function(r,n){if(r=Dh(r),n=n==null?0:EJt(Ui(n),292),n&&bJt(r)){var i=(za(r)+"e").split("e"),a=t(i[0]+"e"+(+i[1]+n));return i=(za(a)+"e").split("e"),+(i[0]+"e"+(+i[1]-n))}return t(r)}}var wJt=zN("ceil"),CJt=wJt;function Jnt(e){var t=gt(e);return t.__chain__=!0,t}var SJt=Math.ceil,TJt=Math.max;function AJt(e,t,r){(r?uc(e,t,r):t===void 0)?t=1:t=TJt(Ui(t),0);var n=e==null?0:e.length;if(!n||t<1)return[];for(var i=0,a=0,o=Array(SJt(n/t));i<n;)o[a++]=Yf(e,i,i+=t);return o}function L_(e,t,r){return e===e&&(r!==void 0&&(e=e<=r?e:r),t!==void 0&&(e=e>=t?e:t)),e}function pR(e,t,r){return r===void 0&&(r=t,t=void 0),r!==void 0&&(r=Dh(r),r=r===r?r:0),t!==void 0&&(t=Dh(t),t=t===t?t:0),L_(Dh(e),t,r)}function MJt(){this.__data__=new _g,this.size=0}function RJt(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}function IJt(e){return this.__data__.get(e)}function LJt(e){return this.__data__.has(e)}var OJt=200;function PJt(e,t){var r=this.__data__;if(r instanceof _g){var n=r.__data__;if(!FC||n.length<OJt-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new xg(n)}return r.set(e,t),this.size=r.size,this}function Nd(e){var t=this.__data__=new _g(e);this.size=t.size}Nd.prototype.clear=MJt;Nd.prototype.delete=RJt;Nd.prototype.get=IJt;Nd.prototype.has=LJt;Nd.prototype.set=PJt;function tit(e,t){return e&&ev(t,xs(t),e)}function DJt(e,t){return e&&ev(t,nh(t),e)}var eit=typeof exports=="object"&&exports&&!exports.nodeType&&exports,wW=eit&&typeof module=="object"&&module&&!module.nodeType&&module,FJt=wW&&wW.exports===eit,CW=FJt?Xl.Buffer:void 0,SW=CW?CW.allocUnsafe:void 0;function rit(e,t){if(t)return e.slice();var r=e.length,n=SW?SW(r):new e.constructor(r);return e.copy(n),n}function m0(e,t){for(var r=-1,n=e==null?0:e.length,i=0,a=[];++r<n;){var o=e[r];t(o,r,e)&&(a[i++]=o)}return a}function UN(){return[]}var BJt=Object.prototype,NJt=BJt.propertyIsEnumerable,TW=Object.getOwnPropertySymbols,kJt=TW?function(e){return e==null?[]:(e=Object(e),m0(TW(e),function(t){return NJt.call(e,t)}))}:UN,$N=kJt;function zJt(e,t){return ev(e,$N(e),t)}var UJt=Object.getOwnPropertySymbols,$Jt=UJt?function(e){for(var t=[];e;)v0(t,$N(e)),e=JI(e);return t}:UN,nit=$Jt;function HJt(e,t){return ev(e,nit(e),t)}function iit(e,t,r){var n=t(e);return Wn(e)?n:v0(n,r(e))}function eB(e){return iit(e,xs,$N)}function HN(e){return iit(e,nh,nit)}var VJt=M_(Xl,"DataView"),rB=VJt,GJt=M_(Xl,"Promise"),nB=GJt,WJt=M_(Xl,"Set"),yx=WJt,AW="[object Map]",XJt="[object Object]",MW="[object Promise]",RW="[object Set]",IW="[object WeakMap]",LW="[object DataView]",jJt=A_(rB),YJt=A_(FC),ZJt=A_(nB),qJt=A_(yx),KJt=A_(OC),dy=hc;(rB&&dy(new rB(new ArrayBuffer(1)))!=LW||FC&&dy(new FC)!=AW||nB&&dy(nB.resolve())!=MW||yx&&dy(new yx)!=RW||OC&&dy(new OC)!=IW)&&(dy=function(e){var t=hc(e),r=t==XJt?e.constructor:void 0,n=r?A_(r):"";if(n)switch(n){case jJt:return LW;case YJt:return AW;case ZJt:return MW;case qJt:return RW;case KJt:return IW}return t});var Yp=dy,QJt=Object.prototype,JJt=QJt.hasOwnProperty;function tte(e){var t=e.length,r=new e.constructor(t);return t&&typeof e[0]=="string"&&JJt.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var ete=Xl.Uint8Array,vR=ete;function VN(e){var t=new e.constructor(e.byteLength);return new vR(t).set(new vR(e)),t}function rte(e,t){var r=t?VN(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var nte=/\w*$/;function ite(e){var t=new e.constructor(e.source,nte.exec(e));return t.lastIndex=e.lastIndex,t}var OW=ku?ku.prototype:void 0,PW=OW?OW.valueOf:void 0;function ate(e){return PW?Object(PW.call(e)):{}}function ait(e,t){var r=t?VN(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var ote="[object Boolean]",ste="[object Date]",lte="[object Map]",ute="[object Number]",cte="[object RegExp]",hte="[object Set]",fte="[object String]",dte="[object Symbol]",pte="[object ArrayBuffer]",vte="[object DataView]",gte="[object Float32Array]",mte="[object Float64Array]",yte="[object Int8Array]",_te="[object Int16Array]",xte="[object Int32Array]",bte="[object Uint8Array]",Ete="[object Uint8ClampedArray]",wte="[object Uint16Array]",Cte="[object Uint32Array]";function Ste(e,t,r){var n=e.constructor;switch(t){case pte:return VN(e);case ote:case ste:return new n(+e);case vte:return rte(e,r);case gte:case mte:case yte:case _te:case xte:case bte:case Ete:case wte:case Cte:return ait(e,r);case lte:return new n;case ute:case fte:return new n(e);case cte:return ite(e);case hte:return new n;case dte:return ate(e)}}function oit(e){return typeof e.constructor=="function"&&!PS(e)?Ab(JI(e)):{}}var Tte="[object Map]";function Ate(e){return Os(e)&&Yp(e)==Tte}var DW=jf&&jf.isMap,Mte=DW?Hh(DW):Ate,sit=Mte,Rte="[object Set]";function Ite(e){return Os(e)&&Yp(e)==Rte}var FW=jf&&jf.isSet,Lte=FW?Hh(FW):Ite,lit=Lte,Ote=1,Pte=2,Dte=4,uit="[object Arguments]",Fte="[object Array]",Bte="[object Boolean]",Nte="[object Date]",kte="[object Error]",cit="[object Function]",zte="[object GeneratorFunction]",Ute="[object Map]",$te="[object Number]",hit="[object Object]",Hte="[object RegExp]",Vte="[object Set]",Gte="[object String]",Wte="[object Symbol]",Xte="[object WeakMap]",jte="[object ArrayBuffer]",Yte="[object DataView]",Zte="[object Float32Array]",qte="[object Float64Array]",Kte="[object Int8Array]",Qte="[object Int16Array]",Jte="[object Int32Array]",tee="[object Uint8Array]",eee="[object Uint8ClampedArray]",ree="[object Uint16Array]",nee="[object Uint32Array]",Co={};Co[uit]=Co[Fte]=Co[jte]=Co[Yte]=Co[Bte]=Co[Nte]=Co[Zte]=Co[qte]=Co[Kte]=Co[Qte]=Co[Jte]=Co[Ute]=Co[$te]=Co[hit]=Co[Hte]=Co[Vte]=Co[Gte]=Co[Wte]=Co[tee]=Co[eee]=Co[ree]=Co[nee]=!0;Co[kte]=Co[cit]=Co[Xte]=!1;function $f(e,t,r,n,i,a){var o,s=t&Ote,l=t&Pte,u=t&Dte;if(r&&(o=i?r(e,n,i,a):r(e)),o!==void 0)return o;if(!Ja(e))return e;var c=Wn(e);if(c){if(o=tte(e),!s)return Zc(e,o)}else{var f=Yp(e),d=f==cit||f==zte;if(e0(e))return rit(e,s);if(f==hit||f==uit||d&&!i){if(o=l||d?{}:oit(e),!s)return l?HJt(e,DJt(o,e)):zJt(e,tit(o,e))}else{if(!Co[f])return i?e:{};o=Ste(e,f,s)}}a||(a=new Nd);var v=a.get(e);if(v)return v;a.set(e,o),lit(e)?e.forEach(function(w){o.add($f(w,t,r,w,e,a))}):sit(e)&&e.forEach(function(w,S){o.set(S,$f(w,t,r,S,e,a))});var g=u?l?HN:eB:l?nh:xs,x=c?void 0:g(e);return td(x||e,function(w,S){x&&(S=w,w=e[S]),OS(o,S,$f(w,t,r,S,e,a))}),o}var iee=4;function FS(e){return $f(e,iee)}var aee=1,oee=4;function iB(e){return $f(e,aee|oee)}var see=1,lee=4;function uee(e,t){return t=typeof t=="function"?t:void 0,$f(e,see|lee,t)}var cee=4;function hee(e,t){return t=typeof t=="function"?t:void 0,$f(e,cee,t)}function fee(){return new Xf(this.value(),this.__chain__)}function kd(e){for(var t=-1,r=e==null?0:e.length,n=0,i=[];++t<r;){var a=e[t];a&&(i[n++]=a)}return i}function J1(){var e=arguments.length;if(!e)return[];for(var t=Array(e-1),r=arguments[0],n=e;n--;)t[n-1]=arguments[n];return v0(Wn(r)?Zc(r):[r],pu(t,1))}var dee="__lodash_hash_undefined__";function pee(e){return this.__data__.set(e,dee),this}function vee(e){return this.__data__.has(e)}function s_(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new xg;++t<r;)this.add(e[t])}s_.prototype.add=s_.prototype.push=pee;s_.prototype.has=vee;function GN(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}function BC(e,t){return e.has(t)}var gee=1,mee=2;function fit(e,t,r,n,i,a){var o=r&gee,s=e.length,l=t.length;if(s!=l&&!(o&&l>s))return!1;var u=a.get(e),c=a.get(t);if(u&&c)return u==t&&c==e;var f=-1,d=!0,v=r&mee?new s_:void 0;for(a.set(e,t),a.set(t,e);++f<s;){var g=e[f],x=t[f];if(n)var w=o?n(x,g,f,t,e,a):n(g,x,f,e,t,a);if(w!==void 0){if(w)continue;d=!1;break}if(v){if(!GN(t,function(S,A){if(!BC(v,A)&&(g===S||i(g,S,r,n,a)))return v.push(A)})){d=!1;break}}else if(!(g===x||i(g,x,r,n,a))){d=!1;break}}return a.delete(e),a.delete(t),d}function WN(e){var t=-1,r=Array(e.size);return e.forEach(function(n,i){r[++t]=[i,n]}),r}function t3(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var yee=1,_ee=2,xee="[object Boolean]",bee="[object Date]",Eee="[object Error]",wee="[object Map]",Cee="[object Number]",See="[object RegExp]",Tee="[object Set]",Aee="[object String]",Mee="[object Symbol]",Ree="[object ArrayBuffer]",Iee="[object DataView]",BW=ku?ku.prototype:void 0,tP=BW?BW.valueOf:void 0;function Lee(e,t,r,n,i,a,o){switch(r){case Iee:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Ree:return!(e.byteLength!=t.byteLength||!a(new vR(e),new vR(t)));case xee:case bee:case Cee:return Kd(+e,+t);case Eee:return e.name==t.name&&e.message==t.message;case See:case Aee:return e==t+"";case wee:var s=WN;case Tee:var l=n&yee;if(s||(s=t3),e.size!=t.size&&!l)return!1;var u=o.get(e);if(u)return u==t;n|=_ee,o.set(e,t);var c=fit(s(e),s(t),n,i,a,o);return o.delete(e),c;case Mee:if(tP)return tP.call(e)==tP.call(t)}return!1}var Oee=1,Pee=Object.prototype,Dee=Pee.hasOwnProperty;function Fee(e,t,r,n,i,a){var o=r&Oee,s=eB(e),l=s.length,u=eB(t),c=u.length;if(l!=c&&!o)return!1;for(var f=l;f--;){var d=s[f];if(!(o?d in t:Dee.call(t,d)))return!1}var v=a.get(e),g=a.get(t);if(v&&g)return v==t&&g==e;var x=!0;a.set(e,t),a.set(t,e);for(var w=o;++f<l;){d=s[f];var S=e[d],A=t[d];if(n)var M=o?n(A,S,d,t,e,a):n(S,A,d,e,t,a);if(!(M===void 0?S===A||i(S,A,r,n,a):M)){x=!1;break}w||(w=d=="constructor")}if(x&&!w){var R=e.constructor,O=t.constructor;R!=O&&"constructor"in e&&"constructor"in t&&!(typeof R=="function"&&R instanceof R&&typeof O=="function"&&O instanceof O)&&(x=!1)}return a.delete(e),a.delete(t),x}var Bee=1,NW="[object Arguments]",kW="[object Array]",jT="[object Object]",Nee=Object.prototype,zW=Nee.hasOwnProperty;function kee(e,t,r,n,i,a){var o=Wn(e),s=Wn(t),l=o?kW:Yp(e),u=s?kW:Yp(t);l=l==NW?jT:l,u=u==NW?jT:u;var c=l==jT,f=u==jT,d=l==u;if(d&&e0(e)){if(!e0(t))return!1;o=!0,c=!1}if(d&&!c)return a||(a=new Nd),o||Lb(e)?fit(e,t,r,n,i,a):Lee(e,t,l,r,n,i,a);if(!(r&Bee)){var v=c&&zW.call(e,"__wrapped__"),g=f&&zW.call(t,"__wrapped__");if(v||g){var x=v?e.value():e,w=g?t.value():t;return a||(a=new Nd),i(x,w,r,n,a)}}return d?(a||(a=new Nd),Fee(e,t,r,n,i,a)):!1}function BS(e,t,r,n,i){return e===t?!0:e==null||t==null||!Os(e)&&!Os(t)?e!==e&&t!==t:kee(e,t,r,n,BS,i)}var zee=1,Uee=2;function XN(e,t,r,n){var i=r.length,a=i,o=!n;if(e==null)return!a;for(e=Object(e);i--;){var s=r[i];if(o&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<a;){s=r[i];var l=s[0],u=e[l],c=s[1];if(o&&s[2]){if(u===void 0&&!(l in e))return!1}else{var f=new Nd;if(n)var d=n(u,c,l,e,t,f);if(!(d===void 0?BS(c,u,zee|Uee,n,f):d))return!1}}return!0}function dit(e){return e===e&&!Ja(e)}function jN(e){for(var t=xs(e),r=t.length;r--;){var n=t[r],i=e[n];t[r]=[n,i,dit(i)]}return t}function pit(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}function vit(e){var t=jN(e);return t.length==1&&t[0][2]?pit(t[0][0],t[0][1]):function(r){return r===e||XN(r,e,t)}}function $ee(e,t){return e!=null&&t in Object(e)}function git(e,t,r){t=p0(t,e);for(var n=-1,i=t.length,a=!1;++n<i;){var o=rv(t[n]);if(!(a=e!=null&&r(e,o)))break;e=e[o]}return a||++n!=i?a:(i=e==null?0:e.length,!!i&&qI(i)&&gg(o,i)&&(Wn(e)||a_(e)))}function l_(e,t){return e!=null&&git(e,t,$ee)}var Hee=1,Vee=2;function mit(e,t){return LN(e)&&dit(t)?pit(rv(e),t):function(r){var n=ii(r,e);return n===void 0&&n===t?l_(r,e):BS(t,n,Hee|Vee)}}function YN(e){return function(t){return t==null?void 0:t[e]}}function Gee(e){return function(t){return I_(t,e)}}function yit(e){return LN(e)?YN(rv(e)):Gee(e)}function Mi(e){return typeof e=="function"?e:e==null?Hu:typeof e=="object"?Wn(e)?mit(e[0],e[1]):vit(e):yit(e)}var Wee="Expected a function";function _it(e){var t=e==null?0:e.length,r=Mi;return e=t?es(e,function(n){if(typeof n[1]!="function")throw new TypeError(Wee);return[r(n[0]),n[1]]}):[],Ki(function(n){for(var i=-1;++i<t;){var a=e[i];if($h(a[0],this,n))return $h(a[1],this,n)}})}function xit(e,t,r){var n=r.length;if(e==null)return!n;for(e=Object(e);n--;){var i=r[n],a=t[i],o=e[i];if(o===void 0&&!(i in e)||!a(o))return!1}return!0}function Xee(e){var t=xs(e);return function(r){return xit(r,e,t)}}var jee=1;function Yee(e){return Xee($f(e,jee))}function Zee(e,t){return t==null||xit(e,t,xs(t))}function qee(e,t,r,n){for(var i=-1,a=e==null?0:e.length;++i<a;){var o=e[i];t(n,o,r(o),e)}return n}function bit(e){return function(t,r,n){for(var i=-1,a=Object(t),o=n(t),s=o.length;s--;){var l=o[e?s:++i];if(r(a[l],l,a)===!1)break}return t}}var Kee=bit(),ZN=Kee;function nv(e,t){return e&&ZN(e,t,xs)}function Eit(e,t){return function(r,n){if(r==null)return r;if(!rh(r))return e(r,n);for(var i=r.length,a=t?i:-1,o=Object(r);(t?a--:++a<i)&&n(o[a],a,o)!==!1;);return r}}var Qee=Eit(nv),y0=Qee;function Jee(e,t,r,n){return y0(e,function(i,a,o){t(n,i,r(i),o)}),n}function e3(e,t){return function(r,n){var i=Wn(r)?qee:Jee,a=t?t():{};return i(r,e,Mi(n),a)}}var tre=Object.prototype,ere=tre.hasOwnProperty,rre=e3(function(e,t,r){ere.call(e,r)?++e[r]:yg(e,r,1)}),nre=rre;function ire(e,t){var r=Ab(e);return t==null?r:tit(r,t)}var are=8;function qN(e,t,r){t=r?void 0:t;var n=mg(e,are,void 0,void 0,void 0,void 0,void 0,t);return n.placeholder=qN.placeholder,n}qN.placeholder={};var ore=16;function KN(e,t,r){t=r?void 0:t;var n=mg(e,ore,void 0,void 0,void 0,void 0,void 0,t);return n.placeholder=KN.placeholder,n}KN.placeholder={};var sre=function(){return Xl.Date.now()},VA=sre,lre="Expected a function",ure=Math.max,cre=Math.min;function NC(e,t,r){var n,i,a,o,s,l,u=0,c=!1,f=!1,d=!0;if(typeof e!="function")throw new TypeError(lre);t=Dh(t)||0,Ja(r)&&(c=!!r.leading,f="maxWait"in r,a=f?ure(Dh(r.maxWait)||0,t):a,d="trailing"in r?!!r.trailing:d);function v(N){var k=n,V=i;return n=i=void 0,u=N,o=e.apply(V,k),o}function g(N){return u=N,s=setTimeout(S,t),c?v(N):o}function x(N){var k=N-l,V=N-u,Q=t-k;return f?cre(Q,a-V):Q}function w(N){var k=N-l,V=N-u;return l===void 0||k>=t||k<0||f&&V>=a}function S(){var N=VA();if(w(N))return A(N);s=setTimeout(S,x(N))}function A(N){return s=void 0,d&&n?v(N):(n=i=void 0,o)}function M(){s!==void 0&&clearTimeout(s),u=0,n=l=i=s=void 0}function R(){return s===void 0?o:A(VA())}function O(){var N=VA(),k=w(N);if(n=arguments,i=this,l=N,k){if(s===void 0)return g(l);if(f)return clearTimeout(s),s=setTimeout(S,t),v(l)}return s===void 0&&(s=setTimeout(S,t)),o}return O.cancel=M,O.flush=R,O}function hre(e,t){return e==null||e!==e?t:e}var wit=Object.prototype,fre=wit.hasOwnProperty,dre=Ki(function(e,t){e=Object(e);var r=-1,n=t.length,i=n>2?t[2]:void 0;for(i&&uc(t[0],t[1],i)&&(n=1);++r<n;)for(var a=t[r],o=nh(a),s=-1,l=o.length;++s<l;){var u=o[s],c=e[u];(c===void 0||Kd(c,wit[u])&&!fre.call(e,u))&&(e[u]=a[u])}return e}),pre=dre;function aB(e,t,r){(r!==void 0&&!Kd(e[t],r)||r===void 0&&!(t in e))&&yg(e,t,r)}function Ws(e){return Os(e)&&rh(e)}function oB(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}function Cit(e){return ev(e,nh(e))}function vre(e,t,r,n,i,a,o){var s=oB(e,r),l=oB(t,r),u=o.get(l);if(u){aB(e,r,u);return}var c=a?a(s,l,r+"",e,t,o):void 0,f=c===void 0;if(f){var d=Wn(l),v=!d&&e0(l),g=!d&&!v&&Lb(l);c=l,d||v||g?Wn(s)?c=s:Ws(s)?c=Zc(s):v?(f=!1,c=rit(l,!0)):g?(f=!1,c=ait(l,!0)):c=[]:DS(l)||a_(l)?(c=s,a_(s)?c=Cit(s):(!Ja(s)||hu(s))&&(c=oit(l))):f=!1}f&&(o.set(l,c),i(c,l,n,a,o),o.delete(l)),aB(e,r,c)}function r3(e,t,r,n,i){e!==t&&ZN(t,function(a,o){if(i||(i=new Nd),Ja(a))vre(e,t,o,r,r3,n,i);else{var s=n?n(oB(e,o),a,o+"",e,t,i):void 0;s===void 0&&(s=a),aB(e,o,s)}},nh)}function Sit(e,t,r,n,i,a){return Ja(e)&&Ja(t)&&(a.set(t,e),r3(e,t,void 0,Sit,a),a.delete(t)),e}var gre=Ib(function(e,t,r,n){r3(e,t,r,n)}),QN=gre,mre=Ki(function(e){return e.push(void 0,Sit),$h(QN,void 0,e)}),yre=mre,_re="Expected a function";function Tit(e,t,r){if(typeof e!="function")throw new TypeError(_re);return setTimeout(function(){e.apply(void 0,r)},t)}var xre=Ki(function(e,t){return Tit(e,1,t)}),bre=xre,Ere=Ki(function(e,t,r){return Tit(e,Dh(t)||0,r)}),wre=Ere;function JN(e,t,r){for(var n=-1,i=e==null?0:e.length;++n<i;)if(r(t,e[n]))return!0;return!1}var Cre=200;function NS(e,t,r,n){var i=-1,a=YI,o=!0,s=e.length,l=[],u=t.length;if(!s)return l;r&&(t=es(t,Hh(r))),n?(a=JN,o=!1):t.length>=Cre&&(a=BC,o=!1,t=new s_(t));t:for(;++i<s;){var c=e[i],f=r==null?c:r(c);if(c=n||c!==0?c:0,o&&f===f){for(var d=u;d--;)if(t[d]===f)continue t;l.push(c)}else a(t,f,n)||l.push(c)}return l}var Sre=Ki(function(e,t){return Ws(e)?NS(e,pu(t,1,Ws,!0)):[]}),Ait=Sre;function co(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var Tre=Ki(function(e,t){var r=co(t);return Ws(r)&&(r=void 0),Ws(e)?NS(e,pu(t,1,Ws,!0),Mi(r)):[]}),Are=Tre,Mre=Ki(function(e,t){var r=co(t);return Ws(r)&&(r=void 0),Ws(e)?NS(e,pu(t,1,Ws,!0),void 0,r):[]}),Mit=Mre,Rre=GI(function(e,t){return e/t},1),Ire=Rre;function Lre(e,t,r){var n=e==null?0:e.length;return n?(t=r||t===void 0?1:Ui(t),Yf(e,t<0?0:t,n)):[]}function Ore(e,t,r){var n=e==null?0:e.length;return n?(t=r||t===void 0?1:Ui(t),t=n-t,Yf(e,0,t<0?0:t)):[]}function n3(e,t,r,n){for(var i=e.length,a=n?i:-1;(n?a--:++a<i)&&t(e[a],a,e););return r?Yf(e,n?0:a,n?a+1:i):Yf(e,n?a+1:0,n?i:a)}function Pre(e,t){return e&&e.length?n3(e,Mi(t),!0,!0):[]}function Dre(e,t){return e&&e.length?n3(e,Mi(t),!0):[]}function iv(e){return typeof e=="function"?e:Hu}function xi(e,t){var r=Wn(e)?td:y0;return r(e,iv(t))}function Fre(e,t){for(var r=e==null?0:e.length;r--&&t(e[r],r,e)!==!1;);return e}var Bre=bit(!0),Rit=Bre;function tk(e,t){return e&&Rit(e,t,xs)}var Nre=Eit(tk,!0),Iit=Nre;function UW(e,t){var r=Wn(e)?Fre:Iit;return r(e,iv(t))}function Lit(e,t,r){e=za(e),t=Uh(t);var n=e.length;r=r===void 0?n:L_(Ui(r),0,n);var i=r;return r-=t.length,r>=0&&e.slice(r,i)==t}function kre(e,t){return es(t,function(r){return[r,e[r]]})}function zre(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=[n,n]}),r}var Ure="[object Map]",$re="[object Set]";function Oit(e){return function(t){var r=Yp(t);return r==Ure?WN(t):r==$re?zre(t):kre(t,e(t))}}var Hre=Oit(xs),$W=Hre,Vre=Oit(nh),HW=Vre,Gre={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Wre=kN(Gre),Xre=Wre,Pit=/[&<>"']/g,jre=RegExp(Pit.source);function ek(e){return e=za(e),e&&jre.test(e)?e.replace(Pit,Xre):e}var Dit=/[\\^$.*+?()[\]{}|]/g,Yre=RegExp(Dit.source);function Zre(e){return e=za(e),e&&Yre.test(e)?e.replace(Dit,"\\$&"):e}function Fit(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}function qre(e,t){var r=!0;return y0(e,function(n,i,a){return r=!!t(n,i,a),r}),r}function i3(e,t,r){var n=Wn(e)?Fit:qre;return r&&uc(e,t,r)&&(t=void 0),n(e,Mi(t))}var Kre=4294967295;function Bit(e){return e?L_(Ui(e),0,Kre):0}function Qre(e,t,r,n){var i=e.length;for(r=Ui(r),r<0&&(r=-r>i?0:i+r),n=n===void 0||n>i?i:Ui(n),n<0&&(n+=i),n=r>n?0:Bit(n);r<n;)e[r++]=t;return e}function Jre(e,t,r,n){var i=e==null?0:e.length;return i?(r&&typeof r!="number"&&uc(e,t,r)&&(r=0,n=i),Qre(e,t,r,n)):[]}function Nit(e,t){var r=[];return y0(e,function(n,i,a){t(n,i,a)&&r.push(n)}),r}function Eg(e,t){var r=Wn(e)?m0:Nit;return r(e,Mi(t))}function kit(e){return function(t,r,n){var i=Object(t);if(!rh(t)){var a=Mi(r);t=xs(t),r=function(s){return a(i[s],s,i)}}var o=e(t,r,n);return o>-1?i[a?t[o]:o]:void 0}}var tne=Math.max;function Jx(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var i=r==null?0:Ui(r);return i<0&&(i=tne(n+i,0)),jI(e,Mi(t),i)}var ene=kit(Jx),zu=ene;function zit(e,t,r){var n;return r(e,function(i,a,o){if(t(i,a,o))return n=a,!1}),n}function rne(e,t){return zit(e,Mi(t),nv)}var nne=Math.max,ine=Math.min;function Uit(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var i=n-1;return r!==void 0&&(i=Ui(r),i=r<0?nne(n+i,0):ine(i,n-1)),jI(e,Mi(t),i,!0)}var ane=kit(Uit),a3=ane;function one(e,t){return zit(e,Mi(t),tk)}function u_(e){return e&&e.length?e[0]:void 0}function $it(e,t){var r=-1,n=rh(e)?Array(e.length):[];return y0(e,function(i,a,o){n[++r]=t(i,a,o)}),n}function ia(e,t){var r=Wn(e)?es:$it;return r(e,Mi(t))}function kS(e,t){return pu(ia(e,t),1)}var sne=1/0;function lne(e,t){return pu(ia(e,t),sne)}function une(e,t,r){return r=r===void 0?1:Ui(r),pu(ia(e,t),r)}var cne=1/0;function Hit(e){var t=e==null?0:e.length;return t?pu(e,cne):[]}function hne(e,t){var r=e==null?0:e.length;return r?(t=t===void 0?1:Ui(t),pu(e,t)):[]}var fne=512;function dne(e){return mg(e,fne)}var pne=zN("floor"),vne=pne,gne="Expected a function",mne=8,yne=32,_ne=128,xne=256;function Vit(e){return bg(function(t){var r=t.length,n=r,i=Xf.prototype.thru;for(e&&t.reverse();n--;){var a=t[n];if(typeof a!="function")throw new TypeError(gne);if(i&&!o&&HA(a)=="wrapper")var o=new Xf([],!0)}for(n=o?n:r;++n<r;){a=t[n];var s=HA(a),l=s=="wrapper"?TN(a):void 0;l&&QF(l[0])&&l[1]==(_ne|mne|yne|xne)&&!l[4].length&&l[9]==1?o=o[HA(l[0])].apply(o,l[3]):o=a.length==1&&QF(a)?o[s]():o.thru(a)}return function(){var u=arguments,c=u[0];if(o&&u.length==1&&Wn(c))return o.plant(c).value();for(var f=0,d=r?t[f].apply(this,u):c;++f<r;)d=t[f].call(this,d);return d}})}var bne=Vit(),Ene=bne,wne=Vit(!0),Cne=wne;function Git(e,t){return e==null?e:ZN(e,iv(t),nh)}function Sne(e,t){return e==null?e:Rit(e,iv(t),nh)}function Tne(e,t){return e&&nv(e,iv(t))}function Ane(e,t){return e&&tk(e,iv(t))}function Mne(e){for(var t=-1,r=e==null?0:e.length,n={};++t<r;){var i=e[t];n[i[0]]=i[1]}return n}function o3(e,t){return m0(t,function(r){return hu(e[r])})}function Rne(e){return e==null?[]:o3(e,xs(e))}function Ine(e){return e==null?[]:o3(e,nh(e))}var Lne=Object.prototype,One=Lne.hasOwnProperty,Pne=e3(function(e,t,r){One.call(e,r)?e[r].push(t):yg(e,r,[t])}),Dne=Pne;function rk(e,t){return e>t}function s3(e){return function(t,r){return typeof t=="string"&&typeof r=="string"||(t=Dh(t),r=Dh(r)),e(t,r)}}var Fne=s3(rk),Bne=Fne,Nne=s3(function(e,t){return e>=t}),kne=Nne,zne=Object.prototype,Une=zne.hasOwnProperty;function $ne(e,t){return e!=null&&Une.call(e,t)}function sB(e,t){return e!=null&&git(e,t,$ne)}var Hne=Math.max,Vne=Math.min;function Gne(e,t,r){return e>=Vne(t,r)&&e<Hne(t,r)}function lB(e,t,r){return t=ag(t),r===void 0?(r=t,t=0):r=ag(r),e=Dh(e),Gne(e,t,r)}var Wne="[object String]";function Db(e){return typeof e=="string"||!Wn(e)&&Os(e)&&hc(e)==Wne}function nk(e,t){return es(t,function(r){return e[r]})}function wg(e){return e==null?[]:nk(e,xs(e))}var Xne=Math.max;function oc(e,t,r,n){e=rh(e)?e:wg(e),r=r&&!n?Ui(r):0;var i=e.length;return r<0&&(r=Xne(i+r,0)),Db(e)?r<=i&&e.indexOf(t,r)>-1:!!i&&Mb(e,t,r)>-1}var jne=Math.max;function l3(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var i=r==null?0:Ui(r);return i<0&&(i=jne(n+i,0)),Mb(e,t,i)}function Yne(e){var t=e==null?0:e.length;return t?Yf(e,0,-1):[]}var Zne=Math.min;function ik(e,t,r){for(var n=r?JN:YI,i=e[0].length,a=e.length,o=a,s=Array(a),l=1/0,u=[];o--;){var c=e[o];o&&t&&(c=es(c,Hh(t))),l=Zne(c.length,l),s[o]=!r&&(t||i>=120&&c.length>=120)?new s_(o&&c):void 0}c=e[0];var f=-1,d=s[0];t:for(;++f<i&&u.length<l;){var v=c[f],g=t?t(v):v;if(v=r||v!==0?v:0,!(d?BC(d,g):n(u,g,r))){for(o=a;--o;){var x=s[o];if(!(x?BC(x,g):n(e[o],g,r)))continue t}d&&d.push(g),u.push(v)}}return u}function ak(e){return Ws(e)?e:[]}var qne=Ki(function(e){var t=es(e,ak);return t.length&&t[0]===e[0]?ik(t):[]}),Wit=qne,Kne=Ki(function(e){var t=co(e),r=es(e,ak);return t===co(r)?t=void 0:r.pop(),r.length&&r[0]===e[0]?ik(r,Mi(t)):[]}),Qne=Kne,Jne=Ki(function(e){var t=co(e),r=es(e,ak);return t=typeof t=="function"?t:void 0,t&&r.pop(),r.length&&r[0]===e[0]?ik(r,void 0,t):[]}),tie=Jne;function eie(e,t,r,n){return nv(e,function(i,a,o){t(n,r(i),a,o)}),n}function Xit(e,t){return function(r,n){return eie(r,e,t(n),{})}}var rie=Object.prototype,nie=rie.toString,iie=Xit(function(e,t,r){t!=null&&typeof t.toString!="function"&&(t=nie.call(t)),e[t]=r},mx(Hu)),aie=iie,jit=Object.prototype,oie=jit.hasOwnProperty,sie=jit.toString,lie=Xit(function(e,t,r){t!=null&&typeof t.toString!="function"&&(t=sie.call(t)),oie.call(e,t)?e[t].push(r):e[t]=[r]},Mi),uie=lie;function Yit(e,t){return t.length<2?e:I_(e,Yf(t,0,-1))}function zS(e,t,r){t=p0(t,e),e=Yit(e,t);var n=e==null?e:e[rv(co(t))];return n==null?void 0:$h(n,e,r)}var cie=Ki(zS),hie=cie,fie=Ki(function(e,t,r){var n=-1,i=typeof t=="function",a=rh(e)?Array(e.length):[];return y0(e,function(o){a[++n]=i?$h(t,o,r):zS(o,t,r)}),a}),die=fie,pie="[object ArrayBuffer]";function vie(e){return Os(e)&&hc(e)==pie}var VW=jf&&jf.isArrayBuffer,gie=VW?Hh(VW):vie,mie=gie,yie="[object Boolean]";function Dp(e){return e===!0||e===!1||Os(e)&&hc(e)==yie}var _ie="[object Date]";function xie(e){return Os(e)&&hc(e)==_ie}var GW=jf&&jf.isDate,bie=GW?Hh(GW):xie,Eie=bie;function wie(e){return Os(e)&&e.nodeType===1&&!DS(e)}var Cie="[object Map]",Sie="[object Set]",Tie=Object.prototype,Aie=Tie.hasOwnProperty;function Or(e){if(e==null)return!0;if(rh(e)&&(Wn(e)||typeof e=="string"||typeof e.splice=="function"||e0(e)||Lb(e)||a_(e)))return!e.length;var t=Yp(e);if(t==Cie||t==Sie)return!e.size;if(PS(e))return!IN(e).length;for(var r in e)if(Aie.call(e,r))return!1;return!0}function cu(e,t){return BS(e,t)}function Mie(e,t,r){r=typeof r=="function"?r:void 0;var n=r?r(e,t):void 0;return n===void 0?BS(e,t,void 0,r):!!n}var Rie=Xl.isFinite;function Iie(e){return typeof e=="number"&&Rie(e)}function Zit(e){return typeof e=="number"&&e==Ui(e)}function Lie(e,t){return e===t||XN(e,t,jN(t))}function Oie(e,t,r){return r=typeof r=="function"?r:void 0,XN(e,t,jN(t),r)}var Pie="[object Number]";function nc(e){return typeof e=="number"||Os(e)&&hc(e)==Pie}function qit(e){return nc(e)&&e!=+e}var Die=$A?hu:RN,Fie=Die,Bie="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.";function Nie(e){if(Fie(e))throw new Error(Bie);return ont(e)}function bl(e){return e==null}function Kit(e){return e===null}var kie="[object RegExp]";function zie(e){return Os(e)&&hc(e)==kie}var WW=jf&&jf.isRegExp,Uie=WW?Hh(WW):zie,ok=Uie,XW=9007199254740991;function $ie(e){return Zit(e)&&e>=-XW&&e<=XW}function u3(e){return e===void 0}var Hie="[object WeakMap]";function Vie(e){return Os(e)&&Yp(e)==Hie}var Gie="[object WeakSet]";function Wie(e){return Os(e)&&hc(e)==Gie}var Xie=1;function jie(e){return Mi(typeof e=="function"?e:$f(e,Xie))}var Yie=Array.prototype,Zie=Yie.join;function qie(e,t){return e==null?"":Zie.call(e,t)}var Kie=Pb(function(e,t,r){return e+(r?"-":"")+t.toLowerCase()}),Qie=Kie,Jie=e3(function(e,t,r){yg(e,r,t)}),tae=Jie;function eae(e,t,r){for(var n=r+1;n--;)if(e[n]===t)return n;return n}var rae=Math.max,nae=Math.min;function iae(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var i=n;return r!==void 0&&(i=Ui(r),i=i<0?rae(n+i,0):nae(i,n-1)),t===t?eae(e,t,i):jI(e,dnt,i,!0)}var aae=Pb(function(e,t,r){return e+(r?" ":"")+t.toLowerCase()}),sk=aae,oae=Bnt("toLowerCase"),sae=oae;function lk(e,t){return e<t}var lae=s3(lk),uae=lae,cae=s3(function(e,t){return e<=t}),hae=cae;function Qit(e,t){var r={};return t=Mi(t),nv(e,function(n,i,a){yg(r,t(n,i,a),n)}),r}function fae(e,t){var r={};return t=Mi(t),nv(e,function(n,i,a){yg(r,i,t(n,i,a))}),r}var dae=1;function uB(e){return vit($f(e,dae))}var pae=1;function vae(e,t){return mit(e,$f(t,pae))}function c3(e,t,r){for(var n=-1,i=e.length;++n<i;){var a=e[n],o=t(a);if(o!=null&&(s===void 0?o===o&&!zh(o):r(o,s)))var s=o,l=a}return l}function tb(e){return e&&e.length?c3(e,Hu,rk):void 0}function uk(e,t){return e&&e.length?c3(e,Mi(t),rk):void 0}function ck(e,t){for(var r,n=-1,i=e.length;++n<i;){var a=t(e[n]);a!==void 0&&(r=r===void 0?a:r+a)}return r}var gae=0/0;function Jit(e,t){var r=e==null?0:e.length;return r?ck(e,t)/r:gae}function mae(e){return Jit(e,Hu)}function yae(e,t){return Jit(e,Mi(t))}var _ae=Ib(function(e,t,r){r3(e,t,r)}),gR=_ae,xae=Ki(function(e,t){return function(r){return zS(r,e,t)}}),bae=xae,Eae=Ki(function(e,t){return function(r){return zS(e,r,t)}}),wae=Eae;function hk(e){return e&&e.length?c3(e,Hu,lk):void 0}function Cae(e,t){return e&&e.length?c3(e,Mi(t),lk):void 0}function tat(e,t,r){var n=xs(t),i=o3(t,n),a=!(Ja(r)&&"chain"in r)||!!r.chain,o=hu(e);return td(i,function(s){var l=t[s];e[s]=l,o&&(e.prototype[s]=function(){var u=this.__chain__;if(a||u){var c=e(this.__wrapped__),f=c.__actions__=Zc(this.__actions__);return f.push({func:l,args:arguments,thisArg:e}),c.__chain__=u,c}return l.apply(e,v0([this.value()],arguments))})}),e}var Sae=GI(function(e,t){return e*t},1),Tae=Sae,Aae="Expected a function";function US(e){if(typeof e!="function")throw new TypeError(Aae);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function Mae(e){for(var t,r=[];!(t=e.next()).done;)r.push(t.value);return r}var Rae="[object Map]",Iae="[object Set]",eP=ku?ku.iterator:void 0;function eat(e){if(!e)return[];if(rh(e))return Db(e)?Vd(e):Zc(e);if(eP&&e[eP])return Mae(e[eP]());var t=Yp(e),r=t==Rae?WN:t==Iae?t3:wg;return r(e)}function Lae(){this.__values__===void 0&&(this.__values__=eat(this.value()));var e=this.__index__>=this.__values__.length,t=e?void 0:this.__values__[this.__index__++];return{done:e,value:t}}function rat(e,t){var r=e.length;if(r)return t+=t<0?r:0,gg(t,r)?e[t]:void 0}function Oae(e,t){return e&&e.length?rat(e,Ui(t)):void 0}function Pae(e){return e=Ui(e),Ki(function(t){return rat(t,e)})}function fk(e,t){return t=p0(t,e),e=Yit(e,t),e==null||delete e[rv(co(t))]}function Dae(e){return DS(e)?void 0:e}var Fae=1,Bae=2,Nae=4,kae=bg(function(e,t){var r={};if(e==null)return r;var n=!1;t=es(t,function(a){return a=p0(a,e),n||(n=a.length>1),a}),ev(e,HN(e),r),n&&(r=$f(r,Fae|Bae|Nae,Dae));for(var i=t.length;i--;)fk(r,t[i]);return r}),dk=kae;function $S(e,t,r,n){if(!Ja(e))return e;t=p0(t,e);for(var i=-1,a=t.length,o=a-1,s=e;s!=null&&++i<a;){var l=rv(t[i]),u=r;if(l==="__proto__"||l==="constructor"||l==="prototype")return e;if(i!=o){var c=s[l];u=n?n(c,l,s):void 0,u===void 0&&(u=Ja(c)?c:gg(t[i+1])?[]:{})}OS(s,l,u),s=s[l]}return e}function nat(e,t,r){for(var n=-1,i=t.length,a={};++n<i;){var o=t[n],s=I_(e,o);r(s,o)&&$S(a,p0(o,e),s)}return a}function pk(e,t){if(e==null)return{};var r=es(HN(e),function(n){return[n]});return t=Mi(t),nat(e,r,function(n,i){return t(n,i[0])})}function zae(e,t){return pk(e,US(Mi(t)))}function Uae(e){return Mnt(2,e)}function $ae(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}function iat(e,t){if(e!==t){var r=e!==void 0,n=e===null,i=e===e,a=zh(e),o=t!==void 0,s=t===null,l=t===t,u=zh(t);if(!s&&!u&&!a&&e>t||a&&o&&l&&!s&&!u||n&&o&&l||!r&&l||!i)return 1;if(!n&&!a&&!u&&e<t||u&&r&&i&&!n&&!a||s&&r&&i||!o&&i||!l)return-1}return 0}function Hae(e,t,r){for(var n=-1,i=e.criteria,a=t.criteria,o=i.length,s=r.length;++n<o;){var l=iat(i[n],a[n]);if(l){if(n>=s)return l;var u=r[n];return l*(u=="desc"?-1:1)}}return e.index-t.index}function aat(e,t,r){t.length?t=es(t,function(a){return Wn(a)?function(o){return I_(o,a.length===1?a[0]:a)}:a}):t=[Hu];var n=-1;t=es(t,Hh(Mi));var i=$it(e,function(a,o,s){var l=es(t,function(u){return u(a)});return{criteria:l,index:++n,value:a}});return $ae(i,function(a,o){return Hae(a,o,r)})}function vk(e,t,r,n){return e==null?[]:(Wn(t)||(t=t==null?[]:[t]),r=n?void 0:r,Wn(r)||(r=r==null?[]:[r]),aat(e,t,r))}function gk(e){return bg(function(t){return t=es(t,Hh(Mi)),Ki(function(r){var n=this;return e(t,function(i){return $h(i,n,r)})})})}var Vae=gk(es),Gae=Vae,Wae=Ki,Xae=Wae,jae=Math.min,Yae=Xae(function(e,t){t=t.length==1&&Wn(t[0])?es(t[0],Hh(Mi)):es(pu(t,1),Hh(Mi));var r=t.length;return Ki(function(n){for(var i=-1,a=jae(n.length,r);++i<a;)n[i]=t[i].call(this,n[i]);return $h(e,this,n)})}),Zae=Yae,qae=gk(Fit),Kae=qae,Qae=gk(GN),Jae=Qae,toe=9007199254740991,eoe=Math.floor;function cB(e,t){var r="";if(!e||t<1||t>toe)return r;do t%2&&(r+=e),t=eoe(t/2),t&&(e+=e);while(t);return r}var roe=YN("length"),noe=roe,oat="\\ud800-\\udfff",ioe="\\u0300-\\u036f",aoe="\\ufe20-\\ufe2f",ooe="\\u20d0-\\u20ff",soe=ioe+aoe+ooe,loe="\\ufe0e\\ufe0f",uoe="["+oat+"]",hB="["+soe+"]",fB="\\ud83c[\\udffb-\\udfff]",coe="(?:"+hB+"|"+fB+")",sat="[^"+oat+"]",lat="(?:\\ud83c[\\udde6-\\uddff]){2}",uat="[\\ud800-\\udbff][\\udc00-\\udfff]",hoe="\\u200d",cat=coe+"?",hat="["+loe+"]?",foe="(?:"+hoe+"(?:"+[sat,lat,uat].join("|")+")"+hat+cat+")*",doe=hat+cat+foe,poe="(?:"+[sat+hB+"?",hB,lat,uat,uoe].join("|")+")",jW=RegExp(fB+"(?="+fB+")|"+poe+doe,"g");function voe(e){for(var t=jW.lastIndex=0;jW.test(e);)++t;return t}function Fb(e){return Ob(e)?voe(e):noe(e)}var goe=Math.ceil;function mR(e,t){t=t===void 0?" ":Uh(t);var r=t.length;if(r<2)return r?cB(t,e):t;var n=cB(t,goe(e/Fb(t)));return Ob(t)?g0(Vd(n),0,e).join(""):n.slice(0,e)}var moe=Math.ceil,yoe=Math.floor;function _oe(e,t,r){e=za(e),t=Ui(t);var n=t?Fb(e):0;if(!t||n>=t)return e;var i=(t-n)/2;return mR(yoe(i),r)+e+mR(moe(i),r)}function xoe(e,t,r){e=za(e),t=Ui(t);var n=t?Fb(e):0;return t&&n<t?e+mR(t-n,r):e}function boe(e,t,r){e=za(e),t=Ui(t);var n=t?Fb(e):0;return t&&n<t?mR(t-n,r)+e:e}var Eoe=/^\s+/,woe=Xl.parseInt;function Coe(e,t,r){return r||t==null?t=0:t&&(t=+t),woe(za(e).replace(Eoe,""),t||0)}var Soe=32,mk=Ki(function(e,t){var r=t0(t,Rb(mk));return mg(e,Soe,void 0,t,r)});mk.placeholder={};var fat=mk,Toe=64,yk=Ki(function(e,t){var r=t0(t,Rb(yk));return mg(e,Toe,void 0,t,r)});yk.placeholder={};var Aoe=yk,Moe=e3(function(e,t,r){e[r?0:1].push(t)},function(){return[[],[]]}),Roe=Moe;function Ioe(e,t){return nat(e,t,function(r,n){return l_(e,n)})}var Loe=bg(function(e,t){return e==null?{}:Ioe(e,t)}),dat=Loe;function Ooe(e){for(var t,r=this;r instanceof WI;){var n=cnt(r);n.__index__=0,n.__values__=void 0,t?i.__wrapped__=n:t=n;var i=n;r=r.__wrapped__}return i.__wrapped__=e,t}function Poe(e){return function(t){return e==null?void 0:I_(e,t)}}function Doe(e,t,r,n){for(var i=r-1,a=e.length;++i<a;)if(n(e[i],t))return i;return-1}var Foe=Array.prototype,YW=Foe.splice;function _k(e,t,r,n){var i=n?Doe:Mb,a=-1,o=t.length,s=e;for(e===t&&(t=Zc(t)),r&&(s=es(e,Hh(r)));++a<o;)for(var l=0,u=t[a],c=r?r(u):u;(l=i(s,c,l,n))>-1;)s!==e&&YW.call(s,l,1),YW.call(e,l,1);return e}function pat(e,t){return e&&e.length&&t&&t.length?_k(e,t):e}var Boe=Ki(pat),Noe=Boe;function koe(e,t,r){return e&&e.length&&t&&t.length?_k(e,t,Mi(r)):e}function zoe(e,t,r){return e&&e.length&&t&&t.length?_k(e,t,void 0,r):e}var Uoe=Array.prototype,$oe=Uoe.splice;function vat(e,t){for(var r=e?t.length:0,n=r-1;r--;){var i=t[r];if(r==n||i!==a){var a=i;gg(i)?$oe.call(e,i,1):fk(e,i)}}return e}var Hoe=bg(function(e,t){var r=e==null?0:e.length,n=ON(e,t);return vat(e,es(t,function(i){return gg(i,r)?+i:i}).sort(iat)),n}),Voe=Hoe,Goe=Math.floor,Woe=Math.random;function xk(e,t){return e+Goe(Woe()*(t-e+1))}var Xoe=parseFloat,joe=Math.min,Yoe=Math.random;function Zoe(e,t,r){if(r&&typeof r!="boolean"&&uc(e,t,r)&&(t=r=void 0),r===void 0&&(typeof t=="boolean"?(r=t,t=void 0):typeof e=="boolean"&&(r=e,e=void 0)),e===void 0&&t===void 0?(e=0,t=1):(e=ag(e),t===void 0?(t=e,e=0):t=ag(t)),e>t){var n=e;e=t,t=n}if(r||e%1||t%1){var i=Yoe();return joe(e+i*(t-e+Xoe("1e-"+((i+"").length-1))),t)}return xk(e,t)}var qoe=Math.ceil,Koe=Math.max;function Qoe(e,t,r,n){for(var i=-1,a=Koe(qoe((t-e)/(r||1)),0),o=Array(a);a--;)o[n?a:++i]=e,e+=r;return o}function gat(e){return function(t,r,n){return n&&typeof n!="number"&&uc(t,r,n)&&(r=n=void 0),t=ag(t),r===void 0?(r=t,t=0):r=ag(r),n=n===void 0?t<r?1:-1:ag(n),Qoe(t,r,n,e)}}var Joe=gat(),_x=Joe,tse=gat(!0),ese=tse,rse=256,nse=bg(function(e,t){return mg(e,rse,void 0,void 0,void 0,t)}),ise=nse;function mat(e,t,r,n,i){return i(e,function(a,o,s){r=n?(n=!1,a):t(r,a,o,s)}),r}function h3(e,t,r){var n=Wn(e)?NN:mat,i=arguments.length<3;return n(e,Mi(t),r,i,y0)}function ase(e,t,r,n){var i=e==null?0:e.length;for(n&&i&&(r=e[--i]);i--;)r=t(r,e[i],i,e);return r}function ose(e,t,r){var n=Wn(e)?ase:mat,i=arguments.length<3;return n(e,Mi(t),r,i,Iit)}function sse(e,t){var r=Wn(e)?m0:Nit;return r(e,US(Mi(t)))}function lse(e,t){var r=[];if(!(e&&e.length))return r;var n=-1,i=[],a=e.length;for(t=Mi(t);++n<a;){var o=e[n];t(o,n,e)&&(r.push(o),i.push(n))}return vat(e,i),r}function use(e,t,r){return(r?uc(e,t,r):t===void 0)?t=1:t=Ui(t),cB(za(e),t)}function cse(){var e=arguments,t=za(e[0]);return e.length<3?t:t.replace(e[1],e[2])}var hse="Expected a function";function fse(e,t){if(typeof e!="function")throw new TypeError(hse);return t=t===void 0?t:Ui(t),Ki(e,t)}function dse(e,t,r){t=p0(t,e);var n=-1,i=t.length;for(i||(i=1,e=void 0);++n<i;){var a=e==null?void 0:e[rv(t[n])];a===void 0&&(n=i,a=r),e=hu(a)?a.call(e):a}return e}var pse=Array.prototype,vse=pse.reverse;function dB(e){return e==null?e:vse.call(e)}var gse=zN("round"),mse=gse;function yat(e){var t=e.length;return t?e[xk(0,t-1)]:void 0}function yse(e){return yat(wg(e))}function _se(e){var t=Wn(e)?yat:yse;return t(e)}function f3(e,t){var r=-1,n=e.length,i=n-1;for(t=t===void 0?n:t;++r<t;){var a=xk(r,i),o=e[a];e[a]=e[r],e[r]=o}return e.length=t,e}function xse(e,t){return f3(Zc(e),L_(t,0,e.length))}function bse(e,t){var r=wg(e);return f3(r,L_(t,0,r.length))}function Ese(e,t,r){(r?uc(e,t,r):t===void 0)?t=1:t=Ui(t);var n=Wn(e)?xse:bse;return n(e,t)}function kC(e,t,r){return e==null?e:$S(e,t,r)}function wse(e,t,r,n){return n=typeof n=="function"?n:void 0,e==null?e:$S(e,t,r,n)}function Cse(e){return f3(Zc(e))}function Sse(e){return f3(wg(e))}function Tse(e){var t=Wn(e)?Cse:Sse;return t(e)}var Ase="[object Map]",Mse="[object Set]";function tx(e){if(e==null)return 0;if(rh(e))return Db(e)?Fb(e):e.length;var t=Yp(e);return t==Ase||t==Mse?e.size:IN(e).length}function Rse(e,t,r){var n=e==null?0:e.length;return n?(r&&typeof r!="number"&&uc(e,t,r)?(t=0,r=n):(t=t==null?0:Ui(t),r=r===void 0?n:Ui(r)),Yf(e,t,r)):[]}var Ise=Pb(function(e,t,r){return e+(r?"_":"")+t.toLowerCase()}),Lse=Ise;function Ose(e,t){var r;return y0(e,function(n,i,a){return r=t(n,i,a),!r}),!!r}function _at(e,t,r){var n=Wn(e)?GN:Ose;return r&&uc(e,t,r)&&(t=void 0),n(e,Mi(t))}var Pse=Ki(function(e,t){if(e==null)return[];var r=t.length;return r>1&&uc(e,t[0],t[1])?t=[]:r>2&&uc(t[0],t[1],t[2])&&(t=[t[0]]),aat(e,pu(t,1),[])}),xat=Pse,Dse=4294967295,Fse=Dse-1,Bse=Math.floor,Nse=Math.min;function bk(e,t,r,n){var i=0,a=e==null?0:e.length;if(a===0)return 0;t=r(t);for(var o=t!==t,s=t===null,l=zh(t),u=t===void 0;i<a;){var c=Bse((i+a)/2),f=r(e[c]),d=f!==void 0,v=f===null,g=f===f,x=zh(f);if(o)var w=n||g;else u?w=g&&(n||d):s?w=g&&d&&(n||!v):l?w=g&&d&&!v&&(n||!x):v||x?w=!1:w=n?f<=t:f<t;w?i=c+1:a=c}return Nse(a,Fse)}var kse=4294967295,zse=kse>>>1;function d3(e,t,r){var n=0,i=e==null?n:e.length;if(typeof t=="number"&&t===t&&i<=zse){for(;n<i;){var a=n+i>>>1,o=e[a];o!==null&&!zh(o)&&(r?o<=t:o<t)?n=a+1:i=a}return i}return bk(e,t,Hu,r)}function Use(e,t){return d3(e,t)}function $se(e,t,r){return bk(e,t,Mi(r))}function Hse(e,t){var r=e==null?0:e.length;if(r){var n=d3(e,t);if(n<r&&Kd(e[n],t))return n}return-1}function Vse(e,t){return d3(e,t,!0)}function Gse(e,t,r){return bk(e,t,Mi(r),!0)}function Wse(e,t){var r=e==null?0:e.length;if(r){var n=d3(e,t,!0)-1;if(Kd(e[n],t))return n}return-1}function bat(e,t){for(var r=-1,n=e.length,i=0,a=[];++r<n;){var o=e[r],s=t?t(o):o;if(!r||!Kd(s,l)){var l=s;a[i++]=o===0?0:o}}return a}function Xse(e){return e&&e.length?bat(e):[]}function jse(e,t){return e&&e.length?bat(e,Mi(t)):[]}var Yse=4294967295;function Eat(e,t,r){return r&&typeof r!="number"&&uc(e,t,r)&&(t=r=void 0),r=r===void 0?Yse:r>>>0,r?(e=za(e),e&&(typeof t=="string"||t!=null&&!ok(t))&&(t=Uh(t),!t&&Ob(e))?g0(Vd(e),0,r):e.split(t,r)):[]}var Zse="Expected a function",qse=Math.max;function Kse(e,t){if(typeof e!="function")throw new TypeError(Zse);return t=t==null?0:qse(Ui(t),0),Ki(function(r){var n=r[t],i=g0(r,0,t);return n&&v0(i,n),$h(e,this,i)})}var Qse=Pb(function(e,t,r){return e+(r?" ":"")+BN(t)}),Jse=Qse;function tle(e,t,r){return e=za(e),r=r==null?0:L_(Ui(r),0,e.length),t=Uh(t),e.slice(r,r+t.length)==t}function ele(){return{}}function rle(){return""}function wat(){return!0}var nle=GI(function(e,t){return e-t},0),ile=nle;function ale(e){return e&&e.length?ck(e,Hu):0}function Cat(e,t){return e&&e.length?ck(e,Mi(t)):0}function ole(e){var t=e==null?0:e.length;return t?Yf(e,1,t):[]}function sle(e,t,r){return e&&e.length?(t=r||t===void 0?1:Ui(t),Yf(e,0,t<0?0:t)):[]}function lle(e,t,r){var n=e==null?0:e.length;return n?(t=r||t===void 0?1:Ui(t),t=n-t,Yf(e,t<0?0:t,n)):[]}function ule(e,t){return e&&e.length?n3(e,Mi(t),!1,!0):[]}function cle(e,t){return e&&e.length?n3(e,Mi(t)):[]}function hle(e,t){return t(e),e}var Sat=Object.prototype,fle=Sat.hasOwnProperty;function ZW(e,t,r,n){return e===void 0||Kd(e,Sat[r])&&!fle.call(n,r)?t:e}var dle={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};function ple(e){return"\\"+dle[e]}var vle=/<%=([\s\S]+?)%>/g,Tat=vle,gle=/<%-([\s\S]+?)%>/g,mle=gle,yle=/<%([\s\S]+?)%>/g,_le=yle,xle={escape:mle,evaluate:_le,interpolate:Tat,variable:"",imports:{_:{escape:ek}}},pB=xle,ble="Invalid `variable` option passed into `_.template`",Ele=/\b__p \+= '';/g,wle=/\b(__p \+=) '' \+/g,Cle=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Sle=/[()=,{}\[\]\/\s]/,Tle=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,YT=/($^)/,Ale=/['\n\r\u2028\u2029\\]/g,Mle=Object.prototype,qW=Mle.hasOwnProperty;function Rle(e,t,r){var n=pB.imports._.templateSettings||pB;r&&uc(e,t,r)&&(t=void 0),e=za(e),t=dR({},t,n,ZW);var i=dR({},t.imports,n.imports,ZW),a=xs(i),o=nk(i,a),s,l,u=0,c=t.interpolate||YT,f="__p += '",d=RegExp((t.escape||YT).source+"|"+c.source+"|"+(c===Tat?Tle:YT).source+"|"+(t.evaluate||YT).source+"|$","g"),v=qW.call(t,"sourceURL")?"//# sourceURL="+(t.sourceURL+"").replace(/\s/g," ")+`
`:"";e.replace(d,function(w,S,A,M,R,O){return A||(A=M),f+=e.slice(u,O).replace(Ale,ple),S&&(s=!0,f+=`' +
__e(`+S+`) +
'`),R&&(l=!0,f+=`';
`+R+`;
__p += '`),A&&(f+=`' +
((__t = (`+A+`)) == null ? '' : __t) +
'`),u=O+w.length,w}),f+=`';
`;var g=qW.call(t,"variable")&&t.variable;if(!g)f=`with (obj) {
`+f+`
}
`;else if(Sle.test(g))throw new Error(ble);f=(l?f.replace(Ele,""):f).replace(wle,"$1").replace(Cle,"$1;"),f="function("+(g||"obj")+`) {
`+(g?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(s?", __e = _.escape":"")+(l?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+f+`return __p
}`;var x=Ant(function(){return Function(a,v+"return "+f).apply(void 0,o)});if(x.source=f,PN(x))throw x;return x}var Ile="Expected a function";function Ek(e,t,r){var n=!0,i=!0;if(typeof e!="function")throw new TypeError(Ile);return Ja(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),NC(e,t,{leading:n,maxWait:t,trailing:i})}function HS(e,t){return t(e)}var Lle=9007199254740991,rP=4294967295,Ole=Math.min;function Ple(e,t){if(e=Ui(e),e<1||e>Lle)return[];var r=rP,n=Ole(e,rP);t=iv(t),e-=rP;for(var i=MN(n,t);++r<e;)t(r);return i}function Dle(){return this}function Aat(e,t){var r=e;return r instanceof ua&&(r=r.value()),NN(t,function(n,i){return i.func.apply(i.thisArg,v0([n],i.args))},r)}function nP(){return Aat(this.__wrapped__,this.__actions__)}function Fle(e){return za(e).toLowerCase()}function Ble(e){return Wn(e)?es(e,rv):zh(e)?[e]:Zc(Cnt(za(e)))}var KW=9007199254740991;function Nle(e){return e?L_(Ui(e),-KW,KW):e===0?e:0}function zC(e){return za(e).toUpperCase()}function kle(e,t,r){var n=Wn(e),i=n||e0(e)||Lb(e);if(t=Mi(t),r==null){var a=e&&e.constructor;i?r=n?new a:[]:Ja(e)?r=hu(a)?Ab(JI(e)):{}:r={}}return(i?td:nv)(e,function(o,s,l){return t(r,o,s,l)}),r}function Mat(e,t){for(var r=e.length;r--&&Mb(t,e[r],0)>-1;);return r}function Rat(e,t){for(var r=-1,n=e.length;++r<n&&Mb(t,e[r],0)>-1;);return r}function zle(e,t,r){if(e=za(e),e&&(r||t===void 0))return ant(e);if(!e||!(t=Uh(t)))return e;var n=Vd(e),i=Vd(t),a=Rat(n,i),o=Mat(n,i)+1;return g0(n,a,o).join("")}function Ule(e,t,r){if(e=za(e),e&&(r||t===void 0))return e.slice(0,int(e)+1);if(!e||!(t=Uh(t)))return e;var n=Vd(e),i=Mat(n,Vd(t))+1;return g0(n,0,i).join("")}var $le=/^\s+/;function Hle(e,t,r){if(e=za(e),e&&(r||t===void 0))return e.replace($le,"");if(!e||!(t=Uh(t)))return e;var n=Vd(e),i=Rat(n,Vd(t));return g0(n,i).join("")}var Vle=30,Gle="...",Wle=/\w*$/;function Xle(e,t){var r=Vle,n=Gle;if(Ja(t)){var i="separator"in t?t.separator:i;r="length"in t?Ui(t.length):r,n="omission"in t?Uh(t.omission):n}e=za(e);var a=e.length;if(Ob(e)){var o=Vd(e);a=o.length}if(r>=a)return e;var s=r-Fb(n);if(s<1)return n;var l=o?g0(o,0,s).join(""):e.slice(0,s);if(i===void 0)return l+n;if(o&&(s+=l.length-s),ok(i)){if(e.slice(s).search(i)){var u,c=l;for(i.global||(i=RegExp(i.source,za(Wle.exec(i))+"g")),i.lastIndex=0;u=i.exec(c);)var f=u.index;l=l.slice(0,f===void 0?s:f)}}else if(e.indexOf(Uh(i),s)!=s){var d=l.lastIndexOf(i);d>-1&&(l=l.slice(0,d))}return l+n}function jle(e){return gnt(e,1)}var Yle={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Zle=kN(Yle),qle=Zle,Iat=/&(?:amp|lt|gt|quot|#39);/g,Kle=RegExp(Iat.source);function Qle(e){return e=za(e),e&&Kle.test(e)?e.replace(Iat,qle):e}var Jle=1/0,tue=yx&&1/t3(new yx([,-0]))[1]==Jle?function(e){return new yx(e)}:XI,eue=tue,rue=200;function r0(e,t,r){var n=-1,i=YI,a=e.length,o=!0,s=[],l=s;if(r)o=!1,i=JN;else if(a>=rue){var u=t?null:eue(e);if(u)return t3(u);o=!1,i=BC,l=new s_}else l=t?[]:s;t:for(;++n<a;){var c=e[n],f=t?t(c):c;if(c=r||c!==0?c:0,o&&f===f){for(var d=l.length;d--;)if(l[d]===f)continue t;t&&l.push(f),s.push(c)}else i(l,f,r)||(l!==s&&l.push(f),s.push(c))}return s}var nue=Ki(function(e){return r0(pu(e,1,Ws,!0))}),iue=nue,aue=Ki(function(e){var t=co(e);return Ws(t)&&(t=void 0),r0(pu(e,1,Ws,!0),Mi(t))}),oue=aue,sue=Ki(function(e){var t=co(e);return t=typeof t=="function"?t:void 0,r0(pu(e,1,Ws,!0),void 0,t)}),lue=sue;function jv(e){return e&&e.length?r0(e):[]}function uue(e,t){return e&&e.length?r0(e,Mi(t)):[]}function cue(e,t){return t=typeof t=="function"?t:void 0,e&&e.length?r0(e,void 0,t):[]}var hue=0;function fue(e){var t=++hue;return za(e)+t}function vB(e,t){return e==null?!0:fk(e,t)}var due=Math.max;function wk(e){if(!(e&&e.length))return[];var t=0;return e=m0(e,function(r){if(Ws(r))return t=due(r.length,t),!0}),MN(t,function(r){return es(e,YN(r))})}function Lat(e,t){if(!(e&&e.length))return[];var r=wk(e);return t==null?r:es(r,function(n){return $h(t,void 0,n)})}function Oat(e,t,r,n){return $S(e,t,r(I_(e,t)),n)}function pue(e,t,r){return e==null?e:Oat(e,t,iv(r))}function vue(e,t,r,n){return n=typeof n=="function"?n:void 0,e==null?e:Oat(e,t,iv(r),n)}var gue=Pb(function(e,t,r){return e+(r?" ":"")+t.toUpperCase()}),mue=gue;function yue(e){return e==null?[]:nk(e,nh(e))}var _ue=Ki(function(e,t){return Ws(e)?NS(e,t):[]}),xue=_ue;function bue(e,t){return fat(iv(t),e)}var Eue=bg(function(e){var t=e.length,r=t?e[0]:0,n=this.__wrapped__,i=function(a){return ON(a,e)};return t>1||this.__actions__.length||!(n instanceof ua)||!gg(r)?this.thru(i):(n=n.slice(r,+r+(t?1:0)),n.__actions__.push({func:HS,args:[i],thisArg:void 0}),new Xf(n,this.__chain__).thru(function(a){return t&&!a.length&&a.push(void 0),a}))}),wue=Eue;function Cue(){return Jnt(this)}function Sue(){var e=this.__wrapped__;if(e instanceof ua){var t=e;return this.__actions__.length&&(t=new ua(this)),t=t.reverse(),t.__actions__.push({func:HS,args:[dB],thisArg:void 0}),new Xf(t,this.__chain__)}return this.thru(dB)}function Ck(e,t,r){var n=e.length;if(n<2)return n?r0(e[0]):[];for(var i=-1,a=Array(n);++i<n;)for(var o=e[i],s=-1;++s<n;)s!=i&&(a[i]=NS(a[i]||o,e[s],t,r));return r0(pu(a,1),t,r)}var Tue=Ki(function(e){return Ck(m0(e,Ws))}),Aue=Tue,Mue=Ki(function(e){var t=co(e);return Ws(t)&&(t=void 0),Ck(m0(e,Ws),Mi(t))}),Rue=Mue,Iue=Ki(function(e){var t=co(e);return t=typeof t=="function"?t:void 0,Ck(m0(e,Ws),void 0,t)}),Lue=Iue,Oue=Ki(wk),p3=Oue;function Pat(e,t,r){for(var n=-1,i=e.length,a=t.length,o={};++n<i;){var s=n<a?t[n]:void 0;r(o,e[n],s)}return o}function Pue(e,t){return Pat(e||[],t||[],OS)}function Due(e,t){return Pat(e||[],t||[],$S)}var Fue=Ki(function(e){var t=e.length,r=t>1?e[t-1]:void 0;return r=typeof r=="function"?(e.pop(),r):void 0,Lat(e,r)}),Bue=Fue,An={chunk:AJt,compact:kd,concat:J1,difference:Ait,differenceBy:Are,differenceWith:Mit,drop:Lre,dropRight:Ore,dropRightWhile:Pre,dropWhile:Dre,fill:Jre,findIndex:Jx,findLastIndex:Uit,first:u_,flatten:Snt,flattenDeep:Hit,flattenDepth:hne,fromPairs:Mne,head:u_,indexOf:l3,initial:Yne,intersection:Wit,intersectionBy:Qne,intersectionWith:tie,join:qie,last:co,lastIndexOf:iae,nth:Oae,pull:Noe,pullAll:pat,pullAllBy:koe,pullAllWith:zoe,pullAt:Voe,remove:lse,reverse:dB,slice:Rse,sortedIndex:Use,sortedIndexBy:$se,sortedIndexOf:Hse,sortedLastIndex:Vse,sortedLastIndexBy:Gse,sortedLastIndexOf:Wse,sortedUniq:Xse,sortedUniqBy:jse,tail:ole,take:sle,takeRight:lle,takeRightWhile:ule,takeWhile:cle,union:iue,unionBy:oue,unionWith:lue,uniq:jv,uniqBy:uue,uniqWith:cue,unzip:wk,unzipWith:Lat,without:xue,xor:Aue,xorBy:Rue,xorWith:Lue,zip:p3,zipObject:Pue,zipObjectDeep:Due,zipWith:Bue},ho={countBy:nre,each:xi,eachRight:UW,every:i3,filter:Eg,find:zu,findLast:a3,flatMap:kS,flatMapDeep:lne,flatMapDepth:une,forEach:xi,forEachRight:UW,groupBy:Dne,includes:oc,invokeMap:die,keyBy:tae,map:ia,orderBy:vk,partition:Roe,reduce:h3,reduceRight:ose,reject:sse,sample:_se,sampleSize:Ese,shuffle:Tse,size:tx,some:_at,sortBy:xat},Nue={now:VA},Ps={after:OYt,ary:gnt,before:Mnt,bind:Rnt,bindKey:uQt,curry:qN,curryRight:KN,debounce:NC,defer:bre,delay:wre,flip:dne,memoize:R_,negate:US,once:Uae,overArgs:Zae,partial:fat,partialRight:Aoe,rearg:ise,rest:fse,spread:Kse,throttle:Ek,unary:jle,wrap:bue},qn={castArray:xJt,clone:FS,cloneDeep:iB,cloneDeepWith:uee,cloneWith:hee,conformsTo:Zee,eq:Kd,gt:Bne,gte:kne,isArguments:a_,isArray:Wn,isArrayBuffer:mie,isArrayLike:rh,isArrayLikeObject:Ws,isBoolean:Dp,isBuffer:e0,isDate:Eie,isElement:wie,isEmpty:Or,isEqual:cu,isEqualWith:Mie,isError:PN,isFinite:Iie,isFunction:hu,isInteger:Zit,isLength:qI,isMap:sit,isMatch:Lie,isMatchWith:Oie,isNaN:qit,isNative:Nie,isNil:bl,isNull:Kit,isNumber:nc,isObject:Ja,isObjectLike:Os,isPlainObject:DS,isRegExp:ok,isSafeInteger:$ie,isSet:lit,isString:Db,isSymbol:zh,isTypedArray:Lb,isUndefined:u3,isWeakMap:Vie,isWeakSet:Wie,lt:uae,lte:hae,toArray:eat,toFinite:ag,toInteger:Ui,toLength:Bit,toNumber:Dh,toPlainObject:Cit,toSafeInteger:Nle,toString:za},fc={add:wYt,ceil:CJt,divide:Ire,floor:vne,max:tb,maxBy:uk,mean:mae,meanBy:yae,min:hk,minBy:Cae,multiply:Tae,round:mse,subtract:ile,sum:ale,sumBy:Cat},Sk={clamp:pR,inRange:lB,random:Zoe},Ei={assign:wnt,assignIn:mW,assignInWith:dR,assignWith:sKt,at:WKt,create:ire,defaults:pre,defaultsDeep:yre,entries:$W,entriesIn:HW,extend:mW,extendWith:dR,findKey:rne,findLastKey:one,forIn:Git,forInRight:Sne,forOwn:Tne,forOwnRight:Ane,functions:Rne,functionsIn:Ine,get:ii,has:sB,hasIn:l_,invert:aie,invertBy:uie,invoke:hie,keys:xs,keysIn:nh,mapKeys:Qit,mapValues:fae,merge:gR,mergeWith:QN,omit:dk,omitBy:zae,pick:dat,pickBy:pk,result:dse,set:kC,setWith:wse,toPairs:$W,toPairsIn:HW,transform:kle,unset:vB,update:pue,updateWith:vue,values:wg,valuesIn:yue},av={at:wue,chain:Jnt,commit:fee,lodash:gt,next:Lae,plant:Ooe,reverse:Sue,tap:hle,thru:HS,toIterator:Dle,toJSON:nP,value:nP,valueOf:nP,wrapperChain:Cue},$a={camelCase:_Jt,capitalize:Nnt,deburr:knt,endsWith:Lit,escape:ek,escapeRegExp:Zre,kebabCase:Qie,lowerCase:sk,lowerFirst:sae,pad:_oe,padEnd:xoe,padStart:boe,parseInt:Coe,repeat:use,replace:cse,snakeCase:Lse,split:Eat,startCase:Jse,startsWith:tle,template:Rle,templateSettings:pB,toLower:Fle,toUpper:zC,trim:zle,trimEnd:Ule,trimStart:Hle,truncate:Xle,unescape:Qle,upperCase:mue,upperFirst:BN,words:Qnt},Xa={attempt:Ant,bindAll:aQt,cond:_it,conforms:Yee,constant:mx,defaultTo:hre,flow:Ene,flowRight:Cne,identity:Hu,iteratee:jie,matches:uB,matchesProperty:vae,method:bae,methodOf:wae,mixin:tat,noop:XI,nthArg:Pae,over:Gae,overEvery:Kae,overSome:Jae,property:yit,propertyOf:Poe,range:_x,rangeRight:ese,stubArray:UN,stubFalse:RN,stubObject:ele,stubString:rle,stubTrue:wat,times:Ple,toPath:Ble,uniqueId:fue};function kue(){var e=new ua(this.__wrapped__);return e.__actions__=Zc(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Zc(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Zc(this.__views__),e}function zue(){if(this.__filtered__){var e=new ua(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}var Uue=Math.max,$ue=Math.min;function Hue(e,t,r){for(var n=-1,i=r.length;++n<i;){var a=r[n],o=a.size;switch(a.type){case"drop":e+=o;break;case"dropRight":t-=o;break;case"take":t=$ue(t,e+o);break;case"takeRight":e=Uue(e,t-o);break}}return{start:e,end:t}}var Vue=1,Gue=2,Wue=Math.min;function Xue(){var e=this.__wrapped__.value(),t=this.__dir__,r=Wn(e),n=t<0,i=r?e.length:0,a=Hue(0,i,this.__views__),o=a.start,s=a.end,l=s-o,u=n?s:o-1,c=this.__iteratees__,f=c.length,d=0,v=Wue(l,this.__takeCount__);if(!r||!n&&i==l&&v==l)return Aat(e,this.__actions__);var g=[];t:for(;l--&&d<v;){u+=t;for(var x=-1,w=e[u];++x<f;){var S=c[x],A=S.iteratee,M=S.type,R=A(w);if(M==Gue)w=R;else if(!R){if(M==Vue)continue t;break t}}g[d++]=w}return g}/**
 * @license
 * Lodash (Custom Build) <https://lodash.com/>
 * Build: `lodash modularize exports="es" -o ./`
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var jue="4.17.21",Yue=2,Zue=1,que=3,Dat=4294967295,Kue=Array.prototype,Que=Object.prototype,Fat=Que.hasOwnProperty,QW=ku?ku.iterator:void 0,Jue=Math.max,JW=Math.min,Tk=function(e){return function(t,r,n){if(n==null){var i=Ja(r),a=i&&xs(r),o=a&&a.length&&o3(r,a);(o?o.length:i)||(n=r,r=t,t=this)}return e(t,r,n)}}(tat);gt.after=Ps.after;gt.ary=Ps.ary;gt.assign=Ei.assign;gt.assignIn=Ei.assignIn;gt.assignInWith=Ei.assignInWith;gt.assignWith=Ei.assignWith;gt.at=Ei.at;gt.before=Ps.before;gt.bind=Ps.bind;gt.bindAll=Xa.bindAll;gt.bindKey=Ps.bindKey;gt.castArray=qn.castArray;gt.chain=av.chain;gt.chunk=An.chunk;gt.compact=An.compact;gt.concat=An.concat;gt.cond=Xa.cond;gt.conforms=Xa.conforms;gt.constant=Xa.constant;gt.countBy=ho.countBy;gt.create=Ei.create;gt.curry=Ps.curry;gt.curryRight=Ps.curryRight;gt.debounce=Ps.debounce;gt.defaults=Ei.defaults;gt.defaultsDeep=Ei.defaultsDeep;gt.defer=Ps.defer;gt.delay=Ps.delay;gt.difference=An.difference;gt.differenceBy=An.differenceBy;gt.differenceWith=An.differenceWith;gt.drop=An.drop;gt.dropRight=An.dropRight;gt.dropRightWhile=An.dropRightWhile;gt.dropWhile=An.dropWhile;gt.fill=An.fill;gt.filter=ho.filter;gt.flatMap=ho.flatMap;gt.flatMapDeep=ho.flatMapDeep;gt.flatMapDepth=ho.flatMapDepth;gt.flatten=An.flatten;gt.flattenDeep=An.flattenDeep;gt.flattenDepth=An.flattenDepth;gt.flip=Ps.flip;gt.flow=Xa.flow;gt.flowRight=Xa.flowRight;gt.fromPairs=An.fromPairs;gt.functions=Ei.functions;gt.functionsIn=Ei.functionsIn;gt.groupBy=ho.groupBy;gt.initial=An.initial;gt.intersection=An.intersection;gt.intersectionBy=An.intersectionBy;gt.intersectionWith=An.intersectionWith;gt.invert=Ei.invert;gt.invertBy=Ei.invertBy;gt.invokeMap=ho.invokeMap;gt.iteratee=Xa.iteratee;gt.keyBy=ho.keyBy;gt.keys=xs;gt.keysIn=Ei.keysIn;gt.map=ho.map;gt.mapKeys=Ei.mapKeys;gt.mapValues=Ei.mapValues;gt.matches=Xa.matches;gt.matchesProperty=Xa.matchesProperty;gt.memoize=Ps.memoize;gt.merge=Ei.merge;gt.mergeWith=Ei.mergeWith;gt.method=Xa.method;gt.methodOf=Xa.methodOf;gt.mixin=Tk;gt.negate=US;gt.nthArg=Xa.nthArg;gt.omit=Ei.omit;gt.omitBy=Ei.omitBy;gt.once=Ps.once;gt.orderBy=ho.orderBy;gt.over=Xa.over;gt.overArgs=Ps.overArgs;gt.overEvery=Xa.overEvery;gt.overSome=Xa.overSome;gt.partial=Ps.partial;gt.partialRight=Ps.partialRight;gt.partition=ho.partition;gt.pick=Ei.pick;gt.pickBy=Ei.pickBy;gt.property=Xa.property;gt.propertyOf=Xa.propertyOf;gt.pull=An.pull;gt.pullAll=An.pullAll;gt.pullAllBy=An.pullAllBy;gt.pullAllWith=An.pullAllWith;gt.pullAt=An.pullAt;gt.range=Xa.range;gt.rangeRight=Xa.rangeRight;gt.rearg=Ps.rearg;gt.reject=ho.reject;gt.remove=An.remove;gt.rest=Ps.rest;gt.reverse=An.reverse;gt.sampleSize=ho.sampleSize;gt.set=Ei.set;gt.setWith=Ei.setWith;gt.shuffle=ho.shuffle;gt.slice=An.slice;gt.sortBy=ho.sortBy;gt.sortedUniq=An.sortedUniq;gt.sortedUniqBy=An.sortedUniqBy;gt.split=$a.split;gt.spread=Ps.spread;gt.tail=An.tail;gt.take=An.take;gt.takeRight=An.takeRight;gt.takeRightWhile=An.takeRightWhile;gt.takeWhile=An.takeWhile;gt.tap=av.tap;gt.throttle=Ps.throttle;gt.thru=HS;gt.toArray=qn.toArray;gt.toPairs=Ei.toPairs;gt.toPairsIn=Ei.toPairsIn;gt.toPath=Xa.toPath;gt.toPlainObject=qn.toPlainObject;gt.transform=Ei.transform;gt.unary=Ps.unary;gt.union=An.union;gt.unionBy=An.unionBy;gt.unionWith=An.unionWith;gt.uniq=An.uniq;gt.uniqBy=An.uniqBy;gt.uniqWith=An.uniqWith;gt.unset=Ei.unset;gt.unzip=An.unzip;gt.unzipWith=An.unzipWith;gt.update=Ei.update;gt.updateWith=Ei.updateWith;gt.values=Ei.values;gt.valuesIn=Ei.valuesIn;gt.without=An.without;gt.words=$a.words;gt.wrap=Ps.wrap;gt.xor=An.xor;gt.xorBy=An.xorBy;gt.xorWith=An.xorWith;gt.zip=An.zip;gt.zipObject=An.zipObject;gt.zipObjectDeep=An.zipObjectDeep;gt.zipWith=An.zipWith;gt.entries=Ei.toPairs;gt.entriesIn=Ei.toPairsIn;gt.extend=Ei.assignIn;gt.extendWith=Ei.assignInWith;Tk(gt,gt);gt.add=fc.add;gt.attempt=Xa.attempt;gt.camelCase=$a.camelCase;gt.capitalize=$a.capitalize;gt.ceil=fc.ceil;gt.clamp=Sk.clamp;gt.clone=qn.clone;gt.cloneDeep=qn.cloneDeep;gt.cloneDeepWith=qn.cloneDeepWith;gt.cloneWith=qn.cloneWith;gt.conformsTo=qn.conformsTo;gt.deburr=$a.deburr;gt.defaultTo=Xa.defaultTo;gt.divide=fc.divide;gt.endsWith=$a.endsWith;gt.eq=qn.eq;gt.escape=$a.escape;gt.escapeRegExp=$a.escapeRegExp;gt.every=ho.every;gt.find=ho.find;gt.findIndex=An.findIndex;gt.findKey=Ei.findKey;gt.findLast=ho.findLast;gt.findLastIndex=An.findLastIndex;gt.findLastKey=Ei.findLastKey;gt.floor=fc.floor;gt.forEach=ho.forEach;gt.forEachRight=ho.forEachRight;gt.forIn=Ei.forIn;gt.forInRight=Ei.forInRight;gt.forOwn=Ei.forOwn;gt.forOwnRight=Ei.forOwnRight;gt.get=Ei.get;gt.gt=qn.gt;gt.gte=qn.gte;gt.has=Ei.has;gt.hasIn=Ei.hasIn;gt.head=An.head;gt.identity=Hu;gt.includes=ho.includes;gt.indexOf=An.indexOf;gt.inRange=Sk.inRange;gt.invoke=Ei.invoke;gt.isArguments=qn.isArguments;gt.isArray=Wn;gt.isArrayBuffer=qn.isArrayBuffer;gt.isArrayLike=qn.isArrayLike;gt.isArrayLikeObject=qn.isArrayLikeObject;gt.isBoolean=qn.isBoolean;gt.isBuffer=qn.isBuffer;gt.isDate=qn.isDate;gt.isElement=qn.isElement;gt.isEmpty=qn.isEmpty;gt.isEqual=qn.isEqual;gt.isEqualWith=qn.isEqualWith;gt.isError=qn.isError;gt.isFinite=qn.isFinite;gt.isFunction=qn.isFunction;gt.isInteger=qn.isInteger;gt.isLength=qn.isLength;gt.isMap=qn.isMap;gt.isMatch=qn.isMatch;gt.isMatchWith=qn.isMatchWith;gt.isNaN=qn.isNaN;gt.isNative=qn.isNative;gt.isNil=qn.isNil;gt.isNull=qn.isNull;gt.isNumber=qn.isNumber;gt.isObject=Ja;gt.isObjectLike=qn.isObjectLike;gt.isPlainObject=qn.isPlainObject;gt.isRegExp=qn.isRegExp;gt.isSafeInteger=qn.isSafeInteger;gt.isSet=qn.isSet;gt.isString=qn.isString;gt.isSymbol=qn.isSymbol;gt.isTypedArray=qn.isTypedArray;gt.isUndefined=qn.isUndefined;gt.isWeakMap=qn.isWeakMap;gt.isWeakSet=qn.isWeakSet;gt.join=An.join;gt.kebabCase=$a.kebabCase;gt.last=co;gt.lastIndexOf=An.lastIndexOf;gt.lowerCase=$a.lowerCase;gt.lowerFirst=$a.lowerFirst;gt.lt=qn.lt;gt.lte=qn.lte;gt.max=fc.max;gt.maxBy=fc.maxBy;gt.mean=fc.mean;gt.meanBy=fc.meanBy;gt.min=fc.min;gt.minBy=fc.minBy;gt.stubArray=Xa.stubArray;gt.stubFalse=Xa.stubFalse;gt.stubObject=Xa.stubObject;gt.stubString=Xa.stubString;gt.stubTrue=Xa.stubTrue;gt.multiply=fc.multiply;gt.nth=An.nth;gt.noop=Xa.noop;gt.now=Nue.now;gt.pad=$a.pad;gt.padEnd=$a.padEnd;gt.padStart=$a.padStart;gt.parseInt=$a.parseInt;gt.random=Sk.random;gt.reduce=ho.reduce;gt.reduceRight=ho.reduceRight;gt.repeat=$a.repeat;gt.replace=$a.replace;gt.result=Ei.result;gt.round=fc.round;gt.sample=ho.sample;gt.size=ho.size;gt.snakeCase=$a.snakeCase;gt.some=ho.some;gt.sortedIndex=An.sortedIndex;gt.sortedIndexBy=An.sortedIndexBy;gt.sortedIndexOf=An.sortedIndexOf;gt.sortedLastIndex=An.sortedLastIndex;gt.sortedLastIndexBy=An.sortedLastIndexBy;gt.sortedLastIndexOf=An.sortedLastIndexOf;gt.startCase=$a.startCase;gt.startsWith=$a.startsWith;gt.subtract=fc.subtract;gt.sum=fc.sum;gt.sumBy=fc.sumBy;gt.template=$a.template;gt.times=Xa.times;gt.toFinite=qn.toFinite;gt.toInteger=Ui;gt.toLength=qn.toLength;gt.toLower=$a.toLower;gt.toNumber=qn.toNumber;gt.toSafeInteger=qn.toSafeInteger;gt.toString=qn.toString;gt.toUpper=$a.toUpper;gt.trim=$a.trim;gt.trimEnd=$a.trimEnd;gt.trimStart=$a.trimStart;gt.truncate=$a.truncate;gt.unescape=$a.unescape;gt.uniqueId=Xa.uniqueId;gt.upperCase=$a.upperCase;gt.upperFirst=$a.upperFirst;gt.each=ho.forEach;gt.eachRight=ho.forEachRight;gt.first=An.head;Tk(gt,function(){var e={};return nv(gt,function(t,r){Fat.call(gt.prototype,r)||(e[r]=t)}),e}(),{chain:!1});gt.VERSION=jue;(gt.templateSettings=$a.templateSettings).imports._=gt;td(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){gt[e].placeholder=gt});td(["drop","take"],function(e,t){ua.prototype[e]=function(r){r=r===void 0?1:Jue(Ui(r),0);var n=this.__filtered__&&!t?new ua(this):this.clone();return n.__filtered__?n.__takeCount__=JW(r,n.__takeCount__):n.__views__.push({size:JW(r,Dat),type:e+(n.__dir__<0?"Right":"")}),n},ua.prototype[e+"Right"]=function(r){return this.reverse()[e](r).reverse()}});td(["filter","map","takeWhile"],function(e,t){var r=t+1,n=r==Zue||r==que;ua.prototype[e]=function(i){var a=this.clone();return a.__iteratees__.push({iteratee:Mi(i),type:r}),a.__filtered__=a.__filtered__||n,a}});td(["head","last"],function(e,t){var r="take"+(t?"Right":"");ua.prototype[e]=function(){return this[r](1).value()[0]}});td(["initial","tail"],function(e,t){var r="drop"+(t?"":"Right");ua.prototype[e]=function(){return this.__filtered__?new ua(this):this[r](1)}});ua.prototype.compact=function(){return this.filter(Hu)};ua.prototype.find=function(e){return this.filter(e).head()};ua.prototype.findLast=function(e){return this.reverse().find(e)};ua.prototype.invokeMap=Ki(function(e,t){return typeof e=="function"?new ua(this):this.map(function(r){return zS(r,e,t)})});ua.prototype.reject=function(e){return this.filter(US(Mi(e)))};ua.prototype.slice=function(e,t){e=Ui(e);var r=this;return r.__filtered__&&(e>0||t<0)?new ua(r):(e<0?r=r.takeRight(-e):e&&(r=r.drop(e)),t!==void 0&&(t=Ui(t),r=t<0?r.dropRight(-t):r.take(t-e)),r)};ua.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()};ua.prototype.toArray=function(){return this.take(Dat)};nv(ua.prototype,function(e,t){var r=/^(?:filter|find|map|reject)|While$/.test(t),n=/^(?:head|last)$/.test(t),i=gt[n?"take"+(t=="last"?"Right":""):t],a=n||/^find/.test(t);i&&(gt.prototype[t]=function(){var o=this.__wrapped__,s=n?[1]:arguments,l=o instanceof ua,u=s[0],c=l||Wn(o),f=function(S){var A=i.apply(gt,v0([S],s));return n&&d?A[0]:A};c&&r&&typeof u=="function"&&u.length!=1&&(l=c=!1);var d=this.__chain__,v=!!this.__actions__.length,g=a&&!d,x=l&&!v;if(!a&&c){o=x?o:new ua(this);var w=e.apply(o,s);return w.__actions__.push({func:HS,args:[f],thisArg:void 0}),new Xf(w,d)}return g&&x?e.apply(this,s):(w=this.thru(f),g?n?w.value()[0]:w.value():w)})});td(["pop","push","shift","sort","splice","unshift"],function(e){var t=Kue[e],r=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",n=/^(?:pop|shift)$/.test(e);gt.prototype[e]=function(){var i=arguments;if(n&&!this.__chain__){var a=this.value();return t.apply(Wn(a)?a:[],i)}return this[r](function(o){return t.apply(Wn(o)?o:[],i)})}});nv(ua.prototype,function(e,t){var r=gt[t];if(r){var n=r.name+"";Fat.call(gx,n)||(gx[n]=[]),gx[n].push({name:t,func:r})}});gx[ZI(void 0,Yue).name]=[{name:"wrapper",func:void 0}];ua.prototype.clone=kue;ua.prototype.reverse=zue;ua.prototype.value=Xue;gt.prototype.at=av.at;gt.prototype.chain=av.wrapperChain;gt.prototype.commit=av.commit;gt.prototype.next=av.next;gt.prototype.plant=av.plant;gt.prototype.reverse=av.reverse;gt.prototype.toJSON=gt.prototype.valueOf=gt.prototype.value=av.value;gt.prototype.first=gt.prototype.head;QW&&(gt.prototype[QW]=av.toIterator);function yR(e){"@babel/helpers - typeof";return yR=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yR(e)}var tce=/^\s+/,ece=/\s+$/;function Fn(e,t){if(e=e||"",t=t||{},e instanceof Fn)return e;if(!(this instanceof Fn))return new Fn(e,t);var r=rce(e);this._originalInput=e,this._r=r.r,this._g=r.g,this._b=r.b,this._a=r.a,this._roundA=Math.round(100*this._a)/100,this._format=t.format||r.format,this._gradientType=t.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=r.ok}Fn.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var t=this.toRgb();return(t.r*299+t.g*587+t.b*114)/1e3},getLuminance:function(){var t=this.toRgb(),r,n,i,a,o,s;return r=t.r/255,n=t.g/255,i=t.b/255,r<=.03928?a=r/12.92:a=Math.pow((r+.055)/1.055,2.4),n<=.03928?o=n/12.92:o=Math.pow((n+.055)/1.055,2.4),i<=.03928?s=i/12.92:s=Math.pow((i+.055)/1.055,2.4),.2126*a+.7152*o+.0722*s},setAlpha:function(t){return this._a=Bat(t),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var t=eX(this._r,this._g,this._b);return{h:t.h*360,s:t.s,v:t.v,a:this._a}},toHsvString:function(){var t=eX(this._r,this._g,this._b),r=Math.round(t.h*360),n=Math.round(t.s*100),i=Math.round(t.v*100);return this._a==1?"hsv("+r+", "+n+"%, "+i+"%)":"hsva("+r+", "+n+"%, "+i+"%, "+this._roundA+")"},toHsl:function(){var t=tX(this._r,this._g,this._b);return{h:t.h*360,s:t.s,l:t.l,a:this._a}},toHslString:function(){var t=tX(this._r,this._g,this._b),r=Math.round(t.h*360),n=Math.round(t.s*100),i=Math.round(t.l*100);return this._a==1?"hsl("+r+", "+n+"%, "+i+"%)":"hsla("+r+", "+n+"%, "+i+"%, "+this._roundA+")"},toHex:function(t){return rX(this._r,this._g,this._b,t)},toHexString:function(t){return"#"+this.toHex(t)},toHex8:function(t){return oce(this._r,this._g,this._b,this._a,t)},toHex8String:function(t){return"#"+this.toHex8(t)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(Jo(this._r,255)*100)+"%",g:Math.round(Jo(this._g,255)*100)+"%",b:Math.round(Jo(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(Jo(this._r,255)*100)+"%, "+Math.round(Jo(this._g,255)*100)+"%, "+Math.round(Jo(this._b,255)*100)+"%)":"rgba("+Math.round(Jo(this._r,255)*100)+"%, "+Math.round(Jo(this._g,255)*100)+"%, "+Math.round(Jo(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:yce[rX(this._r,this._g,this._b,!0)]||!1},toFilter:function(t){var r="#"+nX(this._r,this._g,this._b,this._a),n=r,i=this._gradientType?"GradientType = 1, ":"";if(t){var a=Fn(t);n="#"+nX(a._r,a._g,a._b,a._a)}return"progid:DXImageTransform.Microsoft.gradient("+i+"startColorstr="+r+",endColorstr="+n+")"},toString:function(t){var r=!!t;t=t||this._format;var n=!1,i=this._a<1&&this._a>=0,a=!r&&i&&(t==="hex"||t==="hex6"||t==="hex3"||t==="hex4"||t==="hex8"||t==="name");return a?t==="name"&&this._a===0?this.toName():this.toRgbString():(t==="rgb"&&(n=this.toRgbString()),t==="prgb"&&(n=this.toPercentageRgbString()),(t==="hex"||t==="hex6")&&(n=this.toHexString()),t==="hex3"&&(n=this.toHexString(!0)),t==="hex4"&&(n=this.toHex8String(!0)),t==="hex8"&&(n=this.toHex8String()),t==="name"&&(n=this.toName()),t==="hsl"&&(n=this.toHslString()),t==="hsv"&&(n=this.toHsvString()),n||this.toHexString())},clone:function(){return Fn(this.toString())},_applyModification:function(t,r){var n=t.apply(null,[this].concat([].slice.call(r)));return this._r=n._r,this._g=n._g,this._b=n._b,this.setAlpha(n._a),this},lighten:function(){return this._applyModification(cce,arguments)},brighten:function(){return this._applyModification(hce,arguments)},darken:function(){return this._applyModification(fce,arguments)},desaturate:function(){return this._applyModification(sce,arguments)},saturate:function(){return this._applyModification(lce,arguments)},greyscale:function(){return this._applyModification(uce,arguments)},spin:function(){return this._applyModification(dce,arguments)},_applyCombination:function(t,r){return t.apply(null,[this].concat([].slice.call(r)))},analogous:function(){return this._applyCombination(gce,arguments)},complement:function(){return this._applyCombination(pce,arguments)},monochromatic:function(){return this._applyCombination(mce,arguments)},splitcomplement:function(){return this._applyCombination(vce,arguments)},triad:function(){return this._applyCombination(iX,[3])},tetrad:function(){return this._applyCombination(iX,[4])}};Fn.fromRatio=function(e,t){if(yR(e)=="object"){var r={};for(var n in e)e.hasOwnProperty(n)&&(n==="a"?r[n]=e[n]:r[n]=Sw(e[n]));e=r}return Fn(e,t)};function rce(e){var t={r:0,g:0,b:0},r=1,n=null,i=null,a=null,o=!1,s=!1;return typeof e=="string"&&(e=Ece(e)),yR(e)=="object"&&($v(e.r)&&$v(e.g)&&$v(e.b)?(t=nce(e.r,e.g,e.b),o=!0,s=String(e.r).substr(-1)==="%"?"prgb":"rgb"):$v(e.h)&&$v(e.s)&&$v(e.v)?(n=Sw(e.s),i=Sw(e.v),t=ace(e.h,n,i),o=!0,s="hsv"):$v(e.h)&&$v(e.s)&&$v(e.l)&&(n=Sw(e.s),a=Sw(e.l),t=ice(e.h,n,a),o=!0,s="hsl"),e.hasOwnProperty("a")&&(r=e.a)),r=Bat(r),{ok:o,format:e.format||s,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:r}}function nce(e,t,r){return{r:Jo(e,255)*255,g:Jo(t,255)*255,b:Jo(r,255)*255}}function tX(e,t,r){e=Jo(e,255),t=Jo(t,255),r=Jo(r,255);var n=Math.max(e,t,r),i=Math.min(e,t,r),a,o,s=(n+i)/2;if(n==i)a=o=0;else{var l=n-i;switch(o=s>.5?l/(2-n-i):l/(n+i),n){case e:a=(t-r)/l+(t<r?6:0);break;case t:a=(r-e)/l+2;break;case r:a=(e-t)/l+4;break}a/=6}return{h:a,s:o,l:s}}function ice(e,t,r){var n,i,a;e=Jo(e,360),t=Jo(t,100),r=Jo(r,100);function o(u,c,f){return f<0&&(f+=1),f>1&&(f-=1),f<1/6?u+(c-u)*6*f:f<1/2?c:f<2/3?u+(c-u)*(2/3-f)*6:u}if(t===0)n=i=a=r;else{var s=r<.5?r*(1+t):r+t-r*t,l=2*r-s;n=o(l,s,e+1/3),i=o(l,s,e),a=o(l,s,e-1/3)}return{r:n*255,g:i*255,b:a*255}}function eX(e,t,r){e=Jo(e,255),t=Jo(t,255),r=Jo(r,255);var n=Math.max(e,t,r),i=Math.min(e,t,r),a,o,s=n,l=n-i;if(o=n===0?0:l/n,n==i)a=0;else{switch(n){case e:a=(t-r)/l+(t<r?6:0);break;case t:a=(r-e)/l+2;break;case r:a=(e-t)/l+4;break}a/=6}return{h:a,s:o,v:s}}function ace(e,t,r){e=Jo(e,360)*6,t=Jo(t,100),r=Jo(r,100);var n=Math.floor(e),i=e-n,a=r*(1-t),o=r*(1-i*t),s=r*(1-(1-i)*t),l=n%6,u=[r,o,a,a,s,r][l],c=[s,r,r,o,a,a][l],f=[a,a,s,r,r,o][l];return{r:u*255,g:c*255,b:f*255}}function rX(e,t,r,n){var i=[Pd(Math.round(e).toString(16)),Pd(Math.round(t).toString(16)),Pd(Math.round(r).toString(16))];return n&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function oce(e,t,r,n,i){var a=[Pd(Math.round(e).toString(16)),Pd(Math.round(t).toString(16)),Pd(Math.round(r).toString(16)),Pd(Nat(n))];return i&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)&&a[3].charAt(0)==a[3].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0):a.join("")}function nX(e,t,r,n){var i=[Pd(Nat(n)),Pd(Math.round(e).toString(16)),Pd(Math.round(t).toString(16)),Pd(Math.round(r).toString(16))];return i.join("")}Fn.equals=function(e,t){return!e||!t?!1:Fn(e).toRgbString()==Fn(t).toRgbString()};Fn.random=function(){return Fn.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function sce(e,t){t=t===0?0:t||10;var r=Fn(e).toHsl();return r.s-=t/100,r.s=v3(r.s),Fn(r)}function lce(e,t){t=t===0?0:t||10;var r=Fn(e).toHsl();return r.s+=t/100,r.s=v3(r.s),Fn(r)}function uce(e){return Fn(e).desaturate(100)}function cce(e,t){t=t===0?0:t||10;var r=Fn(e).toHsl();return r.l+=t/100,r.l=v3(r.l),Fn(r)}function hce(e,t){t=t===0?0:t||10;var r=Fn(e).toRgb();return r.r=Math.max(0,Math.min(255,r.r-Math.round(255*-(t/100)))),r.g=Math.max(0,Math.min(255,r.g-Math.round(255*-(t/100)))),r.b=Math.max(0,Math.min(255,r.b-Math.round(255*-(t/100)))),Fn(r)}function fce(e,t){t=t===0?0:t||10;var r=Fn(e).toHsl();return r.l-=t/100,r.l=v3(r.l),Fn(r)}function dce(e,t){var r=Fn(e).toHsl(),n=(r.h+t)%360;return r.h=n<0?360+n:n,Fn(r)}function pce(e){var t=Fn(e).toHsl();return t.h=(t.h+180)%360,Fn(t)}function iX(e,t){if(isNaN(t)||t<=0)throw new Error("Argument to polyad must be a positive number");for(var r=Fn(e).toHsl(),n=[Fn(e)],i=360/t,a=1;a<t;a++)n.push(Fn({h:(r.h+a*i)%360,s:r.s,l:r.l}));return n}function vce(e){var t=Fn(e).toHsl(),r=t.h;return[Fn(e),Fn({h:(r+72)%360,s:t.s,l:t.l}),Fn({h:(r+216)%360,s:t.s,l:t.l})]}function gce(e,t,r){t=t||6,r=r||30;var n=Fn(e).toHsl(),i=360/r,a=[Fn(e)];for(n.h=(n.h-(i*t>>1)+720)%360;--t;)n.h=(n.h+i)%360,a.push(Fn(n));return a}function mce(e,t){t=t||6;for(var r=Fn(e).toHsv(),n=r.h,i=r.s,a=r.v,o=[],s=1/t;t--;)o.push(Fn({h:n,s:i,v:a})),a=(a+s)%1;return o}Fn.mix=function(e,t,r){r=r===0?0:r||50;var n=Fn(e).toRgb(),i=Fn(t).toRgb(),a=r/100,o={r:(i.r-n.r)*a+n.r,g:(i.g-n.g)*a+n.g,b:(i.b-n.b)*a+n.b,a:(i.a-n.a)*a+n.a};return Fn(o)};Fn.readability=function(e,t){var r=Fn(e),n=Fn(t);return(Math.max(r.getLuminance(),n.getLuminance())+.05)/(Math.min(r.getLuminance(),n.getLuminance())+.05)};Fn.isReadable=function(e,t,r){var n=Fn.readability(e,t),i,a;switch(a=!1,i=wce(r),i.level+i.size){case"AAsmall":case"AAAlarge":a=n>=4.5;break;case"AAlarge":a=n>=3;break;case"AAAsmall":a=n>=7;break}return a};Fn.mostReadable=function(e,t,r){var n=null,i=0,a,o,s,l;r=r||{},o=r.includeFallbackColors,s=r.level,l=r.size;for(var u=0;u<t.length;u++)a=Fn.readability(e,t[u]),a>i&&(i=a,n=Fn(t[u]));return Fn.isReadable(e,n,{level:s,size:l})||!o?n:(r.includeFallbackColors=!1,Fn.mostReadable(e,["#fff","#000"],r))};var gB=Fn.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},yce=Fn.hexNames=_ce(gB);function _ce(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[e[r]]=r);return t}function Bat(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function Jo(e,t){xce(e)&&(e="100%");var r=bce(e);return e=Math.min(t,Math.max(0,parseFloat(e))),r&&(e=parseInt(e*t,10)/100),Math.abs(e-t)<1e-6?1:e%t/parseFloat(t)}function v3(e){return Math.min(1,Math.max(0,e))}function Ah(e){return parseInt(e,16)}function xce(e){return typeof e=="string"&&e.indexOf(".")!=-1&&parseFloat(e)===1}function bce(e){return typeof e=="string"&&e.indexOf("%")!=-1}function Pd(e){return e.length==1?"0"+e:""+e}function Sw(e){return e<=1&&(e=e*100+"%"),e}function Nat(e){return Math.round(parseFloat(e)*255).toString(16)}function aX(e){return Ah(e)/255}var wd=function(){var e="[-\\+]?\\d+%?",t="[-\\+]?\\d*\\.\\d+%?",r="(?:"+t+")|(?:"+e+")",n="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?",i="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?";return{CSS_UNIT:new RegExp(r),rgb:new RegExp("rgb"+n),rgba:new RegExp("rgba"+i),hsl:new RegExp("hsl"+n),hsla:new RegExp("hsla"+i),hsv:new RegExp("hsv"+n),hsva:new RegExp("hsva"+i),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function $v(e){return!!wd.CSS_UNIT.exec(e)}function Ece(e){e=e.replace(tce,"").replace(ece,"").toLowerCase();var t=!1;if(gB[e])e=gB[e],t=!0;else if(e=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var r;return(r=wd.rgb.exec(e))?{r:r[1],g:r[2],b:r[3]}:(r=wd.rgba.exec(e))?{r:r[1],g:r[2],b:r[3],a:r[4]}:(r=wd.hsl.exec(e))?{h:r[1],s:r[2],l:r[3]}:(r=wd.hsla.exec(e))?{h:r[1],s:r[2],l:r[3],a:r[4]}:(r=wd.hsv.exec(e))?{h:r[1],s:r[2],v:r[3]}:(r=wd.hsva.exec(e))?{h:r[1],s:r[2],v:r[3],a:r[4]}:(r=wd.hex8.exec(e))?{r:Ah(r[1]),g:Ah(r[2]),b:Ah(r[3]),a:aX(r[4]),format:t?"name":"hex8"}:(r=wd.hex6.exec(e))?{r:Ah(r[1]),g:Ah(r[2]),b:Ah(r[3]),format:t?"name":"hex"}:(r=wd.hex4.exec(e))?{r:Ah(r[1]+""+r[1]),g:Ah(r[2]+""+r[2]),b:Ah(r[3]+""+r[3]),a:aX(r[4]+""+r[4]),format:t?"name":"hex8"}:(r=wd.hex3.exec(e))?{r:Ah(r[1]+""+r[1]),g:Ah(r[2]+""+r[2]),b:Ah(r[3]+""+r[3]),format:t?"name":"hex"}:!1}function wce(e){var t,r;return e=e||{level:"AA",size:"small"},t=(e.level||"AA").toUpperCase(),r=(e.size||"small").toLowerCase(),t!=="AA"&&t!=="AAA"&&(t="AA"),r!=="small"&&r!=="large"&&(r="small"),{level:t,size:r}}var Cce="#FFFFFF",Sce="#000000",Tce=[95,85,75,30,15,0,15,30,45,60,80],Ace=15,kat=function(e){return Fn(e).getLuminance()<=.5},Mce=function(e,t){return Fn.isReadable(e,t,{level:"AA",size:"small"})},Rce=[{fontColorIndex:0,bgColorIndex:3},{fontColorIndex:13,bgColorIndex:8},{fontColorIndex:14,bgColorIndex:1}],Ice=function(e){for(var t=[],r=0;r<11;r++){var n=Tce[r];t.push(zC(n===0?e:Fn.mix(e,r<5?Cce:Sce,n).toHexString()))}return t},Ak=function(e){e===void 0&&(e={});var t=Array.from(Array(Ace)).fill(ZF),r=e.basicColorRelations,n=r===void 0?[]:r,i=e.brandColor,a=Ice(i);return n.forEach(function(o){t[o.basicColorIndex]=a[o.standardColorIndex]}),Rce.forEach(function(o){var s=o.fontColorIndex,l=o.bgColorIndex;t[s]=kat(t[l])?ZF:Jrt}),Zt(Zt({},e),{basicColors:t})},Lce={brandColor:"#3471F9",semanticColors:{red:"#FF4D4F",green:"#29A294",yellow:"#FAAD14"},others:{highlight:"#87B5FF",results:"#F0F7FF"},basicColorRelations:[{basicColorIndex:1,standardColorIndex:0},{basicColorIndex:2,standardColorIndex:1},{basicColorIndex:3,standardColorIndex:5},{basicColorIndex:4,standardColorIndex:6},{basicColorIndex:5,standardColorIndex:6},{basicColorIndex:6,standardColorIndex:6},{basicColorIndex:7,standardColorIndex:5},{basicColorIndex:9,standardColorIndex:1},{basicColorIndex:10,standardColorIndex:4},{basicColorIndex:11,standardColorIndex:4},{basicColorIndex:12,standardColorIndex:5}]},Oce=Ak(Lce),Pce={brandColor:"#326EF4",semanticColors:{red:"#FF4D4F",green:"#29A294",yellow:"#FAAD14"},others:{highlight:"#87B5FF",results:"#F0F7FF"},basicColorRelations:[{basicColorIndex:1,standardColorIndex:0},{basicColorIndex:2,standardColorIndex:1},{basicColorIndex:3,standardColorIndex:1},{basicColorIndex:4,standardColorIndex:2},{basicColorIndex:5,standardColorIndex:7},{basicColorIndex:6,standardColorIndex:5},{basicColorIndex:7,standardColorIndex:5},{basicColorIndex:9,standardColorIndex:1},{basicColorIndex:10,standardColorIndex:2},{basicColorIndex:11,standardColorIndex:5},{basicColorIndex:12,standardColorIndex:5}]},Dce=Ak(Pce),Fce={brandColor:"#9DA7B6",semanticColors:{red:"#FF4D4F",green:"#29A294",yellow:"#FAAD14"},others:{highlight:"#87B5FF",results:"#F0F7FF"},basicColorRelations:[{basicColorIndex:1,standardColorIndex:0},{basicColorIndex:2,standardColorIndex:1},{basicColorIndex:3,standardColorIndex:1},{basicColorIndex:4,standardColorIndex:2},{basicColorIndex:5,standardColorIndex:7},{basicColorIndex:6,standardColorIndex:8},{basicColorIndex:7,standardColorIndex:5},{basicColorIndex:9,standardColorIndex:1},{basicColorIndex:10,standardColorIndex:2},{basicColorIndex:11,standardColorIndex:3},{basicColorIndex:12,standardColorIndex:3}]},Bce=Ak(Fce),Nce={default:Dce,colorful:Oce,gray:Bce},bd="Roboto, PingFangSC, BlinkMacSystemFont, Microsoft YaHei, Arial, sans-serif",kce=12,zce={小计:"Total",总计:"Total",总和:"(SUM)",项:"items",已选择:"selected",序号:"Index",度量:"Measure",数值:"Measure",共计:"Total",条:"",隐藏:"Hide",趋势:"Trend",组内升序:"Group ASC",组内降序:"Group DESC",升序:"ASC",降序:"DESC",不排序:"No order","，":", "},Uce={小计:"Промежуточный итог",总计:"Общий итог",总和:"(СУММА)",项:"элемент(-а/-ов)",已选择:"выбрано",序号:"Индекс",度量:"Мера",数值:"Численная величина",共计:"Общее количество",条:"",隐藏:"Скрыть",趋势:"Курс",组内升序:"Группировать по возрастанию",组内降序:"Группировать по убыванию",升序:"По возрастанию",降序:"По убыванию",不排序:"Не отсортировано","，":", "},$ce={小计:"小计",总计:"总计",总和:"（总和）",项:"项",已选择:"已选择",序号:"序号",度量:"度量",数值:"数值",共计:"共计",条:"条",趋势:"趋势",隐藏:"隐藏",组内升序:"组内升序",升序:"升序",降序:"降序",组内降序:"组内降序",不排序:"不排序","，":"，"},Hce="zh_CN",Vce=Hce,Gce={zh_CN:$ce,en_US:zce,ru_RU:Uce},El=function(e,t){return t===void 0&&(t=e),ii(Gce,[Vce,e],t)},Wce="".concat(Qjt,"-tooltip"),Mk="".concat(Wce,"-container"),Xce="".concat(Mk,"-show"),jce="".concat(Mk,"-hide"),oX={x:15,y:10},Yce=function(){return{key:"hiddenColumns",text:El("隐藏"),icon:"EyeOutlined"}},Zce=function(){return{key:"trend",text:El("趋势"),icon:"Trend"}},qce=function(){return[{key:"asc",icon:"groupAsc",text:El("组内升序")},{key:"desc",icon:"groupDesc",text:El("组内降序")},{key:"none",text:El("不排序")}]},Kce=function(){return[{key:"asc",icon:"groupAsc",text:El("升序")},{key:"desc",icon:"groupDesc",text:El("降序")},{key:"none",text:El("不排序")}]},sX;(function(e){e[e.ALL=0]="ALL",e[e.COL=1]="COL",e[e.ROW=2]="ROW"})(sX||(sX={}));var mB=1,Bf;(function(e){e.All="all",e.DetailOnly="detailOnly"})(Bf||(Bf={}));function Bl(e){return e==="mobile"?!0:/(iPhone|iPad|SymbianOS|Windows Phone|iPod|iOS|Android)/i.test(navigator.userAgent)}function Qce(){return/iPhone/gi.test(navigator.userAgent)&&window.screen.height===812&&window.screen.width===375}function zat(){return/windows/i.test(navigator.userAgent)}var Jce=function(e){var t=e||"default";return Nce[t.toLowerCase()]},the=function(e){var t,r,n,i,a,o=(e==null?void 0:e.palette)||Jce(e==null?void 0:e.name),s=o.basicColors,l=o.semanticColors,u=o.others,c=(t=e==null?void 0:e.spreadsheet)===null||t===void 0?void 0:t.isTableMode(),f=zat()?"bold":700,d=function(){var v,g;return{bolderText:{fontFamily:bd,fontSize:12,fontWeight:f,fill:s[13],opacity:1,textAlign:"right",textBaseline:"middle",linkTextFill:s[6]},text:{fontFamily:bd,fontSize:12,fontWeight:"normal",fill:s[13],opacity:1,textAlign:"right",textBaseline:"middle",linkTextFill:s[6]},cell:{crossBackgroundColor:s[1],backgroundColor:s[8],backgroundColorOpacity:1,horizontalBorderColor:s[9],horizontalBorderColorOpacity:1,verticalBorderColor:s[9],verticalBorderColorOpacity:1,horizontalBorderWidth:1,verticalBorderWidth:1,borderDash:[],padding:{top:8,right:8,bottom:8,left:8},interactionState:{hover:{backgroundColor:s[2],backgroundOpacity:.6},hoverFocus:{backgroundColor:s[2],backgroundOpacity:.6,borderColor:s[14],borderWidth:1,borderOpacity:1},selected:{backgroundColor:s[2],backgroundOpacity:.6},unselected:{backgroundOpacity:.3,textOpacity:.3,opacity:.3},searchResult:{backgroundColor:(v=u==null?void 0:u.results)!==null&&v!==void 0?v:s[2],backgroundOpacity:1},highlight:{backgroundColor:(g=u==null?void 0:u.highlight)!==null&&g!==void 0?g:s[6],backgroundOpacity:1},prepareSelect:{borderColor:s[14],borderOpacity:1,borderWidth:1}}},miniChart:{line:{point:{size:2.2,fill:s[6],opacity:1},linkLine:{size:1.5,fill:s[6],opacity:.6}},bar:{intervalPadding:4,fill:s[6],opacity:1},bullet:{progressBar:{widthPercent:.6,height:10,innerHeight:6},comparativeMeasure:{width:1,height:12,fill:s[13],opacity:.25},rangeColors:{good:l==null?void 0:l.green,satisfactory:l.yellow,bad:l.red},backgroundColor:"#E9E9E9"},interval:{height:kce,fill:s[7]}},icon:{fill:s[13],downIconColor:l.red,upIconColor:l.green,size:10,margin:{right:4,left:4}}}};return{cornerCell:{bolderText:{fontFamily:bd,fontSize:12,fontWeight:f,fill:s[0],opacity:1,textAlign:c?"center":"left",textBaseline:"middle"},text:{fontFamily:bd,fontSize:12,fontWeight:f,fill:s[0],opacity:1,textAlign:"right",textBaseline:"middle"},cell:{backgroundColor:s[3],backgroundColorOpacity:1,horizontalBorderColor:s[10],horizontalBorderColorOpacity:1,verticalBorderColor:s[10],verticalBorderColorOpacity:1,horizontalBorderWidth:1,verticalBorderWidth:1,borderDash:[],padding:{top:0,right:8,bottom:0,left:8}},icon:{fill:s[0],size:10,margin:{right:4,left:4}}},rowCell:{seriesText:{fontFamily:bd,fontSize:12,fontWeight:"normal",fill:s[14],linkTextFill:s[6],opacity:1,textBaseline:c?"middle":"top",textAlign:"center"},measureText:{fontFamily:bd,fontSize:12,fontWeight:"normal",fill:s[14],linkTextFill:s[6],opacity:1,textAlign:c?"center":"left",textBaseline:"top"},bolderText:{fontFamily:bd,fontSize:12,fontWeight:f,fill:s[14],linkTextFill:s[6],opacity:1,textAlign:c?"center":"left",textBaseline:"top"},text:{fontFamily:bd,fontSize:12,fontWeight:"normal",fill:s[14],linkTextFill:s[6],opacity:1,textBaseline:"top",textAlign:c?"center":"left"},cell:{backgroundColor:s[1],backgroundColorOpacity:1,horizontalBorderColor:s[9],horizontalBorderColorOpacity:1,verticalBorderColor:s[9],verticalBorderColorOpacity:1,horizontalBorderWidth:1,verticalBorderWidth:1,borderDash:[],padding:{top:0,right:8,bottom:0,left:8},interactionState:{hover:{backgroundColor:s[2],backgroundOpacity:.6},selected:{backgroundColor:s[2],backgroundOpacity:.6},unselected:{backgroundOpacity:.3,textOpacity:.3,opacity:.3},prepareSelect:{borderColor:s[14],borderOpacity:1,borderWidth:1},searchResult:{backgroundColor:(r=u==null?void 0:u.results)!==null&&r!==void 0?r:s[2],backgroundOpacity:1},highlight:{backgroundColor:(n=u==null?void 0:u.highlight)!==null&&n!==void 0?n:s[6],backgroundOpacity:1}}},icon:{fill:s[14],size:10,margin:{right:4,left:4}},seriesNumberWidth:80},colCell:{measureText:{fontFamily:bd,fontSize:12,fontWeight:"normal",fill:s[0],opacity:1,textAlign:"right",textBaseline:"middle"},bolderText:{fontFamily:bd,fontSize:12,fontWeight:f,fill:s[0],opacity:1,textAlign:"center",textBaseline:"middle"},text:{fontFamily:bd,fontSize:12,fontWeight:"normal",fill:s[0],opacity:1,textAlign:"center",textBaseline:"middle"},cell:{backgroundColor:s[3],backgroundColorOpacity:1,horizontalBorderColor:s[10],horizontalBorderColorOpacity:1,verticalBorderColor:s[10],verticalBorderColorOpacity:1,horizontalBorderWidth:1,verticalBorderWidth:1,borderDash:[],padding:{top:0,right:8,bottom:0,left:8},interactionState:{hover:{backgroundColor:s[4],backgroundOpacity:.6},selected:{backgroundColor:s[4],backgroundOpacity:.6},unselected:{backgroundOpacity:.3,textOpacity:.3,opacity:.3},prepareSelect:{borderColor:s[14],borderOpacity:1,borderWidth:1},searchResult:{backgroundColor:(i=u==null?void 0:u.results)!==null&&i!==void 0?i:s[2],backgroundOpacity:1},highlight:{backgroundColor:(a=u==null?void 0:u.highlight)!==null&&a!==void 0?a:s[6],backgroundOpacity:1}}},icon:{fill:s[0],size:10,margin:{top:6,right:4,bottom:6,left:4}}},dataCell:d(),mergedCell:d(),resizeArea:{size:3,background:s[7],backgroundOpacity:0,guideLineColor:s[7],guideLineDisableColor:"rgba(0,0,0,0.25)",guideLineDash:[3,3],interactionState:{hover:{backgroundColor:s[7],backgroundOpacity:1}}},scrollBar:{trackColor:"rgba(0,0,0,0.01)",thumbHoverColor:"rgba(0,0,0,0.25)",thumbColor:"rgba(0,0,0,0.15)",thumbHorizontalMinSize:32,thumbVerticalMinSize:32,size:Bl()?3:6,hoverSize:Bl()?4:8,lineCap:"round"},splitLine:{horizontalBorderColor:s[12],horizontalBorderColorOpacity:.2,horizontalBorderWidth:2,verticalBorderColor:s[11],verticalBorderColorOpacity:.25,verticalBorderWidth:2,showShadow:!0,shadowWidth:8,shadowColors:{left:"rgba(0,0,0,0.1)",right:"rgba(0,0,0,0)"},borderDash:[]},prepareSelectMask:{backgroundColor:s[5],backgroundOpacity:.3},background:{color:s[8],opacity:1}}},su=function(){function e(t){this.x=0,this.y=0,this.width=0,this.height=0,this.colIndex=-1,this.level=0,this.isLeaf=!1,this.children=[],this.padding=0;var r=t.id,n=t.key,i=t.value,a=t.label,o=t.parent,s=t.level,l=t.rowIndex,u=t.isTotals,c=t.isGrandTotals,f=t.isSubTotals,d=t.isCollapsed,v=t.isTotalRoot,g=t.hierarchy,x=t.isPivotMode,w=t.seriesNumberWidth,S=t.field,A=t.spreadsheet,M=t.query,R=t.belongsCell,O=t.inCollapseNode,N=t.isTotalMeasure,k=t.isLeaf,V=t.extra;this.id=r,this.key=n,this.value=i,this.label=a||i,this.parent=o,this.level=s,this.rowIndex=l,this.isTotals=u,this.isCollapsed=d,this.hierarchy=g,this.isPivotMode=x,this.seriesNumberWidth=w,this.field=S,this.spreadsheet=A,this.query=M,this.belongsCell=R,this.inCollapseNode=O,this.isTotalMeasure=N,this.isLeaf=k,this.isGrandTotals=c,this.isSubTotals=f,this.isTotalRoot=v,this.extra=V}return e.getFieldPath=function(t,r){if(t&&!t.isTotals||t&&r){for(var n=t.parent,i=[t.field];n&&n.id!==Krt;)i.push(n.field),n=n.parent;return i.reverse()}},e.getAllLeaveNodes=function(t){var r=[];if(t.isLeaf)return[t];for(var n=Vr([],lr(t.children),!1),i=n.shift();i;)i.isLeaf?r.push(i):n.unshift.apply(n,Vr([],lr(i.children),!1)),i=n.shift();return r},e.getAllChildrenNodes=function(t){var r=[];if(t.isLeaf)return[t];for(var n=Vr([],lr(t.children||[]),!1),i=n.shift();i;)r.push(i),n.unshift.apply(n,Vr([],lr(i.children),!1)),i=n.shift();return r},e.getAllBranch=function(t){for(var r=[],n=this.getAllLeaveNodes(t),i=n.shift(),a=[];i;){a.unshift(i);for(var o=i.parent;o&&!cu(o,t);){a.unshift(o);o=o.parent}r.push(a),i=n.shift(),a=[]}return r},e.blankNode=function(){return new e({id:"",key:"",value:""})},e.rootNode=function(){return new e({id:"root",key:"",value:""})},e.prototype.toJSON=function(){return dk(this,["config","hierarchy","parent","spreadsheet"])},e.prototype.getHeadLeafChild=function(){for(var t=this;!Or(t.children);)t=u_(t.children);return t},e.prototype.getTotalHeightForTreeHierarchy=function(){return this.height===0||Or(this.children)?this.height:this.children.reduce(function(t,r){return t+r.getTotalHeightForTreeHierarchy()},this.height)},e}(),Uat=function(){function e(){this.width=0,this.height=0,this.maxLevel=-1,this.sampleNodesForAllLevels=[],this.sampleNodeForLastLevel=null,this.allNodesWithoutRoot=[],this.indexNode=[]}return e.prototype.getLeaves=function(){return this.allNodesWithoutRoot.filter(function(t){return t.isLeaf})},e.prototype.getNodes=function(t){return t!==void 0?this.allNodesWithoutRoot.filter(function(r){return r.level===t}):this.allNodesWithoutRoot},e.prototype.getNodesLessThanLevel=function(t){return this.allNodesWithoutRoot.filter(function(r){return r.level<=t})},e.prototype.pushNode=function(t,r){r===void 0&&(r=-1),r===-1?this.allNodesWithoutRoot.push(t):this.allNodesWithoutRoot.splice(r,0,t)},e.prototype.pushIndexNode=function(t){this.indexNode.push(t)},e.prototype.getIndexNodes=function(){return this.indexNode},e}(),eb=function(){function e(t){var r=t.label,n=t.isSubTotals,i=t.isGrandTotals,a=t.isTotalRoot;this.label=r,this.isSubTotals=n,this.isGrandTotals=i,this.isTotalRoot=a}return e}(),ehe=function(e){var t,r=e.isFirstField,n=e.currentField,i=e.fieldValues,a=e.spreadsheet,o=e.lastField,s=a.getTotalsConfig(r?n:o),l,u;r?s!=null&&s.showGrandTotals&&(l=s.reverseLayout?"unshift":"push",u=new eb({label:s.label,isSubTotals:!1,isGrandTotals:!0,isTotalRoot:!0})):s!=null&&s.showSubTotals&&(gt.size(i)>1||gt.get(s,"showSubTotals.always")!==!1)&&n!==Pi&&(l=s.reverseSubLayout?"unshift":"push",u=new eb({label:s.subLabel,isSubTotals:!0,isGrandTotals:!1,isTotalRoot:!0})),(t=i[l])===null||t===void 0||t.call(i,u)};function yB(e,t){for(var r={},n=e;n&&n.key;)(!n.isTotalRoot||t)&&n.value!==T_&&(r[n.key]=n.value),n=n.parent;return r}var rhe="Transform Data",nhe="Header Layout",ihe="Data Cell Render",Fp=function(){function e(){var t=this;this.debug=!1,this.debugCallback=function(r,n){if(t.debug){var i=performance.now();n();var a=performance.now();console.log(r,"".concat(a-i," ms"))}else n()},this.logger=function(r){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];t.debug&&console.log.apply(console,Vr([r],lr(n),!1))}}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.setDebug=function(t){this.debug=t},e}(),ahe=`
<svg width="10px" height="10px" viewBox="0 0 10 10" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" font-family="Roboto, PingFangSC, BlinkMacSystemFont, Microsoft YaHei, Arial, sans-serif" font-size="12" font-weight="bold">
    <text id="↓" fill="#29A294">
        <tspan x="-0.225097656" y="8.5">↓</tspan>
    </text>
</g>
</svg>`,ohe=`<svg width="10px" height="10px" viewBox="0 0 10 10" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" font-family="Roboto, PingFangSC, BlinkMacSystemFont, Microsoft YaHei, Arial, sans-serif" font-size="12" font-weight="bold">
    <text id="↑" fill="#FF4D4F">
        <tspan x="-0.225097656" y="8.5">↑</tspan>
    </text>
</g>
</svg>
`,she=`<?xml version="1.0" encoding="UTF-8"?>
<svg width="7px" height="9px" viewBox="0 0 7 9" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <!-- Generator: Sketch 58 (84663) - https://sketch.com -->
    <title>down</title>
    <desc>Created with Sketch.</desc>
    <g id="一期开发" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <polygon id="down" fill="#58AE57" transform="translate(3.500000, 4.500000) scale(1, -1) translate(-3.500000, -4.500000) " points="3.5 0 7 9 0 9"></polygon>
    </g>
</svg>`,lhe=`<?xml version="1.0" encoding="UTF-8"?>
<svg width="7px" height="9px" viewBox="0 0 7 9" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <!-- Generator: Sketch 58 (84663) - https://sketch.com -->
    <title>up</title>
    <desc>Created with Sketch.</desc>
    <g id="一期开发" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <polygon id="up" fill="#F46649" points="3.5 0 7 9 0 9"></polygon>
    </g>
</svg> `,uhe=`<svg t="1557124621626" class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
xmlns="http://www.w3.org/2000/svg" p-id="17452"
xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14">
<defs>
  <style type="text/css"></style>
</defs>
<path d="M182.272 167.04a8 8 0 0 0-12.544 0L57.728 309.056A8 8 0 0 0 64 321.984h76.032v530.048c0 4.352 3.584 7.936 7.936 7.936h56.064a8 8 0 0 0 7.936-7.936V321.92H288a8 8 0 0 0 6.272-12.992l-112-141.888z m209.728 626.944h176c4.416 0 8 3.584 8 8v56a8 8 0 0 1-8 8h-176A8 8 0 0 1 384 857.984v-56c0-4.416 3.584-8 8-8z m0-424h368c4.416 0 8 3.648 8 8v56a8 8 0 0 1-8 8h-368A8 8 0 0 1 384 433.984v-56c0-4.352 3.584-8 8-8z m528-139.968h-528A8 8 0 0 1 384 222.016v-56c0-4.416 3.584-8 8-8h528c4.416 0 8 3.584 8 8v56a8 8 0 0 1-8 8z m-256 424h-272A8 8 0 0 1 384 646.016v-56c0-4.416 3.584-8 8-8h272c4.416 0 8 3.584 8 8v56a8 8 0 0 1-8 8z" p-id="17453"></path>
</svg>`,che=`<svg t="1557124685600" class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" p-id="17561"
  xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14">
  <defs>
    <style type="text/css"></style>
  </defs>
  <path d="M182.272 856.96a8 8 0 0 1-12.544 0l-112-141.952A8 8 0 0 1 64 702.08h76.032V172.032c0-4.416 3.584-8 7.936-8h56.064c4.352 0 7.936 3.584 7.936 8v529.984H288c6.72 0 10.496 7.808 6.272 12.992l-112 141.888z m209.728-626.944h176A8 8 0 0 0 576 222.016v-56a8 8 0 0 0-8-8h-176A8 8 0 0 0 384 166.016v56c0 4.416 3.584 8 8 8z m0 424h368a8 8 0 0 0 8-8v-56a8 8 0 0 0-8-8h-368A8 8 0 0 0 384 590.016v56c0 4.416 3.584 8 8 8z m528 139.968h-528a8 8 0 0 0-8 8v56c0 4.416 3.584 8 8 8h528a8 8 0 0 0 8-8v-56a8 8 0 0 0-8-8z m-256-424h-272A8 8 0 0 0 384 377.984v56c0 4.416 3.584 8 8 8h272a8 8 0 0 0 8-8v-56a8 8 0 0 0-8-8z" p-id="17562"></path>
</svg>`,hhe=`<svg t="1557124695786" class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" p-id="17670"
  xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14">
  <defs>
    <style type="text/css"></style>
  </defs>
  <path d="M182.272 167.04a8 8 0 0 0-12.544 0L57.728 309.056A8 8 0 0 0 64 321.984h76.032v530.048c0 4.352 3.584 7.936 7.936 7.936h56.064a8 8 0 0 0 7.936-7.936V321.92H288a8 8 0 0 0 6.272-12.992l-112-141.888z m209.728 62.976h304A8 8 0 0 0 704 222.016v-56a8 8 0 0 0-8-8h-304A8 8 0 0 0 384 166.016v56c0 4.416 3.584 8 8 8z m0 424h304a8 8 0 0 0 8-8v-56a8 8 0 0 0-8-8h-304A8 8 0 0 0 384 590.016v56c0 4.416 3.584 8 8 8z m528 139.968h-528a8 8 0 0 0-8 8v56c0 4.416 3.584 8 8 8h528a8 8 0 0 0 8-8v-56a8 8 0 0 0-8-8z m0-424h-528A8 8 0 0 0 384 377.984v56c0 4.416 3.584 8 8 8h528a8 8 0 0 0 8-8v-56a8 8 0 0 0-8-8z" p-id="17671"></path>
</svg>`,fhe=`<svg t="1557124710652" class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" p-id="17779"
  xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14">
  <defs>
    <style type="text/css"></style>
  </defs>
  <path d="M182.272 856.96a8 8 0 0 1-12.544 0l-112-141.952A8 8 0 0 1 64 702.08h76.032V172.032c0-4.416 3.584-8 7.936-8h56.064c4.352 0 7.936 3.584 7.936 8v529.984H288c6.72 0 10.496 7.808 6.272 12.992l-112 141.888z m209.728-626.944h304A8 8 0 0 0 704 222.016v-56a8 8 0 0 0-8-8h-304A8 8 0 0 0 384 166.016v56c0 4.416 3.584 8 8 8z m0 424h304a8 8 0 0 0 8-8v-56a8 8 0 0 0-8-8h-304A8 8 0 0 0 384 590.016v56c0 4.416 3.584 8 8 8z m528 139.968h-528a8 8 0 0 0-8 8v56c0 4.416 3.584 8 8 8h528a8 8 0 0 0 8-8v-56a8 8 0 0 0-8-8z m0-424h-528A8 8 0 0 0 384 377.984v56c0 4.416 3.584 8 8 8h528a8 8 0 0 0 8-8v-56a8 8 0 0 0-8-8z" p-id="17780"></path>
</svg>`,dhe=`<svg width="16px" height="16px" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="设计输出" stroke="none" stroke-width="1" fill-opacity="0.25" fill-rule="evenodd">
    <g id="设计输出-移动端指标详情页-阅读端" transform="translate(-3275.000000, -724.000000)" fill-rule="nonzero">
        <g id="编组-39" transform="translate(3064.500000, 667.000000)">
            <g id="编组-36" transform="translate(80.500000, 44.000000)">
                <g id="不排序" transform="translate(130.000000, 13.000000)">
                    <path d="M12.0009375,12.40625 C12.0696875,12.40625 12.1259375,12.4625 12.1259375,12.53125 L12.1259375,12.53125 L12.1259375,13.40625 C12.1259375,13.475 12.0696875,13.53125 12.0009375,13.53125 L12.0009375,13.53125 L6.25093747,13.53125 C6.18218747,13.53125 6.12593747,13.475 6.12593747,13.40625 L6.12593747,13.40625 L6.12593747,12.53125 C6.12593747,12.4625 6.18218747,12.40625 6.25093747,12.40625 L6.25093747,12.40625 Z M2.93949997,2.5801875 L2.97437497,2.6109375 L4.72437497,4.828125 C4.78062497,4.89776786 4.74503823,4.99725765 4.66779698,5.02426203 L4.62593747,5.03125 L3.438,5.03089062 L3.43843747,10.9691406 L4.62593747,10.9691406 C4.73062497,10.9691406 4.78999997,11.0910156 4.72437497,11.1722656 L2.97437497,13.3894531 C2.92437497,13.4535156 2.82749997,13.4535156 2.77749997,13.3894531 L1.02749997,11.1722656 C0.961874969,11.0894531 1.02124997,10.9691406 1.12593747,10.9691406 L2.31343747,10.9691406 L2.313,5.03089062 L1.12593747,5.03125 C1.03620533,5.03125 0.979764,4.94285714 1.00679571,4.8654519 L1.02749997,4.828125 L2.77749997,2.6109375 C2.81749997,2.5596875 2.88749997,2.5494375 2.93949997,2.5801875 Z M10.5009375,9.09375 C10.5696875,9.09375 10.6259375,9.15 10.6259375,9.21875 L10.6259375,9.21875 L10.6259375,10.09375 C10.6259375,10.1625 10.5696875,10.21875 10.5009375,10.21875 L10.5009375,10.21875 L6.25093747,10.21875 C6.18218747,10.21875 6.12593747,10.1625 6.12593747,10.09375 L6.12593747,10.09375 L6.12593747,9.21875 C6.12593747,9.15 6.18218747,9.09375 6.25093747,9.09375 L6.25093747,9.09375 Z M14.5009375,5.78125 C14.5696875,5.78125 14.6259375,5.8375 14.6259375,5.90625 L14.6259375,5.90625 L14.6259375,6.78125 C14.6259375,6.85 14.5696875,6.90625 14.5009375,6.90625 L14.5009375,6.90625 L6.25093747,6.90625 C6.18218747,6.90625 6.12593747,6.85 6.12593747,6.78125 L6.12593747,6.78125 L6.12593747,5.90625 C6.12593747,5.8375 6.18218747,5.78125 6.25093747,5.78125 L6.25093747,5.78125 Z M9.00093747,2.46875 C9.06968747,2.46875 9.12593747,2.525 9.12593747,2.59375 L9.12593747,2.59375 L9.12593747,3.46875 C9.12593747,3.5375 9.06968747,3.59375 9.00093747,3.59375 L9.00093747,3.59375 L6.25093747,3.59375 C6.18218747,3.59375 6.12593747,3.5375 6.12593747,3.46875 L6.12593747,3.46875 L6.12593747,2.59375 C6.12593747,2.525 6.18218747,2.46875 6.25093747,2.46875 L6.25093747,2.46875 Z" id="形状结合"></path>
                </g>
            </g>
        </g>
    </g>q
</g>
</svg>`,phe='<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1590389330617" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="19656" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><defs><style type="text/css"></style></defs><path d="M512 64c-247.4 0-448 200.6-448 448s200.6 448 448 448 448-200.6 448-448-200.6-448-448-448z m0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z" fill="" p-id="19657"></path><path d="M464 336c0 26.5 21.5 48 48 48s48-21.5 48-48-21.5-48-48-48-48 21.5-48 48zM536 448h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8v-272c0-4.4-3.6-8-8-8z" fill="" p-id="19658"></path></svg>',vhe=`<?xml version="1.0" encoding="UTF-8"?>
<svg width="23px" height="12px" viewBox="0 0 23 12" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <title>编组 8备份 3</title>
    <g id="----隐藏列标注！" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <g id="隐藏列标注" transform="translate(-275.000000, -824.000000)">
            <rect fill="#FFFFFF" x="0" y="0" width="1333" height="1167"></rect>
            <g id="编组-8备份-3" transform="translate(275.000000, 824.000000)">
                <rect id="矩形" stroke-opacity="0.25" stroke="#000000" fill="#F7F7F7" x="0.5" y="0.5" width="11" height="11"></rect>
                <rect id="矩形备份-9" stroke-opacity="0.25" stroke="#000000" fill="#F7F7F7" x="11.5" y="0.5" width="11" height="11"></rect>
                <g id="7.Icon/arrow/15.down/fill" transform="translate(6.000000, 6.000000) rotate(90.000000) translate(-6.000000, -6.000000) " fill="#000000" fill-rule="nonzero" opacity="0.65">
                    <path d="M7.25020811,6.37218077 L4.91348936,8.20968077 C4.82677061,8.27764952 4.69903624,8.21671202 4.69903624,8.10655577 L4.69903624,4.43272764 C4.69903624,4.32257139 4.82677061,4.26046202 4.91348936,4.32960264 L7.25020811,6.16593077 C7.31700499,6.21866514 7.31700499,6.31944639 7.25020811,6.37218077 Z" id="fill" transform="translate(5.999671, 6.269385) rotate(90.000000) translate(-5.999671, -6.269385) "></path>
                </g>
                <g id="7.Icon/arrow/15.down/fill" transform="translate(17.000000, 6.000000) rotate(270.000000) translate(-17.000000, -6.000000) translate(11.000000, 0.000000)" fill="#000000" fill-rule="nonzero" opacity="0.65">
                    <path d="M7.25020811,6.37218077 L4.91348936,8.20968077 C4.82677061,8.27764952 4.69903624,8.21671202 4.69903624,8.10655577 L4.69903624,4.43272764 C4.69903624,4.32257139 4.82677061,4.26046202 4.91348936,4.32960264 L7.25020811,6.16593077 C7.31700499,6.21866514 7.31700499,6.31944639 7.25020811,6.37218077 Z" id="fill" transform="translate(5.999671, 6.269385) rotate(90.000000) translate(-5.999671, -6.269385) "></path>
                </g>
            </g>
            <line x1="286.5" y1="813" x2="286.5" y2="864.5" id="路径-2备份-3" stroke="#000000" opacity="0.25"></line>
        </g>
    </g>
</svg>`,ghe=`<svg t="1557140120188" class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
xmlns="http://www.w3.org/2000/svg" p-id="16909" xmlns:xlink="http://www.w3.org/1999/xlink"
width="200" height="200">
	<defs>
		<style type="text/css">
		</style>
	</defs>
	<path d="M328 544h368c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8z"
	p-id="16910">
	</path>
	<path d="M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32z m-40 728H184V184h656v656z"
	p-id="16911">
	</path>
</svg>`,mhe=`<svg t="1557140186692" class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
xmlns="http://www.w3.org/2000/svg" p-id="17025" xmlns:xlink="http://www.w3.org/1999/xlink"
width="200" height="200">
	<defs>
		<style type="text/css">
		</style>
	</defs>
	<path d="M328 544h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8z"
	p-id="17026">
	</path>
	<path d="M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32z m-40 728H184V184h656v656z"
	p-id="17027">
	</path>
</svg>`,yhe=`<svg t="1565940955886" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
     p-id="17472" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200">
  <defs>
    <style type="text/css"></style>
  </defs>
  <path
    d="M948 392.992l-403.008 488.99200001Q532 896 512.992 896t-32-14.016L76 392.992q-18.016-20.992-7.008-46.016T108 321.98400001L916 321.98400001q28 0 39.008 24.99199999T948 392.992z"
    p-id="17473" data-spm-anchor-id="a313x.7781069.0.i2" class="selected"></path>
</svg>
`,_he=`<svg t="1565940955886" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
     p-id="17472" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200">
  <defs>
    <style type="text/css"></style>
  </defs>
  <path
    fill-opacity="0.45"
    d="M948 392.992l-403.008 488.99200001Q532 896 512.992 896t-32-14.016L76 392.992q-18.016-20.992-7.008-46.016T108 321.98400001L916 321.98400001q28 0 39.008 24.99199999T948 392.992z"
    p-id="17473" data-spm-anchor-id="a313x.7781069.0.i2" class="selected"></path>
</svg>
`,xhe=`<svg t="1565940979768" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
p-id="17620" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200">
<defs>
<style type="text/css"></style>
</defs>
<path
d="M76 631.008l403.008-488.99200001Q492 128 511.008 128t32 14.016L948 631.008q18.016 20.992 7.008 46.016T916 702.01599999L108 702.01599999q-28 0-39.008-24.99199999T76 631.008z"
p-id="17621"></path>
</svg>
`,bhe=`<svg t="1565940979768" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
     p-id="17620" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200">
  <defs>
    <style type="text/css"></style>
  </defs>
  <path
    fill-opacity="0.45"
    d="M76 631.008l403.008-488.99200001Q492 128 511.008 128t32 14.016L948 631.008q18.016 20.992 7.008 46.016T916 702.01599999L108 702.01599999q-28 0-39.008-24.99199999T76 631.008z"
    p-id="17621"></path>
</svg>
`,Ehe='<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1596433821690" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="20229" width="16" height="16" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css"></style></defs><path d="M888 792H200V168c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h752c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM305.8 637.7c3.1 3.1 8.1 3.1 11.3 0l138.3-137.6L583 628.5c3.1 3.1 8.2 3.1 11.3 0l275.4-275.3c3.1-3.1 3.1-8.2 0-11.3l-39.6-39.6c-3.1-3.1-8.2-3.1-11.3 0l-230 229.9L461.4 404c-3.1-3.1-8.2-3.1-11.3 0L266.3 586.7c-3.1 3.1-3.1 8.2 0 11.3l39.5 39.7z" p-id="20230"></path></svg>',whe=`<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1608030723688" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="21482" xmlns:xlink="http://www.w3.org/1999/xlink" width="16" height="16"><defs><style type="text/css"></style></defs><path d="M547.648 696a32 32 0 0 1 31.488 26.24l0.512 5.76v151.68l145.216-144.512a32 32 0 0 1 40.832-3.648l4.416 3.712a32 32 0 0 1 3.584 40.832l-3.712 4.48-203.072 202.24a32 32 0 0 1-40.768 3.648l-4.416-3.712-202.24-202.24a32 32 0 0 1 40.832-48.96l4.416 3.712 150.912 150.912v-158.144a32 32 0 0 1 32-32z m194.56-529.28l4.928 3.072 233.792 180.224a32 32 0 0 1 1.728 49.28l-4.864 3.52-409.792 245.568a32 32 0 0 1-27.328 2.624l-5.184-2.432-422.4-245.568a32 32 0 0 1-7.552-49.28l4.544-4.032 242.816-180.288a32 32 0 0 1 42.432 47.552l-4.288 3.84-203.84 151.296 364.16 211.648 353.28-211.712-196.608-151.552a32 32 0 0 1-8.896-40l3.136-4.864a32 32 0 0 1 40-8.96zM547.712 28.672a32 32 0 0 1 31.488 26.24l0.512 5.76v396.992a32 32 0 0 1-63.488 5.76l-0.512-5.76V60.736a32 32 0 0 1 32-32z" p-id="21483" fill="currentColor"></path></svg>
`,Che='<svg viewBox="64 64 896 896" focusable="false" data-icon="eye" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M942.2 486.2C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 000 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3 7.7-16.2 7.7-35 0-51.5zM512 766c-161.3 0-279.4-81.8-362.7-254C232.6 339.8 350.7 258 512 258c161.3 0 279.4 81.8 362.7 254C791.5 684.2 673.4 766 512 766zm-4-430c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm0 288c-61.9 0-112-50.1-112-112s50.1-112 112-112 112 50.1 112 112-50.1 112-112 112z"></path></svg>',lX=Object.freeze({__proto__:null,ArrowDown:ahe,ArrowUp:ohe,CellDown:she,CellUp:lhe,GlobalAsc:uhe,GlobalDesc:che,GroupAsc:hhe,GroupDesc:fhe,GroupNone:dhe,Minus:ghe,Plus:mhe,SortDown:_he,SortUp:bhe,SortDownSelected:yhe,SortUpSelected:xhe,InfoCircle:phe,ExpandColIcon:vhe,Trend:Ehe,DrillDownIcon:whe,EyeOutlined:Che}),$at={},Hat=function(e,t){$at[sk(e)]=t},She=function(e){return $at[sk(e)]};xs(lX).forEach(function(e){Hat(e,lX[e])});var uX="<svg",cX="data:image/svg+xml",hX={},UC=function(e){en(t,e);function t(r){var n=e.call(this,r)||this;return n.isOnlineLink=function(i){return/^(https?:)?(\/\/)/.test(i)},n.render(),n}return t.prototype.getImage=function(r,n,i){var a=this;return new Promise(function(o,s){var l=She(r);if(l){var u=new Image;u.onload=function(){hX[n]=u,o(u)},u.onerror=s,l.includes(cX)||a.isOnlineLink(l)?(u.src=l,u.crossOrigin="anonymous"):(i&&(l=l.replace(/fill=[\'\"]#?\w+[\'\"]/g,""),l=l.replace(/fill>/g,">")),l=l.replace(uX,"".concat(uX,' fill="').concat(i,'"')),u.src="".concat(cX,";utf-8,").concat(encodeURIComponent(l)))}})},t.prototype.render=function(){var r=this.cfg,n=r.name,i=r.fill,a=FS(this.cfg),o=Zt(Zt({},dk(a,"fill")),{type:t.type}),s=new bN({attrs:o});this.iconImageShape=s,this.setImageAttrs({name:n,fill:i})},t.prototype.setImageAttrs=function(r){var n=this,i=r.name,a=r.fill,o=this.iconImageShape;i=i||o.attrs.name,a=a||o.attrs.fill;var s="".concat(i,"-").concat(a),l=hX[s];l?(o.attr("img",l),this.addShape("image",o)):this.getImage(i,s,a).then(function(u){var c,f,d,v=(d=(f=(c=n.getParent())===null||c===void 0?void 0:c.getMeta)===null||f===void 0?void 0:f.call(c).spreadsheet)===null||d===void 0?void 0:d.container;if(n.destroyed||v&&!v.get("refreshElements")){Fp.getInstance().logger("GuiIcon ".concat(i," destroyed."));return}o.attr("img",u),n.addShape("image",o)}).catch(function(u){if(u instanceof TypeError){console.warn("GuiIcon ".concat(i," destroyed:"),u);return}console.error("GuiIcon ".concat(i," load failed:"),u)})},t.type="__GUI_ICON__",t}(tv),vl;(function(e){e.TOP="TOP",e.BOTTOM="BOTTOM",e.LEFT="LEFT",e.RIGHT="RIGHT"})(vl||(vl={}));var Ay;(function(e){e.SUM="SUM",e.MIN="MIN",e.MAX="MAX",e.AVG="AVG"})(Ay||(Ay={}));var Rd;(function(e){e.Row="row",e.Col="col",e.Series="series"})(Rd||(Rd={}));var The=function(){function e(){this.store=new Map}return e.prototype.set=function(t,r){return this.store.set(t,r)},e.prototype.get=function(t,r){var n,i=this.store.get(t);return(n=i)!==null&&n!==void 0?n:r},e.prototype.clear=function(){this.store.clear()},e.prototype.size=function(){return this.store.size},e}(),GA=function(e){var t,r,n=e.facetCfg,i=e.level,a=e.fields,o=n.colCfg,s=n.spreadsheet,l=n.dataSet,u=l.moreThanOneValue(),c=(r=(t=s.dataCfg.fields)===null||t===void 0?void 0:t.valueInCols)!==null&&r!==void 0?r:!0,f=(o==null?void 0:o.hideMeasureColumn)&&c&&!u&&oc(a,Pi),d=f?2:1;return i===a.length-d},Vat=function(e,t,r,n){return t.layoutArrange?t.layoutArrange(t.spreadsheet,r,n,e):e},Rk=function(e,t,r,n){var i,a,o=(a=(i=e.spreadsheet)===null||i===void 0?void 0:i.facet)===null||a===void 0?void 0:a.getHiddenColumnsInfo(r);if(o&&e.columns.find(function(x){return x===r.field}))return!1;var s=!0,l=function(x,w,S){w===void 0&&(w=-1),S===void 0&&(S=-1),w===-1?(t.children.push(x),n.pushNode(x)):(t.children.splice(w,0,x),n.pushNode(x,S))};if(e.layoutHierarchy){var u=e.layoutHierarchy(e.spreadsheet,r);if(u){var c=Dp(u==null?void 0:u.delete)?u==null?void 0:u.delete:!1;s=!c;var f=u.push,d=u.unshift,v=t.children.length,g=n.getNodes().length;Or(d)||(xi(d,function(x){l(x)}),v=t.children.length,g=n.getNodes().length),Or(f)||xi(f,function(x){l(x)}),c||l(r,v,g)}else l(r)}else l(r);return s},_B=function(e,t,r){e!=null&&e.layoutCoordinate&&(t!=null&&t.isLeaf||r!=null&&r.isLeaf)&&(e==null||e.layoutCoordinate(e.spreadsheet,t,r))},Ahe=function(e,t){var r=e==null?void 0:e.layoutDataPosition;if(r){var n=t.getCellMeta,i=r(e.spreadsheet,n);return Zt(Zt({},t),{getCellMeta:i})}return t},Gat=function(){function e(t){this.label=t}return e}(),Wat=function(e){var t=e.addTotalMeasureInTotal,r=e.parentNode,n=e.currentField,i=e.fields,a=e.facetCfg,o=e.hierarchy,s=i.indexOf(n),l=a.dataSet,u=a.values,c=a.spreadsheet,f=[],d={},v=c.getTotalsConfig(n),g=r.isGrandTotals?v.totalsGroupDimensions||[]:v.subTotalsGroupDimensions||[],x=l.isEmpty()?[]:g;if(x!=null&&x.includes(n)){d=yB(r);var w=l.getDimensionValues(n,d);f.push.apply(f,Vr([],lr((w||[]).map(function(A){return new eb({label:A,isSubTotals:r.isSubTotals,isGrandTotals:r.isGrandTotals,isTotalRoot:!1})})),!1)),Or(f)&&n&&f.push(T_)}else if(t&&n===Pi)d=yB(r),f.push.apply(f,Vr([],lr(u.map(function(A){return new Gat(A)})),!1));else if(GA({facetCfg:a,level:s,fields:i})){r.isLeaf=!0,o.pushIndexNode(r),r.rowIndex=o.getIndexNodes().length-1;return}else{Wat(Zt(Zt({},e),{currentField:i[s+1]}));return}var S=f.filter(function(A){return!u3(A)});Ik(Zt(Zt({},e),{fieldValues:S,level:s,parentNode:r,query:d}))},Mhe=function(e){var t,r=e.parentNode,n=e.currentField,i=e.fields,a=e.facetCfg,o=i.indexOf(n),s=a.dataSet,l=a.spreadsheet,u=[],c={};c=yB(r,!0);var f=s.getDimensionValues(n,c),d=Vat(f,a,r,n);u.push.apply(u,Vr([],lr(d||[]),!1)),Or(u)&&n&&(n===Pi?u.push.apply(u,Vr([],lr((t=s.fields)===null||t===void 0?void 0:t.values),!1)):u.push(T_)),ehe({currentField:n,lastField:i[o-1],isFirstField:o===0,fieldValues:u,spreadsheet:l});var v=u.filter(function(g){return!u3(g)});Ik(Zt(Zt({},e),{fieldValues:v,level:o,parentNode:r,query:c}))},Xat=function(e){e.parentNode.isTotals?Wat(e):Mhe(e)},$C=function(e,t){return"".concat(e).concat(sc).concat(t)},Ik=function(e){var t,r,n,i,a,o,s,l,u,c,f=e.currentField,d=e.fields,v=e.fieldValues,g=e.facetCfg,x=e.hierarchy,w=e.parentNode,S=e.level,A=e.query,M=e.addMeasureInTotalQuery,R=e.addTotalMeasureInTotal,O=g.spreadsheet,N=g.collapsedCols;try{for(var k=Gf(v.entries()),V=k.next();!V.done;V=k.next()){var Q=lr(V.value,2),Y=Q[0],X=Q[1],tt=X instanceof eb,it=X instanceof Gat,Et=void 0,Tt=void 0,pt=!1,kt=!1,ae=!1,Kt=!1,re=f;if(tt){var fe=X;kt=fe.isGrandTotals,ae=fe.isSubTotals,Kt=fe.isTotalRoot,Et=El(X.label),Kt?Tt=A:Tt=Zt(Zt({},A),(n={},n[f]=Et,n)),M&&(Tt[Pi]=(s=O==null?void 0:O.dataSet)===null||s===void 0?void 0:s.fields.values[0]),pt=GA({facetCfg:g,level:S,fields:d})}else it?(Et=El(X.label),Tt=Zt(Zt({},A),(i={},i[Pi]=Et,i)),re=Pi,kt=w.isGrandTotals,ae=w.isSubTotals,pt=GA({facetCfg:g,level:S,fields:d})):O.isTableMode()?(Et=X,re=d[Y],Tt=Zt(Zt({},A),(a={},a[re]=Et,a)),pt=!0):(Et=X,Tt=Et===T_?Zt({},A):Zt(Zt({},A),(o={},o[f]=Et,o)),pt=GA({facetCfg:g,level:S,fields:d}));var Oe=$C(w.id,Et);if(!Oe)return;var Ye=Dp(N==null?void 0:N[Oe])?N==null?void 0:N[Oe]:!1,Be=new su({id:Oe,key:re,value:Et,level:S,field:re,parent:w,isTotals:tt||it,isGrandTotals:kt,isSubTotals:ae,isTotalMeasure:it,isCollapsed:Ye,isTotalRoot:Kt,hierarchy:x,query:Tt,spreadsheet:O,isLeaf:pt||Ye}),De=Rk(g,w,Be,x),Yr=(l=O==null?void 0:O.facet)===null||l===void 0?void 0:l.getHiddenColumnsInfo(Be);Yr&&w&&(w.hiddenChildNodeInfo=Yr),S>x.maxLevel&&!kt&&!w.isGrandTotals&&!w.isSubTotals&&!Be.isSubTotals&&(x.sampleNodesForAllLevels.push(Be),x.maxLevel=S,x.sampleNodeForLastLevel=Yr?((u=Yr==null?void 0:Yr.displaySiblingNode)===null||u===void 0?void 0:u.next)||((c=Yr==null?void 0:Yr.displaySiblingNode)===null||c===void 0?void 0:c.prev):Be);var Gr=pt||Ye||!De;Gr?(Be.isLeaf=!0,x.pushIndexNode(Be),Be.rowIndex=x.getIndexNodes().length-1):Xat({addTotalMeasureInTotal:R,addMeasureInTotalQuery:M,parentNode:Be,currentField:d[S+1],fields:d,facetCfg:g,hierarchy:x})}}catch(Mn){t={error:Mn}}finally{try{V&&!V.done&&(r=k.return)&&r.call(k)}finally{if(t)throw t.error}}},jat=function(e,t,r,n){var i=t.facetCfg,a=t.hierarchy,o=t.parentNode,s=i.dataSet;e.forEach(function(l,u){typeof l=="string"&&(l={key:l});var c=l.key,f=c===n_?El("序号"):s.getFieldName(c),d=n||o;if(Ik({currentField:c,fields:[c],fieldValues:[f],facetCfg:i,hierarchy:a,parentNode:d,level:r,query:{},addMeasureInTotalQuery:!1,addTotalMeasureInTotal:!1}),l.children&&l.children.length){var v=d.children[u];v.isLeaf=!1,jat(l.children,t,r+1,v)}})},Ny=function(e,t){return t>0&&e<t},ky=function(e,t,r){return t>0&&e>=r-t},g3=function(e,t,r){return r>0&&e<t+r},VS=function(e,t,r){return r>0&&e>=t+1-r},Lk=function(e,t,r,n,i,a){var o=Jx(r,function(f,d){var v=e-(bl(a)?0:a)+i.x;return v>=f&&v<r[d+1]},0);o=Math.max(o,0);var s=Jx(r,function(f,d){var v=i.width+e+i.x;return v>=f&&v<r[d+1]},o);s=Math.min(s===-1?1/0:s,r.length-2);var l=n.getIndexRange(t+i.y,i.height+t+i.y),u=l.start,c=l.end;return[o,s,u,c]},Rhe=function(e,t,r){var n=2,i=Math.abs(e/t),a=i<=1/n?0:e,o=i>n?0:t;return[a*r.horizontal,o*r.vertical]},qv=function(e,t,r){var n,i,a=e==null?void 0:e.getMatrix(),o=(n=a==null?void 0:a[6])!==null&&n!==void 0?n:0,s=(i=a==null?void 0:a[7])!==null&&i!==void 0?i:0;e==null||e.translate(t-o,r-s)},m3=function(e,t){var r,n=e==null?void 0:e.getMatrix(),i=(r=n==null?void 0:n[6])!==null&&r!==void 0?r:0;e==null||e.translate(t-i,0)},Ihe=function(e,t){var r,n=e==null?void 0:e.getMatrix(),i=(r=n==null?void 0:n[7])!==null&&r!==void 0?r:0;e==null||e.translate(0,t-i)},Lhe=function(e,t,r,n){var i=t.frozenColCount,a=t.frozenRowCount,o=t.frozenTrailingColCount,s=t.frozenTrailingRowCount,l=e.colIndex,u=e.rowIndex;return g3(u,n.start,a)?tl.ROW:VS(u,n.end,s)?tl.TRAILING_ROW:Ny(l,i)?tl.COL:ky(l,o,r)?tl.TRAILING_COL:tl.SCROLL},Ohe=function(e,t,r){for(var n,i=e.frozenColCount,a=e.frozenRowCount,o=e.frozenTrailingColCount,s=e.frozenTrailingRowCount,l=(n={},n[tl.TOP]=[],n[tl.BOTTOM]=[],n),u=0;u<i;u++){for(var c=r.start;c<r.start+a;c++)l[tl.TOP].push({x:u,y:c});if(s>0)for(var c=0;c<s;c++){var f=r.end-c;l[tl.BOTTOM].push({x:u,y:f})}}for(var u=0;u<o;u++){for(var d=t-1-u,c=r.start;c<r.start+a;c++)l[tl.TOP].push({x:d,y:c});if(s>0)for(var c=0;c<s;c++){var f=r.end-c;l[tl.BOTTOM].push({x:d,y:f})}}return l},Phe=function(e,t,r,n){var i=t.frozenColCount,a=t.frozenRowCount,o=t.frozenTrailingColCount,s=t.frozenTrailingRowCount,l=Vr([],lr(e),!1);Ny(l[0],i)&&(l[0]=i),ky(l[1],o,r)&&(l[1]=r-o-1),g3(l[2],n.start,a)&&(l[2]=n.start+a),VS(l[3],n.end,s)&&(l[3]=n.end-s);var u=Vr([],lr(l),!1);u[2]=n.start,u[3]=n.start+a-1;var c=Vr([],lr(l),!1);c[0]=0,c[1]=i-1;var f=Vr([],lr(l),!1);f[2]=n.end+1-s,f[3]=n.end;var d=Vr([],lr(l),!1);return d[0]=r-o,d[1]=r-1,{center:l,frozenRow:u,frozenCol:c,frozenTrailingCol:d,frozenTrailingRow:f}},Dhe=function(e,t){var r=e,n=0,i=r.getTotalLength()-1;if(t){var a=t.current,o=a===void 0?mB:a,s=t.pageSize;n=Math.max((o-1)*s,0),i=Math.min(o*s-1,r.getTotalLength()-1)}return{start:n,end:i}},_R=function(e,t,r){var n=t,i=r,a=function(o){return o.isLeaf?1:o.children?o.children.reduce(function(s,l){return s+=a(l),s},0):0};return t&&(n=e.slice(0,t).reduce(function(o,s){return o+=a(s),o},0)),r&&(i=e.slice(e.length-r).reduce(function(o,s){return o+=a(s),o},0)),{colCount:n,trailingColCount:i}},Yat=function(e,t){return e.reduce(function(r,n){typeof n=="string"&&(n={key:n});var i=Zt({},n);return i.children?(i.children=Yat(i.children,t),r.push(i),r):(t[i.key]&&r.push(i),r)},[])},Bp=function(e){return e.parent.id==="root"},Fhe=function(e){for(;!Bp(e);)e=e.parent;return e},Bhe=function(e){var t=[],r=function(n){n.forEach(function(i){typeof i=="string"||!i.children?t.push(i):r(i.children)})};return r(e),t},Bb=function(e){var t=Bhe(e);return t.map(function(r){return typeof r=="string"?r:r.key})},xB=function(e){var t=e.children[0];return t?t.isLeaf?t:xB(t):e},Nhe=function(e){return Or(e.rows)&&Or(e.columns)&&Or(e.values)&&Or(e.customTreeItems)},rb=function(e,t){var r,n=e.pagination,i=e.frozenFirstRow,a=e.hierarchyType,o=e.showSeriesNumber,s=n&&n.pageSize,l=!1,u=t==null?void 0:t[0];if(!s&&i){l=((r=u==null?void 0:u.children)===null||r===void 0?void 0:r.length)===0;var c=a==="tree"||a==="customTree";c&&!l&&(l=!o)}var f=l&&!!u;return{frozenRowCount:f?1:0,frozenColCount:0,frozenTrailingColCount:0,frozenTrailingRowCount:0,enableFrozenFirstRow:l,frozenRowHeight:f?u.height:0}},khe=function(e){return e===T_?VI:e},zhe=function(e){var t=e.facetCfg,r=t.columns,n=t.spreadsheet,i=n.store.get("hiddenColumnsDetail"),a=t==null?void 0:t.showSeriesNumber,o=Bb(r),s=o.filter(function(f){return i?i.every(function(d){return d.hideColumnNodes.every(function(v){return v.field!==f})}):!0}),l=Vr([],lr(s),!1),u=Vr([],lr(r),!1),c={};a&&(u.unshift({key:n_}),c[n_]=!0),l.reduce(function(f,d){return f[d]=!0,f},c),jat(Yat(u,c),e,0,null)},ex=function(e){return Number.parseFloat((Dh(e)||0).toPrecision(Qrt))},Nm=function(e,t,r){if(r===void 0&&(r=0),!Object.values(e).find(function(o){return o>0}))return e;var n=Zt({},e);n.frozenColCount>=t&&(n.frozenColCount=t);var i=t-n.frozenColCount;n.frozenTrailingColCount>i&&(n.frozenTrailingColCount=i),n.frozenRowCount>=r&&(n.frozenRowCount=r);var a=r-n.frozenRowCount;return n.frozenTrailingRowCount>a&&(n.frozenTrailingRowCount=a),n},Uhe=function(e){var t;return(t=e==null?void 0:e.position)!==null&&t!==void 0?t:"right"},$he=function(e,t){e===void 0&&(e=0),t===void 0&&(t=0),e=ex(e),t=ex(t);var r=e>=0,n=t>=0&&e<=0,i=r?e:t,a=n?0:i,o=t-e;return function(s){var l=r?0:1,u=n?pR(Math.abs(0-e)/o,0,1):l,c=pR((s-a)/o,-1,1);return{zeroScale:u,scale:c}}},Zat=function(e,t){return a3(e,function(r){return r.field instanceof RegExp?r.field.test(t):r.field===t})},Ok=function(e){return gR({size:0,position:"right",margin:{left:0,right:0}},e)},qat=function(e,t,r){var n=t.size,i=t.margin,a=Zat(e==null?void 0:e.icon,r),o=a&&a.mapping&&{size:n,margin:i,position:Uhe(a)};return Ok(o)};function Fh(e,t,r){var n;return(n=e==null?void 0:e.addShape)===null||n===void 0?void 0:n.call(e,"rect",Zt({zIndex:1,attrs:t},r||{}))}function Hhe(e,t){var r;return(r=e==null?void 0:e.addShape)===null||r===void 0?void 0:r.call(e,"polygon",{attrs:t})}function Vhe(e,t){var r;return(r=e==null?void 0:e.addShape)===null||r===void 0?void 0:r.call(e,"polyline",{attrs:t})}function Kat(e,t){var r;return(r=e==null?void 0:e.addShape)===null||r===void 0?void 0:r.call(e,"circle",{attrs:t})}function c_(e,t,r,n,i,a,o,s){var l;return!Or(t)&&e&&xi(t,function(u){e.contain(u)&&e.removeChild(u,!0)}),(l=e==null?void 0:e.addShape)===null||l===void 0?void 0:l.call(e,"text",{attrs:Zt(Zt({x:r,y:n,text:i,originalText:s},a),o)})}function lu(e,t,r){var n;return(n=e==null?void 0:e.addShape)===null||n===void 0?void 0:n.call(e,"line",{zIndex:100,attrs:Zt(Zt({},t),r)})}function Tf(e,t,r){if(!Or(e)){var n=Wn(e)?e:[e];n.forEach(function(i){kC(i,"attrs.".concat(t),r)})}}function Pk(e,t){var r=new UC(t);return e==null||e.add(r),r}function Qat(e,t,r,n,i){var a=new UC(Zt(Zt({name:n?"Plus":"Minus"},t),{fill:r}));return hu(i)&&a.on("click",i),e==null||e.add(a),a}var bB="s2-offscreen-canvas",Ghe=function(){var e=document.getElementById(bB);return e||(e=document.createElement("canvas"),e.id=bB,e.style.display="none",document.body.appendChild(e),e)},Whe=function(){var e;(e=document.getElementById(bB))===null||e===void 0||e.remove()},Jat=function(e,t){var r,n,i,a=e.data,o=e.encode,s=e.type,l=t.getMeta(),u=l.x,c=l.y,f=l.height,d=l.width,v=t.getStyle(Br.DATA_CELL),g=v.cell,x=v.miniChart,w=[],S=ia(a,function(it){return w.push(it==null?void 0:it[o.y]),{x:it[o.x],y:it[o.y]}}),A=tb(w),M=hk(w),R=A-M,O=u+g.padding.left,N=u+d-g.padding.right,k=c+g.padding.top,V=c+f-g.padding.bottom,Q=V-k,Y=s===Qx.Bar?(N-O-(w.length-1)*((r=x==null?void 0:x.bar)===null||r===void 0?void 0:r.intervalPadding))/w.length+((n=x==null?void 0:x.bar)===null||n===void 0?void 0:n.intervalPadding):(i=(N-O)/(w.length-1))!==null&&i!==void 0?i:0,X=[],tt=ia(S,function(it,Et){var Tt,pt=O+Et*Y,kt;if(R!==0?kt=V-((it==null?void 0:it.y)-M)/R*Q:kt=M>0?k:V,s===Qx.Bar){var ae=void 0,Kt=void 0;M<0&&A>0&&R!==0?(ae=V-(0-M)/R*Q,Kt=Math.abs(kt-ae),(it==null?void 0:it.y)<0&&(kt=ae)):(ae=M<0?k:V,R=tb([Math.abs(A),Math.abs(M)]),Kt=R===0?Q:Math.abs((it==null?void 0:it.y)-0)/R*Q,kt=ae);var re=Y-((Tt=x==null?void 0:x.bar)===null||Tt===void 0?void 0:Tt.intervalPadding);X.push([re,Kt])}return[pt,kt]});return{points:tt,box:X}},Xhe=function(e,t){if(!(Or(e==null?void 0:e.data)||Or(t))){var r=t.getStyle(Br.DATA_CELL),n=r.miniChart,i=n.line,a=i.point,o=i.linkLine,s=Jat(e,t).points;Vhe(t,{points:s,stroke:o.fill,lineWidth:o.size,opacity:o.opacity});for(var l=0;l<s.length;l++)Kat(t,{x:s[l][0],y:s[l][1],r:a.size,fill:a.fill,fillOpacity:a.opacity})}},jhe=function(e,t){if(!(Or(e==null?void 0:e.data)||Or(t)))for(var r=t.getStyle(Br.DATA_CELL),n=r.miniChart,i=n.bar,a=Jat(e,t),o=a.points,s=a.box,l=0;l<o.length;l++)Fh(t,{x:o[l][0],y:o[l][1],width:s[l][0],height:s[l][1],fill:i.fill,fillOpacity:i.opacity})},Yhe=function(e,t,r){var n=Number(t)-Number(e);return Number.isNaN(n)||Number(e)<0?r.bad:n<=.1?r.good:n>.1&&n<=.2?r.satisfactory:r.bad},Zhe=function(e,t){var r,n;t===void 0&&(t={min:0,max:0});var i=Number(e);if(Number.isNaN(i))return e;var a=(r=t==null?void 0:t.min)!==null&&r!==void 0?r:t,o=(n=t==null?void 0:t.max)!==null&&n!==void 0?n:t,s=new Intl.NumberFormat("en-US",{minimumFractionDigits:a,maximumFractionDigits:o,useGrouping:!1,style:"percent"});return s.format(i)},qhe=function(e){var t,r,n,i,a,o;if(!Or(e)){var s=e.getCellArea(),l=s.x,u=s.y,c=s.height,f=s.width,d=e.findFieldCondition((t=e.cellConditions)===null||t===void 0?void 0:t.interval);if(d&&d.mapping){var v=e.mappingValue(d);if(!v)return;var g=v.isCompare?v:e.valueRangeByField,x=ex(g.minValue),w=ex(g.maxValue),S=bl(v==null?void 0:v.fieldValue)?ex(e.getMeta().fieldValue):ex(v==null?void 0:v.fieldValue);if(S<x||S>w)return;var A=(n=(r=e.getStyle().miniChart.interval)===null||r===void 0?void 0:r.height)!==null&&n!==void 0?n:e.getStyle().cell.miniBarChartHeight,M=(a=(i=e.getStyle().miniChart.interval)===null||i===void 0?void 0:i.fill)!==null&&a!==void 0?a:e.getStyle().cell.miniBarChartFillColor,R=$he(x,w),O=R(S),N=O.zeroScale,k=O.scale,V=(o=v.fill)!==null&&o!==void 0?o:M;return Fh(e,{x:l+f*N,y:u+c/2-A/2,width:f*k,height:A,fill:V})}}},Khe=function(e,t){var r,n=t.getStyle(Br.DATA_CELL),i=t.getMeta(),a=i.x,o=i.y,s=i.height,l=i.width,u=i.spreadsheet;if(Or(e)){c_(t,[],a+l-n.cell.padding.right,o+s/2,O_(t,u.options.placeholder),n.text);return}var c=n.miniChart.bullet,f=c.progressBar,d=c.comparativeMeasure,v=c.rangeColors,g=c.backgroundColor,x=e.measure,w=e.target,S=Math.max(Number(x),0),A=Math.max(Number(w),0),M=Zhe(x,2),R=(f==null?void 0:f.widthPercent)>1?(f==null?void 0:f.widthPercent)/100:f==null?void 0:f.widthPercent,O=n.cell.padding,N=l-O.left-O.right,k=R*N,V=N-k,Q=a+l-O.right-k,Y=o+s/2-f.height/2;Fh(t,{x:Q,y:Y,width:k,height:f.height,fill:g,textBaseline:n.text.textBaseline});var X=ii(t.getMeta(),"spreadsheet.options.bullet.getRangeColor"),tt=Math.max(Math.min(k*S,k),0);Fh(t,{x:Q,y:Y+(f.height-f.innerHeight)/2,width:tt,height:f.innerHeight,fill:(r=X==null?void 0:X(S,A))!==null&&r!==void 0?r:Yhe(S,A,v)});var it=Q+k*A;lu(t,{x1:it,y1:o+(s-d.height)/2,x2:it,y2:o+(s-d.height)/2+d.height},{stroke:(d==null?void 0:d.fill)||(d==null?void 0:d.color),lineWidth:d.width,opacity:d==null?void 0:d.opacity}),c_(t,[],Q-O.right,o+s/2,nb({measureTextWidth:u.measureTextWidth,text:M,maxWidth:V-O.right,fontParam:n.text}),n.text)},Qhe=function(e,t){switch(t==null?void 0:t.type){case Qx.Line:Xhe(t,e);break;case Qx.Bar:jhe(t,e);break;default:Khe(t,e);break}},tot=function(e,t){var r=e.x,n=e.y,i=e.width,a=e.height,o=i-(t==null?void 0:t.left)-(t==null?void 0:t.right),s=a-(t==null?void 0:t.top)-(t==null?void 0:t.bottom);return{x:r+(t==null?void 0:t.left),y:n+(t==null?void 0:t.top),width:o,height:s}},eot=function(e,t){return t=Ok(t),e-t.size-t.margin.right-t.margin.left},xR=function(e,t,r){var n=e.y,i=e.height;r===void 0&&(r=0);var a=0;switch(t){case"top":a=n;break;case"middle":a=n+i/2-r/2;break;default:a=n+i-r;break}return a},GS=function(e,t,r,n,i){r===void 0&&(r=0),i===void 0&&(i=1);var a=e.x,o=e.width,s=t||{},l=s.textAlign,u=s.textBaseline,c=Ok(n),f=c.size,d=c.margin,v=c.position,g=i*(f+d.left)+(i?d.right:0),x,w;switch(l){case"left":x=a+(v==="left"?g:0),w=a+(v==="left"?d.left:r+d.left);break;case"center":{var S=g-(v==="left"?d.left:d.right)+r,A=a+o/2-S/2;x=A+r/2+(v==="left"?g-d.left:0),w=A+(v==="left"?0:r+d.left);break}default:{x=a+o-(v==="right"?g:0),w=a+o-(v==="right"?g-d.left:r+g-d.left);break}}var M=xR(e,u,0),R=xR(e,u,f);return{text:{x,y:M},icon:{x:w,y:R}}},Jhe=function(e,t){return GS(e,t).text},tfe=function(e,t,r){var n=t.start+t.width,i=e.start+e.width,a,o;if(t.start<=e.start&&n>=i)a=e.start+e.width/2,o=e.width;else if(t.start<=e.start){var s=t.width-(e.start-t.start);a=s<r?n-r/2:n-s/2,o=s}else if(n>=i){var s=t.width-(n-i);a=s<r?t.start+r/2:t.start+s/2,o=s}else a=t.start+t.width/2,o=t.width;return{start:a,width:o}},h_=function(e,t,r){var n=t.x,i=t.y,a=t.width,o=t.height,s=r.horizontalBorderWidth,l=r.horizontalBorderColorOpacity,u=r.horizontalBorderColor,c=r.verticalBorderWidth,f=r.verticalBorderColor,d=r.verticalBorderColorOpacity,v=r.borderDash,g,x,w,S,A;if(e===vl.TOP||e===vl.BOTTOM){var M=i;e===vl.TOP?M=i+c/2:M=i+o-c/2,x=M,S=M,g=n,w=n+a,A={lineWidth:s,stroke:u,strokeOpacity:l,lineDash:v}}if(e===vl.LEFT||e===vl.RIGHT){var R=n;e===vl.LEFT?R=n+s/2:R=n+a-s/2,g=R,w=R,x=i,S=i+o,A={lineWidth:c,stroke:f,strokeOpacity:d,lineDash:v}}return{position:{x1:g,x2:w,y1:x,y2:S},style:A}},efe=function(e,t,r){r===void 0&&(r={left:0,right:0});var n=Zt({},e);return t==="left"?(n.start+=r.left,n.width-=r.left):t==="right"&&(n.width-=r.right),n},rfe=function(e,t,r,n){var i=t+r,a=e.start;if(n==="center")return a-r/2;var o=e.width-i>0,s=o?e.width/2:i/2;return n==="left"?a-s:a+s-r};R_(function(e,t){if(e===void 0&&(e=""),!t)return 0;var r=Ghe().getContext("2d"),n=t,i=n.fontSize,a=n.fontFamily,o=n.fontWeight,s=n.fontStyle,l=n.fontVariant;return r.font=[s,l,o,"".concat(i,"px"),a].join(" ").trim(),r.measureText("".concat(e)).width},function(e,t){return Vr([e],lr(wg(t)),!1).join("")});var fX=function(e,t,r,n){var i=16,a=e(vx,n),o;Db(t)?o=t:o=za(t);var s=r,l=[],u,c;if(e(t,n)<=r)return t;for(var f=!0;f;){if(u=o.substr(0,i),c=e(u,n),c+a>s&&c>s){f=!1;break}if(l.push(u),s-=c,o=o.substr(i),!o)return l.join("")}for(var d=!0;d;){if(u=o.substr(0,1),c=e(u,n),c+a>s){d=!1;break}if(l.push(u),s-=c,o=o.substr(1),!o)return l.join("")}return"".concat(l.join(""),"...")},nb=function(e){var t=e.measureTextWidth,r=e.text,n=e.maxWidth,i=e.fontParam,a=e.priorityParam,o=e.placeholder,s={},l=o??VI,u=bl(r)||r===""||r===T_,c=u?l:"".concat(r),f=a;if(i&&Wn(i)?f=i:s=i||{},!f||!f.length)return fX(t,c,n,s);var d=[],v=[c];f.forEach(function(S){v.forEach(function(A,M){var R=-1,O=A.match(new RegExp(S));if(O){var N=O[0];R=O.index,d.push(N);var k=R+N.length,V=A.slice(0,R),Q=A.slice(k),Y=[V,Q].filter(function(X){return!!X});v.splice.apply(v,Vr([M,1],lr(Y),!1))}})}),v=d.concat(v);var g=c,x=t(vx,s),w=n;return v.forEach(function(S){if(w<=0){var A=g.indexOf(S),M=g.slice(A-3,A);if(M&&M!==vx){var R=t(S,s);g=g.replace(S,R>x?vx:S)}else g=g.replace(S,"");w-=x}else{var R=t(S,s);if(w<R&&R>x){var O=fX(t,S,w,s);g=g.replace(S,O),w=0}else w-=R}}),g},nfe=function(e,t,r,n){n===void 0&&(n="left");var i=t.right,a=t.left,o=r||0;return n==="left"?e+i/2+o:n==="right"?e-i/2-o:e+a/2+o},ife=function(e){var t,r,n=e.getMeta().isTotals,i=(r=(t=e).isMeasureField)===null||r===void 0?void 0:r.call(t),a=e.getStyle(e.cellType||Br.DATA_CELL),o;return i?o=a.measureText:n?o=a.bolderText:o=a.text,{cellStyle:a,textStyle:o}},afe=function(e){var t=e.rowIndex,r=e.colIndex,n=e.meta,i=e.data,a=e.textStyle,o=e.textCondition,s=a==null?void 0:a.fill;return o!=null&&o.mapping&&(s=o==null?void 0:o.mapping(i,{rowIndex:t,colIndex:r,meta:n}).fill),Zt(Zt({},a),{fill:s})},O_=function(e,t){return hu(t)?t(e):t},ofe=function(e,t,r){for(var n=e.x,i=e.y,a=e.width,o=e.height,s=o/tx(t),l=[],u,c,f,d=0,v=ia(r,function(S){return S>1?S/100:S}),g=0;g<tx(t);g++){c=i+s*g;var x=[];u=n,d=0;for(var w=0;w<tx(t[g]);w++)f=Or(v)?a/tx(t[0]):a*v[w],u=nfe(n,{left:0,right:0},d,"left"),d+=f,x.push({x:u,y:c,width:f,height:s});l.push(x)}return l},sfe=function(e,t,r){var n,i,a,o;r===void 0&&(r=!0);var s=e.getContentArea(),l=s.x,u=s.y,c=s.height,f=s.width,d=t||e.getMeta().fieldValue,v=d.values,g=e.getMeta().spreadsheet,x=g.options,w=g.measureTextWidth,S=x.style.cellCfg.valuesCfg,A=(i=(n=x==null?void 0:x.conditions)===null||n===void 0?void 0:n.text)===null||i===void 0?void 0:i[0],M=(o=(a=x==null?void 0:x.conditions)===null||a===void 0?void 0:a.icon)===null||o===void 0?void 0:o[0];if(!Wn(v)){Qhe(e,v);return}var R=S==null?void 0:S.widthPercent,O=0;if(d!=null&&d.label){var N=e.getStyle(Br.DATA_CELL),k=N.bolderText;O=c/(v.length+1);var V=c_(e,[],l,u+O/2,nb({measureTextWidth:w,text:d.label,maxWidth:f,fontParam:k}),k);e.addTextShape(V)}for(var Q=ife(e),Y=Q.cellStyle,X=Q.textStyle,tt=Y==null?void 0:Y.icon,it=M&&M.mapping&&{size:tt==null?void 0:tt.size,margin:tt==null?void 0:tt.margin,position:M==null?void 0:M.position},Et,Tt=ofe({x:l,y:u+O,height:c-O,width:f},v,R),pt=0;pt<v.length;pt++)for(var kt=FS(v[pt]),ae=0;ae<kt.length;ae++){Et=kt[ae];var Kt=r?afe({rowIndex:pt,colIndex:ae,meta:e==null?void 0:e.getMeta(),data:Et,textStyle:X,textCondition:A}):X,re=(e==null?void 0:e.getMeta().spreadsheet.options).placeholder,fe=O_(e==null?void 0:e.getMeta(),re),Oe=eot(Tt[pt][ae].width,tt),Ye=nb({measureTextWidth:w,text:Et,maxWidth:Oe,fontParam:Kt,placeholder:fe}),Be=w(Ye,X),De=GS(Tt[pt][ae],X,Be,it,M?1:0),V=c_(e,[],De.text.x,De.text.y,Ye,Kt,{},Et==null?void 0:Et.toString());if(e.addTextShape(V),M&&r){var Yr=M==null?void 0:M.mapping(Et,{rowIndex:pt,colIndex:ae,meta:e==null?void 0:e.getMeta()});if(Yr){var Gr=Pk(e,Zt(Zt({},De.icon),{name:Yr.icon,width:tt==null?void 0:tt.size,height:tt==null?void 0:tt.size,fill:Yr.fill}));e.addConditionIconShape(Gr)}}}},iP=function(e,t){return t===void 0&&(t=1),(e==null?void 0:e.width)*t},lfe=function(e){try{return JSON.parse(e)}catch{return null}},ufe=function(e,t,r){return e.sort(function(n,i){r&&(n=r(n),i=r(i));var a=t.indexOf(n),o=t.indexOf(i);return a===-1&&o===-1?0:a===-1?1:o===-1?-1:a-o})},cfe=function(e){return e===void 0&&(e=[]),e.filter(function(t){return t!==jp&&t!==CN})},hfe=function(e){return Wn(e)?Hit(e):[e]},ffe=function(e,t){var r;return(r=e==null?void 0:e.filter(function(n){return!(t!=null&&t.includes(n))}))===null||r===void 0?void 0:r.concat(t)};function dfe(e,t){var r=e.isRowTotal,n=e.isRowSubTotal,i=e.isColTotal,a=e.isColSubTotal,o=t||{},s=o.row,l=o.col,u=s||{},c=u.calcTotals,f=c===void 0?{}:c,d=u.calcSubTotals,v=d===void 0?{}:d,g=l||{},x=g.calcTotals,w=x===void 0?{}:x,S=g.calcSubTotals,A=S===void 0?{}:S,M=function(R,O){if((R.aggregation||R.calcFunc)&&O)return{aggregation:R.aggregation,calcFunc:R.calcFunc}};return M(w,i)||M(A,a)||M(f,r)||M(v,n)}function HC(e){return e===UA}function _y(e,t,r){return e===void 0&&(e={}),t===void 0&&(t=[]),r===void 0&&(r=jp),t.reduce(function(n,i){var a=e[i];return i in e?n.push(String(a)):n.push(r),n},[])}function rot(e,t){var r=t.filter(function(n){return n in e});return Or(r)&&r.push(CN),r}function dX(e,t,r){e===void 0&&(e={}),t===void 0&&(t=[]);var n=[];function i(a,o,s){return o.reduce(function(l,u){var c=a[u];return u in a?l.push(String(c)):u===Pi&&s?l.push(s):l.push(jp),l},[])}return r?r.forEach(function(a){n.push(i(e,t,a))}):n.push(i(e,t)),n}function pfe(e,t,r){var n,i=t.slice(0,t.indexOf(e)+1);return(n=r.map(function(a){return i.map(function(o){return a[o]}).join("".concat(sc))}))===null||n===void 0?void 0:n.filter(function(a){return a})}function bR(e,t){return e.concat(t).filter(function(r){return r!==Pi}).join(sc)}function ER(e){var t=e.rowDimensionValues,r=e.colDimensionValues,n=e.isFirstCreate,i=e.onFirstCreate,a=e.rowFields,o=e.colFields,s=e.rowPivotMeta,l=e.colPivotMeta,u=e.prefix,c=u===void 0?"":u,f=function(g,x,w,S){for(var A=w,M=[],R=0;R<x.length;R++){var O=x[R];if(n&&A&&!(A!=null&&A.has(O))){var N=x.slice(0,R+1).map(function(tt){return String(tt)}),k=N.join(sc),V=O===jp,Q=void 0;V?Q=0:A.has(jp)?Q=A.size:Q=A.size+1,A.set(O,{id:k,dimensions:N,value:O,level:Q,children:new Map}),i==null||i({dimension:g==null?void 0:g[R],dimensionPath:k,careRepeated:S})}var Y=A==null?void 0:A.get(O);if(M.push(HC(O)?O:Y==null?void 0:Y.level),Y){var X=g==null?void 0:g[R+1];n&&Y.childField!==X&&(Y.childField=X),A=Y==null?void 0:Y.children}}return M},d=f(a,t,s,!1),v=f(o,r,l,!0);return Vr(Vr([c],lr(d),!1),lr(v),!1)}function vfe(e){var t=e.rows,r=e.columns,n=e.values,i=e.valueInCols,a=e.data,o=a===void 0?[]:a,s=e.indexesData,l=s===void 0?{}:s,u=e.sortedDimensionValues,c=e.rowPivotMeta,f=e.colPivotMeta,d=e.getExistValuesByDataItem,v=[],g=new Set(Wit(t,r)),x=function(S){var A=S.dimension,M=S.dimensionPath,R=S.careRepeated,O=R===void 0?!0:R;O&&g.has(A)||(u[A]||(u[A]=[])).push(M)},w=bR(t,r);return o.forEach(function(S){var A,M,R,O;if(!(!S||Or(S))){var N=d?d(S,n):rot(S,n),k=dX(S,t,i?null:N),V=dX(S,r,i?N:null);try{for(var Q=Gf(k),Y=Q.next();!Y.done;Y=Q.next()){var X=Y.value;try{for(var tt=(R=void 0,Gf(V)),it=tt.next();!it.done;it=tt.next()){var Et=it.value,Tt=ER({rowDimensionValues:X,colDimensionValues:Et,rowPivotMeta:c,colPivotMeta:f,rowFields:t,colFields:r,isFirstCreate:!0,onFirstCreate:x,prefix:w});v.push(Tt),kC(l,Tt,S)}}catch(pt){R={error:pt}}finally{try{it&&!it.done&&(O=tt.return)&&O.call(tt)}finally{if(R)throw R.error}}}}catch(pt){A={error:pt}}finally{try{Y&&!Y.done&&(M=Q.return)&&M.call(Q)}finally{if(A)throw A.error}}}}),{paths:v,indexesData:l,rowPivotMeta:c,colPivotMeta:f,sortedDimensionValues:u}}function pX(e,t){if(!(!e||!t)){var r=t.split(sc),n=co(r),i=e;xi(r,function(a,o){var s=i.get(a);return s?(a===n?(s.children=new Map,s.childField=void 0):i=s.children,!0):o===0&&a===Krt})}}function gfe(e,t,r){var n=function(o){var s=zu(e,function(l){var u=l.field;return u===o});return ii(s,"name",o)},i=t||r,a={field:Pi,name:i,formatter:function(o){return n(o)}};return a}function Ww(e,t){return{isRowTotal:e.isGrandTotals,isRowSubTotal:e.isSubTotals,isColTotal:t.isGrandTotals,isColSubTotal:t.isSubTotals}}function mfe(e){for(var t=null,r=0;r<e.length;r++){var n=e[r];if(HC(n))t=r;else if(!Kit(t)&&t<r)return!0}return!1}function not(e){var t=e.pivotMeta,r=e.dimensionValues,n=e.fieldIdx,i=e.queryType,a=e.fields,o=e.sortedDimensionValues,s={children:t},l=[s];function u(d,v){var g,x=kS(d,function(A){var M,R,O=[];try{for(var N=Gf(A.children.values()),k=N.next();!k.done;k=N.next()){var V=k.value;V.value!==CN&&(i===Bf.All||V.value!==jp)&&O.push(V)}}catch(Q){M={error:Q}}finally{try{k&&!k.done&&(R=N.return)&&R.call(N)}finally{if(M)throw M.error}}return O});if(d.length>1){var w=(g=o[v])!==null&&g!==void 0?g:[],S=new Map(w.map(function(A,M){return[A,M]}));return x.sort(function(A,M){return S.get(A.id)-S.get(M.id)}),x}return x}for(var c=function(d){var v=r[d],g=a[d];HC(v)?l=u(l,g):l=l.map(function(x){return x.children.get(v)}).filter(Boolean)},f=0;f<=n;f++)c(f);return l}function vX(e){var t=e.dimensionValues,r=e.pivotMeta,n=e.fields,i=e.sortedDimensionValues,a=e.queryType,o=a===void 0?Bf.All:a;if(!mfe(t))return[t];var s=not({pivotMeta:r,dimensionValues:t,fieldIdx:t.length-1,queryType:o,fields:n,sortedDimensionValues:i});return s.map(function(l){return l.dimensions})}function yfe(e){var t=e.rowFields,r=e.rowDimensionValues,n=e.rowPivotMeta,i=e.colFields,a=e.colDimensionValues,o=e.colPivotMeta,s=e.queryType,l=e.sortedDimensionValues,u=vX({dimensionValues:r,pivotMeta:n,fields:t,sortedDimensionValues:l,queryType:s}),c=vX({dimensionValues:a,pivotMeta:o,fields:i,sortedDimensionValues:l,queryType:s});return{rowQueries:u,colQueries:c}}function _fe(e,t){return e?Wn(e)?kS(e,function(r){if(!Wn(r))return kd([r]);var n=t===Bf.DetailOnly?1:0;return kd(r.slice(n))}):kd([e]):[]}var ZT;function gX(e,t){return!e||!t?!1:String(e).toLowerCase()===String(t).toLowerCase()}var xfe=`\r
`,bfe="	",wR=function(e,t){var r=e.getColumnNodes().find(function(n){return n.id===t});return e.isPivotMode()?r==null?void 0:r.value:r==null?void 0:r.field},Efe=function(e,t){var r=t.getColumnNodes().find(function(n){return n.colIndex===e});return wR(t,r.id)},wfe=function(e,t){var r=e.rowIndex,n=e.colIndex;return[t.getRowNodes().find(function(i){return i.rowIndex===r}),t.getColumnNodes().find(function(i){return i.colIndex===n})]},VC=function(e,t){var r=t.getColumnNodes().find(function(i){return i.colIndex===e}),n=wR(t,r.id);return t.options.interaction.copyWithFormat?t.dataSet.getFieldFormatter(n):function(i){return i}},Cfe=function(e){var t,r,n,i,a=((i=(n=(r=e.options)===null||r===void 0?void 0:r.style)===null||n===void 0?void 0:n.colCfg)===null||i===void 0?void 0:i.hideMeasureColumn)&&e.isValueInCols();return a?(t={},t[Pi]=e.dataCfg.fields.values[0],t):{}},Sfe=function(e,t,r){var n,i;if(r.isPivotMode()){var a=lr(wfe(e,r),2),o=a[0],s=a[1],l=Cfe(r),u=r.dataSet.getCellData({query:Zt(Zt(Zt({},o.query),s.query),l),rowNode:o,isTotals:o.isTotals||o.isTotalMeasure||s.isTotals||s.isTotalMeasure,totalStatus:Ww(o,s)});return(n=u==null?void 0:u[jc])!==null&&n!==void 0?n:""}var c=Efe(e.colIndex,r);return(i=t[e.rowIndex])===null||i===void 0?void 0:i[c]},iot=function(e,t,r){var n=VC(e.colIndex,r);return n(Sfe(e,t,r))},Dk=function(e){return/\n/.test(e)?'"'+e.replace(/\r\n?/g,`
`)+'"':e},GC=function(e,t){var r=e.split(sc);return t?r.slice(r.length-t):(r.shift(),r)},EB=function(e,t){return ia(e,function(r){return t.dataSet.getFieldName(r)})},rs;(function(e){e.PLAIN="text/plain",e.HTML="text/html"})(rs||(rs={}));var Tfe=function(e){return{type:rs.PLAIN,content:ia(e,function(t){return t.join(bfe)}).join(xfe)}},Afe=function(e){function t(n,i){return n.map(function(a){return"<".concat(i,">").concat(ek(a),"</").concat(i,">")}).join("")}function r(n,i){return n.map(function(a){return"<".concat(i,">").concat(t(a,"td"),"</").concat(i,">")}).join("")}return{type:rs.HTML,content:'<meta charset="utf-8"><table><tbody>'.concat(r(e,"tr"),"</tbody></table>")}},Mfe=(ZT={},ZT[rs.PLAIN]=Tfe,ZT[rs.HTML]=Afe,ZT);function Jc(e){return Mfe[e]}function Rfe(e,t){return t===void 0&&(t=rs.PLAIN),Array.isArray(t)?[].concat(e).filter(function(r){return t.includes(r.type)}).map(function(r){return r.content}):[].concat(e).filter(function(r){return(r==null?void 0:r.type)===t}).map(function(r){return r.content})[0]||""}var aot=function(e,t,r){var n,i,a,o,s,l,u=(i=(n=e[0])===null||n===void 0?void 0:n.length)!==null&&i!==void 0?i:0,c=(a=t==null?void 0:t.length)!==null&&a!==void 0?a:0,f=(s=(o=r[0])===null||o===void 0?void 0:o.length)!==null&&s!==void 0?s:0,d=(l=r.length)!==null&&l!==void 0?l:0,v=u+f,g=c+d,x=Array.from(Array(g),function(){return new Array(v)});return x=ia(x,function(w,S){return ia(w,function(A,M){if(M>=0&&M<u&&S>=0&&S<c)return"";if(M>=u&&M<=v&&S>=0&&S<c)return t[S][M-u];if(M>=0&&M<u&&S>=c&&S<g)return e[S-c][M];if(M>=u&&M<=v&&S>=c&&S<g)return r[S-c][M-u]})}),[Jc(rs.PLAIN)(x),Jc(rs.HTML)(x)]},Ife=function(e,t,r){var n=t.map(function(i){return i.map(function(a){return a?Dk(iot(a,e,r)):""})});return[Jc(rs.PLAIN)(n),Jc(rs.HTML)(n)]},Lfe=function(e){if(!(e!=null&&e.length))return[];var t=lr([{row:1/0,col:1/0},{row:0,col:0}],2),r=t[0],n=t[1];e.forEach(function(l){var u=l.rowIndex,c=l.colIndex;r.col=Math.min(c,r.col),r.row=Math.min(u,r.row),n.col=Math.max(c,n.col),n.row=Math.max(u,n.row)});var i=lr([n.row-r.row+1,n.col-r.col+1],2),a=i[0],o=i[1],s=new Array(a).fill("").map(function(){return new Array(o).fill("")});return e.forEach(function(l){var u=l.rowIndex,c=l.colIndex,f=lr([u-r.row,c-r.col],2),d=f[0],v=f[1];s[d][v]=l}),s},Ofe=function(e,t){var r=e.dataSet.getDisplayDataSet(),n=t.length?t.map(function(a){return{field:wR(e,a.id),formatter:VC(a.colIndex,e)}}):e.dataCfg.fields.columns.map(function(a){return e.getColumnNodes().find(function(o){return o.field===a})}).map(function(a){return{field:wR(e,a.id),formatter:VC(a.colIndex,e)}}),i=r.map(function(a){return n.map(function(o){var s=o.field,l=o.formatter;return Dk(l(a[s]))})});return[Jc(rs.PLAIN)(i),Jc(rs.HTML)(i)]},oot=function(e,t,r){return ia(e,function(n){return t.map(function(i){var a,o=r.dataSet.getCellData({query:Zt(Zt({},n.query),i.query),rowNode:n,isTotals:n.isTotals||n.isTotalMeasure||i.isTotals||i.isTotalMeasure,totalStatus:Ww(n,i)});return VC(i.colIndex,r)((a=o==null?void 0:o[jc])!==null&&a!==void 0?a:"")})})},Pfe=function(e,t,r){var n=oot(t,r,e);return[Jc(rs.PLAIN)(n),Jc(rs.HTML)(n)]},Dfe=function(e,t,r){var n=ia(t,function(o){return GC(o.id)}),i=p3.apply(void 0,Vr([],lr(ia(r,function(o){return GC(o.id)})),!1)),a=oot(t,r,e);return aot(n,i,a)};function sot(e,t,r){var n=e.options.interaction.copyWithHeader;return n?Dfe(e,t,r):Pfe(e,t,r)}var Ffe=function(e,t){var r=e.getRowNodes().filter(function(a){return a.isLeaf||e.isHierarchyTreeType()}),n=e.getColumnNodes().filter(function(a){return a.isLeaf}),i=t.length?t.reduce(function(a,o){return a.push.apply(a,Vr([],lr(n.filter(function(s){return s.id.startsWith(o.id)})),!1)),a},[]):n;return sot(e,r,i)},mX=function(e,t,r){return t.isPivotMode()?Ffe(t,r):Ofe(t,r)},Bfe=function(e,t){var r=e.dataSet.getDisplayDataSet(),n=r.filter(function(i,a){return t.map(function(o){return o.rowIndex}).includes(a)}).map(function(i){var a=e.getColumnNodes().reduce(function(o,s,l){return o[s.field]=l,o},{});return Object.keys(i).sort(function(o,s){return a[o]-a[s]}).map(function(o){return e.getColumnNodes().find(function(s){return s.field===o})}).filter(Boolean).map(function(o){return Dk(VC(o.colIndex,e)(i[o.field]))})});return[Jc(rs.PLAIN)(n),Jc(rs.HTML)(n)]},Nfe=function(e,t){var r=e.getRowNodes().filter(function(a){return a.isLeaf||e.isHierarchyTreeType()}),n=e.getColumnNodes().filter(function(a){return a.isLeaf}),i=t.reduce(function(a,o){return a.push.apply(a,Vr([],lr(r.filter(function(s){return s.id.startsWith(o.id)})),!1)),a},[]);return sot(e,i,n)},kfe=function(e,t,r){return t.isPivotMode()?Nfe(t,r):Bfe(t,r)},zfe=function(e,t,r){var n=p3.apply(void 0,Vr([],lr(ia(e[0],function(o){var s,l=(o==null?void 0:o.colId)||co((s=o==null?void 0:o.id)===null||s===void 0?void 0:s.split(YF))||"";return EB(GC(l),r)})),!1)),i=ia(e,function(o){var s,l,u,c=((s=o==null?void 0:o[0])===null||s===void 0?void 0:s.rowId)||u_((u=(l=o==null?void 0:o[0])===null||l===void 0?void 0:l.id)===null||u===void 0?void 0:u.split(YF))||"";return EB(GC(c),r)}),a=ia(e,function(o){return ia(o,function(s){return iot(s,t,r)})});return aot(i,n,a)};function Ufe(e){var t=new Set;return xi(e,function(r){var n=r.getMeta().level;t.has(n)||t.add(n)}),t}function $fe(e,t){return Eg(e,function(r){var n=r.getMeta(),i=n.level===t,a=n.isTotals&&Or(n.children);return i||a})}function Hfe(e,t){for(var r=e,n={level:t},i=r.label;r.level>=0;){for(var a=n.level-r.level;a>0;)i="".concat(r.label).concat(sc).concat(i),a--;n=r,r=r.parent}return i}function Vfe(e,t,r){return ia(e,function(n){var i=n.getMeta(),a=i.id,o=i.isTotals,s=i.spreadsheet,l=o?Hfe(i,t):a,u=GC(l,r.size);return EB(u,s)})}function Gfe(e){var t,r=Ufe(e),n=(t=tb(Array.from(r)))!==null&&t!==void 0?t:0,i=$fe(e,n),a=e[0].cellType===Br.COL_CELL,o=Vfe(i,n,r);return a&&(o=p3.apply(void 0,Vr([],lr(o),!1))),[Jc(rs.PLAIN)(o),Jc(rs.HTML)(o)]}var Wfe=function(e,t,r){return ia(t,function(n){var i;return(i=e[n])!==null&&i!==void 0?i:r})},Xfe=function(e,t){var r=e.options.placeholder,n=e.dataCfg.fields,i=n.rows,a=n.columns,o=n.values,s=O_(e,r),l=e.getColumnLeafNodes(),u=[];if(e.isTableMode()){var c=Eg(l,function(g){return g.field!==n_});u=ia(t,function(g){return ia(c,function(x){var w;return(w=g==null?void 0:g[x.field])!==null&&w!==void 0?w:s})})}else if(e.isPivotMode()){var f=Vr(Vr(Vr([],lr(i),!1),lr(a),!1),lr(o),!1),d=hfe(t),v=d.filter(function(g){return Vr(Vr([],lr(i),!1),lr(a),!1).every(function(x){return!bl(g[x])})});u=h3(v,function(g,x){return Vr(Vr([],lr(g),!1),[Wfe(x,f,s)],!1)},[])}return[Jc(rs.PLAIN)(u),Jc(rs.HTML)(u)]};function jfe(e,t){var r,n,i=t.filter(function(c){var f=c.type;return f===Br.COL_CELL}),a=t.filter(function(c){var f=c.type;return f===Br.ROW_CELL}),o=e.dataSet.getDisplayDataSet();if(e.interaction.getCurrentStateName()===On.ALL_SELECTED)n=mX(o,e,[]);else if(i.length)n=mX(o,e,i);else if(a.length)n=kfe(o,e,a);else{if(!t.length)return;var s=Lfe(t),l=e.interaction.getSelectedCellHighlight().currentRow;if(l){var u=vk(t,"rowIndex","asc").map(function(c){return e.dataSet.getRowData(c)});n=Xfe(e,u)}else!((r=e.options.interaction)===null||r===void 0)&&r.copyWithHeader?n=zfe(s,o,e):n=Ife(o,s,e)}return n}var Yfe=function(e){var t,r=e.interaction,n=r.getState().cells||[],i,a=(t=r.getInteractedCells())!==null&&t!==void 0?t:[],o=Or(a)?!1:i3(a,function(s){return s.cellType===Br.ROW_CELL||s.cellType===Br.COL_CELL});return o?i=Gfe(a):i=jfe(e,n),i&&qfe(i),Rfe(i,rs.PLAIN)},lot=function(e){return new Promise(function(t,r){var n;Array.isArray(e)?n=ii(e.filter(function(o){return o.type===rs.PLAIN}),"[0].content",""):n=e.content||"";var i=document.createElement("textarea");i.value=n,document.body.appendChild(i),i.focus({preventScroll:!0}),i.select();var a=document.execCommand("copy");document.body.removeChild(i),a?t():r()})},Zfe=function(e){return navigator.clipboard.write([new ClipboardItem([].concat(e).reduce(function(t,r){var n,i=r.type,a=r.content,o=a.replace(/\x00/g,"");return Zt(Zt({},t),(n={},n[i]=new Blob([o],{type:i}),n))},{}))]).catch(function(){return lot(e)})},qfe=function(e,t){t===void 0&&(t=!1);var r;return typeof e=="string"?r={content:e,type:rs.PLAIN}:r=e,!navigator.clipboard||!window.ClipboardItem||t?lot(r):Zfe(r)},Fk=function(e,t,r){var n,i=e.split(sc);if(r)n=[e];else{n=[$C(i[0],i[1])];for(var a=2;a<i.length;a+=1)n.push($C(n[a-2],i[a]))}var o=Eg(t,function(s){var l;return n.includes((l=s.getMeta())===null||l===void 0?void 0:l.id)});return o},uot=function(e,t,r){if(e){var n=Fk(e,t);xi(n,function(i){i.updateByState(r)})}},Kfe=function(e,t){return typeof e=="function"?e(t):e.some(function(r){return r===t.key||r===t.id||r===t.valueField})},Mp=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=function(i,a){if(Wn(i)&&Wn(a))return a},n=Vr(Vr([],lr(e),!1),[r],!1);return QN.apply(void 0,Vr([{}],lr(n),!1))},Qfe=function(e){var t=["rows","columns","values"],r=t.reduce(function(n,i){var a=e[i],o=jv(a);return cu(o,a)||console.warn("fields.".concat(i,":[").concat(a,"] should be unique")),n[i]=o,n},{});return Zt(Zt({},e),r)},aP=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=Mp.apply(void 0,Vr([Jjt],lr(e),!1));return r.fields=Qfe(r.fields),(!Or(r.fields.customTreeItems)||Or(r.fields.values))&&(r.fields.valueInCols=!1),r},yX=function(e){return Mp(aYt,e)},y3=function(e){en(t,e);function t(r,n){for(var i=[],a=2;a<arguments.length;a++)i[a-2]=arguments[a];var o=e.call(this,{})||this;return o.textShapes=[],o.actualTextWidth=0,o.conditionIconShapes=[],o.stateShapes=new Map,o.meta=r,o.spreadsheet=n,o.theme=n.theme,o.conditions=o.spreadsheet.options.conditions,o.handleRestOptions.apply(o,Vr([],lr(i),!1)),o.shouldInit()&&o.initCell(),o}return t.prototype.getMeta=function(){return this.meta},t.prototype.setMeta=function(r){this.meta=Mp(this.meta,r)},t.prototype.getIconStyle=function(){return this.theme[this.cellType].icon},t.prototype.getTextAndIconPosition=function(r){r===void 0&&(r=1);var n=this.getTextStyle(),i=this.getIconStyle();return GS(this.getContentArea(),n,this.actualTextWidth,i,r)},t.prototype.getActualText=function(){return this.actualText},t.prototype.isTextOverflowing=function(){var r=this.getActualText();return r?oc(r,vx):r!==this.getFieldValue()},t.prototype.getFieldValue=function(){var r=this.getFormattedFieldValue().formattedValue;return r===T_?this.getActualText():r},t.prototype.handleRestOptions=function(){},t.prototype.shouldInit=function(){var r=this.meta,n=r.width,i=r.height;return n>0&&i>0},t.prototype.getStyle=function(r){return ii(this.theme,r||this.cellType)},t.prototype.getResizeAreaStyle=function(){return this.getStyle("resizeArea")},t.prototype.shouldDrawResizeAreaByType=function(r,n){var i=this.spreadsheet.options.interaction.resize;return Dp(i)?i:hu(i.visible)?i.visible(n):i[r]},t.prototype.getCellArea=function(){var r=this.meta,n=r.x,i=r.y,a=r.height,o=r.width;return{x:n,y:i,height:a,width:o}},t.prototype.getContentArea=function(){var r=this.getStyle()||this.theme.dataCell,n=(r==null?void 0:r.cell).padding;return tot(this.getCellArea(),n)},t.prototype.getIconPosition=function(r){return r===void 0&&(r=1),this.getTextAndIconPosition(r).icon},t.prototype.drawTextShape=function(){var r=this.getFormattedFieldValue().formattedValue,n=this.getMaxTextWidth(),i=this.getTextStyle(),a=this.spreadsheet,o=a.options.placeholder,s=a.measureTextWidth,l=O_(this,o),u=nb({measureTextWidth:s,text:r,maxWidth:n,fontParam:i,placeholder:l});this.actualText=u,this.actualTextWidth=s(u,i);var c=this.getTextPosition();this.textShape=c_(this,[this.textShape],c.x,c.y,u,i),this.textShapes.push(this.textShape)},t.prototype.drawLinkFieldShape=function(r,n){if(r){var i=this.spreadsheet.options.style.device;if(!Bl(i)){var a=this.getTextStyle(),o=this.getTextPosition(),s=o.x;a.textAlign==="center"?s-=this.actualTextWidth/2:a.textAlign==="right"&&(s-=this.actualTextWidth);var l=this.textShape.getBBox().maxY;this.linkFieldShape=lu(this,{x1:s,y1:l+1,x2:s+this.actualTextWidth,y2:l+1},{stroke:n,lineWidth:1})}this.textShape.attr({fill:n,cursor:"pointer",appendInfo:{isLinkFieldText:!0,cellData:this.meta}})}},t.prototype.getLinkFieldStyle=function(){return this.getTextStyle().linkTextFill},t.prototype.drawLinkField=function(r){var n=this.spreadsheet.options.interaction.linkFields,i=n===void 0?[]:n,a=this.getLinkFieldStyle(),o=Kfe(i,r);this.drawLinkFieldShape(o,a)},t.prototype.updateByState=function(r,n){var i=this;this.spreadsheet.interaction.setInteractedCells(n);var a=ii(this.theme,"".concat(this.cellType,".cell.interactionState.").concat(r));xi(a,function(o,s){var l=xs(pk(tYt,function(u){return oc(u,s)}));l.forEach(function(u){var c=i.stateShapes.has(u),f=c?i.stateShapes.get(u):i[u],d=Wn(f)?f:[f];if(c&&d.forEach(function(g){g.set("visible",!0)}),u==="interactiveBorderShape"&&s==="borderWidth"&&nc(o)){var v=i.getInteractiveBorderShapeStyle(o);xi(v,function(g,x){Tf(d,x,g)})}Tf(d,Mh[s],o)})})},t.prototype.getInteractiveBorderShapeStyle=function(r){var n=this.getCellArea(),i=n.x,a=n.y,o=n.height,s=n.width,l=this.theme.dataCell.cell,u=l.horizontalBorderWidth,c=l.verticalBorderWidth;return{x:i+c/2+r/2,y:a+u/2+r/2,width:s-c-r,height:o-u-r}},t.prototype.hideInteractionShape=function(){this.stateShapes.forEach(function(r){Tf(r,Mh.backgroundOpacity,0),Tf(r,Mh.backgroundColor,"transparent"),Tf(r,Mh.borderOpacity,0),Tf(r,Mh.borderWidth,1),Tf(r,Mh.borderColor,"transparent")})},t.prototype.clearUnselectedState=function(){Tf(this.backgroundShape,Mh.backgroundOpacity,1),Tf(this.textShapes,Mh.textOpacity,1),Tf(this.linkFieldShape,Mh.opacity,1)},t.prototype.getTextShape=function(){return this.textShape},t.prototype.getTextShapes=function(){return this.textShapes||[this.textShape]},t.prototype.addTextShape=function(r){r&&this.textShapes.push(r)},t.prototype.getConditionIconShape=function(){return this.conditionIconShape},t.prototype.getConditionIconShapes=function(){return this.conditionIconShapes||[this.conditionIconShape]},t.prototype.addConditionIconShape=function(r){r&&this.conditionIconShapes.push(r)},t.prototype.resetTextAndConditionIconShapes=function(){this.textShapes=[],this.conditionIconShapes=[]},Object.defineProperty(t.prototype,"cellConditions",{get:function(){return this.conditions},enumerable:!1,configurable:!0}),t.prototype.drawConditionIconShapes=function(){var r,n=this.findFieldCondition((r=this.conditions)===null||r===void 0?void 0:r.icon);if(n&&n.mapping){var i=this.mappingValue(n),a=this.getIconPosition(),o=this.theme.dataCell.icon.size;Or(i==null?void 0:i.icon)||(this.conditionIconShape=Pk(this,Zt(Zt({},a),{name:i.icon,width:o,height:o,fill:i.fill})),this.addConditionIconShape(this.conditionIconShape))}},t.prototype.getTextConditionFill=function(r){var n,i,a=r.fill,o=this.findFieldCondition((n=this.conditions)===null||n===void 0?void 0:n.text);return o!=null&&o.mapping&&(a=((i=this.mappingValue(o))===null||i===void 0?void 0:i.fill)||r.fill),a},t.prototype.getCrossBackgroundColor=function(r){var n=this.getStyle().cell,i=n.crossBackgroundColor,a=n.backgroundColorOpacity;return i&&r%2===0?{backgroundColorOpacity:a,backgroundColor:i}:{backgroundColorOpacity:a,backgroundColor:this.getStyle().cell.backgroundColor}},t}(tv),cot=function(e,t){return t?t(e[Pi],e[jc]):e[jc]},My=function(e,t){var r=t.getMeta().id;return e.some(function(n){return cu(n.id,r)})},WS=function(e,t){return"".concat(e).concat(YF).concat(t)},Jfe=function(e){var t=e.interaction.getSelectedCellHighlight(),r=t.currentRow,n=t.currentCol,i=t.rowHeader,a=t.colHeader;return r||n||i||a},Bk=function(e){return e.type===Br.DATA_CELL},tde=function(e,t){xi(e,function(r){Bk(r)&&r.rowIndex===t.getMeta().rowIndex&&t.updateByState(On.SELECTED)})},ede=function(e,t){xi(e,function(r){Bk(r)&&r.colIndex===t.getMeta().colIndex&&t.updateByState(On.SELECTED)})},rde=function(e,t){xi(e,function(r){Bk(r)&&r.rowIndex===t.getMeta().rowIndex&&r.colIndex===t.getMeta().colIndex&&t.updateByState(On.SELECTED)})},nde=function(e,t,r){var n=r.interaction.getSelectedCellHighlight(),i=n.rowHeader,a=n.colHeader,o=n.currentRow,s=n.currentCol,l=t.cellType===Br.ROW_CELL,u=r.isTableMode()&&r.options.showSeriesNumber&&i&&l;(o||u)&&tde(e,t),s&&ede(e,t),(i||a)&&rde(e,t)},_0=function(e){en(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return Object.defineProperty(t.prototype,"cellType",{get:function(){return Br.DATA_CELL},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"valueRangeByField",{get:function(){return this.spreadsheet.dataSet.getValueRangeByField(this.meta.valueField)},enumerable:!1,configurable:!0}),t.prototype.handleByStateName=function(r,n){My(r,this)&&this.updateByState(n)},t.prototype.handleSearchResult=function(r){if(My(r,this)){var n=zu(r,function(i){return i==null?void 0:i.isTarget});n.id===this.getMeta().id?this.updateByState(On.HIGHLIGHT):this.updateByState(On.SEARCH_RESULT)}},t.prototype.handleSelect=function(r){var n,i=(n=r==null?void 0:r[0])===null||n===void 0?void 0:n.type;switch(i){case Br.COL_CELL:this.changeRowColSelectState("colIndex");break;case Br.ROW_CELL:this.changeRowColSelectState("rowIndex");break;case Br.DATA_CELL:Jfe(this.spreadsheet)?nde(r,this,this.spreadsheet):My(r,this)?this.updateByState(On.SELECTED):this.spreadsheet.options.interaction.selectedCellsSpotlight&&this.updateByState(On.UNSELECTED);break}},t.prototype.handleHover=function(r){var n=u_(r);if(n.type!==Br.DATA_CELL){this.hideInteractionShape();return}var i=this.spreadsheet.interaction.getHoverHighlight(),a=i.currentRow,o=i.currentCol;if(a||o){var s=this.meta.colIndex,l=this.meta.rowIndex;o&&s===(n==null?void 0:n.colIndex)||a&&l===(n==null?void 0:n.rowIndex)?this.updateByState(On.HOVER):this.hideInteractionShape()}var u=this.getMeta(),c=u.id,f=u.rowIndex,d=u.colIndex;cu(n.id,c)&&cu(n.rowIndex,f)&&cu(n.colIndex,d)&&this.updateByState(On.HOVER_FOCUS)},t.prototype.update=function(){var r=this.spreadsheet.interaction.getCurrentStateName(),n=this.spreadsheet.interaction.getCells();if(r===On.ALL_SELECTED){this.updateByState(On.SELECTED);return}if(!(Or(n)||!r))switch(r){case On.SELECTED:this.handleSelect(n);break;case On.HOVER_FOCUS:case On.HOVER:this.handleHover(n);break;case On.SEARCH_RESULT:this.handleSearchResult(n);break;default:this.handleByStateName(n,r);break}},t.prototype.setMeta=function(r){e.prototype.setMeta.call(this,r),this.initCell()},t.prototype.drawTextShape=function(){e.prototype.drawTextShape.call(this),this.drawLinkField(this.meta)},t.prototype.initCell=function(){this.resetTextAndConditionIconShapes(),this.drawBackgroundShape(),this.drawInteractiveBgShape(),this.shouldHideRowSubtotalData()||(this.drawConditionIntervalShape(),this.drawTextShape(),this.drawConditionIconShapes()),this.drawInteractiveBorderShape(),this.meta.isFrozenCorner&&this.drawBorderShape(),this.update()},t.prototype.getDefaultTextFill=function(r){var n=r.fill,i=this.getBackgroundColor(),a=i.backgroundColor,o=i.intelligentReverseTextColor;return kat(a)&&(n===Jrt||!Mce(a,n))&&o&&(n=ZF),n},t.prototype.getTextStyle=function(){var r=this.meta.isTotals,n=r?this.theme.dataCell.bolderText:this.theme.dataCell.text,i=this.getTextConditionFill(Zt(Zt({},n),{fill:this.getDefaultTextFill(n)}));return Zt(Zt({},n),{fill:i})},t.prototype.getIconStyle=function(){return qat(this.conditions,this.theme.dataCell.icon,this.meta.valueField)},t.prototype.drawConditionIntervalShape=function(){this.conditionIntervalShape=qhe(this)},t.prototype.shouldHideRowSubtotalData=function(){var r,n=this.meta,i=n.rowId,a=n.rowIndex,o=this.spreadsheet.store.get("drillDownIdPathMap");if(o!=null&&o.has(i))return!1;var s=((r=this.spreadsheet.options.totals)!==null&&r!==void 0?r:{}).row,l=s===void 0?{}:s,u=this.spreadsheet.facet.layoutResult.rowLeafNodes[a],c=!(u!=null&&u.isGrandTotals)&&(u==null?void 0:u.isTotals);return this.spreadsheet.options.hierarchyType==="tree"&&!l.showSubTotals&&c},t.prototype.getFormattedFieldValue=function(){var r;if(this.shouldHideRowSubtotalData())return{value:null,formattedValue:VI};var n=this.meta,i=n.rowId,a=n.valueField,o=n.fieldValue,s=n.data,l=n.id,u=(r=this.spreadsheet.dataSet.displayFormattedValueMap)===null||r===void 0?void 0:r.get(l),c=this.spreadsheet.dataSet.getFieldMeta(i),f=c?i:a,d=this.spreadsheet.dataSet.getFieldFormatter(f),v=u??d(o,s,this.meta);return{value:o,formattedValue:v}},t.prototype.getMaxTextWidth=function(){var r=this.getContentArea().width,n=this.getIconStyle();return eot(r,n)},t.prototype.getTextPosition=function(){return this.getTextAndIconPosition().text},t.prototype.getBackgroundColor=function(){var r,n=this.getCrossBackgroundColor(this.meta.rowIndex),i=n.backgroundColor,a=n.backgroundColorOpacity;if(this.shouldHideRowSubtotalData())return{backgroundColor:i,backgroundColorOpacity:a};var o=this.findFieldCondition((r=this.conditions)===null||r===void 0?void 0:r.background),s=!1;if(o&&o.mapping){var l=this.mappingValue(o);l&&(i=l.fill,s=l.intelligentReverseTextColor,a=1)}return{backgroundColor:i,backgroundColorOpacity:a,intelligentReverseTextColor:s}},t.prototype.drawBackgroundShape=function(){var r=this.getBackgroundColor(),n=r.backgroundColor,i=r.backgroundColorOpacity;this.backgroundShape=Fh(this,Zt(Zt({},this.getCellArea()),{fill:n,fillOpacity:i}))},t.prototype.drawInteractiveBorderShape=function(){var r=1,n=this.getCellArea(),i=n.x,a=n.y,o=n.height,s=n.width;this.stateShapes.set("interactiveBorderShape",Fh(this,{x:i+r,y:a+r,width:s-r*2,height:o-r*2},{capture:!1,visible:!1}))},t.prototype.drawInteractiveBgShape=function(){this.stateShapes.set("interactiveBgShape",Fh(this,Zt({},this.getCellArea()),{visible:!1}))},t.prototype.changeRowColSelectState=function(r){var n=this.spreadsheet.interaction,i=ii(this.meta,r),a=n.getState(),o=a.nodes,s=o===void 0?[]:o,l=a.cells,u=l===void 0?[]:l,c=!1;if(this.spreadsheet.isTableMode()&&s.length){var f=s[0].hierarchy.getLeaves();c=f.some(function(d,v){return s.some(function(g){return g===d})?v===i:!1})}else c=Vr(Vr([],lr(s),!1),lr(u),!1).some(function(d){return ii(d,r)===i});c?this.updateByState(On.SELECTED):this.spreadsheet.options.interaction.selectedCellsSpotlight?this.updateByState(On.UNSELECTED):this.hideInteractionShape()},t.prototype.drawBorderShape=function(){var r=this;[vl.BOTTOM,vl.RIGHT].forEach(function(n){var i=h_(n,r.getCellArea(),r.getStyle().cell),a=i.position,o=i.style;lu(r,a,o)})},t.prototype.findFieldCondition=function(r){return Zat(r,this.meta.valueField)},t.prototype.mappingValue=function(r){var n=this.meta.fieldValue,i=this.spreadsheet.isTableMode()?this.spreadsheet.dataSet.getCellData({query:{rowIndex:this.meta.rowIndex}}):this.meta.data;return r==null?void 0:r.mapping(n,i)},t.prototype.updateByState=function(r){if(e.prototype.updateByState.call(this,r,this),r===On.UNSELECTED){var n=ii(this.theme,"".concat(this.cellType,".cell.interactionState.").concat(r));n&&this.toggleConditionIntervalShapeOpacity(n.opacity)}},t.prototype.clearUnselectedState=function(){e.prototype.clearUnselectedState.call(this),this.toggleConditionIntervalShapeOpacity(1)},t.prototype.toggleConditionIntervalShapeOpacity=function(r){Tf(this.conditionIntervalShape,Mh.backgroundOpacity,r),Tf(this.conditionIconShapes,Mh.opacity,r)},t.prototype.drawLeftBorder=function(){var r=h_(vl.LEFT,this.getCellArea(),this.getStyle().cell),n=r.position,i=r.style;lu(this,n,i)},t}(y3),ide=function(e){en(t,e);function t(r,n,i){return e.call(this,i,r,n)||this}return t.prototype.handleRestOptions=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i=lr(r,1),a=i[0];this.cells=a},Object.defineProperty(t.prototype,"cellType",{get:function(){return Br.MERGED_CELL},enumerable:!1,configurable:!0}),t.prototype.update=function(){},t.prototype.initCell=function(){this.resetTextAndConditionIconShapes(),this.conditions=this.spreadsheet.options.conditions,this.drawBackgroundShape(),this.drawTextShape()},t.prototype.drawBackgroundShape=function(){var r=lde(this.cells),n=this.theme.dataCell.cell;this.backgroundShape=Hhe(this,{points:r,stroke:n.horizontalBorderColor,fill:n.backgroundColor,lineHeight:n.horizontalBorderWidth})},t.prototype.drawTextShape=function(){Or(this.meta)||(Ja(this.meta.fieldValue)?sfe(this):e.prototype.drawTextShape.call(this))},t}(_0),ade=function(e,t,r,n){var i=[e,t],a=[e+r,t],o=[e+r,t+n],s=[e,t+n];return[[i,a],[a,o],[o,s],[s,i]]},ode=function(e){var t=[];return xi(e,function(r){var n=[r[1],r[0]];JSON.stringify(e).includes(JSON.stringify(n))||t.push(r)}),t},sde=function(e,t){return zu(t,function(r){return cu(r[0],e[1])})},lde=function(e){var t=[];e.forEach(function(o){var s=o.getMeta(),l=s.x,u=s.y,c=s.width,f=s.height;t=t.concat(ade(l,u,c,f))}),t=ode(t);for(var r=[],n=t[0],i=n,a=[];!cu(n,a);)r=r.concat(i),a=sde(i,t),i=a;return r},ude=function(e,t){var r=[],n;return xi(e,function(i){var a,o,s,l=(o=(a=t==null?void 0:t.facet)===null||a===void 0?void 0:a.layoutResult)===null||o===void 0?void 0:o.getCellMeta(i.rowIndex,i.colIndex);if(l){var u=(s=t==null?void 0:t.facet)===null||s===void 0?void 0:s.cfg.dataCell(l);n=i!=null&&i.showText?l:n,r.push(u)}}),{cells:r,cellsMeta:n}},cde=function(e,t){var r=[],n=[],i;return xi(e,function(a){var o=zu(t,function(s){var l,u=(l=s==null?void 0:s.getMeta)===null||l===void 0?void 0:l.call(s);if((u==null?void 0:u.colIndex)===(a==null?void 0:a.colIndex)&&(u==null?void 0:u.rowIndex)===(a==null?void 0:a.rowIndex))return s});o?(r.push(o),i=a!=null&&a.showText?o==null?void 0:o.getMeta():i):n.push(a)}),{cells:r,invisibleCellInfo:n,cellsMeta:i}},hot=function(e,t,r){var n;r===void 0&&(r=[]);var i=cde(r,e),a=i.cellsMeta,o=i.cells,s=i.invisibleCellInfo,l=a,u=o,c=(s==null?void 0:s.length)>0&&s.length<r.length;if(c){var f=ude(s,t),d=f.cells,v=f.cellsMeta;l=l||v,u=o.concat(d)}return!Or(o)&&!l&&(l=(n=u[0])===null||n===void 0?void 0:n.getMeta()),{cells:u,viewMeta:l}},hde=function(e){var t=e.interaction,r=t.getActiveCells(),n=[];return xi(r,function(i,a){var o=i.getMeta(),s=a===0?{showText:!0}:{};n.push(Zt(Zt({},s),{colIndex:o==null?void 0:o.colIndex,rowIndex:o==null?void 0:o.rowIndex}))}),n},fot=function(e,t,r){var n;return!((n=e.options)===null||n===void 0)&&n.mergedCell?e.options.mergedCell(e,t,r):new ide(e,t,r)},fde=function(e,t,r){var n,i=t||hde(e);if((i==null?void 0:i.length)<=1){console.error("[mergeCell]: The merged cells must be more than one!");return}var a=e.interaction.getPanelGroupAllDataCells(),o=hot(a,e,i),s=o.cells,l=o.viewMeta;if(!Or(s)){var u=((n=e.options)===null||n===void 0?void 0:n.mergedCellsInfo)||[];u.push(i),e.setOptions({mergedCellsInfo:u});var c=r?void 0:l;e.panelScrollGroup.addMergeCell(fot(e,s,c))}},dde=function(e,t){var r=ia(e.cells,function(n){return{colIndex:n.getMeta().colIndex,rowIndex:n.getMeta().rowIndex}});return Eg(t,function(n){var i=n.map(function(a){return a.showText?{colIndex:a.colIndex,rowIndex:a.rowIndex}:a});return!cu(i,r)})},pde=function(e,t){var r,n,i;if(!t||t.cellType!==Br.MERGED_CELL){console.error("[unmergeCell]: The ".concat(t," is not a MergedCell"));return}var a=dde(t,(r=e.options)===null||r===void 0?void 0:r.mergedCellsInfo);(a==null?void 0:a.length)!==((i=(n=e.options)===null||n===void 0?void 0:n.mergedCellsInfo)===null||i===void 0?void 0:i.length)&&(e.setOptions({mergedCellsInfo:a}),t.remove(!0))},vde=function(e){return ia(e,function(t){return{cells:t.cells,viewMeta:t.getMeta()}})},_X=function(e,t){return Mit(e,t,function(r,n){return cu(r.viewMeta.id,n.viewMeta.id)})},gde=function(e,t){var r,n=(r=e.options)===null||r===void 0?void 0:r.mergedCellsInfo;if(!Or(n)){var i=e.interaction.getPanelGroupAllDataCells();if(!Or(i)){var a=[];n.forEach(function(c){var f=hot(i,e,c);f.cells.length>0&&a.push(f)});var o=t.getChildren(),s=vde(o),l=_X(s,a),u=_X(a,s);xi(l,function(c){var f=zu(o,function(d){return cu(d.getMeta().id,c.viewMeta.id)});f==null||f.remove(!0)}),xi(u,function(c){var f=c.cells,d=c.viewMeta;t.add(fot(e,f,d))})}}},dot=function(e){var t=e.includes(sc)?"id":"field";return t},wB=function(e,t){t===void 0&&(t=[]);var r=e.getInitColumnLeafNodes();return kd(t.map(function(n){var i=dot(n);return r.find(function(a){return a[i]===n})}))},mde=function(e,t){if(t===void 0&&(t=[]),Or(t))return{prev:null,next:null};var r=e.getInitColumnLeafNodes(),n=wB(e,t).map(function(l){return l==null?void 0:l.colIndex}),i=Math.max.apply(Math,Vr([],lr(n),!1)),a=Math.min.apply(Math,Vr([],lr(n),!1)),o=r.find(function(l){return l.colIndex===i+1}),s=r.find(function(l){return l.colIndex===a-1});return{prev:s||null,next:o||null}},yde=function(e,t){if(Or(t))return[];var r=Number.NEGATIVE_INFINITY;return e.reduce(function(n,i,a){if(!t.includes(i))return n;if(a===r+1){var o=co(n);o.push(i)}else{var s=[i];n.push(s)}return r=a,n},[])},xX=function(e,t,r){t===void 0&&(t=[]),r===void 0&&(r=!1);var n=function(f,d){f===void 0&&(f=[]),d===void 0&&(d=[]),e.setOptions({interaction:{hiddenColumnFields:f}}),e.interaction.reset(),e.store.set("hiddenColumnsDetail",d),e.render(!1,{reBuildHiddenColumnsDetail:!1})};if(Or(t)&&r){n();return}var i=e.store.get("hiddenColumnsDetail",[]),a=e.options.interaction.hiddenColumnFields;if(!(cu(t,a)&&!r)){var o=jv(Vr(Vr([],lr(t),!1),lr(a),!1)),s=wB(e,o).every(function(f,d,v){var g=v[d+1];return!g||Math.abs(f.colIndex-g.colIndex)===1}),l=mde(e,s?o:t),u={hideColumnNodes:wB(e,t),displaySiblingNode:l},c=Vr(Vr([],lr(i),!1),[u],!1);e.emit(Me.LAYOUT_COLS_HIDDEN,u,c),n(o,c)}},_de=function(e){var t=e.dataCfg.fields.columns,r=t===void 0?[]:t;return e.isTableMode()?r:e.getInitColumnLeafNodes().map(function(n){var i=n.id;return i})},Nk=function(e,t,r){t===void 0&&(t=[]),r===void 0&&(r=!1),Or(t)&&r&&xX(e,t,!0);var n=_de(e),i=Bb(n),a=yde(i,t);a.forEach(function(o){xX(e,o,r)})},xde=function(e,t){var r=e.getColumnLeafNodes(),n=e.getInitColumnLeafNodes(),i=dot(t);return ii(co(r),i)===t&&ii(co(n),i)!==t},bde=function(e){return(e==null?void 0:e.next)||(e==null?void 0:e.prev)},Ede=function(e){var t=bde(e);return t==null?void 0:t.id},CB=function(e,t){return Ede(e)===t},WC=function(e){var t=e.type,r=e.id,n=e.theme,i=e.width,a=e.height,o=NI(e,["type","id","theme","width","height"]),s=t===Uf.Horizontal?n.size:null,l=t===Uf.Vertical?n.size:null;return{fill:n.background,fillOpacity:n.backgroundOpacity,cursor:"".concat(t,"-resize"),width:s,height:l,appendInfo:Zt(Zt({},o),{isResizeArea:!0,type:t,id:r,width:i,height:a,size:n.size})}},XS=function(e,t){if(e.foregroundGroup){var r=e.foregroundGroup.findById(t);return r||e.foregroundGroup.addGroup({id:t,zIndex:Pjt})}},kk=function(e,t,r){var n=r??{},i=n.scrollX,a=i===void 0?0:i,o=n.scrollY,s=o===void 0?0:o,l=!(e.x-a>t.x+t.width||e.x+e.width-a<t.x),u=!(e.y-s>t.y+t.height||e.y+e.height-s<t.y);return l&&u},wde=function(e,t,r){if(!e)return!1;var n=e.iconNames,i=e.displayCondition,a=e.belongsCell;return Or(n)||a!==r?!1:i?n.some(function(o){return i(t,o)}):!0},zk=function(e,t,r){var n=zu(e,function(a){return wde(a,t,r)});if(n){var i=n.iconNames;return n.displayCondition&&(i=i.filter(function(a){return n.displayCondition(t,a)})),Zt(Zt({},n),{iconNames:i})}},pot=function(e,t){var r=e.label,n=e.field;return cu(n,Pi)?{formattedValue:t||r,value:r}:{formattedValue:r,value:r}},Nb=function(e){return zC(e)==="ASC"},Uk=function(e){return zC(e)==="DESC"},bX=function(e){return!qit(Number(e))},EX=function(e,t,r){var n=Nb(t)?1:-1,i=["-",void 0];return e==null?void 0:e.sort(function(a,o){var s=a,l=o;if(r){if(s=a[r],l=o[r],bX(s)&&bX(l))return(Number(s)-Number(l))*n;if(s&&(i!=null&&i.includes(s==null?void 0:s.toString())))return-n;if(Number(s)&&(i!=null&&i.includes(l==null?void 0:l.toString())))return n}return!bl(s)&&!bl(l)?s.toString().localeCompare(l.toString(),"zh")*n:s?n:-n})},vot=function(e,t,r){return r?ffe(t,jv(e)):Vr([],lr(new Set(Vr(Vr([],lr(e),!1),lr(t),!1))),!1)},got=function(e){var t=e.sortByValues,r=e.originValues,n=r.filter(function(s){return t.find(function(l){return Lit(s,l)})}),i=n.map(function(s){var l=s.split(sc);if(l.length>1){var u=l.slice(0,l.length-1).join(sc);return[u,l[l.length-1]]}return l}),a=Array.from(new Set(i.map(function(s){return s[0]})));i.sort(function(s,l){var u=s.slice(0,s.length-1),c=l.slice(0,l.length-1);if(u.join()!==c.join()){var f=a.indexOf(u[0]),d=a.indexOf(c[0]);return f-d}var v=t.indexOf(s[s.length-1]),g=t.indexOf(l[l.length-1]);return v-g});var o=i.map(function(s){return s.join(sc)});return ufe(r,o)},Cde=function(e){var t=e.originValues,r=e.measureValues,n=e.sortParam,i=e.dataSet,a=n.sortFunc,o=n.sortFieldId,s=n.sortMethod,l=a(Zt({data:r},n));return l!=null&&l.length?(i.fields.rows.indexOf(o)>0||i.fields.columns.indexOf(o)>0)&&!oc(l[0],sc)?got({sortByValues:l,originValues:t}):vot(l,t,Nb(s)):t},Sde=function(e){var t=e.sortParam,r=e.measureValues,n=e.originValues,i=e.dataSet,a=t.sortByMeasure,o=t.query,s=t.sortFieldId,l=t.sortMethod,u=i.fields,c=u.rows,f=u.columns,d=c.includes(s),v;if(a){var g=EX(r,l,a===jp?o[Pi]:a);v=pfe(s,d?c:Bb(f),g)}else v=ia(EX(r,l));return vot(v,n,Nb(l))},Tde=function(e){var t=e.sortParam,r=e.originValues,n=e.measureValues,i=e.dataSet,a=t.sortFunc,o=t.sortMethod,s=t.sortBy,l=r,u={originValues:r,measureValues:n,sortParam:t,dataSet:i};return a?l=Cde(u):s?l=got({sortByValues:s,originValues:r}):(Nb(o)||Uk(o))&&(l=Sde(u)),l},Ade=function(e,t,r){var n,i={},a=oc(e,sc);if(a)for(var o=Eat(e,sc),s=!((n=t==null?void 0:t.rows)===null||n===void 0)&&n.includes(r)?t.rows:Bb(t.columns),l=0;l<=l3(s,r);l++)i[s[l]]=o[l];else i[r]=e;return i},wX=function(e){return e.filter(function(t){return t!==Pi})},Mde=function(e){var t=e.dataSet,r=e.sortParam,n=e.originValues,i=t.fields,a=r.sortByMeasure,o=r.query,s=r.sortFieldId;if(a!==jp){var l=t.getMultiData(o,{queryType:Bf.DetailOnly});return l}var u=t.getMultiData(o,{queryType:Bf.All}),c=Bb(i.columns),f=oc(i.rows,s),d=wX(f?i.rows:c),v=wX(f?c:i.rows),g=d[d.indexOf(s)+1],x=xs(o),w=v.filter(function(A){return!x.includes(A)}),S=u.filter(function(A){var M=new Set(Object.keys(A[wN]));if(!M.has(s)||M.has(g))return!1;var R=w.every(function(O){return!M.has(O)});return R});return Or(S)?kd(ia(n,function(A){var M=Ade(A,i,s);return t.getTotalValue(Zt(Zt({},o),M))})):S},Rde=function(e){var t=e.dataSet,r=e.sortParam,n=e.originValues,i=e.isSortByMeasure,a;return i?a=Mde(e):a=n,Tde({sortParam:r,originValues:n,measureValues:a,dataSet:t})},mot=function(e,t){if(e!=null&&e.sortMethod){if(Nb(e==null?void 0:e.sortMethod))return"groupAsc";if(Uk(e==null?void 0:e.sortMethod))return"groupDesc"}if(t)return"SortDown"},CX=function(e){var t,r,n=e.pivotMeta,i=e.dimensions,a=e.sortedDimensionValues,o=e.sortFieldId,s={children:n},l=[s];try{for(var u=Gf(i),c=u.next();!c.done;c=u.next()){var f=c.value;if(f!==o)l=kS(l,function(d){return Vr([],lr(d.children.values()),!1)});else{l.forEach(function(d){var v=Vr([],lr(d.children.values()),!1),g=xat(v,function(x){return l3(a,x.id)}).map(function(x){return[x.value,x]});d.children=new Map(g)});break}}}catch(d){t={error:d}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(t)throw t.error}}return s.children},$k=function(e){en(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.handleRestOptions=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i=lr(r,1),a=i[0];this.headerConfig=Zt({},a);var o=this.meta,s=o.value,l=o.query,u=this.spreadsheet.dataCfg.sortParams,c=this.isSortCell(),f=zu(Vr([],lr(u),!1).reverse(),function(v){return c&&(v==null?void 0:v.sortByMeasure)===s&&cu(ii(v,"query"),l)}),d=mot(f,c);this.headerConfig.sortParam=Zt(Zt(Zt({},this.headerConfig.sortParam),f||{query:l}),{type:d})},t.prototype.initCell=function(){this.resetTextAndConditionIconShapes(),this.actionIcons=[],this.hasDefaultHiddenIcon=!1},t.prototype.getTreeIcon=function(){return this.treeIcon},t.prototype.getInteractiveBorderShapeStyle=function(r){var n=this.getCellArea(),i=n.x,a=n.y,o=n.height,s=n.width;return{x:i+r,y:a+r,width:s-r*2,height:o-r*2}},t.prototype.getFormattedFieldValue=function(){var r=this.meta,n=r.label,i=r.isTotalRoot,a=r.isGrandTotals,o=this.spreadsheet.dataSet.getFieldFormatter(this.meta.field),s=!0;this.spreadsheet.isTableMode()?s=!1:this.spreadsheet.isHierarchyTreeType()?s=!(a&&i):s=!i;var l=s&&o?o(n,void 0,this.meta):n;return{formattedValue:l,value:n}},t.prototype.getActionIconCfg=function(){return zk(this.spreadsheet.options.headerActionIcons,this.meta,this.cellType)},t.prototype.showSortIcon=function(){var r=this.spreadsheet,n=r.options,i=r.dataCfg,a=Or(i.fields.values);if(n.showDefaultHeaderActionIcon&&!a){var o=this.headerConfig.sortParam,s=this.meta.query;return s&&cu(o==null?void 0:o.query,s)&&(o==null?void 0:o.type)&&(o==null?void 0:o.type)!=="none"}return!1},t.prototype.getActionIconsCount=function(){if(this.showSortIcon())return 1;var r=this.getActionIconCfg();if(r){var n=r.iconNames;return n.length}return 0},t.prototype.getActionIconsWidth=function(){var r=this.getStyle().icon,n=r.size,i=r.margin;return(n+i.left)*this.getActionIconsCount()},t.prototype.drawSortIcons=function(){var r=this;if(this.showSortIcon()){var n=this.getStyle(),i=n.icon,a=n.text,o=this.getTextConditionFill(a),s=this.headerConfig.sortParam,l=this.getIconPosition(),u=new UC(Zt(Zt({name:ii(s,"type","none")},l),{width:i.size,height:i.size,fill:o}));u.on("click",function(c){r.spreadsheet.emit(Me.GLOBAL_ACTION_ICON_CLICK,c),r.spreadsheet.handleGroupSort(c,r.meta)}),this.add(u),this.actionIcons.push(u)}},t.prototype.hasDefaultHideActionIcon=function(){return this.hasDefaultHiddenIcon},t.prototype.addActionIcon=function(r){var n=this,i=r.x,a=r.y,o=r.iconName,s=r.defaultHide,l=r.action,u=r.onClick,c=r.onHover,f=this.getStyle(),d=f.icon,v=f.text,g=this.getTextConditionFill(v),x=(d==null?void 0:d.fill)||g,w=new UC({name:o,x:i,y:a,width:d==null?void 0:d.size,height:d==null?void 0:d.size,fill:x});w.set("visible",!s),w.on("mouseover",function(S){n.spreadsheet.emit(Me.GLOBAL_ACTION_ICON_HOVER,S),c==null||c({hovering:!0,iconName:o,meta:n.meta,event:S})}),w.on("mouseleave",function(S){n.spreadsheet.emit(Me.GLOBAL_ACTION_ICON_HOVER_OFF,S),c==null||c({hovering:!1,iconName:o,meta:n.meta,event:S})}),w.on("click",function(S){var A;n.spreadsheet.emit(Me.GLOBAL_ACTION_ICON_CLICK,S),(A=u||l)===null||A===void 0||A({iconName:o,meta:n.meta,event:S})}),this.actionIcons.push(w),this.add(w)},t.prototype.drawActionIcons=function(){var r=this;if(this.showSortIcon()){this.drawSortIcons();return}var n=this.getActionIconCfg();if(n){var i=n.iconNames,a=n.action,o=n.onClick,s=n.onHover,l=n.defaultHide,u=this.getIconPosition(i.length),c=this.getStyle().icon,f=c.size,d=c.margin;xi(i,function(v,g){var x=u.x+g*f+g*d.left,w=u.y,S=typeof l=="function"?l(r.meta,v):l;S&&(r.hasDefaultHiddenIcon=!0),r.addActionIcon({iconName:v,x,y:w,defaultHide:S,action:a,onClick:o,onHover:s})})}},t.prototype.drawBackgroundShape=function(){var r=this.getBackgroundColor(),n=r.backgroundColor,i=r.backgroundColorOpacity;this.backgroundShape=Fh(this,Zt(Zt({},this.getCellArea()),{fill:n,fillOpacity:i}))},t.prototype.isSortCell=function(){var r,n,i,a=(n=(r=this.spreadsheet)===null||r===void 0?void 0:r.isValueInCols)===null||n===void 0?void 0:n.call(r),o=this.meta.level===((i=this.meta.hierarchy)===null||i===void 0?void 0:i.maxLevel);return a?o&&this.cellType===Br.COL_CELL:o&&this.cellType===Br.ROW_CELL},t.prototype.handleByStateName=function(r,n){My(r,this)&&this.updateByState(n)},t.prototype.handleSearchResult=function(r){if(My(r,this)){var n=zu(r,function(i){return i==null?void 0:i.isTarget});n.id===this.getMeta().id?this.updateByState(On.HIGHLIGHT):this.updateByState(On.SEARCH_RESULT)}},t.prototype.handleHover=function(r){var n;My(r,this)&&(this.updateByState(On.HOVER),this.hasDefaultHideActionIcon()&&this.toggleActionIcon((n=r==null?void 0:r[0])===null||n===void 0?void 0:n.id))},t.prototype.handleSelect=function(r,n){My(r,this)&&this.updateByState(On.SELECTED);var i=ia(n,"id");oc(i,this.meta.id)&&this.updateByState(On.SELECTED)},t.prototype.getTextStyle=function(){var r=this.getStyle(),n=r.text,i=r.bolderText,a=r.measureText,o;this.isMeasureField()?o=a||n:this.isBolderText()?o=i:o=n;var s=this.getTextConditionFill(o);return Zt(Zt({},o),{fill:s})},t.prototype.getBackgroundColor=function(){var r,n=((r=this.getStyle())===null||r===void 0?void 0:r.cell)||{},i=n.backgroundColor,a=n.backgroundColorOpacity;return this.getBackgroundColorByCondition(i,a)},t.prototype.getBackgroundColorByCondition=function(r,n){var i,a=r,o=this.findFieldCondition((i=this.conditions)===null||i===void 0?void 0:i.background);if(o&&o.mapping){var s=this.mappingValue(o);s&&(a=s.fill)}return{backgroundColor:a,backgroundColorOpacity:n}},t.prototype.toggleActionIcon=function(r){if(this.getMeta().id===r){var n=[];xi(this.actionIcons,function(i){i.get("visible")||(i.set("visible",!0),n.push(i))}),this.spreadsheet.store.set("visibleActionIcons",n)}},t.prototype.update=function(){var r=this.spreadsheet.interaction,n=r==null?void 0:r.getState(),i=r==null?void 0:r.getCells([Br.CORNER_CELL,Br.COL_CELL,Br.ROW_CELL]);if(u_(i))switch(n==null?void 0:n.stateName){case On.SELECTED:case On.BRUSH_SELECTED:this.handleSelect(i,n==null?void 0:n.nodes);break;case On.HOVER_FOCUS:case On.HOVER:this.handleHover(i);break;case On.SEARCH_RESULT:this.handleSearchResult(i);break;default:this.handleByStateName(i,n==null?void 0:n.stateName);break}},t.prototype.updateByState=function(r){e.prototype.updateByState.call(this,r,this)},t.prototype.hideInteractionShape=function(){e.prototype.hideInteractionShape.call(this)},t.prototype.isMeasureField=function(){return[Pi,Ijt].includes(this.meta.field)},t.prototype.mappingValue=function(r){var n=this.getMeta().label;return r==null?void 0:r.mapping(n,this.meta)},t.prototype.findFieldCondition=function(r){var n=this;return a3(r,function(i){return i.field instanceof RegExp?i.field.test(n.meta.field):i.field===n.meta.field})},t}(y3),_3=function(e){en(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return Object.defineProperty(t.prototype,"cellType",{get:function(){return Br.COL_CELL},enumerable:!1,configurable:!0}),t.prototype.initCell=function(){e.prototype.initCell.call(this),this.drawBackgroundShape(),this.drawInteractiveBgShape(),this.drawInteractiveBorderShape(),this.drawTextShape(),this.drawConditionIconShapes(),this.drawActionIcons(),this.drawBorders(),this.drawResizeArea(),this.addExpandColumnIconShapes(),this.update()},t.prototype.drawInteractiveBgShape=function(){this.stateShapes.set("interactiveBgShape",Fh(this,Zt({},this.getCellArea()),{visible:!1}))},t.prototype.drawInteractiveBorderShape=function(){var r=2;this.stateShapes.set("interactiveBorderShape",Fh(this,this.getInteractiveBorderShapeStyle(r),{visible:!1}))},t.prototype.getMaxTextWidth=function(){var r=this.getContentArea().width;return r-this.getActionIconsWidth()},t.prototype.getIconPosition=function(){if(this.meta.isLeaf)return e.prototype.getIconPosition.call(this,this.getActionIconsCount());var r=this.getIconStyle(),n=r.margin.left,i=this.getTextStyle(),a=this.textPosition,o=a==null?void 0:a.x,s=(a==null?void 0:a.y)-r.size/2;return i.textAlign==="left"?{x:o+this.actualTextWidth+n,y:s}:i.textAlign==="right"?{x:o+n,y:s}:{x:o+this.actualTextWidth/2+n,y:s}},t.prototype.isBolderText=function(){var r=this.meta,n=r.isLeaf,i=r.isTotals;return!!(i||!n)},t.prototype.getTextPosition=function(){var r,n=this.meta.isLeaf,i=this.headerConfig,a=i.width,o=i.scrollContainsRowHeader,s=i.cornerWidth,l=i.scrollX,u=this.getTextStyle(),c=this.getContentArea(),f=this.getIconStyle();if(n)return GS(c,u,this.actualTextWidth,f,this.getActionIconsCount()).text;var d={start:l-(o?s:0),width:a+(o?s:0)},v=this.getTextStyle().textAlign,g=efe(d,v,(r=this.getStyle().cell)===null||r===void 0?void 0:r.padding),x=this.getActionIconsWidth(),w=this.actualTextWidth+x,S=tfe(g,{start:c.x,width:c.width},w),A=rfe(S,this.actualTextWidth,x,v),M=c.y+c.height/2;return this.textPosition={x:A,y:M},this.textPosition},t.prototype.getActionIconsWidth=function(){var r=this.getStyle().icon,n=r.size,i=r.margin,a=this.getActionIconsCount();return(n+i.left)*a+(a>0?i.right:0)},t.prototype.getColResizeAreaKey=function(){return this.meta.key},t.prototype.getColResizeArea=function(){return XS(this.spreadsheet,Yrt)},t.prototype.getHorizontalResizeAreaName=function(){return"".concat(qrt).concat(this.meta.key)},t.prototype.drawHorizontalResizeArea=function(){var r,n,i=((n=(r=this.spreadsheet.options.style)===null||r===void 0?void 0:r.colCfg)===null||n===void 0?void 0:n.height)===0;if(!(i||!this.shouldDrawResizeAreaByType("colCellVertical",this))){var a=this.headerConfig,o=a.cornerWidth,s=a.viewportWidth,l=this.meta,u=l.y,c=l.height,f=this.getResizeAreaStyle(),d=this.getColResizeArea(),v=this.getHorizontalResizeAreaName(),g=d.find(function(w){return w.attrs.name===v});if(!g){var x=o+s;d.addShape("rect",{attrs:Zt(Zt({},WC({theme:f,type:Uf.Vertical,id:this.getColResizeAreaKey(),effect:rc.Field,offsetX:0,offsetY:u,width:x,height:c,meta:this.meta})),{name:v,x:0,y:u+c-f.size/2,width:x})})}}},t.prototype.shouldAddVerticalResizeArea=function(){var r=this.meta,n=r.x,i=r.y,a=r.width,o=r.height,s=this.headerConfig,l=s.scrollX,u=s.scrollY,c=s.scrollContainsRowHeader,f=s.cornerWidth,d=s.height,v=s.width,g=this.getResizeAreaStyle(),x={x:n+a-g.size/2,y:i,width:g.size,height:o},w={x:c?-f:0,y:0,width:c?f+v:v,height:d};return kk(x,w,{scrollX:l,scrollY:u})},t.prototype.getVerticalResizeAreaOffset=function(){var r=this.meta,n=r.x,i=r.y,a=this.headerConfig,o=a.scrollX,s=a.position;return{x:s.x+n-o,y:s.y+i}},t.prototype.drawVerticalResizeArea=function(){if(!(!this.meta.isLeaf||!this.shouldDrawResizeAreaByType("colCellHorizontal",this))){var r=this.meta,n=r.label,i=r.width,a=r.height,o=this.getResizeAreaStyle(),s=this.getColResizeArea();if(this.shouldAddVerticalResizeArea()){var l=this.getVerticalResizeAreaOffset(),u=l.x,c=l.y;s.addShape("rect",{attrs:Zt(Zt({},WC({theme:o,type:Uf.Horizontal,effect:rc.Cell,id:n,offsetX:u,offsetY:c,width:i,height:a,meta:this.meta})),{x:u+i-o.size/2,y:c,height:a})})}}},t.prototype.drawResizeArea=function(){this.drawHorizontalResizeArea(),this.drawVerticalResizeArea()},t.prototype.drawHorizontalBorder=function(){var r=h_(vl.TOP,this.meta,this.theme.colCell.cell),n=r.position,i=r.style;lu(this,n,i)},t.prototype.drawVerticalBorder=function(r){var n=h_(r,this.meta,this.theme.colCell.cell),i=n.position,a=n.style;lu(this,i,a)},t.prototype.drawBorders=function(){var r=this.spreadsheet,n=r.options,i=r.isTableMode;this.meta.colIndex===0&&i()&&!n.showSeriesNumber&&this.drawVerticalBorder(vl.LEFT),this.drawHorizontalBorder(),this.drawVerticalBorder(vl.RIGHT)},t.prototype.hasHiddenColumnCell=function(){var r=this,n=this.spreadsheet.options,i=n.interaction.hiddenColumnFields,a=i===void 0?[]:i,o=n.tooltip.operation,s=this.spreadsheet.store.get("hiddenColumnsDetail",[]);return Or(s)||Or(a)||!o.hiddenColumns?!1:!!s.find(function(l){return CB(l==null?void 0:l.displaySiblingNode,r.meta.id)})},t.prototype.getExpandIconTheme=function(){var r=this.getStyle();return r.icon},t.prototype.addExpandColumnSplitLine=function(){var r=this.meta,n=r.x,i=r.y,a=r.width,o=r.height,s=this.theme.splitLine,l=s.horizontalBorderColor,u=s.horizontalBorderWidth,c=s.horizontalBorderColorOpacity,f=s.borderDash,d=this.isLastColumn()?n+a-u:n;lu(this,{x1:d,y1:i,x2:d,y2:i+o},{stroke:l,lineWidth:u,strokeOpacity:c,lineDash:f})},t.prototype.addExpandColumnIconShapes=function(){this.hasHiddenColumnCell()&&(this.addExpandColumnSplitLine(),this.addExpandColumnIcons())},t.prototype.addExpandColumnIcons=function(){var r=this.isLastColumn();this.addExpandColumnIcon(r),this.isAllDisplaySiblingNodeHidden()&&r&&this.addExpandColumnIcon(!1)},t.prototype.addExpandColumnIcon=function(r){var n=this,i=this.getExpandColumnIconConfig(r),a=Pk(this,Zt(Zt({},i),{name:"ExpandColIcon",cursor:"pointer"}));a.on("click",function(){n.spreadsheet.emit(Me.LAYOUT_COLS_EXPANDED,n.meta)})},t.prototype.getExpandColumnIconConfig=function(r){var n=this.getExpandIconTheme().size,i=this.getCellArea(),a=i.x,o=i.y,s=i.width,l=i.height,u=a-n,c=r?u+s:u,f=o+l/2-n/2;return{x:c,y:f,width:n*2,height:n}},t.prototype.isLastColumn=function(){return xde(this.spreadsheet,this.meta.id)},t.prototype.isAllDisplaySiblingNodeHidden=function(){var r=this.meta.id,n=this.spreadsheet.store.get("hiddenColumnsDetail",[]),i=n.find(function(o){var s,l=o.displaySiblingNode;return((s=l==null?void 0:l.next)===null||s===void 0?void 0:s.id)===r}),a=n.find(function(o){var s,l=o.displaySiblingNode;return((s=l==null?void 0:l.prev)===null||s===void 0?void 0:s.id)===r});return a&&i},t}($k),Ide=function(e){en(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.isBolderText=function(){var r=this.meta.cornerType;return r===Rd.Col},Object.defineProperty(t.prototype,"cellType",{get:function(){return Br.CORNER_CELL},enumerable:!1,configurable:!0}),t.prototype.initCell=function(){e.prototype.initCell.call(this),this.resetTextAndConditionIconShapes(),this.drawBackgroundShape(),this.drawTreeIcon(),this.drawCellText(),this.drawConditionIconShapes(),this.drawActionIcons(),this.drawBorderShape(),this.drawResizeArea(),this.update()},t.prototype.drawCellText=function(){this.drawTextShape()},t.prototype.drawTextShape=function(){var r=this.getContentArea().x,n=this.getCellArea(),i=n.y,a=n.height,o=this.getTextStyle(),s=this.getCornerText(),l=this.getMaxTextWidth(),u=O_(this.meta,this.spreadsheet.options.placeholder),c=this.spreadsheet.measureTextWidth,f=nb({measureTextWidth:c,text:s,maxWidth:l,fontParam:o,placeholder:u});this.actualText=f;var d=f.indexOf(vx),v=f,g="";if(d!==-1&&this.spreadsheet.isHierarchyTreeType()){var x=d+(Qce()?1:0);v=s.substr(0,x),g=s.slice(x),g=nb({measureTextWidth:c,text:g,maxWidth:l,fontParam:o})}var w=Jhe({x:r+this.getTreeIconWidth(),y:i,width:l,height:a},o).x,S=i+(Or(g)?a/2:a/4);this.addTextShape(c_(this,[this.textShapes[0]],w,S,v,o)),Or(g)||this.addTextShape(c_(this,[this.textShapes[1]],w,i+a*.75,g,o)),this.actualTextWidth=tb([c(v,o),c(g,o)])},t.prototype.drawTreeIcon=function(){var r=this;if(!(!this.showTreeIcon()||this.meta.cornerType===Rd.Col)){var n=this.headerConfig.hierarchyCollapse,i=this.getStyle().icon.size,a=this.getTextStyle(),o=a.textBaseline,s=a.fill,l=this.getContentArea();this.treeIcon=Qat(this,{x:l.x,y:xR(l,o,i),width:i,height:i},s,n,function(){r.headerConfig.spreadsheet.store.set("scrollY",0),r.headerConfig.spreadsheet.emit(Me.LAYOUT_TREE_ROWS_COLLAPSE_ALL,n)})}},t.prototype.drawBorderShape=function(){var r=this;[vl.TOP,vl.LEFT].forEach(function(n){var i=h_(n,r.getCellArea(),r.getStyle().cell),a=i.position,o=i.style;lu(r,a,o)})},t.prototype.isLastRowCornerCell=function(){var r=this.meta,n=r.cornerType,i=r.field,a=this.headerConfig.rows;return n===Rd.Row&&(this.spreadsheet.isHierarchyTreeType()||co(a)===i)},t.prototype.getResizeAreaEffect=function(){var r=this.meta.cornerType;return r===Rd.Series?rc.Series:this.isLastRowCornerCell()&&this.spreadsheet.isHierarchyTreeType()?rc.Tree:rc.Field},t.prototype.drawResizeArea=function(){if(this.shouldDrawResizeAreaByType("cornerCellHorizontal",this)){var r=this.getResizeAreaStyle(),n=XS(this.spreadsheet,jF),i=this.headerConfig,a=i.position,o=i.scrollX,s=i.scrollY,l=i.width,u=i.height,c=this.meta,f=c.x,d=c.y,v=c.width,g=c.height,x=c.field,w=c.cornerType,S={x:f+v-r.size/2,y:d,width:r.size,height:g},A={x:0,y:0,width:l,height:u};if(!(w===Rd.Col||!kk(S,A,{scrollX:o,scrollY:s}))){var M=a.x+f-o,R=a.y+(this.isLastRowCornerCell()?0:d);n.addShape("rect",{attrs:Zt(Zt({},WC({theme:r,id:x,type:Uf.Horizontal,effect:this.getResizeAreaEffect(),offsetX:M,offsetY:R,width:v,height:g,meta:this.meta})),{x:M+v-r.size/2,y:R,height:this.isLastRowCornerCell()?u:g})})}}},t.prototype.showTreeIcon=function(){var r;return this.spreadsheet.isHierarchyTreeType()&&((r=this.meta)===null||r===void 0?void 0:r.x)===0},t.prototype.getIconPosition=function(){var r,n,i=(n=(r=this.textShapes)===null||r===void 0?void 0:r[0])===null||n===void 0?void 0:n.cfg.attrs,a=this.getTextStyle(),o=a.textBaseline,s=a.textAlign,l=this.getStyle().icon,u=l.size,c=l.margin,f=(i==null?void 0:i.x)+_it([[uB("center"),mx(this.actualTextWidth/2)],[uB("right"),mx(0)],[wat,mx(this.actualTextWidth)]])(s)+c.left,d=xR(this.getContentArea(),o,u);return{x:f,y:d}},t.prototype.getTreeIconWidth=function(){var r=this.getStyle().icon,n=r.size,i=r.margin;return this.showTreeIcon()?n+i.right:0},t.prototype.getTextStyle=function(){var r=this.getStyle(),n=r.text,i=r.bolderText,a=this.isBolderText()?n:i,o=this.getTextConditionFill(a);return Zt(Zt({},a),{fill:o})},t.prototype.getMaxTextWidth=function(){var r=this.getContentArea().width;return r-this.getTreeIconWidth()-this.getActionIconsWidth()},t.prototype.getTextPosition=function(){return{x:0,y:0}},t.prototype.getFormattedFieldValue=function(){return pot(this.meta,this.spreadsheet.dataSet.getFieldName(this.meta.label))},t.prototype.getCornerText=function(){var r=this.getFormattedFieldValue().formattedValue;return r},t}($k),Lde=function(e,t,r,n){var i,a,o=ii(n,"size"),s=ii(n,"margin"),l=0;return e.options.showDefaultHeaderActionIcon?l=1:l=(a=(i=zk(e.options.headerActionIcons,t,r))===null||i===void 0?void 0:i.iconNames.length)!==null&&a!==void 0?a:0,l*(o+s.left)+(l>0?s.right:0)},yot=function(e,t,r){var n,i,a=((n=r.icon.margin)===null||n===void 0?void 0:n.left)||0,o=((i=r.icon.margin)===null||i===void 0?void 0:i.right)||0,s=e.store.get("hiddenColumnsDetail",[]),l=!1,u=!1;s.forEach(function(f){var d,v,g,x;((v=(d=f==null?void 0:f.displaySiblingNode)===null||d===void 0?void 0:d.prev)===null||v===void 0?void 0:v.field)===t&&(l=!0),((x=(g=f==null?void 0:f.displaySiblingNode)===null||g===void 0?void 0:g.next)===null||x===void 0?void 0:x.field)===t&&(u=!0)});var c=ii(r,"icon.size");return{left:u?c+o:0,right:l?c+a:0}},Ode=function(e,t,r){var n=ii(r,"cell.padding"),i=yot(e,t.field,r);return n.left+n.right+Lde(e,t,Br.COL_CELL,ii(r,"icon"))+i.left+i.right},_ot=function(e){en(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.handleRestOptions=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i=lr(r,1),a=i[0];this.headerConfig=Zt({},a);var o=this.meta.field,s=this.spreadsheet.dataCfg.sortParams,l=zu(s,function(c){return(c==null?void 0:c.sortFieldId)===o}),u=mot(l,!0);this.headerConfig.sortParam=Zt(Zt(Zt({},this.headerConfig.sortParam),l||{}),{type:u})},t.prototype.isFrozenCell=function(){var r=this.spreadsheet.options,n=r.frozenColCount,i=r.frozenTrailingColCount,a=this.spreadsheet.facet.layoutResult.colNodes.filter(function(s){return Bp(s)}),o=Fhe(this.meta).colIndex;return Ny(o,n)||ky(o,i,a.length)},t.prototype.getFormattedFieldValue=function(){return pot(this.meta,this.spreadsheet.dataSet.getFieldName(this.meta.label))},t.prototype.shouldAddVerticalResizeArea=function(){return this.isFrozenCell()?!0:e.prototype.shouldAddVerticalResizeArea.call(this)},t.prototype.getVerticalResizeAreaOffset=function(){var r=this.meta,n=r.x,i=r.y,a=this.headerConfig,o=a.scrollX,s=a.position;return this.isFrozenCell()?{x:n,y:i}:{x:s.x+n-o,y:s.y+i}},t.prototype.getColResizeArea=function(){var r=this.isFrozenCell();return r?XS(this.spreadsheet,Zrt):e.prototype.getColResizeArea.call(this)},t.prototype.isSortCell=function(){return!0},t.prototype.showSortIcon=function(){return this.spreadsheet.options.showDefaultHeaderActionIcon},t.prototype.getTextStyle=function(){var r=this.getStyle();return r==null?void 0:r.bolderText},t.prototype.getContentArea=function(){var r,n=(((r=this.getStyle())===null||r===void 0?void 0:r.cell)||this.theme.dataCell.cell).padding,i=Zt({},n),a=yot(this.spreadsheet,this.meta.field,this.getStyle());return a.left&&(i.left=(i.left||0)+a.left),a.right&&(i.right=(i.right||0)+a.right),tot(this.getCellArea(),i)},t.prototype.getHorizontalResizeAreaName=function(){return"".concat(qrt).concat("table-col-cell")},t.prototype.drawBackgroundShape=function(){var r=this.getStyle().cell.backgroundColor;this.backgroundShape=Fh(this,Zt(Zt({},this.getCellArea()),{fill:r}))},t}(_3),Pde=function(e){en(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getStyle=function(r){return r?this.theme[r]:ii(this,"theme.cornerCell")},t.prototype.showSortIcon=function(){return!1},t.prototype.drawLeftBorder=function(){var r=h_(vl.LEFT,this.getCellArea(),this.getStyle().cell),n=r.position,i=r.style;lu(this,n,i)},t.prototype.drawBorders=function(){e.prototype.drawBorders.call(this),this.meta.colIndex===0&&this.drawLeftBorder()},t}(_ot),x3=function(e){en(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getLinkFieldStyle=function(){return this.theme.rowCell.text.linkTextFill},t.prototype.drawBorderShape=function(){e.prototype.drawBorderShape.call(this),this.meta.colIndex===0&&this.drawLeftBorder()},t.prototype.shouldDrawResizeArea=function(){return this.meta.colIndex===0},t.prototype.drawResizeArea=function(){if(this.shouldDrawResizeArea()){var r=this.getCellArea(),n=r.x,i=r.y,a=r.width,o=r.height,s=this.meta.rowIndex,l=this.getResizeAreaStyle(),u=this.spreadsheet.options,c=u.frozenRowCount,f=u.frozenTrailingRowCount,d=this.spreadsheet.facet.getCellRange(),v=g3(s,d.start,c),g=VS(s,d.end,f),x=v||g,w=x?jrt:Kx,S=XS(this.spreadsheet,w),A=this.spreadsheet.facet.layoutResult.colsHierarchy.height,M=this.spreadsheet.facet.getScrollOffset().scrollY,R=this.spreadsheet.facet.getPaginationScrollY(),O=M+R,N=i+(g?0:A);g||(N-=v?R:O),S.addShape("rect",{attrs:Zt(Zt({},WC({id:String(this.meta.rowIndex),theme:l,type:Uf.Vertical,effect:rc.Cell,offsetX:n,offsetY:N,width:a,height:o,meta:this.meta})),{x:n,y:N+o-l.size/2,width:a})})}},t}(_0),xot=function(e){en(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return Object.defineProperty(t.prototype,"cellType",{get:function(){return Br.ROW_CELL},enumerable:!1,configurable:!0}),t.prototype.getTextStyle=function(){return this.theme.rowCell.seriesText},t}(x3),b3=function(){function e(t){this.EVENT="gesture",this.gm=t}return e.prototype.do=function(t){var r=t.type;switch(r){case"touchstart":this.onTouchStart(t);break;case"touchmove":this.onTouchMove(t);break;case"touchend":this.onTouchEnd(t);break;case"touchcancel":this.onTouchCancel(t);break;default:return}},e.prototype.emit=function(t){this.gm.emit(this.EVENT,t)},e}(),Dde=function(e){en(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.EVENT="pan",r}return t.prototype.onTouchCancel=function(r){},t.prototype.onTouchEnd=function(r){},t.prototype.onTouchMove=function(r){var n=r.x,i=r.y,a=n-this.preX,o=i-this.preY;this.preX=n,this.preY=i,this.emit({x:n,y:i,deltaX:a,deltaY:o,event:r})},t.prototype.onTouchStart=function(r){var n=r.x,i=r.y;this.preX=n,this.preY=i},t}(b3),km=typeof performance=="object"&&performance.now?performance:Date,Fde=300,SX=10,Bde=function(e){en(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.EVENT="press",r}return t.prototype.onTouchCancel=function(r){this.clearTimeout()},t.prototype.onTouchEnd=function(r){this.clearTimeout()},t.prototype.onTouchMove=function(r){var n=r.x,i=r.y;(n-this.touchStartX>SX||i-this.touchStartY>SX)&&this.clearTimeout()},t.prototype.onTouchStart=function(r){var n=this;this.clearTimeout();var i=r.x,a=r.y;this.touchStartTime=km.now(),this.touchStartX=i,this.touchStartY=a,this.pressTimeout=window.setTimeout(function(){n.emit({x:i,y:a,event:r})},Fde)},t.prototype.clearTimeout=function(){window.clearTimeout(this.pressTimeout)},t}(b3),Nde=100,kde=function(e){en(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.EVENT="swipe",r.latestMoveTime=0,r.ms=0,r.speedX=0,r.speedY=0,r.preX=0,r.preY=0,r}return t.prototype.onTouchCancel=function(r){},t.prototype.onTouchEnd=function(r){var n=this.speedX,i=this.speedY;if(km.now()-this.latestMoveTime<Nde){var a=r.x,o=r.y;this.emit({x:a,y:o,speedX:n,speedY:i,event:r})}},t.prototype.onTouchMove=function(r){var n=r.x,i=r.y,a=km.now(),o=n-this.preX,s=i-this.preY,l=a-this.ms;this.speedX=o/l,this.speedY=s/l,this.latestMoveTime=a},t.prototype.onTouchStart=function(r){var n=r.x,i=r.y;this.speedX=this.speedY=0,this.preX=n,this.preY=i,this.ms=km.now()},t}(b3),zde=300,TX=2,Ude=function(e){en(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.EVENT="tap",r}return t.prototype.onTouchCancel=function(r){},t.prototype.onTouchEnd=function(r){var n=r.x,i=r.y;n-this.touchStartX<TX&&i-this.touchStartY<TX&&km.now()-this.touchStartTime<zde&&this.emit({x:n,y:i,event:r})},t.prototype.onTouchMove=function(r){},t.prototype.onTouchStart=function(r){var n=r.x,i=r.y;this.touchStartTime=km.now(),this.touchStartX=n,this.touchStartY=i},t}(b3),$de={Pan:Dde,Press:Bde,Swipe:kde,Tap:Ude},Hde=function(e){return $de[e]},bot=function(e){en(t,e);function t(r,n){n===void 0&&(n={});var i=e.call(this)||this;return i.onTouchStart=function(a){i.preventEvent(a),i.element.on("touchmove",i.onTouchMove),i.element.on("touchend",i.onTouchEnd),i.element.on("touchcancel",i.onTouchCancel),i.emit("touchdown",a),i.doGestures(a)},i.onTouchMove=function(a){i.preventEvent(a),i.emit("touchmove",a),i.doGestures(a)},i.onTouchEnd=function(a){i.preventEvent(a),i.emit("touchend",a),i.element.off("touchmove",i.onTouchMove),i.element.off("touchend",i.onTouchEnd),i.element.off("touchcancel",i.onTouchCancel),i.doGestures(a)},i.onTouchCancel=function(a){i.preventEvent(a),i.emit("touchcancel",a),i.element.off("touchmove",i.onTouchMove),i.element.off("touchend",i.onTouchEnd),i.element.off("touchcancel",i.onTouchCancel),i.doGestures(a)},i.element=r,i.options=n,i.initialGestures(),i.bindTouchStart(),i}return t.prototype.destroy=function(){this.element.off("touchstart",this.onTouchStart),this.off()},t.prototype.initialGestures=function(){var r=this,n=this.options.gestures||["Pan","Press","Swipe","Tap"];this.gestures=n.map(function(i){var a=Hde(i);return new a(r)})},t.prototype.bindTouchStart=function(){this.element.on("touchstart",this.onTouchStart)},t.prototype.preventEvent=function(r){var n=r.type,i=this.options.prevents||[];i.includes(n)&&r.preventDefault()},t.prototype.doGestures=function(r){this.gestures.forEach(function(n){n.do(r)})},t}(zI),Vde=prt,Gde=800,Wde="swipe",Xde="pan",AX="wheel",jde=function(e){en(t,e);function t(r){var n=e.call(this)||this;return n.rafMs=0,n.onPan=function(i){n.raf&&cancelAnimationFrame(n.raf);var a=i.deltaX,o=i.deltaY,s=n.getWrapperEvent(i,a,o);n.emit(AX,s)},n.onSwipe=function(i){var a=i.speedX,o=i.speedY;n.rafMs=km.now(),n.ms=n.rafMs,(a!==0||o!==0)&&n.rafInertia(i)},n.element=r,n.gm=new bot(r,{gestures:["Pan","Swipe"]}),n.gm.on(Wde,n.onSwipe),n.gm.on(Xde,n.onPan),n}return t.prototype.destroy=function(){window.cancelAnimationFrame(this.raf),this.gm.destroy(),this.off()},t.prototype.rafInertia=function(r){var n=this,i=r.speedX,a=r.speedY;this.raf=window.requestAnimationFrame(function(){var o=km.now(),s=(o-n.ms)/Gde;if(s<1){s=Vde(1-s);var l=o-n.rafMs,u=i*s*l,c=a*s*l,f=n.getWrapperEvent(r,u,c);n.emit(AX,f),n.rafMs=o,n.rafInertia(r)}})},t.prototype.getWrapperEvent=function(r,n,i){return Zt(Zt({},r),{deltaX:-n,deltaY:-i})},t}(zI),Yde=function(e){var t=0,r=e.children;return r==null||r.forEach(function(n){t+=n.height||0}),t},Eot=function(e,t,r,n,i){var a=0,o=e+(t-i)/2,s=e+(t+i)/2,l=r+n;return e+i>=l?a=e:l<s?a=r+n-i:r>o?e+t-r>i?a=r:a=e+t-i:a=e+(t-i)/2,a},Zde=function(e){en(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return Object.defineProperty(t.prototype,"cellType",{get:function(){return Br.ROW_CELL},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){var r;e.prototype.destroy.call(this),(r=this.gm)===null||r===void 0||r.destroy()},t.prototype.initCell=function(){e.prototype.initCell.call(this),this.drawBackgroundShape(),this.drawInteractiveBgShape(),this.drawInteractiveBorderShape(),this.drawTextShape(),this.drawConditionIconShapes(),this.drawTreeIcon(),this.drawTreeLeafNodeAlignDot(),this.drawRectBorder(),this.drawResizeAreaInLeaf(),this.drawActionIcons(),this.update()},t.prototype.getBackgroundColor=function(){var r=this.getCrossBackgroundColor(this.meta.rowIndex),n=r.backgroundColor,i=r.backgroundColorOpacity;return this.getBackgroundColorByCondition(n,i)},t.prototype.drawInteractiveBorderShape=function(){var r=2;this.stateShapes.set("interactiveBorderShape",Fh(this,this.getInteractiveBorderShapeStyle(r),{visible:!1}))},t.prototype.drawInteractiveBgShape=function(){this.stateShapes.set("interactiveBgShape",Fh(this,Zt({},this.getCellArea()),{visible:!1}))},t.prototype.showTreeIcon=function(){return this.spreadsheet.isHierarchyTreeType()&&!this.meta.isLeaf},t.prototype.showTreeLeafNodeAlignDot=function(){var r;return((r=this.spreadsheet.options.style)===null||r===void 0?void 0:r.showTreeLeafNodeAlignDot)&&this.spreadsheet.isHierarchyTreeType()},t.prototype.getParentTreeIconCfg=function(){if(!(!this.showTreeLeafNodeAlignDot()||!this.spreadsheet.isHierarchyTreeType()||!this.meta.isLeaf))return ii(this.meta,"parent.belongsCell.treeIcon.cfg")},t.prototype.drawTreeIcon=function(){var r=this;if(this.showTreeIcon()){var n=this.meta,i=n.isCollapsed,a=n.id,o=n.hierarchy,s=this.getContentArea().x,l=this.getTextStyle().fill,u=this.getStyle().icon.size,c=this.getContentIndent(),f=s+c,d=this.getIconYPosition();this.treeIcon=Qat(this,{x:f,y:d,width:u,height:u},l,i,function(){if(!Bl()){if(!i){var v=r.spreadsheet.store.get("scrollY"),g=r.headerConfig.viewportHeight||0,x=Yde(r.meta),w=o.height-x;if(v>0&&v+g>w){var S=w-g;r.spreadsheet.store.set("scrollY",S>0?S:0)}}r.spreadsheet.emit(Me.ROW_CELL_COLLAPSE_TREE_ROWS,{id:a,isCollapsed:!i,node:r.meta})}}),Bl()&&(this.gm=new bot(this,{gestures:["Tap"]}),this.gm.on("tap",function(){r.spreadsheet.emit(Me.ROW_CELL_COLLAPSE_TREE_ROWS,{id:a,isCollapsed:!i,node:r.meta})}))}},t.prototype.drawTreeLeafNodeAlignDot=function(){var r=this.getParentTreeIconCfg();if(r){var n=this.getStyle().icon,i=n.size,a=n.margin,o=r.x+i+a.right,s=this.getTextPosition().y,l=this.getTextStyle(),u=l.fill,c=l.fontSize,f=i/5;this.treeLeafNodeAlignDot=Kat(this,{x:o+i/2,y:s+(c-f)/2,r:f,fill:u,fillOpacity:.3})}},t.prototype.isBolderText=function(){var r=this.meta,n=r.isLeaf,i=r.isTotals,a=r.level;return!n&&a===0||i},t.prototype.drawTextShape=function(){e.prototype.drawTextShape.call(this),this.drawLinkField(this.meta)},t.prototype.drawRectBorder=function(){var r=this,n=this.getCellArea().x,i=this.getContentIndent(),a=this.spreadsheet.isHierarchyTreeType()?n:n+i;[vl.BOTTOM,vl.LEFT].forEach(function(o){var s=h_(o,Zt(Zt({},r.getCellArea()),{x:a}),r.getStyle().cell),l=s.position,u=s.style;lu(r,l,u)})},t.prototype.getResizeClipAreaBBox=function(){var r=this.headerConfig,n=r.width,i=r.viewportHeight;return{x:0,y:0,width:n,height:i}},t.prototype.drawResizeAreaInLeaf=function(){if(!(!this.meta.isLeaf||!this.shouldDrawResizeAreaByType("rowCellVertical",this))){var r=this.getCellArea(),n=r.x,i=r.y,a=r.width,o=r.height,s=this.getResizeAreaStyle(),l=XS(this.spreadsheet,Kx),u=this.headerConfig,c=u.position,f=u.seriesNumberWidth,d=u.width,v=u.scrollX,g=u.scrollY,x={x:n+f,y:i+o-s.size/2,width:a,height:s.size},w=this.getResizeClipAreaBBox();if(kk(x,w,{scrollX:v,scrollY:g})){var S=(c==null?void 0:c.x)+n-v+f,A=(c==null?void 0:c.y)+i-g,M=this.spreadsheet.isFrozenRowHeader()?d-f-(n-v):a;l.addShape("rect",{attrs:Zt(Zt({},WC({id:this.meta.id,theme:s,type:Uf.Vertical,effect:rc.Cell,offsetX:S,offsetY:A,width:a,height:o,meta:this.meta})),{x:S,y:A+o-s.size/2,width:M})})}}},t.prototype.getContentIndent=function(){if(!this.spreadsheet.isHierarchyTreeType())return 0;for(var r=this.getStyle(),n=r.icon,i=r.cell,a=n.size+n.margin.right,o=this.meta.parent,s=0;o;)o.height!==0&&(s+=a),o=o.parent;return this.showTreeLeafNodeAlignDot()&&(s+=this.isTreeLevel()?0:i.padding.right+n.margin.right),s},t.prototype.getTextIndent=function(){var r=this.getStyle().icon,n=r.size,i=r.margin,a=this.getContentIndent(),o=this.showTreeIcon()||this.isTreeLevel()&&this.showTreeLeafNodeAlignDot()?n+i.right:0;return a+o},t.prototype.isTreeLevel=function(){return zu(ii(this.meta,"parent.children"),function(r){return!r.isLeaf})},t.prototype.getIconPosition=function(){if(!this.textShape)return{x:0,y:0};var r=this.textShape.cfg.attrs,n=r.x,i=r.y,a=r.textAlign,o=this.getStyle().icon.margin.left;return a==="left"?{x:n+this.actualTextWidth+o,y:i}:a==="right"?{x:n+o,y:i}:{x:n+this.actualTextWidth/2+o,y:i}},t.prototype.getMaxTextWidth=function(){var r=this.getContentArea().width;return r-this.getTextIndent()-this.getActionIconsWidth()},t.prototype.getTextArea=function(){var r=this.getContentArea(),n=this.getTextIndent();return Zt(Zt({},r),{x:r.x+n,width:r.width-n})},t.prototype.getAdjustTextAreaHeight=function(r,n,i){var a=r.height;return!this.spreadsheet.facet.vScrollBar&&r.y+r.height>n+i&&(a=n+i-r.y),a},t.prototype.calculateTextY=function(r){var n=r.textArea,i=r.adjustTextAreaHeight,a=this.headerConfig,o=a.scrollY,s=a.viewportHeight,l=this.getTextStyle().fontSize;return Eot(n.y,i,o,s,l)},t.prototype.getTextPosition=function(){var r=this.getTextArea(),n=this.headerConfig,i=n.scrollY,a=n.viewportHeight,o=this.getAdjustTextAreaHeight(r,i,a),s=this.calculateTextY({textArea:r,adjustTextAreaHeight:o}),l=GS(r,this.getTextStyle(),0,this.getIconStyle(),this.getActionIconsCount()).text.x;return{x:l,y:s}},t.prototype.getIconYPosition=function(){var r=this.getTextPosition().y,n=this.getStyle().icon.size,i=this.getTextStyle().fontSize;return r+(i-n)/2},t}($k),jS=function(e){en(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.handleRestOptions=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i=lr(r),a=i[0],o=i.slice(1);e.prototype.handleRestOptions.call(this,a,o),this.frozenRowCell=o[0]},t.prototype.getAdjustTextAreaHeight=function(r,n,i){var a=r.y-this.getFrozenFirstRowHeight(),o=r.height;return!this.spreadsheet.facet.vScrollBar&&a+r.height>n+i&&(o=n+i-a),o},t.prototype.calculateTextY=function(r){var n=r.textArea,i=r.adjustTextAreaHeight,a=this.headerConfig,o=a.scrollY,s=a.viewportHeight,l=this.getTextStyle().fontSize;return Eot(n.y,i,o+this.getFrozenFirstRowHeight(),s,l)},t.prototype.getResizeClipAreaBBox=function(){return Zt(Zt({},e.prototype.getResizeClipAreaBBox.call(this)),{y:this.getFrozenFirstRowHeight()})},t.prototype.getFrozenFirstRowHeight=function(){var r;if(this.frozenRowCell)return 0;var n=this.spreadsheet,i=n.facet,a=n.options,o=rb(a,(r=i==null?void 0:i.layoutResult)===null||r===void 0?void 0:r.rowNodes).frozenRowHeight;return o},t}(Zde),wot=function(e){en(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.initCell=function(){this.drawBackgroundShape(),this.drawRectBorder(),this.drawTextShape()},t.prototype.getTextStyle=function(){var r;return(r=this.getStyle())===null||r===void 0?void 0:r.seriesText},t.prototype.getTextPosition=function(){return e.prototype.getTextPosition.call(this)},t.prototype.getActionIconsCount=function(){return 0},t.prototype.getIconStyle=function(){},t.prototype.drawResizeAreaInLeaf=function(){},t.prototype.update=function(){},t.prototype.findFieldCondition=function(){},t.prototype.mappingValue=function(){},t}(jS),CR=function(e){return[Pu.META,Pu.CONTROL].includes(e.key)},Cot=function(e){return e.ctrlKey||e.metaKey},Hp=function(e){var t=e.getMeta(),r=t||{},n=r.id,i=r.colIndex,a=r.rowIndex,o=r.rowQuery;return{id:n,colIndex:i,rowIndex:a,type:e.cellType,rowQuery:o}},qde=function(e,t){var r=e.interaction;r.changeState({stateName:On.SELECTED,cells:t}),e.emit(Me.GLOBAL_SELECTED,r.getActiveCells())};function SB(e,t){var r=Math.min(e.rowIndex,t.rowIndex),n=Math.max(e.rowIndex,t.rowIndex),i=Math.min(e.colIndex,t.colIndex),a=Math.max(e.colIndex,t.colIndex);return{start:{rowIndex:r,colIndex:i},end:{rowIndex:n,colIndex:a}}}function Kde(e,t){var r=t.interaction,n=t.facet,i=t.options;if(t.isTableMode()){if(!i.showSeriesNumber)return[];var a=n.layoutResult.colLeafNodes[0].id,o=WS(String(e.rowIndex),a),s=[],l=r.getAllCells().find(function(u){return u.getMeta().id===o});return l&&l instanceof xot&&s.push(l),s}return Fk(e.rowId,r.getAllRowHeaderCells(),t.isHierarchyTreeType())}var Hk=function(e,t){var r=e.getSelectedCellHighlight(),n=r.colHeader,i=r.rowHeader;n&&e.updateCells(e.getAllColHeaderCells()),i&&e.updateCells(e.getAllRowHeaderCells()),t()},Sot=function(e){var t=e.store.get("visibleActionIcons"),r=e.interaction.getInteractedCells(),n=e.interaction.getState().cells;if(Or(r)&&Or(n)&&Or(t))return!1;if(xi(t,function(a){a.set("visible",!1)}),e.store.set("visibleActionIcons",[]),xi(r,function(a){a.hideInteractionShape()}),e.interaction.resetState(),e.options.interaction.selectedCellsSpotlight){var i=e.interaction.getPanelGroupAllUnSelectedDataCells()||[];xi(i,function(a){a.clearUnselectedState()})}return!0},Qde=function(e,t){var r=t==null?void 0:t.stateName;e.interaction.isEqualStateName(r)||(Sot(e),e.hideTooltip(),e.store.set(KF,t))},Jde=function(e,t,r){var n,i,a=r.facet,o=a.panelBBox.width,s=a==null?void 0:a.frozenGroupInfo,l=(n=s==null?void 0:s.frozenCol.width)!==null&&n!==void 0?n:0,u=(i=s==null?void 0:s.frozenTrailingCol.width)!==null&&i!==void 0?i:0,c=a.layoutResult.colLeafNodes[e];return t===Fl.SCROLL_UP?c.x-l:c.x+c.width-(o-u)},tpe=function(e,t,r){var n,i,a=r.facet,o=a.viewCellHeights.getCellOffsetY,s=a.panelBBox.height,l=o(e+1);if(bl(l))return 0;var u=a==null?void 0:a.frozenGroupInfo,c=(n=u==null?void 0:u.frozenRow.height)!==null&&n!==void 0?n:0,f=(i=u==null?void 0:u.frozenTrailingRow.height)!==null&&i!==void 0?i:0;return t===Fl.SCROLL_UP?o(e)-c:l-(s-f)};/*!
 *  decimal.js v10.4.3
 *  An arbitrary-precision Decimal type for JavaScript.
 *  https://github.com/MikeMcl/decimal.js
 *  Copyright (c) 2022 Michael Mclaughlin <M8ch88l@gmail.com>
 *  MIT Licence
 */var rx=9e15,x0=1e9,TB="0123456789abcdef",SR="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",TR="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",AB={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-rx,maxE:rx,crypto:!1},Tot,Kv,bi=!0,E3="[DecimalError] ",n0=E3+"Invalid argument: ",Aot=E3+"Precision limit exceeded",Mot=E3+"crypto unavailable",Rot="[object Decimal]",Uu=Math.floor,pl=Math.pow,epe=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,rpe=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,npe=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,Iot=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,zd=1e7,ni=7,ipe=9007199254740991,ape=SR.length-1,MB=TR.length-1,vr={toStringTag:Rot};vr.absoluteValue=vr.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),Hn(e)};vr.ceil=function(){return Hn(new this.constructor(this),this.e+1,2)};vr.clampedTo=vr.clamp=function(e,t){var r,n=this,i=n.constructor;if(e=new i(e),t=new i(t),!e.s||!t.s)return new i(NaN);if(e.gt(t))throw Error(n0+t);return r=n.cmp(e),r<0?e:n.cmp(t)>0?t:new i(n)};vr.comparedTo=vr.cmp=function(e){var t,r,n,i,a=this,o=a.d,s=(e=new a.constructor(e)).d,l=a.s,u=e.s;if(!o||!s)return!l||!u?NaN:l!==u?l:o===s?0:!o^l<0?1:-1;if(!o[0]||!s[0])return o[0]?l:s[0]?-u:0;if(l!==u)return l;if(a.e!==e.e)return a.e>e.e^l<0?1:-1;for(n=o.length,i=s.length,t=0,r=n<i?n:i;t<r;++t)if(o[t]!==s[t])return o[t]>s[t]^l<0?1:-1;return n===i?0:n>i^l<0?1:-1};vr.cosine=vr.cos=function(){var e,t,r=this,n=r.constructor;return r.d?r.d[0]?(e=n.precision,t=n.rounding,n.precision=e+Math.max(r.e,r.sd())+ni,n.rounding=1,r=ope(n,Fot(n,r)),n.precision=e,n.rounding=t,Hn(Kv==2||Kv==3?r.neg():r,e,t,!0)):new n(1):new n(NaN)};vr.cubeRoot=vr.cbrt=function(){var e,t,r,n,i,a,o,s,l,u,c=this,f=c.constructor;if(!c.isFinite()||c.isZero())return new f(c);for(bi=!1,a=c.s*pl(c.s*c,1/3),!a||Math.abs(a)==1/0?(r=uu(c.d),e=c.e,(a=(e-r.length+1)%3)&&(r+=a==1||a==-2?"0":"00"),a=pl(r,1/3),e=Uu((e+1)/3)-(e%3==(e<0?-1:2)),a==1/0?r="5e"+e:(r=a.toExponential(),r=r.slice(0,r.indexOf("e")+1)+e),n=new f(r),n.s=c.s):n=new f(a.toString()),o=(e=f.precision)+3;;)if(s=n,l=s.times(s).times(s),u=l.plus(c),n=yo(u.plus(c).times(s),u.plus(l),o+2,1),uu(s.d).slice(0,o)===(r=uu(n.d)).slice(0,o))if(r=r.slice(o-3,o+1),r=="9999"||!i&&r=="4999"){if(!i&&(Hn(s,e+1,0),s.times(s).times(s).eq(c))){n=s;break}o+=4,i=1}else{(!+r||!+r.slice(1)&&r.charAt(0)=="5")&&(Hn(n,e+1,1),t=!n.times(n).times(n).eq(c));break}return bi=!0,Hn(n,e,f.rounding,t)};vr.decimalPlaces=vr.dp=function(){var e,t=this.d,r=NaN;if(t){if(e=t.length-1,r=(e-Uu(this.e/ni))*ni,e=t[e],e)for(;e%10==0;e/=10)r--;r<0&&(r=0)}return r};vr.dividedBy=vr.div=function(e){return yo(this,new this.constructor(e))};vr.dividedToIntegerBy=vr.divToInt=function(e){var t=this,r=t.constructor;return Hn(yo(t,new r(e),0,1,1),r.precision,r.rounding)};vr.equals=vr.eq=function(e){return this.cmp(e)===0};vr.floor=function(){return Hn(new this.constructor(this),this.e+1,3)};vr.greaterThan=vr.gt=function(e){return this.cmp(e)>0};vr.greaterThanOrEqualTo=vr.gte=function(e){var t=this.cmp(e);return t==1||t===0};vr.hyperbolicCosine=vr.cosh=function(){var e,t,r,n,i,a=this,o=a.constructor,s=new o(1);if(!a.isFinite())return new o(a.s?1/0:NaN);if(a.isZero())return s;r=o.precision,n=o.rounding,o.precision=r+Math.max(a.e,a.sd())+4,o.rounding=1,i=a.d.length,i<32?(e=Math.ceil(i/3),t=(1/C3(4,e)).toString()):(e=16,t="2.3283064365386962890625e-10"),a=ib(o,1,a.times(t),new o(1),!0);for(var l,u=e,c=new o(8);u--;)l=a.times(a),a=s.minus(l.times(c.minus(l.times(c))));return Hn(a,o.precision=r,o.rounding=n,!0)};vr.hyperbolicSine=vr.sinh=function(){var e,t,r,n,i=this,a=i.constructor;if(!i.isFinite()||i.isZero())return new a(i);if(t=a.precision,r=a.rounding,a.precision=t+Math.max(i.e,i.sd())+4,a.rounding=1,n=i.d.length,n<3)i=ib(a,2,i,i,!0);else{e=1.4*Math.sqrt(n),e=e>16?16:e|0,i=i.times(1/C3(5,e)),i=ib(a,2,i,i,!0);for(var o,s=new a(5),l=new a(16),u=new a(20);e--;)o=i.times(i),i=i.times(s.plus(o.times(l.times(o).plus(u))))}return a.precision=t,a.rounding=r,Hn(i,t,r,!0)};vr.hyperbolicTangent=vr.tanh=function(){var e,t,r=this,n=r.constructor;return r.isFinite()?r.isZero()?new n(r):(e=n.precision,t=n.rounding,n.precision=e+7,n.rounding=1,yo(r.sinh(),r.cosh(),n.precision=e,n.rounding=t)):new n(r.s)};vr.inverseCosine=vr.acos=function(){var e,t=this,r=t.constructor,n=t.abs().cmp(1),i=r.precision,a=r.rounding;return n!==-1?n===0?t.isNeg()?Dd(r,i,a):new r(0):new r(NaN):t.isZero()?Dd(r,i+4,a).times(.5):(r.precision=i+6,r.rounding=1,t=t.asin(),e=Dd(r,i+4,a).times(.5),r.precision=i,r.rounding=a,e.minus(t))};vr.inverseHyperbolicCosine=vr.acosh=function(){var e,t,r=this,n=r.constructor;return r.lte(1)?new n(r.eq(1)?0:NaN):r.isFinite()?(e=n.precision,t=n.rounding,n.precision=e+Math.max(Math.abs(r.e),r.sd())+4,n.rounding=1,bi=!1,r=r.times(r).minus(1).sqrt().plus(r),bi=!0,n.precision=e,n.rounding=t,r.ln()):new n(r)};vr.inverseHyperbolicSine=vr.asinh=function(){var e,t,r=this,n=r.constructor;return!r.isFinite()||r.isZero()?new n(r):(e=n.precision,t=n.rounding,n.precision=e+2*Math.max(Math.abs(r.e),r.sd())+6,n.rounding=1,bi=!1,r=r.times(r).plus(1).sqrt().plus(r),bi=!0,n.precision=e,n.rounding=t,r.ln())};vr.inverseHyperbolicTangent=vr.atanh=function(){var e,t,r,n,i=this,a=i.constructor;return i.isFinite()?i.e>=0?new a(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(e=a.precision,t=a.rounding,n=i.sd(),Math.max(n,e)<2*-i.e-1?Hn(new a(i),e,t,!0):(a.precision=r=n-i.e,i=yo(i.plus(1),new a(1).minus(i),r+e,1),a.precision=e+4,a.rounding=1,i=i.ln(),a.precision=e,a.rounding=t,i.times(.5))):new a(NaN)};vr.inverseSine=vr.asin=function(){var e,t,r,n,i=this,a=i.constructor;return i.isZero()?new a(i):(t=i.abs().cmp(1),r=a.precision,n=a.rounding,t!==-1?t===0?(e=Dd(a,r+4,n).times(.5),e.s=i.s,e):new a(NaN):(a.precision=r+6,a.rounding=1,i=i.div(new a(1).minus(i.times(i)).sqrt().plus(1)).atan(),a.precision=r,a.rounding=n,i.times(2)))};vr.inverseTangent=vr.atan=function(){var e,t,r,n,i,a,o,s,l,u=this,c=u.constructor,f=c.precision,d=c.rounding;if(u.isFinite()){if(u.isZero())return new c(u);if(u.abs().eq(1)&&f+4<=MB)return o=Dd(c,f+4,d).times(.25),o.s=u.s,o}else{if(!u.s)return new c(NaN);if(f+4<=MB)return o=Dd(c,f+4,d).times(.5),o.s=u.s,o}for(c.precision=s=f+10,c.rounding=1,r=Math.min(28,s/ni+2|0),e=r;e;--e)u=u.div(u.times(u).plus(1).sqrt().plus(1));for(bi=!1,t=Math.ceil(s/ni),n=1,l=u.times(u),o=new c(u),i=u;e!==-1;)if(i=i.times(l),a=o.minus(i.div(n+=2)),i=i.times(l),o=a.plus(i.div(n+=2)),o.d[t]!==void 0)for(e=t;o.d[e]===a.d[e]&&e--;);return r&&(o=o.times(2<<r-1)),bi=!0,Hn(o,c.precision=f,c.rounding=d,!0)};vr.isFinite=function(){return!!this.d};vr.isInteger=vr.isInt=function(){return!!this.d&&Uu(this.e/ni)>this.d.length-2};vr.isNaN=function(){return!this.s};vr.isNegative=vr.isNeg=function(){return this.s<0};vr.isPositive=vr.isPos=function(){return this.s>0};vr.isZero=function(){return!!this.d&&this.d[0]===0};vr.lessThan=vr.lt=function(e){return this.cmp(e)<0};vr.lessThanOrEqualTo=vr.lte=function(e){return this.cmp(e)<1};vr.logarithm=vr.log=function(e){var t,r,n,i,a,o,s,l,u=this,c=u.constructor,f=c.precision,d=c.rounding,v=5;if(e==null)e=new c(10),t=!0;else{if(e=new c(e),r=e.d,e.s<0||!r||!r[0]||e.eq(1))return new c(NaN);t=e.eq(10)}if(r=u.d,u.s<0||!r||!r[0]||u.eq(1))return new c(r&&!r[0]?-1/0:u.s!=1?NaN:r?0:1/0);if(t)if(r.length>1)a=!0;else{for(i=r[0];i%10===0;)i/=10;a=i!==1}if(bi=!1,s=f+v,o=Lm(u,s),n=t?AR(c,s+10):Lm(e,s),l=yo(o,n,s,1),XC(l.d,i=f,d))do if(s+=10,o=Lm(u,s),n=t?AR(c,s+10):Lm(e,s),l=yo(o,n,s,1),!a){+uu(l.d).slice(i+1,i+15)+1==1e14&&(l=Hn(l,f+1,0));break}while(XC(l.d,i+=10,d));return bi=!0,Hn(l,f,d)};vr.minus=vr.sub=function(e){var t,r,n,i,a,o,s,l,u,c,f,d,v=this,g=v.constructor;if(e=new g(e),!v.d||!e.d)return!v.s||!e.s?e=new g(NaN):v.d?e.s=-e.s:e=new g(e.d||v.s!==e.s?v:NaN),e;if(v.s!=e.s)return e.s=-e.s,v.plus(e);if(u=v.d,d=e.d,s=g.precision,l=g.rounding,!u[0]||!d[0]){if(d[0])e.s=-e.s;else if(u[0])e=new g(v);else return new g(l===3?-0:0);return bi?Hn(e,s,l):e}if(r=Uu(e.e/ni),c=Uu(v.e/ni),u=u.slice(),a=c-r,a){for(f=a<0,f?(t=u,a=-a,o=d.length):(t=d,r=c,o=u.length),n=Math.max(Math.ceil(s/ni),o)+2,a>n&&(a=n,t.length=1),t.reverse(),n=a;n--;)t.push(0);t.reverse()}else{for(n=u.length,o=d.length,f=n<o,f&&(o=n),n=0;n<o;n++)if(u[n]!=d[n]){f=u[n]<d[n];break}a=0}for(f&&(t=u,u=d,d=t,e.s=-e.s),o=u.length,n=d.length-o;n>0;--n)u[o++]=0;for(n=d.length;n>a;){if(u[--n]<d[n]){for(i=n;i&&u[--i]===0;)u[i]=zd-1;--u[i],u[n]+=zd}u[n]-=d[n]}for(;u[--o]===0;)u.pop();for(;u[0]===0;u.shift())--r;return u[0]?(e.d=u,e.e=w3(u,r),bi?Hn(e,s,l):e):new g(l===3?-0:0)};vr.modulo=vr.mod=function(e){var t,r=this,n=r.constructor;return e=new n(e),!r.d||!e.s||e.d&&!e.d[0]?new n(NaN):!e.d||r.d&&!r.d[0]?Hn(new n(r),n.precision,n.rounding):(bi=!1,n.modulo==9?(t=yo(r,e.abs(),0,3,1),t.s*=e.s):t=yo(r,e,0,n.modulo,1),t=t.times(e),bi=!0,r.minus(t))};vr.naturalExponential=vr.exp=function(){return RB(this)};vr.naturalLogarithm=vr.ln=function(){return Lm(this)};vr.negated=vr.neg=function(){var e=new this.constructor(this);return e.s=-e.s,Hn(e)};vr.plus=vr.add=function(e){var t,r,n,i,a,o,s,l,u,c,f=this,d=f.constructor;if(e=new d(e),!f.d||!e.d)return!f.s||!e.s?e=new d(NaN):f.d||(e=new d(e.d||f.s===e.s?f:NaN)),e;if(f.s!=e.s)return e.s=-e.s,f.minus(e);if(u=f.d,c=e.d,s=d.precision,l=d.rounding,!u[0]||!c[0])return c[0]||(e=new d(f)),bi?Hn(e,s,l):e;if(a=Uu(f.e/ni),n=Uu(e.e/ni),u=u.slice(),i=a-n,i){for(i<0?(r=u,i=-i,o=c.length):(r=c,n=a,o=u.length),a=Math.ceil(s/ni),o=a>o?a+1:o+1,i>o&&(i=o,r.length=1),r.reverse();i--;)r.push(0);r.reverse()}for(o=u.length,i=c.length,o-i<0&&(i=o,r=c,c=u,u=r),t=0;i;)t=(u[--i]=u[i]+c[i]+t)/zd|0,u[i]%=zd;for(t&&(u.unshift(t),++n),o=u.length;u[--o]==0;)u.pop();return e.d=u,e.e=w3(u,n),bi?Hn(e,s,l):e};vr.precision=vr.sd=function(e){var t,r=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(n0+e);return r.d?(t=Lot(r.d),e&&r.e+1>t&&(t=r.e+1)):t=NaN,t};vr.round=function(){var e=this,t=e.constructor;return Hn(new t(e),e.e+1,t.rounding)};vr.sine=vr.sin=function(){var e,t,r=this,n=r.constructor;return r.isFinite()?r.isZero()?new n(r):(e=n.precision,t=n.rounding,n.precision=e+Math.max(r.e,r.sd())+ni,n.rounding=1,r=lpe(n,Fot(n,r)),n.precision=e,n.rounding=t,Hn(Kv>2?r.neg():r,e,t,!0)):new n(NaN)};vr.squareRoot=vr.sqrt=function(){var e,t,r,n,i,a,o=this,s=o.d,l=o.e,u=o.s,c=o.constructor;if(u!==1||!s||!s[0])return new c(!u||u<0&&(!s||s[0])?NaN:s?o:1/0);for(bi=!1,u=Math.sqrt(+o),u==0||u==1/0?(t=uu(s),(t.length+l)%2==0&&(t+="0"),u=Math.sqrt(t),l=Uu((l+1)/2)-(l<0||l%2),u==1/0?t="5e"+l:(t=u.toExponential(),t=t.slice(0,t.indexOf("e")+1)+l),n=new c(t)):n=new c(u.toString()),r=(l=c.precision)+3;;)if(a=n,n=a.plus(yo(o,a,r+2,1)).times(.5),uu(a.d).slice(0,r)===(t=uu(n.d)).slice(0,r))if(t=t.slice(r-3,r+1),t=="9999"||!i&&t=="4999"){if(!i&&(Hn(a,l+1,0),a.times(a).eq(o))){n=a;break}r+=4,i=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&(Hn(n,l+1,1),e=!n.times(n).eq(o));break}return bi=!0,Hn(n,l,c.rounding,e)};vr.tangent=vr.tan=function(){var e,t,r=this,n=r.constructor;return r.isFinite()?r.isZero()?new n(r):(e=n.precision,t=n.rounding,n.precision=e+10,n.rounding=1,r=r.sin(),r.s=1,r=yo(r,new n(1).minus(r.times(r)).sqrt(),e+10,0),n.precision=e,n.rounding=t,Hn(Kv==2||Kv==4?r.neg():r,e,t,!0)):new n(NaN)};vr.times=vr.mul=function(e){var t,r,n,i,a,o,s,l,u,c=this,f=c.constructor,d=c.d,v=(e=new f(e)).d;if(e.s*=c.s,!d||!d[0]||!v||!v[0])return new f(!e.s||d&&!d[0]&&!v||v&&!v[0]&&!d?NaN:!d||!v?e.s/0:e.s*0);for(r=Uu(c.e/ni)+Uu(e.e/ni),l=d.length,u=v.length,l<u&&(a=d,d=v,v=a,o=l,l=u,u=o),a=[],o=l+u,n=o;n--;)a.push(0);for(n=u;--n>=0;){for(t=0,i=l+n;i>n;)s=a[i]+v[n]*d[i-n-1]+t,a[i--]=s%zd|0,t=s/zd|0;a[i]=(a[i]+t)%zd|0}for(;!a[--o];)a.pop();return t?++r:a.shift(),e.d=a,e.e=w3(a,r),bi?Hn(e,f.precision,f.rounding):e};vr.toBinary=function(e,t){return Vk(this,2,e,t)};vr.toDecimalPlaces=vr.toDP=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(th(e,0,x0),t===void 0?t=n.rounding:th(t,0,8),Hn(r,e+r.e+1,t))};vr.toExponential=function(e,t){var r,n=this,i=n.constructor;return e===void 0?r=Zp(n,!0):(th(e,0,x0),t===void 0?t=i.rounding:th(t,0,8),n=Hn(new i(n),e+1,t),r=Zp(n,!0,e+1)),n.isNeg()&&!n.isZero()?"-"+r:r};vr.toFixed=function(e,t){var r,n,i=this,a=i.constructor;return e===void 0?r=Zp(i):(th(e,0,x0),t===void 0?t=a.rounding:th(t,0,8),n=Hn(new a(i),e+i.e+1,t),r=Zp(n,!1,e+n.e+1)),i.isNeg()&&!i.isZero()?"-"+r:r};vr.toFraction=function(e){var t,r,n,i,a,o,s,l,u,c,f,d,v=this,g=v.d,x=v.constructor;if(!g)return new x(v);if(u=r=new x(1),n=l=new x(0),t=new x(n),a=t.e=Lot(g)-v.e-1,o=a%ni,t.d[0]=pl(10,o<0?ni+o:o),e==null)e=a>0?t:u;else{if(s=new x(e),!s.isInt()||s.lt(u))throw Error(n0+s);e=s.gt(t)?a>0?t:u:s}for(bi=!1,s=new x(uu(g)),c=x.precision,x.precision=a=g.length*ni*2;f=yo(s,t,0,1,1),i=r.plus(f.times(n)),i.cmp(e)!=1;)r=n,n=i,i=u,u=l.plus(f.times(i)),l=i,i=t,t=s.minus(f.times(i)),s=i;return i=yo(e.minus(r),n,0,1,1),l=l.plus(i.times(u)),r=r.plus(i.times(n)),l.s=u.s=v.s,d=yo(u,n,a,1).minus(v).abs().cmp(yo(l,r,a,1).minus(v).abs())<1?[u,n]:[l,r],x.precision=c,bi=!0,d};vr.toHexadecimal=vr.toHex=function(e,t){return Vk(this,16,e,t)};vr.toNearest=function(e,t){var r=this,n=r.constructor;if(r=new n(r),e==null){if(!r.d)return r;e=new n(1),t=n.rounding}else{if(e=new n(e),t===void 0?t=n.rounding:th(t,0,8),!r.d)return e.s?r:e;if(!e.d)return e.s&&(e.s=r.s),e}return e.d[0]?(bi=!1,r=yo(r,e,0,t,1).times(e),bi=!0,Hn(r)):(e.s=r.s,r=e),r};vr.toNumber=function(){return+this};vr.toOctal=function(e,t){return Vk(this,8,e,t)};vr.toPower=vr.pow=function(e){var t,r,n,i,a,o,s=this,l=s.constructor,u=+(e=new l(e));if(!s.d||!e.d||!s.d[0]||!e.d[0])return new l(pl(+s,u));if(s=new l(s),s.eq(1))return s;if(n=l.precision,a=l.rounding,e.eq(1))return Hn(s,n,a);if(t=Uu(e.e/ni),t>=e.d.length-1&&(r=u<0?-u:u)<=ipe)return i=Oot(l,s,r,n),e.s<0?new l(1).div(i):Hn(i,n,a);if(o=s.s,o<0){if(t<e.d.length-1)return new l(NaN);if(e.d[t]&1||(o=1),s.e==0&&s.d[0]==1&&s.d.length==1)return s.s=o,s}return r=pl(+s,u),t=r==0||!isFinite(r)?Uu(u*(Math.log("0."+uu(s.d))/Math.LN10+s.e+1)):new l(r+"").e,t>l.maxE+1||t<l.minE-1?new l(t>0?o/0:0):(bi=!1,l.rounding=s.s=1,r=Math.min(12,(t+"").length),i=RB(e.times(Lm(s,n+r)),n),i.d&&(i=Hn(i,n+5,1),XC(i.d,n,a)&&(t=n+10,i=Hn(RB(e.times(Lm(s,t+r)),t),t+5,1),+uu(i.d).slice(n+1,n+15)+1==1e14&&(i=Hn(i,n+1,0)))),i.s=o,bi=!0,l.rounding=a,Hn(i,n,a))};vr.toPrecision=function(e,t){var r,n=this,i=n.constructor;return e===void 0?r=Zp(n,n.e<=i.toExpNeg||n.e>=i.toExpPos):(th(e,1,x0),t===void 0?t=i.rounding:th(t,0,8),n=Hn(new i(n),e,t),r=Zp(n,e<=n.e||n.e<=i.toExpNeg,e)),n.isNeg()&&!n.isZero()?"-"+r:r};vr.toSignificantDigits=vr.toSD=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(th(e,1,x0),t===void 0?t=n.rounding:th(t,0,8)),Hn(new n(r),e,t)};vr.toString=function(){var e=this,t=e.constructor,r=Zp(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()&&!e.isZero()?"-"+r:r};vr.truncated=vr.trunc=function(){return Hn(new this.constructor(this),this.e+1,1)};vr.valueOf=vr.toJSON=function(){var e=this,t=e.constructor,r=Zp(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()?"-"+r:r};function uu(e){var t,r,n,i=e.length-1,a="",o=e[0];if(i>0){for(a+=o,t=1;t<i;t++)n=e[t]+"",r=ni-n.length,r&&(a+=_m(r)),a+=n;o=e[t],n=o+"",r=ni-n.length,r&&(a+=_m(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return a+o}function th(e,t,r){if(e!==~~e||e<t||e>r)throw Error(n0+e)}function XC(e,t,r,n){var i,a,o,s;for(a=e[0];a>=10;a/=10)--t;return--t<0?(t+=ni,i=0):(i=Math.ceil((t+1)/ni),t%=ni),a=pl(10,ni-t),s=e[i]%a|0,n==null?t<3?(t==0?s=s/100|0:t==1&&(s=s/10|0),o=r<4&&s==99999||r>3&&s==49999||s==5e4||s==0):o=(r<4&&s+1==a||r>3&&s+1==a/2)&&(e[i+1]/a/100|0)==pl(10,t-2)-1||(s==a/2||s==0)&&(e[i+1]/a/100|0)==0:t<4?(t==0?s=s/1e3|0:t==1?s=s/100|0:t==2&&(s=s/10|0),o=(n||r<4)&&s==9999||!n&&r>3&&s==4999):o=((n||r<4)&&s+1==a||!n&&r>3&&s+1==a/2)&&(e[i+1]/a/1e3|0)==pl(10,t-3)-1,o}function WA(e,t,r){for(var n,i=[0],a,o=0,s=e.length;o<s;){for(a=i.length;a--;)i[a]*=t;for(i[0]+=TB.indexOf(e.charAt(o++)),n=0;n<i.length;n++)i[n]>r-1&&(i[n+1]===void 0&&(i[n+1]=0),i[n+1]+=i[n]/r|0,i[n]%=r)}return i.reverse()}function ope(e,t){var r,n,i;if(t.isZero())return t;n=t.d.length,n<32?(r=Math.ceil(n/3),i=(1/C3(4,r)).toString()):(r=16,i="2.3283064365386962890625e-10"),e.precision+=r,t=ib(e,1,t.times(i),new e(1));for(var a=r;a--;){var o=t.times(t);t=o.times(o).minus(o).times(8).plus(1)}return e.precision-=r,t}var yo=function(){function e(n,i,a){var o,s=0,l=n.length;for(n=n.slice();l--;)o=n[l]*i+s,n[l]=o%a|0,s=o/a|0;return s&&n.unshift(s),n}function t(n,i,a,o){var s,l;if(a!=o)l=a>o?1:-1;else for(s=l=0;s<a;s++)if(n[s]!=i[s]){l=n[s]>i[s]?1:-1;break}return l}function r(n,i,a,o){for(var s=0;a--;)n[a]-=s,s=n[a]<i[a]?1:0,n[a]=s*o+n[a]-i[a];for(;!n[0]&&n.length>1;)n.shift()}return function(n,i,a,o,s,l){var u,c,f,d,v,g,x,w,S,A,M,R,O,N,k,V,Q,Y,X,tt,it=n.constructor,Et=n.s==i.s?1:-1,Tt=n.d,pt=i.d;if(!Tt||!Tt[0]||!pt||!pt[0])return new it(!n.s||!i.s||(Tt?pt&&Tt[0]==pt[0]:!pt)?NaN:Tt&&Tt[0]==0||!pt?Et*0:Et/0);for(l?(v=1,c=n.e-i.e):(l=zd,v=ni,c=Uu(n.e/v)-Uu(i.e/v)),X=pt.length,Q=Tt.length,S=new it(Et),A=S.d=[],f=0;pt[f]==(Tt[f]||0);f++);if(pt[f]>(Tt[f]||0)&&c--,a==null?(N=a=it.precision,o=it.rounding):s?N=a+(n.e-i.e)+1:N=a,N<0)A.push(1),g=!0;else{if(N=N/v+2|0,f=0,X==1){for(d=0,pt=pt[0],N++;(f<Q||d)&&N--;f++)k=d*l+(Tt[f]||0),A[f]=k/pt|0,d=k%pt|0;g=d||f<Q}else{for(d=l/(pt[0]+1)|0,d>1&&(pt=e(pt,d,l),Tt=e(Tt,d,l),X=pt.length,Q=Tt.length),V=X,M=Tt.slice(0,X),R=M.length;R<X;)M[R++]=0;tt=pt.slice(),tt.unshift(0),Y=pt[0],pt[1]>=l/2&&++Y;do d=0,u=t(pt,M,X,R),u<0?(O=M[0],X!=R&&(O=O*l+(M[1]||0)),d=O/Y|0,d>1?(d>=l&&(d=l-1),x=e(pt,d,l),w=x.length,R=M.length,u=t(x,M,w,R),u==1&&(d--,r(x,X<w?tt:pt,w,l))):(d==0&&(u=d=1),x=pt.slice()),w=x.length,w<R&&x.unshift(0),r(M,x,R,l),u==-1&&(R=M.length,u=t(pt,M,X,R),u<1&&(d++,r(M,X<R?tt:pt,R,l))),R=M.length):u===0&&(d++,M=[0]),A[f++]=d,u&&M[0]?M[R++]=Tt[V]||0:(M=[Tt[V]],R=1);while((V++<Q||M[0]!==void 0)&&N--);g=M[0]!==void 0}A[0]||A.shift()}if(v==1)S.e=c,Tot=g;else{for(f=1,d=A[0];d>=10;d/=10)f++;S.e=f+c*v-1,Hn(S,s?a+S.e+1:a,o,g)}return S}}();function Hn(e,t,r,n){var i,a,o,s,l,u,c,f,d,v=e.constructor;t:if(t!=null){if(f=e.d,!f)return e;for(i=1,s=f[0];s>=10;s/=10)i++;if(a=t-i,a<0)a+=ni,o=t,c=f[d=0],l=c/pl(10,i-o-1)%10|0;else if(d=Math.ceil((a+1)/ni),s=f.length,d>=s)if(n){for(;s++<=d;)f.push(0);c=l=0,i=1,a%=ni,o=a-ni+1}else break t;else{for(c=s=f[d],i=1;s>=10;s/=10)i++;a%=ni,o=a-ni+i,l=o<0?0:c/pl(10,i-o-1)%10|0}if(n=n||t<0||f[d+1]!==void 0||(o<0?c:c%pl(10,i-o-1)),u=r<4?(l||n)&&(r==0||r==(e.s<0?3:2)):l>5||l==5&&(r==4||n||r==6&&(a>0?o>0?c/pl(10,i-o):0:f[d-1])%10&1||r==(e.s<0?8:7)),t<1||!f[0])return f.length=0,u?(t-=e.e+1,f[0]=pl(10,(ni-t%ni)%ni),e.e=-t||0):f[0]=e.e=0,e;if(a==0?(f.length=d,s=1,d--):(f.length=d+1,s=pl(10,ni-a),f[d]=o>0?(c/pl(10,i-o)%pl(10,o)|0)*s:0),u)for(;;)if(d==0){for(a=1,o=f[0];o>=10;o/=10)a++;for(o=f[0]+=s,s=1;o>=10;o/=10)s++;a!=s&&(e.e++,f[0]==zd&&(f[0]=1));break}else{if(f[d]+=s,f[d]!=zd)break;f[d--]=0,s=1}for(a=f.length;f[--a]===0;)f.pop()}return bi&&(e.e>v.maxE?(e.d=null,e.e=NaN):e.e<v.minE&&(e.e=0,e.d=[0])),e}function Zp(e,t,r){if(!e.isFinite())return Dot(e);var n,i=e.e,a=uu(e.d),o=a.length;return t?(r&&(n=r-o)>0?a=a.charAt(0)+"."+a.slice(1)+_m(n):o>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(e.e<0?"e":"e+")+e.e):i<0?(a="0."+_m(-i-1)+a,r&&(n=r-o)>0&&(a+=_m(n))):i>=o?(a+=_m(i+1-o),r&&(n=r-i-1)>0&&(a=a+"."+_m(n))):((n=i+1)<o&&(a=a.slice(0,n)+"."+a.slice(n)),r&&(n=r-o)>0&&(i+1===o&&(a+="."),a+=_m(n))),a}function w3(e,t){var r=e[0];for(t*=ni;r>=10;r/=10)t++;return t}function AR(e,t,r){if(t>ape)throw bi=!0,r&&(e.precision=r),Error(Aot);return Hn(new e(SR),t,1,!0)}function Dd(e,t,r){if(t>MB)throw Error(Aot);return Hn(new e(TR),t,r,!0)}function Lot(e){var t=e.length-1,r=t*ni+1;if(t=e[t],t){for(;t%10==0;t/=10)r--;for(t=e[0];t>=10;t/=10)r++}return r}function _m(e){for(var t="";e--;)t+="0";return t}function Oot(e,t,r,n){var i,a=new e(1),o=Math.ceil(n/ni+4);for(bi=!1;;){if(r%2&&(a=a.times(t),RX(a.d,o)&&(i=!0)),r=Uu(r/2),r===0){r=a.d.length-1,i&&a.d[r]===0&&++a.d[r];break}t=t.times(t),RX(t.d,o)}return bi=!0,a}function MX(e){return e.d[e.d.length-1]&1}function Pot(e,t,r){for(var n,i=new e(t[0]),a=0;++a<t.length;)if(n=new e(t[a]),n.s)i[r](n)&&(i=n);else{i=n;break}return i}function RB(e,t){var r,n,i,a,o,s,l,u=0,c=0,f=0,d=e.constructor,v=d.rounding,g=d.precision;if(!e.d||!e.d[0]||e.e>17)return new d(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:0/0);for(t==null?(bi=!1,l=g):l=t,s=new d(.03125);e.e>-2;)e=e.times(s),f+=5;for(n=Math.log(pl(2,f))/Math.LN10*2+5|0,l+=n,r=a=o=new d(1),d.precision=l;;){if(a=Hn(a.times(e),l,1),r=r.times(++c),s=o.plus(yo(a,r,l,1)),uu(s.d).slice(0,l)===uu(o.d).slice(0,l)){for(i=f;i--;)o=Hn(o.times(o),l,1);if(t==null)if(u<3&&XC(o.d,l-n,v,u))d.precision=l+=10,r=a=s=new d(1),c=0,u++;else return Hn(o,d.precision=g,v,bi=!0);else return d.precision=g,o}o=s}}function Lm(e,t){var r,n,i,a,o,s,l,u,c,f,d,v=1,g=10,x=e,w=x.d,S=x.constructor,A=S.rounding,M=S.precision;if(x.s<0||!w||!w[0]||!x.e&&w[0]==1&&w.length==1)return new S(w&&!w[0]?-1/0:x.s!=1?NaN:w?0:x);if(t==null?(bi=!1,c=M):c=t,S.precision=c+=g,r=uu(w),n=r.charAt(0),Math.abs(a=x.e)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)x=x.times(e),r=uu(x.d),n=r.charAt(0),v++;a=x.e,n>1?(x=new S("0."+r),a++):x=new S(n+"."+r.slice(1))}else return u=AR(S,c+2,M).times(a+""),x=Lm(new S(n+"."+r.slice(1)),c-g).plus(u),S.precision=M,t==null?Hn(x,M,A,bi=!0):x;for(f=x,l=o=x=yo(x.minus(1),x.plus(1),c,1),d=Hn(x.times(x),c,1),i=3;;){if(o=Hn(o.times(d),c,1),u=l.plus(yo(o,new S(i),c,1)),uu(u.d).slice(0,c)===uu(l.d).slice(0,c))if(l=l.times(2),a!==0&&(l=l.plus(AR(S,c+2,M).times(a+""))),l=yo(l,new S(v),c,1),t==null)if(XC(l.d,c-g,A,s))S.precision=c+=g,u=o=x=yo(f.minus(1),f.plus(1),c,1),d=Hn(x.times(x),c,1),i=s=1;else return Hn(l,S.precision=M,A,bi=!0);else return S.precision=M,l;l=u,i+=2}}function Dot(e){return String(e.s*e.s/0)}function IB(e,t){var r,n,i;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;n++);for(i=t.length;t.charCodeAt(i-1)===48;--i);if(t=t.slice(n,i),t){if(i-=n,e.e=r=r-n-1,e.d=[],n=(r+1)%ni,r<0&&(n+=ni),n<i){for(n&&e.d.push(+t.slice(0,n)),i-=ni;n<i;)e.d.push(+t.slice(n,n+=ni));t=t.slice(n),n=ni-t.length}else n-=i;for(;n--;)t+="0";e.d.push(+t),bi&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function spe(e,t){var r,n,i,a,o,s,l,u,c;if(t.indexOf("_")>-1){if(t=t.replace(/(\d)_(?=\d)/g,"$1"),Iot.test(t))return IB(e,t)}else if(t==="Infinity"||t==="NaN")return+t||(e.s=NaN),e.e=NaN,e.d=null,e;if(rpe.test(t))r=16,t=t.toLowerCase();else if(epe.test(t))r=2;else if(npe.test(t))r=8;else throw Error(n0+t);for(a=t.search(/p/i),a>0?(l=+t.slice(a+1),t=t.substring(2,a)):t=t.slice(2),a=t.indexOf("."),o=a>=0,n=e.constructor,o&&(t=t.replace(".",""),s=t.length,a=s-a,i=Oot(n,new n(r),a,a*2)),u=WA(t,r,zd),c=u.length-1,a=c;u[a]===0;--a)u.pop();return a<0?new n(e.s*0):(e.e=w3(u,c),e.d=u,bi=!1,o&&(e=yo(e,i,s*4)),l&&(e=e.times(Math.abs(l)<54?pl(2,l):Gd.pow(2,l))),bi=!0,e)}function lpe(e,t){var r,n=t.d.length;if(n<3)return t.isZero()?t:ib(e,2,t,t);r=1.4*Math.sqrt(n),r=r>16?16:r|0,t=t.times(1/C3(5,r)),t=ib(e,2,t,t);for(var i,a=new e(5),o=new e(16),s=new e(20);r--;)i=t.times(t),t=t.times(a.plus(i.times(o.times(i).minus(s))));return t}function ib(e,t,r,n,i){var a,o,s,l,u=e.precision,c=Math.ceil(u/ni);for(bi=!1,l=r.times(r),s=new e(n);;){if(o=yo(s.times(l),new e(t++*t++),u,1),s=i?n.plus(o):n.minus(o),n=yo(o.times(l),new e(t++*t++),u,1),o=s.plus(n),o.d[c]!==void 0){for(a=c;o.d[a]===s.d[a]&&a--;);if(a==-1)break}a=s,s=n,n=o,o=a}return bi=!0,o.d.length=c+1,o}function C3(e,t){for(var r=e;--t;)r*=e;return r}function Fot(e,t){var r,n=t.s<0,i=Dd(e,e.precision,1),a=i.times(.5);if(t=t.abs(),t.lte(a))return Kv=n?4:1,t;if(r=t.divToInt(i),r.isZero())Kv=n?3:2;else{if(t=t.minus(r.times(i)),t.lte(a))return Kv=MX(r)?n?2:3:n?4:1,t;Kv=MX(r)?n?1:4:n?3:2}return t.minus(i).abs()}function Vk(e,t,r,n){var i,a,o,s,l,u,c,f,d,v=e.constructor,g=r!==void 0;if(g?(th(r,1,x0),n===void 0?n=v.rounding:th(n,0,8)):(r=v.precision,n=v.rounding),!e.isFinite())c=Dot(e);else{for(c=Zp(e),o=c.indexOf("."),g?(i=2,t==16?r=r*4-3:t==8&&(r=r*3-2)):i=t,o>=0&&(c=c.replace(".",""),d=new v(1),d.e=c.length-o,d.d=WA(Zp(d),10,i),d.e=d.d.length),f=WA(c,10,i),a=l=f.length;f[--l]==0;)f.pop();if(!f[0])c=g?"0p+0":"0";else{if(o<0?a--:(e=new v(e),e.d=f,e.e=a,e=yo(e,d,r,n,0,i),f=e.d,a=e.e,u=Tot),o=f[r],s=i/2,u=u||f[r+1]!==void 0,u=n<4?(o!==void 0||u)&&(n===0||n===(e.s<0?3:2)):o>s||o===s&&(n===4||u||n===6&&f[r-1]&1||n===(e.s<0?8:7)),f.length=r,u)for(;++f[--r]>i-1;)f[r]=0,r||(++a,f.unshift(1));for(l=f.length;!f[l-1];--l);for(o=0,c="";o<l;o++)c+=TB.charAt(f[o]);if(g){if(l>1)if(t==16||t==8){for(o=t==16?4:3,--l;l%o;l++)c+="0";for(f=WA(c,i,t),l=f.length;!f[l-1];--l);for(o=1,c="1.";o<l;o++)c+=TB.charAt(f[o])}else c=c.charAt(0)+"."+c.slice(1);c=c+(a<0?"p":"p+")+a}else if(a<0){for(;++a;)c="0"+c;c="0."+c}else if(++a>l)for(a-=l;a--;)c+="0";else a<l&&(c=c.slice(0,a)+"."+c.slice(a))}c=(t==16?"0x":t==2?"0b":t==8?"0o":"")+c}return e.s<0?"-"+c:c}function RX(e,t){if(e.length>t)return e.length=t,!0}function upe(e){return new this(e).abs()}function cpe(e){return new this(e).acos()}function hpe(e){return new this(e).acosh()}function fpe(e,t){return new this(e).plus(t)}function dpe(e){return new this(e).asin()}function ppe(e){return new this(e).asinh()}function vpe(e){return new this(e).atan()}function gpe(e){return new this(e).atanh()}function mpe(e,t){e=new this(e),t=new this(t);var r,n=this.precision,i=this.rounding,a=n+4;return!e.s||!t.s?r=new this(NaN):!e.d&&!t.d?(r=Dd(this,a,1).times(t.s>0?.25:.75),r.s=e.s):!t.d||e.isZero()?(r=t.s<0?Dd(this,n,i):new this(0),r.s=e.s):!e.d||t.isZero()?(r=Dd(this,a,1).times(.5),r.s=e.s):t.s<0?(this.precision=a,this.rounding=1,r=this.atan(yo(e,t,a,1)),t=Dd(this,a,1),this.precision=n,this.rounding=i,r=e.s<0?r.minus(t):r.plus(t)):r=this.atan(yo(e,t,a,1)),r}function ype(e){return new this(e).cbrt()}function _pe(e){return Hn(e=new this(e),e.e+1,2)}function xpe(e,t,r){return new this(e).clamp(t,r)}function bpe(e){if(!e||typeof e!="object")throw Error(E3+"Object expected");var t,r,n,i=e.defaults===!0,a=["precision",1,x0,"rounding",0,8,"toExpNeg",-rx,0,"toExpPos",0,rx,"maxE",0,rx,"minE",-rx,0,"modulo",0,9];for(t=0;t<a.length;t+=3)if(r=a[t],i&&(this[r]=AB[r]),(n=e[r])!==void 0)if(Uu(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(n0+r+": "+n);if(r="crypto",i&&(this[r]=AB[r]),(n=e[r])!==void 0)if(n===!0||n===!1||n===0||n===1)if(n)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[r]=!0;else throw Error(Mot);else this[r]=!1;else throw Error(n0+r+": "+n);return this}function Epe(e){return new this(e).cos()}function wpe(e){return new this(e).cosh()}function Bot(e){var t,r,n;function i(a){var o,s,l,u=this;if(!(u instanceof i))return new i(a);if(u.constructor=i,IX(a)){u.s=a.s,bi?!a.d||a.e>i.maxE?(u.e=NaN,u.d=null):a.e<i.minE?(u.e=0,u.d=[0]):(u.e=a.e,u.d=a.d.slice()):(u.e=a.e,u.d=a.d?a.d.slice():a.d);return}if(l=typeof a,l==="number"){if(a===0){u.s=1/a<0?-1:1,u.e=0,u.d=[0];return}if(a<0?(a=-a,u.s=-1):u.s=1,a===~~a&&a<1e7){for(o=0,s=a;s>=10;s/=10)o++;bi?o>i.maxE?(u.e=NaN,u.d=null):o<i.minE?(u.e=0,u.d=[0]):(u.e=o,u.d=[a]):(u.e=o,u.d=[a]);return}else if(a*0!==0){a||(u.s=NaN),u.e=NaN,u.d=null;return}return IB(u,a.toString())}else if(l!=="string")throw Error(n0+a);return(s=a.charCodeAt(0))===45?(a=a.slice(1),u.s=-1):(s===43&&(a=a.slice(1)),u.s=1),Iot.test(a)?IB(u,a):spe(u,a)}if(i.prototype=vr,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.EUCLID=9,i.config=i.set=bpe,i.clone=Bot,i.isDecimal=IX,i.abs=upe,i.acos=cpe,i.acosh=hpe,i.add=fpe,i.asin=dpe,i.asinh=ppe,i.atan=vpe,i.atanh=gpe,i.atan2=mpe,i.cbrt=ype,i.ceil=_pe,i.clamp=xpe,i.cos=Epe,i.cosh=wpe,i.div=Cpe,i.exp=Spe,i.floor=Tpe,i.hypot=Ape,i.ln=Mpe,i.log=Rpe,i.log10=Lpe,i.log2=Ipe,i.max=Ope,i.min=Ppe,i.mod=Dpe,i.mul=Fpe,i.pow=Bpe,i.random=Npe,i.round=kpe,i.sign=zpe,i.sin=Upe,i.sinh=$pe,i.sqrt=Hpe,i.sub=Vpe,i.sum=Gpe,i.tan=Wpe,i.tanh=Xpe,i.trunc=jpe,e===void 0&&(e={}),e&&e.defaults!==!0)for(n=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return i.config(e),i}function Cpe(e,t){return new this(e).div(t)}function Spe(e){return new this(e).exp()}function Tpe(e){return Hn(e=new this(e),e.e+1,3)}function Ape(){var e,t,r=new this(0);for(bi=!1,e=0;e<arguments.length;)if(t=new this(arguments[e++]),t.d)r.d&&(r=r.plus(t.times(t)));else{if(t.s)return bi=!0,new this(1/0);r=t}return bi=!0,r.sqrt()}function IX(e){return e instanceof Gd||e&&e.toStringTag===Rot||!1}function Mpe(e){return new this(e).ln()}function Rpe(e,t){return new this(e).log(t)}function Ipe(e){return new this(e).log(2)}function Lpe(e){return new this(e).log(10)}function Ope(){return Pot(this,arguments,"lt")}function Ppe(){return Pot(this,arguments,"gt")}function Dpe(e,t){return new this(e).mod(t)}function Fpe(e,t){return new this(e).mul(t)}function Bpe(e,t){return new this(e).pow(t)}function Npe(e){var t,r,n,i,a=0,o=new this(1),s=[];if(e===void 0?e=this.precision:th(e,1,x0),n=Math.ceil(e/ni),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(n));a<n;)i=t[a],i>=429e7?t[a]=crypto.getRandomValues(new Uint32Array(1))[0]:s[a++]=i%1e7;else if(crypto.randomBytes){for(t=crypto.randomBytes(n*=4);a<n;)i=t[a]+(t[a+1]<<8)+(t[a+2]<<16)+((t[a+3]&127)<<24),i>=214e7?crypto.randomBytes(4).copy(t,a):(s.push(i%1e7),a+=4);a=n/4}else throw Error(Mot);else for(;a<n;)s[a++]=Math.random()*1e7|0;for(n=s[--a],e%=ni,n&&e&&(i=pl(10,ni-e),s[a]=(n/i|0)*i);s[a]===0;a--)s.pop();if(a<0)r=0,s=[0];else{for(r=-1;s[0]===0;r-=ni)s.shift();for(n=1,i=s[0];i>=10;i/=10)n++;n<ni&&(r-=ni-n)}return o.e=r,o.d=s,o}function kpe(e){return Hn(e=new this(e),e.e+1,this.rounding)}function zpe(e){return e=new this(e),e.d?e.d[0]?e.s:0*e.s:e.s||NaN}function Upe(e){return new this(e).sin()}function $pe(e){return new this(e).sinh()}function Hpe(e){return new this(e).sqrt()}function Vpe(e,t){return new this(e).sub(t)}function Gpe(){var e=0,t=arguments,r=new this(t[e]);for(bi=!1;r.s&&++e<t.length;)r=r.plus(t[e]);return bi=!0,Hn(r,this.precision,this.rounding)}function Wpe(e){return new this(e).tan()}function Xpe(e){return new this(e).tanh()}function jpe(e){return Hn(e=new this(e),e.e+1,1)}vr[Symbol.for("nodejs.util.inspect.custom")]=vr.toString;vr[Symbol.toStringTag]="Decimal";var Gd=vr.constructor=Bot(AB);SR=new Gd(SR);TR=new Gd(TR);var P1,Not=function(e){return typeof e=="number"?Number.isNaN(e):e&&typeof e=="string"?Number.isNaN(Number(e)):!0},Gk=function(e,t,r){return r===void 0&&(r=!1),e!=null&&e.length?e.reduce(function(n,i){var a=ii(i,t),o=Not(a);if(r&&o)return n;var s=o?0:a;return n.push(new Gd(s)),n},[]):[]},kot=function(e,t){var r=Gk(e,t);return r.length?Gd.sum.apply(Gd,Vr([],lr(r),!1)).toNumber():0},LX=function(e,t,r){var n=Gk(t,r,!0);if(n!=null&&n.length)return Gd[e].apply(Gd,Vr([],lr(n),!1)).toNumber()},Ype=function(e,t){var r=Gk(e,t);return r!=null&&r.length?Gd.sum.apply(Gd,Vr([],lr(r),!1)).dividedBy(r.length).toNumber():0},Zpe=(P1={},P1[Ay.SUM]=kot,P1[Ay.MIN]=function(e,t){return LX("min",e,t)},P1[Ay.MAX]=function(e,t){return LX("max",e,t)},P1[Ay.AVG]=Ype,P1),qpe=function(e){return Ja(e)&&"values"in e},Kpe=function(e){var t=e.spreadsheet,r=e.position,n=e.tooltipContainer,i=e.autoAdjustBoundary,a=t.getCanvasElement(),o=r.x+oX.x,s=r.y+oX.y;if(!i||!a)return{x:o,y:s};var l=i==="body",u=t.facet.panelBBox,c=u.maxX,f=u.maxY,d=t.options,v=d.width,g=d.height,x=a.getBoundingClientRect(),w=x.top,S=x.left,A=n.getBoundingClientRect(),M=A.width,R=A.height,O=document.body.getBoundingClientRect(),N=O.width,k=O.height,V=l?N:Math.min(v,c)+S,Q=l?k:Math.min(g,f)+w;return o+M>=V&&(o=V-M),s+R>=Q&&(s=Q-R),{x:o,y:s}},Qpe=function(e){return Zt({operator:{onClick:XI,menus:[]},enterable:!0,enableFormat:!0},e)},LB=function(e){return Zt(Zt({},e==null?void 0:e.colQuery),e==null?void 0:e.rowQuery)},qT=function(e,t){var r;if(e){var n=t.style,i=t.className,a=i===void 0?[]:i,o=t.visible;if(n&&Object.assign(e.style,n),a.length){var s=a.filter(Boolean);(r=e.classList).add.apply(r,Vr([],lr(s),!1))}e.classList.toggle(Xce,o),e.classList.toggle(jce,!o)}},Jpe=function(e){var t=nc(e)&&Number.isNaN(e),r=e==="";return bl(e)||t||r?"-":e},Wk=function(e,t){var r,n=(r=e==null?void 0:e.dataSet)===null||r===void 0?void 0:r.getFieldFormatter(t);return function(i,a){return Jpe(n(i,a))}},XA=function(e,t){var r,n=t.data,i=t.field,a=t.valueField,o=t.useCompleteDataForFormatter,s=o===void 0?!0:o,l=(r=e==null?void 0:e.dataSet)===null||r===void 0?void 0:r.getFieldName(i),u=Wk(e,i),c=Ja(n[i])?JSON.stringify(n[i]):n[i],f=u(a||c,s?n:void 0);return{name:l,value:f}},OX=function(e,t,r){var n=Eg(J1([],t),function(a){return a!==Pi&&r[a]}),i=ia(n,function(a){return XA(e,{data:r,field:a,useCompleteDataForFormatter:!1})});return i},tve=function(e,t,r){var n,i,a,o,s=(r||{}).isTotals,l=[],u=[];if(t){var c=(i=(n=e==null?void 0:e.dataSet)===null||n===void 0?void 0:n.fields)===null||i===void 0?void 0:i.columns,f=(o=(a=e==null?void 0:e.dataSet)===null||a===void 0?void 0:a.fields)===null||o===void 0?void 0:o.rows;l=OX(e,Bb(c||[]),t),u=OX(e,f,t)}return Or(l)&&Or(u)&&s&&(l=[{value:El("总计")}]),{cols:l,rows:u}},eve=function(e,t,r){if(t){var n=r.isTotals,i=t[Pi],a=t[i],o=[];if(n)o.push(XA(e,{data:t,field:i,valueField:ii(t,jc)}));else if(qpe(a)&&e.getTooltipDataItemMappingCallback()){var s=cot(t,e.getTooltipDataItemMappingCallback());xi(s,function(l,u){o.push(XA(e,{data:s,field:u}))})}else o.push(XA(e,{data:t,field:i}));return o}},rve=function(e,t,r){var n;if(r)return El("总计");var i=(n=e==null?void 0:e.dataSet)===null||n===void 0?void 0:n.getFieldName(t);return i&&i!=="undefined"?i:""},PX=function(e,t,r){r===void 0&&(r=!0);var n=[];return xi(t,function(i,a){xi(e,function(o){!r&&o.colIndex!==-1?n.push([a,o.colIndex]):r&&o.rowIndex!==-1&&n.push([o.rowIndex,a])})}),n},nve=function(e,t){var r,n=t.rowLeafNodes,i=t.colLeafNodes,a=e.interaction.getState(),o=a.nodes,s=o===void 0?[]:o,l=a.cells,u=l===void 0?[]:l,c=(r=u==null?void 0:u[0])===null||r===void 0?void 0:r.type,f=s.filter(function(d){return d==null?void 0:d.isLeaf});return c===Br.COL_CELL?PX(f,n,!1):c===Br.ROW_CELL?PX(f,i):[]},ive=function(e,t,r){var n,i=(n=e.facet)===null||n===void 0?void 0:n.layoutResult,a=function(l){var u=t==null?void 0:t.getMeta(),c=u==null?void 0:u.isTotals,f=(t==null?void 0:t.cellType)===Br.COL_CELL,d=(t==null?void 0:t.cellType)===Br.ROW_CELL;if(!f&&!d)return!1;var v=i.colNodes.find(function(w){return w.colIndex===l.colIndex}),g=i.rowNodes.find(function(w){return w.rowIndex===l.rowIndex}),x=f?g==null?void 0:g.isTotals:v==null?void 0:v.isTotals;return!c&&(l==null?void 0:l.isTotals)||c&&x};if(r){var o=nve(e,i);return kd(ia(o,function(l){var u=lr(l,2),c=u[0],f=u[1],d=i.getCellMeta(c,f);if(!a(d))return(d==null?void 0:d.data)||LB(d)}))}var s=e.interaction.getCells();return s.filter(function(l){var u=i.getCellMeta(l.rowIndex,l.colIndex);return!a(u)}).map(function(l){var u=i.getCellMeta(l.rowIndex,l.colIndex);return(u==null?void 0:u.data)||LB(u)})},ave=function(e){var t=e.spreadsheet,r=e.targetCell,n=e.options,i=n===void 0?{}:n,a=[],o={},s=t.isTableMode();if(s&&(i!=null&&i.showSingleTips)){var l=r.getMeta(),u=l!=null&&l.field?t.dataSet.getMultiData({field:l.field}):[t.dataSet.getRowData(l)];return[{selectedData:u,name:"",value:""}]}var c=ive(t,r,i.showSingleTips);return xi(c,function(f){var d;o[f==null?void 0:f[Pi]]?(d=o[f==null?void 0:f[Pi]])===null||d===void 0||d.push(f):o[f==null?void 0:f[Pi]]=[f]}),Qit(o,function(f,d){var v,g=rve(t,d,i==null?void 0:i.isTotals),x="",w="";if(i3(f,function(O){return Not(ii(O,jc))})){var S=t.options.placeholder,A=O_(o,S);x=A,w=A}else{var M=Wk(t,d),R=kot(f,jc);w=R,x=(v=M==null?void 0:M(R,f))!==null&&v!==void 0?v:parseFloat(R.toPrecision(Qrt))}a.push({selectedData:f,name:g,value:x,originValue:w})}),a},ove=function(e){if(e){var t=e.getMeta();if(!t.isTotals){var r=zu(t.spreadsheet.dataCfg.meta,{field:t.field||t.value||t.valueField}),n=r==null?void 0:r.field;return t.spreadsheet.dataSet.getFieldDescription(n)}}},sve=function(e){var t=e.spreadsheet,r=e.cellInfos,n=r===void 0?[]:r,i=e.options,a=i===void 0?{}:i,o=e.targetCell,s=null,l=null,u=null,c=ove(o),f=n[0]||{};if(!(a!=null&&a.hideSummary))s=ave({spreadsheet:t,options:a,targetCell:o});else if(a.showSingleTips){var d=Wk(t,f.valueField),v=d(f.value),g=a.enableFormat?t.dataSet.getFieldName(f.value)||v:t.dataSet.getFieldName(f.valueField);f.name=g||""}else l=tve(t,f,a),u=eve(t,f,a);var x=f||{},w=x.interpretation,S=x.infos,A=x.tips,M=x.name;return{summaries:s,interpretation:w,infos:S,tips:A,name:M,headInfo:l,details:u,description:c}},lve=function(e){return ia(e,function(t){var r=t.getMeta();return wnt({},r.query||{},dat(r,["colIndex","rowIndex"]))})},Xk=function(e){if(!e.interaction.isSelectedState())return[];var t=e.dataCfg.fields.valueInCols;return e.interaction.getCells().reduce(function(r,n){var i=e.facet.layoutResult.getCellMeta(n==null?void 0:n.rowIndex,n==null?void 0:n.colIndex),a=LB(i);if(Or(i)||Or(a))return[];var o=Zt(Zt({},a),{colIndex:t?i.colIndex:null,rowIndex:t?null:i.rowIndex}),s=r.find(function(l){return cu(o,l)});return s||r.push(o),r},[])},uve=function(e,t){e===void 0&&(e={});var r=function(s){return Mp(e,s)},n=e.col,i=e.row,a=e.data,o=e.corner;return t===Br.COL_CELL?r(n):t===Br.ROW_CELL?r(i):t===Br.DATA_CELL?r(a):t===Br.CORNER_CELL?r(o):Zt({},e)},jk=function(e,t){var r;if(!(!t||!e)){var n=(r=e.getCellType)===null||r===void 0?void 0:r.call(e,t==null?void 0:t.target);return uve(e.options.tooltip,n)}},zot=function(e,t){var r=t.defaultMenus,n=r===void 0?[]:r,i=t.cell,a=function(s){return s===void 0&&(s=[]),s.filter(function(l){var u;return hu(l.visible)?l.visible(i):(u=l.visible)!==null&&u!==void 0?u:!0}).map(function(l){return l.children&&(l.children=a(l.children)),l})},o=a(e.menus);return{onClick:e.onClick,menus:kd(Vr(Vr([],lr(n),!1),lr(o),!1))}},cve=function(e,t){for(var r=!1,n=t;n&&n!==document.body;){if(e===n){r=!0;break}n=n.parentElement}return r},hve=function(e){e.store.set(sR,SN)},fve=function(e,t){var r=e.store.get(sR,SN);e.store.set(sR,Zt(Zt({},r),t))},dve=function(e,t){var r=e.store.get(sR,SN);return r[t]},Uot=function(){function e(t){var r=this;this.displayFormattedValueMap=new Map,this.getFieldMeta=R_(function(n,i){return zu(r.meta||i,function(a){return a.field===n})}),this.spreadsheet=t}return e.prototype.getFieldName=function(t){var r=ii(this.getFieldMeta(t,this.meta),"name",t);return khe(r)},e.prototype.getFieldFormatter=function(t){return ii(this.getFieldMeta(t,this.meta),"formatter",Hu)},e.prototype.getFieldDescription=function(t){return ii(this.getFieldMeta(t,this.meta),"description")},e.prototype.setDataCfg=function(t){this.getFieldMeta.cache.clear();var r=this.processDataCfg(t),n=r.fields,i=r.meta,a=r.data,o=r.totalData,s=r.sortParams,l=r.filterParams;this.fields=n,this.meta=i,this.originData=a,this.totalData=o,this.sortParams=s,this.filterParams=l,this.displayData=this.originData,this.indexesData={}},e.prototype.processMeta=function(t,r){var n,i;return t===void 0&&(t=[]),Vr(Vr([],lr(t),!1),[gfe(t,(i=(n=this.spreadsheet)===null||n===void 0?void 0:n.options)===null||i===void 0?void 0:i.cornerExtraFieldText,r)],!1)},e.prototype.getDisplayDataSet=function(){return this.displayData||[]},e.prototype.isEmpty=function(){return Or(this.getDisplayDataSet())},e.prototype.getEmptyViewIndexes=function(){return[]},e.prototype.getValueRangeByField=function(t){var r,n=dve(this.spreadsheet,t);if(n)return n;var i=kd(ia(this.originData,function(o){var s=o[t];return bl(s)?null:Number.parseFloat(s)})),a={maxValue:tb(i),minValue:hk(i)};return fve(this.spreadsheet,(r={},r[t]=a,r)),a},e.prototype.moreThanOneValue=function(){var t,r;return((r=(t=this.fields)===null||t===void 0?void 0:t.values)===null||r===void 0?void 0:r.length)>1},e}(),OB=function(){function e(t){this.extraField=t}return e.createProxyData=function(t,r){return new Proxy(t,new e(r))},e.createProxyDataList=function(t,r){return r.map(function(n){return e.createProxyData(t,n)})},e.prototype.get=function(t,r){return r===wN?t:r===Pi?this.extraField:r===jc?t[this.extraField]:t[r]},e.prototype.has=function(t,r){return r===Pi||r===jc?!0:r in t},e.prototype.ownKeys=function(t){return Object.keys(t).concat(Pi,jc)},e.prototype.getOwnPropertyDescriptor=function(t,r){return r===Pi||r===jc?{configurable:!0,enumerable:!0}:Object.getOwnPropertyDescriptor(t,r)},e}(),PB=function(e){en(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.handleDimensionValuesSort=function(){xi(r.sortParams,function(n){var i=n.sortFieldId,a=n.sortByMeasure;if(i){var o=Vr([],lr(r.sortedDimensionValues[i]||[]),!1),s=Rde({dataSet:r,sortParam:n,originValues:o,isSortByMeasure:!Or(a)});r.sortedDimensionValues[i]=s,r.handlePivotMetaSort(i,s)}})},r.getTotalStatus=function(n){var i=r.fields,a=i.columns,o=i.rows,s=function(u,c){if(c){var f=zu(u,function(d){return!sB(n,d)});return f&&f!==u_(u)}return i3(u,function(d){return!sB(n,d)})},l=function(u,c){return c?u.filter(function(f){return f!==Pi}):u};return{isRowTotal:s(l(o,!r.spreadsheet.isValueInCols())),isRowSubTotal:s(o,!0),isColTotal:s(l(a,r.spreadsheet.isValueInCols())),isColSubTotal:s(a,!0)}},r}return t.prototype.getExistValuesByDataItem=function(r,n){return rot(r,n)},t.prototype.setDataCfg=function(r){e.prototype.setDataCfg.call(this,r);var n=this.fields.rows;this.sortedDimensionValues={},this.rowPivotMeta=new Map,this.colPivotMeta=new Map,this.dimensionValuesCache=new Map,this.transformIndexesData(this.originData.concat(this.totalData),n),this.handleDimensionValuesSort()},t.prototype.transformIndexesData=function(r,n){var i=this,a=this.fields,o=a.columns,s=a.values,l=a.valueInCols,u;return Fp.getInstance().debugCallback(rhe,function(){u=vfe({rows:n,columns:o,values:s,valueInCols:l,data:r,indexesData:i.indexesData,sortedDimensionValues:i.sortedDimensionValues,rowPivotMeta:i.rowPivotMeta,colPivotMeta:i.colPivotMeta,getExistValuesByDataItem:i.getExistValuesByDataItem}),i.indexesData=u.indexesData,i.rowPivotMeta=u.rowPivotMeta,i.colPivotMeta=u.colPivotMeta,i.sortedDimensionValues=u.sortedDimensionValues}),u},t.prototype.transformDrillDownData=function(r,n,i){var a=this,o,s=su.getFieldPath(i,!0),l=Vr(Vr([],lr(s),!1),[r],!1),u=this.spreadsheet.store,c=i==null?void 0:i.id,f=(o=u.get("drillDownIdPathMap"))!==null&&o!==void 0?o:new Map;f.has(c)&&(xi(f.get(c),function(v){vB(a.indexesData,v)}),pX(this.rowPivotMeta,c));var d=this.transformIndexesData(n,l).paths;f.set(c,d),u.set("drillDownIdPathMap",f)},t.prototype.clearDrillDownData=function(r){var n=this,i=this.spreadsheet.store,a=i.get("drillDownIdPathMap");if(!a)return!1;var o=i.get("drillDownDataCache",[]);if(r){var s=a.get(r);s&&xi(s,function(v){vB(n.indexesData,v)}),pX(this.rowPivotMeta,r),a.delete(r);var l=Eg(o,function(v){return a.has(v==null?void 0:v.rowId)});i.set("drillDownDataCache",l);var u=l.map(function(v){return v==null?void 0:v.drillLevel}),c=i.get("drillDownFieldInLevel",[]),f=c.filter(function(v){return oc(u,v==null?void 0:v.drillLevel)});i.set("drillDownFieldInLevel",f)}else{a.clear();var d=this.spreadsheet.store.get("originalDataCfg");Or(d)||this.spreadsheet.setDataCfg(d),this.spreadsheet.store.set("drillItemsNum",-1),this.spreadsheet.store.set("drillDownDataCache",[]),this.spreadsheet.store.set("drillDownFieldInLevel",[])}return i.set("drillDownIdPathMap",a),!0},t.prototype.handlePivotMetaSort=function(r,n){var i=this.fields,a=i.rows,o=i.columns;oc(a,r)?this.rowPivotMeta=CX({pivotMeta:this.rowPivotMeta,dimensions:a,sortFieldId:r,sortedDimensionValues:n}):oc(o,r)&&(this.colPivotMeta=CX({pivotMeta:this.colPivotMeta,dimensions:o,sortFieldId:r,sortedDimensionValues:n}))},t.prototype.processDataCfg=function(r){var n=r.data,i=r.meta,a=i===void 0?[]:i,o=r.fields,s=r.sortParams,l=s===void 0?[]:s,u=r.totalData,c=o.columns,f=o.rows,d=o.values,v=o.valueInCols,g=o.customValueOrder,x=c,w=f;v?x=this.isCustomMeasuresPosition(g)?this.handleCustomMeasuresOrder(g,x):jv(Vr(Vr([],lr(c),!1),[Pi],!1)):w=this.isCustomMeasuresPosition(g)?this.handleCustomMeasuresOrder(g,w):jv(Vr(Vr([],lr(f),!1),[Pi],!1));var S=this.processMeta(a,El("数值"));return{data:n,totalData:u,meta:S,fields:Zt(Zt({},o),{rows:w,columns:x,values:d}),sortParams:l}},t.prototype.getFieldsAndPivotMetaByField=function(r){var n=this.fields||{},i=n.rows,a=i===void 0?[]:i,o=n.columns,s=o===void 0?[]:o;return a.includes(r)?{dimensions:a,pivotMeta:this.rowPivotMeta}:s.includes(r)?{dimensions:s,pivotMeta:this.colPivotMeta}:{}},t.prototype.getDimensionValues=function(r,n){n===void 0&&(n={});var i=this.getFieldsAndPivotMetaByField(r),a=i.pivotMeta,o=i.dimensions;if(!a||!o)return[];var s=Or(n);if(this.dimensionValuesCache.has(r)&&s)return this.dimensionValuesCache.get(r);var l=_y(n,o,UA),u=not({pivotMeta:a,dimensionValues:l,fields:o,fieldIdx:l3(o,r),queryType:Bf.DetailOnly,sortedDimensionValues:this.sortedDimensionValues}),c=jv(u.map(function(f){return f.value}));return s&&this.dimensionValuesCache.set(r,c),c},t.prototype.getTotalValue=function(r,n){var i,a=this.spreadsheet.options,o=_at(n),s=o?n:this.getTotalStatus(r),l=dfe(s,a==null?void 0:a.totals)||{},u=l.aggregation,c=l.calcFunc,f=Or(a==null?void 0:a.totals)&&!this.spreadsheet.isHierarchyTreeType()?Ay.SUM:"",d=Zpe[u||f];if(d||c){var v=this.getMultiData(r,{queryType:Bf.DetailOnly}),g=void 0;return c?g=c(r,v,this.spreadsheet):d&&(g=d(v,jc)),Zt(Zt({},r),(i={},i[jc]=g,i[r[Pi]]=g,i))}},t.prototype.getCellData=function(r){var n,i,a,o=r||{},s=o.query,l=s===void 0?{}:s,u=o.rowNode,c=o.isTotals,f=c===void 0?!1:c,d=o.totalStatus,v=this.fields,g=v.rows,x=v.columns,w=g,S=(n=this.spreadsheet)===null||n===void 0?void 0:n.store.get("drillDownIdPathMap"),A=Array.from((i=S==null?void 0:S.keys())!==null&&i!==void 0?i:[]).some(function(k){return u==null?void 0:u.id.startsWith(k)});u&&A&&(w=(a=su.getFieldPath(u,A))!==null&&a!==void 0?a:g);var M=_y(l,w),R=_y(l,x),O=ER({rowDimensionValues:M,colDimensionValues:R,rowPivotMeta:this.rowPivotMeta,colPivotMeta:this.colPivotMeta,rowFields:w,colFields:x,prefix:bR(w,x)}),N=ii(this.indexesData,O);if(N)return OB.createProxyData(N,l[Pi]);if(f)return this.getTotalValue(l,d)},t.prototype.getQueryExtraFields=function(r){var n=this.fields.values,i=r[Pi];return i?oc(n,i)?[i]:[]:n},t.prototype.getMultiData=function(r,n,i,a,o){var s,l,u,c;r===void 0&&(r={}),a===void 0&&(a=[]),o===void 0&&(o=!0),Or(r)&&console.warn("query: ".concat(r,` shouldn't be empty, you can get all data from dataCfg if you're intended.
 you should use { EXTRA_FIELD: xxx} as least if you want query all specific value data`));var f=Ja(n)?n:{queryType:o?Bf.All:Bf.DetailOnly,drillDownFields:a},d=f.drillDownFields,v=d===void 0?[]:d,g=f.queryType,x=g===void 0?Bf.All:g,w=this.fields,S=w.rows,A=w.columns,M=Or(v)?S:S.concat(v),R=_y(r,M,UA),O=_y(r,A,UA),N=yfe({rowDimensionValues:R,colDimensionValues:O,rowPivotMeta:this.rowPivotMeta,colPivotMeta:this.colPivotMeta,rowFields:M,colFields:A,sortedDimensionValues:this.sortedDimensionValues,queryType:x}),k=N.rowQueries,V=N.colQueries,Q=bR(M,A),Y=[];try{for(var X=Gf(k),tt=X.next();!tt.done;tt=X.next()){var it=tt.value;try{for(var Et=(u=void 0,Gf(V)),Tt=Et.next();!Tt.done;Tt=Et.next()){for(var pt=Tt.value,kt=ER({rowDimensionValues:it,colDimensionValues:pt,rowPivotMeta:this.rowPivotMeta,colPivotMeta:this.colPivotMeta,rowFields:M,colFields:A,prefix:Q}),ae=!1,Kt=this.indexesData,re=function(Be){var De=kt[Be];ae?HC(De)?Kt=_fe(Kt,x):Kt=kd(ia(Kt,function(Yr){return Yr==null?void 0:Yr[De]})):HC(De)?(ae=!0,Kt=kd([Kt]),Be--):Kt=Kt==null?void 0:Kt[De],fe=Be},fe,Oe=0;Oe<kt.length;Oe++)re(Oe),Oe=fe;Wn(Kt)?Y.push.apply(Y,Vr([],lr(Kt),!1)):Kt&&Y.push(Kt)}}catch(Be){u={error:Be}}finally{try{Tt&&!Tt.done&&(c=Et.return)&&c.call(Et)}finally{if(u)throw u.error}}}}catch(Be){s={error:Be}}finally{try{tt&&!tt.done&&(l=X.return)&&l.call(X)}finally{if(s)throw s.error}}var Ye=this.getQueryExtraFields(r);return kS(jv(Y),function(Be){return Be?OB.createProxyDataList(Be,Ye):[]})},t.prototype.getFieldFormatter=function(r,n){return r===jp?this.getFieldFormatterForTotalValue(n):e.prototype.getFieldFormatter.call(this,r)},t.prototype.getFieldFormatterForTotalValue=function(r){var n;return!this.spreadsheet.isValueInCols()&&r&&(n=ii(r.rowQuery,Pi)),n=n??ii(this.fields.values,0),e.prototype.getFieldFormatter.call(this,n)},t.prototype.handleCustomMeasuresOrder=function(r,n){var i=jv(Vr([],lr(n),!1));return n.length>=r?(i.splice(r,0,Pi),i):Vr(Vr([],lr(i),!1),[Pi],!1)},t.prototype.isCustomMeasuresPosition=function(r){return nc(r)},t.prototype.getRowData=function(r){return this.getMultiData(r.rowQuery)},t}(Uot),pve=function(e){en(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getCellData=function(r){var n=r.query,i=this.fields,a=i.rows,o=i.columns,s=_y(n,a),l=_y(n,o),u=ER({rowDimensionValues:s,colDimensionValues:l,rowPivotMeta:this.rowPivotMeta,colPivotMeta:this.colPivotMeta,rowFields:a,colFields:o,prefix:bR(a,o)}),c=ii(this.indexesData,u);return c&&OB.createProxyData(c,n[Pi])},t.prototype.processDataCfg=function(r){var n=r.meta,i=this.processMeta(n,El("指标"));return Zt(Zt({},r),{meta:i,fields:Zt(Zt({},r.fields),{rows:[Pi],valueInCols:!1})})},t}(PB),vve=function(e){en(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.handleDimensionValueFilter=function(){xi(r.filterParams,function(n){var i=n.filterKey,a=n.filteredValues,o=n.customFilter,s=new Set(a),l=function(c){return!s.has(c[i])},u=Eg(r.displayData,function(c){return o?o(c)&&l(c):l(c)});r.displayData=r.getDisplayData(u)})},r.handleDimensionValuesSort=function(){xi(r.sortParams,function(n){var i,a=n.sortFieldId,o=n.sortBy,s=n.sortFunc,l=n.sortMethod,u=n.query;if(a){var c=r.displayData,f=[];if(u){var d=[];c.forEach(function(A){for(var M=Object.keys(u),R=!0,O=0;O<M.length;O++){var N=M[O];if(A[N]!==u[N]){R=!1,f.push(A);break}}R&&d.push(A)}),c=d}var v=c;if(s)v=s(Zt(Zt({},n),{data:c}));else if(o&&!hu(o)){var g=Vr([],lr(o),!1).reverse();v=c.sort(function(A,M){var R=g.indexOf(A[a]),O=g.indexOf(M[a]);return O-R})}else if(Nb(l)||Uk(l)){var x=O_(r.spreadsheet,(i=r.spreadsheet.options)===null||i===void 0?void 0:i.placeholder),w=hu(o)?o:null,S=function(A){return A[a]===x?Number.MIN_VALUE:A[a]};v=vk(c,[w||S],[l.toLocaleLowerCase()])}f.length&&(v=Vr(Vr([],lr(v),!1),lr(f),!1)),r.displayData=r.getDisplayData(v)}})},r}return t.prototype.processDataCfg=function(r){return r},t.prototype.setDataCfg=function(r){e.prototype.setDataCfg.call(this,r),this.handleDimensionValueFilter(),this.handleDimensionValuesSort()},t.prototype.getStartFrozenRows=function(r){var n=(this.spreadsheet.options||{}).frozenRowCount;return n?r.slice(0,n):[]},t.prototype.getEndFrozenRows=function(r){var n=(this.spreadsheet.options||{}).frozenTrailingRowCount;return n?r.slice(-n):[]},t.prototype.getDisplayData=function(r){var n=this.getStartFrozenRows(r),i=this.getEndFrozenRows(r),a=r.slice(n.length||0,-i.length||void 0);return Vr(Vr(Vr([],lr(n),!1),lr(a),!1),lr(i),!1)},t.prototype.getDimensionValues=function(){return[]},t.prototype.getCellData=function(r){var n=r.query;if(!(this.displayData.length===0&&n.rowIndex===0)){var i=this.displayData[n.rowIndex];return!l_(n,"field")||!Ja(i)?i:i[n.field]}},t.prototype.getMultiData=function(r){if(!r)return this.displayData;var n=this.displayData[r.rowIndex]?[this.displayData[r.rowIndex]]:this.displayData;return l_(r,"field")?n.map(function(i){return i[r.field]}):n},t.prototype.getRowData=function(r){return this.getCellData({query:{rowIndex:r.rowIndex}})},t}(Uot);function Yk(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function $ot(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function YS(){}var jC=.7,MR=1/jC,xx="\\s*([+-]?\\d+)\\s*",YC="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Vp="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",gve=/^#([0-9a-f]{3,8})$/,mve=new RegExp("^rgb\\("+[xx,xx,xx]+"\\)$"),yve=new RegExp("^rgb\\("+[Vp,Vp,Vp]+"\\)$"),_ve=new RegExp("^rgba\\("+[xx,xx,xx,YC]+"\\)$"),xve=new RegExp("^rgba\\("+[Vp,Vp,Vp,YC]+"\\)$"),bve=new RegExp("^hsl\\("+[YC,Vp,Vp]+"\\)$"),Eve=new RegExp("^hsla\\("+[YC,Vp,Vp,YC]+"\\)$"),DX={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Yk(YS,ZC,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:FX,formatHex:FX,formatHsl:wve,formatRgb:BX,toString:BX});function FX(){return this.rgb().formatHex()}function wve(){return Hot(this).formatHsl()}function BX(){return this.rgb().formatRgb()}function ZC(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=gve.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?NX(t):r===3?new Ih(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?KT(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?KT(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=mve.exec(e))?new Ih(t[1],t[2],t[3],1):(t=yve.exec(e))?new Ih(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=_ve.exec(e))?KT(t[1],t[2],t[3],t[4]):(t=xve.exec(e))?KT(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=bve.exec(e))?UX(t[1],t[2]/100,t[3]/100,1):(t=Eve.exec(e))?UX(t[1],t[2]/100,t[3]/100,t[4]):DX.hasOwnProperty(e)?NX(DX[e]):e==="transparent"?new Ih(NaN,NaN,NaN,0):null}function NX(e){return new Ih(e>>16&255,e>>8&255,e&255,1)}function KT(e,t,r,n){return n<=0&&(e=t=r=NaN),new Ih(e,t,r,n)}function Cve(e){return e instanceof YS||(e=ZC(e)),e?(e=e.rgb(),new Ih(e.r,e.g,e.b,e.opacity)):new Ih}function DB(e,t,r,n){return arguments.length===1?Cve(e):new Ih(e,t,r,n??1)}function Ih(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}Yk(Ih,DB,$ot(YS,{brighter:function(e){return e=e==null?MR:Math.pow(MR,e),new Ih(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?jC:Math.pow(jC,e),new Ih(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:kX,formatHex:kX,formatRgb:zX,toString:zX}));function kX(){return"#"+oP(this.r)+oP(this.g)+oP(this.b)}function zX(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function oP(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function UX(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Op(e,t,r,n)}function Hot(e){if(e instanceof Op)return new Op(e.h,e.s,e.l,e.opacity);if(e instanceof YS||(e=ZC(e)),!e)return new Op;if(e instanceof Op)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),a=Math.max(t,r,n),o=NaN,s=a-i,l=(a+i)/2;return s?(t===a?o=(r-n)/s+(r<n)*6:r===a?o=(n-t)/s+2:o=(t-r)/s+4,s/=l<.5?a+i:2-a-i,o*=60):s=l>0&&l<1?0:o,new Op(o,s,l,e.opacity)}function Sve(e,t,r,n){return arguments.length===1?Hot(e):new Op(e,t,r,n??1)}function Op(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}Yk(Op,Sve,$ot(YS,{brighter:function(e){return e=e==null?MR:Math.pow(MR,e),new Op(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?jC:Math.pow(jC,e),new Op(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new Ih(sP(e>=240?e-240:e+120,i,n),sP(e,i,n),sP(e<120?e+240:e-120,i,n),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function sP(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}function Zk(e){return function(){return e}}function Tve(e,t){return function(r){return e+r*t}}function Ave(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function Mve(e){return(e=+e)==1?Vot:function(t,r){return r-t?Ave(t,r,e):Zk(isNaN(t)?r:t)}}function Vot(e,t){var r=t-e;return r?Tve(e,r):Zk(isNaN(e)?t:e)}var $X=function e(t){var r=Mve(t);function n(i,a){var o=r((i=DB(i)).r,(a=DB(a)).r),s=r(i.g,a.g),l=r(i.b,a.b),u=Vot(i.opacity,a.opacity);return function(c){return i.r=o(c),i.g=s(c),i.b=l(c),i.opacity=u(c),i+""}}return n.gamma=e,n}(1);function Got(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),i;return function(a){for(i=0;i<r;++i)n[i]=e[i]*(1-a)+t[i]*a;return n}}function Wot(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Rve(e,t){return(Wot(t)?Got:Xot)(e,t)}function Xot(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,i=new Array(n),a=new Array(r),o;for(o=0;o<n;++o)i[o]=jot(e[o],t[o]);for(;o<r;++o)a[o]=t[o];return function(s){for(o=0;o<n;++o)a[o]=i[o](s);return a}}function Ive(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function FB(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function Lve(e,t){var r={},n={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?r[i]=jot(e[i],t[i]):n[i]=t[i];return function(a){for(i in r)n[i]=r[i](a);return n}}var BB=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,lP=new RegExp(BB.source,"g");function Ove(e){return function(){return e}}function Pve(e){return function(t){return e(t)+""}}function Dve(e,t){var r=BB.lastIndex=lP.lastIndex=0,n,i,a,o=-1,s=[],l=[];for(e=e+"",t=t+"";(n=BB.exec(e))&&(i=lP.exec(t));)(a=i.index)>r&&(a=t.slice(r,a),s[o]?s[o]+=a:s[++o]=a),(n=n[0])===(i=i[0])?s[o]?s[o]+=i:s[++o]=i:(s[++o]=null,l.push({i:o,x:FB(n,i)})),r=lP.lastIndex;return r<t.length&&(a=t.slice(r),s[o]?s[o]+=a:s[++o]=a),s.length<2?l[0]?Pve(l[0].x):Ove(t):(t=l.length,function(u){for(var c=0,f;c<t;++c)s[(f=l[c]).i]=f.x(u);return s.join("")})}function jot(e,t){var r=typeof t,n;return t==null||r==="boolean"?Zk(t):(r==="number"?FB:r==="string"?(n=ZC(t))?(t=n,$X):Dve:t instanceof ZC?$X:t instanceof Date?Ive:Wot(t)?Got:Array.isArray(t)?Xot:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Lve:FB)(e,t)}var zy;(function(e){e.ScrollChange="scroll-change",e.ScrollEnd="scroll-end"})(zy||(zy={}));var uP=function(e){en(t,e);function t(r){var n=e.call(this,r)||this;n.isMobile=!1,n.eventHandlers=[],n.scrollFrameId=null,n.getCoordinatesName=function(){var v=n.isHorizontal?"x1":"y1",g=n.isHorizontal?"x2":"y2";return{from:v,to:g}},n.getCoordinatesWithBBoxExtraPadding=function(){var v=n.theme.size,g=n.isHorizontal?0:v/2,x=n.isHorizontal?v:v/2;return{start:n.thumbOffset+g,end:n.thumbOffset+n.thumbLen-x}},n.current=function(){var v=n.thumbLen/n.trackLen,g=n.thumbOffset/n.trackLen;return g/(1-v)},n.updateThumbLen=function(v){if(n.thumbLen!==v){n.thumbLen=v;var g=n.getCoordinatesName();n.thumbShape.attr(g.to,n.thumbOffset+v),n.emitScrollChange(n.thumbOffset/(n.trackLen-n.thumbLen)*n.scrollTargetMaxOffset,!1)}},n.updateThumbOffset=function(v,g){var x;g===void 0&&(g=!0);var w=n.validateRange(v),S=n.thumbOffset===w&&w!==0;if(!S){n.thumbOffset=w;var A=n.getCoordinatesName(),M=A.from,R=A.to,O=n.getCoordinatesWithBBoxExtraPadding(),N=O.start,k=O.end;n.thumbShape.attr((x={},x[M]=N,x[R]=k,x)),g&&n.emitScrollChange(w/(n.trackLen-n.thumbLen)*n.scrollTargetMaxOffset,!1)}},n.onlyUpdateThumbOffset=function(v){var g;n.updateThumbOffset(v,!1),(g=n.get("canvas"))===null||g===void 0||g.draw()},n.emitScrollChange=function(v,g){g===void 0&&(g=!0),cancelAnimationFrame(n.scrollFrameId),n.scrollFrameId=requestAnimationFrame(function(){n.emit(zy.ScrollChange,{offset:v,updateThumbOffset:g})})},n.addEventListener=function(v,g,x){return v==null||v.addEventListener(g,x,!1),{remove:function(){v==null||v.removeEventListener(g,x,!1)}}},n.addEvent=function(v,g,x){v.on(g,x),n.eventHandlers.push({target:v,type:g,handler:x})},n.initScrollBar=function(){n.scrollBarGroup=n.createScrollBarGroup(),n.scrollBarGroup.move(n.position.x,n.position.y),n.bindEvents()},n.createScrollBarGroup=function(){var v=n.addGroup({className:n.isHorizontal?"horizontalBar":"verticalBar"});return n.trackShape=n.createTrackShape(v),n.thumbShape=n.createThumbShape(v),v},n.createTrackShape=function(v){var g=n.theme,x=g.lineCap,w=x===void 0?"round":x,S=g.trackColor,A=g.size,M={lineWidth:A,stroke:S,lineCap:w};return n.isHorizontal?v.addShape("line",{attrs:Zt(Zt({},M),{x1:0,y1:A/2,x2:n.trackLen,y2:A/2})}):v.addShape("line",{attrs:Zt(Zt({},M),{x1:A/2,y1:0,x2:A/2,y2:n.trackLen})})},n.createThumbShape=function(v){var g=n.theme,x=g.size,w=g.lineCap,S=w===void 0?"round":w,A=g.thumbColor,M={lineWidth:x,stroke:A,lineCap:S,cursor:"default"},R=n.getCoordinatesWithBBoxExtraPadding(),O=R.start,N=R.end;return n.isHorizontal?v.addShape("line",{attrs:Zt(Zt({},M),{x1:O,y1:x/2,x2:N,y2:x/2})}):v.addShape("line",{attrs:Zt(Zt({},M),{x1:x/2,y1:O,x2:x/2,y2:N})})},n.bindEvents=function(){n.on("mousedown",n.onStartEvent(!1)),n.on("mouseup",n.onMouseUp),n.on("touchstart",n.onStartEvent(!0)),n.on("touchend",n.onMouseUp),n.trackShape.on("click",n.onTrackClick),n.thumbShape.on("mouseover",n.onTrackMouseOver),n.thumbShape.on("mouseout",n.onTrackMouseOut)},n.onStartEvent=function(v){return function(g){g.preventDefault(),n.isMobile=v;var x=n.isMobile?ii(g,"touches.0",g):g,w=x.clientX,S=x.clientY;n.startPos=n.isHorizontal?w:S,n.bindLaterEvent()}},n.bindLaterEvent=function(){var v=n.get("canvas"),g=document.body,x=[];n.isMobile?(x=[n.addEventListener(g,"touchmove",n.onMouseMove),n.addEventListener(g,"touchend",n.onMouseUp),n.addEventListener(g,"touchcancel",n.onMouseUp)],n.addEvent(v,"touchend",n.onMouseUp),n.addEvent(v,"touchcancel",n.onMouseUp)):(x=[n.addEventListener(g,"mousemove",n.onMouseMove),n.addEventListener(g,"mouseup",n.onMouseUp),n.addEventListener(g,"mouseleave",n.onMouseUp)],n.addEvent(v,"mouseup",n.onMouseUp)),n.clearEvents=function(){x.forEach(function(w){w==null||w.remove()}),xi(n.eventHandlers,function(w){var S;(S=w.target)===null||S===void 0||S.off(w.type,w.handler)}),n.eventHandlers.length=0}},n.onTrackClick=function(v){var g=n.isHorizontal?v.x-n.position.x-n.thumbLen/2:v.y-n.position.y-n.thumbLen/2,x=n.validateRange(g);n.updateThumbOffset(x)},n.onMouseMove=function(v){v.preventDefault();var g=n.isMobile?ii(v,"touches.0",v):v,x=g.clientX,w=g.clientY,S=n.isHorizontal?x:w,A=S-n.startPos;n.startPos=S,n.updateThumbOffset(n.thumbOffset+A)},n.onMouseUp=function(v){var g;n.emit(zy.ScrollEnd,{}),v.preventDefault(),(g=n.clearEvents)===null||g===void 0||g.call(n)},n.onTrackMouseOver=function(){var v=n.theme,g=v.thumbHoverColor,x=v.hoverSize;n.thumbShape.attr("stroke",g),n.thumbShape.attr("lineWidth",x)},n.onTrackMouseOut=function(){var v=n.theme,g=v.thumbColor,x=v.size;n.thumbShape.attr("stroke",g),n.thumbShape.attr("lineWidth",x)},n.validateRange=function(v){var g=v;return v+n.thumbLen>n.trackLen?g=n.trackLen-n.thumbLen:v+n.thumbLen<n.thumbLen&&(g=0),g};var i=r.isHorizontal,a=i===void 0?!1:i,o=r.trackLen,s=r.thumbLen,l=r.position,u=r.thumbOffset,c=u===void 0?0:u,f=r.theme,d=r.scrollTargetMaxOffset;return n.isHorizontal=a,n.thumbOffset=c,n.trackLen=o,n.thumbLen=s,n.position=l,n.theme=f,n.scrollTargetMaxOffset=d,n.initScrollBar(),n}return t}(tv),Yot=function(e,t,r){if(r<=0)return{start:0,end:0};var n=Jx(e,function(a,o){var s=t;return s>=a&&s<e[o+1]},0);n=Math.max(n,0);var i=r===t?n:Jx(e,function(a,o){var s=r;return s>a&&s<=e[o+1]},n);return i=Math.min(i===-1?1/0:i,e.length-2),{start:n,end:i}},Fve=function(e,t){var r=t.width,n=t.originalWidth,i=Math.min(n-r,e);return i<0?0:i},cP=function(e,t,r){var n=Math.min(t-r,e);return n<0?0:n},Xw=function(e,t){if(e===void 0&&(e=[]),Or(e))return[];var r=[];return e.forEach(function(n){if(n instanceof t&&r.push(n),n instanceof tv){var i=n.getChildren();i.forEach(function(a){a instanceof t&&r.push(a)})}}),r},Zot=function(e,t,r){return r.slice(e,t+1).map(function(n){return n.x+n.width})},S3=function(e,t,r){for(var n=[],i=e;i<t+1;i++)n.push(r.getCellOffsetY(i+1));return n},Bve=function(e,t,r,n){var i=S3(e,t,n),a=n.getCellOffsetY(e);return i.map(function(o){return o-a+r})},HX=function(e,t,r){var n=lr(r,4),i=n[0],a=n[1],o=n[2],s=n[3];return e>=i&&e<=a&&t>=o&&t<=s},VX=function(e){for(var t=lr(e,4),r=t[0],n=t[1],i=t[2],a=t[3],o=[],s=r;s<=n;s+=1)for(var l=i;l<=a;l+=1)o.push([s,l]);return o},Nve=function(e,t){var r=[],n=[];if(Or(e))return Or(t)?{add:r,remove:n}:{add:VX(t),remove:n};if(Or(t))return{add:r,remove:VX(e)};for(var i=lr(e,4),a=i[0],o=i[1],s=i[2],l=i[3],u=lr(t,4),c=u[0],f=u[1],d=u[2],v=u[3],g=a;g<=o;g++)for(var x=s;x<=l;x++)HX(g,x,t)||n.push([g,x]);for(var g=c;g<=f;g+=1)for(var x=d;x<=v;x+=1)HX(g,x,e)||r.push([g,x]);return{add:r,remove:n}},kve=function(e,t){var r=[],n=[];return Object.keys(t).forEach(function(i){var a=Nve((e==null?void 0:e[i])||[],t[i]),o=a.add,s=a.remove;r.push.apply(r,Vr([],lr(o),!1)),n.push.apply(n,Vr([],lr(s),!1))}),{add:r,remove:n}},qot=function(){function e(t,r){r===void 0&&(r=!1),this.x=0,this.y=0,this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.width=0,this.height=0,this.originalWidth=0,this.originalHeight=0,this.viewportHeight=0,this.viewportWidth=0,this.facet=t,this.spreadsheet=t.spreadsheet,this.layoutResult=t.layoutResult,r&&this.calculateBBox()}return e}(),Kot=function(e){en(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.calculateBBox=function(){var r=this.getCornerBBoxWidth(),n=this.getCornerBBoxHeight();this.width=r,this.height=n,this.maxX=r,this.maxY=n},t.prototype.getCornerBBoxOriginalHeight=function(){var r=this.layoutResult.colsHierarchy,n=this.spreadsheet.options.style.colCfg;return r.sampleNodeForLastLevel?Math.floor(r.height):n==null?void 0:n.height},t.prototype.getCornerBBoxHeight=function(){return this.originalHeight=this.getCornerBBoxOriginalHeight(),this.originalHeight},t.prototype.getCornerBBoxWidth=function(){var r=this.layoutResult.rowsHierarchy;return this.originalWidth=Math.floor(r.width+this.facet.getSeriesNumberWidth()),this.spreadsheet.isScrollContainsRowHeader()?this.originalWidth:this.adjustCornerBBoxWidth()},t.prototype.adjustCornerBBoxWidth=function(){var r=this.layoutResult.colsHierarchy,n=this.spreadsheet.options.width,i=n*Kjt,a=r==null?void 0:r.width,o=n-this.originalWidth;if(this.originalWidth<=i||a<=o)return this.originalWidth;var s=0,l=n-i;return a<=l?s=this.originalWidth-(a-o):s=i,Math.floor(s)},t}(qot),zve=function(e){en(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.calculateBBox=function(){this.originalWidth=this.facet.getRealWidth(),this.originalHeight=this.facet.getRealHeight();var r=this.facet.cornerBBox,n={x:Math.floor(r.maxX),y:Math.floor(r.maxY)},i=this.spreadsheet.theme.scrollBar.size,a=this.spreadsheet.options,o=a.width,s=a.height,l=Math.max(0,o-n.x),u=Math.max(0,s-n.y-i);this.x=n.x,this.y=n.y,this.width=l,this.height=u,this.viewportHeight=Math.abs(Math.floor(Math.min(u,this.originalHeight))),this.viewportWidth=Math.abs(Math.floor(Math.min(l,this.originalWidth))),this.maxX=n.x+this.viewportWidth,this.maxY=n.y+this.viewportHeight,this.minX=n.x,this.minY=n.y;var c=this.spreadsheet.options,f=c.frozenTrailingColCount,d=c.frozenTrailingRowCount;f>0&&(this.viewportWidth=this.width,this.maxX=n.x+this.width),d>0&&(this.viewportHeight=this.height,this.maxY=n.y+this.height)},t}(qot),qk=function(e){en(t,e);function t(r){var n=e.call(this,r)||this;return n.isHeaderCellInViewport=function(i,a,o,s){return i+a>=o&&o+s>=i},n.headerConfig=r,n}return t.prototype.getConfig=function(){return this.headerConfig},t.prototype.clearResizeAreaGroup=function(r){var n=this.get("parent"),i=n==null?void 0:n.findById(r);i==null||i.clear()},t.prototype.render=function(r){this.clearResizeAreaGroup(r),this.clear(),this.layout(),this.offset(),this.clip()},t.prototype.onScrollXY=function(r,n,i){this.headerConfig.scrollX=r,this.headerConfig.scrollY=n,this.render(i)},t.prototype.onRowScrollX=function(r,n){this.headerConfig.scrollX=r,this.render(n)},t.prototype.clear=function(){e.prototype.clear.call(this)},t}(tv),Kk=function(e){en(t,e);function t(r){var n=e.call(this,r)||this;return n.scrollGroup=n.addGroup({name:Wjt,zIndex:Vrt}),n}return t.prototype.onColScroll=function(r,n){this.headerConfig.scrollX!==r&&(this.headerConfig.scrollX=r,this.render(n))},t.prototype.clip=function(){var r=this.headerConfig,n=r.width,i=r.height,a=r.scrollX,o=r.spreadsheet,s=o.isFrozenRowHeader();this.scrollGroup.setClip({type:"rect",attrs:{x:s?a:0,y:0,width:s?n:n+a,height:i}})},t.prototype.clear=function(){var r,n;(r=this.scrollGroup)===null||r===void 0||r.clear(),(n=this.background)===null||n===void 0||n.remove(!0)},t.prototype.getCellInstance=function(r,n,i){return new _3(r,n,i)},t.prototype.getCellGroup=function(r){return this.scrollGroup},t.prototype.isColCellInRect=function(r){var n=this.headerConfig,i=n.spreadsheet,a=n.cornerWidth,o=n.width,s=n.scrollX;return o+s>r.x&&s-(i.isFrozenRowHeader()?0:a)<r.x+r.width},t.prototype.layout=function(){var r=this,n=this.headerConfig,i=n.data,a=n.spreadsheet,o=a.options.colCell;xi(i,function(s){var l=s;if(r.isColCellInRect(l)){var u=(o==null?void 0:o(l,a,r.headerConfig))||r.getCellInstance(l,a,r.headerConfig);l.belongsCell=u;var c=r.getCellGroup(l);c.add(u)}})},t.prototype.offset=function(){var r=this.headerConfig,n=r.position,i=r.scrollX;m3(this.scrollGroup,n.x-i)},t}(qk),Uve=function(e){en(t,e);function t(r){return e.call(this,r)||this}return t.getCornerHeader=function(r,n,i,a,o,s){var l=r.width,u=r.height,c=n.originalWidth,f=n.originalHeight,d=n.width,v=n.height,g=this.getCornerNodes({x:n.x,y:n.y},c,f,a.rows,a.columns,o.rowsHierarchy,o.colsHierarchy,a.dataSet,i,s);return new t({data:g,position:{x:n.x,y:n.y},width:d,height:v,originalHeight:f,originalWidth:c,viewportWidth:l,viewportHeight:u,hierarchyType:a.hierarchyType,hierarchyCollapse:a.hierarchyCollapse,rows:a.rows,columns:a.columns,seriesNumberWidth:i,spreadsheet:s})},t.getCornerNodes=function(r,n,i,a,o,s,l,u,c,f){var d,v,g,x=[],w=f.options.style.colCfg,S=l==null?void 0:l.sampleNodeForLastLevel,A=(d=S==null?void 0:S.y)!==null&&d!==void 0?d:0,M=(g=(v=S==null?void 0:S.height)!==null&&v!==void 0?v:w==null?void 0:w.height)!==null&&g!==void 0?g:0;if(c){var R=new su({id:"",key:qjt,value:El("序号")});R.x=r==null?void 0:r.x,R.y=A,R.width=c,R.height=M,R.isPivotMode=!0,R.spreadsheet=f,R.cornerType=Rd.Series,x.push(R)}if(f.isHierarchyTreeType()){var O=this.getTreeCornerText(f),N=new su({key:"",id:O,value:O});N.x=r.x+c,N.y=A,N.width=n-c,N.height=M,N.seriesNumberWidth=c,N.isPivotMode=!0,N.spreadsheet=f,N.cornerType=Rd.Row,x.push(N)}else s.sampleNodesForAllLevels.forEach(function(k){var V=a[k.level],Q=new su({key:V,id:V,value:u.getFieldName(V)});Q.x=k.x+c,Q.y=A,Q.width=k.width,Q.height=M,Q.field=V,Q.isPivotMode=!0,Q.cornerType=Rd.Row,Q.spreadsheet=f,x.push(Q)});return l.sampleNodesForAllLevels.forEach(function(k){if(k.level<l.maxLevel){var V=o[k.level],Q=new su({key:V,id:V,value:u.getFieldName(V)});Q.x=r.x,Q.y=k.y,Q.width=n,Q.height=k.height,Q.field=V,Q.isPivotMode=!0,Q.cornerType=Rd.Col,Q.spreadsheet=f,x.push(Q)}}),x},t.getTreeCornerText=function(r){var n=r.dataSet.fields.rows,i=n===void 0?[]:n,a=r.options.cornerText;if(a)return a;var o=r.store.get("drillDownFieldInLevel",[]),s=o.map(function(u){return u.drillField}),l=i.filter(function(u){return!oc(s,u)}).map(function(u){return r.dataSet.getFieldName(u)}).join("/");return l},t.prototype.onCorScroll=function(r,n){this.headerConfig.scrollX=r,this.render(n)},t.prototype.destroy=function(){e.prototype.destroy.call(this)},t.prototype.layout=function(){this.renderCells()},t.prototype.renderCells=function(){var r=this,n,i,a,o,s=this.headerConfig,l=s.data,u=s.spreadsheet,c=(i=(n=u==null?void 0:u.facet)===null||n===void 0?void 0:n.cfg)===null||i===void 0?void 0:i.cornerHeader,f=(o=(a=u==null?void 0:u.facet)===null||a===void 0?void 0:a.cfg)===null||o===void 0?void 0:o.cornerCell;if(c){c(this,u,this.headerConfig);return}l.forEach(function(d){var v;f&&(v=f(d,r.headerConfig.spreadsheet,r.headerConfig)),Or(v)&&(v=new Ide(d,r.headerConfig.spreadsheet,r.headerConfig)),r.add(v)})},t.prototype.offset=function(){var r=this.headerConfig.scrollX;m3(this,-r)},t.prototype.clip=function(){var r=this.headerConfig,n=r.width,i=r.height,a=r.scrollX;this.setClip({type:"rect",attrs:{x:a,y:0,width:n,height:i}})},t.prototype.getNodes=function(){return this.headerConfig.data||[]},t}(qk),$ve=function(e){en(t,e);function t(r){var n=e.call(this,r)||this;return n.render(),n}return t.prototype.layout=function(){this.addCornerBottomBorder(),this.addCornerRightBorder(),this.addSplitLineShadow()},t.prototype.render=function(){this.clear(),this.layout()},t.prototype.onBorderScroll=function(r){this.cfg.scrollX=r;var n=this.cfg.position;qv(this,n.x-r,0),this.render()},t.prototype.onChangeShadowVisibility=function(r,n){this.cfg.showViewportLeftShadow=r>0,this.cfg.showViewportRightShadow=Math.floor(r)<Math.floor(n),this.render()},t.prototype.addCornerRightBorder=function(){var r,n=this.cfg,i=n.isPivotMode;if(i){var a=n.width,o=n.height,s=n.viewportHeight,l=n.position,u=n.spreadsheet,c=(r=u.theme)===null||r===void 0?void 0:r.splitLine,f=l.x+a,d=l.y,v=l.y+o+s;this.addShape("line",{attrs:{x1:f,y1:d,x2:f,y2:v,stroke:c.verticalBorderColor,lineWidth:c.verticalBorderWidth,opacity:c.verticalBorderColorOpacity,lineDash:c.borderDash}})}},t.prototype.addCornerBottomBorder=function(){var r,n=this.cfg,i=n.width,a=n.height,o=n.viewportWidth,s=n.position,l=n.scrollX,u=n.scrollContainsRowHeader,c=n.spreadsheet,f=(r=c.theme)===null||r===void 0?void 0:r.splitLine,d=s.x,v=d+i+o+(u?l:0),g=s.y+a-1;this.addShape("line",{attrs:{x1:d,y1:g,x2:v,y2:g,stroke:f.horizontalBorderColor,lineWidth:f.horizontalBorderWidth,opacity:f.horizontalBorderColorOpacity,lineDash:f.borderDash}})},t.prototype.addSplitLineShadow=function(){var r,n=this.cfg,i=n.isPivotMode,a=n.spreadsheet,o=(r=a.theme)===null||r===void 0?void 0:r.splitLine;!i||!o.showShadow||!a.isFrozenRowHeader()||(this.addSplitLineLeftShadow(),this.addSplitLineRightShadow())},t.prototype.addSplitLineLeftShadow=function(){var r,n,i;if(this.cfg.showViewportLeftShadow){var a=this.cfg,o=a.width,s=a.height,l=a.viewportHeight,u=a.position,c=a.spreadsheet,f=(r=c.theme)===null||r===void 0?void 0:r.splitLine,d=u.x+o,v=u.y;this.addShape("rect",{attrs:{x:d,y:v,width:f.shadowWidth,height:l+s,fill:"l (0) 0:".concat((n=f.shadowColors)===null||n===void 0?void 0:n.left," 1:").concat((i=f.shadowColors)===null||i===void 0?void 0:i.right)}})}},t.prototype.addSplitLineRightShadow=function(){var r,n,i;if(this.cfg.showViewportRightShadow){var a=this.cfg,o=a.width,s=a.height,l=a.viewportHeight,u=a.viewportWidth,c=a.position,f=a.spreadsheet,d=(r=f.theme)===null||r===void 0?void 0:r.splitLine,v=c.x+o+u-d.shadowWidth,g=c.y;this.addShape("rect",{attrs:{x:v,y:g,width:d.shadowWidth,height:l+s,fill:"l (0) 0:".concat((n=d.shadowColors)===null||n===void 0?void 0:n.right," 1:").concat((i=d.shadowColors)===null||i===void 0?void 0:i.left)}})}},t}(tv),Qk=function(e){en(t,e);function t(r){return e.call(this,r)||this}return t.prototype.destroy=function(){e.prototype.destroy.call(this),this.gm&&this.gm.destroy()},t.prototype.rowCellInRect=function(r){var n=this.headerConfig,i=n.width,a=n.viewportHeight,o=n.seriesNumberWidth,s=n.scrollY,l=n.scrollX;return a+s>r.y&&s<r.y+r.height&&i-o+l>r.x&&l-o<r.x+r.width},t.prototype.createCellInstance=function(r){return new jS(r,this.headerConfig.spreadsheet,this.headerConfig)},t.prototype.getCellGroup=function(r){return this},t.prototype.getCustomRowCell=function(){var r,n,i=this.headerConfig.spreadsheet;return(n=(r=i==null?void 0:i.facet)===null||r===void 0?void 0:r.cfg)===null||n===void 0?void 0:n.rowCell},t.prototype.layout=function(){var r=this,n=this.headerConfig,i=n.data,a=n.spreadsheet,o=this.getCustomRowCell();xi(i,function(s){if(r.rowCellInRect(s)&&s.height!==0){var l=void 0;o&&(l=o(s,a,r.headerConfig)),Or(l)&&a.isPivotMode()&&(l=r.createCellInstance(s)),s.belongsCell=l;var u=r.getCellGroup(s);u.add(l)}})},t.prototype.offset=function(){var r=this.headerConfig,n=r.scrollX,i=r.scrollY,a=r.position,o=r.seriesNumberWidth;qv(this,a.x-n+o,a.y-i)},t.prototype.clip=function(){var r=this.headerConfig,n=r.width,i=r.viewportHeight,a=r.scrollX,o=r.scrollY,s=r.seriesNumberWidth;this.setClip({type:"rect",attrs:{x:a-s,y:o,width:n,height:i}})},t}(qk),Qot=function(e){en(t,e);function t(r){var n=e.call(this,r)||this;n.scrollGroup=n.addGroup({name:Yjt,zIndex:Vrt}),n.frozenHeadGroup=n.addGroup({name:Zjt,zIndex:LC});var i=n.headerConfig,a=i.position,o=i.seriesNumberWidth;return qv(n.frozenHeadGroup,a.x+o,a.y),n}return t.prototype.rowCellInRectXDir=function(r){var n=this.headerConfig,i=n.width,a=n.scrollX,o=n.seriesNumberWidth,s=r.x+o;return i+a>s&&a<s+r.width},t.prototype.rowCellInRectYDir=function(r){var n=this.headerConfig,i=n.viewportHeight,a=n.scrollY,o=r.y-this.getFrozenFirstRowHeight();return i+a>o&&a<o+r.height},t.prototype.rowCellInRect=function(r){var n=this.rowCellInRectXDir(r);return this.isFrozenRow(r)?n:n&&this.rowCellInRectYDir(r)},t.prototype.getCellGroup=function(r){return this.isFrozenRow(r)?this.frozenHeadGroup:this.scrollGroup},t.prototype.offset=function(){var r=this.headerConfig,n=r.scrollX,i=r.scrollY,a=r.position,o=r.seriesNumberWidth,s=a.x-n+o;qv(this.scrollGroup,s,a.y-i),m3(this.frozenHeadGroup,s)},t.prototype.clip=function(){var r=this.headerConfig,n=r.width,i=r.viewportHeight,a=r.scrollX,o=r.scrollY,s=r.seriesNumberWidth,l=a-s;this.scrollGroup.setClip({type:"rect",attrs:{x:l,y:o+this.getFrozenFirstRowHeight(),width:n,height:i}}),this.frozenHeadGroup.setClip({type:"rect",attrs:{x:l,y:0,width:this.headerConfig.width,height:this.getFrozenFirstRowHeight()}})},t.prototype.isFrozenRow=function(r){var n,i=this.headerConfig.spreadsheet,a=i.facet,o=rb(i.options,(n=a.layoutResult)===null||n===void 0?void 0:n.rowNodes).frozenRowCount;return o>0&&r.rowIndex>=0&&r.rowIndex<o},t.prototype.getFrozenFirstRowHeight=function(){var r,n=this.headerConfig.spreadsheet,i=n.facet,a=rb(n.options,(r=i.layoutResult)===null||r===void 0?void 0:r.rowNodes).frozenRowHeight;return a},t.prototype.clear=function(){this.frozenHeadGroup.clear(),this.scrollGroup.clear()},t}(Qk),Jot=function(e){en(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.getSeriesNumberHeader=function(r){var n,i=r.viewportBBox,a=r.seriesNumberWidth,o=r.leafNodes,s=r.spreadsheet,l=r.cornerWidth,u=i.height,c=i.viewportHeight,f=[],d=s.isHierarchyTreeType();o.forEach(function(A){var M=new su({id:"",key:"",value:"".concat(f.length+1)});M.x=A.x,M.y=A.y,M.height=d?A.getTotalHeightForTreeHierarchy():A.height,M.width=a,M.rowIndex=A.rowIndex,M.spreadsheet=s,M.isLeaf=!0,f.push(M)});var v=s.facet,g=rb(s.options,(n=v.layoutResult)===null||n===void 0?void 0:n.rowNodes),x=g.frozenRowCount,w=g.frozenRowHeight,S=!!x;return new t({width:l,height:u,viewportWidth:l,viewportHeight:S?c-w:c,position:{x:0,y:i.y},data:f,spreadsheet:s,seriesNumberWidth:0,hierarchyType:s.options.hierarchyType,linkFields:[]})},t.prototype.createCellInstance=function(r){var n=this.isFrozenRow(r);return new wot(r,this.headerConfig.spreadsheet,Zt(Zt({},this.headerConfig),{scrollY:n?0:this.headerConfig.scrollY}),n)},t.prototype.getCustomRowCell=function(){return null},t}(Qot),Hve=function(e){en(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.createCellInstance=function(r){var n=this.headerConfig,i=n.spreadsheet,a=n.scrollY,o=this.isFrozenRow(r);return new jS(r,i,Zt(Zt({},this.headerConfig),{scrollY:o?0:a}),o)},t}(Qot),Vve=function(){function e(t){var r=this;this.scrollFrameId=null,this.hideScrollBar=function(){var n,i,a;(n=r.hRowScrollBar)===null||n===void 0||n.hide(),(i=r.hScrollBar)===null||i===void 0||i.hide(),(a=r.vScrollBar)===null||a===void 0||a.hide()},this.delayHideScrollBar=NC(this.hideScrollBar,1e3),this.delayHideScrollbarOnMobile=function(){Bl()&&r.delayHideScrollBar()},this.showVerticalScrollBar=function(){var n;(n=r.vScrollBar)===null||n===void 0||n.show()},this.showHorizontalScrollBar=function(){var n,i;(n=r.hRowScrollBar)===null||n===void 0||n.show(),(i=r.hScrollBar)===null||i===void 0||i.show()},this.onContainerWheelForMobileCompatibility=function(){var n=r.spreadsheet.getCanvasElement(),i,a;n.addEventListener("touchstart",function(o){i=o.touches[0].clientY}),n.addEventListener("touchend",function(o){a=o.changedTouches[0].clientY,a<i?r.scrollDirection=Fl.SCROLL_UP:a>i&&(r.scrollDirection=Fl.SCROLL_DOWN)})},this.onContainerWheel=function(){r.onContainerWheelForPc(),r.onContainerWheelForMobile()},this.getMobileWheelDeltaY=function(n){return r.scrollDirection===Fl.SCROLL_UP?Math.max(0,n):r.scrollDirection===Fl.SCROLL_DOWN?Math.min(0,n):n},this.onContainerWheelForPc=function(){var n=r.spreadsheet.getCanvasElement();n==null||n.addEventListener("wheel",r.onWheel)},this.onContainerWheelForMobile=function(){r.mobileWheel=new jde(r.spreadsheet.container),r.mobileWheel.on("wheel",function(n){r.spreadsheet.hideTooltip();var i=n.event,a=n.deltaX,o=n.deltaY,s=n.x,l=n.y,u=r.getMobileWheelDeltaY(o);r.onWheel(Zt(Zt({},i),{deltaX:a,deltaY:u,offsetX:s,offsetY:l}))}),r.onContainerWheelForMobileCompatibility()},this.bindEvents=function(){r.onContainerWheel(),r.emitPaginationEvent()},this.setScrollOffset=function(n){Object.keys(n).forEach(function(i){var a=n[i];u3(a)||r.spreadsheet.store.set(i,Math.floor(a))})},this.getScrollOffset=function(){var n=r.spreadsheet.store;return{scrollX:n.get("scrollX",0),scrollY:n.get("scrollY",0),rowHeaderScrollX:n.get("rowHeaderScrollX",0)}},this.emitPaginationEvent=function(){var n=r.cfg.pagination;if(n){var i=n.current,a=i===void 0?mB:i,o=n.pageSize,s=r.viewCellHeights.getTotalLength(),l=Math.floor((s-1)/o)+1;r.cfg.spreadsheet.emit(Me.LAYOUT_PAGINATION,{pageSize:o,pageCount:l,total:s,current:a})}},this.unbindEvents=function(){var n=r.spreadsheet.getCanvasElement();n==null||n.removeEventListener("wheel",r.onWheel),r.mobileWheel.destroy()},this.clipPanelGroup=function(){var n;r.foregroundGroup=r.spreadsheet.foregroundGroup,r.backgroundGroup=r.spreadsheet.backgroundGroup,r.panelGroup=r.spreadsheet.panelGroup;var i=r.panelBBox,a=i.width,o=i.height;(n=r.spreadsheet.panelScrollGroup)===null||n===void 0||n.setClip({type:"rect",attrs:{x:0,y:r.cornerBBox.height,width:a,height:o}})},this.calculateCellWidthHeight=function(){var n=r.layoutResult.colLeafNodes,i=h3(n,function(a,o){return a.push(co(a)+o.width),a},[0]);r.viewCellWidths=i,r.viewCellHeights=r.getViewCellHeights(r.layoutResult)},this.getRealScrollX=function(n,i){return i===void 0&&(i=0),r.cfg.spreadsheet.isScrollContainsRowHeader()?n:i},this.calculatePanelBBox=function(){r.panelBBox=new zve(r,!0)},this.getRealWidth=function(){return co(r.viewCellWidths)},this.getRealHeight=function(){var n=r.cfg.pagination,i=r.viewCellHeights;if(n){var a=r.getCellRange(),o=a.start,s=a.end;return i.getCellOffsetY(s+1)-i.getCellOffsetY(o)}return i.getTotalHeight()},this.clearAllGroup=function(){for(var n=r.panelGroup.getChildren()||[],i=n.length-1;i>=0;i--){var a=n[i];a instanceof tv?a.set("children",[]):n[i].remove()}r.foregroundGroup.set("children",[]),r.backgroundGroup.set("children",[])},this.scrollWithAnimation=function(n,i,a){var o,s,l,u;n===void 0&&(n={}),i===void 0&&(i=200);var c=r.getAdjustedScrollOffset({scrollX:((o=n.offsetX)===null||o===void 0?void 0:o.value)||0,scrollY:((s=n.offsetY)===null||s===void 0?void 0:s.value)||0,rowHeaderScrollX:((l=n.rowHeaderOffsetX)===null||l===void 0?void 0:l.value)||0}),f=c.scrollX,d=c.scrollY,v=c.rowHeaderScrollX;(u=r.timer)===null||u===void 0||u.stop();var g=r.getScrollOffset(),x=[f??g.scrollX,d??g.scrollY,v??g.rowHeaderScrollX],w=Rve(Object.values(g),x);r.timer=uN(function(S){try{var A=Math.min(S/i,1),M=lr(w(A),3),R=M[0],O=M[1],N=M[2];r.setScrollOffset({rowHeaderScrollX:N,scrollX:R,scrollY:O}),r.startScroll(),S>i&&(r.timer.stop(),a==null||a())}catch(k){console.error(k),r.timer.stop()}})},this.scrollImmediately=function(n){var i,a,o;n===void 0&&(n={});var s=r.getAdjustedScrollOffset({scrollX:((i=n.offsetX)===null||i===void 0?void 0:i.value)||0,scrollY:((a=n.offsetY)===null||a===void 0?void 0:a.value)||0,rowHeaderScrollX:((o=n.rowHeaderOffsetX)===null||o===void 0?void 0:o.value)||0}),l=s.scrollX,u=s.scrollY,c=s.rowHeaderScrollX;r.setScrollOffset({scrollX:l,scrollY:u,rowHeaderScrollX:c}),r.startScroll()},this.startScroll=function(n){var i,a,o;n===void 0&&(n=!1);var s=r.getScrollOffset(),l=s.rowHeaderScrollX,u=s.scrollX,c=s.scrollY;(i=r.hRowScrollBar)===null||i===void 0||i.onlyUpdateThumbOffset(r.getScrollBarOffset(l,r.hRowScrollBar)),(a=r.hScrollBar)===null||a===void 0||a.onlyUpdateThumbOffset(r.getScrollBarOffset(u,r.hScrollBar)),(o=r.vScrollBar)===null||o===void 0||o.onlyUpdateThumbOffset(r.getScrollBarOffset(c,r.vScrollBar)),r.dynamicRenderCell(n)},this.getRendererHeight=function(){var n=r.getCellRange(),i=n.start,a=n.end;return r.viewCellHeights.getCellOffsetY(a+1)-r.viewCellHeights.getCellOffsetY(i)},this.getAdjustedScrollOffset=function(n){var i=n.scrollX,a=n.scrollY,o=n.rowHeaderScrollX;return{scrollX:cP(i,r.layoutResult.colsHierarchy.width,r.panelBBox.width),scrollY:cP(a,r.getRendererHeight(),r.panelBBox.height),rowHeaderScrollX:Fve(o,r.cornerBBox)}},this.renderRowScrollBar=function(n){if(!r.cfg.spreadsheet.isScrollContainsRowHeader()&&r.cornerBBox.width<r.cornerBBox.originalWidth){var i=r.cornerBBox.originalWidth-r.cornerBBox.width,a=r.getScrollbarPosition().maxY,o=r.spreadsheet.theme,s=o.splitLine,l=o.scrollBar,u=Math.max(r.cornerBBox.width*r.cornerBBox.width/r.cornerBBox.originalWidth,l==null?void 0:l.thumbHorizontalMinSize),c=u-(s==null?void 0:s.verticalBorderWidth);r.hRowScrollBar=new uP({isHorizontal:!0,trackLen:r.cornerBBox.width,thumbLen:c,position:{x:r.cornerBBox.minX+r.scrollBarSize/2,y:a},thumbOffset:n*(r.cornerBBox.width-u)/i,theme:r.scrollBarTheme,scrollTargetMaxOffset:i}),r.hRowScrollBar.on(zy.ScrollChange,function(f){var d,v,g=f.offset,x=r.getValidScrollBarOffset(g,i),w=Math.floor(x);r.setScrollOffset({rowHeaderScrollX:w}),(d=r.rowHeader)===null||d===void 0||d.onRowScrollX(w,Kx),(v=r.rowIndexHeader)===null||v===void 0||v.onRowScrollX(w,$G),r.cornerHeader.onRowScrollX(w,jF);var S=r.getScrollBarOffset(w,r.hRowScrollBar),A=r.getScrollOffset(),M=A.scrollX,R=A.scrollY,O={scrollX:M,scrollY:R,rowHeaderScrollX:S};r.hRowScrollBar.updateThumbOffset(S,!1),r.spreadsheet.emit(Me.ROW_CELL_SCROLL,O),r.spreadsheet.emit(Me.GLOBAL_SCROLL,O)}),r.foregroundGroup.add(r.hRowScrollBar)}},this.getValidScrollBarOffset=function(n,i){return pR(n,0,i)},this.renderHScrollBar=function(n,i,a){if(Math.floor(n)<Math.floor(i)){var o=r.scrollBarSize/2,s=r.getScrollbarPosition().maxY,l=n+(r.cfg.spreadsheet.isScrollContainsRowHeader()?Math.min(r.cornerBBox.width,r.getCanvasHW().width):0),u={x:r.panelBBox.minX+(r.cfg.spreadsheet.isScrollContainsRowHeader()?-r.cornerBBox.width+o:o),y:s},c=i+(r.cfg.spreadsheet.isScrollContainsRowHeader()?r.cornerBBox.width:0),f=r.spreadsheet.theme.scrollBar,d=c-l,v=Math.max(l/c*l,f==null?void 0:f.thumbHorizontalMinSize);r.hScrollBar=new uP({isHorizontal:!0,trackLen:l,thumbLen:v,position:u,thumbOffset:a*(l-v)/d,theme:r.scrollBarTheme,scrollTargetMaxOffset:d}),r.hScrollBar.on(zy.ScrollChange,function(g){var x=g.offset,w=g.updateThumbOffset,S=r.getValidScrollBarOffset(x,d);w&&r.hScrollBar.updateThumbOffset(r.getScrollBarOffset(S,r.hScrollBar),!1),r.setScrollOffset({scrollX:S}),r.dynamicRenderCell()}),r.foregroundGroup.add(r.hScrollBar)}},this.getScrollbarPosition=function(){var n=r.panelBBox,i=n.maxX,a=n.maxY,o=r.getCanvasHW(),s=o.width,l=o.height,u=r.spreadsheet.options.interaction.scrollbarPosition===lR.CONTENT;return{maxX:(u?i:s)-r.scrollBarSize,maxY:u?a:l-r.scrollBarSize}},this.renderVScrollBar=function(n,i,a){if(n<i){var o=r.spreadsheet.theme.scrollBar,s=Math.max(n/i*n,o==null?void 0:o.thumbVerticalMinSize),l=i-n,u=r.getScrollbarPosition().maxX;r.vScrollBar=new uP({isHorizontal:!1,trackLen:n,thumbLen:s,thumbOffset:a*(n-s)/l,position:{x:u,y:r.panelBBox.minY},theme:r.scrollBarTheme,scrollTargetMaxOffset:l}),r.vScrollBar.on(zy.ScrollChange,function(c){var f=c.offset,d=c.updateThumbOffset,v=r.getValidScrollBarOffset(f,l);d&&r.vScrollBar.updateThumbOffset(r.getScrollBarOffset(v,r.vScrollBar),!1),r.setScrollOffset({scrollY:v}),r.dynamicRenderCell()}),r.foregroundGroup.add(r.vScrollBar)}},this.getScrollBarOffset=function(n,i){var a=i.trackLen,o=i.thumbLen,s=i.scrollTargetMaxOffset;return n*(a-o)/s},this.isScrollOverThePanelArea=function(n){var i=n.offsetX,a=n.offsetY;return i>r.panelBBox.minX&&i<r.panelBBox.maxX&&a>r.panelBBox.minY&&a<r.panelBBox.maxY},this.isScrollOverTheCornerArea=function(n){var i=n.offsetX,a=n.offsetY;return i>r.cornerBBox.minX&&i<r.cornerBBox.maxX&&a>r.cornerBBox.minY&&a<r.cornerBBox.maxY+r.panelBBox.height},this.updateHorizontalRowScrollOffset=function(n){var i,a=n.offset,o=n.offsetX,s=n.offsetY;r.isScrollOverTheCornerArea({offsetX:o,offsetY:s})&&((i=r.hRowScrollBar)===null||i===void 0||i.emitScrollChange(a))},this.updateHorizontalScrollOffset=function(n){var i,a=n.offset,o=n.offsetX,s=n.offsetY;(!r.hRowScrollBar||r.isScrollOverThePanelArea({offsetX:o,offsetY:s}))&&((i=r.hScrollBar)===null||i===void 0||i.emitScrollChange(a))},this.isScrollToLeft=function(n){var i=n.deltaX,a=n.offsetX,o=n.offsetY;if(!r.hScrollBar&&!r.hRowScrollBar)return!0;var s=!r.hRowScrollBar||r.isScrollOverThePanelArea({offsetY:o,offsetX:a})||r.hRowScrollBar.thumbOffset<=0,l=!r.hScrollBar||r.hScrollBar.thumbOffset<=0;return i<=0&&l&&s},this.isScrollToRight=function(n){var i,a,o,s,l,u,c=n.deltaX,f=n.offsetX,d=n.offsetY;if(!r.hScrollBar&&!r.hRowScrollBar)return!0;var v=r.spreadsheet.isFrozenRowHeader()?(i=r.panelBBox)===null||i===void 0?void 0:i.width:(a=r.panelBBox)===null||a===void 0?void 0:a.maxX,g=!r.hRowScrollBar||r.isScrollOverThePanelArea({offsetY:d,offsetX:f})||((o=r.hRowScrollBar)===null||o===void 0?void 0:o.thumbOffset)+((s=r.hRowScrollBar)===null||s===void 0?void 0:s.thumbLen)>=r.cornerBBox.width,x=r.hRowScrollBar&&r.isScrollOverTheCornerArea({offsetX:f,offsetY:d})||((l=r.hScrollBar)===null||l===void 0?void 0:l.thumbOffset)+((u=r.hScrollBar)===null||u===void 0?void 0:u.thumbLen)>=v;return c>=0&&x&&g},this.isScrollToTop=function(n){var i;return r.vScrollBar?n<=0&&((i=r.vScrollBar)===null||i===void 0?void 0:i.thumbOffset)<=0:!0},this.isScrollToBottom=function(n){var i,a,o;return r.vScrollBar?n>=0&&((i=r.vScrollBar)===null||i===void 0?void 0:i.thumbOffset)+((a=r.vScrollBar)===null||a===void 0?void 0:a.thumbLen)>=((o=r.panelBBox)===null||o===void 0?void 0:o.height):!0},this.isVerticalScrollOverTheViewport=function(n){return!r.isScrollToTop(n)&&!r.isScrollToBottom(n)},this.isHorizontalScrollOverTheViewport=function(n){return!r.isScrollToLeft(n)&&!r.isScrollToRight(n)},this.isScrollOverTheViewport=function(n){var i=n.deltaY,a=n.deltaX,o=n.offsetY,s=o<=r.cornerBBox.maxY;return s?!1:i!==0?r.isVerticalScrollOverTheViewport(i):a!==0?r.isHorizontalScrollOverTheViewport(n):!1},this.cancelScrollFrame=function(){return Bl()&&r.scrollFrameId?!1:(cancelAnimationFrame(r.scrollFrameId),!0)},this.clearScrollFrameIdOnMobile=function(){Bl()&&(r.scrollFrameId=null)},this.stopScrollChainingIfNeeded=function(n){var i=r.spreadsheet.options.interaction;i.overscrollBehavior!=="auto"&&(r.cancelScrollFrame(),r.stopScrollChaining(n))},this.stopScrollChaining=function(n){var i,a;n!=null&&n.cancelable&&((i=n==null?void 0:n.preventDefault)===null||i===void 0||i.call(n));var o=n==null?void 0:n.originalEvent;o!=null&&o.cancelable&&((a=o==null?void 0:o.preventDefault)===null||a===void 0||a.call(o))},this.onWheel=function(n){var i=r.spreadsheet.options.interaction,a=n.deltaX,o=n.deltaY,s=n.offsetX,l=n.offsetY,u=n.shiftKey;u&&zat()&&(s=s-a+o,a=o,l-=o,o=0);var c=lr(Rhe(a,o,i.scrollSpeedRatio),2),f=c[0],d=c[1];if(r.spreadsheet.hideTooltip(),r.spreadsheet.interaction.clearHoverTimer(),!r.isScrollOverTheViewport({deltaX:f,deltaY:d,offsetX:s,offsetY:l})){r.stopScrollChainingIfNeeded(n);return}r.stopScrollChaining(n),r.spreadsheet.interaction.addIntercepts([Ti.HOVER]),r.cancelScrollFrame()&&(r.scrollFrameId=requestAnimationFrame(function(){var v,g=r.getScrollOffset(),x=g.scrollX,w=g.scrollY,S=g.rowHeaderScrollX;f!==0&&(r.showHorizontalScrollBar(),r.updateHorizontalRowScrollOffset({offsetX:s,offsetY:l,offset:f+S}),r.updateHorizontalScrollOffset({offsetX:s,offsetY:l,offset:f+x})),d!==0&&(r.showVerticalScrollBar(),(v=r.vScrollBar)===null||v===void 0||v.emitScrollChange(d+w)),r.delayHideScrollbarOnMobile(),r.clearScrollFrameIdOnMobile()}))},this.addCell=function(n){var i=r.spreadsheet.panelScrollGroup;i==null||i.add(n)},this.realCellRender=function(n,i){var a=r.calculateXYIndexes(n,i);Fp.getInstance().logger("renderIndex:",r.preCellIndexes,a);var o=kve(r.preCellIndexes,a),s=o.add,l=o.remove;Fp.getInstance().debugCallback(ihe,function(){xi(s,function(c){var f=lr(c,2),d=f[0],v=f[1],g=r.layoutResult.getCellMeta(v,d);if(g){var x=r.cfg.dataCell(g);x.set("name","".concat(d,"-").concat(v)),r.addCell(x)}});var u=Xw(r.panelGroup.getChildren(),_0);xi(l,function(c){var f=lr(c,2),d=f[0],v=f[1],g=zu(u,function(x){return x.get("name")==="".concat(d,"-").concat(v)});g==null||g.remove(!0)}),Fp.getInstance().logger("Render Cell Panel: ".concat(u==null?void 0:u.length,", Add: ").concat(s==null?void 0:s.length,", Remove: ").concat(l==null?void 0:l.length))}),r.preCellIndexes=a,r.spreadsheet.emit(Me.LAYOUT_AFTER_REAL_DATA_CELL_RENDER,{add:s,remove:l,spreadsheet:r.spreadsheet})},this.getGridInfo=function(){var n=lr(r.preCellIndexes.center,4),i=n[0],a=n[1],o=n[2],s=n[3],l=Zot(i,a,r.layoutResult.colLeafNodes),u=S3(o,s,r.viewCellHeights);return{cols:l,rows:u}},this.onAfterScroll=NC(function(){var n=r.spreadsheet,i=n.interaction,a=n.container;if(!i.isSelectedState()&&(i.removeIntercepts([Ti.HOVER]),i.getHoverAfterScroll())){var o=i.eventController.canvasMousemoveEvent;if(o){var s=o.x,l=o.y,u=a.getShape(s,l);u&&a.emit(tc.MOUSE_MOVE,Zt(Zt({},o),{shape:u,target:u,timestamp:performance.now()}))}}},300),this.cfg=t,this.spreadsheet=t.spreadsheet,this.init()}return Object.defineProperty(e.prototype,"scrollBarTheme",{get:function(){return this.spreadsheet.theme.scrollBar},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scrollBarSize",{get:function(){return this.scrollBarTheme.size},enumerable:!1,configurable:!0}),e.prototype.getCellCustomWidth=function(t,r){return hu(r)?r==null?void 0:r(t):r},e.prototype.getCellDraggedWidth=function(t){var r=this.cfg.colCfg;return ii(r==null?void 0:r.widthByFieldValue,"".concat(t.value))},e.prototype.render=function(){Nhe(this.spreadsheet.dataCfg.fields)||(this.adjustScrollOffset(),this.renderHeaders(),this.renderScrollBars(),this.renderBackground(),this.dynamicRenderCell(!0))},e.prototype.adjustScrollOffset=function(){var t=this.getAdjustedScrollOffset(this.getScrollOffset());this.setScrollOffset(t)},e.prototype.getSeriesNumberWidth=function(){var t=this.cfg.showSeriesNumber;return t?this.spreadsheet.theme.rowCell.seriesNumberWidth:0},e.prototype.getCanvasHW=function(){return{width:this.cfg.width,height:this.cfg.height}},e.prototype.updateScrollOffset=function(t){var r,n,i,a,o,s;if(((r=t.rowHeaderOffsetX)===null||r===void 0?void 0:r.value)!==void 0){!((n=t.rowHeaderOffsetX)===null||n===void 0)&&n.animate?this.scrollWithAnimation(t):this.scrollImmediately(t);return}if(((i=t.offsetX)===null||i===void 0?void 0:i.value)!==void 0){!((a=t.offsetX)===null||a===void 0)&&a.animate?this.scrollWithAnimation(t):this.scrollImmediately(t);return}((o=t.offsetY)===null||o===void 0?void 0:o.value)!==void 0&&(!((s=t.offsetY)===null||s===void 0)&&s.animate?this.scrollWithAnimation(t):this.scrollImmediately(t))},e.prototype.getPaginationScrollY=function(){var t=this.cfg.pagination;if(t){var r=t.current,n=r===void 0?mB:r,i=t.pageSize,a=this.viewCellHeights,o=Math.max((n-1)*i,0);return a.getCellOffsetY(o)}return 0},e.prototype.destroy=function(){this.unbindEvents(),this.clearAllGroup(),this.preCellIndexes=null,cancelAnimationFrame(this.scrollFrameId)},e.prototype.calculateXYIndexes=function(t,r){var n=this.panelBBox,i=n.viewportHeight,a=n.viewportWidth,o=Lk(t,r,this.viewCellWidths,this.viewCellHeights,{width:a,height:i,x:0,y:0},this.getRealScrollX(this.cornerBBox.width));return{center:o}},e.prototype.calculateCornerBBox=function(){this.cornerBBox=new Kot(this,!0)},e.prototype.getCellRange=function(){var t=this.cfg.pagination;return Dhe(this.viewCellHeights,t)},e.prototype.panelScrollGroupClip=function(t,r){var n,i=this.spreadsheet.isFrozenRowHeader();(n=this.spreadsheet.panelScrollGroup)===null||n===void 0||n.setClip({type:"rect",attrs:{x:i?t:0,y:r,width:this.panelBBox.width+(i?0:t),height:this.panelBBox.height}})},e.prototype.clip=function(t,r){this.panelScrollGroupClip(t,r)},e.prototype.translateRelatedGroups=function(t,r,n){var i,a,o,s,l,u;qv(this.spreadsheet.panelScrollGroup,this.cornerBBox.width-t,this.cornerBBox.height-r),(i=this.rowHeader)===null||i===void 0||i.onScrollXY(this.getRealScrollX(t,n),r,Kx),(a=this.rowIndexHeader)===null||a===void 0||a.onScrollXY(this.getRealScrollX(t,n),r,$G),(o=this.cornerHeader)===null||o===void 0||o.onCorScroll(this.getRealScrollX(t,n),jF),(s=this.centerFrame)===null||s===void 0||s.onChangeShadowVisibility(t,this.getRealWidth()-this.panelBBox.width),(l=this.centerFrame)===null||l===void 0||l.onBorderScroll(this.getRealScrollX(t)),(u=this.columnHeader)===null||u===void 0||u.onColScroll(t,Yrt)},e.prototype.init=function(){var t=this;Fp.getInstance().debugCallback(nhe,function(){t.layoutResult=t.doLayout(),t.saveInitColumnLeafNodes(t.layoutResult.colLeafNodes),t.spreadsheet.emit(Me.LAYOUT_AFTER_HEADER_LAYOUT,t.layoutResult)}),this.calculateCellWidthHeight(),this.calculateCornerBBox(),this.calculatePanelBBox(),this.clipPanelGroup(),this.bindEvents()},e.prototype.renderBackground=function(){var t=this.getCanvasHW(),r=t.width,n=t.height,i=this.spreadsheet.theme.background,a=i.color,o=i.opacity;this.backgroundGroup.addShape("rect",{attrs:{fill:a,opacity:o,x:0,y:0,width:r,height:n}})},e.prototype.renderScrollBars=function(){var t=this.getScrollOffset(),r=t.scrollX,n=t.scrollY,i=t.rowHeaderScrollX,a=this.panelBBox,o=a.width,s=a.height,l=this.layoutResult.colsHierarchy.width,u=this.getRealHeight();this.renderRowScrollBar(i),this.renderHScrollBar(o,l,r),this.renderVScrollBar(s,u,n)},e.prototype.renderHeaders=function(){var t=this.getSeriesNumberWidth();this.rowHeader=this.getRowHeader(),this.columnHeader=this.getColHeader(),t>0&&!this.rowIndexHeader&&(this.rowIndexHeader=this.getSeriesNumberHeader()),this.cornerHeader=this.getCornerHeader(),this.centerFrame=this.getCenterFrame(),this.rowIndexHeader&&this.foregroundGroup.add(this.rowIndexHeader),this.rowHeader&&this.foregroundGroup.add(this.rowHeader),this.foregroundGroup.add(this.columnHeader),this.foregroundGroup.add(this.cornerHeader),this.foregroundGroup.add(this.centerFrame)},e.prototype.getRowHeaderCfg=function(){var t,r,n,i=this.panelBBox,a=i.y,o=i.viewportHeight,s=i.viewportWidth,l=i.height,u=this.getSeriesNumberWidth();return{width:this.cornerBBox.width,height:l,viewportWidth:s,viewportHeight:o,position:{x:0,y:a},data:this.layoutResult.rowNodes,hierarchyType:this.cfg.hierarchyType,linkFields:(n=(r=(t=this.cfg.spreadsheet.options)===null||t===void 0?void 0:t.interaction)===null||r===void 0?void 0:r.linkFields)!==null&&n!==void 0?n:[],seriesNumberWidth:u,spreadsheet:this.spreadsheet}},e.prototype.getRowHeader=function(){return this.rowHeader?this.rowHeader:new Qk(this.getRowHeaderCfg())},e.prototype.getColHeader=function(){if(!this.columnHeader){var t=this.panelBBox,r=t.x,n=t.width,i=t.viewportHeight,a=t.viewportWidth;return new Kk({width:n,cornerWidth:this.cornerBBox.width,height:this.cornerBBox.height,viewportWidth:a,viewportHeight:i,position:{x:r,y:0},data:this.layoutResult.colNodes,scrollContainsRowHeader:this.cfg.spreadsheet.isScrollContainsRowHeader(),sortParam:this.cfg.spreadsheet.store.get("sortParam"),spreadsheet:this.spreadsheet})}return this.columnHeader},e.prototype.getCornerHeader=function(){return this.cornerHeader?this.cornerHeader:Uve.getCornerHeader(this.panelBBox,this.cornerBBox,this.getSeriesNumberWidth(),this.cfg,this.layoutResult,this.spreadsheet)},e.prototype.getSeriesNumberHeader=function(){return Jot.getSeriesNumberHeader({viewportBBox:this.panelBBox,seriesNumberWidth:this.getSeriesNumberWidth(),leafNodes:this.layoutResult.rowsHierarchy.getNodes(0),spreadsheet:this.spreadsheet,cornerWidth:this.cornerBBox.width})},e.prototype.getCenterFrame=function(){var t;if(!this.centerFrame){var r=this.panelBBox,n=r.viewportWidth,i=r.viewportHeight,a=this.cornerBBox.width,o=this.cornerBBox.height,s=(t=this.cfg)===null||t===void 0?void 0:t.frame,l={position:{x:this.cornerBBox.x,y:this.cornerBBox.y},width:a,height:o,viewportWidth:n,viewportHeight:i,showViewportLeftShadow:!1,showViewportRightShadow:!1,scrollContainsRowHeader:this.cfg.spreadsheet.isScrollContainsRowHeader(),isPivotMode:this.cfg.spreadsheet.isPivotMode(),spreadsheet:this.cfg.spreadsheet};return s?s(l):new $ve(l)}return this.centerFrame},e.prototype.updatePanelScrollGroup=function(){this.gridInfo=this.getGridInfo(),this.spreadsheet.panelScrollGroup.update(this.gridInfo)},e.prototype.dynamicRenderCell=function(t){var r=this.getScrollOffset(),n=r.scrollX,i=r.scrollY,a=r.rowHeaderScrollX,o=i+this.getPaginationScrollY(),s=cP(o,this.viewCellHeights.getTotalHeight(),this.panelBBox.viewportHeight);this.spreadsheet.hideTooltip(),this.spreadsheet.interaction.clearHoverTimer(),this.realCellRender(n,s),this.updatePanelScrollGroup(),this.translateRelatedGroups(n,s,a),this.clip(n,s),t||this.emitScrollEvent({scrollX:n,scrollY:s,rowHeaderScrollX:a}),this.onAfterScroll()},e.prototype.emitScrollEvent=function(t){this.spreadsheet.emit(Me.LAYOUT_CELL_SCROLL,t),this.spreadsheet.emit(Me.GLOBAL_SCROLL,t)},e.prototype.saveInitColumnLeafNodes=function(t){t===void 0&&(t=[]);var r=this.spreadsheet,n=r.store,i=r.options,a=i.interaction.hiddenColumnFields,o=t.length+a.length,s=n.get("initColumnLeafNodes",[]);o!==s.length&&n.set("initColumnLeafNodes",t)},e.prototype.getHiddenColumnsInfo=function(t){var r=this.spreadsheet.store.get("hiddenColumnsDetail",[]);return Or(r)?null:r.find(function(n){var i;return(i=n==null?void 0:n.hideColumnNodes)===null||i===void 0?void 0:i.some(function(a){return a.id===t.id})})},e.prototype.getCornerNodes=function(){var t;return((t=this.cornerHeader)===null||t===void 0?void 0:t.getNodes())||[]},e}(),tst=function(e){en(t,e);function t(r){var n,i=e.call(this,r)||this;return i.frozenGroupInfo=(n={},n[Af.FROZEN_COL]={width:0},n[Af.FROZEN_ROW]={height:0},n[Af.FROZEN_TRAILING_ROW]={height:0},n[Af.FROZEN_TRAILING_COL]={width:0},n),i.panelScrollGroupIndexes=[],i.initFrozenGroupPosition=function(){var a=i.getScrollOffset(),o=a.scrollY,s=a.scrollX,l=i.getPaginationScrollY();qv(i.spreadsheet.frozenRowGroup,i.cornerBBox.width-s,i.cornerBBox.height-l),qv(i.spreadsheet.frozenColGroup,i.cornerBBox.width,i.cornerBBox.height-o-l),qv(i.spreadsheet.frozenTrailingColGroup,i.cornerBBox.width,i.cornerBBox.height-o-l),qv(i.spreadsheet.frozenTopGroup,i.cornerBBox.width,i.cornerBBox.height-l)},i.addCell=function(a){var o=i.getBizRevisedFrozenOptions(),s=o.frozenRowCount,l=o.frozenColCount,u=o.frozenTrailingRowCount,c=o.frozenTrailingColCount,f=i.layoutResult.colsHierarchy.getLeaves().length,d=i.getCellRange(),v=i.getRealFrozenColumns(l,c),g=v.colCount,x=v.trailingColCount,w=Lhe(a.getMeta(),{frozenRowCount:s,frozenColCount:g,frozenTrailingRowCount:u,frozenTrailingColCount:x},f,d),S=tnt[w];S&&i.spreadsheet[S]&&i.spreadsheet[S].add(a)},i.renderFrozenGroupSplitLine=function(a,o){var s,l,u,c=i.panelBBox,f=c.width,d=c.height,v=c.viewportWidth,g=c.viewportHeight,x=i.cornerBBox.height,w=i.layoutResult.colNodes.filter(function(Ye){return Bp(Ye)}),S=i.getCellRange(),A=S.end-S.start,M=Nm(i.getBizRevisedFrozenOptions(),w.length,A),R=M.frozenRowCount,O=R===void 0?0:R,N=M.frozenColCount,k=N===void 0?0:N,V=M.frozenTrailingColCount,Q=V===void 0?0:V,Y=M.frozenTrailingRowCount,X=Y===void 0?0:Y,tt=Math.floor(o-i.getPaginationScrollY()),it=Math.max(0,((s=co(i.viewCellWidths))!==null&&s!==void 0?s:0)-v),Et=Math.max(0,i.viewCellHeights.getCellOffsetY(S.end+1)-i.viewCellHeights.getCellOffsetY(S.start)-g);(l=i.foregroundGroup.findById(oR))===null||l===void 0||l.remove();var Tt=ii(i.cfg,"spreadsheet.theme.splitLine"),pt=i.foregroundGroup.addGroup({id:oR,zIndex:LC}),kt={lineWidth:Tt==null?void 0:Tt.verticalBorderWidth,stroke:Tt==null?void 0:Tt.verticalBorderColor,opacity:Tt==null?void 0:Tt.verticalBorderColorOpacity,lineDash:Tt==null?void 0:Tt.borderDash},ae={lineWidth:Tt==null?void 0:Tt.horizontalBorderWidth,stroke:Tt==null?void 0:Tt.horizontalBorderColor,opacity:Tt==null?void 0:Tt.horizontalBorderColorOpacity,lineDash:Tt==null?void 0:Tt.borderDash};if(k>0){var Kt=w.reduce(function(Ye,Be,De){return De<k?Ye+Be.width:Ye},0),re=X>0?d:g;lu(pt,{x1:Kt,x2:Kt,y1:x,y2:x+re},Zt({},kt)),Tt.showShadow&&a>0&&pt.addShape("rect",{attrs:{x:Kt,y:x,width:Tt.shadowWidth,height:re,fill:i.getShadowFill(0)}})}if(O>0){var fe=x+i.getTotalHeightForRange(S.start,S.start+O-1),Oe=Q>0?f:v;lu(pt,{x1:0,x2:Oe,y1:fe,y2:fe},Zt({},ae)),Tt.showShadow&&tt>0&&pt.addShape("rect",{attrs:{x:0,y:fe,width:Oe,height:Tt.shadowWidth,fill:i.getShadowFill(90)}})}if(Q>0){var Kt=w[w.length-Q].x,re=X?d:g;lu(pt,{x1:Kt,x2:Kt,y1:x,y2:x+re},Zt({},kt)),Tt.showShadow&&Math.floor(a)<Math.floor(it)&&pt.addShape("rect",{attrs:{x:Kt-((u=Tt.shadowWidth)!==null&&u!==void 0?u:0),y:x,width:Tt.shadowWidth,height:re,fill:i.getShadowFill(180)}})}if(X>0){var fe=i.panelBBox.maxY-i.getTotalHeightForRange(S.end-X+1,S.end),Oe=Q>0?f:v;lu(pt,{x1:0,x2:Oe,y1:fe,y2:fe},Zt({},ae)),Tt.showShadow&&tt<Math.floor(Et)&&pt.addShape("rect",{attrs:{x:0,y:fe-Tt.shadowWidth,width:Oe,height:Tt.shadowWidth,fill:i.getShadowFill(270)}})}i.foregroundGroup.sort()},i.getRealFrozenColumns=function(a,o){var s,l=a,u=o;if(a||o){var c=i.layoutResult.colsHierarchy.getNodes();c=c.filter(function(f){return Bp(f)}),s=_R(c,a,o),l=s.colCount,u=s.trailingColCount}return{colCount:l,trailingColCount:u}},i.getTotalHeightForRange=function(a,o){if(a<0||o<0)return 0;if(i.rowOffsets)return i.rowOffsets[o+1]-i.rowOffsets[a];for(var s=0,l=a;l<o+1;l++){var u=i.getDefaultCellHeight();s+=u}return s},i.getShadowFill=function(a){var o,s,l=ii(i.cfg,"spreadsheet.theme.splitLine");return"l (".concat(a,") 0:").concat((o=l.shadowColors)===null||o===void 0?void 0:o.left," 1:").concat((s=l.shadowColors)===null||s===void 0?void 0:s.right)},i}return t.prototype.calculateFrozenGroupInfo=function(){var r=this.getFrozenOptionsDirectly(),n=r.frozenColCount,i=r.frozenRowCount,a=r.frozenTrailingColCount,o=r.frozenTrailingRowCount,s=this.layoutResult.colNodes.filter(function(x){return Bp(x)}),l=this.viewCellHeights,u=this.getCellRange(),c=this.frozenGroupInfo,f=c.frozenCol,d=c.frozenTrailingCol,v=c.frozenRow,g=c.frozenTrailingRow;n>0&&(f.width=s[n-1].x+s[n-1].width-0,f.range=[0,n-1]),i>0&&(v.height=l.getCellOffsetY(u.start+i)-l.getCellOffsetY(u.start),v.range=[u.start,u.start+i-1]),a>0&&(d.width=s[s.length-1].x-s[s.length-a].x+s[s.length-1].width,d.range=[s.length-a,s.length-1]),o>0&&(g.height=l.getCellOffsetY(u.end+1)-l.getCellOffsetY(u.end+1-o),g.range=[u.end-o+1,u.end])},t.prototype.calculateXYIndexes=function(r,n){var i,a,o,s=this.layoutResult.colLeafNodes.length,l=this.getCellRange(),u=this.panelBBox,c=u.viewportHeight,f=u.viewportWidth,d=this.getFrozenOptionsDirectly(),v=d.frozenColCount,g=v===void 0?0:v,x=d.frozenRowCount,w=x===void 0?0:x,S=d.frozenTrailingColCount,A=S===void 0?0:S,M=d.frozenTrailingRowCount,R=M===void 0?0:M,O={width:f,height:c,x:0,y:0};if(A>0||g>0){var N=this.frozenGroupInfo,k=N.frozenTrailingCol,V=N.frozenCol;O.width-=k.width+V.width,O.x+=(i=V.width)!==null&&i!==void 0?i:0}if(R>0||w>0){var Q=this.frozenGroupInfo,Y=Q.frozenRow,X=Q.frozenTrailingRow;O.height<Y.height+X.height?(O.height=0,O.y=0):(O.height-=Y.height+X.height,O.y+=Y.height)}var tt=this.spreadsheet.isTableMode()&&(!((o=(a=this.spreadsheet.dataSet)===null||a===void 0?void 0:a.isEmpty)===null||o===void 0)&&o.call(a))?this.spreadsheet.dataSet.getEmptyViewIndexes():Lk(r,n,this.viewCellWidths,this.viewCellHeights,O,this.getRealScrollX(this.cornerBBox.width));this.panelScrollGroupIndexes=tt;var it=this.getRealFrozenColumns(g,A),Et=it.colCount,Tt=it.trailingColCount;return Phe(tt,{frozenColCount:Et,frozenRowCount:w,frozenTrailingColCount:Tt,frozenTrailingRowCount:R},s,l)},t.prototype.updateFrozenGroupGrid=function(){var r=this;[Af.FROZEN_COL,Af.FROZEN_ROW,Af.FROZEN_TRAILING_COL,Af.FROZEN_TRAILING_ROW].forEach(function(n){if(r.frozenGroupInfo[n].range){var i=[],a=[];if(n.toLowerCase().includes("row")){var o=lr(r.frozenGroupInfo[n].range,2),s=o[0],l=o[1];if(i=r.gridInfo.cols,a=S3(s,l,r.viewCellHeights),n===Af.FROZEN_TRAILING_ROW){var u=r.spreadsheet.frozenTrailingRowGroup.getBBox().minY;a=Bve(s,l,Math.ceil(u),r.viewCellHeights)}}else{var c=lr(r.frozenGroupInfo[n].range,2),f=c[0],d=c[1],v=r.layoutResult.colNodes.filter(function(g){return Bp(g)});i=Zot(f,d,v),a=r.gridInfo.rows}r.spreadsheet["".concat(n,"Group")].updateGrid({cols:i,rows:a},"".concat(n,"Group"))}})},t.prototype.updatePanelScrollGroup=function(){e.prototype.updatePanelScrollGroup.call(this),this.updateFrozenGroupGrid()},t.prototype.translateRelatedGroups=function(r,n,i){var a=this,o=this.spreadsheet,s=o.frozenColGroup,l=o.frozenTrailingColGroup,u=o.frozenRowGroup,c=o.frozenTrailingRowGroup;[u,c].forEach(function(f){m3(f,a.cornerBBox.width-r)}),[s,l].forEach(function(f){Ihe(f,a.cornerBBox.height-n)}),e.prototype.translateRelatedGroups.call(this,r,n,i),this.updateRowResizeArea(),this.renderFrozenGroupSplitLine(r,n)},t.prototype.updateRowResizeArea=function(){},t.prototype.clip=function(r,n){var i,a,o,s=this.getPaginationScrollY(),l=this.spreadsheet,u=l.frozenRowGroup,c=l.frozenColGroup,f=l.frozenTrailingColGroup,d=l.frozenTrailingRowGroup,v=l.panelScrollGroup,g=0,x=0,w=0;c&&(g=c.getBBox().width),u&&(x=u.getBBox().height);var S;f&&(S=f.getBBox()),d&&(w=d.getBBox().height);var A=this.panelBBox.width-g-((i=S==null?void 0:S.width)!==null&&i!==void 0?i:0),M=this.panelBBox.height-x-w;v.setClip({type:"rect",attrs:{x:r+g,y:n+x,width:A,height:M}}),u.setClip({type:"rect",attrs:{x:r+g,y:s,width:A,height:x}}),d==null||d.setClip({type:"rect",attrs:{x:r+g,y:d.getBBox().minY,width:A,height:w}});var R={y:n+x,height:M};c==null||c.setClip({type:"rect",attrs:Zt(Zt({},R),{x:0,width:g})}),f==null||f.setClip({type:"rect",attrs:Zt(Zt({},R),{x:(a=S==null?void 0:S.minX)!==null&&a!==void 0?a:0,width:(o=S==null?void 0:S.width)!==null&&o!==void 0?o:0})})},t.prototype.init=function(){e.prototype.init.call(this)},t.prototype.render=function(){this.calculateFrozenGroupInfo(),e.prototype.render.call(this),this.initFrozenGroupPosition()},t.prototype.getFrozenOptionsDirectly=function(){var r=this.layoutResult.colLeafNodes.length,n=this.getCellRange();return Nm(this.getBizRevisedFrozenOptions(),r,n.end-n.start+1)},t.prototype.getBizRevisedFrozenOptions=function(){var r=this.cfg,n=r.frozenColCount,i=r.frozenRowCount,a=r.frozenTrailingColCount,o=r.frozenTrailingRowCount;return{frozenColCount:n,frozenRowCount:i,frozenTrailingColCount:a,frozenTrailingRowCount:o}},t.prototype.getDefaultCellHeight=function(){var r,n=this.cfg.cellCfg;return(r=n==null?void 0:n.height)!==null&&r!==void 0?r:0},t}(Vve),est=function(e){var t,r,n,i=e.facetCfg,a=e.customTreeItems,o=a===void 0?[]:a,s=e.level,l=e.parentNode,u=e.hierarchy,c=i.spreadsheet,f=i.collapsedRows,d=i.hierarchyCollapse;try{for(var v=Gf(o),g=v.next();!g.done;g=v.next()){var x=g.value,w=x.key,S=x.title,A=x.collapsed,M=x.children,R=NI(x,["key","title","collapsed","children"]),O=(n={},n[Pi]=w,n),N=$C(l.id,S),k=A??!1,V=ii(f,N),Q=V??(d||k),Y=new su({id:N,key:w,label:S,value:S,level:s,parent:l,field:w,isTotals:!1,isCollapsed:Q,hierarchy:u,query:O,spreadsheet:c,extra:R});s>u.maxLevel&&(u.maxLevel=s),Or(M)&&(Y.isLeaf=!0);var X=Rk(i,l,Y,u);!Or(M)&&!Q&&X&&est({facetCfg:i,parentNode:Y,level:s+1,hierarchy:u,customTreeItems:M})}}catch(tt){t={error:tt}}finally{try{g&&!g.done&&(r=v.return)&&r.call(v)}finally{if(t)throw t.error}}},Gve=function(e,t,r){var n=e.getTotalsConfig(t);if(n.showGrandTotals){var i=n.reverseLayout?"unshift":"push";r[i](new eb({label:n.label,isSubTotals:!1,isGrandTotals:!0}))}},rst=function(e){var t,r,n,i,a,o,s=e.parentNode,l=e.currentField,u=e.level,c=e.facetCfg,f=e.hierarchy,d=e.pivotMeta,v=c.spreadsheet,g=c.collapsedRows,x=c.hierarchyCollapse,w=c.rowExpandDepth,S=s.query,A=s.id,M=((i=v.dataCfg.fields.rows)===null||i===void 0?void 0:i.length)<=u,R=cfe(Array.from(d.keys())),O=Vat(R,c,s,l),N=v.store.get("drillItemsNum");M&&N>0&&(O=O.slice(0,N)),u===0&&Gve(v,l,O);try{for(var k=Gf(O),V=k.next();!V.done;V=k.next()){var Q=V.value,Y=Q instanceof eb,X=Y?null:d.get(Q),tt=void 0,it=S,Et=!1,Tt=!1;if(Y){var pt=Q;Et=pt.isGrandTotals,Tt=pt.isSubTotals,tt=El(Q.label),it=S}else tt=Q,it=Zt(Zt({},S),(n={},n[l]=tt,n));var kt=$C(A,tt),ae=g==null?void 0:g[kt],Kt=nc(w)?u>w:null,re=(a=ae??Kt)!==null&&a!==void 0?a:x,fe=new su({id:kt,key:l,label:tt,value:tt,level:u,parent:s,field:l,isTotals:Y,isGrandTotals:Et,isSubTotals:Tt,isCollapsed:re,hierarchy:f,query:it,spreadsheet:v});u>f.maxLevel&&(f.maxLevel=u);var Oe=Vr([],lr(((o=X==null?void 0:X.children)===null||o===void 0?void 0:o.keys())||[]),!1).filter(function(De){return De!==jp}),Ye=Or(Oe);(Ye||Y)&&(fe.isLeaf=!0),Ye||(fe.isTotals=!0);var Be=Rk(c,s,fe,f);!Ye&&!re&&!Y&&Be&&rst({level:u+1,currentField:X.childField,pivotMeta:X.children,facetCfg:c,parentNode:fe,hierarchy:f})}}catch(De){t={error:De}}finally{try{V&&!V.done&&(r=k.return)&&r.call(k)}finally{if(t)throw t.error}}},nst=function(e){var t=e.isValueInCols,r=e.moreThanOneValue,n=e.rootNode,i=e.facetCfg,a=e.hierarchy,o=e.fields,s=e.isRowHeader,l,u;s?(l=!t&&r,u=!t&&!r):(l=t&&r,u=t&&!r),Xat({addTotalMeasureInTotal:l,addMeasureInTotalQuery:u,parentNode:n,currentField:o[0],fields:o,facetCfg:i,hierarchy:a})},Wve=function(e){var t=e.facetCfg,r=e.rootNode,n=e.hierarchy,i=t.dataSet.fields.customTreeItems;est({customTreeItems:i,facetCfg:t,level:0,parentNode:r,hierarchy:n})},Xve=function(e){var t=e.facetCfg,r=e.rootNode,n=e.hierarchy,i=t.hierarchyType,a=t.rows,o=t.dataSet;i==="tree"?rst({level:0,currentField:a[0],pivotMeta:o.rowPivotMeta,facetCfg:t,parentNode:r,hierarchy:n}):Wve(e)},jve=function(e){var t=e.spreadsheet;t.isHierarchyTreeType()?Xve(e):nst(e)},Yve=function(e){var t=e.isPivotMode,r=e.hierarchy,n=e.rootNode,i=e.facetCfg;t?nst(e):zhe({parentNode:n,hierarchy:r,facetCfg:i})},NB=function(e){var t=e.isRowHeader,r=e.facetCfg,n=r.spreadsheet,i=r.rows,a=i===void 0?[]:i,o=r.columns,s=o===void 0?[]:o,l=n.dataCfg.fields.valueInCols,u=n.isPivotMode(),c=r.dataSet.moreThanOneValue(),f=su.rootNode(),d=new Uat,v={isValueInCols:l,isPivotMode:u,moreThanOneValue:c,rootNode:f,hierarchy:d,spreadsheet:n,facetCfg:r,fields:t?a:s,isRowHeader:t};t?jve(v):Yve(v);var g=function(){return t&&n.isHierarchyTreeType()?d.getNodes():d.getLeaves()};return{hierarchy:d,leafNodes:g()}},Zve=function(e){en(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.renderFrozenGroupSplitLine=function(n,i){var a;if((a=r.foregroundGroup.findById(oR))===null||a===void 0||a.remove(),r.enableFrozenFirstRow()){var o=Math.floor(i-r.getPaginationScrollY()),s=r.foregroundGroup.addGroup({id:oR,zIndex:LC}),l=ii(r.cfg,"spreadsheet.theme.splitLine"),u={lineWidth:l==null?void 0:l.horizontalBorderWidth,stroke:l==null?void 0:l.horizontalBorderColor,opacity:l==null?void 0:l.horizontalBorderColorOpacity},c=r.cornerBBox.height,f=r.getCellRange(),d=c+r.getTotalHeightForRange(f.start,f.start),v=r.panelBBox.viewportWidth+r.layoutResult.rowsHierarchy.width+r.getSeriesNumberWidth();lu(s,{x1:0,x2:v,y1:d,y2:d},Zt({},u)),l.showShadow&&o>0&&s.addShape("rect",{attrs:{x:0,y:d,width:v,height:l.shadowWidth,fill:r.getShadowFill(90)}})}},r}return t.prototype.updateFrozenGroupGrid=function(){var r=this;[Af.FROZEN_ROW].forEach(function(n){if(r.frozenGroupInfo[n].range){var i=[],a=[];if(n.toLowerCase().includes("row")){var o=lr(r.frozenGroupInfo[n].range,2),s=o[0],l=o[1];i=r.gridInfo.cols,a=S3(s,l,r.viewCellHeights)}r.spreadsheet["".concat(n,"Group")].updateGrid({cols:i,rows:a},"".concat(n,"Group"))}})},t.prototype.getBizRevisedFrozenOptions=function(){return rb(this.cfg,this.layoutResult.rowNodes)},t.prototype.clip=function(r,n){var i=this.spreadsheet,a=i.isFrozenRowHeader,o=i.frozenRowGroup;if(!a.call(this.spreadsheet)){if(this.panelScrollGroupClip(r,n),this.enableFrozenFirstRow()){var s=this.getPaginationScrollY();o.setClip({type:"rect",attrs:{x:0,y:s,width:this.panelBBox.width+r,height:o.getBBox().height}})}return}e.prototype.clip.call(this,r,n)},Object.defineProperty(t.prototype,"rowCellTheme",{get:function(){return this.spreadsheet.theme.rowCell.cell},enumerable:!1,configurable:!0}),t.prototype.getContentHeight=function(){var r=this.layoutResult,n=r.rowsHierarchy,i=r.colsHierarchy;return n.height+i.height},t.prototype.doLayout=function(){var r=this,n=NB({isRowHeader:!0,facetCfg:this.cfg}),i=n.leafNodes,a=n.hierarchy,o=NB({isRowHeader:!1,facetCfg:this.cfg}),s=o.leafNodes,l=o.hierarchy;this.calculateNodesCoordinate(i,a,s,l);var u=this.cfg,c=u.dataSet,f=u.spreadsheet,d=function(g,x){var w=g||0,S=x||0,A=i[w],M=s[S];if(!A||!M)return null;var R=A.query,O=M.query,N=A.isTotals||A.isTotalMeasure||M.isTotals||M.isTotalMeasure,k=r.getMeasureInfo(),V=gR({},R,O,k),Q=Ww(A,M),Y=c.getCellData({query:V,rowNode:A,isTotals:N,totalStatus:Q}),X=V[Pi],tt=ii(Y,jc,null);return{spreadsheet:f,x:M.x,y:A.y,width:M.width,height:A.height,data:Y,rowIndex:w,colIndex:S,isTotals:N,valueField:X,fieldValue:tt,rowQuery:R,colQuery:O,rowId:A.id,colId:M.id,id:WS(A.id,M.id)}},v={colNodes:l.getNodes(),colsHierarchy:l,rowNodes:a.getNodes(),rowsHierarchy:a,rowLeafNodes:i,colLeafNodes:s,getCellMeta:d,spreadsheet:f};return Ahe(this.cfg,v)},t.prototype.getMeasureInfo=function(){var r,n,i,a=this.cfg,o=a.dataSet,s=a.spreadsheet,l=s.options.hierarchyType,u=(n=ii(s,"facet.cfg.colCfg.hideMeasureColumn"))!==null&&n!==void 0?n:!1;return u&&l!=="customTree"?(r={},r[Pi]=(i=o.fields.values)===null||i===void 0?void 0:i[0],r):{}},t.prototype.calculateNodesCoordinate=function(r,n,i,a){this.calculateRowNodesCoordinate(r,n,i),this.calculateColNodesCoordinate(i,a,r,n.width)},t.prototype.calculateColNodesCoordinate=function(r,n,i,a){for(var o,s,l,u=su.blankNode(),c=n.getNodes(),f=n.sampleNodesForAllLevels,d=0;d<f.length;d++){var v=f[d];if(v.height=this.getColNodeHeight(v),n.height+=v.height,v.level===0)v.y=0;else{var g=f[d-1];v.y=(o=(g==null?void 0:g.y)+(g==null?void 0:g.height))!==null&&o!==void 0?o:0}}for(var x=0,w=function(M){var R=c[M];if(R.isLeaf&&(R.colIndex=x,x+=1,R.x=u.x+u.width,R.width=S.calculateColLeafNodesWidth(R,r,i,a),n.width+=R.width,u=R),R.level===0)R.y=0;else{var O=n.sampleNodesForAllLevels.find(function(N){return N.level===R.level-1});R.y=(s=(O==null?void 0:O.y)+(O==null?void 0:O.height))!==null&&s!==void 0?s:0}R.height=S.getColNodeHeight(R),_B(S.cfg,null,R)},S=this,A=0;A<c.length;A++)w(A);this.autoCalculateColNodeWidthAndX(r),Or((l=this.spreadsheet.options.totals)===null||l===void 0?void 0:l.col)||(this.adjustTotalNodesCoordinate({hierarchy:n,isRowHeader:!1,isSubTotal:!0}),this.adjustTotalNodesCoordinate({hierarchy:n,isRowHeader:!1,isSubTotal:!1}))},t.prototype.autoCalculateColNodeWidthAndX=function(r){for(var n,i=null,a=0,o=r.slice(0);a<o.length;){var s=o[a++],l=s.parent;if(i!==l&&l){o.push(l);var u=(n=l.children)===null||n===void 0?void 0:n.find(function(d){return d.width}),c=u==null?void 0:u.x,f=Cat(l.children,"width");l.x=c,l.width=f,i=l}}},t.prototype.calculateColLeafNodesWidth=function(r,n,i,a){var o,s,l,u,c,f=this.cfg,d=f.colCfg,v=f.dataSet,g=f.filterDisplayDataItem,x=this.getCellDraggedWidth(r);if(nc(x))return x;var w=this.getCellCustomWidth(r,d==null?void 0:d.width);if(nc(w))return w;if(this.spreadsheet.getLayoutWidthType()===i_.Compact){for(var S=this.spreadsheet.theme.colCell,A=S.bolderText,M=S.cell,R=S.icon,O=this.spreadsheet.theme.dataCell.text,N=this.spreadsheet.dataSet.getFieldFormatter(r.field),k=(o=N==null?void 0:N(r.value))!==null&&o!==void 0?o:r.label,V=this.getExpectedCellIconWidth(Br.COL_CELL,this.spreadsheet.isValueInCols()&&this.spreadsheet.options.showDefaultHeaderActionIcon,R),Q=this.spreadsheet.measureTextWidth(k,A)+V,Y=this.getMeasureInfo(),X=void 0,tt=0,it=0,Et=0;Et<YO;Et++){var Tt=i[Et];if(Tt){var pt=v.getCellData({query:Zt(Zt({},r.query),Tt.query),rowNode:Tt,isTotals:r.isTotals||r.isTotalMeasure||Tt.isTotals||Tt.isTotalMeasure,totalStatus:Ww(Tt,r)});if(pt){var kt=cot(pt,g),ae=(l=(s=this.spreadsheet.dataSet.getFieldFormatter(pt[Pi]))===null||s===void 0?void 0:s(kt))!==null&&l!==void 0?l:kt,Kt="".concat(ae),re=gR({},Tt.query,r.query,Y),fe=re[Pi],Oe=qat(this.spreadsheet.options.conditions,this.spreadsheet.theme.dataCell.icon,fe),Ye=Oe.size,Be=Oe.margin,De=Be.left,Yr=Be.right,Gr=Ye+De+Yr,Mn=this.spreadsheet.measureTextWidth(Kt,O)+Gr;Mn>tt&&(X=Kt,tt=Mn,it=Gr)}}}var ee=Q>tt,rr=ee?k:X,Nr=ee?V:it;Fp.getInstance().logger("Max Label In Col:",r.field,rr,tt);var Fe=this.spreadsheet.measureTextWidth(rr,Zt(Zt({},A),{fontSize:Math.max(O.fontSize,A.fontSize)}));return Fe+((u=M.padding)===null||u===void 0?void 0:u.left)+((c=M.padding)===null||c===void 0?void 0:c.right)+Nr}return this.spreadsheet.isHierarchyTreeType()?this.getAdaptTreeColWidth(r,n,i):this.getAdaptGridColWidth(n,a)},t.prototype.getColNodeHeight=function(r){var n=this.cfg.colCfg,i=ii(n,["heightByField",r.key]);return i??(n==null?void 0:n.height)},t.prototype.getExpectedCellIconWidth=function(r,n,i){var a,o=0;if(n)o=1;else{var s=zk(ia(this.spreadsheet.options.headerActionIcons,function(l){return Zt(Zt({},l),{displayCondition:function(){return!0}})}),null,r);o=(a=s==null?void 0:s.iconNames.length)!==null&&a!==void 0?a:0}return o?o*(i.size+i.margin.left)+i.margin.right:0},t.prototype.calculateRowNodesCoordinate=function(r,n,i){var a,o,s,l,u,c,f,d,v,g,x=this.cfg,w=x.cellCfg,S=x.spreadsheet,A=S.isHierarchyTreeType(),M=ii(S,"options.style.rowCfg.heightByField",{}),R=(s=n.sampleNodesForAllLevels)!==null&&s!==void 0?s:[];if(A)n.width=this.getTreeRowHeaderWidth();else try{for(var O=Gf(n.sampleNodesForAllLevels),N=O.next();!N.done;N=O.next()){var k=N.value;k.width=this.calculateGridRowNodesWidth(k,i),n.width+=k.width;var V=(l=R[k.level-1])!==null&&l!==void 0?l:{x:0,width:0};k.x=(V==null?void 0:V.x)+(V==null?void 0:V.width)}}catch(Tt){a={error:Tt}}finally{try{N&&!N.done&&(o=O.return)&&o.call(O)}finally{if(a)throw a.error}}for(var Q=su.blankNode(),Y=n.getNodes(),X=0;X<Y.length;X++){var tt=Y[X],it=A||!A&&tt.isLeaf;if(it&&((u=tt.rowIndex)!==null&&u!==void 0||(tt.rowIndex=X),(c=tt.colIndex)!==null&&c!==void 0||(tt.colIndex=X),tt.y=Q.y+Q.height,tt.height=((f=M==null?void 0:M[tt.id])!==null&&f!==void 0?f:w==null?void 0:w.height)+((d=this.rowCellTheme.padding)===null||d===void 0?void 0:d.top)+((v=this.rowCellTheme.padding)===null||v===void 0?void 0:v.bottom),Q=tt,n.height+=tt.height),A||tt.level===0)tt.x=0;else{var V=R[tt.level-1];tt.x=(V==null?void 0:V.x)+(V==null?void 0:V.width)}if(A)tt.width=this.getTreeRowHeaderWidth();else{var Et=R[tt.level];tt.width=Et==null?void 0:Et.width}_B(this.cfg,tt,null)}A||(this.autoCalculateRowNodeHeightAndY(r),Or((g=S.options.totals)===null||g===void 0?void 0:g.row)||(this.adjustTotalNodesCoordinate({hierarchy:n,isRowHeader:!0,isSubTotal:!1}),this.adjustTotalNodesCoordinate({hierarchy:n,isRowHeader:!0,isSubTotal:!0})))},t.prototype.autoCalculateRowNodeHeightAndY=function(r){for(var n=null,i=0,a=r.slice(0);i<a.length;){var o=a[i++],s=o.parent;n!==s&&s&&(a.push(s),s.y=s.children[0].y,s.height=s.children.reduce(function(l,u){return l+u.height},0),n=s)}},t.prototype.getMultipleMap=function(r,n,i){for(var a=r.maxLevel,o=this.cfg,s=o.totals,l=o.dataSet,u=l.moreThanOneValue(),c=l.fields,f=c.rows,d=c.columns,v=n?f:d,g=n?s.row:s.col,x=i?g.subTotalsGroupDimensions||[]:g.totalsGroupDimensions||[],w=l.isEmpty()?[]:x,S=Array.from({length:a+1},function(){return 1}),A=a;A>0;A--){var M=v[A],R=M===Pi&&u;w.includes(M)||R||(S[A-1]+=S[A],S[A]=0)}return S},t.prototype.adjustTotalNodesCoordinate=function(r){var n=r.hierarchy,i=r.isRowHeader,a=r.isSubTotal,o=this.getMultipleMap(n,i,a),s=Eg(n.getNodes(),function(u){return a?u.isSubTotals:u.isGrandTotals}),l=i?"width":"height";xi(s,function(u){var c,f=o[u.level];if(!f&&a)for(var d=1;f<1;)f=o[u.level-d]-d,d++;for(var v=0,g=function(w){v+=((c=n.sampleNodesForAllLevels.find(function(S){return S.level===u.level+w}))===null||c===void 0?void 0:c[l])||0},x=0;x<f;x++)g(x);u[l]=v})},t.prototype.calculateGridRowNodesWidth=function(r,n){var i=this.cfg,a=i.rowCfg,o=i.spreadsheet,s=ii(a,["widthByField",r.key]);if(nc(s))return s;var l=this.getCellCustomWidth(r,a==null?void 0:a.width);return nc(l)?l:o.getLayoutWidthType()!==i_.Adaptive?this.getCompactGridRowWidth(r):this.getAdaptGridColWidth(n)},t.prototype.getAdaptTreeColWidth=function(r,n,i){var a=this.getCanvasHW().width,o=a-this.getSeriesNumberWidth(),s=Math.min(o/2,this.getTreeRowHeaderWidth()),l=Math.max(1,n.length),u=this.cfg.cellCfg;return Math.max(iP(u,this.getColLabelLength(r,i)),(o-s)/l)},t.prototype.getColLabelLength=function(r,n){var i,a=lfe(r==null?void 0:r.value);if(Wn(a))return a.length;for(var o=1,s=0;s<YO;s++){var l=n[s];if(!l)return o;for(var u=this.cfg.dataSet.getCellData({query:Zt(Zt({},r.query),l.query),rowNode:l,isTotals:r.isTotals||r.isTotalMeasure||l.isTotals||l.isTotalMeasure,totalStatus:Ww(l,r)}),c=xs(u==null?void 0:u[wN]),f=0;f<c.length;f++){var d=u[c[f]],v=tx((i=d==null?void 0:d.values)===null||i===void 0?void 0:i[0]);v>o&&(o=v)}}return o},t.prototype.getAdaptGridColWidth=function(r,n){var i=this.cfg,a=i.rows,o=i.cellCfg,s=a.length,l=r.length,u=this.getCanvasHW().width,c=u-this.getSeriesNumberWidth(),f=Math.max(1,s+l);return n?Math.max(iP(o),(c-n)/l):Math.max(iP(o),c/f)},t.prototype.getTreeRowHeaderWidth=function(){var r,n,i,a,o=this.cfg,s=o.rows,l=o.dataSet,u=o.rowCfg,c=o.treeRowsWidth,f=c??(u==null?void 0:u.treeRowsWidth);if(nc(f))return f;var d=this.getCellCustomWidth(null,u==null?void 0:u.width);if(nc(d))return d;var v=s.map(function(M){return l.getFieldName(M)}).join("/"),g=this.spreadsheet.theme.cornerCell,x=g.bolderText,w=g.icon,S=1+this.spreadsheet.measureTextWidth(v,x)+w.size*2+((r=w.margin)===null||r===void 0?void 0:r.left)+((n=w.margin)===null||n===void 0?void 0:n.right)+((i=this.rowCellTheme.padding)===null||i===void 0?void 0:i.left)+((a=this.rowCellTheme.padding)===null||a===void 0?void 0:a.right),A=Math.max(f??YG,S);return Number.isNaN(A)?YG:A},t.prototype.getCompactGridRowWidth=function(r){var n=this,i,a=this.cfg,o=a.dataSet,s=a.spreadsheet,l=s.theme.rowCell,u=l.bolderText,c=l.icon,f=l.cell,d=s.theme.cornerCell,v=d.bolderText,g=d.icon,x=d.cell,w=r.field,S=r.isLeaf,A=this.getExpectedCellIconWidth(Br.ROW_CELL,!s.isValueInCols()&&S&&s.options.showDefaultHeaderActionIcon,c),M=(i=o.getDimensionValues(w))===null||i===void 0?void 0:i.slice(0,YO).map(function(Q){var Y,X;return(X=(Y=n.spreadsheet.dataSet.getFieldFormatter(w))===null||Y===void 0?void 0:Y(Q))!==null&&X!==void 0?X:Q}),R=uk(M,function(Q){return"".concat(Q).length}),O=s.measureTextWidth(R,u)+A+f.padding.left+f.padding.right,N=o.getFieldName(w),k=this.getExpectedCellIconWidth(Br.CORNER_CELL,!1,g),V=s.measureTextWidth(N,v)+k+x.padding.left+x.padding.right;return Fp.getInstance().logger("Max Label In Row:",w,O>V?R:N),Math.max(O,V)},t.prototype.getViewCellHeights=function(r){var n=r.rowLeafNodes,i=h3(n,function(a,o){return a.push(co(a)+o.height),a},[0]);return{getTotalHeight:function(){return co(i)||0},getCellOffsetY:function(a){return i[a]||0},getTotalLength:function(){return i.length-1},getIndexRange:function(a,o){return Yot(i,a,o)}}},t.prototype.getRowHeader=function(){if(!this.rowHeader){var r=this.getRowHeaderCfg(),n=r.viewportHeight,i=NI(r,["viewportHeight"]),a=rb(this.cfg,this.layoutResult.rowNodes).frozenRowHeight;return new Hve(Zt(Zt({},i),{viewportHeight:n-a}))}},t.prototype.enableFrozenFirstRow=function(){return!!this.getBizRevisedFrozenOptions().frozenRowCount},t}(tst),qve=function(e){en(t,e);function t(r){var n=this,i,a,o;n=e.call(this,r)||this,n.getScrollGroupClipBBox=function(){var g,x=n.headerConfig,w=x.width,S=x.height,A=x.scrollX,M=x.spreadsheet,R=M.options;if(!R.frozenColCount&&!R.frozenTrailingColCount)return{x:A,y:0,width:w,height:S};for(var O=(g=M.facet)===null||g===void 0?void 0:g.layoutResult.colLeafNodes,N=Nm(M.options,O.length),k=N.frozenColCount,V=N.frozenTrailingColCount,Q=0,Y=0,X=0;X<k;X++)Q+=O[X].width;for(var X=0;X<V;X++)Y+=O[O.length-1-X].width;var tt=w-Q-Y;return{x:A+Q,y:0,width:tt,height:S}};var s=(i=n.headerConfig.spreadsheet)===null||i===void 0?void 0:i.options,l=s.frozenColCount,u=s.frozenTrailingColCount,c=(o=(a=n.headerConfig.spreadsheet)===null||a===void 0?void 0:a.facet)===null||o===void 0?void 0:o.layoutResult.colNodes.filter(function(g){return Bp(g)}),f=_R(c,l,u),d=f.colCount,v=f.trailingColCount;return n.finalColCount=d,n.finalTrailingColCount=v,d&&(n.frozenColGroup=n.addGroup({name:Xjt,zIndex:LC})),v&&(n.frozenTrailingColGroup=n.addGroup({name:jjt,zIndex:LC})),n}return t.prototype.isFrozenCell=function(r){var n=this.headerConfig.spreadsheet,i=n==null?void 0:n.options,a=i.frozenColCount,o=i.frozenTrailingColCount,s=r.colIndex,l=n==null?void 0:n.facet.layoutResult.colLeafNodes;return Ny(s,a)||ky(s,o,l.length)},t.prototype.clear=function(){var r,n,i=this.headerConfig.spreadsheet;e.prototype.clear.call(this),(r=this.frozenTrailingColGroup)===null||r===void 0||r.clear(),(n=this.frozenColGroup)===null||n===void 0||n.clear();var a=i==null?void 0:i.foregroundGroup.findById(Zrt);a==null||a.clear()},t.prototype.getCellInstance=function(r,n,i){return r.field===n_?new Pde(r,n,i):new _ot(r,n,i)},t.prototype.getCellGroup=function(r){var n,i=this.headerConfig.spreadsheet,a=xB(r).colIndex;return Ny(a,this.finalColCount)?this.frozenColGroup:ky(a,this.finalTrailingColCount,(n=i==null?void 0:i.facet)===null||n===void 0?void 0:n.layoutResult.colLeafNodes.length)?this.frozenTrailingColGroup:this.scrollGroup},t.prototype.isColCellInRect=function(r){var n,i=this.headerConfig.spreadsheet,a=(n=i==null?void 0:i.facet)===null||n===void 0?void 0:n.layoutResult.colLeafNodes.length,o=xB(r).colIndex;return Ny(o,this.finalColCount)||ky(o,this.finalTrailingColCount,a)?!0:e.prototype.isColCellInRect.call(this,r)},t.prototype.clip=function(){this.scrollGroup.setClip({type:"rect",attrs:this.getScrollGroupClipBBox()})},t}(Kk),Kve=function(e){en(t,e);function t(r){var n=e.call(this,r)||this;n.onSortHandler=function(a){var o=n.spreadsheet,s=a;Array.isArray(a)||(s=[a]);var l=o.dataCfg.sortParams||[];s=s.map(function(c){var f,d,v=Zt(Zt({},c),{sortFieldId:(f=c.sortKey)!==null&&f!==void 0?f:c.sortFieldId}),g=(d=l.find(function(x){return x.sortFieldId===v.sortFieldId}))!==null&&d!==void 0?d:{};return Zt(Zt({},g),v)});var u=l.filter(function(c){var f=s.find(function(d){return d.sortFieldId===c.sortFieldId});return!f});kC(o.dataCfg,"sortParams",Vr(Vr([],lr(u),!1),lr(s),!1)),o.setDataCfg(o.dataCfg),o.render(!0),o.emit(Me.RANGE_SORTED,o.dataSet.getDisplayDataSet())},n.onFilterHandler=function(a){var o=n.spreadsheet,s=!a.filteredValues||a.filteredValues.length===0,l=o.dataCfg.filterParams||[],u=l.findIndex(function(c){return c.filterKey===a.filterKey});u!==-1?s?l.splice(u,1):l[u]=a:l.push(a),kC(o.dataCfg,"filterParams",l),o.render(!0),o.emit(Me.RANGE_FILTERED,o.dataSet.getDisplayDataSet())},n.renderFrozenPanelCornerGroup=function(){var a=n.layoutResult.colNodes.filter(function(w){return Bp(w)}),o=n.getCellRange(),s=Nm(n.spreadsheet.options,a.length,o.end-o.start+1),l=s.frozenRowCount,u=s.frozenColCount,c=s.frozenTrailingRowCount,f=s.frozenTrailingColCount,d=_R(a,u,f),v=d.colCount,g=d.trailingColCount,x=Ohe({frozenRowCount:l,frozenColCount:v,frozenTrailingRowCount:c,frozenTrailingColCount:g},n.layoutResult.colLeafNodes.length,o);Object.keys(x).forEach(function(w){var S=x[w],A=n.spreadsheet[tnt[w]];A&&S.forEach(function(M){n.addFrozenCell(M.x,M.y,A)})})},n.addFrozenCell=function(a,o,s){var l=n.layoutResult.getCellMeta(o,a);if(l.isFrozenCorner=!0,l){var u=n.cfg.dataCell(l);s.add(u)}};var i=n.spreadsheet;return i.on(Me.RANGE_SORT,n.onSortHandler),i.on(Me.RANGE_FILTER,n.onFilterHandler),n}return t.prototype.updateRowResizeArea=function(){var r=this.spreadsheet,n=r.foregroundGroup,i=r.options,a=ii(i,"interaction.resize"),o=Dp(a)?a:a==null?void 0:a.rowCellVertical;if(o){var s=n.findById(Kx),l=n.findById(jrt);s&&s.set("children",[]),l&&l.set("children",[]);var u=Xw(this.panelGroup.getChildren(),x3).filter(function(c){return c.shouldDrawResizeArea()});u==null||u.forEach(function(c){c.drawResizeArea()})}},t.prototype.clip=function(r,n){e.prototype.clip.call(this,r,n),this.clipResizeAreaGroup()},t.prototype.clipResizeAreaGroup=function(){var r,n,i=this.spreadsheet.foregroundGroup.findById(Kx);if(i){var a=this.layoutResult.colLeafNodes,o=this.spreadsheet,s=o.frozenRowGroup,l=o.frozenTrailingRowGroup,u=0,c=0;s&&(u=s.getBBox().height),l&&(c=l.getBBox().height);var f=this.panelBBox.height-u-c;i.setClip({type:"rect",attrs:{x:0,y:u+this.cornerBBox.height,width:(n=(r=a==null?void 0:a[0])===null||r===void 0?void 0:r.width)!==null&&n!==void 0?n:0,height:f}})}},t.prototype.getContentHeight=function(){var r=this.getViewCellHeights().getTotalHeight,n=this.layoutResult.colsHierarchy;return r()+n.height},Object.defineProperty(t.prototype,"dataCellTheme",{get:function(){return this.spreadsheet.theme.dataCell.cell},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){var r=this.spreadsheet;r.off(Me.RANGE_SORT,this.onSortHandler),r.off(Me.RANGE_FILTER,this.onFilterHandler),e.prototype.destroy.call(this)},t.prototype.calculateCornerBBox=function(){var r=this.layoutResult.colsHierarchy,n=Math.floor(r.height);this.cornerBBox=new Kot(this),this.cornerBBox.height=n,this.cornerBBox.maxY=n},t.prototype.doLayout=function(){var r=this,n=this.cfg,i=n.dataSet,a=n.spreadsheet,o=new Uat,s=NB({isRowHeader:!1,facetCfg:this.cfg}),l=s.leafNodes,u=s.hierarchy;this.calculateColNodesCoordinate(l,u);var c=function(d,v){var g,x=r.cfg.showSeriesNumber,w=l[v],S=r.getCellHeight(d),A=r.getCellRange(),M=Nm(r.cfg,l.length,A.end-A.start+1).frozenTrailingRowCount,R,O=w.x,N=r.viewCellHeights.getCellOffsetY(d);return VS(d,A.end,M)&&(N=r.panelBBox.maxY-r.getTotalHeightForRange(d,A.end)),x&&w.field===n_?R="".concat(d+1):R=i.getCellData({query:{field:w.field,rowIndex:d}}),{spreadsheet:a,x:O,y:N,width:w.width,height:S,data:(g={},g[w.field]=R,g),rowIndex:d,colIndex:v,isTotals:!1,colId:w.id,rowId:String(d),valueField:w.field,fieldValue:R,id:WS(String(d),w.id)}},f={colNodes:u.getNodes(),colsHierarchy:u,rowNodes:o.getNodes(),rowsHierarchy:o,rowLeafNodes:o.getLeaves(),colLeafNodes:l,getCellMeta:c,spreadsheet:a};return f},t.prototype.getAdaptiveColWidth=function(r){var n=this.cfg.cellCfg,i=this.cfg.showSeriesNumber;if(this.spreadsheet.getLayoutWidthType()!==i_.Compact){var a=this.getSeriesNumberWidth(),o=r.length-(i?1:0),s=this.getCanvasHW().width-a;return Math.max(n==null?void 0:n.width,s/Math.max(1,o))}return n==null?void 0:n.width},t.prototype.getColNodeHeight=function(r,n){var i=this.cfg.colCfg,a=wg(i==null?void 0:i.heightByField)[0],o=a||(i==null?void 0:i.height);if(!n||r.children&&r.children.length)return o;for(;r.parent;)n-=Bp(r)?0:o,r=r.parent;return n},t.prototype.calculateColNodesCoordinate=function(r,n){var i,a,o,s,l,u,c=su.blankNode(),f=n.getNodes();try{for(var d=Gf(n.sampleNodesForAllLevels),v=d.next();!v.done;v=d.next()){var g=v.value;g.height=this.getColNodeHeight(g),n.height+=g.height}}catch(V){i={error:V}}finally{try{v&&!v.done&&(a=d.return)&&a.call(d)}finally{if(i)throw i.error}}for(var x=this.getAdaptiveColWidth(r),w=0,S=0;S<f.length;S++){var A=f[S];A.isLeaf&&(A.colIndex=w,w+=1,A.x=c.x+c.width,A.width=this.calculateColLeafNodesWidth(A,x),_B(this.cfg,null,A),n.width+=A.width,c=A),A.level===0?A.y=0:A.y=(l=((o=A.parent)===null||o===void 0?void 0:o.y)+((s=A.parent)===null||s===void 0?void 0:s.height))!==null&&l!==void 0?l:0,A.height=this.getColNodeHeight(A,n.height)}var M=f.filter(function(V){return Bp(V)}),R=Nm((u=this.spreadsheet)===null||u===void 0?void 0:u.options,M.length).frozenTrailingColCount;c=su.blankNode();var O=this.getCanvasHW().width;if(R>0)for(var N=_R(M,0,R).trailingColCount,k=f.filter(function(V){return V.isLeaf}),S=1;S<=N;S++){var A=k[k.length-S];S===1?A.x=O-A.width:A.x=c.x-A.width,c=A}this.autoCalculateColNodeWidthAndX(r)},t.prototype.autoCalculateColNodeWidthAndX=function(r){for(var n=null,i=r.slice(0);i.length;){var a=i.shift(),o=a.parent;n!==o&&o&&(i.push(o),o.x=o.children[0].x,o.width=o.children.map(function(s){return s.width}).reduce(function(s,l){return s+l},0),n=o)}},t.prototype.calculateColLeafNodesWidth=function(r,n){var i=this.cfg,a=i.colCfg,o=i.dataSet,s=i.spreadsheet,l=this.spreadsheet.getLayoutWidthType(),u=this.getCellDraggedWidth(r);if(nc(u))return u;var c=this.getCellCustomWidth(r,a==null?void 0:a.width);if(nc(c))return c;var f;if(l===i_.Compact){var d=o.getDisplayDataSet(),v=o.getFieldFormatter(r.field),g=uk(d==null?void 0:d.slice(0,50).map(function(N){var k;return"".concat((k=v==null?void 0:v(N[r.field]))!==null&&k!==void 0?k:N[r.field])}),function(N){return s.measureTextWidthRoughly(N)});Fp.getInstance().logger("Max Label In Col:",r.field,g);var x=s.theme.colCell.bolderText,w=s.theme.dataCell,S=w.text,A=w.cell,M=1,R=s.measureTextWidth(g,S)+A.padding.left+A.padding.right+M,O=s.measureTextWidth(r.label,x)+Ode(this.spreadsheet,r,s.theme.colCell);f=Math.max(O,R)}else f=n;return r.field===n_&&(f=this.getSeriesNumberWidth()),f},t.prototype.initRowOffsets=function(){var r=this,n,i=this.cfg.dataSet,a=(((n=this.spreadsheet.options.style)===null||n===void 0?void 0:n.rowCfg)||{}).heightByField,o=a===void 0?{}:a;if(Object.keys(o).length){var s=i.getDisplayDataSet();this.rowOffsets=[0];var l=0;s.forEach(function(u,c){var f,d=(f=o==null?void 0:o[String(c)])!==null&&f!==void 0?f:r.getDefaultCellHeight(),v=l+d;r.rowOffsets.push(v),l=v})}},t.prototype.getCellHeight=function(r){var n;if(this.rowOffsets){var i=(((n=this.spreadsheet.options.style)===null||n===void 0?void 0:n.rowCfg)||{}).heightByField,a=i===void 0?{}:i,o=a==null?void 0:a[String(r)];if(nc(o))return o}return this.getDefaultCellHeight()},t.prototype.getViewCellHeights=function(){var r=this,n=this.cfg.dataSet,i=this.getDefaultCellHeight();return{getTotalHeight:function(){return r.rowOffsets?co(r.rowOffsets):i*n.getDisplayDataSet().length},getCellOffsetY:function(a){if(a<=0)return 0;if(r.rowOffsets)return r.rowOffsets[a];for(var o=0,s=0;s<a;s++)o+=i;return o},getTotalLength:function(){return n.getDisplayDataSet().length},getIndexRange:function(a,o){if(r.rowOffsets)return Yot(r.rowOffsets,a,o);var s=Math.floor(a/i),l=o%i===0?o/i-1:Math.floor(o/i);return{start:Math.max(0,s),end:Math.max(0,l)}}}},t.prototype.init=function(){this.initRowOffsets(),e.prototype.init.call(this);var r=this.panelBBox,n=r.width,i=r.height;this.spreadsheet.panelGroup.setClip({type:"rect",attrs:{x:0,y:this.cornerBBox.height,width:n,height:i}})},t.prototype.getColHeader=function(){if(!this.columnHeader){var r=this.panelBBox,n=r.x,i=r.width,a=r.viewportHeight,o=r.viewportWidth;return new qve({width:i,height:this.cornerBBox.height,viewportWidth:o,viewportHeight:a,cornerWidth:this.cornerBBox.width,position:{x:n,y:0},data:this.layoutResult.colNodes,scrollContainsRowHeader:this.cfg.spreadsheet.isScrollContainsRowHeader(),sortParam:this.cfg.spreadsheet.store.get("sortParam"),spreadsheet:this.spreadsheet})}return this.columnHeader},t.prototype.render=function(){this.renderFrozenPanelCornerGroup(),e.prototype.render.call(this)},t.prototype.getRowHeader=function(){return null},t.prototype.getSeriesNumberHeader=function(){return null},t}(tst),ist=function(e){en(t,e);function t(r){var n=e.call(this,r)||this;return n.gridInfo={cols:[],rows:[]},n.updateGrid=function(i,a){a===void 0&&(a=HG);var o=n.getBBox(),s=n.s2,l=s.theme,u=s.isTableMode,c=l.dataCell.cell,f=u()&&(a===HG||a===Xrt);(!n.gridGroup||!n.findById(a))&&(n.gridGroup=n.addGroup({id:a})),n.gridGroup.clear(),n.gridInfo=i,f&&n.gridInfo.cols.unshift(0);var d=c.verticalBorderWidth,v=c.verticalBorderWidth/2;n.gridInfo.cols.forEach(function(w){lu(n.gridGroup,{x1:w,x2:w,y1:Math.ceil(o.minY+v),y2:Math.floor(o.maxY-v)},{stroke:c.verticalBorderColor,strokeOpacity:c.verticalBorderColorOpacity,lineWidth:d,lineCap:WG,lineDash:c.borderDash})});var g=c.horizontalBorderWidth,x=c.horizontalBorderWidth/2;n.gridInfo.rows.forEach(function(w){lu(n.gridGroup,{x1:Math.ceil(o.minX+x),x2:Math.floor(o.maxX-x),y1:w,y2:w},{stroke:c.horizontalBorderColor,strokeOpacity:c.horizontalBorderColorOpacity,lineWidth:g,lineCap:WG,lineDash:c.borderDash})}),n.gridGroup.toFront()},n.s2=r.s2,n}return t}(tv),ast=function(e){en(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(ist),Qve=function(e){en(t,e);function t(r){var n=e.call(this,r)||this;return n.initMergedCellsGroup(),n}return t.prototype.initMergedCellsGroup=function(){this.mergedCellsGroup&&this.findById(UG)||(this.mergedCellsGroup=this.addGroup({id:UG}))},t.prototype.updateMergedCells=function(){this.initMergedCellsGroup(),gde(this.s2,this.mergedCellsGroup),this.mergedCellsGroup.toFront()},t.prototype.addMergeCell=function(r){var n;(n=this.mergedCellsGroup)===null||n===void 0||n.add(r)},t.prototype.update=function(r){this.updateGrid(r),this.updateMergedCells()},t}(ist),Qd=function(){function e(t){var r=this;this.isLinkFieldText=function(n){var i=r.getCellAppendInfo(n);return i==null?void 0:i.isLinkFieldText},this.spreadsheet=t,this.bindEvents()}return e.prototype.getCellAppendInfo=function(t){var r,n;return((r=t==null?void 0:t.attr)===null||r===void 0?void 0:r.call(t,"appendInfo"))||((n=t==null?void 0:t.attrs)===null||n===void 0?void 0:n.appendInfo)||{}},e.prototype.reset=function(){},e}(),Jve=function(e){en(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.bindEvents=function(){this.bindDataCellClick()},t.prototype.bindDataCellClick=function(){var r=this;this.spreadsheet.on(Me.DATA_CELL_CLICK,function(n){var i;n.stopPropagation();var a=r.spreadsheet.interaction;if(a.clearHoverTimer(),!a.hasIntercepts([Ti.CLICK])){if(r.isLinkFieldText(n.target)){r.emitLinkFieldClickEvent(n);return}var o=r.spreadsheet.getCell(n.target),s=o.getMeta();if(s){if(a.addIntercepts([Ti.HOVER]),a.isSelectedCell(o)){((i=n.originalEvent)===null||i===void 0?void 0:i.detail)===1&&(a.reset(),r.spreadsheet.emit(Me.GLOBAL_SELECTED,a.getActiveCells()));return}a.changeState({cells:[Hp(o)],stateName:On.SELECTED,onUpdateCells:Hk}),r.spreadsheet.emit(Me.GLOBAL_SELECTED,[o]),r.showTooltip(n,s);var l=s.rowId,u=s.colId,c=s.spreadsheet,f=a.getSelectedCellHighlight(),d=f.colHeader,v=f.rowHeader;if(d&&uot(u,a.getAllColHeaderCells(),On.SELECTED),v&&l){var g=Kde(s,c);xi(g,function(x){x.updateByState(On.SELECTED)})}}}})},t.prototype.getTooltipOperator=function(r,n){var i=this,a=Zce(),o=this.spreadsheet.getCell(r.target),s=jk(this.spreadsheet,r).operation,l=s.trend&&Zt(Zt({},a),{onClick:function(){i.spreadsheet.emit(Me.DATA_CELL_TREND_ICON_CLICK,Zt(Zt({},n),{record:i.spreadsheet.isTableMode()?i.spreadsheet.dataSet.getCellData({query:{rowIndex:n.rowIndex}}):void 0})),i.spreadsheet.hideTooltip()}});return zot(s,{defaultMenus:[l],cell:o})},t.prototype.showTooltip=function(r,n){var i=n.data,a=n.isTotals,o=a===void 0?!1:a,s=n.value,l=n.fieldValue,u=n.field,c=n.valueField,f=i,d=this.spreadsheet.isTableMode(),v=d?Zt(Zt({},f),{value:s||l,valueField:u||c}):f,g=[v||Zt(Zt({},n.rowQuery),n.colQuery)],x=this.getTooltipOperator(r,n);this.spreadsheet.showTooltipWithInfo(r,g,{isTotals:o,operator:x,enterable:!0,hideSummary:!0,showSingleTips:d})},t.prototype.emitLinkFieldClickEvent=function(r){var n=this.getCellAppendInfo(r.target).cellData,i=n.valueField,a=n.data;this.spreadsheet.emit(Me.GLOBAL_LINK_FIELD_JUMP,{key:i,cellData:n,record:Object.assign({rowIndex:n.rowIndex},a)})},t}(Qd),tge=function(e){en(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.bindEvents=function(){this.bindDataCellClick()},t.prototype.bindDataCellClick=function(){var r=this;this.spreadsheet.on(Me.MERGED_CELLS_CLICK,function(n){n.stopPropagation();var i=r.spreadsheet.interaction;i.hasIntercepts([Ti.CLICK])||i.addIntercepts([Ti.HOVER])})},t}(Qd),ege=function(e){en(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.isMultiSelection=!1,r.handleRowColClick=function(n){if(n.stopPropagation(),!r.isLinkFieldText(n.target)){var i=r.spreadsheet,a=i.interaction,o=i.options,s=r.spreadsheet.getCell(n.target),l=o.interaction.multiSelection,u=!!(l&&r.isMultiSelection),c=a.selectHeaderCell({cell:s,isMultiSelection:u});c&&r.showTooltip(n)}},r.getHideColumnField=function(n){return r.spreadsheet.isTableMode()?n.field:n.id},r}return t.prototype.bindEvents=function(){this.bindKeyboardDown(),this.bindKeyboardUp(),this.bindColCellClick(),this.bindRowCellClick(),this.bindTableColExpand(),this.bindMouseMove()},t.prototype.reset=function(){this.isMultiSelection=!1,this.spreadsheet.interaction.removeIntercepts([Ti.CLICK])},t.prototype.bindKeyboardDown=function(){var r=this;this.spreadsheet.on(Me.GLOBAL_KEYBOARD_DOWN,function(n){CR(n)&&(r.isMultiSelection=!0)})},t.prototype.bindKeyboardUp=function(){var r=this;this.spreadsheet.on(Me.GLOBAL_KEYBOARD_UP,function(n){CR(n)&&r.reset()})},t.prototype.bindMouseMove=function(){var r=this;this.spreadsheet.on(Me.GLOBAL_MOUSE_MOVE,function(n){r.isMultiSelection&&!Cot(n)&&r.reset()})},t.prototype.bindRowCellClick=function(){var r=this;this.spreadsheet.on(Me.ROW_CELL_CLICK,function(n){r.handleRowColClick(n)})},t.prototype.bindColCellClick=function(){var r=this;this.spreadsheet.on(Me.COL_CELL_CLICK,function(n){r.handleRowColClick(n)})},t.prototype.showTooltip=function(r){var n=jk(this.spreadsheet,r),i=n.operation,a=n.showTooltip;if(a){var o=this.spreadsheet.interaction,s=o.isSelectedState()?lve(o.getActiveCells()):[],l=this.getTooltipOperator(r,i);this.spreadsheet.showTooltipWithInfo(r,s,{showSingleTips:!0,operator:l})}},t.prototype.getTooltipOperator=function(r,n){var i=this,a=this.spreadsheet.getCell(r.target),o=a.getMeta(),s=a.cellType===Br.COL_CELL,l=this.spreadsheet.getColumnLeafNodes().length===1,u=Yce(),c=s&&!l&&o.isLeaf&&n.hiddenColumns,f=c&&Zt(Zt({},u),{onClick:function(){i.hideSelectedColumns()}});return zot(n,{defaultMenus:[f],cell:a})},t.prototype.bindTableColExpand=function(){var r=this;this.spreadsheet.on(Me.LAYOUT_COLS_EXPANDED,function(n){r.handleExpandIconClick(n)})},t.prototype.hideSelectedColumns=function(){var r=this.spreadsheet.interaction,n=r.getActiveCells().map(function(a){return a.getMeta()}),i=n.map(this.getHideColumnField);Nk(this.spreadsheet,i,!0)},t.prototype.handleExpandIconClick=function(r){var n=this.spreadsheet.store.get("hiddenColumnsDetail",[]),i=(a3(n,function(c){var f=c.displaySiblingNode;return CB(f,r.id)})||{}).hideColumnNodes,a=i===void 0?[]:i,o=this.spreadsheet.options.interaction.hiddenColumnFields,s=a.map(this.getHideColumnField),l=Ait(o,s),u=n.filter(function(c){var f=c.displaySiblingNode;return!CB(f,r.id)});this.spreadsheet.setOptions({interaction:{hiddenColumnFields:l}}),this.spreadsheet.store.set("hiddenColumnsDetail",u),this.spreadsheet.interaction.reset(),this.spreadsheet.render(!1)},t}(Qd),rge=function(e){en(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.getRowData=function(n){var i,a=n.getHeadLeafChild(),o=r.spreadsheet.dataSet.getMultiData(a==null?void 0:a.query)[0];return Zt(Zt({},o),{rowIndex:(i=n.rowIndex)!==null&&i!==void 0?i:a.rowIndex})},r}return t.prototype.bindEvents=function(){this.bindRowCellClick()},t.prototype.bindRowCellClick=function(){var r=this;this.spreadsheet.on(Me.ROW_CELL_CLICK,function(n){if(!r.spreadsheet.interaction.hasIntercepts([Ti.CLICK])&&r.isLinkFieldText(n.target)){var i=r.getCellAppendInfo(n.target).cellData,a=i.key,o=r.getRowData(i);r.spreadsheet.emit(Me.GLOBAL_LINK_FIELD_JUMP,{key:a,cellData:i,record:o})}})},t}(Qd),nge=function(e){en(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.bindEvents=function(){this.bindCornerCellClick()},t.prototype.bindCornerCellClick=function(){var r=this;this.spreadsheet.on(Me.CORNER_CELL_CLICK,function(n){var i,a=r.spreadsheet.interaction,o=r.spreadsheet.getCell(n.target);if(o){var s=o.getMeta(),l=r.getRowNodesByField(s==null?void 0:s.field),u=(i=l[0])===null||i===void 0?void 0:i.belongsCell,c=r.getRowCells(l);if(u&&a.isSelectedCell(u)){a.reset(),r.spreadsheet.emit(Me.GLOBAL_SELECTED,a.getActiveCells());return}Or(l)||Or(c)||(a.addIntercepts([Ti.HOVER]),a.changeState({cells:c,stateName:On.SELECTED}),a.highlightNodes(l),r.showTooltip(n),r.spreadsheet.emit(Me.GLOBAL_SELECTED,a.getActiveCells()))}})},t.prototype.getRowNodesByField=function(r){return this.spreadsheet.getRowNodes().filter(function(n){return n.field===r})},t.prototype.getRowCells=function(r){return r.map(function(n){return{id:n.id,colIndex:-1,rowIndex:-1,type:Br.ROW_CELL}})},t.prototype.showTooltip=function(r){var n=this.spreadsheet.interaction.getActiveCells();this.spreadsheet.showTooltipWithInfo(r,[],{data:{summaries:[{selectedData:n,name:"",value:null}]}})},t}(Qd),ige=function(e){en(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.bindEvents=function(){this.bindCornerCellHover(),this.bindDataCellHover(),this.bindRowCellHover(),this.bindColCellHover()},t.prototype.updateRowColCells=function(r){var n=r.rowId,i=r.colId,a=this.spreadsheet.interaction,o=a.getHoverHighlight(),s=o.rowHeader,l=o.colHeader;if(l&&uot(i,a.getAllColHeaderCells(),On.HOVER),s&&n){var u=Fk(n,a.getAllRowHeaderCells(),this.spreadsheet.isHierarchyTreeType());xi(u,function(c){c.updateByState(On.HOVER)})}},t.prototype.changeStateToHoverFocus=function(r,n,i){var a=this,o,s=this.spreadsheet.interaction,l=this.spreadsheet.options.interaction,u=l.hoverFocus;s.clearHoverTimer();var c=function(){if(!s.hasIntercepts([Ti.HOVER])){s.changeState({cells:[Hp(r)],stateName:On.HOVER_FOCUS});var v=a.spreadsheet.isTableMode(),g={isTotals:i.isTotals,enterable:!0,hideSummary:!0,showSingleTips:v},x=s.getHoverHighlight(),w=x.rowHeader,S=x.colHeader;(w||S)&&a.updateRowColCells(i);var A=a.getCellData(i,v);a.spreadsheet.showTooltipWithInfo(n,A,g)}},f=qF;if(Dp(u)||(f=(o=u==null?void 0:u.duration)!==null&&o!==void 0?o:qF),f===0)c();else{var d=window.setTimeout(function(){return c()},f);s.setHoverTimer(d)}},t.prototype.handleHeaderHover=function(r){var n=this.spreadsheet.getCell(r.target);if(!Or(n)){var i=this.spreadsheet.interaction;i.clearHoverTimer(),!i.isActiveCell(n)&&(i.changeState({cells:[Hp(n)],stateName:On.HOVER}),n.update(),this.showEllipsisTooltip(r,n))}},t.prototype.showEllipsisTooltip=function(r,n){if(!n||!n.isTextOverflowing()){this.spreadsheet.hideTooltip();return}var i=n.getMeta(),a=!0,o={isTotals:i.isTotals,enterable:!0,hideSummary:!0,showSingleTips:a,enableFormat:!0},s=this.getCellData(i,a);this.spreadsheet.showTooltipWithInfo(r,s,o)},t.prototype.getCellData=function(r,n){r===void 0&&(r={});var i=r.data,a=r.query,o=r.value,s=r.field,l=r.fieldValue,u=r.valueField,c=r.rowQuery,f=r.colQuery,d=i,v=n?[Zt(Zt({},a),{value:o||l,valueField:s||u})]:[d||Zt(Zt({},c),f)];return v},t.prototype.bindDataCellHover=function(){var r=this;this.spreadsheet.on(Me.DATA_CELL_HOVER,function(n){var i=r.spreadsheet.getCell(n.target);if(!Or(i)){var a=r.spreadsheet,o=a.interaction,s=a.options,l=s.interaction,u=i==null?void 0:i.getMeta();if(!o.isActiveCell(i)){o.changeState({cells:[Hp(i)],stateName:On.HOVER});var c=o.getHoverHighlight(),f=c.rowHeader,d=c.colHeader;(f||d)&&r.updateRowColCells(u),l.hoverFocus&&r.changeStateToHoverFocus(i,n,u)}}})},t.prototype.bindRowCellHover=function(){var r=this;this.spreadsheet.on(Me.ROW_CELL_HOVER,function(n){r.handleHeaderHover(n)})},t.prototype.bindColCellHover=function(){var r=this;this.spreadsheet.on(Me.COL_CELL_HOVER,function(n){r.handleHeaderHover(n)})},t.prototype.bindCornerCellHover=function(){var r=this;this.spreadsheet.on(Me.CORNER_CELL_HOVER,function(n){r.handleHeaderHover(n)})},t}(Qd),Jk=function(e){en(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.displayedCells=[],r.brushRangeCells=[],r.brushSelectionStage=Lu.UN_DRAGGED,r.brushSelectionMinimumMoveDistance=5,r.scrollAnimationComplete=!0,r.mouseMoveDistanceFromCanvas=0,r.setMoveDistanceFromCanvas=function(n,i,a){var o=0;if(i&&(o=n.x),a){var s=n.y;i?o=Math.max(s,o):o=s}r.mouseMoveDistanceFromCanvas=Math.abs(o)},r.formatBrushPointForScroll=function(n,i){var a,o,s,l;i===void 0&&(i=!1);var u=n.x,c=n.y,f=r.spreadsheet.facet,d=i?f.cornerBBox:f.panelBBox,v=d.minX,g=d.maxX,x=f.panelBBox,w=x.minY,S=x.maxY,A=((a=r.endBrushPoint)===null||a===void 0?void 0:a.x)+u,M=((o=r.endBrushPoint)===null||o===void 0?void 0:o.y)+c,R=!0,O=!0,N=(l=(s=f.vScrollBar)===null||s===void 0?void 0:s.getBBox())===null||l===void 0?void 0:l.width,k=2;return A>g?A=g-N-k:A<v?A=v+k:R=!1,M>S?M=S-k:M<=w?M=w+k:O=!1,{x:{value:A,needScroll:R},y:{value:M,needScroll:O}}},r.rectanglesIntersect=function(n,i){return n.maxX>i.minX&&n.minX<i.maxX&&n.minY<i.maxY&&n.maxY>i.minY},r.autoScrollIntervalId=null,r.autoScrollConfig=iB(jG),r.validateYIndex=function(n){var i,a,o=r.spreadsheet.facet,s=o.frozenGroupInfo,l=0,u=(i=s==null?void 0:s.frozenRow)===null||i===void 0?void 0:i.range;if(u&&(l=u[1]+1),n<l)return null;var c=o.getCellRange().end,f=(a=s==null?void 0:s.frozenTrailingRow)===null||a===void 0?void 0:a.range;return f&&(c=f[0]-1),n>c?null:n},r.validateXIndex=function(n){var i,a,o=r.spreadsheet.facet,s=o.frozenGroupInfo,l=0,u=(i=s==null?void 0:s.frozenCol)===null||i===void 0?void 0:i.range;if(u&&(l=u[1]+1),n<l)return null;var c=o.layoutResult.colLeafNodes.length-1,f=(a=s==null?void 0:s.frozenTrailingCol)===null||a===void 0?void 0:a.range;return f&&(c=f[0]-1),n>c?null:n},r.adjustNextColIndexWithFrozen=function(n,i){var a=r.spreadsheet,o=a.facet,s=a.dataSet,l=a.options,u=s.getDisplayDataSet().length,c=o.layoutResult.colLeafNodes.length,f=Nm(l,c,u),d=f.frozenTrailingColCount,v=f.frozenColCount,g=o.panelScrollGroupIndexes;return d>0&&i===Fl.SCROLL_DOWN&&ky(n,d,c)?g[1]:v>0&&i===Fl.SCROLL_UP&&Ny(n,v)?g[0]:n},r.adjustNextRowIndexWithFrozen=function(n,i){var a=r.spreadsheet,o=a.facet,s=a.dataSet,l=a.options,u=s.getDisplayDataSet().length,c=o.layoutResult.colLeafNodes.length,f=o.getCellRange(),d=Nm(l,c,u),v=d.frozenTrailingRowCount,g=d.frozenRowCount,x=o.panelScrollGroupIndexes;return v>0&&i===Fl.SCROLL_DOWN&&VS(n,f.end,v)?x[3]:g>0&&i===Fl.SCROLL_UP&&g3(n,f.start,g)?x[2]:n},r.getWillScrollRowIndexDiff=function(n){return n===Fl.SCROLL_DOWN?uR.SCROLL_DOWN:uR.SCROLL_UP},r.getDefaultWillScrollToRowIndex=function(n){var i=r.adjustNextRowIndexWithFrozen(r.endBrushPoint.rowIndex,n),a=i+r.getWillScrollRowIndexDiff(n);return r.validateYIndex(a)},r.getWillScrollToRowIndex=function(n){return r.getDefaultWillScrollToRowIndex(n)},r.getNextScrollDelta=function(n){var i=r.spreadsheet.facet.getScrollOffset(),a=i.scrollX,o=i.scrollY,s=0,l=0;if(n.y.scroll){var u=n.y.value>0?Fl.SCROLL_DOWN:Fl.SCROLL_UP,c=r.getWillScrollToRowIndex(u),f=tpe(c,u,r.spreadsheet)-o,d=bl(c)||bl(f)||Number.isNaN(f);l=d?0:f}if(n.x.scroll){var u=n.x.value>0?Fl.SCROLL_DOWN:Fl.SCROLL_UP,v=r.adjustNextColIndexWithFrozen(r.endBrushPoint.colIndex,u),g=r.validateXIndex(v+(n.x.value>0?1:-1));s=bl(g)?0:Jde(g,u,r.spreadsheet)-a}return{x:s,y:l}},r.onScrollAnimationComplete=function(){r.scrollAnimationComplete=!0,r.brushSelectionStage!==Lu.UN_DRAGGED&&r.renderPrepareSelected(r.endBrushPoint)},r.autoScroll=function(n){if(n===void 0&&(n=!1),!(r.brushSelectionStage===Lu.UN_DRAGGED||!r.scrollAnimationComplete)){var i=r.autoScrollConfig,a=r.spreadsheet.facet.getScrollOffset(),o=n?"rowHeaderOffsetX":"offsetX",s={rowHeaderOffsetX:{value:a.rowHeaderScrollX,animate:!0},offsetX:{value:a.scrollX,animate:!0},offsetY:{value:a.scrollY,animate:!0}},l=r.getNextScrollDelta(i),u=l.x,c=l.y;if(c===0&&u===0){r.clearAutoScroll();return}if(i.y.scroll&&(s.offsetY.value+=c),i.x.scroll){var f=s[o];f.value+=u,f.value<0&&(f.value=0)}r.scrollAnimationComplete=!1;var d=i.x.scroll?1:3,v=Math.max(16,300-r.mouseMoveDistanceFromCanvas*d);r.spreadsheet.facet.scrollWithAnimation(s,v,r.onScrollAnimationComplete)}},r.handleScroll=Ek(function(n,i,a){if(a===void 0&&(a=!1),r.brushSelectionStage!==Lu.UN_DRAGGED){var o=r.formatBrushPointForScroll({x:n,y:i},a),s=o.x,l=s.value,u=s.needScroll,c=o.y,f=c.value,d=c.needScroll,v=r.autoScrollConfig;d&&(v.y.value=i,v.y.scroll=!0),u&&(v.x.value=n,v.x.scroll=!0),r.setMoveDistanceFromCanvas({x:n,y:i},u,d),r.renderPrepareSelected({x:l,y:f}),(d||u)&&(r.clearAutoScroll(),r.autoScroll(a),r.autoScrollIntervalId=setInterval(function(){r.autoScroll(a)},16))}},30),r.clearAutoScroll=function(){r.autoScrollIntervalId&&(clearInterval(r.autoScrollIntervalId),r.autoScrollIntervalId=null,r.resetScrollDelta())},r.onUpdateCells=function(n,i){return i()},r.showPrepareSelectedCells=function(){r.brushRangeCells=r.getBrushRangeCells(),r.spreadsheet.interaction.changeState({cells:ia(r.brushRangeCells,function(n){return Hp(n)}),stateName:On.PREPARE_SELECT,force:!0,onUpdateCells:r.onUpdateCells})},r.renderPrepareSelected=function(n){var i=n.x,a=n.y,o=r.spreadsheet.container.getShape(i,a),s=r.spreadsheet.getCell(o),l=s instanceof _0||s instanceof jS||s instanceof _3;if(!(!s||!l)){var u=s.getMeta(),c=u.rowIndex,f=u.colIndex;r.endBrushPoint={x:i,y:a,rowIndex:c,colIndex:f};var d=r.spreadsheet.interaction;d.addIntercepts([Ti.HOVER]),d.clearStyleIndependent(),r.isValidBrushSelection()&&(r.showPrepareSelectedCells(),r.updatePrepareSelectMask())}},r}return t.prototype.bindEvents=function(){this.bindMouseDown(),this.bindMouseMove(),this.bindMouseUp()},t.prototype.getPrepareSelectMaskTheme=function(){var r;return(r=this.spreadsheet.theme)===null||r===void 0?void 0:r.prepareSelectMask},t.prototype.initPrepareSelectMaskShape=function(){var r=this.spreadsheet.foregroundGroup;if(r){r.removeChild(this.prepareSelectMaskShape);var n=this.getPrepareSelectMaskTheme();this.prepareSelectMaskShape=r.addShape("rect",{visible:!1,attrs:{width:0,height:0,x:0,y:0,fill:n==null?void 0:n.backgroundColor,fillOpacity:n==null?void 0:n.backgroundOpacity,zIndex:Djt},capture:!1})}},t.prototype.setBrushSelectionStage=function(r){this.brushSelectionStage=r},t.prototype.isPointInCanvas=function(r){var n=this.spreadsheet.facet.getCanvasHW(),i=n.height,a=n.width,o=this.spreadsheet.facet.panelBBox,s=o.minX,l=o.minY;return r.x>s&&r.x<a&&r.y>l&&r.y<i},t.prototype.resetDrag=function(){this.hidePrepareSelectMaskShape(),this.setBrushSelectionStage(Lu.UN_DRAGGED)},t.prototype.isValidBrushSelection=function(){var r=this.getBrushRange(),n=r.start,i=r.end,a=i.x-n.x>this.brushSelectionMinimumMoveDistance||i.y-n.y>this.brushSelectionMinimumMoveDistance;return a},t.prototype.setDisplayedCells=function(){this.displayedCells=this.spreadsheet.interaction.getPanelGroupAllDataCells()},t.prototype.updatePrepareSelectMask=function(){var r=this.getBrushRange(),n=this.getPrepareSelectMaskPosition(r),i=n.x,a=n.y;this.prepareSelectMaskShape.attr({x:i,y:a,width:r.width,height:r.height}),this.prepareSelectMaskShape.show()},t.prototype.hidePrepareSelectMaskShape=function(){var r;(r=this.prepareSelectMaskShape)===null||r===void 0||r.hide()},t.prototype.resetScrollDelta=function(){this.autoScrollConfig=iB(jG)},t.prototype.getBrushPoint=function(r){var n=this.spreadsheet.facet.getScrollOffset(),i=n.scrollY,a=n.scrollX,o={x:r==null?void 0:r.x,y:r==null?void 0:r.y},s=this.spreadsheet.getCell(r.target),l=s.getMeta(),u=l.colIndex,c=l.rowIndex;return Zt(Zt({},o),{rowIndex:c,colIndex:u,scrollY:i,scrollX:a})},t.prototype.getBrushRange=function(){var r,n,i,a,o,s,l,u,c=this.spreadsheet.facet.getScrollOffset(),f=c.scrollX,d=c.scrollY,v=Math.min(this.startBrushPoint.rowIndex,(r=this.endBrushPoint)===null||r===void 0?void 0:r.rowIndex),g=Math.max(this.startBrushPoint.rowIndex,(n=this.endBrushPoint)===null||n===void 0?void 0:n.rowIndex),x=Math.min(this.startBrushPoint.colIndex,(i=this.endBrushPoint)===null||i===void 0?void 0:i.colIndex),w=Math.max(this.startBrushPoint.colIndex,(a=this.endBrushPoint)===null||a===void 0?void 0:a.colIndex),S=this.startBrushPoint.x+this.startBrushPoint.scrollX-f,A=this.startBrushPoint.y+this.startBrushPoint.scrollY-d,M=Math.min(S,(o=this.endBrushPoint)===null||o===void 0?void 0:o.x),R=Math.max(S,(s=this.endBrushPoint)===null||s===void 0?void 0:s.x),O=Math.min(A,(l=this.endBrushPoint)===null||l===void 0?void 0:l.y),N=Math.max(A,(u=this.endBrushPoint)===null||u===void 0?void 0:u.y);return{start:{rowIndex:v,colIndex:x,x:M,y:O},end:{rowIndex:g,colIndex:w,x:R,y:N},width:R-M,height:N-O}},t.prototype.getBrushRangeCells=function(){var r=this;return this.setDisplayedCells(),this.displayedCells.filter(function(n){var i=n.getMeta();return r.isInBrushRange(i)})},t.prototype.mouseDown=function(r){var n;(n=r==null?void 0:r.preventDefault)===null||n===void 0||n.call(r),!this.spreadsheet.interaction.hasIntercepts([Ti.CLICK])&&(this.setBrushSelectionStage(Lu.CLICK),this.initPrepareSelectMaskShape(),this.setDisplayedCells(),this.startBrushPoint=this.getBrushPoint(r))},t.prototype.addBrushIntercepts=function(){this.spreadsheet.interaction.addIntercepts([Ti.BRUSH_SELECTION])},t.prototype.bindMouseUp=function(r){var n=this;r===void 0&&(r=!1),this.spreadsheet.on(Me.GLOBAL_MOUSE_UP,function(i){if(n.brushSelectionStage!==Lu.DRAGGED){n.resetDrag();return}if(r&&n.clearAutoScroll(),n.isValidBrushSelection()){n.addBrushIntercepts(),n.updateSelectedCells();var a=Xk(n.spreadsheet);n.spreadsheet.showTooltipWithInfo(i,a)}n.spreadsheet.interaction.getCurrentStateName()===On.PREPARE_SELECT&&n.spreadsheet.interaction.reset(),n.resetDrag()}),this.spreadsheet.on(Me.GLOBAL_CONTEXT_MENU,function(){n.brushSelectionStage!==Lu.UN_DRAGGED&&(n.spreadsheet.interaction.removeIntercepts([Ti.HOVER]),n.resetDrag())})},t.prototype.autoBrushScroll=function(r,n){var i,a;if(n===void 0&&(n=!1),this.clearAutoScroll(),!this.isPointInCanvas(r)){var o=(r==null?void 0:r.x)-((i=this.endBrushPoint)===null||i===void 0?void 0:i.x),s=(r==null?void 0:r.y)-((a=this.endBrushPoint)===null||a===void 0?void 0:a.y);return this.handleScroll(o,s,n),!0}return!1},t.prototype.emitBrushSelectionEvent=function(r,n){this.spreadsheet.emit(r,n),this.spreadsheet.emit(Me.GLOBAL_SELECTED,n),Or(n)&&this.spreadsheet.interaction.removeIntercepts([Ti.HOVER])},t.prototype.getVisibleBrushRangeCells=function(r){return this.brushRangeCells.find(function(n){var i=n.getMeta();return(i==null?void 0:i.id)===r})},t.prototype.isInBrushRange=function(r){return!1},t.prototype.bindMouseDown=function(){},t.prototype.bindMouseMove=function(){},t.prototype.updateSelectedCells=function(){},t.prototype.getPrepareSelectMaskPosition=function(r){return{x:r.start.x,y:r.start.y}},t}(Qd),age=function(e){en(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.displayedCells=[],r.brushRangeCells=[],r.onUpdateCells=function(n){return n.updateCells(n.getAllColHeaderCells())},r}return t.prototype.bindEvents=function(){this.bindMouseDown(),this.bindMouseMove(),this.bindMouseUp()},t.prototype.bindMouseDown=function(){var r=this;this.spreadsheet.on(Me.COL_CELL_MOUSE_DOWN,function(n){r.spreadsheet.interaction.getBrushSelection().col&&e.prototype.mouseDown.call(r,n)})},t.prototype.isPointInCanvas=function(r){var n=this.spreadsheet.facet.getCanvasHW().width,i=this.spreadsheet.facet.cornerBBox,a=i.width,o=i.minY,s=i.maxY;return r.x>=a&&r.x<=n&&r.y>=o&&r.y<=s},t.prototype.bindMouseMove=function(){var r=this;this.spreadsheet.on(Me.COL_CELL_MOUSE_MOVE,function(n){if(r.brushSelectionStage!==Lu.UN_DRAGGED){r.setBrushSelectionStage(Lu.DRAGGED);var i=r.spreadsheet.container.getPointByEvent(n.originalEvent);r.isPointInCanvas(i)&&r.renderPrepareSelected(i)}})},t.prototype.setDisplayedCells=function(){this.displayedCells=this.spreadsheet.interaction.getAllColHeaderCells()},t.prototype.isInBrushRange=function(r){var n=this.getBrushRange(),i=n.start,a=n.end,o=this.spreadsheet.facet.getScrollOffset().scrollX,s=this.spreadsheet.facet.cornerBBox,l=r.x,u=l===void 0?0:l,c=r.y,f=c===void 0?0:c,d=r.width,v=d===void 0?0:d,g=r.height,x=g===void 0?0:g;return this.rectanglesIntersect({minX:i.x-s.width+o,minY:i.y,maxX:a.x-s.width+o,maxY:a.y},{minX:u,maxX:u+v,minY:f,maxY:f+x})},t.prototype.updateSelectedCells=function(){var r=this.spreadsheet.interaction;r.changeState({cells:ia(this.brushRangeCells,Hp),stateName:On.BRUSH_SELECTED,onUpdateCells:this.onUpdateCells}),this.spreadsheet.emit(Me.COL_CELL_BRUSH_SELECTION,this.brushRangeCells),this.spreadsheet.emit(Me.GLOBAL_SELECTED,this.brushRangeCells),Or(this.brushRangeCells)&&r.removeIntercepts([Ti.HOVER])},t.prototype.addBrushIntercepts=function(){this.spreadsheet.interaction.addIntercepts([Ti.COL_BRUSH_SELECTION])},t}(Jk),oge=function(e){en(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.displayedCells=[],r.brushRangeCells=[],r.getSelectedCellMetas=function(n){var i=[],a=r.spreadsheet.facet.layoutResult,o=a.rowLeafNodes,s=o===void 0?[]:o,l=a.colLeafNodes,u=l===void 0?[]:l,c=_x(n.start.rowIndex,n.end.rowIndex+1),f=_x(n.start.colIndex,n.end.colIndex+1);return c.forEach(function(d){f.forEach(function(v){var g=String(u[v].id),x=Or(s)?String(d):String(s[d].id);i.push({colIndex:v,rowIndex:d,id:WS(x,g),type:Br.DATA_CELL,rowId:x,colId:g,spreadsheet:r.spreadsheet})})}),i},r}return t.prototype.bindMouseDown=function(){var r=this;this.spreadsheet.on(Me.DATA_CELL_MOUSE_DOWN,function(n){r.spreadsheet.interaction.getBrushSelection().data&&(e.prototype.mouseDown.call(r,n),r.resetScrollDelta())})},t.prototype.bindMouseMove=function(){var r=this;this.spreadsheet.on(Me.GLOBAL_MOUSE_MOVE,function(n){if(r.brushSelectionStage!==Lu.UN_DRAGGED){r.setBrushSelectionStage(Lu.DRAGGED);var i=r.spreadsheet.container.getPointByEvent(n);r.autoBrushScroll(i)||r.renderPrepareSelected(i)}})},t.prototype.isInBrushRange=function(r){var n=this.getBrushRange(),i=n.start,a=n.end,o=r.rowIndex,s=r.colIndex;return o>=i.rowIndex&&o<=a.rowIndex&&s>=i.colIndex&&s<=a.colIndex},t.prototype.updateSelectedCells=function(){var r=this.getBrushRange(),n=this.getSelectedCellMetas(r);this.spreadsheet.interaction.changeState({cells:n,stateName:On.SELECTED,onUpdateCells:Hk});var i=this.getScrollBrushRangeCells(n);this.emitBrushSelectionEvent(Me.DATA_CELL_BRUSH_SELECTION,i)},t.prototype.getScrollBrushRangeCells=function(r){var n=this;return r.map(function(i){var a=n.getVisibleBrushRangeCells(i.id);if(a)return a;var o=n.spreadsheet.facet.layoutResult.getCellMeta(i.rowIndex,i.colIndex),s=n.spreadsheet.isTableMode()?x3:_0;return new s(o,n.spreadsheet)})},t.prototype.bindMouseUp=function(){e.prototype.bindMouseUp.call(this,!0)},t.prototype.getPrepareSelectMaskPosition=function(r){var n=this.spreadsheet.facet.panelBBox,i=n.minX,a=n.minY,o=Math.max(r.start.x,i),s=Math.max(r.start.y,a);return{x:o,y:s}},t}(Jk),sge=function(e){en(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.isInBrushRange=function(n){var i=r.getBrushRange(),a=i.start,o=i.end,s=r.spreadsheet.facet.getScrollOffset(),l=s.scrollY,u=s.rowHeaderScrollX,c=r.spreadsheet.facet.cornerBBox,f=n.x,d=f===void 0?0:f,v=n.y,g=v===void 0?0:v,x=n.width,w=x===void 0?0:x,S=n.height,A=S===void 0?0:S;return r.rectanglesIntersect({minX:a.x+u,minY:a.y-c.height+l,maxX:o.x+u,maxY:o.y-c.height+l},{minX:d,maxX:d+w,minY:g,maxY:g+A})},r.onUpdateCells=function(n){return n.updateCells(n.getAllRowHeaderCells())},r.getSelectedRowNodes=function(){return r.spreadsheet.getRowNodes().filter(r.isInBrushRange)},r.getVisibleRowLeafCellByScrollDirection=function(n){var i=r.spreadsheet.interaction.getAllRowHeaderCells();return n===Fl.SCROLL_DOWN?co(i):i.find(function(a){var o=a.getMeta();return o.isLeaf})},r.getWillScrollToRowIndex=function(n){var i,a;if(!bl(r.endBrushPoint.rowIndex))return r.getDefaultWillScrollToRowIndex(n);var o=r.getVisibleRowLeafCellByScrollDirection(n),s=(a=(i=o==null?void 0:o.getMeta())===null||i===void 0?void 0:i.rowIndex)!==null&&a!==void 0?a:0,l=s+r.getWillScrollRowIndexDiff(n);return r.validateYIndex(l)},r}return t.prototype.bindMouseDown=function(){var r=this;this.spreadsheet.on(Me.ROW_CELL_MOUSE_DOWN,function(n){r.spreadsheet.interaction.getBrushSelection().row&&e.prototype.mouseDown.call(r,n)})},t.prototype.isPointInCanvas=function(r){var n=this.spreadsheet.facet.getCanvasHW().height,i=this.spreadsheet.facet.cornerBBox,a=i.minX,o=i.height,s=i.maxX;return r.x>=a&&r.x<=s&&r.y>=o&&r.y<=n},t.prototype.bindMouseMove=function(){var r=this;this.spreadsheet.on(Me.GLOBAL_MOUSE_MOVE,function(n){if(r.brushSelectionStage!==Lu.UN_DRAGGED){r.setBrushSelectionStage(Lu.DRAGGED);var i=r.spreadsheet.container.getPointByEvent(n);r.autoBrushScroll(i,!0)||r.renderPrepareSelected(i)}})},t.prototype.setDisplayedCells=function(){this.displayedCells=this.spreadsheet.interaction.getAllRowHeaderCells()},t.prototype.updateSelectedCells=function(){var r=this.getSelectedRowNodes(),n=this.getScrollBrushRangeCells(r),i=ia(n,Hp);this.spreadsheet.interaction.changeState({cells:i,stateName:On.BRUSH_SELECTED,onUpdateCells:this.onUpdateCells}),this.emitBrushSelectionEvent(Me.ROW_CELL_BRUSH_SELECTION,n)},t.prototype.addBrushIntercepts=function(){this.spreadsheet.interaction.addIntercepts([Ti.ROW_BRUSH_SELECTION])},t.prototype.getScrollBrushRangeCells=function(r){var n=this;return r.map(function(i){var a=n.getVisibleBrushRangeCells(i.id);return a||n.spreadsheet.facet.rowHeader.createCellInstance(i)})},t.prototype.getPrepareSelectMaskPosition=function(r){var n=this.spreadsheet.facet.panelBBox.minY,i=r.start.x,a=Math.max(r.start.y,n);return{x:i,y:a}},t}(Jk),lge=function(e){en(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.isMultiSelection=!1,r}return t.prototype.bindEvents=function(){this.bindKeyboardDown(),this.bindDataCellClick(),this.bindKeyboardUp(),this.bindMouseMove()},t.prototype.reset=function(){this.isMultiSelection=!1,this.spreadsheet.interaction.removeIntercepts([Ti.CLICK])},t.prototype.bindKeyboardDown=function(){var r=this;this.spreadsheet.on(Me.GLOBAL_KEYBOARD_DOWN,function(n){CR(n)&&(r.isMultiSelection=!0,r.spreadsheet.interaction.addIntercepts([Ti.CLICK]))})},t.prototype.bindKeyboardUp=function(){var r=this;this.spreadsheet.on(Me.GLOBAL_KEYBOARD_UP,function(n){CR(n)&&r.reset()})},t.prototype.bindMouseMove=function(){var r=this;this.spreadsheet.on(Me.GLOBAL_MOUSE_MOVE,function(n){r.isMultiSelection&&!Cot(n)&&r.reset()})},t.prototype.getSelectedCells=function(r){var n=r.getMeta().id,i=this.spreadsheet.interaction,a=i.getCells([Br.DATA_CELL]),o=[];return i.getCurrentStateName()!==On.SELECTED&&(a=[]),a.find(function(s){return s.id===n})?o=a.filter(function(s){return s.id!==n}):o=Vr(Vr([],lr(a),!1),[Hp(r)],!1),o},t.prototype.bindDataCellClick=function(){var r=this;this.spreadsheet.on(Me.DATA_CELL_CLICK,function(n){n.stopPropagation();var i=r.spreadsheet.getCell(n.target),a=i.getMeta(),o=r.spreadsheet.interaction;if(r.isMultiSelection&&a){var s=r.getSelectedCells(i);if(Or(s)){o.clearState(),r.spreadsheet.hideTooltip(),r.spreadsheet.emit(Me.GLOBAL_SELECTED,o.getActiveCells());return}o.addIntercepts([Ti.CLICK,Ti.HOVER]),r.spreadsheet.hideTooltip(),o.changeState({cells:s,stateName:On.SELECTED,onUpdateCells:Hk}),r.spreadsheet.emit(Me.GLOBAL_SELECTED,o.getActiveCells()),r.spreadsheet.showTooltipWithInfo(n,Xk(r.spreadsheet))}})},t}(Qd),uge=function(){function e(t){var r=this;this.canvasEventHandlers=[],this.s2EventHandlers=[],this.domEventListeners=[],this.isCanvasEffect=!1,this.isGuiIconShape=function(n){return n instanceof bN&&n.attrs.type===UC.type},this.onCanvasMousedown=function(n){if(r.target=n.target,r.spreadsheet.interaction.clearHoverTimer(),r.isResizeArea(n)){r.spreadsheet.emit(Me.LAYOUT_RESIZE_MOUSE_DOWN,n);var i=function(o){if(!r.spreadsheet.getCanvasElement())return!1;r.spreadsheet.getCanvasElement()!==o.target&&(n.clientX=o.clientX,n.clientY=o.clientY,n.originalEvent=o,r.spreadsheet.emit(Me.LAYOUT_RESIZE_MOUSE_MOVE,n))};window.addEventListener("mousemove",i),window.addEventListener("mouseup",function(){window.removeEventListener("mousemove",i)},{once:!0});return}var a=r.spreadsheet.getCellType(n.target);switch(a){case Br.DATA_CELL:r.spreadsheet.emit(Me.DATA_CELL_MOUSE_DOWN,n);break;case Br.ROW_CELL:r.spreadsheet.emit(Me.ROW_CELL_MOUSE_DOWN,n);break;case Br.COL_CELL:r.spreadsheet.emit(Me.COL_CELL_MOUSE_DOWN,n);break;case Br.CORNER_CELL:r.spreadsheet.emit(Me.CORNER_CELL_MOUSE_DOWN,n);break;case Br.MERGED_CELL:r.spreadsheet.emit(Me.MERGED_CELLS_MOUSE_DOWN,n);break}},this.onCanvasMousemove=function(n){if(r.canvasMousemoveEvent=n,r.isResizeArea(n)){r.activeResizeArea(n),r.spreadsheet.emit(Me.LAYOUT_RESIZE_MOUSE_MOVE,n);return}r.resetResizeArea();var i=r.spreadsheet.getCell(n.target);if(i){var a=i.cellType;switch(a){case Br.DATA_CELL:r.spreadsheet.emit(Me.DATA_CELL_MOUSE_MOVE,n);break;case Br.ROW_CELL:r.spreadsheet.emit(Me.ROW_CELL_MOUSE_MOVE,n);break;case Br.COL_CELL:r.spreadsheet.emit(Me.COL_CELL_MOUSE_MOVE,n);break;case Br.CORNER_CELL:r.spreadsheet.emit(Me.CORNER_CELL_MOUSE_MOVE,n);break;case Br.MERGED_CELL:r.spreadsheet.emit(Me.MERGED_CELLS_MOUSE_MOVE,n);break}if(!r.hasBrushSelectionIntercepts())switch(r.spreadsheet.emit(Me.GLOBAL_HOVER,n),a){case Br.DATA_CELL:r.spreadsheet.emit(Me.DATA_CELL_HOVER,n);break;case Br.ROW_CELL:r.spreadsheet.emit(Me.ROW_CELL_HOVER,n);break;case Br.COL_CELL:r.spreadsheet.emit(Me.COL_CELL_HOVER,n);break;case Br.CORNER_CELL:r.spreadsheet.emit(Me.CORNER_CELL_HOVER,n);break;case Br.MERGED_CELL:r.spreadsheet.emit(Me.MERGED_CELLS_HOVER,n);break}}},this.onCanvasMouseup=function(n){if(r.isResizeArea(n)){r.spreadsheet.emit(Me.LAYOUT_RESIZE_MOUSE_UP,n);return}var i=r.spreadsheet.getCell(n.target);if(i){var a=i.cellType;if(r.target===n.target){var o=r.isGuiIconShape(n.target);switch(a){case Br.DATA_CELL:r.spreadsheet.emit(Me.DATA_CELL_CLICK,n);break;case Br.ROW_CELL:if(o)break;r.spreadsheet.emit(Me.ROW_CELL_CLICK,n);break;case Br.COL_CELL:if(o)break;r.spreadsheet.emit(Me.COL_CELL_CLICK,n);break;case Br.CORNER_CELL:if(o)break;r.spreadsheet.emit(Me.CORNER_CELL_CLICK,n);break;case Br.MERGED_CELL:r.spreadsheet.emit(Me.MERGED_CELLS_CLICK,n);break}}switch(a){case Br.DATA_CELL:r.spreadsheet.emit(Me.DATA_CELL_MOUSE_UP,n);break;case Br.ROW_CELL:r.spreadsheet.emit(Me.ROW_CELL_MOUSE_UP,n);break;case Br.COL_CELL:r.spreadsheet.emit(Me.COL_CELL_MOUSE_UP,n);break;case Br.CORNER_CELL:r.spreadsheet.emit(Me.CORNER_CELL_MOUSE_UP,n);break;case Br.MERGED_CELL:r.spreadsheet.emit(Me.MERGED_CELLS_MOUSE_UP,n);break}}},this.onCanvasClick=function(n){r.spreadsheet.emit(Me.GLOBAL_CLICK,n)},this.onCanvasDoubleClick=function(n){var i=r.spreadsheet;if(r.isResizeArea(n)){i.emit(Me.LAYOUT_RESIZE_MOUSE_UP,n);return}i.emit(Me.GLOBAL_DOUBLE_CLICK,n);var a=i.getCell(n.target);if(a){var o=a.cellType;if(r.target===n.target)switch(o){case Br.DATA_CELL:i.emit(Me.DATA_CELL_DOUBLE_CLICK,n);break;case Br.ROW_CELL:i.emit(Me.ROW_CELL_DOUBLE_CLICK,n);break;case Br.COL_CELL:i.emit(Me.COL_CELL_DOUBLE_CLICK,n);break;case Br.CORNER_CELL:i.emit(Me.CORNER_CELL_DOUBLE_CLICK,n);break;case Br.MERGED_CELL:i.emit(Me.MERGED_CELLS_DOUBLE_CLICK,n);break}}},this.onCanvasMouseout=function(n){if(!(!r.isAutoResetSheetStyle||n!=null&&n.shape)){var i=r.spreadsheet.interaction;!i.isSelectedState()&&!(i.intercepts.size>0)&&i.reset()}},this.onCanvasContextMenu=function(n){var i=r.spreadsheet;if(r.isResizeArea(n)){i.emit(Me.LAYOUT_RESIZE_MOUSE_UP,n);return}i.emit(Me.GLOBAL_CONTEXT_MENU,n);var a=r.spreadsheet.getCellType(n.target);switch(a){case Br.DATA_CELL:r.spreadsheet.emit(Me.DATA_CELL_CONTEXT_MENU,n);break;case Br.ROW_CELL:r.spreadsheet.emit(Me.ROW_CELL_CONTEXT_MENU,n);break;case Br.COL_CELL:r.spreadsheet.emit(Me.COL_CELL_CONTEXT_MENU,n);break;case Br.CORNER_CELL:r.spreadsheet.emit(Me.CORNER_CELL_CONTEXT_MENU,n);break;case Br.MERGED_CELL:r.spreadsheet.emit(Me.MERGED_CELLS_CONTEXT_MENU,n);break}},this.spreadsheet=t,this.bindEvents()}return Object.defineProperty(e.prototype,"canvasContainer",{get:function(){return this.spreadsheet.container},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isAutoResetSheetStyle",{get:function(){return this.spreadsheet.options.interaction.autoResetSheetStyle},enumerable:!1,configurable:!0}),e.prototype.bindEvents=function(){var t=this;this.clearAllEvents(),this.addCanvasEvent(tc.CLICK,this.onCanvasClick),this.addCanvasEvent(tc.MOUSE_DOWN,this.onCanvasMousedown),this.addCanvasEvent(tc.MOUSE_MOVE,this.onCanvasMousemove),this.addCanvasEvent(tc.MOUSE_OUT,this.onCanvasMouseout),this.addCanvasEvent(tc.MOUSE_UP,this.onCanvasMouseup),this.addCanvasEvent(tc.DOUBLE_CLICK,this.onCanvasDoubleClick),this.addCanvasEvent(tc.CONTEXT_MENU,this.onCanvasContextMenu),this.addS2Event(Me.GLOBAL_ACTION_ICON_CLICK,function(){t.spreadsheet.interaction.addIntercepts([Ti.HOVER]),t.spreadsheet.interaction.clearState()}),this.addDomEventListener(window,tc.CLICK,function(r){t.resetSheetStyle(r),t.isCanvasEffect=t.isMouseOnTheCanvasContainer(r)}),this.addDomEventListener(window,tc.KEY_DOWN,function(r){t.onKeyboardCopy(r),t.onKeyboardEsc(r),t.spreadsheet.emit(Me.GLOBAL_KEYBOARD_DOWN,r)}),this.addDomEventListener(window,tc.KEY_UP,function(r){t.spreadsheet.emit(Me.GLOBAL_KEYBOARD_UP,r)}),this.addDomEventListener(window,tc.MOUSE_UP,function(r){t.spreadsheet.emit(Me.GLOBAL_MOUSE_UP,r)}),this.addDomEventListener(window,tc.MOUSE_MOVE,function(r){t.spreadsheet.emit(Me.GLOBAL_MOUSE_MOVE,r)})},e.prototype.onKeyboardCopy=function(t){if(this.isCanvasEffect&&this.spreadsheet.options.interaction.enableCopy&&gX(t.key,Pu.COPY)&&(t.metaKey||t.ctrlKey)){var r=Yfe(this.spreadsheet);bl(r)||this.spreadsheet.emit(Me.GLOBAL_COPIED,r)}},e.prototype.onKeyboardEsc=function(t){this.isCanvasEffect&&gX(t.key,Pu.ESC)&&this.resetSheetStyle(t)},e.prototype.resetSheetStyle=function(t){if(!(!this.isAutoResetSheetStyle||!this.spreadsheet)){var r=this.spreadsheet.interaction;if(r.hasIntercepts([Ti.BRUSH_SELECTION,Ti.COL_BRUSH_SELECTION,Ti.ROW_BRUSH_SELECTION])){r.removeIntercepts([Ti.BRUSH_SELECTION,Ti.ROW_BRUSH_SELECTION,Ti.COL_BRUSH_SELECTION]);return}this.isMouseOnTheTooltip(t)||this.isMouseOnTheCanvasContainer(t)||(r.reset(),this.spreadsheet.emit(Me.GLOBAL_RESET,t),this.spreadsheet.emit(Me.GLOBAL_SELECTED,r.getActiveCells()))}},e.prototype.isMouseEvent=function(t){return l_(t,"clientX")&&l_(t,"clientY")},e.prototype.isMouseOnTheCanvasContainer=function(t){if(this.isMouseEvent(t)){var r=this.spreadsheet.getCanvasElement();if(!r)return!1;if(this.spreadsheet.options.supportCSSTransform)return r.contains(t.target);var n=r.getBoundingClientRect()||{},i=n.x,a=n.y,o=this.getContainerRect(),s=o.width,l=o.height;return r.contains(t.target)&&t.clientX<=i+s&&t.clientY<=a+l}return!1},e.prototype.getContainerRect=function(){var t,r=this.spreadsheet,n=r.facet,i=r.options,a=(n==null?void 0:n.hRowScrollBar)||(n==null?void 0:n.hScrollBar),o=(n==null?void 0:n.panelBBox)||{},s=o.maxX,l=o.maxY,u=i.width,c=i.height,f=((t=a==null?void 0:a.theme)===null||t===void 0?void 0:t.size)||0;return{width:Math.min(u,s),height:Math.min(c,l+f)}},e.prototype.isMouseOnTheTooltip=function(t){var r,n,i,a,o=this.spreadsheet.tooltip;if(!(o!=null&&o.visible))return!1;var s=((i=(n=(r=this.spreadsheet.tooltip)===null||r===void 0?void 0:r.container)===null||n===void 0?void 0:n.getBoundingClientRect)===null||i===void 0?void 0:i.call(n))||{},l=s.x,u=s.y,c=s.width,f=s.height;return t.target instanceof Node?cve((a=this.spreadsheet.tooltip)===null||a===void 0?void 0:a.container,t.target):this.isMouseEvent(t)?t.clientX>=l&&t.clientX<=l+c&&t.clientY>=u&&t.clientY<=u+f:!1},e.prototype.isResizeArea=function(t){var r=ii(t.target,"attrs.appendInfo");return r==null?void 0:r.isResizeArea},e.prototype.activeResizeArea=function(t){this.resetResizeArea();var r=t.target;this.spreadsheet.store.set("activeResizeArea",r),r.attr(Mh.backgroundOpacity,this.spreadsheet.theme.resizeArea.interactionState.hover.backgroundOpacity)},e.prototype.resetResizeArea=function(){var t=this.spreadsheet.store.get("activeResizeArea");Or(t)||t.attr(Mh.backgroundOpacity,this.spreadsheet.theme.resizeArea.backgroundOpacity),this.spreadsheet.store.set("activeResizeArea",t)},e.prototype.hasBrushSelectionIntercepts=function(){return this.spreadsheet.interaction.hasIntercepts([Ti.HOVER,Ti.BRUSH_SELECTION,Ti.ROW_BRUSH_SELECTION,Ti.COL_BRUSH_SELECTION])},e.prototype.clear=function(){this.unbindEvents()},e.prototype.unbindEvents=function(){this.clearAllEvents()},e.prototype.addCanvasEvent=function(t,r){var n;(n=this.canvasContainer)===null||n===void 0||n.on(t,r),this.canvasEventHandlers.push({type:t,handler:r})},e.prototype.addS2Event=function(t,r){this.spreadsheet.on(t,r),this.s2EventHandlers.push({type:t,handler:r})},e.prototype.addDomEventListener=function(t,r,n){if(t.addEventListener){var i=this.spreadsheet.options.interaction.eventListenerOptions;t.addEventListener(r,n,i),this.domEventListeners.push({target:t,type:r,handler:n,options:i})}else console.error("Please make sure ".concat(t," has addEventListener function"))},e.prototype.clearAllEvents=function(){var t=this;xi(this.canvasEventHandlers,function(r){var n,i=r.type,a=r.handler;(n=t.canvasContainer)===null||n===void 0||n.off(i,a)}),xi(this.s2EventHandlers,function(r){var n=r.type,i=r.handler;t.spreadsheet.off(n,i)}),xi(this.domEventListeners,function(r){r.target.removeEventListener(r.type,r.handler,r.options)}),this.canvasEventHandlers=[],this.s2EventHandlers=[],this.domEventListeners=[]},e}(),cge=function(e){en(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.isRangeSelection=!1,r.handleColClick=function(n){n.stopPropagation();var i=r.spreadsheet.interaction,a=r.spreadsheet.getCell(n.target),o=a==null?void 0:a.getMeta();if(!bl(o==null?void 0:o.x)){i.addIntercepts([Ti.HOVER]);var s=[Hp(a)],l=r.spreadsheet.store.get("lastClickedCell");if(r.isRangeSelection&&l&&l.cellType===a.cellType&&l.getMeta().level===a.getMeta().level){var u=lr([r.spreadsheet.facet.layoutResult.rowsHierarchy.maxLevel,r.spreadsheet.facet.layoutResult.colsHierarchy.maxLevel],2),c=u[0],f=u[1],d=SB(l.getMeta(),a.getMeta()),v=d.start,g=d.end;a instanceof _0?s=r.handleSeriesNumberRowSelected(v.rowIndex,g.rowIndex,a):a.cellType===Br.ROW_CELL&&a.getMeta().level===c?s=r.handleRowSelected(v.rowIndex,g.rowIndex,a):a.cellType===Br.COL_CELL&&a.getMeta().level===f&&(s=r.handleColSelected(v.colIndex,g.colIndex,a)),i.changeState({cells:s,stateName:On.SELECTED})}else Or(i.getCells())&&i.removeIntercepts([Ti.HOVER]),r.spreadsheet.store.set("lastClickedCell",a);var x=s.map(function(w){var S=w.id;return S});i.updateCells(i.getRowColActiveCells(x)),r.spreadsheet.emit(Me.GLOBAL_SELECTED,i.getActiveCells())}},r}return t.prototype.bindEvents=function(){this.bindKeyboardDown(),this.bindDataCellClick(),this.bindColCellClick(),this.bindKeyboardUp(),this.bindMouseMove()},t.prototype.reset=function(){this.isRangeSelection=!1,this.spreadsheet.interaction.removeIntercepts([Ti.CLICK])},t.prototype.bindKeyboardDown=function(){var r=this;this.spreadsheet.on(Me.GLOBAL_KEYBOARD_DOWN,function(n){n.key===Pu.SHIFT&&(r.isRangeSelection=!0,r.spreadsheet.interaction.addIntercepts([Ti.CLICK]))})},t.prototype.bindKeyboardUp=function(){var r=this;this.spreadsheet.on(Me.GLOBAL_KEYBOARD_UP,function(n){n.key===Pu.SHIFT&&r.reset()})},t.prototype.bindMouseMove=function(){var r=this;this.spreadsheet.on(Me.GLOBAL_MOUSE_MOVE,function(n){r.isRangeSelection&&!n.shiftKey&&r.reset()})},t.prototype.bindColCellClick=function(){var r=this;this.spreadsheet.isTableMode()&&this.spreadsheet.on(Me.ROW_CELL_CLICK,function(n){r.handleColClick(n)}),this.spreadsheet.on(Me.COL_CELL_CLICK,function(n){r.handleColClick(n)})},t.prototype.bindDataCellClick=function(){var r=this;this.spreadsheet.on(Me.DATA_CELL_CLICK,function(n){n.stopPropagation();var i=r.spreadsheet.getCell(n.target),a=i.getMeta(),o=r.spreadsheet.interaction;if(a){var s=r.spreadsheet.store.get("lastClickedCell"),l=r.isRangeSelection&&(s==null?void 0:s.cellType)===i.cellType;if(!l){r.spreadsheet.store.set("lastClickedCell",i);return}var u=SB(s.getMeta(),i.getMeta()),c=u.start,f=u.end,d=_x(c.colIndex,f.colIndex+1).flatMap(function(v){var g=r.spreadsheet.facet.layoutResult.colLeafNodes[v].id;return _x(c.rowIndex,f.rowIndex+1).map(function(x){var w=r.spreadsheet.facet.getSeriesNumberWidth()||r.spreadsheet.isTableMode()?String(x):r.spreadsheet.facet.layoutResult.rowLeafNodes[x].id;return{id:w+"-"+g,colIndex:v,rowIndex:x,type:i.cellType}})});o.addIntercepts([Ti.CLICK,Ti.HOVER]),o.changeState({cells:d,stateName:On.SELECTED}),r.spreadsheet.showTooltipWithInfo(n,Xk(r.spreadsheet)),r.spreadsheet.emit(Me.GLOBAL_SELECTED,o.getActiveCells())}})},t.prototype.handleSeriesNumberRowSelected=function(r,n,i){var a=this.spreadsheet.facet.layoutResult.colLeafNodes[0].id;return _x(r,n+1).map(function(o){var s=String(o);return{id:s+"-"+a,colIndex:0,rowIndex:o,type:i.cellType}})},t.prototype.handleRowSelected=function(r,n,i){return this.spreadsheet.facet.layoutResult.rowNodes.filter(function(a){var o=a.rowIndex;return lB(o,r,n+1)}).map(function(a){return{id:a.id,colIndex:a.colIndex,rowIndex:a.rowIndex,type:i.cellType}})},t.prototype.handleColSelected=function(r,n,i){return this.spreadsheet.facet.layoutResult.colLeafNodes.filter(function(a){var o=a.colIndex;return lB(o,r,n+1)}).map(function(a){return{id:a.id,colIndex:a.colIndex,rowIndex:a.rowIndex,type:i.cellType}})},t}(Qd),hge=function(e){en(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.resizeStartPosition={},r.resizeMouseMove=function(n){var i,a;if(!((i=r.resizeReferenceGroup)===null||i===void 0)&&i.get("visible")){(a=n==null?void 0:n.preventDefault)===null||a===void 0||a.call(n);var o=n.originalEvent,s=r.getResizeInfo(),l=r.resizeReferenceGroup.getChildren()||[];if(!Or(l)){var u=lr(l,2),c=u[1],f=lr(FS(c.attr("path")),2),d=f[0],v=f[1];s.type===Uf.Horizontal?r.updateHorizontalResizingEndGuideLinePosition(o,s,d,v):r.updateVerticalResizingEndGuideLinePosition(o,s,d,v),r.updateResizeGuideLineTheme(c),c.attr("path",[d,v])}}},r}return t.prototype.bindEvents=function(){this.bindMouseDown(),this.bindMouseMove(),this.bindMouseUp()},t.prototype.initResizeGroup=function(){if(!this.resizeReferenceGroup){this.resizeReferenceGroup=this.spreadsheet.foregroundGroup.addGroup();var r=this.spreadsheet.options,n=r.width,i=r.height,a=this.getResizeAreaTheme(),o=a.guideLineColor,s=a.guideLineDash,l=a.size,u={path:"",lineDash:s,stroke:o,lineWidth:l};this.resizeReferenceGroup.addShape("path",{id:eYt,attrs:u}),this.resizeReferenceGroup.addShape("path",{id:rYt,attrs:u}),this.resizeReferenceGroup.addShape("rect",{id:nYt,attrs:{appendInfo:{isResizeArea:!0},x:0,y:0,width:n,height:i,fill:"transparent"}})}},t.prototype.getResizeAreaTheme=function(){return this.spreadsheet.theme.resizeArea},t.prototype.setResizeTarget=function(r){this.resizeTarget=r},t.prototype.getGuideLineWidthAndHeight=function(){var r=this.spreadsheet.options,n=r.width,i=r.height,a=this.spreadsheet.facet.panelBBox,o=a.maxY,s=a.maxX,l=Math.min(s,n),u=Math.min(o,i);return{width:l,height:u}},t.prototype.getResizeShapes=function(){var r;return((r=this.resizeReferenceGroup)===null||r===void 0?void 0:r.get("children"))||[]},t.prototype.setResizeMaskCursor=function(r){var n=lr(this.getResizeShapes(),3),i=n[2];i==null||i.attr("cursor",r)},t.prototype.updateResizeGuideLinePosition=function(r,n){var i=this.getResizeShapes();if(!Or(i)){var a=lr(i,2),o=a[0],s=a[1],l=n.type,u=n.offsetX,c=n.offsetY,f=n.width,d=n.height,v=this.getGuideLineWidthAndHeight(),g=v.width,x=v.height;if(this.setResizeMaskCursor("".concat(l,"-resize")),l===Uf.Horizontal){o.attr("path",[["M",u,c],["L",u,x]]),s.attr("path",[["M",u+f,c],["L",u+f,x]]),this.resizeStartPosition.offsetX=r.offsetX,this.resizeStartPosition.clientX=r.clientX;return}o.attr("path",[["M",u,c],["L",g,c]]),s.attr("path",[["M",u,c+d],["L",g,c+d]]),this.resizeStartPosition.offsetY=r.offsetY,this.resizeStartPosition.clientY=r.clientY}},t.prototype.bindMouseDown=function(){var r=this;this.spreadsheet.on(Me.LAYOUT_RESIZE_MOUSE_DOWN,function(n){var i;(i=n==null?void 0:n.preventDefault)===null||i===void 0||i.call(n);var a=n.target,o=n.originalEvent,s=r.getCellAppendInfo(n.target);r.spreadsheet.store.set("resized",!1),s!=null&&s.isResizeArea&&(r.spreadsheet.interaction.reset(),r.spreadsheet.interaction.addIntercepts([Ti.RESIZE]),r.setResizeTarget(a),r.showResizeGroup(),r.updateResizeGuideLinePosition(o,s))})},t.prototype.bindMouseMove=function(){var r=this;this.spreadsheet.on(Me.LAYOUT_RESIZE_MOUSE_MOVE,function(n){Ek(r.resizeMouseMove,33)(n)})},t.prototype.getResizeGuideLinePosition=function(){var r=lr(this.resizeReferenceGroup.getChildren()||[],2),n=r[0],i=r[1],a=(n==null?void 0:n.attr("path"))||[],o=(i==null?void 0:i.attr("path"))||[],s=lr(a[0]||[],3),l=s[1],u=l===void 0?0:l,c=s[2],f=c===void 0?0:c,d=lr(o[0]||[],3),v=d[1],g=v===void 0?0:v,x=d[2],w=x===void 0?0:x;return{start:{x:u,y:f},end:{x:g,y:w}}},t.prototype.getDisAllowResizeInfo=function(){var r,n=this.getResizeInfo(),i=this.spreadsheet.options.interaction.resize,a=n.width,o=n.height,s=n.resizedWidth,l=n.resizedHeight,u=(r=i==null?void 0:i.disable)===null||r===void 0?void 0:r.call(i,n),c=u?a:s,f=u?o:l;return{displayWidth:c,displayHeight:f,isDisabled:u}},t.prototype.getResizeWidthDetail=function(){var r,n,i=this.getResizeInfo(),a=this.getDisAllowResizeInfo().displayWidth;switch(i.effect){case rc.Field:return{eventType:Me.LAYOUT_RESIZE_ROW_WIDTH,style:{rowCfg:{widthByField:(r={},r[i.id]=a,r)}}};case rc.Tree:return{eventType:Me.LAYOUT_RESIZE_TREE_WIDTH,style:{treeRowsWidth:a,rowCfg:{treeRowsWidth:a}}};case rc.Cell:return{eventType:Me.LAYOUT_RESIZE_COL_WIDTH,style:{colCfg:{widthByFieldValue:(n={},n[i.id]=a,n)}}};case rc.Series:return{eventType:Me.LAYOUT_RESIZE_SERIES_WIDTH,seriesNumberWidth:a};default:return null}},t.prototype.getResizeHeightDetail=function(){var r,n,i=this.spreadsheet.options,a=i.interaction.resize,o=i.style.rowCfg.heightByField,s=this.spreadsheet.theme.rowCell.cell.padding,l=this.getResizeInfo(),u=this.getDisAllowResizeInfo().displayHeight,c=u-s.top-s.bottom,f;switch(l.effect){case rc.Field:return{eventType:Me.LAYOUT_RESIZE_COL_HEIGHT,style:{colCfg:{heightByField:(r={},r[l.id]=u,r)}}};case rc.Cell:return o!=null&&o[String(l.id)]||(a==null?void 0:a.rowResizeType)===cR.CURRENT?f={rowCfg:{heightByField:(n={},n[l.id]=c,n)}}:f={cellCfg:{height:c}},{eventType:Me.LAYOUT_RESIZE_ROW_HEIGHT,style:f};default:return null}},t.prototype.getResizeDetail=function(){var r=this.getResizeInfo();return r.type===Uf.Horizontal?this.getResizeWidthDetail():this.getResizeHeightDetail()},t.prototype.showResizeGroup=function(){this.initResizeGroup(),this.resizeReferenceGroup.set("visible",!0)},t.prototype.hideResizeGroup=function(){this.resizeReferenceGroup.set("visible",!1)},t.prototype.bindMouseUp=function(){var r=this;this.spreadsheet.on(Me.GLOBAL_MOUSE_UP,function(){var n;r.setResizeMaskCursor("default"),!(!r.resizeReferenceGroup||Or((n=r.resizeReferenceGroup)===null||n===void 0?void 0:n.getChildren()))&&(r.hideResizeGroup(),r.renderResizedResult())})},t.prototype.updateResizeGuideLineTheme=function(r){var n=this.getResizeAreaTheme(),i=n.guideLineColor,a=n.guideLineDisableColor,o=this.getDisAllowResizeInfo().isDisabled;r.attr("stroke",o?a:i),this.setResizeMaskCursor(o?"no-drop":"default")},t.prototype.updateHorizontalResizingEndGuideLinePosition=function(r,n,i,a){var o=r.clientX-this.resizeStartPosition.clientX;n.width+o<VG&&(o=-(n.width-VG));var s=n.offsetX+n.width+o;i[1]=s,a[1]=s,this.resizeTarget.attr({x:s-n.size/2})},t.prototype.updateVerticalResizingEndGuideLinePosition=function(r,n,i,a){var o=r.clientY-this.resizeStartPosition.clientY;n.height+o<GG&&(o=-(n.height-GG));var s=n.offsetY+n.height+o;i[2]=s,a[2]=s,this.resizeTarget.attr({y:s-n.size/2})},t.prototype.renderResizedResult=function(){var r=this.getResizeInfo(),n=this.getResizeDetail()||{},i=n.style,a=n.seriesNumberWidth,o=n.eventType,s={info:r,style:i};this.spreadsheet.emit(Me.LAYOUT_RESIZE,s),this.spreadsheet.emit(o,s),i&&this.spreadsheet.setOptions({style:i}),a&&this.spreadsheet.setTheme({rowCell:{seriesNumberWidth:a}}),this.spreadsheet.store.set("resized",!0),this.render()},t.prototype.getResizeInfo=function(){var r=this.getCellAppendInfo(this.resizeTarget),n=this.getResizeGuideLinePosition(),i=n.start,a=n.end,o=Math.floor(a.x-i.x),s=Math.floor(a.y-i.y);return Zt(Zt({},r),{resizedWidth:o,resizedHeight:s})},t.prototype.render=function(){this.resizeStartPosition={},this.resizeTarget=null,this.resizeReferenceGroup=null,this.spreadsheet.render(!1)},t}(Qd),fge=[Pu.ARROW_LEFT,Pu.ARROW_RIGHT,Pu.ARROW_UP,Pu.ARROW_DOWN],dge=function(e){en(t,e);function t(r){return e.call(this,r)||this}return t.prototype.isCanvasEffect=function(){return this.spreadsheet.interaction.eventController.isCanvasEffect},t.prototype.bindEvents=function(){var r=this;this.spreadsheet.on(Me.GLOBAL_KEYBOARD_DOWN,function(n){if(r.isCanvasEffect()){var i=n.shiftKey,a=n.metaKey,o=fge.includes(n.key),s=!1,l=!1,u=!1;o&&(a&&i?(s=!1,l=!0,u=!1):a?(s=!0,l=!0,u=!0):i?(s=!1,l=!1,u=!1):(s=!0,l=!1,u=!0),r.handleMove({event:n,changeStartCell:s,isJumpMode:l,isSingleSelection:u}))}}),this.spreadsheet.on(Me.DATA_CELL_CLICK,function(n){var i=r.spreadsheet.getCell(n.target).getMeta();i&&(r.startCell=r.getCellMetaFromViewMeta(i),r.endCell=r.startCell)})},t.prototype.getCellMetaFromViewMeta=function(r){return{rowIndex:r.rowIndex,colIndex:r.colIndex,id:r.id,type:Br.DATA_CELL}},t.prototype.handleMove=function(r){var n=r.event,i=r.changeStartCell,a=r.isJumpMode,o=r.isSingleSelection,s=this,l=s.spreadsheet,u=s.startCell,c=s.endCell,f=i?u:c,d=this.getMoveInfo(n.key,f,a);if(d){var v=lr([d.row,d.col],2),g=v[0],x=v[1];this.scrollToActiveCell(l,g,x);var w=this.generateCellMeta(l,g,x),S=o?[w]:this.getRangeCells(l,u,w);qde(l,S),i&&(this.startCell=w),this.endCell=w,this.spreadsheet.emit(Me.DATA_CELL_SELECT_MOVE,S)}},t.prototype.generateCellMeta=function(r,n,i){var a=r.isTableMode,o=r.facet.layoutResult,s=o.colLeafNodes,l=o.rowLeafNodes,u=a()?String(n):l[n].id,c=s[i].id;return{rowIndex:n,colIndex:i,id:WS(u,c),type:Br.DATA_CELL}},t.prototype.getRangeCells=function(r,n,i){for(var a=SB(n,i),o=a.start,s=o.rowIndex,l=o.colIndex,u=a.end,c=u.rowIndex,f=u.colIndex,d=[],v=s;v<=c;v++)for(var g=l;g<=f;g++)d.push(this.generateCellMeta(r,v,g));return d},t.prototype.getMoveInfo=function(r,n,i){var a=this.spreadsheet,o=a.options,s=o.frozenColCount,l=s===void 0?0:s,u=o.frozenRowCount,c=u===void 0?0:u,f=o.frozenTrailingColCount,d=f===void 0?0:f,v=o.frozenTrailingRowCount,g=v===void 0?0:v,x=a.facet.layoutResult,w=x.rowLeafNodes,S=x.colLeafNodes,A=lr([0+l,S.length-d-1],2),M=A[0],R=A[1],O=lr([0+c,(a.isTableMode()?a.dataSet.getDisplayDataSet().length:w.length)-g-1],2),N=O[0],k=O[1];if(n)switch(r){case Pu.ARROW_RIGHT:return n.colIndex+1>R?void 0:{row:n.rowIndex,col:i?R:n.colIndex+1};case Pu.ARROW_LEFT:return n.colIndex-1<M?void 0:{row:n.rowIndex,col:i?M:n.colIndex-1};case Pu.ARROW_UP:return n.rowIndex-1<N?void 0:{row:i?N:n.rowIndex-1,col:n.colIndex};case Pu.ARROW_DOWN:return n.rowIndex+1>k?void 0:{row:i?k:n.rowIndex+1,col:n.colIndex}}},t.prototype.calculateOffset=function(r,n,i){var a=r.options,o=a.frozenRowCount,s=o===void 0?0:o,l=a.frozenTrailingRowCount,u=l===void 0?0:l,c=r.facet,f=r.frozenColGroup,d=r.frozenTrailingColGroup,v=r.frozenRowGroup,g=r.frozenTrailingRowGroup,x=c.layoutResult.colLeafNodes,w=c.getScrollOffset(),S=w.scrollX,A=w.scrollY,M=c.panelBBox,R=M.viewportHeight,O=M.viewportWidth,N=ii(r,"theme.splitLine"),k=f?Math.floor(f.getBBox().width-N.verticalBorderWidth/2):0,V=d?Math.floor(d.getBBox().width):0,Q=v?Math.floor(v.getBBox().height-N.horizontalBorderWidth/2):0,Y=g?Math.floor(g.getBBox().height):0,X=Lk(S,A,c.viewCellWidths,c.viewCellHeights,{width:O-k-V,height:R-Q-Y,x:k,y:Q},c.getRealScrollX(c.cornerBBox.width)),tt=-1,it=-1,Et=x.find(function(pt){return pt.colIndex===i});if(i<=X[0]?tt=Et.x-k:i>=X[1]&&i<x.length-u&&(tt=Et.x+Et.width-O+V),n<=X[2])it=c.viewCellHeights.getCellOffsetY(n-s);else if(n>=X[3]){var Tt=c.viewCellHeights.getCellOffsetY(n+1);it=Tt+Y-R}return{offsetX:tt,offsetY:it}},t.prototype.scrollToActiveCell=function(r,n,i){var a=this.calculateOffset(r,n,i),o=a.offsetX,s=a.offsetY,l=r.facet,u=r.facet.getScrollOffset(),c=u.scrollX,f=u.scrollY;l.scrollWithAnimation({offsetX:{value:o>-1?o:c},offsetY:{value:s>-1?s:f}})},t}(Qd),pge=function(){function e(t){var r=this;this.interactions=new Map,this.intercepts=new Set,this.hoverTimer=null,this.defaultState={cells:[],force:!1},this.onTriggerInteractionsResetEffect=function(){r.interactions.forEach(function(n){n.reset()})},this.selectAll=function(){r.changeState({stateName:On.ALL_SELECTED})},this.getCellChildrenNodes=function(n){var i,a=(i=n==null?void 0:n.getMeta)===null||i===void 0?void 0:i.call(n),o=(n==null?void 0:n.cellType)===Br.ROW_CELL,s=r.spreadsheet.isHierarchyTreeType();return s&&o?su.getAllLeaveNodes(a).filter(function(l){return l.rowIndex===a.rowIndex}):su.getAllChildrenNodes(a)},this.selectHeaderCell=function(n){var i;n===void 0&&(n={});var a=n.cell;if(!Or(a)){var o=(i=a==null?void 0:a.getMeta)===null||i===void 0?void 0:i.call(a);if(!(!o||bl(o==null?void 0:o.x))){r.addIntercepts([Ti.HOVER]);var s=r.spreadsheet.isHierarchyTreeType(),l=(a==null?void 0:a.cellType)===Br.COL_CELL,u=r.getState(),c=r.isSelectedCell(a),f=(n==null?void 0:n.isMultiSelection)&&r.isSelectedState(),d=c?[]:r.getCellChildrenNodes(a),v=c?[]:[Hp(a)];if(f&&(v=J1(u==null?void 0:u.cells,v),d=J1(u==null?void 0:u.nodes,d),c&&(v=v.filter(function(x){var w=x.id;return w!==o.id}),d=d.filter(function(x){return!(x!=null&&x.id.includes(o.id))}))),Or(v)){r.reset(),r.spreadsheet.emit(Me.GLOBAL_SELECTED,r.getActiveCells());return}r.changeState({cells:v,nodes:d,stateName:On.SELECTED});var g=v.map(function(x){var w=x.id;return w});return r.updateCells(r.getRowColActiveCells(g)),(!s||l)&&r.highlightNodes(d),r.spreadsheet.emit(Me.GLOBAL_SELECTED,r.getActiveCells()),!0}}},this.highlightNodes=function(n){n===void 0&&(n=[]),n.forEach(function(i){var a;(a=i==null?void 0:i.belongsCell)===null||a===void 0||a.updateByState(On.SELECTED,i.belongsCell)})},this.mergeCells=function(n,i){fde(r.spreadsheet,n,i)},this.unmergeCell=function(n){pde(r.spreadsheet,n)},this.spreadsheet=t,this.registerEventController(),this.registerInteractions(),window.addEventListener("visibilitychange",this.onTriggerInteractionsResetEffect)}return e.prototype.destroy=function(){this.interactions.clear(),this.intercepts.clear(),this.eventController.clear(),this.clearHoverTimer(),this.resetState(),window.removeEventListener("visibilitychange",this.onTriggerInteractionsResetEffect)},e.prototype.reset=function(){this.clearState(),this.clearHoverTimer(),this.intercepts.clear(),this.spreadsheet.hideTooltip()},e.prototype.setState=function(t){Qde(this.spreadsheet,t)},e.prototype.getState=function(){return this.spreadsheet.store.get(KF)||this.defaultState},e.prototype.setInteractedCells=function(t){var r=this.getInteractedCells().concat([t]),n=this.getState();n.interactedCells=r,this.setState(n)},e.prototype.getInteractedCells=function(){var t=this.getState();return(t==null?void 0:t.interactedCells)||[]},e.prototype.resetState=function(){this.spreadsheet.store.set(KF,this.defaultState)},e.prototype.getCurrentStateName=function(){return this.getState().stateName},e.prototype.isEqualStateName=function(t){return this.getCurrentStateName()===t},e.prototype.isStateOf=function(t){var r=this.getState();return(r==null?void 0:r.stateName)===t},e.prototype.isSelectedState=function(){return this.isStateOf(On.SELECTED)||this.isStateOf(On.BRUSH_SELECTED)},e.prototype.isAllSelectedState=function(){return this.isStateOf(On.ALL_SELECTED)},e.prototype.isHoverFocusState=function(){return this.isStateOf(On.HOVER_FOCUS)},e.prototype.isHoverState=function(){return this.isStateOf(On.HOVER)},e.prototype.isActiveCell=function(t){return!!this.getCells().find(function(r){return t.getMeta().id===r.id})},e.prototype.isSelectedCell=function(t){return this.isSelectedState()&&this.isActiveCell(t)},e.prototype.getCells=function(t){var r=this.getState(),n=(r==null?void 0:r.cells)||[];return bl(t)?n:n.filter(function(i){return t.includes(i.type)})},e.prototype.getActiveCells=function(){var t=this.getCells().map(function(n){return n.id}),r=this.getAllCells();return ia(t,function(n){return zu(r,function(i){var a;return((a=i==null?void 0:i.getMeta())===null||a===void 0?void 0:a.id)===n})}).filter(function(n){return n})},e.prototype.clearStyleIndependent=function(){!this.isSelectedState()&&!this.isHoverState()&&!this.isAllSelectedState()||this.getPanelGroupAllDataCells().forEach(function(t){t.hideInteractionShape()})},e.prototype.getPanelGroupAllUnSelectedDataCells=function(){var t=this;return this.getPanelGroupAllDataCells().filter(function(r){return!t.isActiveCell(r)})},e.prototype.getPanelGroupAllDataCells=function(){var t;return Xw((t=this.spreadsheet.panelGroup)===null||t===void 0?void 0:t.getChildren(),_0)},e.prototype.getAllRowHeaderCells=function(){var t,r,n=((t=this.spreadsheet.foregroundGroup)===null||t===void 0?void 0:t.getChildren())||[],i=n.find(function(o){return o instanceof Qk&&!(o instanceof Jot)}),a=((r=i==null?void 0:i.cfg)===null||r===void 0?void 0:r.children)||[];return Xw(a,jS).filter(function(o){return o.cellType===Br.ROW_CELL})},e.prototype.getAllColHeaderCells=function(){var t,r,n=((t=this.spreadsheet.foregroundGroup)===null||t===void 0?void 0:t.getChildren())||[],i=n.find(function(o){return o instanceof Kk}),a=((r=i==null?void 0:i.cfg)===null||r===void 0?void 0:r.children)||[];return Xw(a,_3).filter(function(o){return o.cellType===Br.COL_CELL})},e.prototype.getRowColActiveCells=function(t){return J1(this.getAllRowHeaderCells(),this.getAllColHeaderCells()).filter(function(r){return t.includes(r.getMeta().id)})},e.prototype.getAllCells=function(){return J1(this.getPanelGroupAllDataCells(),this.getAllRowHeaderCells(),this.getAllColHeaderCells())},e.prototype.hideColumns=function(t,r){t===void 0&&(t=[]),r===void 0&&(r=!0),Nk(this.spreadsheet,t,r)},e.prototype.getBrushSelectionInfo=function(t){var r,n,i;return Dp(t)?{dataBrushSelection:t,rowBrushSelection:t,colBrushSelection:t}:{dataBrushSelection:(r=t==null?void 0:t.data)!==null&&r!==void 0?r:!1,rowBrushSelection:(n=t==null?void 0:t.row)!==null&&n!==void 0?n:!1,colBrushSelection:(i=t==null?void 0:t.col)!==null&&i!==void 0?i:!1}},e.prototype.getDefaultInteractions=function(){var t=this.spreadsheet.options.interaction,r=t.resize,n=t.brushSelection,i=t.multiSelection,a=t.rangeSelection,o=t.selectedCellMove,s=this.getBrushSelectionInfo(n),l=s.dataBrushSelection,u=s.rowBrushSelection,c=s.colBrushSelection;return[{key:Ju.CORNER_CELL_CLICK,interaction:nge},{key:Ju.DATA_CELL_CLICK,interaction:Jve},{key:Ju.ROW_COLUMN_CLICK,interaction:ege},{key:Ju.ROW_TEXT_CLICK,interaction:rge},{key:Ju.MERGED_CELLS_CLICK,interaction:tge},{key:Ju.HOVER,interaction:ige,enable:!Bl()},{key:Ju.BRUSH_SELECTION,interaction:oge,enable:!Bl()&&l},{key:Ju.ROW_BRUSH_SELECTION,interaction:sge,enable:!Bl()&&u},{key:Ju.COL_BRUSH_SELECTION,interaction:age,enable:!Bl()&&c},{key:Ju.COL_ROW_RESIZE,interaction:hge,enable:!Bl()&&r},{key:Ju.DATA_CELL_MULTI_SELECTION,interaction:lge,enable:!Bl()&&i},{key:Ju.RANGE_SELECTION,interaction:cge,enable:!Bl()&&a},{key:Ju.SELECTED_CELL_MOVE,interaction:dge,enable:!Bl()&&o}]},e.prototype.registerInteractions=function(){var t=this,r=this.spreadsheet.options.interaction.customInteractions;this.interactions.clear();var n=this.getDefaultInteractions();n.forEach(function(i){var a=i.key,o=i.interaction,s=i.enable;s!==!1&&t.interactions.set(a,new o(t.spreadsheet))}),Or(r)||xi(r,function(i){var a=i.interaction;t.interactions.set(i.key,new a(t.spreadsheet))})},e.prototype.registerEventController=function(){this.eventController=new uge(this.spreadsheet)},e.prototype.draw=function(){this.spreadsheet.container.draw()},e.prototype.clearState=function(){Sot(this.spreadsheet)&&this.draw()},e.prototype.changeState=function(t){var r=this,n=this.spreadsheet.interaction,i=t.cells,a=i===void 0?[]:i,o=t.force,s=t.stateName,l=t.onUpdateCells;if(Or(a)&&s===On.SELECTED){o&&n.changeState({cells:[],stateName:On.UNSELECTED});return}this.getCurrentStateName()===On.ALL_SELECTED&&this.clearStyleIndependent(),this.clearState(),this.setState(t);var u=function(){r.updatePanelGroupAllDataCells()};l?l(this,u):u(),this.draw()},e.prototype.updatePanelGroupAllDataCells=function(){this.updateCells(this.getPanelGroupAllDataCells())},e.prototype.updateCells=function(t){t===void 0&&(t=[]),t.forEach(function(r){r.update()})},e.prototype.addIntercepts=function(t){var r=this;t===void 0&&(t=[]),t.forEach(function(n){r.intercepts.add(n)})},e.prototype.hasIntercepts=function(t){var r=this;return t===void 0&&(t=[]),t.some(function(n){return r.intercepts.has(n)})},e.prototype.removeIntercepts=function(t){var r=this;t===void 0&&(t=[]),t.forEach(function(n){r.intercepts.delete(n)})},e.prototype.clearHoverTimer=function(){clearTimeout(this.hoverTimer)},e.prototype.setHoverTimer=function(t){this.hoverTimer=t},e.prototype.getHoverTimer=function(){return this.hoverTimer},e.prototype.getSelectedCellHighlight=function(){var t=this.spreadsheet.options.interaction.selectedCellHighlight;if(Dp(t))return{rowHeader:t,colHeader:t,currentRow:!1,currentCol:!1};var r=t??{},n=r.rowHeader,i=n===void 0?!1:n,a=r.colHeader,o=a===void 0?!1:a,s=r.currentRow,l=s===void 0?!1:s,u=r.currentCol,c=u===void 0?!1:u;return{rowHeader:i,colHeader:o,currentRow:l,currentCol:c}},e.prototype.getHoverAfterScroll=function(){return this.spreadsheet.options.interaction.hoverAfterScroll},e.prototype.getHoverHighlight=function(){var t=this.spreadsheet.options.interaction.hoverHighlight;if(Dp(t))return{rowHeader:t,colHeader:t,currentRow:t,currentCol:t};var r=t??{},n=r.rowHeader,i=n===void 0?!1:n,a=r.colHeader,o=a===void 0?!1:a,s=r.currentRow,l=s===void 0?!1:s,u=r.currentCol,c=u===void 0?!1:u;return{rowHeader:i,colHeader:o,currentRow:l,currentCol:c}},e.prototype.getBrushSelection=function(){var t=this.spreadsheet.options.interaction.brushSelection;if(Dp(t))return{data:t,row:t,col:t};var r=t??{},n=r.data,i=n===void 0?!1:n,a=r.row,o=a===void 0?!1:a,s=r.col,l=s===void 0?!1:s;return{data:i,row:o,col:l}},e}(),vge=function(){function e(t){var r=this;this.viewport=window,this.isDevicePixelRatioChange=!1,this.init=function(){r.initDevicePixelRatioListener(),r.initDeviceZoomListener()},this.destroy=function(){r.removeDevicePixelRatioListener(),r.removeDeviceZoomListener()},this.removeDevicePixelRatioListener=function(){var n;!((n=r.devicePixelRatioMedia)===null||n===void 0)&&n.removeEventListener?r.devicePixelRatioMedia.removeEventListener("change",r.renderByDevicePixelRatioChanged):r.devicePixelRatioMedia.removeListener(r.renderByDevicePixelRatioChanged)},this.initDeviceZoomListener=function(){var n,i;Bl()||(i=(n=r.viewport)===null||n===void 0?void 0:n.visualViewport)===null||i===void 0||i.addEventListener("resize",r.renderByZoomScaleWithoutResizeEffect)},this.removeDeviceZoomListener=function(){var n,i;Bl()||(i=(n=r.viewport)===null||n===void 0?void 0:n.visualViewport)===null||i===void 0||i.removeEventListener("resize",r.renderByZoomScaleWithoutResizeEffect)},this.renderByZoomScaleWithoutResizeEffect=function(n){r.isDevicePixelRatioChange=!1,r.renderByZoomScale(n)},this.renderByDevicePixelRatioChanged=function(){r.isDevicePixelRatioChange=!0,r.renderByDevicePixelRatio()},this.renderByDevicePixelRatio=function(n){n===void 0&&(n=window.devicePixelRatio);var i=r.spreadsheet,a=i.container,o=i.options,s=o.width,l=o.height,u=o.devicePixelRatio,c=r.spreadsheet.getCanvasElement(),f=a.get("pixelRatio");if(!(f===n||!c)){var d=Math.max(n,u,ent);a.set("pixelRatio",d),a.changeSize(s,l),r.spreadsheet.render(!1)}},this.renderByZoomScale=NC(function(n){var i=Math.ceil(n.target.scale);i>=1&&!r.isDevicePixelRatioChange&&r.renderByDevicePixelRatio(i)},350),this.spreadsheet=t}return e.prototype.initDevicePixelRatioListener=function(){var t;this.devicePixelRatioMedia=window.matchMedia("(resolution: ".concat(window.devicePixelRatio,"dppx)")),!((t=this.devicePixelRatioMedia)===null||t===void 0)&&t.addEventListener?this.devicePixelRatioMedia.addEventListener("change",this.renderByDevicePixelRatioChanged):this.devicePixelRatioMedia.addListener(this.renderByDevicePixelRatioChanged)},e}(),GX=function(){function e(t){this.visible=!1,this.position={x:0,y:0},this.spreadsheet=t}return e.prototype.show=function(t){var r,n,i,a=t.position,o=t.options,s=t.content,l=t.event,u=Qpe(o).enterable,c=this.spreadsheet.options.tooltip||{},f=c.autoAdjustBoundary,d=c.adjustPosition;this.visible=!0,this.options=t;var v=this.getContainer();this.renderContent(s);var g=Kpe({spreadsheet:this.spreadsheet,position:a,tooltipContainer:v,autoAdjustBoundary:f}),x=g.x,w=g.y;this.position=(r=d==null?void 0:d({position:{x,y:w},event:l}))!==null&&r!==void 0?r:{x,y:w},qT(v,{style:{left:"".concat((n=this.position)===null||n===void 0?void 0:n.x,"px"),top:"".concat((i=this.position)===null||i===void 0?void 0:i.y,"px"),pointerEvents:u?"all":"none"},visible:!0})},e.prototype.hide=function(){this.visible=!1,this.container&&(qT(this.container,{style:{pointerEvents:"none"},visible:!1}),this.resetPosition())},e.prototype.destroy=function(){var t,r;this.visible=!1,this.container&&(this.resetPosition(),(r=(t=this.container).remove)===null||r===void 0||r.call(t),this.container=null)},e.prototype.renderContent=function(t){if(this.container){this.clearContent();var r=(this.spreadsheet.options.tooltip||{}).content,n=t??r;if(!bl(n)){if(typeof n=="string"){this.container.innerHTML=n;return}n instanceof Element&&this.container.appendChild(n)}}},e.prototype.clearContent=function(){this.container&&(this.container.innerHTML="")},e.prototype.disablePointerEvent=function(){this.container&&this.container.style.pointerEvents!=="none"&&qT(this.container,{style:{pointerEvents:"none"}})},e.prototype.resetPosition=function(){this.position={x:0,y:0}},e.prototype.getContainer=function(){var t;if(!this.container){var r=this.spreadsheet.options.tooltip,n=((t=r.getContainer)===null||t===void 0?void 0:t.call(r))||document.body,i=document.createElement("div");return qT(i,{style:r.style,className:[Mk].concat(r.className)}),n.appendChild(i),this.container=i,this.container}return this.container},e}(),ost=function(e){en(t,e);function t(r,n,i){var a=e.call(this)||this;return a.store=new The,a.untypedOn=a.on,a.untypedEmit=a.emit,a.on=function(o,s){return a.untypedOn(o,s)},a.emit=function(o){for(var s=[],l=1;l<arguments.length;l++)s[l-1]=arguments[l];return a.untypedEmit.apply(a,Vr([o],lr(s),!1))},a.initHiddenColumnsDetail=function(){var o=a.options.interaction.hiddenColumnFields,s=a.store.get("hiddenColumnsDetail");Or(o)&&Or(s)||Nk(a,o,!0)},a.measureText=R_(function(o,s){var l;if(o===void 0&&(o=""),!s)return null;var u=(l=a.getCanvasElement())===null||l===void 0?void 0:l.getContext("2d"),c=s,f=c.fontSize,d=c.fontFamily,v=c.fontWeight,g=c.fontStyle,x=c.fontVariant;return u.font=[g,x,v,"".concat(f,"px"),d].join(" ").trim(),u.measureText(String(o))},function(o,s){return Vr([o],lr(wg(s)),!1).join("")}),a.measureTextWidth=function(o,s){o===void 0&&(o="");var l=a.measureText(o,s);return(l==null?void 0:l.width)||0},a.measureTextHeight=function(o,s){o===void 0&&(o="");var l=a.measureText(o,s);return l?l.actualBoundingBoxAscent+l.actualBoundingBoxDescent:0},a.measureTextWidthRoughly=function(o,s){var l,u;s===void 0&&(s={});var c=a.measureTextWidth("a",s),f=a.measureTextWidth("蚂",s),d=0;if(!o)return d;try{for(var v=Gf(o),g=v.next();!g.done;g=v.next()){var x=g.value,w=x.charCodeAt(0);d+=w>=0&&w<=255?c:f}}catch(S){l={error:S}}finally{try{g&&!g.done&&(u=v.return)&&u.call(v)}finally{if(l)throw l.error}}return d},a.dataCfg=aP(n),a.options=yX(i),a.dataSet=a.getDataSet(a.options),a.setDebug(),a.initTooltip(),a.initGroups(r),a.bindEvents(),a.initInteraction(),a.initTheme(),a.initHdAdapter(),a.registerIcons(),a.setOverscrollBehavior(),a.mountSheetInstance(),a}return t.prototype.setOverscrollBehavior=function(){var r=this.options.interaction.overscrollBehavior,n=window.getComputedStyle(document.body).getPropertyValue("overscroll-behavior"),i=n&&n!=="auto";i?this.store.set("initOverscrollBehavior",n):r&&(document.body.style.overscrollBehavior=r)},t.prototype.restoreOverscrollBehavior=function(){document.body.style.overscrollBehavior=this.store.get("initOverscrollBehavior")||""},t.prototype.setDebug=function(){Fp.getInstance().setDebug(this.options.debug)},t.prototype.initTheme=function(){this.setThemeCfg({name:"default"})},t.prototype.getMountContainer=function(r){var n=Db(r)?document.querySelector(r):r;if(!n)throw new Error("Target mount container is not a DOM element");return n},t.prototype.initHdAdapter=function(){this.options.hdAdapter&&(this.hdAdapter=new vge(this),this.hdAdapter.init())},t.prototype.initInteraction=function(){var r,n;(n=(r=this.interaction)===null||r===void 0?void 0:r.destroy)===null||n===void 0||n.call(r),this.interaction=new pge(this)},t.prototype.initTooltip=function(){var r,n,i,a;(n=(r=this.tooltip)===null||r===void 0?void 0:r.destroy)===null||n===void 0||n.call(r),this.tooltip=this.renderTooltip(),this.tooltip instanceof GX||console.warn("[Custom Tooltip]: ".concat((a=(i=this.tooltip)===null||i===void 0?void 0:i.constructor)===null||a===void 0?void 0:a.toString()," should be extends from BaseTooltip"))},t.prototype.renderTooltip=function(){var r,n;return((n=(r=this.options.tooltip)===null||r===void 0?void 0:r.renderTooltip)===null||n===void 0?void 0:n.call(r,this))||new GX(this)},t.prototype.showTooltip=function(r){var n,i,a=r.content,o=r.event,s=this.getCell(o==null?void 0:o.target),l=hu(a)?a(s,r):a;(i=(n=this.tooltip).show)===null||i===void 0||i.call(n,Zt(Zt({},r),{content:l}))},t.prototype.showTooltipWithInfo=function(r,n,i){var a,o=jk(this,r),s=o.showTooltip,l=o.content;if(s){var u=this.getCell(r==null?void 0:r.target),c=(a=i==null?void 0:i.data)!==null&&a!==void 0?a:sve({spreadsheet:this,cellInfos:n,targetCell:u,options:Zt({enableFormat:!0},i)});this.showTooltip({data:c,position:{x:r.clientX,y:r.clientY},options:Zt({enterable:!0},i),event:r,content:l})}},t.prototype.hideTooltip=function(){var r,n;(n=(r=this.tooltip).hide)===null||n===void 0||n.call(r)},t.prototype.destroyTooltip=function(){var r,n;(n=(r=this.tooltip).destroy)===null||n===void 0||n.call(r)},t.prototype.registerIcons=function(){var r=this.options.customSVGIcons;Or(r)||xi(r,function(n){Hat(n.name,n.svg)})},t.prototype.setDataCfg=function(r,n){this.store.set("originalDataCfg",r),n?this.dataCfg=aP(r):this.dataCfg=aP(this.dataCfg,r),hve(this)},t.prototype.setOptions=function(r,n){var i;this.hideTooltip(),n?this.options=yX(r):this.options=Mp(this.options,r),(n||!((i=r.tooltip)===null||i===void 0)&&i.renderTooltip)&&this.initTooltip(),this.resetHiddenColumnsDetailInfoIfNeeded(),this.registerIcons()},t.prototype.resetHiddenColumnsDetailInfoIfNeeded=function(){var r;Or((r=this.options.interaction)===null||r===void 0?void 0:r.hiddenColumnFields)||this.store.set("hiddenColumnsDetail",[])},t.prototype.render=function(r,n){if(r===void 0&&(r=!0),n===void 0&&(n={}),!!this.getCanvasElement()){var i=n.reBuildDataSet,a=i===void 0?!1:i,o=n.reBuildHiddenColumnsDetail,s=o===void 0?!0:o;this.emit(Me.LAYOUT_BEFORE_RENDER),a&&(this.dataSet=this.getDataSet(this.options)),r&&(this.clearDrillDownData("",!0),this.dataSet.setDataCfg(this.dataCfg)),this.buildFacet(),s&&this.initHiddenColumnsDetail(),this.emit(Me.LAYOUT_AFTER_RENDER)}},t.prototype.mountSheetInstance=function(){var r=this.getCanvasElement();r&&(r.__s2_instance__=this)},t.prototype.unmountSheetInstance=function(){var r=this.getCanvasElement();r&&delete r.__s2_instance__},t.prototype.destroy=function(){var r,n,i,a,o;this.restoreOverscrollBehavior(),this.emit(Me.LAYOUT_DESTROY),(r=this.facet)===null||r===void 0||r.destroy(),(n=this.hdAdapter)===null||n===void 0||n.destroy(),(i=this.interaction)===null||i===void 0||i.destroy(),(a=this.store)===null||a===void 0||a.clear(),this.destroyTooltip(),this.clearCanvasEvent(),this.unmountSheetInstance(),(o=this.container)===null||o===void 0||o.destroy(),Whe()},t.prototype.setThemeCfg=function(r){r===void 0&&(r={});var n=(r==null?void 0:r.theme)||{},i=the(Zt(Zt({},r),{spreadsheet:this}));this.theme=Mp(i,n)},t.prototype.setTheme=function(r){this.theme=Mp(this.theme,r)},t.prototype.updatePagination=function(r){this.options=Mp(this.options,{pagination:r}),this.store.set("scrollX",0),this.store.set("scrollY",0)},t.prototype.getContentHeight=function(){return this.facet.getContentHeight()},t.prototype.changeSize=function(r,n){r===void 0&&(r=this.options.width),n===void 0&&(n=this.options.height),this.changeSheetSize(r,n)},t.prototype.changeSheetSize=function(r,n){r===void 0&&(r=this.options.width),n===void 0&&(n=this.options.height);var i=this.getCanvasElement(),a=this.container.get("width"),o=this.container.get("height"),s=r!==a||n!==o;!s||!i||(this.options=Mp(this.options,{width:r,height:n}),this.container.changeSize(r,n))},t.prototype.getCanvasElement=function(){return this.container.get("el")},t.prototype.getLayoutWidthType=function(){return this.options.style.layoutWidthType},t.prototype.getRowNodes=function(r){return r===void 0&&(r=-1),r===-1?this.facet.layoutResult.rowNodes:this.facet.layoutResult.rowNodes.filter(function(n){return n.level===r})},t.prototype.getRowLeafNodes=function(){var r;return((r=this.facet)===null||r===void 0?void 0:r.layoutResult.rowLeafNodes)||[]},t.prototype.getColumnNodes=function(r){var n;r===void 0&&(r=-1);var i=((n=this.facet)===null||n===void 0?void 0:n.layoutResult.colNodes)||[];return r===-1?i:i.filter(function(a){return a.level===r})},t.prototype.getColumnLeafNodes=function(){var r;return((r=this.facet)===null||r===void 0?void 0:r.layoutResult.colLeafNodes)||[]},t.prototype.updateScrollOffset=function(r){var n={offsetX:{value:void 0,animate:!1},offsetY:{value:void 0,animate:!1},rowHeaderOffsetX:{value:void 0,animate:!1}};this.facet.updateScrollOffset(Mp(n,r))},t.prototype.getTooltipDataItemMappingCallback=function(){var r;return(r=this.options)===null||r===void 0?void 0:r.mappingDisplayDataItem},t.prototype.isCellType=function(r){return r instanceof y3},t.prototype.getCell=function(r){for(var n,i=r;i&&!(i instanceof kG);){if(this.isCellType(i))return i;i=(n=i.get)===null||n===void 0?void 0:n.call(i,"parent")}return null},t.prototype.getCellType=function(r){var n=this.getCell(r);return n==null?void 0:n.cellType},t.prototype.getTotalsConfig=function(r){var n=this.options.totals,i=this.dataSet.fields.rows,a=ii(n,oc(i,r)?"row":"col",{}),o=a.showSubTotals&&oc(a.subTotalsDimensions,r)?a.showSubTotals:!1;return Zt(Zt({label:El("总计"),subLabel:El("小计"),totalsGroupDimensions:[],subTotalsGroupDimensions:[]},a),{showSubTotals:o})},t.prototype.initGroups=function(r){var n=this.options,i=n.width,a=n.height,o=n.supportCSSTransform,s=n.devicePixelRatio;this.container=new kG({container:this.getMountContainer(r),width:i,height:a,localRefresh:!1,supportCSSTransform:o,pixelRatio:Math.max(s,ent)}),this.backgroundGroup=this.container.addGroup({name:Njt,zIndex:Ljt}),this.panelGroup=this.container.addGroup({name:zjt,zIndex:Fjt}),this.foregroundGroup=this.container.addGroup({name:kjt,zIndex:Ojt}),this.initPanelGroupChildren(),this.updateContainerStyle()},t.prototype.updateContainerStyle=function(){var r=this.getCanvasElement();r&&(r.style.display="block")},t.prototype.initPanelGroupChildren=function(){this.panelScrollGroup=new Qve({name:Ujt,zIndex:Bjt,s2:this}),this.panelGroup.add(this.panelScrollGroup)},t.prototype.getInitColumnLeafNodes=function(){return this.store.get("initColumnLeafNodes",[])},t.prototype.clearColumnLeafNodes=function(){this.clearInitColumnLeafNodes()},t.prototype.clearInitColumnLeafNodes=function(){this.store.set("initColumnLeafNodes",void 0)},t.prototype.clearCanvasEvent=function(){var r=this,n=this.getEvents();Git(n,function(i,a){r.off(a)})},t.prototype.updateSortMethodMap=function(r,n,i){var a;i===void 0&&(i=!1);var o=i?null:this.store.get("sortMethodMap");this.store.set("sortMethodMap",Zt(Zt({},o),(a={},a[r]=n,a)))},t.prototype.getMenuDefaultSelectedKeys=function(r){var n=this.store.get("sortMethodMap"),i=ii(n,r);return i?[i]:[]},t}(zI),W3e=function(e){en(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDataSet=function(r){var n=r.dataSet,i=r.hierarchyType;if(n)return n(this);var a=i==="customTree"?new pve(this):new PB(this);return a},t.prototype.getContentHeight=function(){return this.facet.getContentHeight()},t.prototype.isPivotMode=function(){return!0},t.prototype.isTableMode=function(){return!1},t.prototype.isHierarchyTreeType=function(){var r=this.options.hierarchyType;return r==="tree"||r==="customTree"},t.prototype.isScrollContainsRowHeader=function(){return!this.isFrozenRowHeader()},t.prototype.isFrozenRowHeader=function(){var r;return(r=this.options)===null||r===void 0?void 0:r.frozenRowHeader},t.prototype.isValueInCols=function(){var r,n;return(n=(r=this.dataSet)===null||r===void 0?void 0:r.fields)===null||n===void 0?void 0:n.valueInCols},t.prototype.clearDrillDownData=function(r,n){if(this.dataSet instanceof PB){var i=this.dataSet.clearDrillDownData(r);i&&!n&&(this.interaction.reset(),this.render(!1))}},t.prototype.getFacetCfgFromDataSetAndOptions=function(){var r=this,n=this.dataSet,i=n.fields,a=n.meta,o=this.options,s=o.style,l=o.dataCell,u=function(c){return new _0(c,r)};return Zt(Zt(Zt(Zt({},this.options),i),s),{meta:a,spreadsheet:this,dataSet:this.dataSet,dataCell:l??u})},t.prototype.buildFacet=function(){var r,n=this.getFacetCfgFromDataSetAndOptions();(r=this.facet)===null||r===void 0||r.destroy(),this.facet=new Zve(n),this.facet.render()},t.prototype.bindEvents=function(){this.off(Me.ROW_CELL_COLLAPSE_TREE_ROWS),this.off(Me.LAYOUT_TREE_ROWS_COLLAPSE_ALL),this.on(Me.ROW_CELL_COLLAPSE_TREE_ROWS,this.handleRowCellCollapseTreeRows),this.on(Me.LAYOUT_TREE_ROWS_COLLAPSE_ALL,this.handleTreeRowsCollapseAll)},t.prototype.handleRowCellCollapseTreeRows=function(r){var n,i=r.id,a=r.isCollapsed,o={style:{collapsedRows:(n={},n[i]=a,n)}};this.emit(Me.LAYOUT_COLLAPSE_ROWS,{collapsedRows:o.style.collapsedRows,meta:r==null?void 0:r.node}),this.setOptions(o),this.render(!1),this.emit(Me.LAYOUT_AFTER_COLLAPSE_ROWS,{collapsedRows:o.style.collapsedRows,meta:r==null?void 0:r.node})},t.prototype.handleTreeRowsCollapseAll=function(r){var n={style:{hierarchyCollapse:!r,collapsedRows:null,rowExpandDepth:null}};this.setOptions(n),this.render(!1)},t.prototype.groupSortByMethod=function(r,n){var i=this.dataCfg.fields,a=i.rows,o=i.columns,s=this.options.style.colCfg.hideMeasureColumn,l=this.isValueInCols()?co(a):co(o),u=n.query,c=n.value,f=FS(u),d=c;s&&this.isValueInCols()&&(d=this.dataSet.fields.values[0],f[Pi]=d);var v={sortFieldId:l,sortMethod:r,sortByMeasure:d,query:f},g=this.dataCfg.sortParams.filter(function(w){return(w==null?void 0:w.sortFieldId)!==l});this.updateSortMethodMap(n.id,r,!0);var x=Vr(Vr([],lr(g),!1),[v],!1);this.emit(Me.RANGE_SORT,x),this.setDataCfg(Zt(Zt({},this.dataCfg),{sortParams:x})),this.render()},t.prototype.handleGroupSort=function(r,n){var i=this;r.stopPropagation(),this.interaction.addIntercepts([Ti.HOVER]);var a=this.getMenuDefaultSelectedKeys(n==null?void 0:n.id),o={onClick:function(s){var l=s.key,u=l;i.groupSortByMethod(u,n),i.emit(Me.RANGE_SORTED,r)},menus:qce(),defaultSelectedKeys:a};this.showTooltipWithInfo(r,[],{operator:o,onlyMenu:!0,forceRender:!0})},t.prototype.initPanelGroupChildren=function(){e.prototype.initPanelGroupChildren.call(this);var r={zIndex:Grt,s2:this};this.frozenRowGroup=new ast(Zt({KEY_GROUP_PANEL_FROZEN_ROW:Wrt},r)),this.panelGroup.add(this.frozenRowGroup)},t.prototype.isCellType=function(r){return r instanceof y3&&!(r instanceof wot)},t}(ost),X3e=function(e){en(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.onSortTooltipClick=function(n,i){var a=n.key,o=i.field,s={sortFieldId:o,sortMethod:a};r.updateSortMethodMap(i.id,a),r.emit(Me.RANGE_SORT,[s])},r}return t.prototype.getDataSet=function(r){var n=r.dataSet;return n?n(this):new vve(this)},t.prototype.isPivotMode=function(){return!1},t.prototype.isTableMode=function(){return!0},t.prototype.isHierarchyTreeType=function(){return!1},t.prototype.isScrollContainsRowHeader=function(){return!1},t.prototype.isFrozenRowHeader=function(){return!1},t.prototype.clearDrillDownData=function(){},t.prototype.isValueInCols=function(){return!1},t.prototype.bindEvents=function(){},t.prototype.initPanelGroupChildren=function(){var r,n=this;e.prototype.initPanelGroupChildren.call(this);var i={zIndex:Grt,s2:this};r=lr([Wrt,Xrt,$jt,Hjt,Vjt,Gjt].map(function(a){var o=new ast(Zt({name:a},i));return n.panelGroup.add(o),o}),6),this.frozenRowGroup=r[0],this.frozenColGroup=r[1],this.frozenTrailingRowGroup=r[2],this.frozenTrailingColGroup=r[3],this.frozenTopGroup=r[4],this.frozenBottomGroup=r[5]},t.prototype.getFacetCfgFromDataSetAndOptions=function(){var r=this,n=this.dataSet,i=n.fields,a=n.meta,o=this.options,s=o.style,l=o.dataCell,u=function(c){return r.options.showSeriesNumber&&c.colIndex===0?new xot(c,r):new x3(c,r)};return Zt(Zt(Zt(Zt({},this.options),i),s),{meta:a,spreadsheet:this,dataSet:this.dataSet,dataCell:l??u})},t.prototype.buildFacet=function(){var r,n=this.getFacetCfgFromDataSetAndOptions();(r=this.facet)===null||r===void 0||r.destroy(),this.facet=new Kve(n),this.facet.render()},t.prototype.clearFrozenGroups=function(){this.frozenRowGroup.set("children",[]),this.frozenColGroup.set("children",[]),this.frozenTrailingRowGroup.set("children",[]),this.frozenTrailingColGroup.set("children",[]),this.frozenTopGroup.set("children",[]),this.frozenBottomGroup.set("children",[])},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.clearFrozenGroups(),this.off(Me.RANGE_SORT),this.off(Me.RANGE_FILTER)},t.prototype.handleGroupSort=function(r,n){var i=this;r.stopPropagation(),this.interaction.addIntercepts([Ti.HOVER]);var a=this.getMenuDefaultSelectedKeys(n==null?void 0:n.id),o={onClick:function(s){var l=s.key,u=l;i.onSortTooltipClick({key:u},n)},menus:Kce(),defaultSelectedKeys:a};this.showTooltipWithInfo(r,[],{operator:o,onlyMenu:!0,forceRender:!0})},t}(ost),ys;(function(e){e.FORE="fore",e.MID="mid",e.BG="bg"})(ys||(ys={}));var xr;(function(e){e.TOP="top",e.TOP_LEFT="top-left",e.TOP_RIGHT="top-right",e.RIGHT="right",e.RIGHT_TOP="right-top",e.RIGHT_BOTTOM="right-bottom",e.LEFT="left",e.LEFT_TOP="left-top",e.LEFT_BOTTOM="left-bottom",e.BOTTOM="bottom",e.BOTTOM_LEFT="bottom-left",e.BOTTOM_RIGHT="bottom-right",e.RADIUS="radius",e.CIRCLE="circle",e.NONE="none"})(xr||(xr={}));var gl;(function(e){e.AXIS="axis",e.GRID="grid",e.LEGEND="legend",e.TOOLTIP="tooltip",e.ANNOTATION="annotation",e.SLIDER="slider",e.SCROLLBAR="scrollbar",e.OTHER="other"})(gl||(gl={}));var bx={FORE:3,MID:2,BG:1},di;(function(e){e.BEFORE_RENDER="beforerender",e.AFTER_RENDER="afterrender",e.BEFORE_PAINT="beforepaint",e.AFTER_PAINT="afterpaint",e.BEFORE_CHANGE_DATA="beforechangedata",e.AFTER_CHANGE_DATA="afterchangedata",e.BEFORE_CLEAR="beforeclear",e.AFTER_CLEAR="afterclear",e.BEFORE_DESTROY="beforedestroy",e.BEFORE_CHANGE_SIZE="beforechangesize",e.AFTER_CHANGE_SIZE="afterchangesize"})(di||(di={}));var zm;(function(e){e.BEFORE_DRAW_ANIMATE="beforeanimate",e.AFTER_DRAW_ANIMATE="afteranimate",e.BEFORE_RENDER_LABEL="beforerenderlabel",e.AFTER_RENDER_LABEL="afterrenderlabel"})(zm||(zm={}));var Oc;(function(e){e.MOUSE_ENTER="plot:mouseenter",e.MOUSE_DOWN="plot:mousedown",e.MOUSE_MOVE="plot:mousemove",e.MOUSE_UP="plot:mouseup",e.MOUSE_LEAVE="plot:mouseleave",e.TOUCH_START="plot:touchstart",e.TOUCH_MOVE="plot:touchmove",e.TOUCH_END="plot:touchend",e.TOUCH_CANCEL="plot:touchcancel",e.CLICK="plot:click",e.DBLCLICK="plot:dblclick",e.CONTEXTMENU="plot:contextmenu",e.LEAVE="plot:leave",e.ENTER="plot:enter"})(Oc||(Oc={}));var RR;(function(e){e.ACTIVE="active",e.INACTIVE="inactive",e.SELECTED="selected",e.DEFAULT="default"})(RR||(RR={}));var nx=["color","shape","size"],Oa="_origin",WX=1,XX=1,jX=.25,sst={};function gge(e){var t=sst[e];if(!t)throw new Error("G engine '".concat(e,"' is not exist, please register it at first."));return t}function lst(e,t){sst[e]=t}function mge(e){var t=getComputedStyle(e);return{width:(e.clientWidth||parseInt(t.width,10))-parseInt(t.paddingLeft,10)-parseInt(t.paddingRight,10),height:(e.clientHeight||parseInt(t.height,10))-parseInt(t.paddingTop,10)-parseInt(t.paddingBottom,10)}}function YX(e){return typeof e=="number"&&!isNaN(e)}function ZX(e,t,r,n){var i=r,a=n;if(t){var o=mge(e);i=o.width?o.width:i,a=o.height?o.height:a}return{width:Math.max(YX(i)?i:WX,WX),height:Math.max(YX(a)?a:XX,XX)}}function yge(e){var t=e.parentNode;t&&t.removeChild(e)}var t6=function(e){Ut(t,e);function t(r){var n=e.call(this)||this;n.destroyed=!1;var i=r.visible,a=i===void 0?!0:i;return n.visible=a,n}return t.prototype.show=function(){var r=this.visible;r||this.changeVisible(!0)},t.prototype.hide=function(){var r=this.visible;r&&this.changeVisible(!1)},t.prototype.destroy=function(){this.off(),this.destroyed=!0},t.prototype.changeVisible=function(r){this.visible!==r&&(this.visible=r)},t}(S_),qX=0,_ge=1/2,xge=1/2,bge=.05,T3=function(){function e(t){var r=t.xField,n=t.yField,i=t.adjustNames,a=i===void 0?["x","y"]:i,o=t.dimValuesMap;this.adjustNames=a,this.xField=r,this.yField=n,this.dimValuesMap=o}return e.prototype.isAdjust=function(t){return this.adjustNames.indexOf(t)>=0},e.prototype.getAdjustRange=function(t,r,n){var i=this.yField,a=n.indexOf(r),o=n.length,s,l;return!i&&this.isAdjust("y")?(s=0,l=1):o>1?(s=n[a===0?0:a-1],l=n[a===o-1?o-1:a+1],a!==0?s+=(r-s)/2:s-=(l-r)/2,a!==o-1?l-=(l-r)/2:l+=(r-n[o-2])/2):(s=r===0?0:r-.5,l=r===0?1:r+.5),{pre:s,next:l}},e.prototype.adjustData=function(t,r){var n=this,i=this.getDimValues(r);ft(t,function(a,o){ft(i,function(s,l){n.adjustDim(l,s,a,o)})})},e.prototype.groupData=function(t,r){return ft(t,function(n){n[r]===void 0&&(n[r]=qX)}),Ph(t,r)},e.prototype.adjustDim=function(t,r,n,i){},e.prototype.getDimValues=function(t){var r=this,n=r.xField,i=r.yField,a=Sa({},this.dimValuesMap),o=[];if(n&&this.isAdjust("x")&&o.push(n),i&&this.isAdjust("y")&&o.push(i),o.forEach(function(l){a&&a[l]||(a[l]=$d(t,l).sort(function(u,c){return u-c}))}),!i&&this.isAdjust("y")){var s="y";a[s]=[qX,1]}return a},e}(),ust={},cst=function(e){return ust[e.toLowerCase()]},A3=function(e,t){if(cst(e))throw new Error("Adjust type '"+e+"' existed.");ust[e.toLowerCase()]=t};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var kB=function(e,t){return kB=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},kB(e,t)};function M3(e,t){kB(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Np=function(){return Np=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},Np.apply(this,arguments)},Ege=function(e){M3(t,e);function t(r){var n=e.call(this,r)||this;n.cacheMap={},n.adjustDataArray=[],n.mergeData=[];var i=r.marginRatio,a=i===void 0?_ge:i,o=r.dodgeRatio,s=o===void 0?xge:o,l=r.dodgeBy,u=r.intervalPadding,c=r.dodgePadding,f=r.xDimensionLength,d=r.groupNum,v=r.defaultSize,g=r.maxColumnWidth,x=r.minColumnWidth,w=r.columnWidthRatio,S=r.customOffset;return n.marginRatio=a,n.dodgeRatio=s,n.dodgeBy=l,n.intervalPadding=u,n.dodgePadding=c,n.xDimensionLegenth=f,n.groupNum=d,n.defaultSize=v,n.maxColumnWidth=g,n.minColumnWidth=x,n.columnWidthRatio=w,n.customOffset=S,n}return t.prototype.process=function(r){var n=$l(r),i=Nh(n),a=this.dodgeBy,o=a?pUt(i,a):n;return this.cacheMap={},this.adjustDataArray=o,this.mergeData=i,this.adjustData(o,i),this.adjustDataArray=[],this.mergeData=[],n},t.prototype.adjustDim=function(r,n,i,a){var o=this,s=this.customOffset,l=this.getDistribution(r),u=this.groupData(i,r);return ft(u,function(c,f){var d;n.length===1?d={pre:n[0]-1,next:n[0]+1}:d=o.getAdjustRange(r,parseFloat(f),n),ft(c,function(v){var g=v[r],x=l[g],w=x.indexOf(a);if(ke(s))v[r]=o.getDodgeOffset(d,w,x.length);else{var S=d.pre,A=d.next;v[r]=$r(s)?s(v,d):(S+A)/2+s}})}),[]},t.prototype.getDodgeOffset=function(r,n,i){var a=this,o=a.dodgeRatio,s=a.marginRatio,l=a.intervalPadding,u=a.dodgePadding,c=r.pre,f=r.next,d=f-c,v;if(!ke(l)&&ke(u)&&l>=0){var g=this.getIntervalOnlyOffset(i,n);v=c+g}else if(!ke(u)&&ke(l)&&u>=0){var g=this.getDodgeOnlyOffset(i,n);v=c+g}else if(!ke(l)&&!ke(u)&&l>=0&&u>=0){var g=this.getIntervalAndDodgeOffset(i,n);v=c+g}else{var x=d*o/i,w=s*x,g=1/2*(d-i*x-(i-1)*w)+((n+1)*x+n*w)-1/2*x-1/2*d;v=(c+f)/2+g}return v},t.prototype.getIntervalOnlyOffset=function(r,n){var i=this,a=i.defaultSize,o=i.intervalPadding,s=i.xDimensionLegenth,l=i.groupNum,u=i.dodgeRatio,c=i.maxColumnWidth,f=i.minColumnWidth,d=i.columnWidthRatio,v=o/s,g=(1-(l-1)*v)/l*u/(r-1),x=((1-v*(l-1))/l-g*(r-1))/r;if(x=ke(d)?x:1/l/r*d,!ke(c)){var w=c/s;x=Math.min(x,w)}if(!ke(f)){var S=f/s;x=Math.max(x,S)}x=a?a/s:x,g=((1-(l-1)*v)/l-r*x)/(r-1);var A=((1/2+n)*x+n*g+1/2*v)*l-v/2;return A},t.prototype.getDodgeOnlyOffset=function(r,n){var i=this,a=i.defaultSize,o=i.dodgePadding,s=i.xDimensionLegenth,l=i.groupNum,u=i.marginRatio,c=i.maxColumnWidth,f=i.minColumnWidth,d=i.columnWidthRatio,v=o/s,g=1*u/(l-1),x=((1-g*(l-1))/l-v*(r-1))/r;if(x=d?1/l/r*d:x,!ke(c)){var w=c/s;x=Math.min(x,w)}if(!ke(f)){var S=f/s;x=Math.max(x,S)}x=a?a/s:x,g=(1-(x*r+v*(r-1))*l)/(l-1);var A=((1/2+n)*x+n*v+1/2*g)*l-g/2;return A},t.prototype.getIntervalAndDodgeOffset=function(r,n){var i=this,a=i.intervalPadding,o=i.dodgePadding,s=i.xDimensionLegenth,l=i.groupNum,u=a/s,c=o/s,f=((1-u*(l-1))/l-c*(r-1))/r,d=((1/2+n)*f+n*c+1/2*u)*l-u/2;return d},t.prototype.getDistribution=function(r){var n=this.adjustDataArray,i=this.cacheMap,a=i[r];return a||(a={},ft(n,function(o,s){var l=$d(o,r);l.length||l.push(0),ft(l,function(u){a[u]||(a[u]=[]),a[u].push(s)})}),i[r]=a),a},t}(T3);function wge(e,t){return(t-e)*Math.random()+e}var Cge=function(e){M3(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.process=function(r){var n=$l(r),i=Nh(n);return this.adjustData(n,i),n},t.prototype.adjustDim=function(r,n,i){var a=this,o=this.groupData(i,r);return ft(o,function(s,l){return a.adjustGroup(s,r,parseFloat(l),n)})},t.prototype.getAdjustOffset=function(r){var n=r.pre,i=r.next,a=(i-n)*bge;return wge(n+a,i-a)},t.prototype.adjustGroup=function(r,n,i,a){var o=this,s=this.getAdjustRange(n,i,a);return ft(r,function(l){l[n]=o.getAdjustOffset(s)}),r},t}(T3),hP=OUt,Sge=function(e){M3(t,e);function t(r){var n=e.call(this,r)||this,i=r.adjustNames,a=i===void 0?["y"]:i,o=r.height,s=o===void 0?NaN:o,l=r.size,u=l===void 0?10:l,c=r.reverseOrder,f=c===void 0?!1:c;return n.adjustNames=a,n.height=s,n.size=u,n.reverseOrder=f,n}return t.prototype.process=function(r){var n=this,i=n.yField,a=n.reverseOrder,o=i?this.processStack(r):this.processOneDimStack(r);return a?this.reverse(o):o},t.prototype.reverse=function(r){return r.slice(0).reverse()},t.prototype.processStack=function(r){var n=this,i=n.xField,a=n.yField,o=n.reverseOrder,s=o?this.reverse(r):r,l=new hP,u=new hP;return s.map(function(c){return c.map(function(f){var d,v=xt(f,i,0),g=xt(f,[a]),x=v.toString();if(g=ze(g)?g[1]:g,!ke(g)){var w=g>=0?l:u;w.has(x)||w.set(x,0);var S=w.get(x),A=g+S;return w.set(x,A),Np(Np({},f),(d={},d[a]=[S,A],d))}return f})})},t.prototype.processOneDimStack=function(r){var n=this,i=this,a=i.xField,o=i.height,s=i.reverseOrder,l="y",u=s?this.reverse(r):r,c=new hP;return u.map(function(f){return f.map(function(d){var v,g=n.size,x=d[a],w=g*2/o;c.has(x)||c.set(x,w/2);var S=c.get(x);return c.set(x,S+w),Np(Np({},d),(v={},v[l]=S,v))})})},t}(T3),Tge=function(e){M3(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.process=function(r){var n=Nh(r),i=this,a=i.xField,o=i.yField,s=this.getXValuesMaxMap(n),l=Math.max.apply(Math,Object.keys(s).map(function(u){return s[u]}));return mo(r,function(u){return mo(u,function(c){var f,d,v=c[o],g=c[a];if(ze(v)){var x=(l-s[g])/2;return Np(Np({},c),(f={},f[o]=mo(v,function(S){return x+S}),f))}var w=(l-v)/2;return Np(Np({},c),(d={},d[o]=[w,v+w],d))})})},t.prototype.getXValuesMaxMap=function(r){var n=this,i=this,a=i.xField,o=i.yField,s=Ph(r,function(l){return l[a]});return MUt(s,function(l){return n.getDimMaxValue(l,o)})},t.prototype.getDimMaxValue=function(r,n){var i=mo(r,function(o){return xt(o,n,[])}),a=Nh(i);return Math.max.apply(Math,a)},t}(T3);A3("Dodge",Ege);A3("Jitter",Cge);A3("Stack",Sge);A3("Symmetric",Tge);var KX=function(e,t){return nn(t)?t:e.invert(e.scale(t))},ZS=function(){function e(t){this.names=[],this.scales=[],this.linear=!1,this.values=[],this.callback=function(){return[]},this._parseCfg(t)}return e.prototype.mapping=function(){for(var t=this,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i=r.map(function(a,o){return t._toOriginParam(a,t.scales[o])});return this.callback.apply(this,i)},e.prototype.getLinearValue=function(t){var r=this.values.length-1,n=Math.floor(r*t),i=r*t-n,a=this.values[n],o=n===r?a:this.values[n+1];return a+(o-a)*i},e.prototype.getNames=function(){for(var t=this.scales,r=this.names,n=Math.min(t.length,r.length),i=[],a=0;a<n;a+=1)i.push(r[a]);return i},e.prototype.getFields=function(){return this.scales.map(function(t){return t.field})},e.prototype.getScale=function(t){return this.scales[this.names.indexOf(t)]},e.prototype.defaultCallback=function(){for(var t=this,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return r.length===0?this.values:r.map(function(i,a){var o=t.scales[a];return o.type==="identity"?o.values[0]:t._getAttributeValue(o,i)})},e.prototype._parseCfg=function(t){var r=this,n=t.type,i=n===void 0?"base":n,a=t.names,o=a===void 0?[]:a,s=t.scales,l=s===void 0?[]:s,u=t.values,c=u===void 0?[]:u,f=t.callback;this.type=i,this.scales=l,this.values=c,this.names=o,this.callback=function(){for(var d=[],v=0;v<arguments.length;v++)d[v]=arguments[v];if(f){var g=f.apply(void 0,d);if(!ke(g))return[g]}return r.defaultCallback.apply(r,d)}},e.prototype._getAttributeValue=function(t,r){if(t.isCategory&&!this.linear){var n=t.translate(r);return this.values[n%this.values.length]}var i=t.scale(r);return this.getLinearValue(i)},e.prototype._toOriginParam=function(t,r){return r.isLinear?t:ze(t)?t.map(function(n){return KX(r,n)}):KX(r,t)},e}(),Age=/rgba?\(([\s.,0-9]+)\)/,Mge=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,Rge=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,Ige=/[\d.]+:(#[^\s]+|[^\)]+\))/gi,Lge=function(e){return/^[r,R,L,l]{1}[\s]*\(/.test(e)},Oge=function(){var e=document.createElement("i");return e.title="Web Colour Picker",e.style.display="none",document.body.appendChild(e),e},fP=function(e,t,r,n){return e[n]+(t[n]-e[n])*r};function hst(e){return"#"+dP(e[0])+dP(e[1])+dP(e[2])}var fst=function(e){return[parseInt(e.substr(1,2),16),parseInt(e.substr(3,2),16),parseInt(e.substr(5,2),16)]},dP=function(e){var t=Math.round(e).toString(16);return t.length===1?"0"+t:t},Pge=function(e,t){var r=isNaN(Number(t))||t<0?0:t>1?1:Number(t),n=e.length-1,i=Math.floor(n*r),a=n*r-i,o=e[i],s=i===n?o:e[i+1];return hst([fP(o,s,a,0),fP(o,s,a,1),fP(o,s,a,2)])},QT,dst=function(e){if(e[0]==="#"&&e.length===7)return e;QT||(QT=Oge()),QT.style.color=e;var t=document.defaultView.getComputedStyle(QT,"").getPropertyValue("color"),r=Age.exec(t),n=r[1].split(/\s*,\s*/).map(function(i){return Number(i)});return t=hst(n),t},Dge=function(e){var t=nn(e)?e.split("-"):e,r=mo(t,function(n){return fst(n.indexOf("#")===-1?dst(n):n)});return function(n){return Pge(r,n)}},Fge=function(e){if(Lge(e)){var t,r=void 0;if(e[0]==="l"){var n=Mge.exec(e),i=+n[1]+90;r=n[2],t="linear-gradient("+i+"deg, "}else if(e[0]==="r"){t="radial-gradient(";var n=Rge.exec(e);r=n[4]}var a=r.match(Ige);return ft(a,function(o,s){var l=o.split(":");t+=l[1]+" "+l[0]*100+"%",s!==a.length-1&&(t+=", ")}),t+=")",t}return e};const Um={rgb2arr:fst,gradient:Dge,toRGB:wb(dst),toCSSGradient:Fge};var Bge=function(e){Ut(t,e);function t(r){var n=e.call(this,r)||this;return n.type="color",n.names=["color"],nn(n.values)&&(n.linear=!0),n.gradient=Um.gradient(n.values),n}return t.prototype.getLinearValue=function(r){return this.gradient(r)},t}(ZS),Nge=function(e){Ut(t,e);function t(r){var n=e.call(this,r)||this;return n.type="opacity",n.names=["opacity"],n}return t}(ZS),kge=function(e){Ut(t,e);function t(r){var n=e.call(this,r)||this;return n.names=["x","y"],n.type="position",n}return t.prototype.mapping=function(r,n){var i=this.scales,a=i[0],o=i[1];return ke(r)||ke(n)?[]:[ze(r)?r.map(function(s){return a.scale(s)}):a.scale(r),ze(n)?n.map(function(s){return o.scale(s)}):o.scale(n)]},t}(ZS),zge=function(e){Ut(t,e);function t(r){var n=e.call(this,r)||this;return n.type="shape",n.names=["shape"],n}return t.prototype.getLinearValue=function(r){var n=Math.round((this.values.length-1)*r);return this.values[n]},t}(ZS),Uge=function(e){Ut(t,e);function t(r){var n=e.call(this,r)||this;return n.type="size",n.names=["size"],n}return t}(ZS),pst={};function $ge(e){return pst[e]}function ov(e,t){pst[e]=t}var e6=function(){function e(t){this.type="base",this.isCategory=!1,this.isLinear=!1,this.isContinuous=!1,this.isIdentity=!1,this.values=[],this.range=[0,1],this.ticks=[],this.__cfg__=t,this.initCfg(),this.init()}return e.prototype.translate=function(t){return t},e.prototype.change=function(t){Sa(this.__cfg__,t),this.init()},e.prototype.clone=function(){return this.constructor(this.__cfg__)},e.prototype.getTicks=function(){var t=this;return mo(this.ticks,function(r,n){return qi(r)?r:{text:t.getText(r,n),tickValue:r,value:t.scale(r)}})},e.prototype.getText=function(t,r){var n=this.formatter,i=n?n(t,r):t;return ke(i)||!$r(i.toString)?"":i.toString()},e.prototype.getConfig=function(t){return this.__cfg__[t]},e.prototype.init=function(){Sa(this,this.__cfg__),this.setDomain(),Kc(this.getConfig("ticks"))&&(this.ticks=this.calculateTicks())},e.prototype.initCfg=function(){},e.prototype.setDomain=function(){},e.prototype.calculateTicks=function(){var t=this.tickMethod,r=[];if(nn(t)){var n=$ge(t);if(!n)throw new Error("There is no method to to calculate ticks!");r=n(this)}else $r(t)&&(r=t(this));return r},e.prototype.rangeMin=function(){return this.range[0]},e.prototype.rangeMax=function(){return this.range[1]},e.prototype.calcPercent=function(t,r,n){return Gn(t)?(t-r)/(n-r):NaN},e.prototype.calcValue=function(t,r,n){return r+t*(n-r)},e}(),R3=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="cat",r.isCategory=!0,r}return t.prototype.buildIndexMap=function(){if(!this.translateIndexMap){this.translateIndexMap=new Map;for(var r=0;r<this.values.length;r++)this.translateIndexMap.set(this.values[r],r)}},t.prototype.translate=function(r){this.buildIndexMap();var n=this.translateIndexMap.get(r);return n===void 0&&(n=Gn(r)?r:NaN),n},t.prototype.scale=function(r){var n=this.translate(r),i=this.calcPercent(n,this.min,this.max);return this.calcValue(i,this.rangeMin(),this.rangeMax())},t.prototype.invert=function(r){var n=this.max-this.min,i=this.calcPercent(r,this.rangeMin(),this.rangeMax()),a=Math.round(n*i)+this.min;return a<this.min||a>this.max?NaN:this.values[a]},t.prototype.getText=function(r){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var a=r;return Gn(r)&&!this.values.includes(r)&&(a=this.values[a]),e.prototype.getText.apply(this,Wy([a],n))},t.prototype.initCfg=function(){this.tickMethod="cat"},t.prototype.setDomain=function(){if(ke(this.getConfig("min"))&&(this.min=0),ke(this.getConfig("max"))){var r=this.values.length;this.max=r>1?r-1:r}this.translateIndexMap&&(this.translateIndexMap=void 0)},t}(e6),vst=/d{1,4}|M{1,4}|YY(?:YY)?|S{1,3}|Do|ZZ|Z|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g,dm="\\d\\d?",um="\\d\\d",Hge="\\d{3}",Vge="\\d{4}",jw="[^\\s]+",gst=/\[([^]*?)\]/gm;function mst(e,t){for(var r=[],n=0,i=e.length;n<i;n++)r.push(e[n].substr(0,t));return r}var QX=function(e){return function(t,r){var n=r[e].map(function(a){return a.toLowerCase()}),i=n.indexOf(t.toLowerCase());return i>-1?i:null}};function i0(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n=0,i=t;n<i.length;n++){var a=i[n];for(var o in a)e[o]=a[o]}return e}var yst=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],_st=["January","February","March","April","May","June","July","August","September","October","November","December"],Gge=mst(_st,3),Wge=mst(yst,3),r6={dayNamesShort:Wge,dayNames:yst,monthNamesShort:Gge,monthNames:_st,amPm:["am","pm"],DoFn:function(e){return e+["th","st","nd","rd"][e%10>3?0:(e-e%10!==10?1:0)*e%10]}},IR=i0({},r6),xst=function(e){return IR=i0(IR,e)},JX=function(e){return e.replace(/[|\\{()[^$+*?.-]/g,"\\$&")},Lc=function(e,t){for(t===void 0&&(t=2),e=String(e);e.length<t;)e="0"+e;return e},Xge={D:function(e){return String(e.getDate())},DD:function(e){return Lc(e.getDate())},Do:function(e,t){return t.DoFn(e.getDate())},d:function(e){return String(e.getDay())},dd:function(e){return Lc(e.getDay())},ddd:function(e,t){return t.dayNamesShort[e.getDay()]},dddd:function(e,t){return t.dayNames[e.getDay()]},M:function(e){return String(e.getMonth()+1)},MM:function(e){return Lc(e.getMonth()+1)},MMM:function(e,t){return t.monthNamesShort[e.getMonth()]},MMMM:function(e,t){return t.monthNames[e.getMonth()]},YY:function(e){return Lc(String(e.getFullYear()),4).substr(2)},YYYY:function(e){return Lc(e.getFullYear(),4)},h:function(e){return String(e.getHours()%12||12)},hh:function(e){return Lc(e.getHours()%12||12)},H:function(e){return String(e.getHours())},HH:function(e){return Lc(e.getHours())},m:function(e){return String(e.getMinutes())},mm:function(e){return Lc(e.getMinutes())},s:function(e){return String(e.getSeconds())},ss:function(e){return Lc(e.getSeconds())},S:function(e){return String(Math.round(e.getMilliseconds()/100))},SS:function(e){return Lc(Math.round(e.getMilliseconds()/10),2)},SSS:function(e){return Lc(e.getMilliseconds(),3)},a:function(e,t){return e.getHours()<12?t.amPm[0]:t.amPm[1]},A:function(e,t){return e.getHours()<12?t.amPm[0].toUpperCase():t.amPm[1].toUpperCase()},ZZ:function(e){var t=e.getTimezoneOffset();return(t>0?"-":"+")+Lc(Math.floor(Math.abs(t)/60)*100+Math.abs(t)%60,4)},Z:function(e){var t=e.getTimezoneOffset();return(t>0?"-":"+")+Lc(Math.floor(Math.abs(t)/60),2)+":"+Lc(Math.abs(t)%60,2)}},tj=function(e){return+e-1},ej=[null,dm],rj=[null,jw],nj=["isPm",jw,function(e,t){var r=e.toLowerCase();return r===t.amPm[0]?0:r===t.amPm[1]?1:null}],ij=["timezoneOffset","[^\\s]*?[\\+\\-]\\d\\d:?\\d\\d|[^\\s]*?Z?",function(e){var t=(e+"").match(/([+-]|\d\d)/gi);if(t){var r=+t[1]*60+parseInt(t[2],10);return t[0]==="+"?r:-r}return 0}],jge={D:["day",dm],DD:["day",um],Do:["day",dm+jw,function(e){return parseInt(e,10)}],M:["month",dm,tj],MM:["month",um,tj],YY:["year",um,function(e){var t=new Date,r=+(""+t.getFullYear()).substr(0,2);return+(""+(+e>68?r-1:r)+e)}],h:["hour",dm,void 0,"isPm"],hh:["hour",um,void 0,"isPm"],H:["hour",dm],HH:["hour",um],m:["minute",dm],mm:["minute",um],s:["second",dm],ss:["second",um],YYYY:["year",Vge],S:["millisecond","\\d",function(e){return+e*100}],SS:["millisecond",um,function(e){return+e*10}],SSS:["millisecond",Hge],d:ej,dd:ej,ddd:rj,dddd:rj,MMM:["month",jw,QX("monthNamesShort")],MMMM:["month",jw,QX("monthNames")],a:nj,A:nj,ZZ:ij,Z:ij},LR={default:"ddd MMM DD YYYY HH:mm:ss",shortDate:"M/D/YY",mediumDate:"MMM D, YYYY",longDate:"MMMM D, YYYY",fullDate:"dddd, MMMM D, YYYY",isoDate:"YYYY-MM-DD",isoDateTime:"YYYY-MM-DDTHH:mm:ssZ",shortTime:"HH:mm",mediumTime:"HH:mm:ss",longTime:"HH:mm:ss.SSS"},bst=function(e){return i0(LR,e)},Est=function(e,t,r){if(t===void 0&&(t=LR.default),r===void 0&&(r={}),typeof e=="number"&&(e=new Date(e)),Object.prototype.toString.call(e)!=="[object Date]"||isNaN(e.getTime()))throw new Error("Invalid Date pass to format");t=LR[t]||t;var n=[];t=t.replace(gst,function(a,o){return n.push(o),"@@@"});var i=i0(i0({},IR),r);return t=t.replace(vst,function(a){return Xge[a](e,i)}),t.replace(/@@@/g,function(){return n.shift()})};function wst(e,t,r){if(r===void 0&&(r={}),typeof t!="string")throw new Error("Invalid format in fecha parse");if(t=LR[t]||t,e.length>1e3)return null;var n=new Date,i={year:n.getFullYear(),month:0,day:1,hour:0,minute:0,second:0,millisecond:0,isPm:null,timezoneOffset:null},a=[],o=[],s=t.replace(gst,function(R,O){return o.push(JX(O)),"@@@"}),l={},u={};s=JX(s).replace(vst,function(R){var O=jge[R],N=O[0],k=O[1],V=O[3];if(l[N])throw new Error("Invalid format. "+N+" specified twice in format");return l[N]=!0,V&&(u[V]=!0),a.push(O),"("+k+")"}),Object.keys(u).forEach(function(R){if(!l[R])throw new Error("Invalid format. "+R+" is required in specified format")}),s=s.replace(/@@@/g,function(){return o.shift()});var c=e.match(new RegExp(s,"i"));if(!c)return null;for(var f=i0(i0({},IR),r),d=1;d<c.length;d++){var v=a[d-1],g=v[0],x=v[2],w=x?x(c[d],f):+c[d];if(w==null)return null;i[g]=w}i.isPm===1&&i.hour!=null&&+i.hour!=12?i.hour=+i.hour+12:i.isPm===0&&+i.hour==12&&(i.hour=0);var S;if(i.timezoneOffset==null){S=new Date(i.year,i.month,i.day,i.hour,i.minute,i.second,i.millisecond);for(var A=[["month","getMonth"],["day","getDate"],["hour","getHours"],["minute","getMinutes"],["second","getSeconds"]],d=0,M=A.length;d<M;d++)if(l[A[d][0]]&&i[A[d][0]]!==S[A[d][1]]())return null}else if(S=new Date(Date.UTC(i.year,i.month,i.day,i.hour,i.minute-i.timezoneOffset,i.second,i.millisecond)),i.month>11||i.month<0||i.day>31||i.day<1||i.hour>23||i.hour<0||i.minute>59||i.minute<0||i.second>59||i.second<0)return null;return S}var Cst={format:Est,parse:wst,defaultI18n:r6,setGlobalDateI18n:xst,setGlobalDateMasks:bst};const Yge=Object.freeze(Object.defineProperty({__proto__:null,assign:i0,default:Cst,defaultI18n:r6,format:Est,parse:wst,setGlobalDateI18n:xst,setGlobalDateMasks:bst},Symbol.toStringTag,{value:"Module"}));function Zge(e){return function(t,r,n,i){for(var a=ke(n)?0:n,o=ke(i)?t.length:i;a<o;){var s=a+o>>>1;e(t[s])>r?o=s:a=s+1}return a}}var aj="format";function Sst(e,t){var r=Yge[aj]||Cst[aj];return r(e,t)}function OR(e){return nn(e)&&(e.indexOf("T")>0?e=new Date(e).getTime():e=new Date(e.replace(/-/gi,"/")).getTime()),ytt(e)&&(e=e.getTime()),e}var Sd=1e3,Uy=60*Sd,$y=60*Uy,Qv=24*$y,Yw=Qv*31,oj=Qv*365,QE=[["HH:mm:ss",Sd],["HH:mm:ss",Sd*10],["HH:mm:ss",Sd*30],["HH:mm",Uy],["HH:mm",Uy*10],["HH:mm",Uy*30],["HH",$y],["HH",$y*6],["HH",$y*12],["YYYY-MM-DD",Qv],["YYYY-MM-DD",Qv*4],["YYYY-WW",Qv*7],["YYYY-MM",Yw],["YYYY-MM",Yw*4],["YYYY-MM",Yw*6],["YYYY",Qv*380]];function qge(e,t,r){var n=(t-e)/r,i=Zge(function(o){return o[1]})(QE,n)-1,a=QE[i];return i<0?a=QE[0]:i>=QE.length&&(a=Gs(QE)),a}var Kge=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="timeCat",r}return t.prototype.translate=function(r){r=OR(r);var n=this.values.indexOf(r);return n===-1&&(Gn(r)&&r<this.values.length?n=r:n=NaN),n},t.prototype.getText=function(r,n){var i=this.translate(r);if(i>-1){var a=this.values[i],o=this.formatter;return a=o?o(a,n):Sst(a,this.mask),a}return r},t.prototype.initCfg=function(){this.tickMethod="time-cat",this.mask="YYYY-MM-DD",this.tickCount=7},t.prototype.setDomain=function(){var r=this.values;ft(r,function(n,i){r[i]=OR(n)}),r.sort(function(n,i){return n-i}),e.prototype.setDomain.call(this)},t}(R3),I3=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.isContinuous=!0,r}return t.prototype.scale=function(r){if(ke(r))return NaN;var n=this.rangeMin(),i=this.rangeMax(),a=this.max,o=this.min;if(a===o)return n;var s=this.getScalePercent(r);return n+s*(i-n)},t.prototype.init=function(){e.prototype.init.call(this);var r=this.ticks,n=Oh(r),i=Gs(r);n<this.min&&(this.min=n),i>this.max&&(this.max=i),ke(this.minLimit)||(this.min=n),ke(this.maxLimit)||(this.max=i)},t.prototype.setDomain=function(){var r=vtt(this.values),n=r.min,i=r.max;ke(this.min)&&(this.min=n),ke(this.max)&&(this.max=i),this.min>this.max&&(this.min=n,this.max=i)},t.prototype.calculateTicks=function(){var r=this,n=e.prototype.calculateTicks.call(this);return this.nice||(n=Wl(n,function(i){return i>=r.min&&i<=r.max})),n},t.prototype.getScalePercent=function(r){var n=this.max,i=this.min;return(r-i)/(n-i)},t.prototype.getInvertPercent=function(r){return(r-this.rangeMin())/(this.rangeMax()-this.rangeMin())},t}(e6),L3=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="linear",r.isLinear=!0,r}return t.prototype.invert=function(r){var n=this.getInvertPercent(r);return this.min+n*(this.max-this.min)},t.prototype.initCfg=function(){this.tickMethod="wilkinson-extended",this.nice=!1},t}(I3);function xm(e,t){var r=Math.E,n;return t>=0?n=Math.pow(r,Math.log(t)/e):n=Math.pow(r,Math.log(-t)/e)*-1,n}function Mf(e,t){return e===1?1:Math.log(t)/Math.log(e)}function Tst(e,t,r){ke(r)&&(r=Math.max.apply(null,e));var n=r;return ft(e,function(i){i>0&&i<n&&(n=i)}),n===r&&(n=r/t),n>1&&(n=1),n}var Qge=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="log",r}return t.prototype.invert=function(r){var n=this.base,i=Mf(n,this.max),a=this.rangeMin(),o=this.rangeMax()-a,s,l=this.positiveMin;if(l){if(r===0)return 0;s=Mf(n,l/n);var u=1/(i-s)*o;if(r<u)return r/u*l}else s=Mf(n,this.min);var c=(r-a)/o,f=c*(i-s)+s;return Math.pow(n,f)},t.prototype.initCfg=function(){this.tickMethod="log",this.base=10,this.tickCount=6,this.nice=!0},t.prototype.setDomain=function(){e.prototype.setDomain.call(this);var r=this.min;if(r<0)throw new Error("When you use log scale, the minimum value must be greater than zero!");r===0&&(this.positiveMin=Tst(this.values,this.base,this.max))},t.prototype.getScalePercent=function(r){var n=this.max,i=this.min;if(n===i||r<=0)return 0;var a=this.base,o=this.positiveMin;o&&(i=o*1/a);var s;return r<o?s=r/o/(Mf(a,n)-Mf(a,i)):s=(Mf(a,r)-Mf(a,i))/(Mf(a,n)-Mf(a,i)),s},t}(I3),Jge=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="pow",r}return t.prototype.invert=function(r){var n=this.getInvertPercent(r),i=this.exponent,a=xm(i,this.max),o=xm(i,this.min),s=n*(a-o)+o,l=s>=0?1:-1;return Math.pow(s,i)*l},t.prototype.initCfg=function(){this.tickMethod="pow",this.exponent=2,this.tickCount=5,this.nice=!0},t.prototype.getScalePercent=function(r){var n=this.max,i=this.min;if(n===i)return 0;var a=this.exponent,o=(xm(a,r)-xm(a,i))/(xm(a,n)-xm(a,i));return o},t}(I3),tme=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="time",r}return t.prototype.getText=function(r,n){var i=this.translate(r),a=this.formatter;return a?a(i,n):Sst(i,this.mask)},t.prototype.scale=function(r){var n=r;return(nn(n)||ytt(n))&&(n=this.translate(n)),e.prototype.scale.call(this,n)},t.prototype.translate=function(r){return OR(r)},t.prototype.initCfg=function(){this.tickMethod="time-pretty",this.mask="YYYY-MM-DD",this.tickCount=7,this.nice=!1},t.prototype.setDomain=function(){var r=this.values,n=this.getConfig("min"),i=this.getConfig("max");if((!ke(n)||!Gn(n))&&(this.min=this.translate(this.min)),(!ke(i)||!Gn(i))&&(this.max=this.translate(this.max)),r&&r.length){var a=[],o=1/0,s=o,l=0;ft(r,function(u){var c=OR(u);if(isNaN(c))throw new TypeError("Invalid Time: "+u+" in time scale!");o>c?(s=o,o=c):s>c&&(s=c),l<c&&(l=c),a.push(c)}),r.length>1&&(this.minTickInterval=s-o),ke(n)&&(this.min=o),ke(i)&&(this.max=l)}},t}(L3),Ast=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="quantize",r}return t.prototype.invert=function(r){var n=this.ticks,i=n.length,a=this.getInvertPercent(r),o=Math.floor(a*(i-1));if(o>=i-1)return Gs(n);if(o<0)return Oh(n);var s=n[o],l=n[o+1],u=o/(i-1),c=(o+1)/(i-1);return s+(a-u)/(c-u)*(l-s)},t.prototype.initCfg=function(){this.tickMethod="r-pretty",this.tickCount=5,this.nice=!0},t.prototype.calculateTicks=function(){var r=e.prototype.calculateTicks.call(this);return this.nice||(Gs(r)!==this.max&&r.push(this.max),Oh(r)!==this.min&&r.unshift(this.min)),r},t.prototype.getScalePercent=function(r){var n=this.ticks;if(r<Oh(n))return 0;if(r>Gs(n))return 1;var i=0;return ft(n,function(a,o){if(r>=a)i=o;else return!1}),i/(n.length-1)},t}(I3),eme=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="quantile",r}return t.prototype.initCfg=function(){this.tickMethod="quantile",this.tickCount=5,this.nice=!0},t}(Ast),Mst={};function zB(e){return Mst[e]}function sv(e,t){if(zB(e))throw new Error("type '"+e+"' existed.");Mst[e]=t}var rme=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="identity",r.isIdentity=!0,r}return t.prototype.calculateTicks=function(){return this.values},t.prototype.scale=function(r){return this.values[0]!==r&&Gn(r)?r:this.range[0]},t.prototype.invert=function(r){var n=this.range;return r<n[0]||r>n[1]?NaN:this.values[0]},t}(e6);function Rst(e){var t=e.values,r=e.tickInterval,n=e.tickCount,i=e.showLast;if(Gn(r)){var a=Wl(t,function(g,x){return x%r===0}),o=Gs(t);return i&&Gs(a)!==o&&a.push(o),a}var s=t.length,l=e.min,u=e.max;if(ke(l)&&(l=0),ke(u)&&(u=t.length-1),!Gn(n)||n>=s)return t.slice(l,u+1);if(n<=0||u<=0)return[];for(var c=n===1?s:Math.floor(s/(n-1)),f=[],d=l,v=0;v<n&&!(d>=u);v++)d=Math.min(l+v*c,u),v===n-1&&i?f.push(t[u]):f.push(t[d]);return f}function nme(e){var t=e.min,r=e.max,n=e.nice,i=e.tickCount,a=new ime;return a.domain([t,r]),n&&a.nice(i),a.ticks(i)}var pP=5,sj=Math.sqrt(50),lj=Math.sqrt(10),uj=Math.sqrt(2),ime=function(){function e(){this._domain=[0,1]}return e.prototype.domain=function(t){return t?(this._domain=Array.from(t,Number),this):this._domain.slice()},e.prototype.nice=function(t){var r,n;t===void 0&&(t=pP);var i=this._domain.slice(),a=0,o=this._domain.length-1,s=this._domain[a],l=this._domain[o],u;return l<s&&(r=[l,s],s=r[0],l=r[1],n=[o,a],a=n[0],o=n[1]),u=jA(s,l,t),u>0?(s=Math.floor(s/u)*u,l=Math.ceil(l/u)*u,u=jA(s,l,t)):u<0&&(s=Math.ceil(s*u)/u,l=Math.floor(l*u)/u,u=jA(s,l,t)),u>0?(i[a]=Math.floor(s/u)*u,i[o]=Math.ceil(l/u)*u,this.domain(i)):u<0&&(i[a]=Math.ceil(s*u)/u,i[o]=Math.floor(l*u)/u,this.domain(i)),this},e.prototype.ticks=function(t){return t===void 0&&(t=pP),ame(this._domain[0],this._domain[this._domain.length-1],t||pP)},e}();function ame(e,t,r){var n,i=-1,a,o,s;if(t=+t,e=+e,r=+r,e===t&&r>0)return[e];if((n=t<e)&&(a=e,e=t,t=a),(s=jA(e,t,r))===0||!isFinite(s))return[];if(s>0)for(e=Math.ceil(e/s),t=Math.floor(t/s),o=new Array(a=Math.ceil(t-e+1));++i<a;)o[i]=(e+i)*s;else for(e=Math.floor(e*s),t=Math.ceil(t*s),o=new Array(a=Math.ceil(e-t+1));++i<a;)o[i]=(e-i)/s;return n&&o.reverse(),o}function jA(e,t,r){var n=(t-e)/Math.max(0,r),i=Math.floor(Math.log(n)/Math.LN10),a=n/Math.pow(10,i);return i>=0?(a>=sj?10:a>=lj?5:a>=uj?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=sj?10:a>=lj?5:a>=uj?2:1)}function cj(e,t,r){var n;return r==="ceil"?n=Math.ceil(e/t):r==="floor"?n=Math.floor(e/t):n=Math.round(e/t),n*t}function n6(e,t,r){var n=cj(e,r,"floor"),i=cj(t,r,"ceil");n=OO(n,r),i=OO(i,r);for(var a=[],o=Math.max((i-n)/(Math.pow(2,12)-1),r),s=n;s<=i;s=s+o){var l=OO(s,o);a.push(l)}return{min:n,max:i,ticks:a}}function i6(e,t,r){var n,i=e.minLimit,a=e.maxLimit,o=e.min,s=e.max,l=e.tickCount,u=l===void 0?5:l,c=ke(i)?ke(t)?o:t:i,f=ke(a)?ke(r)?s:r:a;if(c>f&&(n=[c,f],f=n[0],c=n[1]),u<=2)return[c,f];for(var d=(f-c)/(u-1),v=[],g=0;g<u;g++)v.push(c+d*g);return v}function ome(e){var t=e.min,r=e.max,n=e.tickInterval,i=e.minLimit,a=e.maxLimit,o=nme(e);return!ke(i)||!ke(a)?i6(e,Oh(o),Gs(o)):n?n6(t,r,n).ticks:o}function py(e){return Math.abs(e)<1e-15?e:parseFloat(e.toFixed(15))}var sme=[1,5,2,2.5,4,3],hj=Number.EPSILON*100;function lme(e,t){return(e%t+t)%t}function ume(e){return Math.round(e*1e12)/1e12}function cme(e,t,r,n,i,a){var o=_l(t),s=Ett(t,e),l=0,u=lme(n,a);return(u<hj||a-u<hj)&&n<=0&&i>=0&&(l=1),1-s/(o-1)-r+l}function hme(e,t,r){var n=_l(t),i=Ett(t,e),a=1;return 1-i/(n-1)-r+a}function fme(e,t,r,n,i,a){var o=(e-1)/(a-i),s=(t-1)/(Math.max(a,n)-Math.min(r,i));return 2-Math.max(o/s,s/o)}function dme(e,t){return e>=t?2-(e-1)/(t-1):1}function pme(e,t,r,n){var i=t-e;return 1-.5*(Math.pow(t-n,2)+Math.pow(e-r,2))/Math.pow(.1*i,2)}function vme(e,t,r){var n=t-e;if(r>n){var i=(r-n)/2;return 1-Math.pow(i,2)/Math.pow(.1*n,2)}return 1}function gme(){return 1}function mme(e,t,r,n,i,a){r===void 0&&(r=5),n===void 0&&(n=!0),i===void 0&&(i=sme),a===void 0&&(a=[.25,.2,.5,.05]);var o=r<0?0:Math.round(r);if(Number.isNaN(e)||Number.isNaN(t)||typeof e!="number"||typeof t!="number"||!o)return{min:0,max:0,ticks:[]};if(t-e<1e-15||o===1)return{min:e,max:t,ticks:[e]};if(t-e>1e148){var s=r||5,l=(t-e)/s;return{min:e,max:t,ticks:Array(s).fill(null).map(function(fe,Oe){return py(e+l*Oe)})}}for(var u={score:-2,lmin:0,lmax:0,lstep:0},c=1;c<1/0;){for(var f=0;f<i.length;f+=1){var d=i[f],v=hme(d,i,c);if(a[0]*v+a[1]+a[2]+a[3]<u.score){c=1/0;break}for(var g=2;g<1/0;){var x=dme(g,o);if(a[0]*v+a[1]+a[2]*x+a[3]<u.score)break;for(var w=(t-e)/(g+1)/c/d,S=Math.ceil(Math.log10(w));S<1/0;){var A=c*d*Math.pow(10,S),M=vme(e,t,A*(g-1));if(a[0]*v+a[1]*M+a[2]*x+a[3]<u.score)break;var R=Math.floor(t/A)*c-(g-1)*c,O=Math.ceil(e/A)*c;if(R<=O)for(var s=O-R,N=0;N<=s;N+=1){var k=R+N,V=k*(A/c),Q=V+A*(g-1),Y=A,X=cme(d,i,c,V,Q,Y),tt=pme(e,t,V,Q),it=fme(g,o,e,t,V,Q),Et=gme(),Tt=a[0]*X+a[1]*tt+a[2]*it+a[3]*Et;Tt>u.score&&(!n||V<=e&&Q>=t)&&(u.lmin=V,u.lmax=Q,u.lstep=Y,u.score=Tt)}S+=1}g+=1}}c+=1}var pt=py(u.lmax),kt=py(u.lmin),ae=py(u.lstep),Kt=Math.floor(ume((pt-kt)/ae))+1,re=new Array(Kt);re[0]=py(kt);for(var f=1;f<Kt;f++)re[f]=py(re[f-1]+ae);return{min:Math.min(e,Oh(re)),max:Math.max(t,Gs(re)),ticks:re}}function yme(e){var t=e.min,r=e.max,n=e.tickCount,i=e.nice,a=e.tickInterval,o=e.minLimit,s=e.maxLimit,l=mme(t,r,n,i).ticks;return!ke(o)||!ke(s)?i6(e,Oh(l),Gs(l)):a?n6(t,r,a).ticks:l}function _me(e){var t=e.base,r=e.tickCount,n=e.min,i=e.max,a=e.values,o,s=Mf(t,i);if(n>0)o=Math.floor(Mf(t,n));else{var l=Tst(a,t,i);o=Math.floor(Mf(t,l))}for(var u=s-o,c=Math.ceil(u/r),f=[],d=o;d<s+c;d=d+c)f.push(Math.pow(t,d));return n<=0&&f.unshift(0),f}function Ist(e,t,r){if(r===void 0&&(r=5),e===t)return{max:t,min:e,ticks:[e]};var n=r<0?0:Math.round(r);if(n===0)return{max:t,min:e,ticks:[]};var i=1.5,a=.5+1.5*i,o=t-e,s=o/n,l=Math.pow(10,Math.floor(Math.log10(s))),u=l;2*l-s<i*(s-u)&&(u=2*l,5*l-s<a*(s-u)&&(u=5*l,10*l-s<i*(s-u)&&(u=10*l)));for(var c=Math.ceil(t/u),f=Math.floor(e/u),d=Math.max(c*u,t),v=Math.min(f*u,e),g=Math.floor((d-v)/u)+1,x=new Array(g),w=0;w<g;w++)x[w]=py(v+w*u);return{min:v,max:d,ticks:x}}function xme(e){var t=e.exponent,r=e.tickCount,n=Math.ceil(xm(t,e.max)),i=Math.floor(xm(t,e.min)),a=Ist(i,n,r).ticks;return a.map(function(o){var s=o>=0?1:-1;return Math.pow(o,t)*s})}function bme(e,t){var r=e.length*t;return t===1?e[e.length-1]:t===0?e[0]:r%1!==0?e[Math.ceil(r)-1]:e.length%2===0?(e[r-1]+e[r])/2:e[r]}function Eme(e){var t=e.tickCount,r=e.values;if(!r||!r.length)return[];for(var n=r.slice().sort(function(s,l){return s-l}),i=[],a=0;a<t;a++){var o=a/(t-1);i.push(bme(n,o))}return i}function wme(e){var t=e.min,r=e.max,n=e.tickCount,i=e.tickInterval,a=e.minLimit,o=e.maxLimit,s=Ist(t,r,n).ticks;return!ke(a)||!ke(o)?i6(e,Oh(s),Gs(s)):i?n6(t,r,i).ticks:s}function Cme(e){var t=e.min,r=e.max,n=e.minTickInterval,i=e.tickInterval,a=e.tickCount;if(i)a=Math.ceil((r-t)/i);else{i=qge(t,r,a)[1];var o=(r-t)/i,s=o/a;s>1&&(i=i*Math.ceil(s)),n&&i<n&&(i=n)}i=Math.max(Math.floor((r-t)/(Math.pow(2,12)-1)),i);for(var l=[],u=t;u<r+i;u+=i)l.push(u);return l}function Sme(e){var t=Rst(U({showLast:!0},e));return t}function PR(e){return new Date(e).getFullYear()}function Tme(e){return new Date(e,0,1).getTime()}function UB(e){return new Date(e).getMonth()}function Ame(e,t){var r=PR(e),n=PR(t),i=UB(e),a=UB(t);return(n-r)*12+(a-i)%12}function Mme(e,t){return new Date(e,t,1).getTime()}function Rme(e,t){return Math.ceil((t-e)/Qv)}function Ime(e,t){return Math.ceil((t-e)/$y)}function Lme(e,t){return Math.ceil((t-e)/(60*1e3))}function Ome(e){var t=e.min,r=e.max,n=e.minTickInterval,i=e.tickCount,a=e.tickInterval,o=[];a||(a=(r-t)/i,n&&a<n&&(a=n)),a=Math.max(Math.floor((r-t)/(Math.pow(2,12)-1)),a);var s=PR(t);if(a>oj)for(var l=PR(r),u=Math.ceil(a/oj),c=s;c<=l+u;c=c+u)o.push(Tme(c));else if(a>Yw)for(var f=Math.ceil(a/Yw),d=UB(t),v=Ame(t,r),c=0;c<=v+f;c=c+f)o.push(Mme(s,c+d));else if(a>Qv)for(var g=new Date(t),x=g.getFullYear(),w=g.getMonth(),S=g.getDate(),A=Math.ceil(a/Qv),M=Rme(t,r),c=0;c<M+A;c=c+A)o.push(new Date(x,w,S+c).getTime());else if(a>$y)for(var g=new Date(t),x=g.getFullYear(),w=g.getMonth(),A=g.getDate(),R=g.getHours(),O=Math.ceil(a/$y),N=Ime(t,r),c=0;c<=N+O;c=c+O)o.push(new Date(x,w,A,R+c).getTime());else if(a>Uy)for(var k=Lme(t,r),V=Math.ceil(a/Uy),c=0;c<=k+V;c=c+V)o.push(t+c*Uy);else{var Q=a;Q<Sd&&(Q=Sd);for(var Y=Math.floor(t/Sd)*Sd,X=Math.ceil((r-t)/Sd),tt=Math.ceil(Q/Sd),c=0;c<X+tt;c=c+tt)o.push(Y+c*Sd)}return o.length>=512&&console.warn("Notice: current ticks length("+o.length+') >= 512, may cause performance issues, even out of memory. Because of the configure "tickInterval"(in milliseconds, current is '+a+") is too small, increase the value to solve the problem!"),o}ov("cat",Rst);ov("time-cat",Sme);ov("wilkinson-extended",yme);ov("r-pretty",wme);ov("time",Cme);ov("time-pretty",Ome);ov("log",_me);ov("pow",xme);ov("quantile",Eme);ov("d3-linear",ome);sv("cat",R3);sv("category",R3);sv("identity",rme);sv("linear",L3);sv("log",Qge);sv("pow",Jge);sv("time",tme);sv("timeCat",Kge);sv("quantize",Ast);sv("quantile",eme);var Lst={},Ost=function(e){return Lst[e.toLowerCase()]},qS=function(e,t){if(Ost(e))throw new Error("Attribute type '".concat(e,"' existed."));Lst[e.toLowerCase()]=t};qS("Color",Bge);qS("Opacity",Nge);qS("Position",kge);qS("Shape",zge);qS("Size",Uge);var a6=function(){function e(t){this.type="coordinate",this.isRect=!1,this.isHelix=!1,this.isPolar=!1,this.isReflectX=!1,this.isReflectY=!1;var r=t.start,n=t.end,i=t.matrix,a=i===void 0?[1,0,0,0,1,0,0,0,1]:i,o=t.isTransposed,s=o===void 0?!1:o;this.start=r,this.end=n,this.matrix=a,this.originalMatrix=an([],a),this.isTransposed=s}return e.prototype.initial=function(){this.center={x:(this.start.x+this.end.x)/2,y:(this.start.y+this.end.y)/2},this.width=Math.abs(this.end.x-this.start.x),this.height=Math.abs(this.end.y-this.start.y)},e.prototype.update=function(t){Sa(this,t),this.initial()},e.prototype.convertDim=function(t,r){var n,i=this[r],a=i.start,o=i.end;return this.isReflect(r)&&(n=[o,a],a=n[0],o=n[1]),a+t*(o-a)},e.prototype.invertDim=function(t,r){var n,i=this[r],a=i.start,o=i.end;return this.isReflect(r)&&(n=[o,a],a=n[0],o=n[1]),(t-a)/(o-a)},e.prototype.applyMatrix=function(t,r,n){n===void 0&&(n=0);var i=this.matrix,a=[t,r,n];return oC(a,a,i),a},e.prototype.invertMatrix=function(t,r,n){n===void 0&&(n=0);var i=this.matrix,a=WRt([0,0,0,0,0,0,0,0,0],i),o=[t,r,n];return a&&oC(o,o,a),o},e.prototype.convert=function(t){var r=this.convertPoint(t),n=r.x,i=r.y,a=this.applyMatrix(n,i,1);return{x:a[0],y:a[1]}},e.prototype.invert=function(t){var r=this.invertMatrix(t.x,t.y,1);return this.invertPoint({x:r[0],y:r[1]})},e.prototype.rotate=function(t){var r=this.matrix,n=this.center;return U1(r,r,[-n.x,-n.y]),N4(r,r,t),U1(r,r,[n.x,n.y]),this},e.prototype.reflect=function(t){return t==="x"?this.isReflectX=!this.isReflectX:this.isReflectY=!this.isReflectY,this},e.prototype.scale=function(t,r){var n=this.matrix,i=this.center;return U1(n,n,[-i.x,-i.y]),Ltt(n,n,[t,r]),U1(n,n,[i.x,i.y]),this},e.prototype.translate=function(t,r){var n=this.matrix;return U1(n,n,[t,r]),this},e.prototype.transpose=function(){return this.isTransposed=!this.isTransposed,this},e.prototype.getCenter=function(){return this.center},e.prototype.getWidth=function(){return this.width},e.prototype.getHeight=function(){return this.height},e.prototype.getRadius=function(){return this.radius},e.prototype.isReflect=function(t){return t==="x"?this.isReflectX:this.isReflectY},e.prototype.resetMatrix=function(t){this.matrix=t||an([],this.originalMatrix)},e}(),Pst=function(e){Ut(t,e);function t(r){var n=e.call(this,r)||this;return n.isRect=!0,n.type="cartesian",n.initial(),n}return t.prototype.initial=function(){e.prototype.initial.call(this);var r=this.start,n=this.end;this.x={start:r.x,end:n.x},this.y={start:r.y,end:n.y}},t.prototype.convertPoint=function(r){var n,i=r.x,a=r.y;return this.isTransposed&&(n=[a,i],i=n[0],a=n[1]),{x:this.convertDim(i,"x"),y:this.convertDim(a,"y")}},t.prototype.invertPoint=function(r){var n,i=this.invertDim(r.x,"x"),a=this.invertDim(r.y,"y");return this.isTransposed&&(n=[a,i],i=n[0],a=n[1]),{x:i,y:a}},t}(a6),Pme=function(e){Ut(t,e);function t(r){var n=e.call(this,r)||this;n.isHelix=!0,n.type="helix";var i=r.startAngle,a=i===void 0?1.25*Math.PI:i,o=r.endAngle,s=o===void 0?7.25*Math.PI:o,l=r.innerRadius,u=l===void 0?0:l,c=r.radius;return n.startAngle=a,n.endAngle=s,n.innerRadius=u,n.radius=c,n.initial(),n}return t.prototype.initial=function(){e.prototype.initial.call(this);var r=(this.endAngle-this.startAngle)/(2*Math.PI)+1,n=Math.min(this.width,this.height)/2;this.radius&&this.radius>=0&&this.radius<=1&&(n=n*this.radius),this.d=Math.floor(n*(1-this.innerRadius)/r),this.a=this.d/(Math.PI*2),this.x={start:this.startAngle,end:this.endAngle},this.y={start:this.innerRadius*n,end:this.innerRadius*n+this.d*.99}},t.prototype.convertPoint=function(r){var n,i=r.x,a=r.y;this.isTransposed&&(n=[a,i],i=n[0],a=n[1]);var o=this.convertDim(i,"x"),s=this.a*o,l=this.convertDim(a,"y");return{x:this.center.x+Math.cos(o)*(s+l),y:this.center.y+Math.sin(o)*(s+l)}},t.prototype.invertPoint=function(r){var n,i=this.d+this.y.start,a=pM([0,0],[r.x,r.y],[this.center.x,this.center.y]),o=k4(a,[1,0],!0),s=o*this.a;W1(a)<s&&(s=W1(a));var l=Math.floor((W1(a)-s)/i);o=2*l*Math.PI+o;var u=this.a*o,c=W1(a)-u;c=Ul(c,0)?0:c;var f=this.invertDim(o,"x"),d=this.invertDim(c,"y");return f=Ul(f,0)?0:f,d=Ul(d,0)?0:d,this.isTransposed&&(n=[d,f],f=n[0],d=n[1]),{x:f,y:d}},t}(a6),Dme=function(e){Ut(t,e);function t(r){var n=e.call(this,r)||this;n.isPolar=!0,n.type="polar";var i=r.startAngle,a=i===void 0?-Math.PI/2:i,o=r.endAngle,s=o===void 0?Math.PI*3/2:o,l=r.innerRadius,u=l===void 0?0:l,c=r.radius;return n.startAngle=a,n.endAngle=s,n.innerRadius=u,n.radius=c,n.initial(),n}return t.prototype.initial=function(){for(e.prototype.initial.call(this);this.endAngle<this.startAngle;)this.endAngle+=Math.PI*2;var r=this.getOneBox(),n=r.maxX-r.minX,i=r.maxY-r.minY,a=Math.abs(r.minX)/n,o=Math.abs(r.minY)/i,s;this.height/i>this.width/n?(s=this.width/n,this.circleCenter={x:this.center.x-(.5-a)*this.width,y:this.center.y-(.5-o)*s*i}):(s=this.height/i,this.circleCenter={x:this.center.x-(.5-a)*s*n,y:this.center.y-(.5-o)*this.height}),this.polarRadius=this.radius,this.radius?this.radius>0&&this.radius<=1?this.polarRadius=s*this.radius:(this.radius<=0||this.radius>s)&&(this.polarRadius=s):this.polarRadius=s,this.x={start:this.startAngle,end:this.endAngle},this.y={start:this.innerRadius*this.polarRadius,end:this.polarRadius}},t.prototype.getRadius=function(){return this.polarRadius},t.prototype.convertPoint=function(r){var n,i=this.getCenter(),a=r.x,o=r.y;return this.isTransposed&&(n=[o,a],a=n[0],o=n[1]),a=this.convertDim(a,"x"),o=this.convertDim(o,"y"),{x:i.x+Math.cos(a)*o,y:i.y+Math.sin(a)*o}},t.prototype.invertPoint=function(r){var n,i=this.getCenter(),a=[r.x-i.x,r.y-i.y],o=this,s=o.startAngle,l=o.endAngle;this.isReflect("x")&&(n=[l,s],s=n[0],l=n[1]);var u=[1,0,0,0,1,0,0,0,1];N4(u,u,s);var c=[1,0,0];oC(c,c,u);var f=[c[0],c[1]],d=k4(f,a,l<s);Ul(d,Math.PI*2)&&(d=0);var v=W1(a),g=d/(l-s);g=l-s>0?g:-g;var x=this.invertDim(v,"y"),w={x:0,y:0};return w.x=this.isTransposed?x:g,w.y=this.isTransposed?g:x,w},t.prototype.getCenter=function(){return this.circleCenter},t.prototype.getOneBox=function(){var r=this.startAngle,n=this.endAngle;if(Math.abs(n-r)>=Math.PI*2)return{minX:-1,maxX:1,minY:-1,maxY:1};for(var i=[0,Math.cos(r),Math.cos(n)],a=[0,Math.sin(r),Math.sin(n)],o=Math.min(r,n);o<Math.max(r,n);o+=Math.PI/18)i.push(Math.cos(o)),a.push(Math.sin(o));return{minX:Math.min.apply(Math,i),maxX:Math.max.apply(Math,i),minY:Math.min.apply(Math,a),maxY:Math.max.apply(Math,a)}},t}(a6),Dst={},Fme=function(e){return Dst[e.toLowerCase()]},O3=function(e,t){Dst[e.toLowerCase()]=t};O3("rect",Pst);O3("cartesian",Pst);O3("polar",Dme);O3("helix",Pme);function Fst(e,t,r){var n=new IS(t,r);n.target=e,n.propagationPath.push(e),e.emitDelegation(t,n);for(var i=e.getParent();i;)i.emitDelegation(t,n),n.propagationPath.push(i),i=i.getParent()}var Bst=[1,0,0,0,1,0,0,0,1];function f_(e,t,r){if(r===void 0&&(r=Bst),!t)return null;var n=Vs(r,[["t",-e.x,-e.y],["r",t],["t",e.x,e.y]]);return n}function o6(e,t){return!e.x&&!e.y?null:Vs(t||Bst,[["t",e.x,e.y]])}function Bme(e){var t=[1,0,0],r=[0,0,0];return oC(r,t,e),Math.atan2(r[1],r[0])}function JT(e,t){var r=[0,0];return oIt(r,t,e),r}function Nme(e,t){var r=JT(e,[t.minX,t.minY]),n=JT(e,[t.maxX,t.minY]),i=JT(e,[t.minX,t.maxY]),a=JT(e,[t.maxX,t.maxY]),o=Math.min(r[0],n[0],i[0],a[0]),s=Math.max(r[0],n[0],i[0],a[0]),l=Math.min(r[1],n[1],i[1],a[1]),u=Math.max(r[1],n[1],i[1],a[1]);return{x:o,y:l,minX:o,minY:l,maxX:s,maxY:u,width:s-o,height:u-l}}function Nst(e,t,r,n){if(t){var i=f_({x:r,y:n},t,e.getMatrix());e.setMatrix(i)}}function s6(e,t,r){var n=o6({x:t,y:r});e.attr("matrix",n)}function DR(e){var t=0,r=0,n=0,i=0;return Gn(e)?t=r=n=i=e:ze(e)&&(t=e[0],n=ke(e[1])?e[0]:e[1],i=ke(e[2])?e[0]:e[2],r=ke(e[3])?n:e[3]),[t,n,i,r]}function l6(e){for(var t=e.childNodes,r=t.length,n=r-1;n>=0;n--)e.removeChild(t[n])}function kme(e,t){return!!e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))}function qC(e){var t=e.start,r=e.end,n=Math.min(t.x,r.x),i=Math.min(t.y,r.y),a=Math.max(t.x,r.x),o=Math.max(t.y,r.y);return{x:n,y:i,minX:n,minY:i,maxX:a,maxY:o,width:a-n,height:o-i}}function zme(e){var t=e.map(function(s){return s.x}),r=e.map(function(s){return s.y}),n=Math.min.apply(Math,t),i=Math.min.apply(Math,r),a=Math.max.apply(Math,t),o=Math.max.apply(Math,r);return{x:n,y:i,minX:n,minY:i,maxX:a,maxY:o,width:a-n,height:o-i}}function P3(e,t,r,n){var i=e+r,a=t+n;return{x:e,y:t,width:r,height:n,minX:e,minY:t,maxX:isNaN(i)?0:i,maxY:isNaN(a)?0:a}}function Hy(e,t,r){return(1-r)*e+t*r}function Ex(e,t,r){return{x:e.x+Math.cos(r)*t,y:e.y+Math.sin(r)*t}}function Ume(e,t){var r=t.x-e.x,n=t.y-e.y;return Math.sqrt(r*r+n*n)}var FR=function(e,t,r){return r===void 0&&(r=Math.pow(Number.EPSILON,.5)),[e,t].includes(1/0)?Math.abs(e)===Math.abs(t):Math.abs(e-t)<r};function $me(e,t){var r=Math.max(e.minX,t.minX),n=Math.max(e.minY,t.minY),i=Math.min(e.maxX,t.maxX),a=Math.min(e.maxY,t.maxY);return P3(r,n,i-r,a-n)}function kst(e){var t=e.getClip(),r=t&&t.getBBox(),n;if(!e.isGroup())n=e.getBBox();else{var i=1/0,a=-1/0,o=1/0,s=-1/0,l=e.getChildren();l.length>0?ft(l,function(u){if(u.get("visible")){if(u.isGroup()&&u.get("children").length===0)return!0;var c=kst(u),f=u.applyToMatrix([c.minX,c.minY,1]),d=u.applyToMatrix([c.minX,c.maxY,1]),v=u.applyToMatrix([c.maxX,c.minY,1]),g=u.applyToMatrix([c.maxX,c.maxY,1]),x=Math.min(f[0],d[0],v[0],g[0]),w=Math.max(f[0],d[0],v[0],g[0]),S=Math.min(f[1],d[1],v[1],g[1]),A=Math.max(f[1],d[1],v[1],g[1]);x<i&&(i=x),w>a&&(a=w),S<o&&(o=S),A>s&&(s=A)}}):(i=0,a=0,o=0,s=0),n=P3(i,o,a-i,s-o)}return r?$me(n,r):n}function Hme(e,t){if(!(!e.getClip()&&!t.getClip())){var r=t.getClip();if(!r){e.setClip(null);return}var n={type:r.get("type"),attrs:r.attr()};e.setClip(n)}}function Uc(e){return e+"px"}function zst(e,t,r,n){var i=Ume(e,t),a=n/i,o=0;return r==="start"?o=0-a:r==="end"&&(o=1+a),{x:Hy(e.x,t.x,o),y:Hy(e.y,t.y,o)}}var Vme={none:[],point:["x","y"],region:["start","end"],points:["points"],circle:["center","radius","startAngle","endAngle"]},Ust=function(e){Ut(t,e);function t(r){var n=e.call(this,r)||this;return n.initCfg(),n}return t.prototype.getDefaultCfg=function(){return{id:"",name:"",type:"",locationType:"none",offsetX:0,offsetY:0,animate:!1,capture:!0,updateAutoRender:!1,animateOption:{appear:null,update:{duration:400,easing:"easeQuadInOut"},enter:{duration:400,easing:"easeQuadInOut"},leave:{duration:350,easing:"easeQuadIn"}},events:null,defaultCfg:{},visible:!0}},t.prototype.clear=function(){},t.prototype.update=function(r){var n=this,i=this.get("defaultCfg")||{};ft(r,function(a,o){var s=n.get(o),l=a;s!==a&&(qi(a)&&i[o]&&(l=Tr({},i[o],a)),n.set(o,l))}),this.updateInner(r),this.afterUpdate(r)},t.prototype.updateInner=function(r){},t.prototype.afterUpdate=function(r){jm(r,"visible")&&(r.visible?this.show():this.hide()),jm(r,"capture")&&this.setCapture(r.capture)},t.prototype.getLayoutBBox=function(){return this.getBBox()},t.prototype.getLocationType=function(){return this.get("locationType")},t.prototype.getOffset=function(){return{offsetX:this.get("offsetX"),offsetY:this.get("offsetY")}},t.prototype.setOffset=function(r,n){this.update({offsetX:r,offsetY:n})},t.prototype.setLocation=function(r){var n=U({},r);this.update(n)},t.prototype.getLocation=function(){var r=this,n={},i=this.get("locationType"),a=Vme[i];return ft(a,function(o){n[o]=r.get(o)}),n},t.prototype.isList=function(){return!1},t.prototype.isSlider=function(){return!1},t.prototype.init=function(){},t.prototype.initCfg=function(){var r=this,n=this.get("defaultCfg");ft(n,function(i,a){var o=r.get(a);if(qi(o)){var s=Tr({},i,o);r.set(a,s)}})},t}(SI),ly="update_status",Gme=["visible","tip","delegateObject"],Wme=["container","group","shapesMap","isRegister","isUpdating","destroyed"],vu=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultCfg=function(){var r=e.prototype.getDefaultCfg.call(this);return U(U({},r),{container:null,shapesMap:{},group:null,capture:!0,isRegister:!1,isUpdating:!1,isInit:!0})},t.prototype.remove=function(){this.clear();var r=this.get("group");r.remove()},t.prototype.clear=function(){var r=this.get("group");r.clear(),this.set("shapesMap",{}),this.clearOffScreenCache(),this.set("isInit",!0)},t.prototype.getChildComponentById=function(r){var n=this.getElementById(r),i=n&&n.get("component");return i},t.prototype.getElementById=function(r){return this.get("shapesMap")[r]},t.prototype.getElementByLocalId=function(r){var n=this.getElementId(r);return this.getElementById(n)},t.prototype.getElementsByName=function(r){var n=[];return ft(this.get("shapesMap"),function(i){i.get("name")===r&&n.push(i)}),n},t.prototype.getContainer=function(){return this.get("container")},t.prototype.updateInner=function(r){this.offScreenRender(),this.get("updateAutoRender")&&this.render()},t.prototype.render=function(){var r=this.get("offScreenGroup");r||(r=this.offScreenRender());var n=this.get("group");this.updateElements(r,n),this.deleteElements(),this.applyOffset(),this.get("eventInitted")||(this.initEvent(),this.set("eventInitted",!0)),this.set("isInit",!1)},t.prototype.show=function(){var r=this.get("group");r.show(),this.set("visible",!0)},t.prototype.hide=function(){var r=this.get("group");r.hide(),this.set("visible",!1)},t.prototype.setCapture=function(r){var n=this.get("group");n.set("capture",r),this.set("capture",r)},t.prototype.destroy=function(){this.removeEvent(),this.remove(),e.prototype.destroy.call(this)},t.prototype.getBBox=function(){return this.get("group").getCanvasBBox()},t.prototype.getLayoutBBox=function(){var r=this.get("group"),n=this.getInnerLayoutBBox(),i=r.getTotalMatrix();return i&&(n=Nme(i,n)),n},t.prototype.on=function(r,n,i){var a=this.get("group");return a.on(r,n,i),this},t.prototype.off=function(r,n){var i=this.get("group");return i&&i.off(r,n),this},t.prototype.emit=function(r,n){var i=this.get("group");i.emit(r,n)},t.prototype.init=function(){e.prototype.init.call(this),this.get("group")||this.initGroup(),this.offScreenRender()},t.prototype.getInnerLayoutBBox=function(){return this.get("offScreenBBox")||this.get("group").getBBox()},t.prototype.delegateEmit=function(r,n){var i=this.get("group");n.target=i,i.emit(r,n),Fst(i,r,n)},t.prototype.createOffScreenGroup=function(){var r=this.get("group"),n=r.getGroupBase(),i=new n({delegateObject:this.getDelegateObject()});return i},t.prototype.applyOffset=function(){var r=this.get("offsetX"),n=this.get("offsetY");this.moveElementTo(this.get("group"),{x:r,y:n})},t.prototype.initGroup=function(){var r=this.get("container");this.set("group",r.addGroup({id:this.get("id"),name:this.get("name"),capture:this.get("capture"),visible:this.get("visible"),isComponent:!0,component:this,delegateObject:this.getDelegateObject()}))},t.prototype.offScreenRender=function(){this.clearOffScreenCache();var r=this.createOffScreenGroup();return this.renderInner(r),this.set("offScreenGroup",r),this.set("offScreenBBox",kst(r)),r},t.prototype.addGroup=function(r,n){this.appendDelegateObject(r,n);var i=r.addGroup(n);return this.get("isRegister")&&this.registerElement(i),i},t.prototype.addShape=function(r,n){this.appendDelegateObject(r,n);var i=r.addShape(n);return this.get("isRegister")&&this.registerElement(i),i},t.prototype.addComponent=function(r,n){var i=n.id,a=n.component,o=hi(n,["id","component"]),s=new a(U(U({},o),{id:i,container:r,updateAutoRender:this.get("updateAutoRender")}));return s.init(),s.render(),this.get("isRegister")&&this.registerElement(s.get("group")),s},t.prototype.initEvent=function(){},t.prototype.removeEvent=function(){var r=this.get("group");r.off()},t.prototype.getElementId=function(r){var n=this.get("id"),i=this.get("name");return n+"-"+i+"-"+r},t.prototype.registerElement=function(r){var n=r.get("id");this.get("shapesMap")[n]=r},t.prototype.unregisterElement=function(r){var n=r.get("id");delete this.get("shapesMap")[n]},t.prototype.moveElementTo=function(r,n){var i=o6(n);r.attr("matrix",i)},t.prototype.addAnimation=function(r,n,i){var a=n.attr("opacity");ke(a)&&(a=1),n.attr("opacity",0),n.animate({opacity:a},i)},t.prototype.removeAnimation=function(r,n,i){n.animate({opacity:0},i)},t.prototype.updateAnimation=function(r,n,i,a){n.animate(i,a)},t.prototype.updateElements=function(r,n){var i=this,a=this.get("animate"),o=this.get("animateOption"),s=r.getChildren().slice(0),l;ft(s,function(u){var c=u.get("id"),f=i.getElementById(c),d=u.get("name");if(f)if(u.get("isComponent")){var v=u.get("component"),g=f.get("component"),x=Up(v.cfg,oUt(Eb(v.cfg),Wme));g.update(x),f.set(ly,"update")}else{var w=i.getReplaceAttrs(f,u);a&&o.update?i.updateAnimation(d,f,w,o.update):f.attr(w),u.isGroup()&&i.updateElements(u,f),ft(Gme,function(R){f.set(R,u.get(R))}),Hme(f,u),l=f,f.set(ly,"update")}else{n.add(u);var S=n.getChildren();if(S.splice(S.length-1,1),l){var A=S.indexOf(l);S.splice(A+1,0,u)}else S.unshift(u);if(i.registerElement(u),u.set(ly,"add"),u.get("isComponent")){var v=u.get("component");v.set("container",n)}else u.isGroup()&&i.registerNewGroup(u);if(l=u,a){var M=i.get("isInit")?o.appear:o.enter;M&&i.addAnimation(d,u,M)}}})},t.prototype.clearUpdateStatus=function(r){var n=r.getChildren();ft(n,function(i){i.set(ly,null)})},t.prototype.clearOffScreenCache=function(){var r=this.get("offScreenGroup");r&&r.destroy(),this.set("offScreenGroup",null),this.set("offScreenBBox",null)},t.prototype.getDelegateObject=function(){var r,n=this.get("name"),i=(r={},r[n]=this,r.component=this,r);return i},t.prototype.appendDelegateObject=function(r,n){var i=r.get("delegateObject");n.delegateObject||(n.delegateObject={}),Sa(n.delegateObject,i)},t.prototype.getReplaceAttrs=function(r,n){var i=r.attr(),a=n.attr();return ft(i,function(o,s){a[s]===void 0&&(a[s]=void 0)}),a},t.prototype.registerNewGroup=function(r){var n=this,i=r.getChildren();ft(i,function(a){n.registerElement(a),a.set(ly,"add"),a.isGroup()&&n.registerNewGroup(a)})},t.prototype.deleteElements=function(){var r=this,n=this.get("shapesMap"),i=[];ft(n,function(s,l){!s.get(ly)||s.destroyed?i.push([l,s]):s.set(ly,null)});var a=this.get("animate"),o=this.get("animateOption");ft(i,function(s){var l=s[0],u=s[1];if(!u.destroyed){var c=u.get("name");if(a&&o.leave){var f=Sa({callback:function(){r.removeElement(u)}},o.leave);r.removeAnimation(c,u,f)}else r.removeElement(u)}delete n[l]})},t.prototype.removeElement=function(r){if(r.get("isGroup")){var n=r.get("component");n&&n.destroy()}r.remove()},t}(Ust),vP="…";function Xme(e){for(var t=0,r=0;r<e.length;r++)t+=vy(e,r);return t}function vy(e,t){return e.charCodeAt(t)>0&&e.charCodeAt(t)<128?1:2}function jme(e,t,r){r===void 0&&(r="tail");var n=e.length,i="";if(r==="tail"){for(var a=0,o=0;a<t;){var s=vy(e,o);if(a+s<=t)i+=e[o],a+=vy(e,o),o++;else break}i+=vP}else if(r==="head"){for(var a=0,o=n-1;a<t;){var s=vy(e,o);if(a+s<=t)i+=e[o],a+=vy(e,o),o--;else break}i=vP+i}else{for(var l="",u="",a=0,c=0,f=n-1;a<t;){var d=vy(e,c),v=!1;d+a<=t&&(l+=e[c],c++,a+=d,v=!0);var g=vy(e,f);if(g+a<=t&&(u=e[f]+u,a+=g,f--,v=!0),!v)break}i=l+vP+u}return i}var Yme="…",Zme=2,qme=400;function Kme(e){for(var t=e.map(function(l){var u=l.attr("text");return ke(u)?"":""+u}),r=0,n=0,i=0;i<t.length;i+=1){for(var a=0,o=0;o<=t[i].length;o+=1){var s=t[i].charCodeAt(o);s>=19968&&s<=40869?a+=2:a+=1}a>r&&(r=a,n=i)}return e[n].getBBox().width}function $B(e){if(e.length>qme)return Kme(e);var t=0;return ft(e,function(r){var n=r.getBBox(),i=n.width;t<i&&(t=i)}),t}function Qme(e,t){var r=t.getCanvasBBox();return e?r.width:r.height}function Zw(e,t,r,n){var i;n===void 0&&(n="tail");var a=(i=t.attr("text"))!==null&&i!==void 0?i:"";if(n==="tail"){var o=Up(t.attr(),["fontSize","fontFamily","fontWeight","fontStyle","fontVariant"]),s=LUt(a,r,o,"…");return a!==s?(t.attr("text",s),t.set("tip",a),!0):(t.set("tip",null),!1)}var l=Qme(e,t),u=Xme(a),c=!1;if(r<l){var f=Math.floor(r/l*u)-Zme,d=void 0;f>=0?d=jme(a,f,n):d=Yme,d&&(t.attr("text",d),c=!0)}return c?t.set("tip",a):t.set("tip",null),c}function D3(e,t){var r=t.x,n=t.y,i=t.content,a=t.style,o=t.id,s=t.name,l=t.rotate,u=t.maxLength,c=t.autoEllipsis,f=t.isVertical,d=t.ellipsisPosition,v=t.background,g=e.addGroup({id:o+"-group",name:s+"-group",attrs:{x:r,y:n}}),x=g.addShape({type:"text",id:o,name:s,attrs:U({x:0,y:0,text:i},a)}),w=DR(xt(v,"padding",0));if(u&&c){var S=u-(w[1]+w[3]);Zw(!f,x,S,d)}if(v){var A=xt(v,"style",{}),M=x.getCanvasBBox(),R=M.minX,O=M.minY,N=M.width,k=M.height,V=g.addShape("rect",{id:o+"-bg",name:o+"-bg",attrs:U({x:R-w[3],y:O-w[0],width:N+w[1]+w[3],height:k+w[0]+w[2]},A)});V.toBack()}s6(g,r,n),Nst(g,l,r,n)}const Ai={fontFamily:`
  BlinkMacSystemFont, "Segoe UI", Roboto,"Helvetica Neue",
  Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei",
  SimSun, "sans-serif"`,textColor:"#2C3542",activeTextColor:"#333333",uncheckedColor:"#D8D8D8",lineColor:"#416180",regionColor:"#CCD7EB",verticalAxisRotate:-Math.PI/4,horizontalAxisRotate:Math.PI/4,descriptionIconStroke:"#fff",descriptionIconFill:"rgba(58, 73, 101, .25)"};var Jme=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultCfg=function(){var r=e.prototype.getDefaultCfg.call(this);return U(U({},r),{name:"annotation",type:"line",locationType:"region",start:null,end:null,style:{},text:null,defaultCfg:{style:{fill:Ai.textColor,fontSize:12,textAlign:"center",textBaseline:"bottom",fontFamily:Ai.fontFamily},text:{position:"center",autoRotate:!0,content:null,offsetX:0,offsetY:0,style:{stroke:Ai.lineColor,lineWidth:1}}}})},t.prototype.renderInner=function(r){this.renderLine(r),this.get("text")&&this.renderLabel(r)},t.prototype.renderLine=function(r){var n=this.get("start"),i=this.get("end"),a=this.get("style");this.addShape(r,{type:"line",id:this.getElementId("line"),name:"annotation-line",attrs:U({x1:n.x,y1:n.y,x2:i.x,y2:i.y},a)})},t.prototype.getLabelPoint=function(r,n,i){var a;return i==="start"?a=0:i==="center"?a=.5:nn(i)&&i.indexOf("%")!==-1?a=parseInt(i,10)/100:Gn(i)?a=i:a=1,(a>1||a<0)&&(a=1),{x:Hy(r.x,n.x,a),y:Hy(r.y,n.y,a)}},t.prototype.renderLabel=function(r){var n=this.get("text"),i=this.get("start"),a=this.get("end"),o=n.position,s=n.content,l=n.style,u=n.offsetX,c=n.offsetY,f=n.autoRotate,d=n.maxLength,v=n.autoEllipsis,g=n.ellipsisPosition,x=n.background,w=n.isVertical,S=w===void 0?!1:w,A=this.getLabelPoint(i,a,o),M=A.x+u,R=A.y+c,O={id:this.getElementId("line-text"),name:"annotation-line-text",x:M,y:R,content:s,style:l,maxLength:d,autoEllipsis:v,ellipsisPosition:g,background:x,isVertical:S};if(f){var N=[a.x-i.x,a.y-i.y];O.rotate=Math.atan2(N[1],N[0])}D3(r,O)},t}(vu),t0e=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultCfg=function(){var r=e.prototype.getDefaultCfg.call(this);return U(U({},r),{name:"annotation",type:"text",locationType:"point",x:0,y:0,content:"",rotate:null,style:{},background:null,maxLength:null,autoEllipsis:!0,isVertical:!1,ellipsisPosition:"tail",defaultCfg:{style:{fill:Ai.textColor,fontSize:12,textAlign:"center",textBaseline:"middle",fontFamily:Ai.fontFamily}}})},t.prototype.setLocation=function(r){this.set("x",r.x),this.set("y",r.y),this.resetLocation()},t.prototype.renderInner=function(r){var n=this.getLocation(),i=n.x,a=n.y,o=this.get("content"),s=this.get("style"),l=this.getElementId("text"),u=this.get("name")+"-text",c=this.get("maxLength"),f=this.get("autoEllipsis"),d=this.get("isVertical"),v=this.get("ellipsisPosition"),g=this.get("background"),x=this.get("rotate"),w={id:l,name:u,x:i,y:a,content:o,style:s,maxLength:c,autoEllipsis:f,isVertical:d,ellipsisPosition:v,background:g,rotate:x};D3(r,w)},t.prototype.resetLocation=function(){var r=this.getElementByLocalId("text-group");if(r){var n=this.getLocation(),i=n.x,a=n.y,o=this.get("rotate");s6(r,i,a),Nst(r,o,i,a)}},t}(vu),e0e=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultCfg=function(){var r=e.prototype.getDefaultCfg.call(this);return U(U({},r),{name:"annotation",type:"arc",locationType:"circle",center:null,radius:100,startAngle:-Math.PI/2,endAngle:Math.PI*3/2,style:{stroke:"#999",lineWidth:1}})},t.prototype.renderInner=function(r){this.renderArc(r)},t.prototype.getArcPath=function(){var r=this.getLocation(),n=r.center,i=r.radius,a=r.startAngle,o=r.endAngle,s=Ex(n,i,a),l=Ex(n,i,o),u=o-a>Math.PI?1:0,c=[["M",s.x,s.y]];if(o-a===Math.PI*2){var f=Ex(n,i,a+Math.PI);c.push(["A",i,i,0,u,1,f.x,f.y]),c.push(["A",i,i,0,u,1,l.x,l.y])}else c.push(["A",i,i,0,u,1,l.x,l.y]);return c},t.prototype.renderArc=function(r){var n=this.getArcPath(),i=this.get("style");this.addShape(r,{type:"path",id:this.getElementId("arc"),name:"annotation-arc",attrs:U({path:n},i)})},t}(vu),r0e=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultCfg=function(){var r=e.prototype.getDefaultCfg.call(this);return U(U({},r),{name:"annotation",type:"region",locationType:"region",start:null,end:null,style:{},defaultCfg:{style:{lineWidth:0,fill:Ai.regionColor,opacity:.4}}})},t.prototype.renderInner=function(r){this.renderRegion(r)},t.prototype.renderRegion=function(r){var n=this.get("start"),i=this.get("end"),a=this.get("style"),o=qC({start:n,end:i});this.addShape(r,{type:"rect",id:this.getElementId("region"),name:"annotation-region",attrs:U({x:o.x,y:o.y,width:o.width,height:o.height},a)})},t}(vu),n0e=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultCfg=function(){var r=e.prototype.getDefaultCfg.call(this);return U(U({},r),{name:"annotation",type:"image",locationType:"region",start:null,end:null,src:null,style:{}})},t.prototype.renderInner=function(r){this.renderImage(r)},t.prototype.getImageAttrs=function(){var r=this.get("start"),n=this.get("end"),i=this.get("style"),a=qC({start:r,end:n}),o=this.get("src");return U({x:a.x,y:a.y,img:o,width:a.width,height:a.height},i)},t.prototype.renderImage=function(r){this.addShape(r,{type:"image",id:this.getElementId("image"),name:"annotation-image",attrs:this.getImageAttrs()})},t}(vu),i0e=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultCfg=function(){var r=e.prototype.getDefaultCfg.call(this);return U(U({},r),{name:"annotation",type:"dataMarker",locationType:"point",x:0,y:0,point:{},line:{},text:{},direction:"upward",autoAdjust:!0,coordinateBBox:null,defaultCfg:{point:{display:!0,style:{r:3,fill:"#FFFFFF",stroke:"#1890FF",lineWidth:2}},line:{display:!0,length:20,style:{stroke:Ai.lineColor,lineWidth:1}},text:{content:"",display:!0,style:{fill:Ai.textColor,opacity:.65,fontSize:12,textAlign:"start",fontFamily:Ai.fontFamily}}}})},t.prototype.renderInner=function(r){xt(this.get("line"),"display")&&this.renderLine(r),xt(this.get("text"),"display")&&this.renderText(r),xt(this.get("point"),"display")&&this.renderPoint(r),this.get("autoAdjust")&&this.autoAdjust(r)},t.prototype.applyOffset=function(){this.moveElementTo(this.get("group"),{x:this.get("x")+this.get("offsetX"),y:this.get("y")+this.get("offsetY")})},t.prototype.renderPoint=function(r){var n=this.getShapeAttrs().point;this.addShape(r,{type:"circle",id:this.getElementId("point"),name:"annotation-point",attrs:n})},t.prototype.renderLine=function(r){var n=this.getShapeAttrs().line;this.addShape(r,{type:"path",id:this.getElementId("line"),name:"annotation-line",attrs:n})},t.prototype.renderText=function(r){var n=this.getShapeAttrs().text,i=n.x,a=n.y,o=n.text,s=hi(n,["x","y","text"]),l=this.get("text"),u=l.background,c=l.maxLength,f=l.autoEllipsis,d=l.isVertival,v=l.ellipsisPosition,g={x:i,y:a,id:this.getElementId("text"),name:"annotation-text",content:o,style:s,background:u,maxLength:c,autoEllipsis:f,isVertival:d,ellipsisPosition:v};D3(r,g)},t.prototype.autoAdjust=function(r){var n=this.get("direction"),i=this.get("x"),a=this.get("y"),o=xt(this.get("line"),"length",0),s=this.get("coordinateBBox"),l=r.getBBox(),u=l.minX,c=l.maxX,f=l.minY,d=l.maxY,v=r.findById(this.getElementId("text-group")),g=r.findById(this.getElementId("text")),x=r.findById(this.getElementId("line"));if(s&&v){var w=v.attr("x"),S=v.attr("y"),A=g.getCanvasBBox(),M=A.width,R=A.height,O=0,N=0;if(i+u<=s.minX)if(n==="leftward")O=1;else{var k=s.minX-(i+u);w=v.attr("x")+k}else if(i+c>=s.maxX)if(n==="rightward")O=-1;else{var k=i+c-s.maxX;w=v.attr("x")-k}if(O&&(x&&x.attr("path",[["M",0,0],["L",o*O,0]]),w=(o+2+M)*O),a+f<=s.minY)if(n==="upward")N=1;else{var k=s.minY-(a+f);S=v.attr("y")+k}else if(a+d>=s.maxY)if(n==="downward")N=-1;else{var k=a+d-s.maxY;S=v.attr("y")-k}N&&(x&&x.attr("path",[["M",0,0],["L",0,o*N]]),S=(o+2+R)*N),(w!==v.attr("x")||S!==v.attr("y"))&&s6(v,w,S)}},t.prototype.getShapeAttrs=function(){var r=xt(this.get("line"),"display"),n=xt(this.get("point"),"style",{}),i=xt(this.get("line"),"style",{}),a=xt(this.get("text"),"style",{}),o=this.get("direction"),s=r?xt(this.get("line"),"length",0):0,l=0,u=0,c="top",f="start";switch(o){case"upward":u=-1,c="bottom";break;case"downward":u=1,c="top";break;case"leftward":l=-1,f="end";break;case"rightward":l=1,f="start";break}return{point:U({x:0,y:0},n),line:U({path:[["M",0,0],["L",s*l,s*u]]},i),text:U({x:(s+2)*l,y:(s+2)*u,text:xt(this.get("text"),"content",""),textBaseline:c,textAlign:f},a)}},t}(vu),a0e=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultCfg=function(){var r=e.prototype.getDefaultCfg.call(this);return U(U({},r),{name:"annotation",type:"dataRegion",locationType:"points",points:[],lineLength:0,region:{},text:{},defaultCfg:{region:{style:{lineWidth:0,fill:Ai.regionColor,opacity:.4}},text:{content:"",style:{textAlign:"center",textBaseline:"bottom",fontSize:12,fill:Ai.textColor,fontFamily:Ai.fontFamily}}}})},t.prototype.renderInner=function(r){var n=xt(this.get("region"),"style",{});xt(this.get("text"),"style",{});var i=this.get("lineLength")||0,a=this.get("points");if(a.length){var o=zme(a),s=[];s.push(["M",a[0].x,o.minY-i]),a.forEach(function(u){s.push(["L",u.x,u.y])}),s.push(["L",a[a.length-1].x,a[a.length-1].y-i]),this.addShape(r,{type:"path",id:this.getElementId("region"),name:"annotation-region",attrs:U({path:s},n)});var l=U({id:this.getElementId("text"),name:"annotation-text",x:(o.minX+o.maxX)/2,y:o.minY-i},this.get("text"));D3(r,l)}},t}(vu),o0e=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultCfg=function(){var r=e.prototype.getDefaultCfg.call(this);return U(U({},r),{name:"annotation",type:"regionFilter",locationType:"region",start:null,end:null,color:null,shape:[]})},t.prototype.renderInner=function(r){var n=this,i=this.get("start"),a=this.get("end"),o=this.addGroup(r,{id:this.getElementId("region-filter"),capture:!1});ft(this.get("shapes"),function(l,u){var c=l.get("type"),f=$l(l.attr());n.adjustShapeAttrs(f),n.addShape(o,{id:n.getElementId("shape-"+c+"-"+u),capture:!1,type:c,attrs:f})});var s=qC({start:i,end:a});o.setClip({type:"rect",attrs:{x:s.minX,y:s.minY,width:s.width,height:s.height}})},t.prototype.adjustShapeAttrs=function(r){var n=this.get("color");r.fill&&(r.fill=r.fillStyle=n),r.stroke=r.strokeStyle=n},t}(vu),s0e=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultCfg=function(){var r=e.prototype.getDefaultCfg.call(this);return U(U({},r),{name:"annotation",type:"shape",draw:Mm})},t.prototype.renderInner=function(r){var n=this.get("render");$r(n)&&n(r)},t}(vu),u6=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultCfg=function(){var r=e.prototype.getDefaultCfg.call(this);return U(U({},r),{container:null,containerTpl:"<div></div>",updateAutoRender:!0,containerClassName:"",parent:null})},t.prototype.getContainer=function(){return this.get("container")},t.prototype.show=function(){var r=this.get("container");r.style.display="",this.set("visible",!0)},t.prototype.hide=function(){var r=this.get("container");r.style.display="none",this.set("visible",!1)},t.prototype.setCapture=function(r){var n=this.getContainer(),i=r?"auto":"none";n.style.pointerEvents=i,this.set("capture",r)},t.prototype.getBBox=function(){var r=this.getContainer(),n=parseFloat(r.style.left)||0,i=parseFloat(r.style.top)||0;return P3(n,i,r.clientWidth,r.clientHeight)},t.prototype.clear=function(){var r=this.get("container");l6(r)},t.prototype.destroy=function(){this.removeEvent(),this.removeDom(),e.prototype.destroy.call(this)},t.prototype.init=function(){e.prototype.init.call(this),this.initContainer(),this.initDom(),this.resetStyles(),this.applyStyles(),this.initEvent(),this.initCapture(),this.initVisible()},t.prototype.initCapture=function(){this.setCapture(this.get("capture"))},t.prototype.initVisible=function(){this.get("visible")?this.show():this.hide()},t.prototype.initDom=function(){},t.prototype.initContainer=function(){var r=this.get("container");if(ke(r)){r=this.createDom();var n=this.get("parent");nn(n)&&(n=document.getElementById(n),this.set("parent",n)),n.appendChild(r),this.get("containerId")&&r.setAttribute("id",this.get("containerId")),this.set("container",r)}else nn(r)&&(r=document.getElementById(r),this.set("container",r));this.get("parent")||this.set("parent",r.parentNode)},t.prototype.resetStyles=function(){var r=this.get("domStyles"),n=this.get("defaultStyles");r?r=Tr({},n,r):r=n,this.set("domStyles",r)},t.prototype.applyStyles=function(){var r=this.get("domStyles");if(r){var n=this.getContainer();this.applyChildrenStyles(n,r);var i=this.get("containerClassName");if(i&&kme(n,i)){var a=r[i];ka(n,a)}}},t.prototype.applyChildrenStyles=function(r,n){ft(n,function(i,a){var o=r.getElementsByClassName(a);ft(o,function(s){ka(s,i)})})},t.prototype.applyStyle=function(r,n){var i=this.get("domStyles");ka(n,i[r])},t.prototype.createDom=function(){var r=this.get("containerTpl");return eg(r)},t.prototype.initEvent=function(){},t.prototype.removeDom=function(){var r=this.get("container");r&&r.parentNode&&r.parentNode.removeChild(r)},t.prototype.removeEvent=function(){},t.prototype.updateInner=function(r){jm(r,"domStyles")&&(this.resetStyles(),this.applyStyles()),this.resetPosition()},t.prototype.resetPosition=function(){},t}(Ust),l0e=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultCfg=function(){var r=e.prototype.getDefaultCfg.call(this);return U(U({},r),{name:"annotation",type:"html",locationType:"point",x:0,y:0,containerTpl:'<div class="g2-html-annotation" style="position:absolute"></div>',alignX:"left",alignY:"top",html:"",zIndex:7})},t.prototype.render=function(){var r=this.getContainer(),n=this.get("html");l6(r);var i=$r(n)?n(r):n;if(_tt(i))r.appendChild(i);else if(nn(i)||Gn(i)){var a=eg(""+i);a&&r.appendChild(a)}this.resetPosition()},t.prototype.resetPosition=function(){var r=this.getContainer(),n=this.getLocation(),i=n.x,a=n.y,o=this.get("alignX"),s=this.get("alignY"),l=this.get("offsetX"),u=this.get("offsetY"),c=zHt(r),f=NHt(r),d={x:i,y:a};o==="middle"?d.x-=Math.round(c/2):o==="right"&&(d.x-=Math.round(c)),s==="middle"?d.y-=Math.round(f/2):s==="bottom"&&(d.y-=Math.round(f)),l&&(d.x+=l),u&&(d.y+=u),ka(r,{position:"absolute",left:d.x+"px",top:d.y+"px",zIndex:this.get("zIndex")})},t}(u6);const u0e=Object.freeze(Object.defineProperty({__proto__:null,Arc:e0e,DataMarker:i0e,DataRegion:a0e,Html:l0e,Image:n0e,Line:Jme,Region:r0e,RegionFilter:o0e,Shape:s0e,Text:t0e},Symbol.toStringTag,{value:"Module"}));function Tw(e,t,r){var n=t+"Style",i=null;return ft(r,function(a,o){e[o]&&a[n]&&(i||(i={}),Sa(i,a[n]))}),i}var $st=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultCfg=function(){var r=e.prototype.getDefaultCfg.call(this);return U(U({},r),{name:"axis",ticks:[],line:{},tickLine:{},subTickLine:null,title:null,label:{},verticalFactor:1,verticalLimitLength:null,overlapOrder:["autoRotate","autoEllipsis","autoHide"],tickStates:{},optimize:{},defaultCfg:{line:{style:{lineWidth:1,stroke:Ai.lineColor}},tickLine:{style:{lineWidth:1,stroke:Ai.lineColor},alignTick:!0,length:5,displayWithLabel:!0},subTickLine:{style:{lineWidth:1,stroke:Ai.lineColor},count:4,length:2},label:{autoRotate:!0,autoHide:!1,autoEllipsis:!1,style:{fontSize:12,fill:Ai.textColor,fontFamily:Ai.fontFamily,fontWeight:"normal"},offset:10,offsetX:0,offsetY:0},title:{autoRotate:!0,spacing:5,position:"center",style:{fontSize:12,fill:Ai.textColor,textBaseline:"middle",fontFamily:Ai.fontFamily,textAlign:"center"},iconStyle:{fill:Ai.descriptionIconFill,stroke:Ai.descriptionIconStroke},description:""},tickStates:{active:{labelStyle:{fontWeight:500},tickLineStyle:{lineWidth:2}},inactive:{labelStyle:{fill:Ai.uncheckedColor}}},optimize:{enable:!0,threshold:400}},theme:{}})},t.prototype.renderInner=function(r){this.get("line")&&this.drawLine(r),this.drawTicks(r),this.get("title")&&this.drawTitle(r)},t.prototype.isList=function(){return!0},t.prototype.getItems=function(){return this.get("ticks")},t.prototype.setItems=function(r){this.update({ticks:r})},t.prototype.updateItem=function(r,n){Sa(r,n),this.clear(),this.render()},t.prototype.clearItems=function(){var r=this.getElementByLocalId("label-group");r&&r.clear()},t.prototype.setItemState=function(r,n,i){r[n]=i,this.updateTickStates(r)},t.prototype.hasState=function(r,n){return!!r[n]},t.prototype.getItemStates=function(r){var n=this.get("tickStates"),i=[];return ft(n,function(a,o){r[o]&&i.push(o)}),i},t.prototype.clearItemsState=function(r){var n=this,i=this.getItemsByState(r);ft(i,function(a){n.setItemState(a,r,!1)})},t.prototype.getItemsByState=function(r){var n=this,i=this.getItems();return Wl(i,function(a){return n.hasState(a,r)})},t.prototype.getSidePoint=function(r,n){var i=this,a=i.getSideVector(n,r);return{x:r.x+a[0],y:r.y+a[1]}},t.prototype.getTextAnchor=function(r){var n;return Ul(r[0],0)?n="center":r[0]>0?n="start":r[0]<0&&(n="end"),n},t.prototype.getTextBaseline=function(r){var n;return Ul(r[1],0)?n="middle":r[1]>0?n="top":r[1]<0&&(n="bottom"),n},t.prototype.processOverlap=function(r){},t.prototype.drawLine=function(r){var n=this.getLinePath(),i=this.get("line");this.addShape(r,{type:"path",id:this.getElementId("line"),name:"axis-line",attrs:Sa({path:n},i.style)})},t.prototype.getTickLineItems=function(r){var n=this,i=[],a=this.get("tickLine"),o=a.alignTick,s=a.length,l=1,u=r.length;return u>=2&&(l=r[1].value-r[0].value),ft(r,function(c){var f=c.point;o||(f=n.getTickPoint(c.value-l/2));var d=n.getSidePoint(f,s);i.push({startPoint:f,tickValue:c.value,endPoint:d,tickId:c.id,id:"tickline-"+c.id})}),i},t.prototype.getSubTickLineItems=function(r){var n=[],i=this.get("subTickLine"),a=i.count,o=r.length;if(o>=2)for(var s=0;s<o-1;s++)for(var l=r[s],u=r[s+1],c=0;c<a;c++){var f=(c+1)/(a+1),d=(1-f)*l.tickValue+f*u.tickValue,v=this.getTickPoint(d),g=this.getSidePoint(v,i.length);n.push({startPoint:v,endPoint:g,tickValue:d,id:"sub-"+l.id+"-"+c})}return n},t.prototype.getTickLineAttrs=function(r,n,i,a){var o=this.get(n).style,s={points:[r.startPoint,r.endPoint]},l=xt(this.get("theme"),["tickLine","style"],{});o=$r(o)?Sa({},l,o(s,i,a)):o;var u=r.startPoint,c=r.endPoint;return U({x1:u.x,y1:u.y,x2:c.x,y2:c.y},o)},t.prototype.drawTick=function(r,n,i,a,o){this.addShape(n,{type:"line",id:this.getElementId(r.id),name:"axis-"+i,attrs:this.getTickLineAttrs(r,i,a,o)})},t.prototype.drawTickLines=function(r){var n=this,i=this.get("ticks"),a=this.get("subTickLine"),o=this.getTickLineItems(i),s=this.addGroup(r,{name:"axis-tickline-group",id:this.getElementId("tickline-group")}),l=this.get("tickLine");if(ft(o,function(c,f){if(l.displayWithLabel){var d=n.getElementId("label-"+c.tickId);r.findById(d)&&n.drawTick(c,s,"tickLine",f,o)}else n.drawTick(c,s,"tickLine",f,o)}),a){var u=this.getSubTickLineItems(o);ft(u,function(c,f){n.drawTick(c,s,"subTickLine",f,u)})}},t.prototype.processTicks=function(){var r=this,n=this.get("ticks");ft(n,function(i){i.point=r.getTickPoint(i.value),ke(i.id)&&(i.id=i.name)})},t.prototype.drawTicks=function(r){var n=this;this.optimizeTicks(),this.processTicks(),this.get("label")&&this.drawLabels(r),this.get("tickLine")&&this.drawTickLines(r);var i=this.get("ticks");ft(i,function(a){n.applyTickStates(a,r)})},t.prototype.optimizeTicks=function(){var r=this.get("optimize"),n=this.get("ticks");if(r&&r.enable&&r.threshold>0){var i=_l(n);if(i>r.threshold){var a=Math.ceil(i/r.threshold),o=n.filter(function(s,l){return l%a===0});this.set("ticks",o),this.set("originalTicks",n)}}},t.prototype.getLabelAttrs=function(r,n,i){var a=this.get("label"),o=a.offset,s=a.offsetX,l=a.offsetY,u=a.rotate,c=a.formatter,f=this.getSidePoint(r.point,o),d=this.getSideVector(o,f),v=c?c(r.name,r,n):r.name,g=a.style;g=$r(g)?xt(this.get("theme"),["label","style"],{}):g;var x=Sa({x:f.x+s,y:f.y+l,text:v,textAlign:this.getTextAnchor(d),textBaseline:this.getTextBaseline(d)},g);return u&&(x.matrix=f_(f,u)),x},t.prototype.drawLabels=function(r){var n=this,i=this.get("ticks"),a=this.addGroup(r,{name:"axis-label-group",id:this.getElementId("label-group")});ft(i,function(d,v){n.addShape(a,{type:"text",name:"axis-label",id:n.getElementId("label-"+d.id),attrs:n.getLabelAttrs(d,v,i),delegateObject:{tick:d,item:d,index:v}})}),this.processOverlap(a);var o=a.getChildren(),s=xt(this.get("theme"),["label","style"],{}),l=this.get("label"),u=l.style,c=l.formatter;if($r(u)){var f=o.map(function(d){return xt(d.get("delegateObject"),"tick")});ft(o,function(d,v){var g=d.get("delegateObject").tick,x=c?c(g.name,g,v):g.name,w=Sa({},s,u(x,v,f));d.attr(w)})}},t.prototype.getTitleAttrs=function(){var r=this.get("title"),n=r.style,i=r.position,a=r.offset,o=r.spacing,s=o===void 0?0:o,l=r.autoRotate,u=n.fontSize,c=.5;i==="start"?c=0:i==="end"&&(c=1);var f=this.getTickPoint(c),d=this.getSidePoint(f,a||s+u/2),v=Sa({x:d.x,y:d.y,text:r.text},n),g=r.rotate,x=g;if(ke(g)&&l){var w=this.getAxisVector(f),S=[1,0];x=k4(w,S,!0)}if(x){var A=f_(d,x);v.matrix=A}return v},t.prototype.drawTitle=function(r){var n,i=this.getTitleAttrs(),a=this.addShape(r,{type:"text",id:this.getElementId("title"),name:"axis-title",attrs:i});!((n=this.get("title"))===null||n===void 0)&&n.description&&this.drawDescriptionIcon(r,a,i.matrix)},t.prototype.drawDescriptionIcon=function(r,n,i){var a=this.addGroup(r,{name:"axis-description",id:this.getElementById("description")}),o=n.getBBox(),s=o.maxX,l=o.maxY,u=o.height,c=this.get("title").iconStyle,f=4,d=u/2,v=d/6,g=s+f,x=l-u/2,w=[g+d,x-d],S=w[0],A=w[1],M=[S+d,A+d],R=M[0],O=M[1],N=[S,O+d],k=N[0],V=N[1],Q=[g,A+d],Y=Q[0],X=Q[1],tt=[g+d,x-u/4],it=tt[0],Et=tt[1],Tt=[it,Et+v],pt=Tt[0],kt=Tt[1],ae=[pt,kt+v],Kt=ae[0],re=ae[1],fe=[Kt,re+d*3/4],Oe=fe[0],Ye=fe[1];this.addShape(a,{type:"path",id:this.getElementId("title-description-icon"),name:"axis-title-description-icon",attrs:U({path:[["M",S,A],["A",d,d,0,0,1,R,O],["A",d,d,0,0,1,k,V],["A",d,d,0,0,1,Y,X],["A",d,d,0,0,1,S,A],["M",it,Et],["L",pt,kt],["M",Kt,re],["L",Oe,Ye]],lineWidth:v,matrix:i},c)}),this.addShape(a,{type:"rect",id:this.getElementId("title-description-rect"),name:"axis-title-description-rect",attrs:{x:g,y:x-u/2,width:u,height:u,stroke:"#000",fill:"#000",opacity:0,matrix:i,cursor:"pointer"}})},t.prototype.applyTickStates=function(r,n){var i=this.getItemStates(r);if(i.length){var a=this.get("tickStates"),o=this.getElementId("label-"+r.id),s=n.findById(o);if(s){var l=Tw(r,"label",a);l&&s.attr(l)}var u=this.getElementId("tickline-"+r.id),c=n.findById(u);if(c){var f=Tw(r,"tickLine",a);f&&c.attr(f)}}},t.prototype.updateTickStates=function(r){var n=this.getItemStates(r),i=this.get("tickStates"),a=this.get("label"),o=this.getElementByLocalId("label-"+r.id),s=this.get("tickLine"),l=this.getElementByLocalId("tickline-"+r.id);if(n.length){if(o){var u=Tw(r,"label",i);u&&o.attr(u)}if(l){var c=Tw(r,"tickLine",i);c&&l.attr(c)}}else o&&o.attr(a.style),l&&l.attr(s.style)},t}(vu);function c6(e,t,r,n){var i=t.getChildren(),a=!1;return ft(i,function(o){var s=Zw(e,o,r,n);a=a||s}),a}function c0e(){return Hst}function h0e(e,t,r){return c6(e,t,r,"head")}function Hst(e,t,r){return c6(e,t,r,"tail")}function f0e(e,t,r){return c6(e,t,r,"middle")}const d0e=Object.freeze(Object.defineProperty({__proto__:null,ellipsisHead:h0e,ellipsisMiddle:f0e,ellipsisTail:Hst,getDefault:c0e},Symbol.toStringTag,{value:"Module"}));function p0e(e){var t=e.attr("matrix");return t&&t[0]!==1}function Vst(e){var t=p0e(e)?Bme(e.attr("matrix")):0;return t%360}function HB(e,t,r,n){var i=!1,a=Vst(t),o=Math.abs(e?r.attr("y")-t.attr("y"):r.attr("x")-t.attr("x")),s=(e?r.attr("y")>t.attr("y"):r.attr("x")>t.attr("x"))?t.getBBox():r.getBBox();if(e){var l=Math.abs(Math.cos(a));FR(l,0,Math.PI/180)?i=s.width+n>o:i=s.height/l+n>o}else{var l=Math.abs(Math.sin(a));FR(l,0,Math.PI/180)?i=s.width+n>o:i=s.height/l+n>o}return i}function KC(e,t,r,n){var i=(n==null?void 0:n.minGap)||0,a=t.getChildren().slice().filter(function(v){return v.get("visible")});if(!a.length)return!1;var o=!1;r&&a.reverse();for(var s=a.length,l=a[0],u=l,c=1;c<s;c++){var f=a[c];f.getBBox();var d=HB(e,u,f,i);d?(f.hide(),o=!0):u=f}return o}function Gst(e,t,r){var n=(r==null?void 0:r.minGap)||0,i=t.getChildren().slice();if(i.length<2)return!1;var a=!1,o=i[0],s=o.getBBox(),l=i[1],u=i.length,c=Vst(o),f=Math.abs(e?l.attr("y")-o.attr("y"):l.attr("x")-o.attr("x")),d=0;if(e){var v=Math.abs(Math.cos(c));if(FR(v,0,Math.PI/180)){var g=$B(i);d=(g+n)/f}else d=(s.height/v+n)/f}else{var v=Math.abs(Math.sin(c));if(FR(v,0,Math.PI/180)){var g=$B(i);d=(g+n)/f}else d=(s.height/v+n)/f}if(d>1){d=Math.ceil(d);for(var x=0;x<u;x++)x%d!==0&&(i[x].hide(),a=!0)}return a}function v0e(){return Wst}function g0e(e,t,r,n){return KC(e,t,!1,n)}function m0e(e,t,r,n){return KC(e,t,!0,n)}function y0e(e,t,r,n){var i=(n==null?void 0:n.minGap)||0,a=t.getChildren().slice();if(a.length<=2)return!1;for(var o=!1,s=a.length,l=a[0],u=a[s-1],c=l,f=1;f<s-1;f++){var d=a[f];d.getBBox();var v=HB(e,c,d,i);v?(d.hide(),o=!0):c=d}var g=HB(e,c,u,i);return g&&(c.hide(),o=!0),o}function Wst(e,t,r,n){var i=Gst(e,t,n);return KC(e,t,!1)&&(i=!0),i}function _0e(e,t,r,n){var i=t.getChildren().slice(),a=Gst(e,t,n);if(i.length>2){var o=i[0],s=i[i.length-1];o.get("visible")||(o.show(),KC(e,t,!1,n)&&(a=!0)),s.get("visible")||(s.show(),KC(e,t,!0,n)&&(a=!0))}return a}const x0e=Object.freeze(Object.defineProperty({__proto__:null,equidistance:Wst,equidistanceWithReverseBoth:_0e,getDefault:v0e,reserveBoth:y0e,reserveFirst:g0e,reserveLast:m0e},Symbol.toStringTag,{value:"Module"}));function b0e(e,t){ft(e,function(r){var n=r.attr("x"),i=r.attr("y"),a=f_({x:n,y:i},t);r.attr("matrix",a)})}function Xst(e,t,r,n){var i=t.getChildren();if(!i.length||!e&&i.length<2)return!1;var a=$B(i),o=!1;if(e)o=!!r&&a>r;else{var s=Math.abs(i[1].attr("x")-i[0].attr("x"));o=a>s}if(o){var l=n(r,a);b0e(i,l)}return o}function E0e(){return jst}function jst(e,t,r,n){return Xst(e,t,r,function(){return Gn(n)?n:e?Ai.verticalAxisRotate:Ai.horizontalAxisRotate})}function w0e(e,t,r){return Xst(e,t,r,function(n,i){if(!n)return e?Ai.verticalAxisRotate:Ai.horizontalAxisRotate;if(e)return-Math.acos(n/i);var a=0;return n>i?a=Math.PI/4:(a=Math.asin(n/i),a>Math.PI/4&&(a=Math.PI/4)),a})}const C0e=Object.freeze(Object.defineProperty({__proto__:null,fixedAngle:jst,getDefault:E0e,unfixedAngle:w0e},Symbol.toStringTag,{value:"Module"})),Yst=Object.freeze(Object.defineProperty({__proto__:null,autoEllipsis:d0e,autoHide:x0e,autoRotate:C0e},Symbol.toStringTag,{value:"Module"}));var S0e=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultCfg=function(){var r=e.prototype.getDefaultCfg.call(this);return U(U({},r),{type:"line",locationType:"region",start:null,end:null})},t.prototype.getLinePath=function(){var r=this.get("start"),n=this.get("end"),i=[];return i.push(["M",r.x,r.y]),i.push(["L",n.x,n.y]),i},t.prototype.getInnerLayoutBBox=function(){var r=this.get("start"),n=this.get("end"),i=e.prototype.getInnerLayoutBBox.call(this),a=Math.min(r.x,n.x,i.x),o=Math.min(r.y,n.y,i.y),s=Math.max(r.x,n.x,i.maxX),l=Math.max(r.y,n.y,i.maxY);return{x:a,y:o,minX:a,minY:o,maxX:s,maxY:l,width:s-a,height:l-o}},t.prototype.isVertical=function(){var r=this.get("start"),n=this.get("end");return Ul(r.x,n.x)},t.prototype.isHorizontal=function(){var r=this.get("start"),n=this.get("end");return Ul(r.y,n.y)},t.prototype.getTickPoint=function(r){var n=this,i=n.get("start"),a=n.get("end"),o=a.x-i.x,s=a.y-i.y;return{x:i.x+o*r,y:i.y+s*r}},t.prototype.getSideVector=function(r){var n=this.getAxisVector(),i=Dx([0,0],n),a=this.get("verticalFactor"),o=[i[1],i[0]*-1];return ic([0,0],o,r*a)},t.prototype.getAxisVector=function(){var r=this.get("start"),n=this.get("end");return[n.x-r.x,n.y-r.y]},t.prototype.processOverlap=function(r){var n=this,i=this.isVertical(),a=this.isHorizontal();if(!(!i&&!a)){var o=this.get("label"),s=this.get("title"),l=this.get("verticalLimitLength"),u=o.offset,c=l,f=0,d=0;s&&(f=s.style.fontSize,d=s.spacing),c&&(c=c-u-d-f);var v=this.get("overlapOrder");if(ft(v,function(w){o[w]&&n.canProcessOverlap(w)&&n.autoProcessOverlap(w,o[w],r,c)}),s&&ke(s.offset)){var g=r.getCanvasBBox(),x=i?g.width:g.height;s.offset=u+x+d+f/2}}},t.prototype.canProcessOverlap=function(r){var n=this.get("label");return r==="autoRotate"?ke(n.rotate):!0},t.prototype.autoProcessOverlap=function(r,n,i,a){var o=this,s=this.isVertical(),l=!1,u=Yst[r];if(n===!0)this.get("label"),l=u.getDefault()(s,i,a);else if($r(n))l=n(s,i,a);else if(qi(n)){var c=n;u[c.type]&&(l=u[c.type](s,i,a,c.cfg))}else u[n]&&(l=u[n](s,i,a));if(r==="autoRotate"){if(l){var f=i.getChildren(),d=this.get("verticalFactor");ft(f,function(g){var x=g.attr("textAlign");if(x==="center"){var w=d>0?"end":"start";g.attr("textAlign",w)}})}}else if(r==="autoHide"){var v=i.getChildren().slice(0);ft(v,function(g){g.get("visible")||(o.get("isRegister")&&o.unregisterElement(g),g.remove())})}},t}($st),T0e=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultCfg=function(){var r=e.prototype.getDefaultCfg.call(this);return U(U({},r),{type:"circle",locationType:"circle",center:null,radius:null,startAngle:-Math.PI/2,endAngle:Math.PI*3/2})},t.prototype.getLinePath=function(){var r=this.get("center"),n=r.x,i=r.y,a=this.get("radius"),o=a,s=this.get("startAngle"),l=this.get("endAngle"),u=[];if(Math.abs(l-s)===Math.PI*2)u=[["M",n,i-o],["A",a,o,0,1,1,n,i+o],["A",a,o,0,1,1,n,i-o],["Z"]];else{var c=this.getCirclePoint(s),f=this.getCirclePoint(l),d=Math.abs(l-s)>Math.PI?1:0,v=s>l?0:1;u=[["M",n,i],["L",c.x,c.y],["A",a,o,0,d,v,f.x,f.y],["L",n,i]]}return u},t.prototype.getTickPoint=function(r){var n=this.get("startAngle"),i=this.get("endAngle"),a=n+(i-n)*r;return this.getCirclePoint(a)},t.prototype.getSideVector=function(r,n){var i=this.get("center"),a=[n.x-i.x,n.y-i.y],o=this.get("verticalFactor"),s=W1(a);return ic(a,a,o*r/s),a},t.prototype.getAxisVector=function(r){var n=this.get("center"),i=[r.x-n.x,r.y-n.y];return[i[1],-1*i[0]]},t.prototype.getCirclePoint=function(r,n){var i=this.get("center");return n=n||this.get("radius"),{x:i.x+Math.cos(r)*n,y:i.y+Math.sin(r)*n}},t.prototype.canProcessOverlap=function(r){var n=this.get("label");return r==="autoRotate"?ke(n.rotate):!0},t.prototype.processOverlap=function(r){var n=this,i=this.get("label"),a=this.get("title"),o=this.get("verticalLimitLength"),s=i.offset,l=o,u=0,c=0;a&&(u=a.style.fontSize,c=a.spacing),l&&(l=l-s-c-u);var f=this.get("overlapOrder");if(ft(f,function(v){i[v]&&n.canProcessOverlap(v)&&n.autoProcessOverlap(v,i[v],r,l)}),a&&ke(a.offset)){var d=r.getCanvasBBox().height;a.offset=s+d+c+u/2}},t.prototype.autoProcessOverlap=function(r,n,i,a){var o=this,s=!1,l=Yst[r];if(a>0)if(n===!0)s=l.getDefault()(!1,i,a);else if($r(n))s=n(!1,i,a);else if(qi(n)){var u=n;l[u.type]&&(s=l[u.type](!1,i,a,u.cfg))}else l[n]&&(s=l[n](!1,i,a));if(r==="autoRotate"){if(s){var c=i.getChildren(),f=this.get("verticalFactor");ft(c,function(v){var g=v.attr("textAlign");if(g==="center"){var x=f>0?"end":"start";v.attr("textAlign",x)}})}}else if(r==="autoHide"){var d=i.getChildren().slice(0);ft(d,function(v){v.get("visible")||(o.get("isRegister")&&o.unregisterElement(v),v.remove())})}},t}($st),h6=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultCfg=function(){var r=e.prototype.getDefaultCfg.call(this);return U(U({},r),{name:"crosshair",type:"base",line:{},text:null,textBackground:{},capture:!1,defaultCfg:{line:{style:{lineWidth:1,stroke:Ai.lineColor}},text:{position:"start",offset:10,autoRotate:!1,content:null,style:{fill:Ai.textColor,textAlign:"center",textBaseline:"middle",fontFamily:Ai.fontFamily}},textBackground:{padding:5,style:{stroke:Ai.lineColor}}}})},t.prototype.renderInner=function(r){this.get("line")&&this.renderLine(r),this.get("text")&&(this.renderText(r),this.renderBackground(r))},t.prototype.renderText=function(r){var n=this.get("text"),i=n.style,a=n.autoRotate,o=n.content;if(!ke(o)){var s=this.getTextPoint(),l=null;if(a){var u=this.getRotateAngle();l=f_(s,u)}this.addShape(r,{type:"text",name:"crosshair-text",id:this.getElementId("text"),attrs:U(U(U({},s),{text:o,matrix:l}),i)})}},t.prototype.renderLine=function(r){var n=this.getLinePath(),i=this.get("line"),a=i.style;this.addShape(r,{type:"path",name:"crosshair-line",id:this.getElementId("line"),attrs:U({path:n},a)})},t.prototype.renderBackground=function(r){var n=this.getElementId("text"),i=r.findById(n),a=this.get("textBackground");if(a&&i){var o=i.getBBox(),s=DR(a.padding),l=a.style,u=this.addShape(r,{type:"rect",name:"crosshair-text-background",id:this.getElementId("text-background"),attrs:U({x:o.x-s[3],y:o.y-s[0],width:o.width+s[1]+s[3],height:o.height+s[0]+s[2],matrix:i.attr("matrix")},l)});u.toBack()}},t}(vu),Zst=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultCfg=function(){var r=e.prototype.getDefaultCfg.call(this);return U(U({},r),{type:"line",locationType:"region",start:null,end:null})},t.prototype.getRotateAngle=function(){var r=this.getLocation(),n=r.start,i=r.end,a=this.get("text").position,o=Math.atan2(i.y-n.y,i.x-n.x),s=a==="start"?o-Math.PI/2:o+Math.PI/2;return s},t.prototype.getTextPoint=function(){var r=this.getLocation(),n=r.start,i=r.end,a=this.get("text"),o=a.position,s=a.offset;return zst(n,i,o,s)},t.prototype.getLinePath=function(){var r=this.getLocation(),n=r.start,i=r.end;return[["M",n.x,n.y],["L",i.x,i.y]]},t}(h6),A0e=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultCfg=function(){var r=e.prototype.getDefaultCfg.call(this);return U(U({},r),{type:"circle",locationType:"circle",center:null,radius:100,startAngle:-Math.PI/2,endAngle:Math.PI*3/2})},t.prototype.getRotateAngle=function(){var r=this.getLocation(),n=r.startAngle,i=r.endAngle,a=this.get("text").position,o=a==="start"?n+Math.PI/2:i-Math.PI/2;return o},t.prototype.getTextPoint=function(){var r=this.get("text"),n=r.position,i=r.offset,a=this.getLocation(),o=a.center,s=a.radius,l=a.startAngle,u=a.endAngle,c=n==="start"?l:u,f=this.getRotateAngle()-Math.PI,d=Ex(o,s,c),v=Math.cos(f)*i,g=Math.sin(f)*i;return{x:d.x+v,y:d.y+g}},t.prototype.getLinePath=function(){var r=this.getLocation(),n=r.center,i=r.radius,a=r.startAngle,o=r.endAngle,s=null;if(o-a===Math.PI*2){var l=n.x,u=n.y;s=[["M",l,u-i],["A",i,i,0,1,1,l,u+i],["A",i,i,0,1,1,l,u-i],["Z"]]}else{var c=Ex(n,i,a),f=Ex(n,i,o),d=Math.abs(o-a)>Math.PI?1:0,v=a>o?0:1;s=[["M",c.x,c.y],["A",i,i,0,d,v,f.x,f.y]]}return s},t}(h6),QC="g2-crosshair",VB=QC+"-line",GB=QC+"-text",JE;const M0e=(JE={},JE[""+QC]={position:"relative"},JE[""+VB]={position:"absolute",backgroundColor:"rgba(0, 0, 0, 0.25)"},JE[""+GB]={position:"absolute",color:Ai.textColor,fontFamily:Ai.fontFamily},JE);var R0e=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultCfg=function(){var r=e.prototype.getDefaultCfg.call(this);return U(U({},r),{name:"crosshair",type:"html",locationType:"region",start:{x:0,y:0},end:{x:0,y:0},capture:!1,text:null,containerTpl:'<div class="'+QC+'"></div>',crosshairTpl:'<div class="'+VB+'"></div>',textTpl:'<span class="'+GB+'">{content}</span>',domStyles:null,containerClassName:QC,defaultStyles:M0e,defaultCfg:{text:{position:"start",content:null,align:"center",offset:10}}})},t.prototype.render=function(){this.resetText(),this.resetPosition()},t.prototype.initCrossHair=function(){var r=this.getContainer(),n=this.get("crosshairTpl"),i=eg(n);r.appendChild(i),this.applyStyle(VB,i),this.set("crosshairEl",i)},t.prototype.getTextPoint=function(){var r=this.getLocation(),n=r.start,i=r.end,a=this.get("text"),o=a.position,s=a.offset;return zst(n,i,o,s)},t.prototype.resetText=function(){var r=this.get("text"),n=this.get("textEl");if(r){var i=r.content;if(!n){var a=this.getContainer(),o=dS(this.get("textTpl"),r);n=eg(o),a.appendChild(n),this.applyStyle(GB,n),this.set("textEl",n)}n.innerHTML=i}else n&&n.remove()},t.prototype.isVertical=function(r,n){return r.x===n.x},t.prototype.resetPosition=function(){var r=this.get("crosshairEl");r||(this.initCrossHair(),r=this.get("crosshairEl"));var n=this.get("start"),i=this.get("end"),a=Math.min(n.x,i.x),o=Math.min(n.y,i.y);this.isVertical(n,i)?ka(r,{width:"1px",height:Uc(Math.abs(i.y-n.y))}):ka(r,{height:"1px",width:Uc(Math.abs(i.x-n.x))}),ka(r,{top:Uc(o),left:Uc(a)}),this.alignText()},t.prototype.alignText=function(){var r=this.get("textEl");if(r){var n=this.get("text").align,i=r.clientWidth,a=this.getTextPoint();switch(n){case"center":a.x=a.x-i/2;break;case"right":a.x=a.x-i}ka(r,{top:Uc(a.y),left:Uc(a.x)})}},t.prototype.updateInner=function(r){jm(r,"text")&&this.resetText(),e.prototype.updateInner.call(this,r)},t}(u6);const fj=Object.freeze(Object.defineProperty({__proto__:null,Base:h6,Circle:A0e,Html:R0e,Line:Zst},Symbol.toStringTag,{value:"Module"}));var qst=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultCfg=function(){var r=e.prototype.getDefaultCfg.call(this);return U(U({},r),{name:"grid",line:{},alternateColor:null,capture:!1,items:[],closed:!1,defaultCfg:{line:{type:"line",style:{lineWidth:1,stroke:Ai.lineColor}}}})},t.prototype.getLineType=function(){var r=this.get("line")||this.get("defaultCfg").line;return r.type},t.prototype.renderInner=function(r){this.drawGrid(r)},t.prototype.getAlternatePath=function(r,n){var i=this.getGridPath(r),a=n.slice(0).reverse(),o=this.getGridPath(a,!0),s=this.get("closed");return s?i=i.concat(o):(o[0][0]="L",i=i.concat(o),i.push(["Z"])),i},t.prototype.getPathStyle=function(){return this.get("line").style},t.prototype.drawGrid=function(r){var n=this,i=this.get("line"),a=this.get("items"),o=this.get("alternateColor"),s=null;ft(a,function(l,u){var c=l.id||u;if(i){var f=n.getPathStyle();f=$r(f)?f(l,u,a):f;var d=n.getElementId("line-"+c),v=n.getGridPath(l.points);n.addShape(r,{type:"path",name:"grid-line",id:d,attrs:Sa({path:v},f)})}if(o&&u>0){var g=n.getElementId("region-"+c),x=u%2===0;if(nn(o))x&&n.drawAlternateRegion(g,r,s.points,l.points,o);else{var w=x?o[1]:o[0];n.drawAlternateRegion(g,r,s.points,l.points,w)}}s=l})},t.prototype.drawAlternateRegion=function(r,n,i,a,o){var s=this.getAlternatePath(i,a);this.addShape(n,{type:"path",id:r,name:"grid-region",attrs:{path:s,fill:o}})},t}(vu);function I0e(e,t,r,n){var i=r-e,a=n-t;return Math.sqrt(i*i+a*a)}var L0e=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultCfg=function(){var r=e.prototype.getDefaultCfg.call(this);return U(U({},r),{type:"circle",center:null,closed:!0})},t.prototype.getGridPath=function(r,n){var i=this.getLineType(),a=this.get("closed"),o=[];if(r.length)if(i==="circle"){var s=this.get("center"),l=r[0],u=I0e(s.x,s.y,l.x,l.y),c=n?0:1;a?(o.push(["M",s.x,s.y-u]),o.push(["A",u,u,0,0,c,s.x,s.y+u]),o.push(["A",u,u,0,0,c,s.x,s.y-u]),o.push(["Z"])):ft(r,function(f,d){d===0?o.push(["M",f.x,f.y]):o.push(["A",u,u,0,0,c,f.x,f.y])})}else ft(r,function(f,d){d===0?o.push(["M",f.x,f.y]):o.push(["L",f.x,f.y])}),a&&o.push(["Z"]);return o},t}(qst),O0e=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultCfg=function(){var r=e.prototype.getDefaultCfg.call(this);return U(U({},r),{type:"line"})},t.prototype.getGridPath=function(r){var n=[];return ft(r,function(i,a){a===0?n.push(["M",i.x,i.y]):n.push(["L",i.x,i.y])}),n},t}(qst),Kst=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultCfg=function(){var r=e.prototype.getDefaultCfg.call(this);return U(U({},r),{name:"legend",layout:"horizontal",locationType:"point",x:0,y:0,offsetX:0,offsetY:0,title:null,background:null})},t.prototype.getLayoutBBox=function(){var r=e.prototype.getLayoutBBox.call(this),n=this.get("maxWidth"),i=this.get("maxHeight"),a=r.width,o=r.height;return n&&(a=Math.min(a,n)),i&&(o=Math.min(o,i)),P3(r.minX,r.minY,a,o)},t.prototype.setLocation=function(r){this.set("x",r.x),this.set("y",r.y),this.resetLocation()},t.prototype.resetLocation=function(){var r=this.get("x"),n=this.get("y"),i=this.get("offsetX"),a=this.get("offsetY");this.moveElementTo(this.get("group"),{x:r+i,y:n+a})},t.prototype.applyOffset=function(){this.resetLocation()},t.prototype.getDrawPoint=function(){return this.get("currentPoint")},t.prototype.setDrawPoint=function(r){return this.set("currentPoint",r)},t.prototype.renderInner=function(r){this.resetDraw(),this.get("title")&&this.drawTitle(r),this.drawLegendContent(r),this.get("background")&&this.drawBackground(r)},t.prototype.drawBackground=function(r){var n=this.get("background"),i=r.getBBox(),a=DR(n.padding),o=U({x:0,y:0,width:i.width+a[1]+a[3],height:i.height+a[0]+a[2]},n.style),s=this.addShape(r,{type:"rect",id:this.getElementId("background"),name:"legend-background",attrs:o});s.toBack()},t.prototype.drawTitle=function(r){var n=this.get("currentPoint"),i=this.get("title"),a=i.spacing,o=i.style,s=i.text,l=this.addShape(r,{type:"text",id:this.getElementId("title"),name:"legend-title",attrs:U({text:s,x:n.x,y:n.y},o)}),u=l.getBBox();this.set("currentPoint",{x:n.x,y:u.maxY+a})},t.prototype.resetDraw=function(){var r=this.get("background"),n={x:0,y:0};if(r){var i=DR(r.padding);n.x=i[3],n.y=i[0]}this.set("currentPoint",n)},t}(vu),gP={marker:{style:{inactiveFill:"#000",inactiveOpacity:.45,fill:"#000",opacity:1,size:12}},text:{style:{fill:"#ccc",fontSize:12}}},tA={fill:Ai.textColor,fontSize:12,textAlign:"start",textBaseline:"middle",fontFamily:Ai.fontFamily,fontWeight:"normal",lineHeight:12},mP="navigation-arrow-right",yP="navigation-arrow-left",dj={right:90*Math.PI/180,left:(360-90)*Math.PI/180,up:0,down:180*Math.PI/180},P0e=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.currentPageIndex=1,r.totalPagesCnt=1,r.pageWidth=0,r.pageHeight=0,r.startX=0,r.startY=0,r.onNavigationBack=function(){var n=r.getElementByLocalId("item-group");if(r.currentPageIndex>1){r.currentPageIndex-=1,r.updateNavigation();var i=r.getCurrentNavigationMatrix();r.get("animate")?n.animate({matrix:i},100):n.attr({matrix:i})}},r.onNavigationAfter=function(){var n=r.getElementByLocalId("item-group");if(r.currentPageIndex<r.totalPagesCnt){r.currentPageIndex+=1,r.updateNavigation();var i=r.getCurrentNavigationMatrix();r.get("animate")?n.animate({matrix:i},100):n.attr({matrix:i})}},r}return t.prototype.getDefaultCfg=function(){var r=e.prototype.getDefaultCfg.call(this);return U(U({},r),{name:"legend",type:"category",itemSpacing:24,itemMarginBottom:8,maxItemWidth:null,itemWidth:null,itemHeight:null,itemName:{},itemValue:null,maxWidth:null,maxHeight:null,marker:{},radio:null,items:[],itemStates:{},itemBackground:{},pageNavigator:{},defaultCfg:{title:{spacing:5,style:{fill:Ai.textColor,fontSize:12,textAlign:"start",textBaseline:"top"}},background:{padding:5,style:{stroke:Ai.lineColor}},itemBackground:{style:{opacity:0,fill:"#fff"}},pageNavigator:gP,itemName:{spacing:16,style:tA},marker:{spacing:8,style:{r:6,symbol:"circle"}},itemValue:{alignRight:!1,formatter:null,style:tA,spacing:6},itemStates:{active:{nameStyle:{opacity:.8}},unchecked:{nameStyle:{fill:Ai.uncheckedColor},markerStyle:{fill:Ai.uncheckedColor,stroke:Ai.uncheckedColor}},inactive:{nameStyle:{fill:Ai.uncheckedColor},markerStyle:{opacity:.2}}}}})},t.prototype.isList=function(){return!0},t.prototype.getItems=function(){return this.get("items")},t.prototype.setItems=function(r){this.update({items:r})},t.prototype.updateItem=function(r,n){Sa(r,n),this.clear(),this.render()},t.prototype.clearItems=function(){var r=this.getElementByLocalId("item-group");r&&r.clear()},t.prototype.setItemState=function(r,n,i){r[n]=i;var a=this.getElementByLocalId("item-"+r.id);if(a){var o=this.getItems(),s=o.indexOf(r),l=this.createOffScreenGroup(),u=this.drawItem(r,s,this.getItemHeight(),l);this.updateElements(u,a),this.clearUpdateStatus(a)}},t.prototype.hasState=function(r,n){return!!r[n]},t.prototype.getItemStates=function(r){var n=this.get("itemStates"),i=[];return ft(n,function(a,o){r[o]&&i.push(o)}),i},t.prototype.clearItemsState=function(r){var n=this,i=this.getItemsByState(r);ft(i,function(a){n.setItemState(a,r,!1)})},t.prototype.getItemsByState=function(r){var n=this,i=this.getItems();return Wl(i,function(a){return n.hasState(a,r)})},t.prototype.drawLegendContent=function(r){this.processItems(),this.drawItems(r)},t.prototype.processItems=function(){var r=this.get("items");ft(r,function(n){n.id||(n.id=n.name)})},t.prototype.drawItems=function(r){var n=this,i=this.addGroup(r,{id:this.getElementId("item-container-group"),name:"legend-item-container-group"}),a=this.addGroup(i,{id:this.getElementId("item-group"),name:"legend-item-group"}),o=this.getItemHeight(),s=this.get("itemWidth"),l=this.get("itemSpacing"),u=this.get("itemMarginBottom"),c=this.get("currentPoint"),f=c.x,d=c.y,v=this.get("layout"),g=this.get("items"),x=!1,w=0,S=this.get("maxWidth"),A=this.get("maxHeight");ft(g,function(M,R){var O=n.drawItem(M,R,o,a),N=O.getBBox(),k=s||N.width;k>w&&(w=k),v==="horizontal"?(S&&S<c.x+k-f&&(x=!0,c.x=f,c.y+=o+u),n.moveElementTo(O,c),c.x+=k+l):(A&&A<c.y+o+u-d&&(x=!0,c.x+=w+l,c.y=d,w=0),n.moveElementTo(O,c),c.y+=o+u)}),x&&this.get("flipPage")&&(this.pageHeight=0,this.pageWidth=0,this.totalPagesCnt=1,this.startX=f,this.startY=d,this.adjustNavigation(r,a))},t.prototype.getItemHeight=function(){var r=this.get("itemHeight");if(!r){var n=(this.get("itemName")||{}).style;if($r(n)){var i=this.getItems();i.forEach(function(a,o){var s=U(U({},tA),n(a,o,i)).fontSize;r<s&&(r=s)})}else n&&(r=n.fontSize)}return r},t.prototype.drawMarker=function(r,n,i,a){var o=U(U(U({x:0,y:a/2},n.style),{symbol:xt(i.marker,"symbol","circle")}),xt(i.marker,"style",{})),s=this.addShape(r,{type:"marker",id:this.getElementId("item-"+i.id+"-marker"),name:"legend-item-marker",attrs:o}),l=s.getBBox();s.attr("x",l.width/2);var u=s.attr(),c=u.stroke,f=u.fill;return c&&s.set("isStroke",!0),f&&s.set("isFill",!0),s},t.prototype.drawItemText=function(r,n,i,a,o,s,l){var u=i.formatter,c=i.style,f=U(U({x:s,y:o/2,text:u?u(a[n],a,l):a[n]},tA),$r(c)?c(a,l,this.getItems()):c);return this.addShape(r,{type:"text",id:this.getElementId("item-"+a.id+"-"+n),name:"legend-item-"+n,attrs:f})},t.prototype.drawRadio=function(r,n,i,a,o){var s,l,u=n.style||{},c=(s=u.r)!==null&&s!==void 0?s:a/2,f=c*3.6/8,d=[o+c,a/2-c],v=d[0],g=d[1],x=[v+c,g+c],w=x[0],S=x[1],A=[v,S+c],M=A[0],R=A[1],O=[o,g+c],N=O[0],k=O[1],V=i.showRadio,Q=U(U({path:[["M",v,g],["A",c,c,0,0,1,w,S],["L",w-f,S],["L",w,S],["A",c,c,0,0,1,M,R],["L",M,R-f],["L",M,R],["A",c,c,0,0,1,N,k],["L",N+f,k],["L",N,k],["A",c,c,0,0,1,v,g],["L",v,g+f]],stroke:"#000000",fill:"#ffffff"},u),{opacity:V?(l=u==null?void 0:u.opacity)!==null&&l!==void 0?l:.45:0}),Y=this.addShape(r,{type:"path",id:this.getElementId("item-"+i.id+"-radio"),name:"legend-item-radio",attrs:Q});return Y.set("tip",n.tip),Y},t.prototype.drawItem=function(r,n,i,a){var o="item-"+r.id,s=this.addGroup(a,{name:"legend-item-container",id:this.getElementId("item-container-"+o),delegateObject:{item:r,index:n}}),l=this.addGroup(s,{name:"legend-item",id:this.getElementId(o),delegateObject:{item:r,index:n}}),u=this.get("marker"),c=this.get("itemName"),f=this.get("itemValue"),d=this.get("itemBackground"),v=this.get("radio"),g=this.getLimitItemWidth(),x=0;if(u){var w=this.drawMarker(l,u,r,i),S=u.spacing,A=xt(r,["marker","spacing"]);Gn(A)&&(S=A),x=w.getBBox().maxX+S}if(c){var M=this.drawItemText(l,"name",c,r,i,x,n);g&&Zw(!0,M,lo(g-x,0,g)),x=M.getBBox().maxX+c.spacing}if(f){var R=this.drawItemText(l,"value",f,r,i,x,n);g&&(f.alignRight?(R.attr({textAlign:"right",x:g}),Zw(!0,R,lo(g-x,0,g),"head")):Zw(!0,R,lo(g-x,0,g))),x=R.getBBox().maxX+f.spacing}if(v&&this.drawRadio(l,v,r,i,x),d){var O=l.getBBox(),N=this.addShape(l,{type:"rect",name:"legend-item-background",id:this.getElementId(o+"-background"),attrs:U({x:0,y:0,width:O.width,height:i},d.style)});N.toBack()}return this.applyItemStates(r,l),l},t.prototype.adjustNavigation=function(r,n){var i=this,a=this.startX,o=this.startY,s=this.get("layout"),l=n.findAll(function(tt){return tt.get("name")==="legend-item"}),u=this.get("maxWidth"),c=this.get("maxHeight"),f=this.get("itemWidth"),d=this.get("itemSpacing"),v=this.getItemHeight(),g=Tr({},gP,this.get("pageNavigator")),x=this.drawNavigation(r,s,"00/00",g),w=x.getBBox(),S={x:a,y:o},A=1,M=0,R=0,O=0,N=this.get("itemMarginBottom");function k(tt,it){var Et=tt.getBBox(),Tt=f||Et.width,pt=it.x+Tt+d+w.width;return pt>u}if(s==="horizontal"){var V=this.get("maxRow")||1,Q=v+(V===1?0:N),Y=u-d-w.width-w.minX;this.pageHeight=Q*V,this.pageWidth=Y,ft(l,function(tt){var it=tt.getBBox(),Et=f||it.width;(M&&M<S.x+Et+d||k(tt,S))&&(A===1&&(M=S.x+d,i.moveElementTo(x,{x:Y,y:S.y+v/2-w.height/2-w.minY})),A+=1,S.x=a,S.y+=Q),i.moveElementTo(tt,S),tt.getParent().setClip({type:"rect",attrs:{x:S.x,y:S.y,width:Et+d,height:v}}),S.x+=Et+d})}else{ft(l,function(tt){var it=tt.getBBox();it.width>R&&(R=it.width)}),O=R,R+=d,u&&(R=Math.min(u,R),O=Math.min(u,O)),this.pageWidth=R,this.pageHeight=c-Math.max(w.height,v+N);var X=Math.floor(this.pageHeight/(v+N));ft(l,function(tt,it){it!==0&&it%X===0&&(A+=1,S.x+=R,S.y=o),i.moveElementTo(tt,S),tt.getParent().setClip({type:"rect",attrs:{x:S.x,y:S.y,width:R,height:v}}),S.y+=v+N}),this.totalPagesCnt=A,this.moveElementTo(x,{x:a+O/2-w.width/2-w.minX,y:c-w.height-w.minY})}this.pageHeight&&this.pageWidth&&n.getParent().setClip({type:"rect",attrs:{x:this.startX,y:this.startY,width:this.pageWidth,height:this.pageHeight}}),s==="horizontal"&&this.get("maxRow")?this.totalPagesCnt=Math.ceil(A/this.get("maxRow")):this.totalPagesCnt=A,this.currentPageIndex>this.totalPagesCnt&&(this.currentPageIndex=1),this.updateNavigation(x),n.attr("matrix",this.getCurrentNavigationMatrix())},t.prototype.drawNavigation=function(r,n,i,a){var o={x:0,y:0},s=this.addGroup(r,{id:this.getElementId("navigation-group"),name:"legend-navigation"}),l=xt(a.marker,"style",{}),u=l.size,c=u===void 0?12:u,f=hi(l,["size"]),d=this.drawArrow(s,o,yP,n==="horizontal"?"up":"left",c,f);d.on("click",this.onNavigationBack);var v=d.getBBox();o.x+=v.width+2;var g=this.addShape(s,{type:"text",id:this.getElementId("navigation-text"),name:"navigation-text",attrs:U({x:o.x,y:o.y+c/2,text:i,textBaseline:"middle"},xt(a.text,"style"))}),x=g.getBBox();o.x+=x.width+2;var w=this.drawArrow(s,o,mP,n==="horizontal"?"down":"right",c,f);return w.on("click",this.onNavigationAfter),s},t.prototype.updateNavigation=function(r){var n=Tr({},gP,this.get("pageNavigator")),i=n.marker.style,a=i.fill,o=i.opacity,s=i.inactiveFill,l=i.inactiveOpacity,u=this.currentPageIndex+"/"+this.totalPagesCnt,c=r?r.getChildren()[1]:this.getElementByLocalId("navigation-text"),f=r?r.findById(this.getElementId(yP)):this.getElementByLocalId(yP),d=r?r.findById(this.getElementId(mP)):this.getElementByLocalId(mP);c.attr("text",u),f.attr("opacity",this.currentPageIndex===1?l:o),f.attr("fill",this.currentPageIndex===1?s:a),f.attr("cursor",this.currentPageIndex===1?"not-allowed":"pointer"),d.attr("opacity",this.currentPageIndex===this.totalPagesCnt?l:o),d.attr("fill",this.currentPageIndex===this.totalPagesCnt?s:a),d.attr("cursor",this.currentPageIndex===this.totalPagesCnt?"not-allowed":"pointer");var v=f.getBBox().maxX+2;c.attr("x",v),v+=c.getBBox().width+2,this.updateArrowPath(d,{x:v,y:0})},t.prototype.drawArrow=function(r,n,i,a,o,s){var l=n.x,u=n.y,c=this.addShape(r,{type:"path",id:this.getElementId(i),name:i,attrs:U({size:o,direction:a,path:[["M",l+o/2,u],["L",l,u+o],["L",l+o,u+o],["Z"]],cursor:"pointer"},s)});return c.attr("matrix",f_({x:l+o/2,y:u+o/2},dj[a])),c},t.prototype.updateArrowPath=function(r,n){var i=n.x,a=n.y,o=r.attr(),s=o.size,l=o.direction,u=f_({x:i+s/2,y:a+s/2},dj[l]);r.attr("path",[["M",i+s/2,a],["L",i,a+s],["L",i+s,a+s],["Z"]]),r.attr("matrix",u)},t.prototype.getCurrentNavigationMatrix=function(){var r=this,n=r.currentPageIndex,i=r.pageWidth,a=r.pageHeight,o=this.get("layout"),s=o==="horizontal"?{x:0,y:a*(1-n)}:{x:i*(1-n),y:0};return o6(s)},t.prototype.applyItemStates=function(r,n){var i=this.getItemStates(r),a=i.length>0;if(a){var o=n.getChildren(),s=this.get("itemStates");ft(o,function(l){var u=l.get("name"),c=u.split("-")[2],f=Tw(r,c,s);f&&(l.attr(f),c==="marker"&&!(l.get("isStroke")&&l.get("isFill"))&&(l.get("isStroke")&&l.attr("fill",null),l.get("isFill")&&l.attr("stroke",null)))})}},t.prototype.getLimitItemWidth=function(){var r=this.get("itemWidth"),n=this.get("maxItemWidth");return n?r&&(n=r<=n?r:n):r&&(n=r),n},t}(Kst),D0e=1.4,pj=.4,F0e=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultCfg=function(){var r=e.prototype.getDefaultCfg.call(this);return U(U({},r),{type:"continue",min:0,max:100,value:null,colors:[],track:{},rail:{},label:{},handler:{},slidable:!0,tip:null,step:null,maxWidth:null,maxHeight:null,defaultCfg:{label:{align:"rail",spacing:5,formatter:null,style:{fontSize:12,fill:Ai.textColor,textBaseline:"middle",fontFamily:Ai.fontFamily}},handler:{size:10,style:{fill:"#fff",stroke:"#333"}},track:{},rail:{type:"color",size:20,defaultLength:100,style:{fill:"#DCDEE2"}},title:{spacing:5,style:{fill:Ai.textColor,fontSize:12,textAlign:"start",textBaseline:"top"}}}})},t.prototype.isSlider=function(){return!0},t.prototype.getValue=function(){return this.getCurrentValue()},t.prototype.getRange=function(){return{min:this.get("min"),max:this.get("max")}},t.prototype.setRange=function(r,n){this.update({min:r,max:n})},t.prototype.setValue=function(r){var n=this.getValue();this.set("value",r);var i=this.get("group");this.resetTrackClip(),this.get("slidable")&&this.resetHandlers(i),this.delegateEmit("valuechanged",{originValue:n,value:r})},t.prototype.initEvent=function(){var r=this.get("group");this.bindSliderEvent(r),this.bindRailEvent(r),this.bindTrackEvent(r)},t.prototype.drawLegendContent=function(r){this.drawRail(r),this.drawLabels(r),this.fixedElements(r),this.resetTrack(r),this.resetTrackClip(r),this.get("slidable")&&this.resetHandlers(r)},t.prototype.bindSliderEvent=function(r){this.bindHandlersEvent(r)},t.prototype.bindHandlersEvent=function(r){var n=this;r.on("legend-handler-min:drag",function(i){var a=n.getValueByCanvasPoint(i.x,i.y),o=n.getCurrentValue(),s=o[1];s<a&&(s=a),n.setValue([a,s])}),r.on("legend-handler-max:drag",function(i){var a=n.getValueByCanvasPoint(i.x,i.y),o=n.getCurrentValue(),s=o[0];s>a&&(s=a),n.setValue([s,a])})},t.prototype.bindRailEvent=function(r){},t.prototype.bindTrackEvent=function(r){var n=this,i=null;r.on("legend-track:dragstart",function(a){i={x:a.x,y:a.y}}),r.on("legend-track:drag",function(a){if(i){var o=n.getValueByCanvasPoint(i.x,i.y),s=n.getValueByCanvasPoint(a.x,a.y),l=n.getCurrentValue(),u=l[1]-l[0],c=n.getRange(),f=s-o;f<0?l[0]+f>c.min?n.setValue([l[0]+f,l[1]+f]):n.setValue([c.min,c.min+u]):f>0&&(f>0&&l[1]+f<c.max?n.setValue([l[0]+f,l[1]+f]):n.setValue([c.max-u,c.max])),i={x:a.x,y:a.y}}}),r.on("legend-track:dragend",function(a){i=null})},t.prototype.drawLabels=function(r){this.drawLabel("min",r),this.drawLabel("max",r)},t.prototype.drawLabel=function(r,n){var i=this.get("label"),a=i.style,o=i.align,s=i.formatter,l=this.get(r),u=this.getLabelAlignAttrs(r,o),c="label-"+r;this.addShape(n,{type:"text",id:this.getElementId(c),name:"legend-label-"+r,attrs:U(U({x:0,y:0,text:$r(s)?s(l):l},a),u)})},t.prototype.getLabelAlignAttrs=function(r,n){var i=this.isVertical(),a="center",o="middle";return i?(a="start",n!=="rail"?r==="min"?o="top":o="bottom":o="top"):n!=="rail"?(o="top",r==="min"?a="start":a="end"):(a="start",o="middle"),{textAlign:a,textBaseline:o}},t.prototype.getRailPath=function(r,n,i,a){var o=this.get("rail"),s=o.size,l=o.defaultLength,u=o.type,c=this.isVertical(),f=l,d=i,v=a;d||(d=c?s:f),v||(v=c?f:s);var g=[];return u==="color"?(g.push(["M",r,n]),g.push(["L",r+d,n]),g.push(["L",r+d,n+v]),g.push(["L",r,n+v]),g.push(["Z"])):(g.push(["M",r+d,n]),g.push(["L",r+d,n+v]),g.push(["L",r,n+v]),g.push(["Z"])),g},t.prototype.drawRail=function(r){var n=this.get("rail"),i=n.style;this.addShape(r,{type:"path",id:this.getElementId("rail"),name:"legend-rail",attrs:U({path:this.getRailPath(0,0)},i)})},t.prototype.getTrackColor=function(r){var n=r.length;if(!n)return null;if(n===1)return r[0];var i;this.isVertical()?i="l(90)":i="l(0)";for(var a=0;a<n;a++){var o=a/(n-1);i+=" "+o+":"+r[a]}return i},t.prototype.getTrackPath=function(r){var n=this.getRailShape(r),i=n.attr("path");return $l(i)},t.prototype.getClipTrackAttrs=function(r){var n=this.getCurrentValue(),i=n[0],a=n[1],o=this.getRailBBox(r),s=this.getPointByValue(i,r),l=this.getPointByValue(a,r),u=this.isVertical(),c,f,d,v;return u?(c=o.minX,f=s.y,d=o.width,v=l.y-s.y):(c=s.x,f=o.minY,d=l.x-s.x,v=o.height),{x:c,y:f,width:d,height:v}},t.prototype.getTrackAttrs=function(r){var n=this.get("track"),i=this.get("colors"),a=this.getTrackPath(r);return Sa({path:a,fill:this.getTrackColor(i)},n.style)},t.prototype.resetTrackClip=function(r){var n=r||this.get("group"),i=this.getElementId("track"),a=n.findById(i),o=a.getClip(),s=this.getClipTrackAttrs(r);o?o.attr(s):a.setClip({type:"rect",attrs:s})},t.prototype.resetTrack=function(r){var n=this.getElementId("track"),i=r.findById(n),a=this.getTrackAttrs(r);i?i.attr(a):this.addShape(r,{type:"path",id:n,draggable:this.get("slidable"),name:"legend-track",attrs:a})},t.prototype.getPointByValue=function(r,n){var i=this.getRange(),a=i.min,o=i.max,s=(r-a)/(o-a),l=this.getRailBBox(n),u=this.isVertical(),c={x:0,y:0};return u?(c.x=l.minX+l.width/2,c.y=Hy(l.minY,l.maxY,s)):(c.x=Hy(l.minX,l.maxX,s),c.y=l.minY+l.height/2),c},t.prototype.getRailShape=function(r){var n=r||this.get("group");return n.findById(this.getElementId("rail"))},t.prototype.getRailBBox=function(r){var n=this.getRailShape(r),i=n.getBBox();return i},t.prototype.getRailCanvasBBox=function(){var r=this.get("group"),n=r.findById(this.getElementId("rail")),i=n.getCanvasBBox();return i},t.prototype.isVertical=function(){return this.get("layout")==="vertical"},t.prototype.getValueByCanvasPoint=function(r,n){var i=this.getRange(),a=i.min,o=i.max,s=this.getRailCanvasBBox(),l=this.isVertical(),u=this.get("step"),c;l?c=(n-s.minY)/s.height:c=(r-s.minX)/s.width;var f=Hy(a,o,c);if(u){var d=Math.round((f-a)/u);f=a+d*u}return f>o&&(f=o),f<a&&(f=a),f},t.prototype.getCurrentValue=function(){var r=this.get("value");if(!r){var n=this.get("values");return n?[Math.max(Math.min.apply(Math,Wy(n,[this.get("max")])),this.get("min")),Math.min(Math.max.apply(Math,Wy(n,[this.get("min")])),this.get("max"))]:[this.get("min"),this.get("max")]}return r},t.prototype.resetHandlers=function(r){var n=this.getCurrentValue(),i=n[0],a=n[1];this.resetHandler(r,"min",i),this.resetHandler(r,"max",a)},t.prototype.getHandlerPath=function(r,n){var i=this.isVertical(),a=[],o=r.size,s=n.x,l=n.y,u=o*D0e,c=o/2,f=o/6;if(i){var d=s+u*pj;a.push(["M",s,l]),a.push(["L",d,l+c]),a.push(["L",s+u,l+c]),a.push(["L",s+u,l-c]),a.push(["L",d,l-c]),a.push(["Z"]),a.push(["M",d,l+f]),a.push(["L",s+u-2,l+f]),a.push(["M",d,l-f]),a.push(["L",s+u-2,l-f])}else{var v=l+u*pj;a.push(["M",s,l]),a.push(["L",s-c,v]),a.push(["L",s-c,l+u]),a.push(["L",s+c,l+u]),a.push(["L",s+c,v]),a.push(["Z"]),a.push(["M",s-f,v]),a.push(["L",s-f,l+u-2]),a.push(["M",s+f,v]),a.push(["L",s+f,l+u-2])}return a},t.prototype.resetHandler=function(r,n,i){var a=this.getPointByValue(i,r),o=this.get("handler"),s=this.getHandlerPath(o,a),l=this.getElementId("handler-"+n),u=r.findById(l),c=this.isVertical();u?u.attr("path",s):this.addShape(r,{type:"path",name:"legend-handler-"+n,draggable:!0,id:l,attrs:U(U({path:s},o.style),{cursor:c?"ns-resize":"ew-resize"})})},t.prototype.fixedElements=function(r){var n=r.findById(this.getElementId("rail")),i=r.findById(this.getElementId("label-min")),a=r.findById(this.getElementId("label-max")),o=this.getDrawPoint();this.isVertical()?this.fixedVertail(i,a,n,o):this.fixedHorizontal(i,a,n,o)},t.prototype.fitRailLength=function(r,n,i,a){var o=this.isVertical(),s=o?"height":"width",l=this.get("label"),u=l.align,c=l.spacing,f=this.get("max"+C_(s));if(f){var d=u==="rail"?i[s]+r[s]+n[s]+c*2:i[s],v=d-f;v>0&&this.changeRailLength(a,s,i[s]-v)}},t.prototype.changeRailLength=function(r,n,i){var a=r.getBBox(),o;n==="height"?o=this.getRailPath(a.x,a.y,a.width,i):o=this.getRailPath(a.x,a.y,i,a.height),r.attr("path",o)},t.prototype.changeRailPosition=function(r,n,i){var a=r.getBBox(),o=this.getRailPath(n,i,a.width,a.height);r.attr("path",o)},t.prototype.fixedHorizontal=function(r,n,i,a){var o=this.get("label"),s=o.align,l=o.spacing,u=i.getBBox(),c=r.getBBox(),f=n.getBBox(),d=u.height;this.fitRailLength(c,f,u,i),u=i.getBBox(),s==="rail"?(r.attr({x:a.x,y:a.y+d/2}),this.changeRailPosition(i,a.x+c.width+l,a.y),n.attr({x:a.x+c.width+u.width+l*2,y:a.y+d/2})):s==="top"?(r.attr({x:a.x,y:a.y}),n.attr({x:a.x+u.width,y:a.y}),this.changeRailPosition(i,a.x,a.y+c.height+l)):(this.changeRailPosition(i,a.x,a.y),r.attr({x:a.x,y:a.y+u.height+l}),n.attr({x:a.x+u.width,y:a.y+u.height+l}))},t.prototype.fixedVertail=function(r,n,i,a){var o=this.get("label"),s=o.align,l=o.spacing,u=i.getBBox(),c=r.getBBox(),f=n.getBBox();if(this.fitRailLength(c,f,u,i),u=i.getBBox(),s==="rail")r.attr({x:a.x,y:a.y}),this.changeRailPosition(i,a.x,a.y+c.height+l),n.attr({x:a.x,y:a.y+c.height+u.height+l*2});else if(s==="right")r.attr({x:a.x+u.width+l,y:a.y}),this.changeRailPosition(i,a.x,a.y),n.attr({x:a.x+u.width+l,y:a.y+u.height});else{var d=Math.max(c.width,f.width);r.attr({x:a.x,y:a.y}),this.changeRailPosition(i,a.x+d+l,a.y),n.attr({x:a.x,y:a.y+u.height})}},t}(Kst),ug="g2-tooltip",cg="g2-tooltip-title",JC="g2-tooltip-list",F3="g2-tooltip-list-item",B3="g2-tooltip-marker",N3="g2-tooltip-value",Qst="g2-tooltip-name",f6="g2-tooltip-crosshair-x",d6="g2-tooltip-crosshair-y";const B0e=Object.freeze(Object.defineProperty({__proto__:null,CONTAINER_CLASS:ug,CROSSHAIR_X:f6,CROSSHAIR_Y:d6,LIST_CLASS:JC,LIST_ITEM_CLASS:F3,MARKER_CLASS:B3,NAME_CLASS:Qst,TITLE_CLASS:cg,VALUE_CLASS:N3},Symbol.toStringTag,{value:"Module"}));var Sp;const N0e=(Sp={},Sp[""+ug]={position:"absolute",visibility:"visible",zIndex:8,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)",backgroundColor:"rgba(255, 255, 255, 0.9)",boxShadow:"0px 0px 10px #aeaeae",borderRadius:"3px",color:"rgb(87, 87, 87)",fontSize:"12px",fontFamily:Ai.fontFamily,lineHeight:"20px",padding:"10px 10px 6px 10px"},Sp[""+cg]={marginBottom:"4px"},Sp[""+JC]={margin:"0px",listStyleType:"none",padding:"0px"},Sp[""+F3]={listStyleType:"none",marginBottom:"4px"},Sp[""+B3]={width:"8px",height:"8px",borderRadius:"50%",display:"inline-block",marginRight:"8px"},Sp[""+N3]={display:"inline-block",float:"right",marginLeft:"30px"},Sp[""+f6]={position:"absolute",width:"1px",backgroundColor:"rgba(0, 0, 0, 0.25)"},Sp[""+d6]={position:"absolute",height:"1px",backgroundColor:"rgba(0, 0, 0, 0.25)"},Sp);function k0e(e,t,r,n,i){var a={left:e<i.x,right:e+r>i.x+i.width,top:t<i.y,bottom:t+n>i.y+i.height};return a}function z0e(e,t,r,n,i,a){var o=e,s=t;switch(a){case"left":o=e-n-r,s=t-i/2;break;case"right":o=e+r,s=t-i/2;break;case"top":o=e-n/2,s=t-i-r;break;case"bottom":o=e-n/2,s=t+r;break;default:o=e+r,s=t-i-r;break}return{x:o,y:s}}function U0e(e,t,r,n,i,a,o){var s=z0e(e,t,r,n,i,a);if(o){var l=k0e(s.x,s.y,n,i,o);a==="auto"?(l.right&&(s.x=Math.max(0,e-n-r)),l.top&&(s.y=Math.max(0,t-i-r))):a==="top"||a==="bottom"?(l.left&&(s.x=o.x),l.right&&(s.x=o.x+o.width-n),a==="top"&&l.top&&(s.y=t+r),a==="bottom"&&l.bottom&&(s.y=t-i-r)):(l.top&&(s.y=o.y),l.bottom&&(s.y=o.y+o.height-i),a==="left"&&l.left&&(s.x=e+r),a==="right"&&l.right&&(s.x=e-n-r))}return s}function $0e(e,t){var r=!1;return ft(t,function(n){if(jm(e,n))return r=!0,!1}),r}var H0e=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultCfg=function(){var r=e.prototype.getDefaultCfg.call(this);return U(U({},r),{name:"tooltip",type:"html",x:0,y:0,items:[],customContent:null,containerTpl:'<div class="'+ug+'"><div class="'+cg+'"></div><ul class="'+JC+'"></ul></div>',itemTpl:'<li class="'+F3+`" data-index={index}>
          <span class="`+B3+`" style="background:{color}"></span>
          <span class="`+Qst+`">{name}</span>:
          <span class="`+N3+`">{value}</span>
        </li>`,xCrosshairTpl:'<div class="'+f6+'"></div>',yCrosshairTpl:'<div class="'+d6+'"></div>',title:null,showTitle:!0,region:null,crosshairsRegion:null,containerClassName:ug,crosshairs:null,offset:10,position:"right",domStyles:null,defaultStyles:N0e})},t.prototype.render=function(){this.get("customContent")?this.renderCustomContent():(this.resetTitle(),this.renderItems()),this.resetPosition()},t.prototype.clear=function(){this.clearCrosshairs(),this.setTitle(""),this.clearItemDoms()},t.prototype.show=function(){var r=this.getContainer();!r||this.destroyed||(this.set("visible",!0),ka(r,{visibility:"visible"}),this.setCrossHairsVisible(!0))},t.prototype.hide=function(){var r=this.getContainer();!r||this.destroyed||(this.set("visible",!1),ka(r,{visibility:"hidden"}),this.setCrossHairsVisible(!1))},t.prototype.getLocation=function(){return{x:this.get("x"),y:this.get("y")}},t.prototype.setLocation=function(r){this.set("x",r.x),this.set("y",r.y),this.resetPosition()},t.prototype.setCrossHairsVisible=function(r){var n=r?"":"none",i=this.get("xCrosshairDom"),a=this.get("yCrosshairDom");i&&ka(i,{display:n}),a&&ka(a,{display:n})},t.prototype.initContainer=function(){if(e.prototype.initContainer.call(this),this.get("customContent")){this.get("container")&&this.get("container").remove();var r=this.getHtmlContentNode();this.get("parent").appendChild(r),this.set("container",r),this.resetStyles(),this.applyStyles()}},t.prototype.updateInner=function(r){this.get("customContent")?this.renderCustomContent():($0e(r,["title","showTitle"])&&this.resetTitle(),jm(r,"items")&&this.renderItems()),e.prototype.updateInner.call(this,r)},t.prototype.initDom=function(){this.cacheDoms()},t.prototype.removeDom=function(){e.prototype.removeDom.call(this),this.clearCrosshairs()},t.prototype.resetPosition=function(){var r=this.get("x"),n=this.get("y"),i=this.get("offset"),a=this.getOffset(),o=a.offsetX,s=a.offsetY,l=this.get("position"),u=this.get("region"),c=this.getContainer(),f=this.getBBox(),d=f.width,v=f.height,g;u&&(g=qC(u));var x=U0e(r,n,i,d,v,l,g);ka(c,{left:Uc(x.x+o),top:Uc(x.y+s)}),this.resetCrosshairs()},t.prototype.renderCustomContent=function(){var r=this.getHtmlContentNode(),n=this.get("parent"),i=this.get("container");i&&i.parentNode===n?n.replaceChild(r,i):n.appendChild(r),this.set("container",r),this.resetStyles(),this.applyStyles()},t.prototype.getHtmlContentNode=function(){var r,n=this.get("customContent");if(n){var i=n(this.get("title"),this.get("items"));_tt(i)?r=i:r=eg(i)}return r},t.prototype.cacheDoms=function(){var r=this.getContainer(),n=r.getElementsByClassName(cg)[0],i=r.getElementsByClassName(JC)[0];this.set("titleDom",n),this.set("listDom",i)},t.prototype.resetTitle=function(){var r=this.get("title"),n=this.get("showTitle");n&&r?this.setTitle(r):this.setTitle("")},t.prototype.setTitle=function(r){var n=this.get("titleDom");n&&(n.innerText=r)},t.prototype.resetCrosshairs=function(){var r=this.get("crosshairsRegion"),n=this.get("crosshairs");if(!r||!n)this.clearCrosshairs();else{var i=qC(r),a=this.get("xCrosshairDom"),o=this.get("yCrosshairDom");n==="x"?(this.resetCrosshair("x",i),o&&(o.remove(),this.set("yCrosshairDom",null))):n==="y"?(this.resetCrosshair("y",i),a&&(a.remove(),this.set("xCrosshairDom",null))):(this.resetCrosshair("x",i),this.resetCrosshair("y",i)),this.setCrossHairsVisible(this.get("visible"))}},t.prototype.resetCrosshair=function(r,n){var i=this.checkCrosshair(r),a=this.get(r);r==="x"?ka(i,{left:Uc(a),top:Uc(n.y),height:Uc(n.height)}):ka(i,{top:Uc(a),left:Uc(n.x),width:Uc(n.width)})},t.prototype.checkCrosshair=function(r){var n=r+"CrosshairDom",i=r+"CrosshairTpl",a="CROSSHAIR_"+r.toUpperCase(),o=B0e[a],s=this.get(n),l=this.get("parent");return s||(s=eg(this.get(i)),this.applyStyle(o,s),l.appendChild(s),this.set(n,s)),s},t.prototype.renderItems=function(){this.clearItemDoms();var r=this.get("items"),n=this.get("itemTpl"),i=this.get("listDom");i&&(ft(r,function(a){var o=Um.toCSSGradient(a.color),s=U(U({},a),{color:o}),l=dS(n,s),u=eg(l);i.appendChild(u)}),this.applyChildrenStyles(i,this.get("domStyles")))},t.prototype.clearItemDoms=function(){this.get("listDom")&&l6(this.get("listDom"))},t.prototype.clearCrosshairs=function(){var r=this.get("xCrosshairDom"),n=this.get("yCrosshairDom");r&&r.remove(),n&&n.remove(),this.set("xCrosshairDom",null),this.set("yCrosshairDom",null)},t}(u6),V0e={opacity:0},G0e={stroke:"#C5C5C5",strokeOpacity:.85},W0e={fill:"#CACED4",opacity:.85};function X0e(e,t,r,n){var i=[],a=!!n,o,s,l,u,c,f,d;if(a){l=n[0],u=n[1];for(var v=0,g=e.length;v<g;v+=1){var x=e[v];l=Nl([0,0],l,x),u=kl([0,0],u,x)}}for(var v=0,w=e.length;v<w;v+=1){var x=e[v];if(v===0&&!r)d=x;else if(v===w-1&&!r)f=x,i.push(d),i.push(f);else{var S=[v?v-1:w-1,v-1][r?0:1];o=e[S],s=e[r?(v+1)%w:v+1];var A=[0,0];A=rg(A,s,o),A=ic(A,A,t);var M=Px(x,o),R=Px(x,s),O=M+R;O!==0&&(M/=O,R/=O);var N=ic([0,0],A,-M),k=ic([0,0],A,R);f=zl([0,0],x,N),c=zl([0,0],x,k),c=Nl([0,0],c,kl([0,0],s,x)),c=kl([0,0],c,Nl([0,0],s,x)),N=rg([0,0],c,x),N=ic([0,0],N,-M/R),f=zl([0,0],x,N),f=Nl([0,0],f,kl([0,0],o,x)),f=kl([0,0],f,Nl([0,0],o,x)),k=rg([0,0],x,f),k=ic([0,0],k,R/M),c=zl([0,0],x,k),a&&(f=kl([0,0],f,l),f=Nl([0,0],f,u),c=kl([0,0],c,l),c=Nl([0,0],c,u)),i.push(d),i.push(f),d=c}}return r&&i.push(i.shift()),i}function j0e(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=[[0,0],[1,1]]);for(var n=!!t,i=[],a=0,o=e.length;a<o;a+=2)i.push([e[a],e[a+1]]);for(var s=X0e(i,.4,n,r),l=i.length,u=[],c,f,d,a=0;a<l-1;a+=1)c=s[a*2],f=s[a*2+1],d=i[a+1],u.push(["C",c[0],c[1],f[0],f[1],d[0],d[1]]);return n&&(c=s[l],f=s[l+1],d=i[0],u.push(["C",c[0],c[1],f[0],f[1],d[0],d[1]])),u}function Y0e(e){return mo(e,function(t,r){var n=r===0?"M":"L",i=t[0],a=t[1];return[n,i,a]})}function Jst(e){return Y0e(e)}function Z0e(e){if(e.length<=2)return Jst(e);var t=[];ft(e,function(o){zi(o,t.slice(t.length-2))||t.push(o[0],o[1])});var r=j0e(t,!1),n=Oh(e),i=n[0],a=n[1];return r.unshift(["M",i,a]),r}function q0e(e,t,r,n){n===void 0&&(n=!0);var i=new L3({values:e}),a=new R3({values:mo(e,function(s,l){return l})}),o=mo(e,function(s,l){return[a.scale(l)*t,r-i.scale(s)*r]});return n?Z0e(o):Jst(o)}function K0e(e,t){var r=new L3({values:e}),n=r.max<0?r.max:Math.max(0,r.min);return t-r.scale(n)*t}function Q0e(e,t,r,n){var i=Wy(e),a=K0e(n,r);return i.push(["L",t,a]),i.push(["L",0,a]),i.push(["Z"]),i}var J0e=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultCfg=function(){var r=e.prototype.getDefaultCfg.call(this);return U(U({},r),{name:"trend",x:0,y:0,width:200,height:16,smooth:!0,isArea:!1,data:[],backgroundStyle:V0e,lineStyle:G0e,areaStyle:W0e})},t.prototype.renderInner=function(r){var n=this.cfg,i=n.width,a=n.height,o=n.data,s=n.smooth,l=n.isArea,u=n.backgroundStyle,c=n.lineStyle,f=n.areaStyle;this.addShape(r,{id:this.getElementId("background"),type:"rect",attrs:U({x:0,y:0,width:i,height:a},u)});var d=q0e(o,i,a,s);if(this.addShape(r,{id:this.getElementId("line"),type:"path",attrs:U({path:d},c)}),l){var v=Q0e(d,i,a,o);this.addShape(r,{id:this.getElementId("area"),type:"path",attrs:U({path:v},f)})}},t.prototype.applyOffset=function(){var r=this.cfg,n=r.x,i=r.y;this.moveElementTo(this.get("group"),{x:n,y:i})},t}(vu),tlt={fill:"#F7F7F7",stroke:"#BFBFBF",radius:2,opacity:1,cursor:"ew-resize",highLightFill:"#FFF"},vj=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultCfg=function(){var r=e.prototype.getDefaultCfg.call(this);return U(U({},r),{name:"handler",x:0,y:0,width:10,height:24,style:tlt})},t.prototype.renderInner=function(r){var n=this.cfg,i=n.width,a=n.height,o=n.style,s=o.fill,l=o.stroke,u=o.radius,c=o.opacity,f=o.cursor;this.addShape(r,{type:"rect",id:this.getElementId("background"),attrs:{x:0,y:0,width:i,height:a,fill:s,stroke:l,radius:u,opacity:c,cursor:f}});var d=1/3*i,v=2/3*i,g=1/4*a,x=3/4*a;this.addShape(r,{id:this.getElementId("line-left"),type:"line",attrs:{x1:d,y1:g,x2:d,y2:x,stroke:l,cursor:f}}),this.addShape(r,{id:this.getElementId("line-right"),type:"line",attrs:{x1:v,y1:g,x2:v,y2:x,stroke:l,cursor:f}})},t.prototype.applyOffset=function(){this.moveElementTo(this.get("group"),{x:this.get("x"),y:this.get("y")})},t.prototype.initEvent=function(){this.bindEvents()},t.prototype.bindEvents=function(){var r=this;this.get("group").on("mouseenter",function(){var n=r.get("style").highLightFill;r.getElementByLocalId("background").attr("fill",n),r.draw()}),this.get("group").on("mouseleave",function(){var n=r.get("style").fill;r.getElementByLocalId("background").attr("fill",n),r.draw()})},t.prototype.draw=function(){var r=this.get("container").get("canvas");r&&r.draw()},t}(vu),tye={fill:"#416180",opacity:.05},eye={fill:"#5B8FF9",opacity:.15,cursor:"move"},YA=10,rye={width:YA,height:24},nye={textBaseline:"middle",fill:"#000",opacity:.45},iye="sliderchange",aye=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.onMouseDown=function(n){return function(i){r.currentTarget=n;var a=i.originalEvent;a.stopPropagation(),a.preventDefault(),r.prevX=xt(a,"touches.0.pageX",a.pageX),r.prevY=xt(a,"touches.0.pageY",a.pageY);var o=r.getContainerDOM();o.addEventListener("mousemove",r.onMouseMove),o.addEventListener("mouseup",r.onMouseUp),o.addEventListener("mouseleave",r.onMouseUp),o.addEventListener("touchmove",r.onMouseMove),o.addEventListener("touchend",r.onMouseUp),o.addEventListener("touchcancel",r.onMouseUp)}},r.onMouseMove=function(n){var i=r.cfg.width,a=[r.get("start"),r.get("end")];n.stopPropagation(),n.preventDefault();var o=xt(n,"touches.0.pageX",n.pageX),s=xt(n,"touches.0.pageY",n.pageY),l=o-r.prevX,u=r.adjustOffsetRange(l/i);r.updateStartEnd(u),r.updateUI(r.getElementByLocalId("foreground"),r.getElementByLocalId("minText"),r.getElementByLocalId("maxText")),r.prevX=o,r.prevY=s,r.draw(),r.emit(iye,[r.get("start"),r.get("end")].sort()),r.delegateEmit("valuechanged",{originValue:a,value:[r.get("start"),r.get("end")]})},r.onMouseUp=function(){r.currentTarget&&(r.currentTarget=void 0);var n=r.getContainerDOM();n&&(n.removeEventListener("mousemove",r.onMouseMove),n.removeEventListener("mouseup",r.onMouseUp),n.removeEventListener("mouseleave",r.onMouseUp),n.removeEventListener("touchmove",r.onMouseMove),n.removeEventListener("touchend",r.onMouseUp),n.removeEventListener("touchcancel",r.onMouseUp))},r}return t.prototype.setRange=function(r,n){this.set("minLimit",r),this.set("maxLimit",n);var i=this.get("start"),a=this.get("end"),o=lo(i,r,n),s=lo(a,r,n);!this.get("isInit")&&(i!==o||a!==s)&&this.setValue([o,s])},t.prototype.getRange=function(){return{min:this.get("minLimit")||0,max:this.get("maxLimit")||1}},t.prototype.setValue=function(r){var n=this.getRange();if(ze(r)&&r.length===2){var i=[this.get("start"),this.get("end")];this.update({start:lo(r[0],n.min,n.max),end:lo(r[1],n.min,n.max)}),this.get("updateAutoRender")||this.render(),this.delegateEmit("valuechanged",{originValue:i,value:r})}},t.prototype.getValue=function(){return[this.get("start"),this.get("end")]},t.prototype.getDefaultCfg=function(){var r=e.prototype.getDefaultCfg.call(this);return U(U({},r),{name:"slider",x:0,y:0,width:100,height:16,backgroundStyle:{},foregroundStyle:{},handlerStyle:{},textStyle:{},defaultCfg:{backgroundStyle:tye,foregroundStyle:eye,handlerStyle:rye,textStyle:nye}})},t.prototype.update=function(r){var n=r.start,i=r.end,a=U({},r);ke(n)||(a.start=lo(n,0,1)),ke(i)||(a.end=lo(i,0,1)),e.prototype.update.call(this,a),this.minHandler=this.getChildComponentById(this.getElementId("minHandler")),this.maxHandler=this.getChildComponentById(this.getElementId("maxHandler")),this.trend=this.getChildComponentById(this.getElementId("trend"))},t.prototype.init=function(){this.set("start",lo(this.get("start"),0,1)),this.set("end",lo(this.get("end"),0,1)),e.prototype.init.call(this)},t.prototype.render=function(){e.prototype.render.call(this),this.updateUI(this.getElementByLocalId("foreground"),this.getElementByLocalId("minText"),this.getElementByLocalId("maxText"))},t.prototype.renderInner=function(r){var n=this.cfg;n.start,n.end;var i=n.width,a=n.height,o=n.trendCfg,s=o===void 0?{}:o,l=n.minText,u=n.maxText,c=n.backgroundStyle,f=c===void 0?{}:c,d=n.foregroundStyle,v=d===void 0?{}:d,g=n.textStyle,x=g===void 0?{}:g,w=Tr({},tlt,this.cfg.handlerStyle);_l(xt(s,"data"))&&(this.trend=this.addComponent(r,U({component:J0e,id:this.getElementId("trend"),x:0,y:0,width:i,height:a},s))),this.addShape(r,{id:this.getElementId("background"),type:"rect",attrs:U({x:0,y:0,width:i,height:a},f)}),this.addShape(r,{id:this.getElementId("minText"),type:"text",attrs:U({y:a/2,textAlign:"right",text:l,silent:!1},x)}),this.addShape(r,{id:this.getElementId("maxText"),type:"text",attrs:U({y:a/2,textAlign:"left",text:u,silent:!1},x)}),this.addShape(r,{id:this.getElementId("foreground"),name:"foreground",type:"rect",attrs:U({y:0,height:a},v)});var S=xt(w,"width",YA),A=xt(w,"height",24);this.minHandler=this.addComponent(r,{component:vj,id:this.getElementId("minHandler"),name:"handler-min",x:0,y:(a-A)/2,width:S,height:A,cursor:"ew-resize",style:w}),this.maxHandler=this.addComponent(r,{component:vj,id:this.getElementId("maxHandler"),name:"handler-max",x:0,y:(a-A)/2,width:S,height:A,cursor:"ew-resize",style:w})},t.prototype.applyOffset=function(){this.moveElementTo(this.get("group"),{x:this.get("x"),y:this.get("y")})},t.prototype.initEvent=function(){this.bindEvents()},t.prototype.updateUI=function(r,n,i){var a=this.cfg,o=a.start,s=a.end,l=a.width,u=a.minText,c=a.maxText,f=a.handlerStyle,d=a.height,v=o*l,g=s*l;this.trend&&(this.trend.update({width:l,height:d}),this.get("updateAutoRender")||this.trend.render()),r.attr("x",v),r.attr("width",g-v);var x=xt(f,"width",YA);n.attr("text",u),i.attr("text",c);var w=this._dodgeText([v,g],n,i),S=w[0],A=w[1];this.minHandler&&(this.minHandler.update({x:v-x/2}),this.get("updateAutoRender")||this.minHandler.render()),ft(S,function(M,R){return n.attr(R,M)}),this.maxHandler&&(this.maxHandler.update({x:g-x/2}),this.get("updateAutoRender")||this.maxHandler.render()),ft(A,function(M,R){return i.attr(R,M)})},t.prototype.bindEvents=function(){var r=this.get("group");r.on("handler-min:mousedown",this.onMouseDown("minHandler")),r.on("handler-min:touchstart",this.onMouseDown("minHandler")),r.on("handler-max:mousedown",this.onMouseDown("maxHandler")),r.on("handler-max:touchstart",this.onMouseDown("maxHandler"));var n=r.findById(this.getElementId("foreground"));n.on("mousedown",this.onMouseDown("foreground")),n.on("touchstart",this.onMouseDown("foreground"))},t.prototype.adjustOffsetRange=function(r){var n=this.cfg,i=n.start,a=n.end;switch(this.currentTarget){case"minHandler":{var o=0-i,s=1-i;return Math.min(s,Math.max(o,r))}case"maxHandler":{var o=0-a,s=1-a;return Math.min(s,Math.max(o,r))}case"foreground":{var o=0-i,s=1-a;return Math.min(s,Math.max(o,r))}}},t.prototype.updateStartEnd=function(r){var n=this.cfg,i=n.start,a=n.end;switch(this.currentTarget){case"minHandler":i+=r;break;case"maxHandler":a+=r;break;case"foreground":i+=r,a+=r;break}this.set("start",i),this.set("end",a)},t.prototype._dodgeText=function(r,n,i){var a,o,s=this.cfg,l=s.handlerStyle,u=s.width,c=2,f=xt(l,"width",YA),d=r[0],v=r[1],g=!1;d>v&&(a=[v,d],d=a[0],v=a[1],o=[i,n],n=o[0],i=o[1],g=!0);var x=n.getBBox(),w=i.getBBox(),S=x.width>d-c?{x:d+f/2+c,textAlign:"left"}:{x:d-f/2-c,textAlign:"right"},A=w.width>u-v-c?{x:v-f/2-c,textAlign:"right"}:{x:v+f/2+c,textAlign:"left"};return g?[A,S]:[S,A]},t.prototype.draw=function(){var r=this.get("container"),n=r&&r.get("canvas");n&&n.draw()},t.prototype.getContainerDOM=function(){var r=this.get("container"),n=r&&r.get("canvas");return n&&n.get("container")},t}(vu),oye={trackColor:"rgba(0,0,0,0)",thumbColor:"rgba(0,0,0,0.15)",size:8,lineCap:"round"},_P={default:oye,hover:{thumbColor:"rgba(0,0,0,0.2)"}},sye=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.clearEvents=Mm,r.onStartEvent=function(n){return function(i){r.isMobile=n,i.originalEvent.preventDefault();var a=n?xt(i.originalEvent,"touches.0.clientX"):i.clientX,o=n?xt(i.originalEvent,"touches.0.clientY"):i.clientY;r.startPos=r.cfg.isHorizontal?a:o,r.bindLaterEvent()}},r.bindLaterEvent=function(){var n=r.getContainerDOM(),i=[];r.isMobile?i=[L1(n,"touchmove",r.onMouseMove),L1(n,"touchend",r.onMouseUp),L1(n,"touchcancel",r.onMouseUp)]:i=[L1(n,"mousemove",r.onMouseMove),L1(n,"mouseup",r.onMouseUp),L1(n,"mouseleave",r.onMouseUp)],r.clearEvents=function(){i.forEach(function(a){a.remove()})}},r.onMouseMove=function(n){var i=r.cfg,a=i.isHorizontal,o=i.thumbOffset;n.preventDefault();var s=r.isMobile?xt(n,"touches.0.clientX"):n.clientX,l=r.isMobile?xt(n,"touches.0.clientY"):n.clientY,u=a?s:l,c=u-r.startPos;r.startPos=u,r.updateThumbOffset(o+c)},r.onMouseUp=function(n){n.preventDefault(),r.clearEvents()},r.onTrackClick=function(n){var i=r.cfg,a=i.isHorizontal,o=i.x,s=i.y,l=i.thumbLen,u=r.getContainerDOM(),c=u.getBoundingClientRect(),f=n.clientX,d=n.clientY,v=a?f-c.left-o-l/2:d-c.top-s-l/2,g=r.validateRange(v);r.updateThumbOffset(g)},r.onThumbMouseOver=function(){var n=r.cfg.theme.hover.thumbColor;r.getElementByLocalId("thumb").attr("stroke",n),r.draw()},r.onThumbMouseOut=function(){var n=r.cfg.theme.default.thumbColor;r.getElementByLocalId("thumb").attr("stroke",n),r.draw()},r}return t.prototype.setRange=function(r,n){this.set("minLimit",r),this.set("maxLimit",n);var i=this.getValue(),a=lo(i,r,n);i!==a&&!this.get("isInit")&&this.setValue(a)},t.prototype.getRange=function(){var r=this.get("minLimit")||0,n=this.get("maxLimit")||1;return{min:r,max:n}},t.prototype.setValue=function(r){var n=this.getRange(),i=this.getValue();this.update({thumbOffset:(this.get("trackLen")-this.get("thumbLen"))*lo(r,n.min,n.max)}),this.delegateEmit("valuechange",{originalValue:i,value:this.getValue()})},t.prototype.getValue=function(){return lo(this.get("thumbOffset")/(this.get("trackLen")-this.get("thumbLen")),0,1)},t.prototype.getDefaultCfg=function(){var r=e.prototype.getDefaultCfg.call(this);return U(U({},r),{name:"scrollbar",isHorizontal:!0,minThumbLen:20,thumbOffset:0,theme:_P})},t.prototype.renderInner=function(r){this.renderTrackShape(r),this.renderThumbShape(r)},t.prototype.applyOffset=function(){this.moveElementTo(this.get("group"),{x:this.get("x"),y:this.get("y")})},t.prototype.initEvent=function(){this.bindEvents()},t.prototype.renderTrackShape=function(r){var n=this.cfg,i=n.trackLen,a=n.theme,o=a===void 0?{default:{}}:a,s=Tr({},_P,o).default,l=s.lineCap,u=s.trackColor,c=s.size,f=xt(this.cfg,"size",c),d=this.get("isHorizontal")?{x1:0+f/2,y1:f/2,x2:i-f/2,y2:f/2,lineWidth:f,stroke:u,lineCap:l}:{x1:f/2,y1:0+f/2,x2:f/2,y2:i-f/2,lineWidth:f,stroke:u,lineCap:l};return this.addShape(r,{id:this.getElementId("track"),name:"track",type:"line",attrs:d})},t.prototype.renderThumbShape=function(r){var n=this.cfg,i=n.thumbOffset,a=n.thumbLen,o=n.theme,s=Tr({},_P,o).default,l=s.size,u=s.lineCap,c=s.thumbColor,f=xt(this.cfg,"size",l),d=this.get("isHorizontal")?{x1:i+f/2,y1:f/2,x2:i+a-f/2,y2:f/2,lineWidth:f,stroke:c,lineCap:u,cursor:"default"}:{x1:f/2,y1:i+f/2,x2:f/2,y2:i+a-f/2,lineWidth:f,stroke:c,lineCap:u,cursor:"default"};return this.addShape(r,{id:this.getElementId("thumb"),name:"thumb",type:"line",attrs:d})},t.prototype.bindEvents=function(){var r=this.get("group");r.on("mousedown",this.onStartEvent(!1)),r.on("mouseup",this.onMouseUp),r.on("touchstart",this.onStartEvent(!0)),r.on("touchend",this.onMouseUp);var n=r.findById(this.getElementId("track"));n.on("click",this.onTrackClick);var i=r.findById(this.getElementId("thumb"));i.on("mouseover",this.onThumbMouseOver),i.on("mouseout",this.onThumbMouseOut)},t.prototype.getContainerDOM=function(){var r=this.get("container"),n=r&&r.get("canvas");return n&&n.get("container")},t.prototype.validateRange=function(r){var n=this.cfg,i=n.thumbLen,a=n.trackLen,o=r;return r+i>a?o=a-i:r+i<i&&(o=0),o},t.prototype.draw=function(){var r=this.get("container"),n=r&&r.get("canvas");n&&n.draw()},t.prototype.updateThumbOffset=function(r){var n=this.cfg,i=n.thumbOffset,a=n.isHorizontal,o=n.thumbLen,s=n.size,l=this.validateRange(r);if(l!==i){var u=this.getElementByLocalId("thumb");a?u.attr({x1:l+s/2,x2:l+o-s/2}):u.attr({y1:l+s/2,y2:l+o-s/2}),this.emitOffsetChange(l)}},t.prototype.emitOffsetChange=function(r){var n=this.cfg,i=n.thumbOffset,a=n.trackLen,o=n.thumbLen;this.cfg.thumbOffset=r,this.emit("scrollchange",{thumbOffset:r,ratio:lo(r/(a-o),0,1)}),this.delegateEmit("valuechange",{originalValue:i,value:r})},t}(vu),lye=S0e,uye=T0e,cye=O0e,hye=L0e,gj=P0e,fye=F0e,k3=H0e;function dye(e){if(Kc(e))return null;var t=e[0].x,r=e[0].x,n=e[0].y,i=e[0].y;return ft(e,function(a){t=t>a.x?a.x:t,r=r<a.x?a.x:r,n=n>a.y?a.y:n,i=i<a.y?a.y:i}),{minX:t,maxX:r,minY:n,maxY:i,centerX:(t+r)/2,centerY:(n+i)/2}}function mj(e){return Array.from(new Set(e)).length===1}function yj(e){return(Vf(e)+kh(e))/2}function Ls(e,t,r,n){return{x:e+r*Math.cos(n),y:t+r*Math.sin(n)}}function $m(e,t,r,n,i,a){a===void 0&&(a=0);var o=Ls(e,t,r,n),s=Ls(e,t,r,i),l=Ls(e,t,a,n),u=Ls(e,t,a,i);if(i-n===Math.PI*2){var c=Ls(e,t,r,n+Math.PI),f=Ls(e,t,a,n+Math.PI),d=[["M",o.x,o.y],["A",r,r,0,1,1,c.x,c.y],["A",r,r,0,1,1,s.x,s.y],["M",l.x,l.y]];return a&&(d.push(["A",a,a,0,1,0,f.x,f.y]),d.push(["A",a,a,0,1,0,u.x,u.y])),d.push(["M",o.x,o.y]),d.push(["Z"]),d}var v=i-n<=Math.PI?0:1,g=[["M",o.x,o.y],["A",r,r,0,v,1,s.x,s.y],["L",u.x,u.y]];return a&&g.push(["A",a,a,0,v,0,l.x,l.y]),g.push(["L",o.x,o.y]),g.push(["Z"]),g}function elt(e,t,r,n,i){var a=Ls(e,t,r,n),o=Ls(e,t,r,i);if(Ul(i-n,Math.PI*2)){var s=Ls(e,t,r,n+Math.PI);return[["M",a.x,a.y],["A",r,r,0,1,1,s.x,s.y],["A",r,r,0,1,1,a.x,a.y],["A",r,r,0,1,0,s.x,s.y],["A",r,r,0,1,0,a.x,a.y],["Z"]]}var l=i-n<=Math.PI?0:1;return[["M",a.x,a.y],["A",r,r,0,l,1,o.x,o.y]]}function tS(e,t){var r=e.points,n=dye(r),i,a,o=t.startAngle,s=t.endAngle,l=s-o;return t.isTransposed?(i=n.maxY*l,a=n.minY*l):(i=n.maxX*l,a=n.minX*l),i+=o,a+=o,{startAngle:a,endAngle:i}}function pye(e,t){if(Gn(e)&&Gn(t))return[e,t];if(e=e,t=t,mj(e)||mj(t))return[yj(e),yj(t)];for(var r=-1,n=0,i=0,a,o=e.length-1,s,l=0;++r<e.length;)a=o,o=r,l+=s=e[a]*t[o]-e[o]*t[a],n+=(e[a]+e[o])*s,i+=(t[a]+t[o])*s;return l*=3,[n/l,i/l]}function rlt(e,t){var r=e.attr(),n=t.attr();return ft(r,function(i,a){n[a]===void 0&&(n[a]=void 0)}),n}function ix(e,t,r){var n=Math.min(t,r),i=Math.max(t,r);return e>=n&&e<=i}function vye(e,t,r){if(nn(e))return e.padEnd(t,r);if(ze(e)){var n=e.length;if(n<t)for(var i=t-n,a=0;a<i;a++)e.push(r)}return e}function $c(e,t){return typeof e=="object"&&t.forEach(function(r){delete e[r]}),e}function wm(e,t,r){var n,i;t===void 0&&(t=[]),r===void 0&&(r=new Map);try{for(var a=mi(e),o=a.next();!o.done;o=a.next()){var s=o.value;r.has(s)||(t.push(s),r.set(s,!0))}}catch(l){n={error:l}}finally{try{o&&!o.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}return t}var lc=function(){function e(t,r,n,i){t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=0),i===void 0&&(i=0),this.x=t,this.y=r,this.height=i,this.width=n}return e.fromRange=function(t,r,n,i){return new e(t,r,n-t,i-r)},e.fromObject=function(t){return new e(t.minX,t.minY,t.width,t.height)},Object.defineProperty(e.prototype,"minX",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxX",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minY",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxY",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tl",{get:function(){return{x:this.x,y:this.y}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tr",{get:function(){return{x:this.maxX,y:this.y}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bl",{get:function(){return{x:this.x,y:this.maxY}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"br",{get:function(){return{x:this.maxX,y:this.maxY}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return{x:this.x+this.width/2,y:this.minY}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return{x:this.maxX,y:this.y+this.height/2}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return{x:this.x+this.width/2,y:this.maxY}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return{x:this.minX,y:this.y+this.height/2}},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height},e.prototype.contains=function(t){return t.minX>=this.minX&&t.maxX<=this.maxX&&t.minY>=this.minY&&t.maxY<=this.maxY},e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height)},e.prototype.add=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=this.clone();return ft(t,function(i){n.x=Math.min(i.x,n.x),n.y=Math.min(i.y,n.y),n.width=Math.max(i.maxX,n.maxX)-n.x,n.height=Math.max(i.maxY,n.maxY)-n.y}),n},e.prototype.merge=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=this.clone();return ft(t,function(i){n.x=Math.max(i.x,n.x),n.y=Math.max(i.y,n.y),n.width=Math.min(i.maxX,n.maxX)-n.x,n.height=Math.min(i.maxY,n.maxY)-n.y}),n},e.prototype.cut=function(t,r){var n=t.width,i=t.height;switch(r){case xr.TOP:case xr.TOP_LEFT:case xr.TOP_RIGHT:return e.fromRange(this.minX,this.minY+i,this.maxX,this.maxY);case xr.RIGHT:case xr.RIGHT_TOP:case xr.RIGHT_BOTTOM:return e.fromRange(this.minX,this.minY,this.maxX-n,this.maxY);case xr.BOTTOM:case xr.BOTTOM_LEFT:case xr.BOTTOM_RIGHT:return e.fromRange(this.minX,this.minY,this.maxX,this.maxY-i);case xr.LEFT:case xr.LEFT_TOP:case xr.LEFT_BOTTOM:return e.fromRange(this.minX+n,this.minY,this.maxX,this.maxY);default:return this}},e.prototype.shrink=function(t){var r=Lr(t,4),n=r[0],i=r[1],a=r[2],o=r[3];return new e(this.x+o,this.y+n,this.width-o-i,this.height-n-a)},e.prototype.expand=function(t){var r=Lr(t,4),n=r[0],i=r[1],a=r[2],o=r[3];return new e(this.x-o,this.y-n,this.width+o+i,this.height+n+a)},e.prototype.exceed=function(t){return[Math.max(-this.minY+t.minY,0),Math.max(this.maxX-t.maxX,0),Math.max(this.maxY-t.maxY,0),Math.max(-this.minX+t.minX,0)]},e.prototype.collide=function(t){return this.minX<t.maxX&&this.maxX>t.minX&&this.minY<t.maxY&&this.maxY>t.minY},e.prototype.size=function(){return this.width*this.height},e.prototype.isPointIn=function(t){return t.x>=this.minX&&t.x<=this.maxX&&t.y>=this.minY&&t.y<=this.maxY},e}();function gye(e){return[[e.minX,e.minY],[e.maxX,e.minY],[e.maxX,e.maxY],[e.minX,e.maxY]]}function KS(e){if(e.isPolar&&!e.isTransposed)return(e.endAngle-e.startAngle)*e.getRadius();var t=e.convert({x:0,y:0}),r=e.convert({x:1,y:0});return Math.sqrt(Math.pow(r.x-t.x,2)+Math.pow(r.y-t.y,2))}function mye(e){if(e.isPolar){var t=e.startAngle,r=e.endAngle;return r-t===Math.PI*2}return!1}function z3(e,t){var r=e.getCenter();return Math.sqrt(Math.pow(t.x-r.x,2)+Math.pow(t.y-r.y,2))}function yye(e,t){var r=!1;if(e)if(e.type==="theta"){var n=e.start,i=e.end;r=ix(t.x,n.x,i.x)&&ix(t.y,n.y,i.y)}else{var a=e.invert(t);r=ix(a.x,0,1)&&ix(a.y,0,1)}return r}function ab(e,t){var r=e.getCenter();return Math.atan2(t.y-r.y,t.x-r.x)}function p6(e,t){t===void 0&&(t=0);var r=e.start,n=e.end,i=e.getWidth(),a=e.getHeight();if(e.isPolar){var o=e.startAngle,s=e.endAngle,l=e.getCenter(),u=e.getRadius();return{type:"path",startState:{path:$m(l.x,l.y,u+t,o,o)},endState:function(f){var d=(s-o)*f+o,v=$m(l.x,l.y,u+t,o,d);return{path:v}},attrs:{path:$m(l.x,l.y,u+t,o,s)}}}var c;return e.isTransposed?c={height:a+t*2}:c={width:i+t*2},{type:"rect",startState:{x:r.x-t,y:n.y-t,width:e.isTransposed?i+t*2:0,height:e.isTransposed?0:a+t*2},endState:c,attrs:{x:r.x-t,y:n.y-t,width:i+t*2,height:a+t*2}}}function _ye(e,t){t===void 0&&(t=0);var r=e.start,n=e.end,i=e.getWidth(),a=e.getHeight(),o=Math.min(r.x,n.x),s=Math.min(r.y,n.y);return lc.fromRange(o-t,s-t,o+i+t,s+a+t)}var xye=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]+)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/;function bye(e){var t="linear";return xye.test(e)?t="timeCat":nn(e)&&(t="cat"),t}function nlt(e,t,r,n){return t===void 0&&(t={}),t.type?t.type:e.type!=="identity"&&nx.includes(r)&&["interval"].includes(n)||e.isCategory?"cat":e.type}function Eye(e,t,r){var n=t||[];if(Gn(e)||ke(lUt(n,e))&&Kc(r)){var i=zB("identity");return new i({field:e.toString(),values:[e]})}var a=$d(n,e),o=xt(r,"type",bye(a[0])),s=zB(o);return new s(U({field:e,values:a},r))}function wye(e,t){if(e.type!=="identity"&&t.type!=="identity"){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);e.change(r)}}function eS(e){return e.alias||e.field}function ilt(e,t,r){var n=e.values,i=n.length,a;if(i===1)a=[.5,1];else{var o=1,s=0;mye(t)?t.isTransposed?(o=xt(r,"widthRatio.multiplePie",1/1.3),s=1/i*o,a=[s/2,1-s/2]):a=[0,1-1/i]:(s=1/i/2,a=[s,1-s])}return a}function Cye(e){var t=e.values.filter(function(r){return!ke(r)&&!isNaN(r)});return Math.max.apply(Math,an(an([],Lr(t),!1),[ke(e.max)?-1/0:e.max],!1))}function Sye(e){var t,r;switch(e){case xr.TOP:t={x:0,y:1},r={x:1,y:1};break;case xr.RIGHT:t={x:1,y:0},r={x:1,y:1};break;case xr.BOTTOM:t={x:0,y:0},r={x:1,y:0};break;case xr.LEFT:t={x:0,y:0},r={x:0,y:1};break;default:t=r={x:0,y:0}}return{start:t,end:r}}function Tye(e){var t,r;return e.isTransposed?(t={x:0,y:0},r={x:1,y:0}):(t={x:0,y:0},r={x:0,y:1}),{start:t,end:r}}function eA(e,t){var r={start:{x:0,y:0},end:{x:0,y:0}};e.isRect?r=Sye(t):e.isPolar&&(r=Tye(e));var n=r.start,i=r.end;return{start:e.convert(n),end:e.convert(i)}}function alt(e){var t=e.start,r=e.end;return t.x===r.x}function _j(e,t){var r=e.start,n=e.end,i=alt(e);return i?(r.y-n.y)*(t.x-r.x)>0?1:-1:(n.x-r.x)*(r.y-t.y)>0?-1:1}function rA(e,t){var r=xt(e,["components","axis"],{});return Tr({},xt(r,["common"],{}),Tr({},xt(r,[t],{})))}function xj(e,t,r){var n=xt(e,["components","axis"],{});return Tr({},xt(n,["common","title"],{}),Tr({},xt(n,[t,"title"],{})),r)}function xP(e){var t=e.x,r=e.y,n=e.circleCenter,i=r.start>r.end,a=e.isTransposed?e.convert({x:i?0:1,y:0}):e.convert({x:0,y:i?0:1}),o=[a.x-n.x,a.y-n.y],s=[1,0],l=a.y>n.y?dD(o,s):dD(o,s)*-1,u=l+(t.end-t.start),c=Math.sqrt(Math.pow(a.x-n.x,2)+Math.pow(a.y-n.y,2));return{center:n,radius:c,startAngle:l,endAngle:u}}function BR(e,t){return Ym(e)?e===!1?!1:{}:xt(e,[t])}function bj(e,t){return xt(e,"position",t)}function Ej(e,t){return xt(t,["title","text"],eS(e))}var kb=function(){function e(t,r){this.destroyed=!1,this.facets=[],this.view=t,this.cfg=Tr({},this.getDefaultCfg(),r)}return e.prototype.init=function(){this.container||(this.container=this.createContainer());var t=this.view.getData();this.facets=this.generateFacets(t)},e.prototype.render=function(){this.renderViews()},e.prototype.update=function(){},e.prototype.clear=function(){this.clearFacetViews()},e.prototype.destroy=function(){this.clear(),this.container&&(this.container.remove(!0),this.container=void 0),this.destroyed=!0,this.view=void 0,this.facets=[]},e.prototype.facetToView=function(t){var r=t.region,n=t.data,i=t.padding,a=i===void 0?this.cfg.padding:i,o=this.view.createView({region:r,padding:a});o.data(n||[]),t.view=o,this.beforeEachView(o,t);var s=this.cfg.eachView;return s&&s(o,t),this.afterEachView(o,t),o},e.prototype.createContainer=function(){var t=this.view.getLayer(ys.FORE);return t.addGroup()},e.prototype.renderViews=function(){this.createFacetViews()},e.prototype.createFacetViews=function(){var t=this;return this.facets.map(function(r){return t.facetToView(r)})},e.prototype.clearFacetViews=function(){var t=this;ft(this.facets,function(r){r.view&&(t.view.removeView(r.view),r.view=void 0)})},e.prototype.parseSpacing=function(){var t=this.view.viewBBox,r=t.width,n=t.height,i=this.cfg.spacing;return i.map(function(a,o){return Gn(a)?a/(o===0?r:n):parseFloat(a)/100})},e.prototype.getFieldValues=function(t,r){var n=[],i={};return ft(t,function(a){var o=a[r];!ke(o)&&!i[o]&&(n.push(o),i[o]=!0)}),n},e.prototype.getRegion=function(t,r,n,i){var a=Lr(this.parseSpacing(),2),o=a[0],s=a[1],l=(1+o)/(r===0?1:r)-o,u=(1+s)/(t===0?1:t)-s,c={x:(l+o)*n,y:(u+s)*i},f={x:c.x+l,y:c.y+u};return{start:c,end:f}},e.prototype.getDefaultCfg=function(){return{eachView:void 0,showTitle:!0,spacing:[0,0],padding:10,fields:[]}},e.prototype.getDefaultTitleCfg=function(){var t=this.view.getTheme().fontFamily;return{style:{fontSize:14,fill:"#666",fontFamily:t}}},e.prototype.processAxis=function(t,r){var n=t.getOptions(),i=n.coordinate,a=t.geometries,o=xt(i,"type","rect");if(o==="rect"&&a.length){ke(n.axes)&&(n.axes={});var s=n.axes,l=Lr(a[0].getXYFields(),2),u=l[0],c=l[1],f=BR(s,u),d=BR(s,c);f!==!1&&(n.axes[u]=this.getXAxisOption(u,s,f,r)),d!==!1&&(n.axes[c]=this.getYAxisOption(c,s,d,r))}},e.prototype.getFacetDataFilter=function(t){return function(r){return D4(t,function(n){var i=n.field,a=n.value;return!ke(a)&&i?r[i]===a:!0})}},e}(),olt={},Aye=function(e){return olt[w_(e)]},zb=function(e,t){olt[w_(e)]=t},to=function(){function e(t,r){this.context=t,this.cfg=r,t.addAction(this)}return e.prototype.applyCfg=function(t){Sa(this,t)},e.prototype.init=function(){this.applyCfg(this.cfg)},e.prototype.destroy=function(){this.context.removeAction(this),this.context=null},e}(),Mye=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.execute=function(){this.callback&&this.callback(this.context)},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.callback=null},t}(to),v6={};function Rye(e,t){var r=v6[e],n=null;if(r){var i=r.ActionClass,a=r.cfg;n=new i(t,a),n.name=e,n.init()}return n}function U3(e){var t=v6[e];return xt(t,"ActionClass")}function mn(e,t,r){v6[e]={ActionClass:t,cfg:r}}function Iye(e,t){var r=new Mye(t);return r.callback=e,r.name="callback",r}function Lye(e,t){var r=[];if(e.length){r.push(["M",e[0].x,e[0].y]);for(var n=1,i=e.length;n<i;n+=1){var a=e[n];r.push(["L",a.x,a.y])}t&&r.push(["Z"])}return r}function WB(e,t){for(var r=[e[0]],n=1,i=e.length;n<i;n=n+2){var a=t.convert({x:e[n],y:e[n+1]});r.push(a.x,a.y)}return r}function slt(e,t){var r=t.isTransposed,n=e[1],i=e[6],a=e[7],o=t.convert({x:i,y:a}),s=r?0:1;return["A",n,n,0,0,s,o.x,o.y]}function Oye(e,t,r){var n=r.isTransposed,i=r.startAngle,a=r.endAngle,o=e[0].toLowerCase()==="a"?{x:e[6],y:e[7]}:{x:e[1],y:e[2]},s={x:t[1],y:t[2]},l=[],u=n?"y":"x",c=Math.abs(s[u]-o[u])*(a-i),f=s[u]>=o[u]?1:0,d=c>Math.PI?1:0,v=r.convert(s),g=z3(r,v);if(g>=.5)if(c===Math.PI*2){var x={x:(s.x+o.x)/2,y:(s.y+o.y)/2},w=r.convert(x);l.push(["A",g,g,0,d,f,w.x,w.y]),l.push(["A",g,g,0,d,f,v.x,v.y])}else l.push(["A",g,g,0,d,f,v.x,v.y]);return l}function Pye(e){ft(e,function(t,r){var n=t;if(n[0].toLowerCase()==="a"){var i=e[r-1],a=e[r+1];a&&a[0].toLowerCase()==="a"?i&&i[0].toLowerCase()==="l"&&(i[0]="M"):i&&i[0].toLowerCase()==="a"&&a&&a[0].toLowerCase()==="l"&&(a[0]="M")}})}var Dye=function(e,t,r,n){var i,a=[],o=!!n,s,l,u,c,f,d,v;if(o){i=Lr(n,2),u=i[0],c=i[1];for(var g=0,x=e.length;g<x;g++){var w=e[g];u=Nl([0,0],u,w),c=kl([0,0],c,w)}}for(var g=0,S=e.length;g<S;g++){var w=e[g];if(g===0&&!r)v=w;else if(g===S-1&&!r)d=w,a.push(v),a.push(d);else{s=e[r?g?g-1:S-1:g-1],l=e[r?(g+1)%S:g+1];var A=[0,0];A=rg(A,l,s),A=ic(A,A,t);var M=Px(w,s),R=Px(w,l),O=M+R;O!==0&&(M/=O,R/=O);var N=ic([0,0],A,-M),k=ic([0,0],A,R);d=zl([0,0],w,N),f=zl([0,0],w,k),f=Nl([0,0],f,kl([0,0],l,w)),f=kl([0,0],f,Nl([0,0],l,w)),N=rg([0,0],f,w),N=ic([0,0],N,-M/R),d=zl([0,0],w,N),d=Nl([0,0],d,kl([0,0],s,w)),d=kl([0,0],d,Nl([0,0],s,w)),k=rg([0,0],w,d),k=ic([0,0],k,R/M),f=zl([0,0],w,k),o&&(d=kl([0,0],d,u),d=Nl([0,0],d,c),f=kl([0,0],f,u),f=Nl([0,0],f,c)),a.push(v),a.push(d),v=f}}return r&&a.push(a.shift()),a};function llt(e,t,r){for(var n=!!t,i=[],a=0,o=e.length;a<o;a+=2)i.push([e[a],e[a+1]]);for(var s=Dye(i,.4,n,r),l=i.length,u=[],c,f,d,a=0;a<l-1;a++)c=s[a*2],f=s[a*2+1],d=i[a+1],u.push(["C",c[0],c[1],f[0],f[1],d[0],d[1]]);return n&&(c=s[l],f=s[l+1],d=i[0],u.push(["C",c[0],c[1],f[0],f[1],d[0],d[1]])),u}function QS(e,t){return Lye(e,t)}function NR(e,t,r){var n=[],i=e[0],a=null;if(e.length<=2)return QS(e,t);for(var o=0,s=e.length;o<s;o++){var l=e[o];(!a||!(a.x===l.x&&a.y===l.y))&&(n.push(l.x),n.push(l.y),a=l)}var u=r||[[0,0],[1,1]],c=llt(n,t,u);return c.unshift(["M",i.x,i.y]),c}function Fye(e,t){var r=[];return ft(t,function(n){var i=n[0];switch(i.toLowerCase()){case"m":case"l":case"c":r.push(WB(n,e));break;case"a":r.push(slt(n,e));break;case"z":default:r.push(n);break}}),r}function Bye(e,t){var r=[],n,i,a,o;return ft(t,function(s,l){var u=s[0];switch(u.toLowerCase()){case"m":case"c":case"q":r.push(WB(s,e));break;case"l":n=t[l-1],i=s,a=e.isTransposed,o=a?n[n.length-2]===i[1]:n[n.length-1]===i[2],o?r=r.concat(Oye(n,i,e)):r.push(WB(s,e));break;case"a":r.push(slt(s,e));break;case"z":default:r.push(s);break}}),Pye(r),r}var qw=`	
\v\f\r   ᠎             　\u2028\u2029`,Nye=new RegExp("([a-z])["+qw+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+qw+"]*,?["+qw+"]*)+)","ig"),kye=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+qw+"]*,?["+qw+"]*","ig");function zye(e){if(!e)return null;if(ze(e))return e;var t={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},r=[];return String(e).replace(Nye,function(n,i,a){var o=[],s=i.toLowerCase();if(a.replace(kye,function(l,u){u&&o.push(+u)}),s==="m"&&o.length>2&&(r.push([i].concat(o.splice(0,2))),s="l",i=i==="m"?"l":"L"),s==="o"&&o.length===1&&r.push([i,o[0]]),s==="r")r.push([i].concat(o));else for(;o.length>=t[s]&&(r.push([i].concat(o.splice(0,t[s]))),!!t[s]););return""}),r}var wj=function(e,t,r){return e>=t&&e<=r};function Uye(e,t,r,n){var i=.001,a={x:r.x-e.x,y:r.y-e.y},o={x:t.x-e.x,y:t.y-e.y},s={x:n.x-r.x,y:n.y-r.y},l=o.x*s.y-o.y*s.x,u=l*l,c=o.x*o.x+o.y*o.y,f=s.x*s.x+s.y*s.y,d=null;if(u>i*c*f){var v=(a.x*s.y-a.y*s.x)/l,g=(a.x*o.y-a.y*o.x)/l;wj(v,0,1)&&wj(g,0,1)&&(d={x:e.x+v*o.x,y:e.y+v*o.y})}return d}var $ye=1e-6;function bP(e){return Math.abs(e)<$ye?0:e<0?-1:1}function Hye(e,t,r){return(r[0]-e[0])*(t[1]-e[1])===(t[0]-e[0])*(r[1]-e[1])&&Math.min(e[0],t[0])<=r[0]&&r[0]<=Math.max(e[0],t[0])&&Math.min(e[1],t[1])<=r[1]&&r[1]<=Math.max(e[1],t[1])}function Cj(e,t,r){var n=!1,i=e.length;if(i<=2)return!1;for(var a=0;a<i;a++){var o=e[a],s=e[(a+1)%i];if(Hye(o,s,[t,r]))return!0;bP(o[1]-r)>0!=bP(s[1]-r)>0&&bP(t-(r-o[1])*(o[0]-s[0])/(o[1]-s[1])-o[0])<0&&(n=!n)}return n}function Sj(e){for(var t=[],r=e.length,n=0;n<r-1;n++){var i=e[n],a=e[n+1];t.push({from:{x:i[0],y:i[1]},to:{x:a[0],y:a[1]}})}if(t.length>1){var o=e[0],s=e[r-1];t.push({from:{x:s[0],y:s[1]},to:{x:o[0],y:o[1]}})}return t}function Vye(e,t){var r=!1;return ft(e,function(n){if(Uye(n.from,n.to,t.from,t.to))return r=!0,!1}),r}function Tj(e){var t=e.map(function(n){return n[0]}),r=e.map(function(n){return n[1]});return{minX:Math.min.apply(null,t),maxX:Math.max.apply(null,t),minY:Math.min.apply(null,r),maxY:Math.max.apply(null,r)}}function Gye(e,t){return!(t.minX>e.maxX||t.maxX<e.minX||t.minY>e.maxY||t.maxY<e.minY)}function Wye(e,t){if(e.length<2||t.length<2)return!1;var r=Tj(e),n=Tj(t);if(!Gye(r,n))return!1;var i=!1;if(ft(t,function(l){if(Cj(e,l[0],l[1]))return i=!0,!1}),i||(ft(e,function(l){if(Cj(t,l[0],l[1]))return i=!0,!1}),i))return!0;var a=Sj(e),o=Sj(t),s=!1;return ft(o,function(l){if(Vye(a,l))return s=!0,!1}),s}function ult(e,t){var r=e.event,n=r.target;return hlt(n,t)}function clt(e,t){var r=e.getCanvasBBox(),n=r.width,i=r.height;return n>0&&i>0&&(n>=t||i>=t)}function hlt(e,t){var r=e.getCanvasBBox();return clt(e,t)?r:null}function flt(e,t){var r=e.event.maskShapes;return r.map(function(n){return hlt(n,t)}).filter(function(n){return!!n})}function Xye(e,t){var r=e.event,n=r.target;return dlt(n,t)}function dlt(e,t){return clt(e,t)?e.attr("path"):null}function jye(e,t){var r=e.event.maskShapes;return r.map(function(n){return dlt(n,t)})}function a0(e){var t=e.event,r,n=t.target;return n&&(r=n.get("element")),r}function d_(e){var t=e.event,r=t.target,n;return r&&(n=r.get("delegateObject")),n}function plt(e){var t=e.event.gEvent;return!(t&&t.fromShape&&t.toShape&&t.fromShape.get("element")===t.toShape.get("element"))}function rS(e){return e&&e.component&&e.component.isList()}function vlt(e){return e&&e.component&&e.component.isSlider()}function nS(e){var t=e.event,r=t.target;return r&&(r==null?void 0:r.get("name"))==="mask"||$3(e)}function $3(e){var t;return((t=e.event.target)===null||t===void 0?void 0:t.get("name"))==="multi-mask"}function g6(e,t){var r=e.event.target;if($3(e))return Yye(e,t);if(r.get("type")==="path"){var n=Xye(e,t);return n?_lt(e.view,n):void 0}var i=ult(e,t);return i?H3(e.view,i):null}function Yye(e,t){var r=e.event.target;if(r.get("type")==="path"){var n=jye(e,t);return n.length>0?n.flatMap(function(a){return _lt(e.view,a)}):null}var i=flt(e,t);return i.length>0?i.flatMap(function(a){return H3(e.view,a)}):null}function glt(e,t,r){if($3(e))return Zye(e,t,r);var n=ult(e,r);return n?mlt(n,e,t):null}function mlt(e,t,r){var n=t.view,i=XB(n,r,{x:e.x,y:e.y}),a=XB(n,r,{x:e.maxX,y:e.maxY}),o={minX:i.x,minY:i.y,maxX:a.x,maxY:a.y};return H3(r,o)}function Zye(e,t,r){var n=flt(e,r);return n.length>0?n.flatMap(function(i){return mlt(i,e,t)}):null}function Vl(e){var t=e.geometries,r=[];return ft(t,function(n){var i=n.elements;r=r.concat(i)}),e.views&&e.views.length&&ft(e.views,function(n){r=r.concat(Vl(n))}),r}function qye(e,t,r){var n=Vl(e);return n.filter(function(i){return Wd(i,t)===r})}function ylt(e,t){var r=e.geometries,n=[];return ft(r,function(i){var a=i.getElementsBy(function(o){return o.hasState(t)});n=n.concat(a)}),n}function Wd(e,t){var r=e.getModel(),n=r.data,i;return ze(n)?i=n[0][t]:i=n[t],i}function Kye(e,t){return!(t.minX>e.maxX||t.maxX<e.minX||t.minY>e.maxY||t.maxY<e.minY)}function H3(e,t){var r=Vl(e),n=[];return ft(r,function(i){var a=i.shape,o=a.getCanvasBBox();Kye(t,o)&&n.push(i)}),n}function Aj(e){var t=[];return ft(e,function(r){var n=r[0];if(n!=="A")for(var i=1;i<r.length;i=i+2)t.push([r[i],r[i+1]]);else{var a=r.length;t.push([r[a-2],r[a-1]])}}),t}function _lt(e,t){var r=Vl(e),n=Aj(t),i=r.filter(function(a){var o=a.shape,s;if(o.get("type")==="path")s=Aj(o.attr("path"));else{var l=o.getCanvasBBox();s=gye(l)}return Wye(n,s)});return i}function xlt(e){return e.getComponents().map(function(t){return t.component})}function m6(e,t){var r=t.x-e.x,n=t.y-e.y;return Math.sqrt(r*r+n*n)}function Qye(e,t){if(e.length<=2)return QS(e,!1);var r=e[0],n=[];ft(e,function(a){n.push(a.x),n.push(a.y)});var i=llt(n,t,null);return i.unshift(["M",r.x,r.y]),i}function Mj(e,t){return e.x<=t.x&&e.maxX>=t.x&&e.y<=t.y&&e.maxY>t.y}function Gp(e){var t=e.parent,r=null;return t&&(r=t.views.filter(function(n){return n!==e})),r}function Jye(e,t){var r=e.getCoordinate();return r.invert(t)}function XB(e,t,r){var n=Jye(e,r);return t.getCoordinate().convert(n)}function blt(e,t,r,n){var i=!1;return ft(e,function(a){if(a[r]===t[r]&&a[n]===t[n])return i=!0,!1}),i}function ob(e,t){var r=e.getScaleByField(t);return!r&&e.views&&ft(e.views,function(n){if(r=ob(n,t),r)return!1}),r}var t_e=function(){function e(t){this.actions=[],this.event=null,this.cacheMap={},this.view=t}return e.prototype.cache=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(t.length===1)return this.cacheMap[t[0]];t.length===2&&(this.cacheMap[t[0]]=t[1])},e.prototype.getAction=function(t){return this.actions.find(function(r){return r.name===t})},e.prototype.addAction=function(t){this.actions.push(t)},e.prototype.removeAction=function(t){var r=this.actions,n=this.actions.indexOf(t);n>=0&&r.splice(n,1)},e.prototype.getCurrentPoint=function(){var t=this.event;if(t)if(t.target instanceof HTMLElement){var r=this.view.getCanvas(),n=r.getPointByClient(t.clientX,t.clientY);return n}else return{x:t.x,y:t.y};return null},e.prototype.getCurrentShape=function(){return xt(this.event,["gEvent","shape"])},e.prototype.isInPlot=function(){var t=this.getCurrentPoint();return t?this.view.isPointInPlot(t):!1},e.prototype.isInShape=function(t){var r=this.getCurrentShape();return r?r.get("name")===t:!1},e.prototype.isInComponent=function(t){var r=xlt(this.view),n=this.getCurrentPoint();return n?!!r.find(function(i){var a=i.getBBox();return t?i.get("name")===t&&Mj(a,n):Mj(a,n)}):!1},e.prototype.destroy=function(){ft(this.actions.slice(),function(t){t.destroy()}),this.view=null,this.event=null,this.actions=null,this.cacheMap=null},e}(),e_e=function(){function e(t,r){this.view=t,this.cfg=r}return e.prototype.init=function(){this.initEvents()},e.prototype.initEvents=function(){},e.prototype.clearEvents=function(){},e.prototype.destroy=function(){this.clearEvents()},e}();function Rj(e,t,r){var n=e.split(":"),i=n[0],a=t.getAction(i)||Rye(i,t);if(!a)throw new Error("There is no action named ".concat(i));var o=n[1];return{action:a,methodName:o,arg:r}}function Ij(e){var t=e.action,r=e.methodName,n=e.arg;if(t[r])t[r](n);else throw new Error("Action(".concat(t.name,") doesn't have a method called ").concat(r))}var Th={START:"start",SHOW_ENABLE:"showEnable",END:"end",ROLLBACK:"rollback",PROCESSING:"processing"},r_e=function(e){Ut(t,e);function t(r,n){var i=e.call(this,r,n)||this;return i.callbackCaches={},i.emitCaches={},i.steps=n,i}return t.prototype.init=function(){this.initContext(),e.prototype.init.call(this)},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.steps=null,this.context&&(this.context.destroy(),this.context=null),this.callbackCaches=null,this.view=null},t.prototype.initEvents=function(){var r=this;ft(this.steps,function(n,i){ft(n,function(a){var o=r.getActionCallback(i,a);o&&r.bindEvent(a.trigger,o)})})},t.prototype.clearEvents=function(){var r=this;ft(this.steps,function(n,i){ft(n,function(a){var o=r.getActionCallback(i,a);o&&r.offEvent(a.trigger,o)})})},t.prototype.initContext=function(){var r=this.view,n=new t_e(r);this.context=n;var i=this.steps;ft(i,function(a){ft(a,function(o){if($r(o.action))o.actionObject={action:Iye(o.action,n),methodName:"execute"};else if(nn(o.action))o.actionObject=Rj(o.action,n,o.arg);else if(ze(o.action)){var s=o.action,l=ze(o.arg)?o.arg:[o.arg];o.actionObject=[],ft(s,function(u,c){o.actionObject.push(Rj(u,n,l[c]))})}})})},t.prototype.isAllowStep=function(r){var n=this.currentStepName,i=this.steps;if(n===r||r===Th.SHOW_ENABLE)return!0;if(r===Th.PROCESSING)return n===Th.START;if(r===Th.START)return n!==Th.PROCESSING;if(r===Th.END)return n===Th.PROCESSING||n===Th.START;if(r===Th.ROLLBACK){if(i[Th.END])return n===Th.END;if(n===Th.START)return!0}return!1},t.prototype.isAllowExecute=function(r,n){if(this.isAllowStep(r)){var i=this.getKey(r,n);return n.once&&this.emitCaches[i]?!1:n.isEnable?n.isEnable(this.context):!0}return!1},t.prototype.enterStep=function(r){this.currentStepName=r,this.emitCaches={}},t.prototype.afterExecute=function(r,n){r!==Th.SHOW_ENABLE&&this.currentStepName!==r&&this.enterStep(r);var i=this.getKey(r,n);this.emitCaches[i]=!0},t.prototype.getKey=function(r,n){return r+n.trigger+n.action},t.prototype.getActionCallback=function(r,n){var i=this,a=this.context,o=this.callbackCaches,s=n.actionObject;if(n.action&&s){var l=this.getKey(r,n);if(!o[l]){var u=function(c){a.event=c,i.isAllowExecute(r,n)?(ze(s)?ft(s,function(f){a.event=c,Ij(f)}):(a.event=c,Ij(s)),i.afterExecute(r,n),n.callback&&(a.event=c,n.callback(a))):a.event=null};n.debounce?o[l]=xtt(u,n.debounce.wait,n.debounce.immediate):n.throttle?o[l]=F4(u,n.throttle.wait,{leading:n.throttle.leading,trailing:n.throttle.trailing}):o[l]=u}return o[l]}return null},t.prototype.bindEvent=function(r,n){var i=r.split(":");i[0]==="window"?window.addEventListener(i[1],n):i[0]==="document"?document.addEventListener(i[1],n):this.view.on(r,n)},t.prototype.offEvent=function(r,n){var i=r.split(":");i[0]==="window"?window.removeEventListener(i[1],n):i[0]==="document"?document.removeEventListener(i[1],n):this.view.off(r,n)},t}(e_e),Elt={};function n_e(e){return Elt[w_(e)]}function Yn(e,t){Elt[w_(e)]=t}function i_e(e,t,r){var n=n_e(e);if(!n)return null;if(zp(n)){var i=Sa($l(n),r);return new r_e(t,i)}else{var a=n;return new a(t,r)}}function a_e(e){return{title:{autoRotate:!0,position:"center",spacing:e.axisTitleSpacing,style:{fill:e.axisTitleTextFillColor,fontSize:e.axisTitleTextFontSize,lineHeight:e.axisTitleTextLineHeight,textBaseline:"middle",fontFamily:e.fontFamily},iconStyle:{fill:e.axisDescriptionIconFillColor}},label:{autoRotate:!1,autoEllipsis:!1,autoHide:{type:"equidistance",cfg:{minGap:6}},offset:e.axisLabelOffset,style:{fill:e.axisLabelFillColor,fontSize:e.axisLabelFontSize,lineHeight:e.axisLabelLineHeight,fontFamily:e.fontFamily}},line:{style:{lineWidth:e.axisLineBorder,stroke:e.axisLineBorderColor}},grid:{line:{type:"line",style:{stroke:e.axisGridBorderColor,lineWidth:e.axisGridBorder,lineDash:e.axisGridLineDash}},alignTick:!0,animate:!0},tickLine:{style:{lineWidth:e.axisTickLineBorder,stroke:e.axisTickLineBorderColor},alignTick:!0,length:e.axisTickLineLength},subTickLine:null,animate:!0}}function o_e(e){return{title:null,marker:{symbol:"circle",spacing:e.legendMarkerSpacing,style:{r:e.legendCircleMarkerSize,fill:e.legendMarkerColor}},itemName:{spacing:5,style:{fill:e.legendItemNameFillColor,fontFamily:e.fontFamily,fontSize:e.legendItemNameFontSize,lineHeight:e.legendItemNameLineHeight,fontWeight:e.legendItemNameFontWeight,textAlign:"start",textBaseline:"middle"}},itemStates:{active:{nameStyle:{opacity:.8}},unchecked:{nameStyle:{fill:"#D8D8D8"},markerStyle:{fill:"#D8D8D8",stroke:"#D8D8D8"}},inactive:{nameStyle:{fill:"#D8D8D8"},markerStyle:{opacity:.2}}},flipPage:!0,pageNavigator:{marker:{style:{size:e.legendPageNavigatorMarkerSize,inactiveFill:e.legendPageNavigatorMarkerInactiveFillColor,inactiveOpacity:e.legendPageNavigatorMarkerInactiveFillOpacity,fill:e.legendPageNavigatorMarkerFillColor,opacity:e.legendPageNavigatorMarkerFillOpacity}},text:{style:{fill:e.legendPageNavigatorTextFillColor,fontSize:e.legendPageNavigatorTextFontSize}}},animate:!1,maxItemWidth:200,itemSpacing:e.legendItemSpacing,itemMarginBottom:e.legendItemMarginBottom,padding:e.legendPadding}}function wlt(e){var t,r={point:{default:{fill:e.pointFillColor,r:e.pointSize,stroke:e.pointBorderColor,lineWidth:e.pointBorder,fillOpacity:e.pointFillOpacity},active:{stroke:e.pointActiveBorderColor,lineWidth:e.pointActiveBorder},selected:{stroke:e.pointSelectedBorderColor,lineWidth:e.pointSelectedBorder},inactive:{fillOpacity:e.pointInactiveFillOpacity,strokeOpacity:e.pointInactiveBorderOpacity}},hollowPoint:{default:{fill:e.hollowPointFillColor,lineWidth:e.hollowPointBorder,stroke:e.hollowPointBorderColor,strokeOpacity:e.hollowPointBorderOpacity,r:e.hollowPointSize},active:{stroke:e.hollowPointActiveBorderColor,strokeOpacity:e.hollowPointActiveBorderOpacity},selected:{lineWidth:e.hollowPointSelectedBorder,stroke:e.hollowPointSelectedBorderColor,strokeOpacity:e.hollowPointSelectedBorderOpacity},inactive:{strokeOpacity:e.hollowPointInactiveBorderOpacity}},area:{default:{fill:e.areaFillColor,fillOpacity:e.areaFillOpacity,stroke:null},active:{fillOpacity:e.areaActiveFillOpacity},selected:{fillOpacity:e.areaSelectedFillOpacity},inactive:{fillOpacity:e.areaInactiveFillOpacity}},hollowArea:{default:{fill:null,stroke:e.hollowAreaBorderColor,lineWidth:e.hollowAreaBorder,strokeOpacity:e.hollowAreaBorderOpacity},active:{fill:null,lineWidth:e.hollowAreaActiveBorder},selected:{fill:null,lineWidth:e.hollowAreaSelectedBorder},inactive:{strokeOpacity:e.hollowAreaInactiveBorderOpacity}},interval:{default:{fill:e.intervalFillColor,fillOpacity:e.intervalFillOpacity},active:{stroke:e.intervalActiveBorderColor,lineWidth:e.intervalActiveBorder},selected:{stroke:e.intervalSelectedBorderColor,lineWidth:e.intervalSelectedBorder},inactive:{fillOpacity:e.intervalInactiveFillOpacity,strokeOpacity:e.intervalInactiveBorderOpacity}},hollowInterval:{default:{fill:e.hollowIntervalFillColor,stroke:e.hollowIntervalBorderColor,lineWidth:e.hollowIntervalBorder,strokeOpacity:e.hollowIntervalBorderOpacity},active:{stroke:e.hollowIntervalActiveBorderColor,lineWidth:e.hollowIntervalActiveBorder,strokeOpacity:e.hollowIntervalActiveBorderOpacity},selected:{stroke:e.hollowIntervalSelectedBorderColor,lineWidth:e.hollowIntervalSelectedBorder,strokeOpacity:e.hollowIntervalSelectedBorderOpacity},inactive:{stroke:e.hollowIntervalInactiveBorderColor,lineWidth:e.hollowIntervalInactiveBorder,strokeOpacity:e.hollowIntervalInactiveBorderOpacity}},line:{default:{stroke:e.lineBorderColor,lineWidth:e.lineBorder,strokeOpacity:e.lineBorderOpacity,fill:null,lineAppendWidth:10,lineCap:"round",lineJoin:"round"},active:{lineWidth:e.lineActiveBorder},selected:{lineWidth:e.lineSelectedBorder},inactive:{strokeOpacity:e.lineInactiveBorderOpacity}}},n=a_e(e),i=o_e(e);return{background:e.backgroundColor,defaultColor:e.brandColor,subColor:e.subColor,semanticRed:e.paletteSemanticRed,semanticGreen:e.paletteSemanticGreen,padding:"auto",fontFamily:e.fontFamily,columnWidthRatio:1/2,maxColumnWidth:null,minColumnWidth:null,roseWidthRatio:.9999999,multiplePieWidthRatio:1/1.3,colors10:e.paletteQualitative10,colors20:e.paletteQualitative20,sequenceColors:e.paletteSequence,shapes:{point:["hollow-circle","hollow-square","hollow-bowtie","hollow-diamond","hollow-hexagon","hollow-triangle","hollow-triangle-down","circle","square","bowtie","diamond","hexagon","triangle","triangle-down","cross","tick","plus","hyphen","line"],line:["line","dash","dot","smooth"],area:["area","smooth","line","smooth-line"],interval:["rect","hollow-rect","line","tick"]},sizes:[1,10],geometries:{interval:{rect:{default:{style:r.interval.default},active:{style:r.interval.active},inactive:{style:r.interval.inactive},selected:{style:function(a){var o=a.geometry.coordinate;if(o.isPolar&&o.isTransposed){var s=tS(a.getModel(),o),l=s.startAngle,u=s.endAngle,c=(l+u)/2,f=7.5,d=f*Math.cos(c),v=f*Math.sin(c);return{matrix:Vs(null,[["t",d,v]])}}return r.interval.selected}}},"hollow-rect":{default:{style:r.hollowInterval.default},active:{style:r.hollowInterval.active},inactive:{style:r.hollowInterval.inactive},selected:{style:r.hollowInterval.selected}},line:{default:{style:r.hollowInterval.default},active:{style:r.hollowInterval.active},inactive:{style:r.hollowInterval.inactive},selected:{style:r.hollowInterval.selected}},tick:{default:{style:r.hollowInterval.default},active:{style:r.hollowInterval.active},inactive:{style:r.hollowInterval.inactive},selected:{style:r.hollowInterval.selected}},funnel:{default:{style:r.interval.default},active:{style:r.interval.active},inactive:{style:r.interval.inactive},selected:{style:r.interval.selected}},pyramid:{default:{style:r.interval.default},active:{style:r.interval.active},inactive:{style:r.interval.inactive},selected:{style:r.interval.selected}}},line:{line:{default:{style:r.line.default},active:{style:r.line.active},inactive:{style:r.line.inactive},selected:{style:r.line.selected}},dot:{default:{style:U(U({},r.line.default),{lineCap:null,lineDash:[1,1]})},active:{style:U(U({},r.line.active),{lineCap:null,lineDash:[1,1]})},inactive:{style:U(U({},r.line.inactive),{lineCap:null,lineDash:[1,1]})},selected:{style:U(U({},r.line.selected),{lineCap:null,lineDash:[1,1]})}},dash:{default:{style:U(U({},r.line.default),{lineCap:null,lineDash:[5.5,1]})},active:{style:U(U({},r.line.active),{lineCap:null,lineDash:[5.5,1]})},inactive:{style:U(U({},r.line.inactive),{lineCap:null,lineDash:[5.5,1]})},selected:{style:U(U({},r.line.selected),{lineCap:null,lineDash:[5.5,1]})}},smooth:{default:{style:r.line.default},active:{style:r.line.active},inactive:{style:r.line.inactive},selected:{style:r.line.selected}},hv:{default:{style:r.line.default},active:{style:r.line.active},inactive:{style:r.line.inactive},selected:{style:r.line.selected}},vh:{default:{style:r.line.default},active:{style:r.line.active},inactive:{style:r.line.inactive},selected:{style:r.line.selected}},hvh:{default:{style:r.line.default},active:{style:r.line.active},inactive:{style:r.line.inactive},selected:{style:r.line.selected}},vhv:{default:{style:r.line.default},active:{style:r.line.active},inactive:{style:r.line.inactive},selected:{style:r.line.selected}}},polygon:{polygon:{default:{style:r.interval.default},active:{style:r.interval.active},inactive:{style:r.interval.inactive},selected:{style:r.interval.selected}}},point:{circle:{default:{style:r.point.default},active:{style:r.point.active},inactive:{style:r.point.inactive},selected:{style:r.point.selected}},square:{default:{style:r.point.default},active:{style:r.point.active},inactive:{style:r.point.inactive},selected:{style:r.point.selected}},bowtie:{default:{style:r.point.default},active:{style:r.point.active},inactive:{style:r.point.inactive},selected:{style:r.point.selected}},diamond:{default:{style:r.point.default},active:{style:r.point.active},inactive:{style:r.point.inactive},selected:{style:r.point.selected}},hexagon:{default:{style:r.point.default},active:{style:r.point.active},inactive:{style:r.point.inactive},selected:{style:r.point.selected}},triangle:{default:{style:r.point.default},active:{style:r.point.active},inactive:{style:r.point.inactive},selected:{style:r.point.selected}},"triangle-down":{default:{style:r.point.default},active:{style:r.point.active},inactive:{style:r.point.inactive},selected:{style:r.point.selected}},"hollow-circle":{default:{style:r.hollowPoint.default},active:{style:r.hollowPoint.active},inactive:{style:r.hollowPoint.inactive},selected:{style:r.hollowPoint.selected}},"hollow-square":{default:{style:r.hollowPoint.default},active:{style:r.hollowPoint.active},inactive:{style:r.hollowPoint.inactive},selected:{style:r.hollowPoint.selected}},"hollow-bowtie":{default:{style:r.hollowPoint.default},active:{style:r.hollowPoint.active},inactive:{style:r.hollowPoint.inactive},selected:{style:r.hollowPoint.selected}},"hollow-diamond":{default:{style:r.hollowPoint.default},active:{style:r.hollowPoint.active},inactive:{style:r.hollowPoint.inactive},selected:{style:r.hollowPoint.selected}},"hollow-hexagon":{default:{style:r.hollowPoint.default},active:{style:r.hollowPoint.active},inactive:{style:r.hollowPoint.inactive},selected:{style:r.hollowPoint.selected}},"hollow-triangle":{default:{style:r.hollowPoint.default},active:{style:r.hollowPoint.active},inactive:{style:r.hollowPoint.inactive},selected:{style:r.hollowPoint.selected}},"hollow-triangle-down":{default:{style:r.hollowPoint.default},active:{style:r.hollowPoint.active},inactive:{style:r.hollowPoint.inactive},selected:{style:r.hollowPoint.selected}},cross:{default:{style:r.hollowPoint.default},active:{style:r.hollowPoint.active},inactive:{style:r.hollowPoint.inactive},selected:{style:r.hollowPoint.selected}},tick:{default:{style:r.hollowPoint.default},active:{style:r.hollowPoint.active},inactive:{style:r.hollowPoint.inactive},selected:{style:r.hollowPoint.selected}},plus:{default:{style:r.hollowPoint.default},active:{style:r.hollowPoint.active},inactive:{style:r.hollowPoint.inactive},selected:{style:r.hollowPoint.selected}},hyphen:{default:{style:r.hollowPoint.default},active:{style:r.hollowPoint.active},inactive:{style:r.hollowPoint.inactive},selected:{style:r.hollowPoint.selected}},line:{default:{style:r.hollowPoint.default},active:{style:r.hollowPoint.active},inactive:{style:r.hollowPoint.inactive},selected:{style:r.hollowPoint.selected}}},area:{area:{default:{style:r.area.default},active:{style:r.area.active},inactive:{style:r.area.inactive},selected:{style:r.area.selected}},smooth:{default:{style:r.area.default},active:{style:r.area.active},inactive:{style:r.area.inactive},selected:{style:r.area.selected}},line:{default:{style:r.hollowArea.default},active:{style:r.hollowArea.active},inactive:{style:r.hollowArea.inactive},selected:{style:r.hollowArea.selected}},"smooth-line":{default:{style:r.hollowArea.default},active:{style:r.hollowArea.active},inactive:{style:r.hollowArea.inactive},selected:{style:r.hollowArea.selected}}},schema:{candle:{default:{style:r.hollowInterval.default},active:{style:r.hollowInterval.active},inactive:{style:r.hollowInterval.inactive},selected:{style:r.hollowInterval.selected}},box:{default:{style:r.hollowInterval.default},active:{style:r.hollowInterval.active},inactive:{style:r.hollowInterval.inactive},selected:{style:r.hollowInterval.selected}}},edge:{line:{default:{style:r.line.default},active:{style:r.line.active},inactive:{style:r.line.inactive},selected:{style:r.line.selected}},vhv:{default:{style:r.line.default},active:{style:r.line.active},inactive:{style:r.line.inactive},selected:{style:r.line.selected}},smooth:{default:{style:r.line.default},active:{style:r.line.active},inactive:{style:r.line.inactive},selected:{style:r.line.selected}},arc:{default:{style:r.line.default},active:{style:r.line.active},inactive:{style:r.line.inactive},selected:{style:r.line.selected}}},violin:{violin:{default:{style:r.line.default},active:{style:r.line.active},inactive:{style:r.line.inactive},selected:{style:r.line.selected}},smooth:{default:{style:r.line.default},active:{style:r.line.active},inactive:{style:r.line.inactive},selected:{style:r.line.selected}},hollow:{default:{style:r.hollowArea.default},active:{style:r.hollowArea.active},inactive:{style:r.hollowArea.inactive},selected:{style:r.hollowArea.selected}},"hollow-smooth":{default:{style:r.hollowArea.default},active:{style:r.hollowArea.active},inactive:{style:r.hollowArea.inactive},selected:{style:r.hollowArea.selected}}}},components:{axis:{common:n,top:{position:"top",grid:null,title:null,verticalLimitLength:1/2},bottom:{position:"bottom",grid:null,title:null,verticalLimitLength:1/2},left:{position:"left",title:null,line:null,tickLine:null,verticalLimitLength:1/3},right:{position:"right",title:null,line:null,tickLine:null,verticalLimitLength:1/3},circle:{title:null,grid:Tr({},n.grid,{line:{type:"line"}})},radius:{title:null,grid:Tr({},n.grid,{line:{type:"circle"}})}},legend:{common:i,right:{layout:"vertical",padding:e.legendVerticalPadding},left:{layout:"vertical",padding:e.legendVerticalPadding},top:{layout:"horizontal",padding:e.legendHorizontalPadding},bottom:{layout:"horizontal",padding:e.legendHorizontalPadding},continuous:{title:null,background:null,track:{},rail:{type:"color",size:e.sliderRailHeight,defaultLength:e.sliderRailWidth,style:{fill:e.sliderRailFillColor,stroke:e.sliderRailBorderColor,lineWidth:e.sliderRailBorder}},label:{align:"rail",spacing:4,formatter:null,style:{fill:e.sliderLabelTextFillColor,fontSize:e.sliderLabelTextFontSize,lineHeight:e.sliderLabelTextLineHeight,textBaseline:"middle",fontFamily:e.fontFamily}},handler:{size:e.sliderHandlerWidth,style:{fill:e.sliderHandlerFillColor,stroke:e.sliderHandlerBorderColor}},slidable:!0,padding:i.padding}},tooltip:{showContent:!0,follow:!0,showCrosshairs:!1,showMarkers:!0,shared:!1,enterable:!1,position:"auto",marker:{symbol:"circle",stroke:"#fff",shadowBlur:10,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"rgba(0,0,0,0.09)",lineWidth:2,r:4},crosshairs:{line:{style:{stroke:e.tooltipCrosshairsBorderColor,lineWidth:e.tooltipCrosshairsBorder}},text:null,textBackground:{padding:2,style:{fill:"rgba(0, 0, 0, 0.25)",lineWidth:0,stroke:null}},follow:!1},domStyles:(t={},t["".concat(ug)]={position:"absolute",visibility:"hidden",zIndex:8,transition:"left 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s, top 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s",backgroundColor:e.tooltipContainerFillColor,opacity:e.tooltipContainerFillOpacity,boxShadow:e.tooltipContainerShadow,borderRadius:"".concat(e.tooltipContainerBorderRadius,"px"),color:e.tooltipTextFillColor,fontSize:"".concat(e.tooltipTextFontSize,"px"),fontFamily:e.fontFamily,lineHeight:"".concat(e.tooltipTextLineHeight,"px"),padding:"0 12px 0 12px"},t["".concat(cg)]={marginBottom:"12px",marginTop:"12px"},t["".concat(JC)]={margin:0,listStyleType:"none",padding:0},t["".concat(F3)]={listStyleType:"none",padding:0,marginBottom:"12px",marginTop:"12px",marginLeft:0,marginRight:0},t["".concat(B3)]={width:"8px",height:"8px",borderRadius:"50%",display:"inline-block",marginRight:"8px"},t["".concat(N3)]={display:"inline-block",float:"right",marginLeft:"30px"},t)},annotation:{arc:{style:{stroke:e.annotationArcBorderColor,lineWidth:e.annotationArcBorder},animate:!0},line:{style:{stroke:e.annotationLineBorderColor,lineDash:e.annotationLineDash,lineWidth:e.annotationLineBorder},text:{position:"start",autoRotate:!0,style:{fill:e.annotationTextFillColor,stroke:e.annotationTextBorderColor,lineWidth:e.annotationTextBorder,fontSize:e.annotationTextFontSize,textAlign:"start",fontFamily:e.fontFamily,textBaseline:"bottom"}},animate:!0},text:{style:{fill:e.annotationTextFillColor,stroke:e.annotationTextBorderColor,lineWidth:e.annotationTextBorder,fontSize:e.annotationTextFontSize,textBaseline:"middle",textAlign:"start",fontFamily:e.fontFamily},animate:!0},region:{top:!1,style:{lineWidth:e.annotationRegionBorder,stroke:e.annotationRegionBorderColor,fill:e.annotationRegionFillColor,fillOpacity:e.annotationRegionFillOpacity},animate:!0},image:{top:!1,animate:!0},dataMarker:{top:!0,point:{style:{r:3,stroke:e.brandColor,lineWidth:2}},line:{style:{stroke:e.annotationLineBorderColor,lineWidth:e.annotationLineBorder},length:e.annotationDataMarkerLineLength},text:{style:{textAlign:"start",fill:e.annotationTextFillColor,stroke:e.annotationTextBorderColor,lineWidth:e.annotationTextBorder,fontSize:e.annotationTextFontSize,fontFamily:e.fontFamily}},direction:"upward",autoAdjust:!0,animate:!0},dataRegion:{style:{region:{fill:e.annotationRegionFillColor,fillOpacity:e.annotationRegionFillOpacity},text:{textAlign:"center",textBaseline:"bottom",fill:e.annotationTextFillColor,stroke:e.annotationTextBorderColor,lineWidth:e.annotationTextBorder,fontSize:e.annotationTextFontSize,fontFamily:e.fontFamily}},animate:!0}},slider:{common:{padding:[8,8,8,8],backgroundStyle:{fill:e.cSliderBackgroundFillColor,opacity:e.cSliderBackgroundFillOpacity},foregroundStyle:{fill:e.cSliderForegroundFillColor,opacity:e.cSliderForegroundFillOpacity},handlerStyle:{width:e.cSliderHandlerWidth,height:e.cSliderHandlerHeight,fill:e.cSliderHandlerFillColor,opacity:e.cSliderHandlerFillOpacity,stroke:e.cSliderHandlerBorderColor,lineWidth:e.cSliderHandlerBorder,radius:e.cSliderHandlerBorderRadius,highLightFill:e.cSliderHandlerHighlightFillColor},textStyle:{fill:e.cSliderTextFillColor,opacity:e.cSliderTextFillOpacity,fontSize:e.cSliderTextFontSize,lineHeight:e.cSliderTextLineHeight,fontWeight:e.cSliderTextFontWeight,stroke:e.cSliderTextBorderColor,lineWidth:e.cSliderTextBorder}}},scrollbar:{common:{padding:[8,8,8,8]},default:{style:{trackColor:e.scrollbarTrackFillColor,thumbColor:e.scrollbarThumbFillColor}},hover:{style:{thumbColor:e.scrollbarThumbHighlightFillColor}}}},labels:{offset:12,style:{fill:e.labelFillColor,fontSize:e.labelFontSize,fontFamily:e.fontFamily,stroke:e.labelBorderColor,lineWidth:e.labelBorder},fillColorDark:e.labelFillColorDark,fillColorLight:e.labelFillColorLight,autoRotate:!0},innerLabels:{style:{fill:e.innerLabelFillColor,fontSize:e.innerLabelFontSize,fontFamily:e.fontFamily,stroke:e.innerLabelBorderColor,lineWidth:e.innerLabelBorder},autoRotate:!0},overflowLabels:{style:{fill:e.overflowLabelFillColor,fontSize:e.overflowLabelFontSize,fontFamily:e.fontFamily,stroke:e.overflowLabelBorderColor,lineWidth:e.overflowLabelBorder}},pieLabels:{labelHeight:14,offset:10,labelLine:{style:{lineWidth:e.labelLineBorder}},autoRotate:!0}}}var ma={100:"#000",95:"#0D0D0D",85:"#262626",65:"#595959",45:"#8C8C8C",25:"#BFBFBF",15:"#D9D9D9",6:"#F0F0F0"},D1={100:"#FFFFFF",95:"#F2F2F2",85:"#D9D9D9",65:"#A6A6A6",45:"#737373",25:"#404040",15:"#262626",6:"#0F0F0F"},s_e=["#5B8FF9","#5AD8A6","#5D7092","#F6BD16","#6F5EF9","#6DC8EC","#945FB9","#FF9845","#1E9493","#FF99C3"],l_e=["#5B8FF9","#CDDDFD","#5AD8A6","#CDF3E4","#5D7092","#CED4DE","#F6BD16","#FCEBB9","#6F5EF9","#D3CEFD","#6DC8EC","#D3EEF9","#945FB9","#DECFEA","#FF9845","#FFE0C7","#1E9493","#BBDEDE","#FF99C3","#FFE0ED"],u_e=["#B8E1FF","#9AC5FF","#7DAAFF","#5B8FF9","#3D76DD","#085EC0","#0047A5","#00318A","#001D70"],Clt=function(e){e===void 0&&(e={});var t=e.paletteQualitative10,r=t===void 0?s_e:t,n=e.paletteQualitative20,i=n===void 0?l_e:n,a=e.brandColor,o=a===void 0?r[0]:a,s={backgroundColor:"transparent",brandColor:o,subColor:"rgba(0,0,0,0.05)",paletteQualitative10:r,paletteQualitative20:i,paletteSemanticRed:"#F4664A",paletteSemanticGreen:"#30BF78",paletteSemanticYellow:"#FAAD14",paletteSequence:u_e,fontFamily:`"Segoe UI", Roboto, "Helvetica Neue", Arial,
    "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol",
    "Noto Color Emoji"`,axisLineBorderColor:ma[25],axisLineBorder:1,axisLineDash:null,axisTitleTextFillColor:ma[65],axisTitleTextFontSize:12,axisTitleTextLineHeight:12,axisTitleTextFontWeight:"normal",axisTitleSpacing:12,axisDescriptionIconFillColor:D1[85],axisTickLineBorderColor:ma[25],axisTickLineLength:4,axisTickLineBorder:1,axisSubTickLineBorderColor:ma[15],axisSubTickLineLength:2,axisSubTickLineBorder:1,axisLabelFillColor:ma[45],axisLabelFontSize:12,axisLabelLineHeight:12,axisLabelFontWeight:"normal",axisLabelOffset:8,axisGridBorderColor:ma[15],axisGridBorder:1,axisGridLineDash:null,legendTitleTextFillColor:ma[45],legendTitleTextFontSize:12,legendTitleTextLineHeight:21,legendTitleTextFontWeight:"normal",legendMarkerColor:o,legendMarkerSpacing:8,legendMarkerSize:4,legendCircleMarkerSize:4,legendSquareMarkerSize:4,legendLineMarkerSize:5,legendItemNameFillColor:ma[65],legendItemNameFontSize:12,legendItemNameLineHeight:12,legendItemNameFontWeight:"normal",legendItemSpacing:24,legendItemMarginBottom:12,legendPadding:[8,8,8,8],legendHorizontalPadding:[8,0,8,0],legendVerticalPadding:[0,8,0,8],legendPageNavigatorMarkerSize:12,legendPageNavigatorMarkerInactiveFillColor:ma[100],legendPageNavigatorMarkerInactiveFillOpacity:.45,legendPageNavigatorMarkerFillColor:ma[100],legendPageNavigatorMarkerFillOpacity:1,legendPageNavigatorTextFillColor:ma[45],legendPageNavigatorTextFontSize:12,sliderRailFillColor:ma[15],sliderRailBorder:0,sliderRailBorderColor:null,sliderRailWidth:100,sliderRailHeight:12,sliderLabelTextFillColor:ma[45],sliderLabelTextFontSize:12,sliderLabelTextLineHeight:12,sliderLabelTextFontWeight:"normal",sliderHandlerFillColor:ma[6],sliderHandlerWidth:10,sliderHandlerHeight:14,sliderHandlerBorder:1,sliderHandlerBorderColor:ma[25],annotationArcBorderColor:ma[15],annotationArcBorder:1,annotationLineBorderColor:ma[25],annotationLineBorder:1,annotationLineDash:null,annotationTextFillColor:ma[65],annotationTextFontSize:12,annotationTextLineHeight:12,annotationTextFontWeight:"normal",annotationTextBorderColor:null,annotationTextBorder:0,annotationRegionFillColor:ma[100],annotationRegionFillOpacity:.06,annotationRegionBorder:0,annotationRegionBorderColor:null,annotationDataMarkerLineLength:16,tooltipCrosshairsBorderColor:ma[25],tooltipCrosshairsBorder:1,tooltipCrosshairsLineDash:null,tooltipContainerFillColor:"rgb(255, 255, 255)",tooltipContainerFillOpacity:.95,tooltipContainerShadow:"0px 0px 10px #aeaeae",tooltipContainerBorderRadius:3,tooltipTextFillColor:ma[65],tooltipTextFontSize:12,tooltipTextLineHeight:12,tooltipTextFontWeight:"bold",labelFillColor:ma[65],labelFillColorDark:"#2c3542",labelFillColorLight:"#ffffff",labelFontSize:12,labelLineHeight:12,labelFontWeight:"normal",labelBorderColor:null,labelBorder:0,innerLabelFillColor:D1[100],innerLabelFontSize:12,innerLabelLineHeight:12,innerLabelFontWeight:"normal",innerLabelBorderColor:null,innerLabelBorder:0,overflowLabelFillColor:ma[65],overflowLabelFontSize:12,overflowLabelLineHeight:12,overflowLabelFontWeight:"normal",overflowLabelBorderColor:D1[100],overflowLabelBorder:1,labelLineBorder:1,labelLineBorderColor:ma[25],cSliderRailHieght:16,cSliderBackgroundFillColor:"#416180",cSliderBackgroundFillOpacity:.05,cSliderForegroundFillColor:"#5B8FF9",cSliderForegroundFillOpacity:.15,cSliderHandlerHeight:24,cSliderHandlerWidth:10,cSliderHandlerFillColor:"#F7F7F7",cSliderHandlerFillOpacity:1,cSliderHandlerHighlightFillColor:"#FFF",cSliderHandlerBorderColor:"#BFBFBF",cSliderHandlerBorder:1,cSliderHandlerBorderRadius:2,cSliderTextFillColor:"#000",cSliderTextFillOpacity:.45,cSliderTextFontSize:12,cSliderTextLineHeight:12,cSliderTextFontWeight:"normal",cSliderTextBorderColor:null,cSliderTextBorder:0,scrollbarTrackFillColor:"rgba(0,0,0,0)",scrollbarThumbFillColor:"rgba(0,0,0,0.15)",scrollbarThumbHighlightFillColor:"rgba(0,0,0,0.2)",pointFillColor:o,pointFillOpacity:.95,pointSize:4,pointBorder:1,pointBorderColor:D1[100],pointBorderOpacity:1,pointActiveBorderColor:ma[100],pointSelectedBorder:2,pointSelectedBorderColor:ma[100],pointInactiveFillOpacity:.3,pointInactiveBorderOpacity:.3,hollowPointSize:4,hollowPointBorder:1,hollowPointBorderColor:o,hollowPointBorderOpacity:.95,hollowPointFillColor:D1[100],hollowPointActiveBorder:1,hollowPointActiveBorderColor:ma[100],hollowPointActiveBorderOpacity:1,hollowPointSelectedBorder:2,hollowPointSelectedBorderColor:ma[100],hollowPointSelectedBorderOpacity:1,hollowPointInactiveBorderOpacity:.3,lineBorder:2,lineBorderColor:o,lineBorderOpacity:1,lineActiveBorder:3,lineSelectedBorder:3,lineInactiveBorderOpacity:.3,areaFillColor:o,areaFillOpacity:.25,areaActiveFillColor:o,areaActiveFillOpacity:.5,areaSelectedFillColor:o,areaSelectedFillOpacity:.5,areaInactiveFillOpacity:.3,hollowAreaBorderColor:o,hollowAreaBorder:2,hollowAreaBorderOpacity:1,hollowAreaActiveBorder:3,hollowAreaActiveBorderColor:ma[100],hollowAreaSelectedBorder:3,hollowAreaSelectedBorderColor:ma[100],hollowAreaInactiveBorderOpacity:.3,intervalFillColor:o,intervalFillOpacity:.95,intervalActiveBorder:1,intervalActiveBorderColor:ma[100],intervalActiveBorderOpacity:1,intervalSelectedBorder:2,intervalSelectedBorderColor:ma[100],intervalSelectedBorderOpacity:1,intervalInactiveBorderOpacity:.3,intervalInactiveFillOpacity:.3,hollowIntervalBorder:2,hollowIntervalBorderColor:o,hollowIntervalBorderOpacity:1,hollowIntervalFillColor:D1[100],hollowIntervalActiveBorder:2,hollowIntervalActiveBorderColor:ma[100],hollowIntervalSelectedBorder:3,hollowIntervalSelectedBorderColor:ma[100],hollowIntervalSelectedBorderOpacity:1,hollowIntervalInactiveBorderOpacity:.3};return U(U({},s),e)};Clt();function kR(e){var t=e.styleSheet,r=t===void 0?{}:t,n=hi(e,["styleSheet"]),i=Clt(r);return Tr({},wlt(i),n)}var c_e=kR({}),jB={default:c_e};function Kw(e){return xt(jB,w_(e),jB.default)}function h_e(e,t){jB[w_(e)]=kR(t)}function Lj(e,t,r){var n=r.translate(e),i=r.translate(t);return Ul(n,i)}function f_e(e,t){var r=t.coordinate,n=t.getXScale(),i=n.range,a=i[i.length-1],o=i[0],s=r.invert(e),l=s.x;return r.isPolar&&l>(1+a)/2&&(l=o),n.translate(n.invert(l))}function Oj(e,t,r){var n=r.coordinate,i=r.getYScale(),a=i.field,o=n.invert(t),s=i.invert(o.y),l=Bd(e,function(u){var c=u[Oa];return c[a][0]<=s&&c[a][1]>=s});return l||e[e.length-1]}var d_e=wb(function(e){if(e.isCategory)return 1;for(var t=e.values,r=t.length,n=e.translate(t[0]),i=n,a=0;a<r;a++){var o=t[a],s=e.translate(o);s<n&&(n=s),s>i&&(i=s)}return(i-n)/(r-1)});function p_e(e,t,r){var n=t.getAttribute("position"),i=n.getFields(),a=t.scales,o=$r(r)||!r?i[0]:r,s=a[o],l=s?s.getText(e[o]):e[o]||o;return $r(r)?r(l,e):l}function v_e(e){var t=wI(e.attributes);return Wl(t,function(r){return yy(nx,r.type)})}function Slt(e){var t,r,n=v_e(e),i;try{for(var a=mi(n),o=a.next();!o.done;o=a.next()){var s=o.value,l=s.getScale(s.type);if(l&&l.isLinear){var u=xt(e.scaleDefs,l.field),c=nlt(l,u,s.type,e.type);if(c!=="cat"){i=l;break}}}}catch(v){t={error:v}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}var f=e.getXScale(),d=e.getYScale();return i||d||f}function g_e(e,t){var r=t.field,n=e[r];if(ze(n)){var i=n.map(function(a){return t.getText(a)});return i.join("-")}return t.getText(n)}function m_e(e,t){var r,n=t.getGroupScales();if(n.length&&(r=n[0]),r){var i=r.field;return r.getText(e[i])}var a=Slt(t);return eS(a)}function Tlt(e,t,r){if(t.length===0)return null;var n=r.type,i=r.getXScale(),a=r.getYScale(),o=i.field,s=a.field,l=null;if(n==="heatmap"||n==="point"){for(var u=r.coordinate,c=u.invert(e),f=i.invert(c.x),d=a.invert(c.y),v=1/0,g=0;g<t.length;g++){var x=t[g],w=x[Oa],S=Math.pow(w[o]-f,2)+Math.pow(w[s]-d,2);S<v&&(v=S,l=x)}return l}var A=t[0],M=t[t.length-1],R=f_e(e,r),O=A[Oa][o],N=A[Oa][s],k=M[Oa][o],V=a.isLinear&&ze(N);if(ze(O)){for(var g=0;g<t.length;g++){var Q=t[g],w=Q[Oa];if(i.translate(w[o][0])<=R&&i.translate(w[o][1])>=R)if(V)ze(l)||(l=[]),l.push(Q);else{l=Q;break}}ze(l)&&(l=Oj(l,e,r))}else{var Y=void 0;if(!i.isLinear&&i.type!=="timeCat"){for(var g=0;g<t.length;g++){var Q=t[g],w=Q[Oa];if(Lj(w[o],R,i))if(V)ze(l)||(l=[]),l.push(Q);else{l=Q;break}else i.translate(w[o])<=R&&(M=Q,Y=t[g+1])}ze(l)&&(l=Oj(l,e,r))}else{if((R>i.translate(k)||R<i.translate(O))&&(R>i.max||R<i.min))return null;for(var X=0,tt=t.length-1,it=void 0;X<=tt;){it=Math.floor((X+tt)/2);var Et=t[it][Oa][o];if(Lj(Et,R,i))return t[it];i.translate(Et)<=i.translate(R)?(X=it+1,M=t[it],Y=t[it+1]):(tt===0&&(M=t[0]),tt=it-1)}}M&&Y&&Math.abs(i.translate(M[Oa][o])-R)>Math.abs(i.translate(Y[Oa][o])-R)&&(M=Y)}var Tt=d_e(r.getXScale());return!l&&Math.abs(i.translate(M[Oa][o])-R)<=Tt/2&&(l=M),l}function y6(e,t,r,n){var i,a;r===void 0&&(r=""),n===void 0&&(n=!1);var o=e[Oa],s=p_e(o,t,r),l=t.tooltipOption,u=t.theme.defaultColor,c=[],f,d;function v(Q,Y){if(n||!ke(Y)&&Y!==""){var X={title:s,data:o,mappingData:e,name:Q,value:Y,color:e.color||u,marker:!0};c.push(X)}}if(qi(l)){var g=l.fields,x=l.callback;if(x){var w=g.map(function(Q){return e[Oa][Q]}),S=x.apply(void 0,an([],Lr(w),!1)),A=U({data:e[Oa],mappingData:e,title:s,color:e.color||u,marker:!0},S);c.push(A)}else{var M=t.scales;try{for(var R=mi(g),O=R.next();!O.done;O=R.next()){var N=O.value;if(!ke(o[N])){var k=M[N];f=eS(k),d=k.getText(o[N]),v(f,d)}}}catch(Q){i={error:Q}}finally{try{O&&!O.done&&(a=R.return)&&a.call(R)}finally{if(i)throw i.error}}}}else{var V=Slt(t);d=g_e(o,V),f=m_e(o,t),v(f,d)}return c}function Pj(e,t,r,n){var i,a,o=n.showNil,s=[],l=e.dataArray;if(!Kc(l)){e.sort(l);try{for(var u=mi(l),c=u.next();!c.done;c=u.next()){var f=c.value,d=Tlt(t,f,e);if(d){var v=e.getElementId(d),g=e.elementsMap[v];if(e.type==="heatmap"||g.visible){var x=y6(d,e,r,o);x.length&&s.push(x)}}}}catch(w){i={error:w}}finally{try{c&&!c.done&&(a=u.return)&&a.call(u)}finally{if(i)throw i.error}}}return s}function Dj(e,t,r,n){var i=n.showNil,a=[],o=e.container,s=o.getShape(t.x,t.y);if(s&&s.get("visible")&&s.get("origin")){var l=s.get("origin").mappingData,u=y6(l,e,r,i);u.length&&a.push(u)}return a}function YB(e,t,r){var n,i,a=[],o=e.geometries,s=r.shared,l=r.title,u=r.reversed;try{for(var c=mi(o),f=c.next();!f.done;f=c.next()){var d=f.value;if(d.visible&&d.tooltipOption!==!1){var v=d.type,g=void 0;["point","edge","polygon"].includes(v)?g=Dj(d,t,l,r):["area","line","path","heatmap"].includes(v)||s!==!1?g=Pj(d,t,l,r):g=Dj(d,t,l,r),g.length&&(u&&g.reverse(),a.push(g))}}}catch(x){n={error:x}}finally{try{f&&!f.done&&(i=c.return)&&i.call(c)}finally{if(n)throw n.error}}return a}function y_e(e,t,r){var n,i,a=YB(e,t,r);try{for(var o=mi(e.views),s=o.next();!s.done;s=o.next()){var l=s.value;a=a.concat(YB(l,t,r))}}catch(u){n={error:u}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return a}function __e(e){return!Gn(e)&&!ze(e)}function _6(e){e===void 0&&(e=0);var t=ze(e)?e:[e];switch(t.length){case 0:t=[0,0,0,0];break;case 1:t=new Array(4).fill(t[0]);break;case 2:t=an(an([],Lr(t),!1),Lr(t),!1);break;case 3:t=an(an([],Lr(t),!1),[t[1]],!1);break;default:t=t.slice(0,4);break}return t}var x6={};function P_(e,t){x6[e]=t}function x_e(){return Object.keys(x6)}function b_e(e){return x6[e]}var E_e=function(){function e(t){this.option=this.wrapperOption(t)}return e.prototype.update=function(t){return this.option=this.wrapperOption(t),this},e.prototype.hasAction=function(t){var r=this.option.actions;return xI(r,function(n){return n[0]===t})},e.prototype.create=function(t,r){var n=this.option,i=n.type,a=n.cfg,o=i==="theta",s=U({start:t,end:r},a),l=Fme(o?"polar":i);return this.coordinate=new l(s),this.coordinate.type=i,o&&(this.hasAction("transpose")||this.transpose()),this.execActions(),this.coordinate},e.prototype.adjust=function(t,r){return this.coordinate.update({start:t,end:r}),this.coordinate.resetMatrix(),this.execActions(["scale","rotate","translate"]),this.coordinate},e.prototype.rotate=function(t){return this.option.actions.push(["rotate",t]),this},e.prototype.reflect=function(t){return this.option.actions.push(["reflect",t]),this},e.prototype.scale=function(t,r){return this.option.actions.push(["scale",t,r]),this},e.prototype.transpose=function(){return this.option.actions.push(["transpose"]),this},e.prototype.getOption=function(){return this.option},e.prototype.getCoordinate=function(){return this.coordinate},e.prototype.wrapperOption=function(t){return U({type:"rect",actions:[],cfg:{}},t)},e.prototype.execActions=function(t){var r=this,n=this.option.actions;ft(n,function(i){var a,o=Lr(i),s=o[0],l=o.slice(1),u=ke(t)?!0:t.includes(s);u&&(a=r.coordinate)[s].apply(a,an([],Lr(l),!1))})},e}(),So=function(){function e(t,r,n){this.view=t,this.gEvent=r,this.data=n,this.type=r.type}return e.fromData=function(t,r,n){return new e(t,new IS(r,{}),n)},Object.defineProperty(e.prototype,"target",{get:function(){return this.gEvent.target},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"event",{get:function(){return this.gEvent.originalEvent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this.gEvent.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.gEvent.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clientX",{get:function(){return this.gEvent.clientX},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clientY",{get:function(){return this.gEvent.clientY},enumerable:!1,configurable:!0}),e.prototype.toString=function(){return"[Event (type=".concat(this.type,")]")},e.prototype.clone=function(){return new e(this.view,this.gEvent,this.data)},e}();function w_e(e){var t=e.getController("axis"),r=e.getController("legend"),n=e.getController("annotation"),i=e.getController("slider"),a=e.getController("scrollbar");[t,i,a,r,n].forEach(function(o){o&&o.layout()})}var C_e=function(){function e(){this.scales=new Map,this.syncScales=new Map}return e.prototype.createScale=function(t,r,n,i){var a=n,o=this.getScaleMeta(i);if(r.length===0&&o){var s=o.scale,l={type:s.type};s.isCategory&&(l.values=s.values),a=Tr(l,o.scaleDef,n)}var u=Eye(t,r,a);return this.cacheScale(u,n,i),u},e.prototype.sync=function(t,r){var n=this;this.syncScales.forEach(function(i,a){var o=Number.MAX_SAFE_INTEGER,s=Number.MIN_SAFE_INTEGER,l=[];ft(i,function(u){var c=n.getScale(u);s=Gn(c.max)?Math.max(s,c.max):s,o=Gn(c.min)?Math.min(o,c.min):o,ft(c.values,function(f){l.includes(f)||l.push(f)})}),ft(i,function(u){var c=n.getScale(u);if(c.isContinuous)c.change({min:o,max:s,values:l});else if(c.isCategory){var f=c.range,d=n.getScaleMeta(u);l&&!xt(d,["scaleDef","range"])&&(f=ilt(Tr({},c,{values:l}),t,r)),c.change({values:l,range:f})}})})},e.prototype.cacheScale=function(t,r,n){var i=this.getScaleMeta(n);i&&i.scale.type===t.type?(wye(i.scale,t),i.scaleDef=r):(i={key:n,scale:t,scaleDef:r},this.scales.set(n,i));var a=this.getSyncKey(i);if(i.syncKey=a,this.removeFromSyncScales(n),a){var o=this.syncScales.get(a);o||(o=[],this.syncScales.set(a,o)),o.push(n)}},e.prototype.getScale=function(t){var r=this.getScaleMeta(t);if(!r){var n=Gs(t.split("-")),i=this.syncScales.get(n);i&&i.length&&(r=this.getScaleMeta(i[0]))}return r&&r.scale},e.prototype.deleteScale=function(t){var r=this.getScaleMeta(t);if(r){var n=r.syncKey,i=this.syncScales.get(n);if(i&&i.length){var a=i.indexOf(t);a!==-1&&i.splice(a,1)}}this.scales.delete(t)},e.prototype.clear=function(){this.scales.clear(),this.syncScales.clear()},e.prototype.removeFromSyncScales=function(t){var r=this;this.syncScales.forEach(function(n,i){var a=n.indexOf(t);if(a!==-1)return n.splice(a,1),n.length===0&&r.syncScales.delete(i),!1})},e.prototype.getSyncKey=function(t){var r=t.scale,n=t.scaleDef,i=r.field,a=xt(n,["sync"]);return a===!0?i:a===!1?void 0:a},e.prototype.getScaleMeta=function(t){return this.scales.get(t)},e}(),ZA=function(){function e(t,r,n,i){t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=0),i===void 0&&(i=0),this.top=t,this.right=r,this.bottom=n,this.left=i}return e.instance=function(t,r,n,i){return t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=0),i===void 0&&(i=0),new e(t,r,n,i)},e.prototype.max=function(t){var r=Lr(t,4),n=r[0],i=r[1],a=r[2],o=r[3];return this.top=Math.max(this.top,n),this.right=Math.max(this.right,i),this.bottom=Math.max(this.bottom,a),this.left=Math.max(this.left,o),this},e.prototype.shrink=function(t){var r=Lr(t,4),n=r[0],i=r[1],a=r[2],o=r[3];return this.top+=n,this.right+=i,this.bottom+=a,this.left+=o,this},e.prototype.inc=function(t,r){var n=t.width,i=t.height;switch(r){case xr.TOP:case xr.TOP_LEFT:case xr.TOP_RIGHT:this.top+=i;break;case xr.RIGHT:case xr.RIGHT_TOP:case xr.RIGHT_BOTTOM:this.right+=n;break;case xr.BOTTOM:case xr.BOTTOM_LEFT:case xr.BOTTOM_RIGHT:this.bottom+=i;break;case xr.LEFT:case xr.LEFT_TOP:case xr.LEFT_BOTTOM:this.left+=n;break}return this},e.prototype.getPadding=function(){return[this.top,this.right,this.bottom,this.left]},e.prototype.clone=function(){return new(e.bind.apply(e,an([void 0],Lr(this.getPadding()),!1)))},e}();function S_e(e){var t=e.padding;if(!__e(t))return new(ZA.bind.apply(ZA,an([void 0],Lr(_6(t)),!1)));var r=e.viewBBox,n=new ZA,i=[],a=[],o=[];return ft(e.getComponents(),function(s){var l=s.type;l===gl.AXIS?i.push(s):[gl.LEGEND,gl.SLIDER,gl.SCROLLBAR].includes(l)?a.push(s):l!==gl.GRID&&l!==gl.TOOLTIP&&o.push(s)}),ft(i,function(s){var l=s.component,u=l.getLayoutBBox(),c=new lc(u.x,u.y,u.width,u.height),f=c.exceed(r);n.max(f)}),ft(a,function(s){var l=s.component,u=s.direction,c=l.getLayoutBBox(),f=l.get("padding"),d=new lc(c.x,c.y,c.width,c.height).expand(f);n.inc(d,u)}),ft(o,function(s){var l=s.component,u=s.direction,c=l.getLayoutBBox(),f=new lc(c.x,c.y,c.width,c.height);n.inc(f,u)}),n}function T_e(e,t,r){var n=r.instance();t.forEach(function(i){i.autoPadding=n.max(i.autoPadding.getPadding())})}var Alt=function(e){Ut(t,e);function t(r){var n=e.call(this,{visible:r.visible})||this;n.views=[],n.geometries=[],n.controllers=[],n.interactions={},n.limitInPlot=!1,n.options={data:[],animate:!0},n.usedControllers=x_e(),n.scalePool=new C_e,n.layoutFunc=w_e,n.isPreMouseInPlot=!1,n.isDataChanged=!1,n.isCoordinateChanged=!1,n.createdScaleKeys=new Map,n.onCanvasEvent=function(M){var R=M.name;if(!R.includes(":")){var O=n.createViewEvent(M);n.doPlotEvent(O),n.emit(R,O)}},n.onDelegateEvents=function(M){var R=M.name;if(R.includes(":")){var O=n.createViewEvent(M);n.emit(R,O)}};var i=r.id,a=i===void 0?Gh("view"):i,o=r.parent,s=r.canvas,l=r.backgroundGroup,u=r.middleGroup,c=r.foregroundGroup,f=r.region,d=f===void 0?{start:{x:0,y:0},end:{x:1,y:1}}:f,v=r.padding,g=r.appendPadding,x=r.theme,w=r.options,S=r.limitInPlot,A=r.syncViewPadding;return n.parent=o,n.canvas=s,n.backgroundGroup=l,n.middleGroup=u,n.foregroundGroup=c,n.region=d,n.padding=v,n.appendPadding=g,n.options=U(U({},n.options),w),n.limitInPlot=S,n.id=a,n.syncViewPadding=A,n.themeObject=qi(x)?Tr({},Kw("default"),kR(x)):Kw(x),n.init(),n}return t.prototype.setLayout=function(r){this.layoutFunc=r},t.prototype.init=function(){this.calculateViewBBox(),this.initEvents(),this.initComponentController(),this.initOptions()},t.prototype.render=function(r,n){r===void 0&&(r=!1),this.emit(di.BEFORE_RENDER,So.fromData(this,di.BEFORE_RENDER,n)),this.paint(r),this.emit(di.AFTER_RENDER,So.fromData(this,di.AFTER_RENDER,n)),this.visible===!1&&this.changeVisible(!1)},t.prototype.clear=function(){var r=this;this.emit(di.BEFORE_CLEAR),this.filteredData=[],this.coordinateInstance=void 0,this.isDataChanged=!1,this.isCoordinateChanged=!1;for(var n=this.geometries,i=0;i<n.length;i++)n[i].clear(),n[i].container.remove(!0),n[i].labelsContainer.remove(!0);this.geometries=[];for(var a=this.controllers,i=0;i<a.length;i++)a[i].name==="annotation"?a[i].clear(!0):a[i].clear();this.createdScaleKeys.forEach(function(s,l){r.getRootView().scalePool.deleteScale(l)}),this.createdScaleKeys.clear();for(var o=this.views,i=0;i<o.length;i++)o[i].clear();this.emit(di.AFTER_CLEAR)},t.prototype.destroy=function(){this.emit(di.BEFORE_DESTROY);var r=this.interactions;ft(r,function(s){s&&s.destroy()}),this.clear();for(var n=this.controllers,i=0,a=n.length;i<a;i++){var o=n[i];o.destroy()}this.backgroundGroup.remove(!0),this.middleGroup.remove(!0),this.foregroundGroup.remove(!0),e.prototype.destroy.call(this)},t.prototype.changeVisible=function(r){e.prototype.changeVisible.call(this,r);for(var n=this.geometries,i=0,a=n.length;i<a;i++){var o=n[i];o.changeVisible(r)}for(var s=this.controllers,i=0,a=s.length;i<a;i++){var l=s[i];l.changeVisible(r)}return this.foregroundGroup.set("visible",r),this.middleGroup.set("visible",r),this.backgroundGroup.set("visible",r),this.getCanvas().draw(),this},t.prototype.data=function(r){return Hs(this.options,"data",r),this.isDataChanged=!0,this},t.prototype.source=function(r){return console.warn("This method will be removed at G2 V4.1. Please use chart.data() instead."),this.data(r)},t.prototype.filter=function(r,n){return $r(n)?(Hs(this.options,["filters",r],n),this):(!n&&xt(this.options,["filters",r])&&delete this.options.filters[r],this)},t.prototype.axis=function(r,n){return Ym(r)?Hs(this.options,["axes"],r):Hs(this.options,["axes",r],n),this},t.prototype.legend=function(r,n){return Ym(r)?Hs(this.options,["legends"],r):nn(r)?(Hs(this.options,["legends",r],n),zp(n)&&(n!=null&&n.selected)&&Hs(this.options,["filters",r],function(i){var a;return(a=n==null?void 0:n.selected[i])!==null&&a!==void 0?a:!0})):Hs(this.options,["legends"],r),this},t.prototype.scale=function(r,n){var i=this;return nn(r)?Hs(this.options,["scales",r],n):qi(r)&&ft(r,function(a,o){Hs(i.options,["scales",o],a)}),this},t.prototype.tooltip=function(r){return Hs(this.options,"tooltip",r),this},t.prototype.annotation=function(){return this.getController("annotation")},t.prototype.guide=function(){return console.warn("This method will be removed at G2 V4.1. Please use chart.annotation() instead."),this.annotation()},t.prototype.coordinate=function(r,n){return nn(r)?Hs(this.options,"coordinate",{type:r,cfg:n}):Hs(this.options,"coordinate",r),this.coordinateController.update(this.options.coordinate),this.coordinateController},t.prototype.coord=function(r,n){return console.warn("This method will be removed at G2 V4.1. Please use chart.coordinate() instead."),this.coordinate(r,n)},t.prototype.facet=function(r,n){this.facetInstance&&this.facetInstance.destroy();var i=Aye(r);if(!i)throw new Error("facet '".concat(r,"' is not exist!"));return this.facetInstance=new i(this,U(U({},n),{type:r})),this},t.prototype.animate=function(r){return Hs(this.options,"animate",r),this},t.prototype.updateOptions=function(r){return this.clear(),Sa(this.options,r),this.views.forEach(function(n){return n.destroy()}),this.views=[],this.initOptions(),this.coordinateBBox=this.viewBBox,this},t.prototype.option=function(r,n){if(t.prototype[r])throw new Error(`Can't use built in variable name "`.concat(r,'", please change another one.'));return Hs(this.options,r,n),this},t.prototype.theme=function(r){return this.themeObject=qi(r)?Tr({},this.themeObject,kR(r)):Kw(r),this},t.prototype.interaction=function(r,n){var i=this.interactions[r];i&&i.destroy();var a=i_e(r,this,n);return a&&(a.init(),this.interactions[r]=a),this},t.prototype.removeInteraction=function(r){var n=this.interactions[r];n&&(n.destroy(),this.interactions[r]=void 0)},t.prototype.changeData=function(r){this.isDataChanged=!0,this.emit(di.BEFORE_CHANGE_DATA,So.fromData(this,di.BEFORE_CHANGE_DATA,null)),this.data(r),this.paint(!0);for(var n=this.views,i=0,a=n.length;i<a;i++){var o=n[i];o.changeData(r)}this.emit(di.AFTER_CHANGE_DATA,So.fromData(this,di.AFTER_CHANGE_DATA,null))},t.prototype.createView=function(r){this.parent&&this.parent.parent&&console.warn("The view nesting recursive feature will be removed at G2 V4.1. Please avoid to use it.");var n={data:this.options.data,scales:$l(this.options.scales),axes:$l(this.options.axes),coordinate:$l(this.coordinateController.getOption()),tooltip:$l(this.options.tooltip),legends:$l(this.options.legends),animate:this.options.animate,visible:this.visible},i=new t(U(U({parent:this,canvas:this.canvas,backgroundGroup:this.backgroundGroup.addGroup({zIndex:bx.BG}),middleGroup:this.middleGroup.addGroup({zIndex:bx.MID}),foregroundGroup:this.foregroundGroup.addGroup({zIndex:bx.FORE}),theme:this.themeObject,padding:this.padding},r),{options:U(U({},n),xt(r,"options",{}))}));return this.views.push(i),i},t.prototype.view=function(r){return console.warn("This method will be removed at G2 V4.1. Please use chart.createView() instead."),this.createView(r)},t.prototype.removeView=function(r){var n=hUt(this.views,function(i){return i===r})[0];return n&&n.destroy(),n},t.prototype.getCoordinate=function(){return this.coordinateInstance},t.prototype.getTheme=function(){return this.themeObject},t.prototype.getXScale=function(){var r=this.geometries[0];return r?r.getXScale():null},t.prototype.getYScales=function(){var r={},n=[];return this.geometries.forEach(function(i){var a=i.getYScale(),o=a.field;r[o]||(r[o]=!0,n.push(a))}),n},t.prototype.getScalesByDim=function(r){for(var n=this.geometries,i={},a=0,o=n.length;a<o;a++){var s=n[a],l=r==="x"?s.getXScale():s.getYScale();l&&!i[l.field]&&(i[l.field]=l)}return i},t.prototype.getScale=function(r,n){var i=n||this.getScaleKey(r);return this.getRootView().scalePool.getScale(i)},t.prototype.getScaleByField=function(r,n){return this.getScale(r,n)},t.prototype.getOptions=function(){return this.options},t.prototype.getData=function(){return this.filteredData},t.prototype.getOriginalData=function(){return this.options.data},t.prototype.getPadding=function(){return this.autoPadding.getPadding()},t.prototype.getGeometries=function(){return this.geometries},t.prototype.getElements=function(){return Fu(this.geometries,function(r,n){return r.concat(n.getElements())},[])},t.prototype.getElementsBy=function(r){return this.getElements().filter(function(n){return r(n)})},t.prototype.getLayer=function(r){return r===ys.BG?this.backgroundGroup:r===ys.MID?this.middleGroup:r===ys.FORE?this.foregroundGroup:this.foregroundGroup},t.prototype.isPointInPlot=function(r){return yye(this.getCoordinate(),r)},t.prototype.getLegendAttributes=function(){return Nh(this.geometries.map(function(r){return r.getGroupAttributes()}))},t.prototype.getGroupScales=function(){var r=this.geometries.map(function(n){return n.getGroupScales()});return wm(Nh(r))},t.prototype.getCanvas=function(){return this.getRootView().canvas},t.prototype.getRootView=function(){for(var r=this;;){if(r.parent){r=r.parent;continue}break}return r},t.prototype.getXY=function(r){var n=this.getCoordinate(),i=this.getScalesByDim("x"),a=this.getScalesByDim("y"),o,s;if(ft(r,function(l,u){i[u]&&(o=i[u].scale(l)),a[u]&&(s=a[u].scale(l))}),!ke(o)&&!ke(s))return n.convert({x:o,y:s})},t.prototype.getController=function(r){return Bd(this.controllers,function(n){return n.name===r})},t.prototype.showTooltip=function(r){var n=this.getController("tooltip");return n&&n.showTooltip(r),this},t.prototype.hideTooltip=function(){var r=this.getController("tooltip");return r&&r.hideTooltip(),this},t.prototype.lockTooltip=function(){var r=this.getController("tooltip");return r&&r.lockTooltip(),this},t.prototype.unlockTooltip=function(){var r=this.getController("tooltip");return r&&r.unlockTooltip(),this},t.prototype.isTooltipLocked=function(){var r=this.getController("tooltip");return r&&r.isTooltipLocked()},t.prototype.getTooltipItems=function(r){var n=this.getController("tooltip");return n?n.getTooltipItems(r):[]},t.prototype.getSnapRecords=function(r){for(var n=this.geometries,i=[],a=0,o=n.length;a<o;a++){var s=n[a],l=s.dataArray;s.sort(l);for(var u=void 0,c=0,f=l.length;c<f;c++){var d=l[c];u=Tlt(r,d,s),u&&i.push(u)}}for(var v=this.views,a=0,o=v.length;a<o;a++){var g=v[a],x=g.getSnapRecords(r);i=i.concat(x)}return i},t.prototype.getComponents=function(){for(var r=[],n=this.controllers,i=0,a=n.length;i<a;i++){var o=n[i];r=r.concat(o.getComponents())}return r},t.prototype.filterData=function(r){var n=this.options.filters;return _l(n)===0?r:Wl(r,function(i,a){var o=Object.keys(n);return o.every(function(s){var l=n[s];return l(i[s],i,a)})})},t.prototype.filterFieldData=function(r,n){var i=this.options.filters,a=xt(i,r);return iu(a)?n:n.filter(function(o,s){return a(o[r],o,s)})},t.prototype.adjustCoordinate=function(){var r=this.getCoordinate(),n=r.start,i=r.end,a=this.coordinateBBox.bl,o=this.coordinateBBox.tr;if(zi(n,a)&&zi(i,o)){this.isCoordinateChanged=!1;return}this.isCoordinateChanged=!0,this.coordinateInstance=this.coordinateController.adjust(a,o)},t.prototype.paint=function(r){this.renderDataRecursive(r),this.syncScale(),this.emit(di.BEFORE_PAINT),this.renderPaddingRecursive(r),this.renderLayoutRecursive(r),this.renderBackgroundStyleShape(),this.renderPaintRecursive(r),this.emit(di.AFTER_PAINT),this.isDataChanged=!1},t.prototype.renderBackgroundStyleShape=function(){if(!this.parent){var r=xt(this.themeObject,"background");if(r){this.backgroundStyleRectShape||(this.backgroundStyleRectShape=this.backgroundGroup.addShape("rect",{attrs:{},zIndex:-1,capture:!1}),this.backgroundStyleRectShape.toBack());var n=this.viewBBox,i=n.x,a=n.y,o=n.width,s=n.height;this.backgroundStyleRectShape.attr({fill:r,x:i,y:a,width:o,height:s})}else this.backgroundStyleRectShape&&(this.backgroundStyleRectShape.remove(!0),this.backgroundStyleRectShape=void 0)}},t.prototype.renderPaddingRecursive=function(r){this.calculateViewBBox(),this.adjustCoordinate(),this.initComponents(r),this.autoPadding=S_e(this).shrink(_6(this.appendPadding)),this.coordinateBBox=this.viewBBox.shrink(this.autoPadding.getPadding()),this.adjustCoordinate();var n=this.controllers.find(function(l){return l.name==="tooltip"});n.update();for(var i=this.views,a=0,o=i.length;a<o;a++){var s=i[a];s.renderPaddingRecursive(r)}},t.prototype.renderLayoutRecursive=function(r){var n=this.syncViewPadding===!0?T_e:$r(this.syncViewPadding)?this.syncViewPadding:void 0;n&&(n(this,this.views,ZA),this.views.forEach(function(l){l.coordinateBBox=l.viewBBox.shrink(l.autoPadding.getPadding()),l.adjustCoordinate()})),this.doLayout();for(var i=this.views,a=0,o=i.length;a<o;a++){var s=i[a];s.renderLayoutRecursive(r)}},t.prototype.renderPaintRecursive=function(r){var n=this.middleGroup;if(this.limitInPlot){var i=p6(this.coordinateInstance),a=i.type,o=i.attrs;n.setClip({type:a,attrs:o})}else n.setClip(void 0);this.paintGeometries(r),this.renderComponents(r);for(var s=this.views,l=0,u=s.length;l<u;l++){var c=s[l];c.renderPaintRecursive(r)}},t.prototype.createScale=function(r,n,i,a){var o=xt(this.options.scales,[r]),s=U(U({},o),i);return this.parent?this.parent.createScale(r,n,s,a):this.scalePool.createScale(r,n,s,a)},t.prototype.renderDataRecursive=function(r){this.doFilterData(),this.createCoordinate(),this.initGeometries(r),this.renderFacet(r);for(var n=this.views,i=0,a=n.length;i<a;i++){var o=n[i];o.renderDataRecursive(r)}},t.prototype.calculateViewBBox=function(){var r,n,i,a;if(this.parent){var o=this.parent.coordinateBBox;r=o.x,n=o.y,i=o.width,a=o.height}else r=0,n=0,i=this.canvas.get("width"),a=this.canvas.get("height");var s=this.region,l=s.start,u=s.end,c=new lc(r+i*l.x,n+a*l.y,i*(u.x-l.x),a*(u.y-l.y));(!this.viewBBox||!this.viewBBox.isEqual(c))&&(this.viewBBox=new lc(r+i*l.x,n+a*l.y,i*(u.x-l.x),a*(u.y-l.y))),this.coordinateBBox=this.viewBBox},t.prototype.initEvents=function(){this.foregroundGroup.on("*",this.onDelegateEvents),this.middleGroup.on("*",this.onDelegateEvents),this.backgroundGroup.on("*",this.onDelegateEvents),this.canvas.on("*",this.onCanvasEvent)},t.prototype.initComponentController=function(){for(var r=this.usedControllers,n=0,i=r.length;n<i;n++){var a=r[n],o=b_e(a);o&&this.controllers.push(new o(this))}},t.prototype.createViewEvent=function(r){var n=r.shape,i=r.name,a=n?n.get("origin"):null,o=new So(this,r,a);return o.type=i,o},t.prototype.doPlotEvent=function(r){var n=r.type,i=r.x,a=r.y,o={x:i,y:a},s=["mousedown","mouseup","mousemove","mouseleave","mousewheel","touchstart","touchmove","touchend","touchcancel","click","dblclick","contextmenu"];if(s.includes(n)){var l=this.isPointInPlot(o),u=r.clone();if(l){var c="plot:".concat(n);u.type=c,this.emit(c,u),(n==="mouseleave"||n==="touchend")&&(this.isPreMouseInPlot=!1)}n==="mousemove"||n==="touchmove"?(this.isPreMouseInPlot&&!l?(n==="mousemove"&&(u.type=Oc.MOUSE_LEAVE,this.emit(Oc.MOUSE_LEAVE,u)),u.type=Oc.LEAVE,this.emit(Oc.LEAVE,u)):!this.isPreMouseInPlot&&l&&(n==="mousemove"&&(u.type=Oc.MOUSE_ENTER,this.emit(Oc.MOUSE_ENTER,u)),u.type=Oc.ENTER,this.emit(Oc.ENTER,u)),this.isPreMouseInPlot=l):(n==="mouseleave"||n==="touchend")&&this.isPreMouseInPlot&&(n==="mouseleave"&&(u.type=Oc.MOUSE_LEAVE,this.emit(Oc.MOUSE_LEAVE,u)),u.type=Oc.LEAVE,this.emit(Oc.LEAVE,u),this.isPreMouseInPlot=!1)}},t.prototype.doFilterData=function(){var r=this.options.data;this.filteredData=this.filterData(r)},t.prototype.initGeometries=function(r){this.createOrUpdateScales();for(var n=this.getCoordinate(),i=xt(this.options,"scales",{}),a=this.geometries,o=0,s=a.length;o<s;o++){var l=a[o];l.scales=this.getGeometryScales();var u={coordinate:n,scaleDefs:i,data:this.filteredData,theme:this.themeObject,isDataChanged:this.isDataChanged,isCoordinateChanged:this.isCoordinateChanged};r?l.update(u):l.init(u)}this.adjustScales()},t.prototype.createOrUpdateScales=function(){for(var r=this.getScaleFields(),n=this.getGroupedFields(),i=this.getOptions(),a=i.data,o=i.scales,s=o===void 0?{}:o,l=this.filteredData,u=0,c=r.length;u<c;u++){var f=r[u],d=s[f],v=this.getScaleKey(f);this.createScale(f,n.includes(f)?a:l,d,v),this.createdScaleKeys.set(v,!0)}},t.prototype.syncScale=function(){this.getRootView().scalePool.sync(this.getCoordinate(),this.theme)},t.prototype.getGeometryScales=function(){for(var r=this.getScaleFields(),n={},i=0;i<r.length;i++){var a=r[i];n[a]=this.getScaleByField(a)}return n},t.prototype.getScaleFields=function(){for(var r=[],n=new Map,i=this.geometries,a=0;a<i.length;a++){var o=i[a],s=o.getScaleFields();wm(s,r,n)}return r},t.prototype.getGroupedFields=function(){for(var r=[],n=new Map,i=this.geometries,a=0;a<i.length;a++){var o=i[a],s=o.getGroupFields();wm(s,r,n)}return r},t.prototype.adjustScales=function(){this.adjustCategoryScaleRange()},t.prototype.adjustCategoryScaleRange=function(){var r=this,n=an([this.getXScale()],Lr(this.getYScales()),!1).filter(function(o){return!!o}),i=this.getCoordinate(),a=this.options.scales;ft(n,function(o){var s=o.field,l=o.values,u=o.isCategory,c=o.isIdentity;(u||c)&&l&&!xt(a,[s,"range"])&&(o.range=ilt(o,i,r.theme))})},t.prototype.initComponents=function(r){for(var n=this.controllers,i=0;i<n.length;i++){var a=n[i];r?a.update():(a.clear(),a.render())}},t.prototype.doLayout=function(){this.layoutFunc(this)},t.prototype.createCoordinate=function(){var r=this.coordinateBBox.bl,n=this.coordinateBBox.tr;this.coordinateInstance=this.coordinateController.create(r,n)},t.prototype.paintGeometries=function(r){for(var n=this.options.animate,i=this.getCoordinate(),a={x:this.viewBBox.x,y:this.viewBBox.y,minX:this.viewBBox.minX,minY:this.viewBBox.minY,maxX:this.viewBBox.maxX,maxY:this.viewBBox.maxY,width:this.viewBBox.width,height:this.viewBBox.height},o=this.geometries,s=0;s<o.length;s++){var l=o[s];l.coordinate=i,l.canvasRegion=a,n||l.animate(!1),l.paint(r)}},t.prototype.renderComponents=function(r){for(var n=this.getComponents(),i=0;i<n.length;i++){var a=n[i];a.component.render()}},t.prototype.renderFacet=function(r){this.facetInstance&&(r?this.facetInstance.update():(this.facetInstance.clear(),this.facetInstance.init(),this.facetInstance.render()))},t.prototype.initOptions=function(){var r=this,n=this.options,i=n.geometries,a=i===void 0?[]:i,o=n.interactions,s=o===void 0?[]:o,l=n.views,u=l===void 0?[]:l,c=n.annotations,f=c===void 0?[]:c,d=n.coordinate,v=n.events,g=n.facets;this.coordinateController?d&&this.coordinateController.update(d):this.coordinateController=new E_e(d);for(var x=0;x<a.length;x++){var w=a[x];this.createGeometry(w)}for(var S=0;S<s.length;S++){var A=s[S],M=A.type,R=A.cfg;this.interaction(M,R)}for(var O=0;O<u.length;O++){var N=u[O];this.createView(N)}for(var k=this.getController("annotation"),V=0;V<f.length;V++){var Q=f[V];k.annotation(Q)}v&&ft(v,function(Y,X){r.on(X,Y)}),g&&ft(g,function(Y){var X=Y.type,tt=hi(Y,["type"]);r.facet(X,tt)})},t.prototype.createGeometry=function(r){var n=r.type,i=r.cfg,a=i===void 0?{}:i;if(this[n]){var o=this[n](a);ft(r,function(s,l){$r(o[l])&&o[l](s)})}},t.prototype.getScaleKey=function(r){return"".concat(this.id,"-").concat(r)},t}(t6);function lv(e,t){Alt.prototype[e.toLowerCase()]=function(r){r===void 0&&(r={});var n=U({container:this.middleGroup.addGroup(),labelsContainer:this.foregroundGroup.addGroup()},r),i=new t(n);return this.geometries.push(i),i}}var A_e=function(e){Ut(t,e);function t(r){var n=this,i=r.container,a=r.width,o=r.height,s=r.autoFit,l=s===void 0?!1:s,u=r.padding,c=r.appendPadding,f=r.renderer,d=f===void 0?"canvas":f,v=r.pixelRatio,g=r.localRefresh,x=g===void 0?!0:g,w=r.visible,S=w===void 0?!0:w,A=r.supportCSSTransform,M=A===void 0?!1:A,R=r.defaultInteractions,O=R===void 0?["tooltip","legend-filter","legend-active","continuous-filter","ellipsis-text","axis-description"]:R,N=r.options,k=r.limitInPlot,V=r.theme,Q=r.syncViewPadding,Y=nn(i)?document.getElementById(i):i,X=eg('<div style="position:relative;"></div>');Y.appendChild(X);var tt=ZX(Y,l,a,o),it=gge(d),Et=new it.Canvas(U({container:X,pixelRatio:v,localRefresh:x,supportCSSTransform:M},tt));return n=e.call(this,{parent:null,canvas:Et,backgroundGroup:Et.addGroup({zIndex:bx.BG}),middleGroup:Et.addGroup({zIndex:bx.MID}),foregroundGroup:Et.addGroup({zIndex:bx.FORE}),padding:u,appendPadding:c,visible:S,options:N,limitInPlot:k,theme:V,syncViewPadding:Q})||this,n.onResize=xtt(function(){n.forceFit()},300),n.ele=Y,n.canvas=Et,n.width=tt.width,n.height=tt.height,n.autoFit=l,n.localRefresh=x,n.renderer=d,n.wrapperElement=X,n.updateCanvasStyle(),n.bindAutoFit(),n.initDefaultInteractions(O),n}return t.prototype.initDefaultInteractions=function(r){var n=this;ft(r,function(i){n.interaction(i)})},t.prototype.aria=function(r){var n="aria-label";r===!1?this.ele.removeAttribute(n):this.ele.setAttribute(n,r.label)},t.prototype.changeSize=function(r,n){return this.width===r&&this.height===n?this:(this.emit(di.BEFORE_CHANGE_SIZE),this.width=r,this.height=n,this.canvas.changeSize(r,n),this.render(!0),this.emit(di.AFTER_CHANGE_SIZE),this)},t.prototype.clear=function(){e.prototype.clear.call(this),this.aria(!1)},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.unbindAutoFit(),this.canvas.destroy(),yge(this.wrapperElement),this.wrapperElement=null},t.prototype.changeVisible=function(r){return e.prototype.changeVisible.call(this,r),this.wrapperElement.style.display=r?"":"none",this},t.prototype.forceFit=function(){if(!this.destroyed){var r=ZX(this.ele,!0,this.width,this.height),n=r.width,i=r.height;this.changeSize(n,i)}},t.prototype.updateCanvasStyle=function(){ka(this.canvas.get("el"),{display:"inline-block",verticalAlign:"middle"})},t.prototype.bindAutoFit=function(){this.autoFit&&window.addEventListener("resize",this.onResize)},t.prototype.unbindAutoFit=function(){this.autoFit&&window.removeEventListener("resize",this.onResize)},t}(Alt),Ub=function(){function e(t){this.visible=!0,this.components=[],this.view=t}return e.prototype.clear=function(t){ft(this.components,function(r){r.component.destroy()}),this.components=[]},e.prototype.destroy=function(){this.clear()},e.prototype.getComponents=function(){return this.components},e.prototype.changeVisible=function(t){this.visible!==t&&(this.components.forEach(function(r){t?r.component.show():r.component.hide()}),this.visible=t)},e}();function M_e(e){for(var t=[],r=function(i){var a=e[i],o=Bd(t,function(s){return s.color===a.color&&s.name===a.name&&s.value===a.value&&s.title===a.title});o||t.push(a)},n=0;n<e.length;n++)r(n);return t}var Mlt=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.isLocked=!1,r}return Object.defineProperty(t.prototype,"name",{get:function(){return"tooltip"},enumerable:!1,configurable:!0}),t.prototype.init=function(){},t.prototype.isVisible=function(){var r=this.view.getOptions().tooltip;return r!==!1},t.prototype.render=function(){},t.prototype.showTooltip=function(r){if(this.point=r,!!this.isVisible()){var n=this.view,i=this.getTooltipItems(r);if(!i.length){this.hideTooltip();return}var a=this.getTitle(i),o={x:i[0].x,y:i[0].y};n.emit("tooltip:show",So.fromData(n,"tooltip:show",U({items:i,title:a},r)));var s=this.getTooltipCfg(),l=s.follow,u=s.showMarkers,c=s.showCrosshairs,f=s.showContent,d=s.marker,v=this.items,g=this.title;if(!zi(g,a)||!zi(v,i)?(n.emit("tooltip:change",So.fromData(n,"tooltip:change",U({items:i,title:a},r))),($r(f)?f(i):f)&&(this.tooltip||this.renderTooltip(),this.tooltip.update(Sa({},s,{items:this.getItemsAfterProcess(i),title:a},l?r:{})),this.tooltip.show()),u&&this.renderTooltipMarkers(i,d)):(this.tooltip&&l&&(this.tooltip.update(r),this.tooltip.show()),this.tooltipMarkersGroup&&this.tooltipMarkersGroup.show()),this.items=i,this.title=a,c){var x=xt(s,["crosshairs","follow"],!1);this.renderCrosshairs(x?r:o,s)}}},t.prototype.hideTooltip=function(){var r=this.getTooltipCfg().follow;if(!r){this.point=null;return}var n=this.tooltipMarkersGroup;n&&n.hide();var i=this.xCrosshair,a=this.yCrosshair;i&&i.hide(),a&&a.hide();var o=this.tooltip;o&&o.hide(),this.view.emit("tooltip:hide",So.fromData(this.view,"tooltip:hide",{})),this.point=null},t.prototype.lockTooltip=function(){this.isLocked=!0,this.tooltip&&this.tooltip.setCapture(!0)},t.prototype.unlockTooltip=function(){this.isLocked=!1;var r=this.getTooltipCfg();this.tooltip&&this.tooltip.setCapture(r.capture)},t.prototype.isTooltipLocked=function(){return this.isLocked},t.prototype.clear=function(){var r=this,n=r.tooltip,i=r.xCrosshair,a=r.yCrosshair,o=r.tooltipMarkersGroup;n&&(n.hide(),n.clear()),i&&i.clear(),a&&a.clear(),o&&o.clear(),n!=null&&n.get("customContent")&&(this.tooltip.destroy(),this.tooltip=null),this.title=null,this.items=null},t.prototype.destroy=function(){this.tooltip&&this.tooltip.destroy(),this.xCrosshair&&this.xCrosshair.destroy(),this.yCrosshair&&this.yCrosshair.destroy(),this.guideGroup&&this.guideGroup.remove(!0),this.reset()},t.prototype.reset=function(){this.items=null,this.title=null,this.tooltipMarkersGroup=null,this.tooltipCrosshairsGroup=null,this.xCrosshair=null,this.yCrosshair=null,this.tooltip=null,this.guideGroup=null,this.isLocked=!1,this.point=null},t.prototype.changeVisible=function(r){if(this.visible!==r){var n=this,i=n.tooltip,a=n.tooltipMarkersGroup,o=n.xCrosshair,s=n.yCrosshair;r?(i&&i.show(),a&&a.show(),o&&o.show(),s&&s.show()):(i&&i.hide(),a&&a.hide(),o&&o.hide(),s&&s.hide()),this.visible=r}},t.prototype.getTooltipItems=function(r){var n,i,a,o,s,l,u=this.findItemsFromView(this.view,r);if(u.length){u=Nh(u);try{for(var c=mi(u),f=c.next();!f.done;f=c.next()){var d=f.value;try{for(var v=(a=void 0,mi(d)),g=v.next();!g.done;g=v.next()){var x=g.value,w=x.mappingData,S=w.x,A=w.y;x.x=ze(S)?S[S.length-1]:S,x.y=ze(A)?A[A.length-1]:A}}catch(Y){a={error:Y}}finally{try{g&&!g.done&&(o=v.return)&&o.call(v)}finally{if(a)throw a.error}}}}catch(Y){n={error:Y}}finally{try{f&&!f.done&&(i=c.return)&&i.call(c)}finally{if(n)throw n.error}}var M=this.getTooltipCfg().shared;if(M===!1&&u.length>1){var R=u[0],O=Math.abs(r.y-R[0].y);try{for(var N=mi(u),k=N.next();!k.done;k=N.next()){var V=k.value,Q=Math.abs(r.y-V[0].y);Q<=O&&(R=V,O=Q)}}catch(Y){s={error:Y}}finally{try{k&&!k.done&&(l=N.return)&&l.call(N)}finally{if(s)throw s.error}}u=[R]}return M_e(Nh(u))}return[]},t.prototype.layout=function(){},t.prototype.update=function(){if(this.point&&this.showTooltip(this.point),this.tooltip){var r=this.view.getCanvas();this.tooltip.set("region",{start:{x:0,y:0},end:{x:r.get("width"),y:r.get("height")}})}},t.prototype.isCursorEntered=function(r){if(this.tooltip){var n=this.tooltip.getContainer(),i=this.tooltip.get("capture");if(n&&i){var a=n.getBoundingClientRect(),o=a.x,s=a.y,l=a.width,u=a.height;return new lc(o,s,l,u).isPointIn(r)}}return!1},t.prototype.getTooltipCfg=function(){var r=this.view,n=r.getOptions().tooltip,i=this.processCustomContent(n),a=r.getTheme(),o=xt(a,["components","tooltip"],{}),s=xt(i,"enterable",o.enterable);return Tr({},o,i,{capture:!!(s||this.isLocked)})},t.prototype.processCustomContent=function(r){if(Ym(r)||!xt(r,"customContent"))return r;var n=r.customContent,i=function(a,o){var s=n(a,o)||"";return nn(s)?'<div class="g2-tooltip">'+s+"</div>":s};return U(U({},r),{customContent:i})},t.prototype.getTitle=function(r){var n=r[0].title||r[0].name;return this.title=n,n},t.prototype.renderTooltip=function(){var r=this.view.getCanvas(),n={start:{x:0,y:0},end:{x:r.get("width"),y:r.get("height")}},i=this.getTooltipCfg(),a=new k3(U(U({parent:r.get("el").parentNode,region:n},i),{visible:!1,crosshairs:null}));a.init(),this.tooltip=a},t.prototype.renderTooltipMarkers=function(r,n){var i,a,o=this.getTooltipMarkersGroup(),s=this.view.getRootView(),l=s.limitInPlot;try{for(var u=mi(r),c=u.next();!c.done;c=u.next()){var f=c.value,d=f.x,v=f.y;if(l||o!=null&&o.getClip()){var g=p6(s.getCoordinate()),x=g.type,w=g.attrs;o==null||o.setClip({type:x,attrs:w})}else o==null||o.setClip(void 0);var S=this.view.getTheme(),A=xt(S,["components","tooltip","marker"],{}),M=U(U({fill:f.color,symbol:"circle",shadowColor:f.color},$r(n)?U(U({},A),n(f)):n),{x:d,y:v});o.addShape("marker",{attrs:M})}}catch(R){i={error:R}}finally{try{c&&!c.done&&(a=u.return)&&a.call(u)}finally{if(i)throw i.error}}},t.prototype.renderCrosshairs=function(r,n){var i=xt(n,["crosshairs","type"],"x");i==="x"?(this.yCrosshair&&this.yCrosshair.hide(),this.renderXCrosshairs(r,n)):i==="y"?(this.xCrosshair&&this.xCrosshair.hide(),this.renderYCrosshairs(r,n)):i==="xy"&&(this.renderXCrosshairs(r,n),this.renderYCrosshairs(r,n))},t.prototype.renderXCrosshairs=function(r,n){var i=this.getViewWithGeometry(this.view).getCoordinate(),a,o;if(i.isRect)i.isTransposed?(a={x:i.start.x,y:r.y},o={x:i.end.x,y:r.y}):(a={x:r.x,y:i.end.y},o={x:r.x,y:i.start.y});else{var s=ab(i,r),l=i.getCenter(),u=i.getRadius();o=Ls(l.x,l.y,u,s),a=l}var c=Tr({start:a,end:o,container:this.getTooltipCrosshairsGroup()},xt(n,"crosshairs",{}),this.getCrosshairsText("x",r,n));delete c.type;var f=this.xCrosshair;f?f.update(c):(f=new Zst(c),f.init()),f.render(),f.show(),this.xCrosshair=f},t.prototype.renderYCrosshairs=function(r,n){var i=this.getViewWithGeometry(this.view).getCoordinate(),a,o;if(i.isRect){var s=void 0,l=void 0;i.isTransposed?(s={x:r.x,y:i.end.y},l={x:r.x,y:i.start.y}):(s={x:i.start.x,y:r.y},l={x:i.end.x,y:r.y}),a={start:s,end:l},o="Line"}else a={center:i.getCenter(),radius:z3(i,r),startAngle:i.startAngle,endAngle:i.endAngle},o="Circle";a=Tr({container:this.getTooltipCrosshairsGroup()},a,xt(n,"crosshairs",{}),this.getCrosshairsText("y",r,n)),delete a.type;var u=this.yCrosshair;u?i.isRect&&u.get("type")==="circle"||!i.isRect&&u.get("type")==="line"?(u=new fj[o](a),u.init()):u.update(a):(u=new fj[o](a),u.init()),u.render(),u.show(),this.yCrosshair=u},t.prototype.getCrosshairsText=function(r,n,i){var a=xt(i,["crosshairs","text"]),o=xt(i,["crosshairs","follow"]),s=this.items;if(a){var l=this.getViewWithGeometry(this.view),u=s[0],c=l.getXScale(),f=l.getYScales()[0],d=void 0,v=void 0;if(o){var g=this.view.getCoordinate().invert(n);d=c.invert(g.x),v=f.invert(g.y)}else d=u.data[c.field],v=u.data[f.field];var x=r==="x"?d:v;return $r(a)?a=a(r,x,s,n):a.content=x,{text:a}}},t.prototype.getGuideGroup=function(){if(!this.guideGroup){var r=this.view.foregroundGroup;this.guideGroup=r.addGroup({name:"tooltipGuide",capture:!1})}return this.guideGroup},t.prototype.getTooltipMarkersGroup=function(){var r=this.tooltipMarkersGroup;return r&&!r.destroyed?(r.clear(),r.show()):(r=this.getGuideGroup().addGroup({name:"tooltipMarkersGroup"}),r.toFront(),this.tooltipMarkersGroup=r),r},t.prototype.getTooltipCrosshairsGroup=function(){var r=this.tooltipCrosshairsGroup;return r||(r=this.getGuideGroup().addGroup({name:"tooltipCrosshairsGroup",capture:!1}),r.toBack(),this.tooltipCrosshairsGroup=r),r},t.prototype.findItemsFromView=function(r,n){var i,a;if(r.getOptions().tooltip===!1)return[];var o=this.getTooltipCfg(),s=YB(r,n,o);try{for(var l=mi(r.views),u=l.next();!u.done;u=l.next()){var c=u.value;s=s.concat(this.findItemsFromView(c,n))}}catch(f){i={error:f}}finally{try{u&&!u.done&&(a=l.return)&&a.call(l)}finally{if(i)throw i.error}}return s},t.prototype.getViewWithGeometry=function(r){var n=this;return r.geometries.length?r:Bd(r.views,function(i){return n.getViewWithGeometry(i)})},t.prototype.getItemsAfterProcess=function(r){var n=this.getTooltipCfg().customItems,i=n||function(a){return a};return i(r)},t}(Ub),Rlt={};function Ilt(e){return Rlt[e.toLowerCase()]}function Wh(e,t){Rlt[e.toLowerCase()]=t}var sb={appear:{duration:450,easing:"easeQuadOut"},update:{duration:400,easing:"easeQuadInOut"},enter:{duration:400,easing:"easeQuadInOut"},leave:{duration:350,easing:"easeQuadIn"}},R_e={interval:function(e){return{enter:{animation:e.isRect?e.isTransposed?"scale-in-x":"scale-in-y":"fade-in"},update:{animation:e.isPolar&&e.isTransposed?"sector-path-update":null},leave:{animation:"fade-out"}}},line:{enter:{animation:"fade-in"},leave:{animation:"fade-out"}},path:{enter:{animation:"fade-in"},leave:{animation:"fade-out"}},point:{appear:{animation:"zoom-in"},enter:{animation:"zoom-in"},leave:{animation:"zoom-out"}},area:{enter:{animation:"fade-in"},leave:{animation:"fade-out"}},polygon:{enter:{animation:"fade-in"},leave:{animation:"fade-out"}},schema:{enter:{animation:"fade-in"},leave:{animation:"fade-out"}},edge:{enter:{animation:"fade-in"},leave:{animation:"fade-out"}},label:{appear:{animation:"fade-in",delay:450},enter:{animation:"fade-in"},update:{animation:"position-update"},leave:{animation:"fade-out"}}},Fj={line:function(){return{animation:"wave-in"}},area:function(){return{animation:"wave-in"}},path:function(){return{animation:"fade-in"}},interval:function(e){var t;return e.isRect?t=e.isTransposed?"grow-in-x":"grow-in-y":(t="grow-in-xy",e.isPolar&&e.isTransposed&&(t="wave-in")),{animation:t}},schema:function(e){var t;return e.isRect?t=e.isTransposed?"grow-in-x":"grow-in-y":t="grow-in-xy",{animation:t}},polygon:function(){return{animation:"fade-in",duration:500}},edge:function(){return{animation:"fade-in"}}};function I_e(e,t){return{delay:$r(e.delay)?e.delay(t):e.delay,easing:$r(e.easing)?e.easing(t):e.easing,duration:$r(e.duration)?e.duration(t):e.duration,callback:e.callback,repeat:e.repeat}}function Llt(e,t,r){var n=R_e[e];return n&&($r(n)&&(n=n(t)),n=Tr({},sb,n),r)?n[r]:n}function Cx(e,t,r){var n=xt(e.get("origin"),"data",Oa),i=t.animation,a=I_e(t,n);if(i){var o=Ilt(i);o&&o(e,a,r)}else e.animate(r.toAttrs,a)}function L_e(e,t,r,n,i){if(Fj[r]){var a=Fj[r](n),o=Ilt(xt(a,"animation",""));if(o){var s=U(U(U({},sb.appear),a),t);e.stopAnimate(),o(e,s,{coordinate:n,minYPoint:i,toAttrs:null})}}}var b6="element-background",Olt=function(e){Ut(t,e);function t(r){var n=e.call(this,r)||this;n.labelShape=[],n.states=[];var i=r.shapeFactory,a=r.container,o=r.offscreenGroup,s=r.elementIndex,l=r.visible,u=l===void 0?!0:l;return n.shapeFactory=i,n.container=a,n.offscreenGroup=o,n.visible=u,n.elementIndex=s,n}return t.prototype.draw=function(r,n){n===void 0&&(n=!1),this.model=r,this.data=r.data,this.shapeType=this.getShapeType(r),this.drawShape(r,n),this.visible===!1&&this.changeVisible(!1)},t.prototype.update=function(r){var n=this,i=n.shapeFactory,a=n.shape;if(a){this.model=r,this.data=r.data,this.shapeType=this.getShapeType(r),this.setShapeInfo(a,r);var o=this.getOffscreenGroup(),s=i.drawShape(this.shapeType,r,o);s.cfg.data=this.data,s.cfg.origin=r,s.cfg.element=this,this.syncShapeStyle(a,s,this.getStates(),this.getAnimateCfg("update"))}},t.prototype.destroy=function(){var r=this,n=r.shapeFactory,i=r.shape;if(i){var a=this.getAnimateCfg("leave");a?Cx(i,a,{coordinate:n.coordinate,toAttrs:U({},i.attr())}):i.remove(!0)}this.states=[],this.shapeFactory=void 0,this.container=void 0,this.shape=void 0,this.animate=void 0,this.geometry=void 0,this.labelShape=[],this.model=void 0,this.data=void 0,this.offscreenGroup=void 0,this.statesStyle=void 0,e.prototype.destroy.call(this)},t.prototype.changeVisible=function(r){e.prototype.changeVisible.call(this,r),r?(this.shape&&this.shape.show(),this.labelShape&&this.labelShape.forEach(function(n){n.show()})):(this.shape&&this.shape.hide(),this.labelShape&&this.labelShape.forEach(function(n){n.hide()}))},t.prototype.setState=function(r,n){var i=this,a=i.states,o=i.shapeFactory,s=i.model,l=i.shape,u=i.shapeType,c=a.indexOf(r);if(n){if(c>-1)return;a.push(r),(r==="active"||r==="selected")&&(l==null||l.toFront())}else{if(c===-1)return;if(a.splice(c,1),r==="active"||r==="selected"){var f=this.geometry,d=f.sortZIndex,v=f.zIndexReversed,g=v?this.geometry.elements.length-this.elementIndex:this.elementIndex;d?l.setZIndex(g):l.set("zIndex",g)}}var x=o.drawShape(u,s,this.getOffscreenGroup());a.length?this.syncShapeStyle(l,x,a,null):this.syncShapeStyle(l,x,["reset"],null),x.remove(!0);var w={state:r,stateStatus:n,element:this,target:this.container};this.container.emit("statechange",w),Fst(this.shape,"statechange",w)},t.prototype.clearStates=function(){var r=this,n=this.states;ft(n,function(i){r.setState(i,!1)}),this.states=[]},t.prototype.hasState=function(r){return this.states.includes(r)},t.prototype.getStates=function(){return this.states},t.prototype.getData=function(){return this.data},t.prototype.getModel=function(){return this.model},t.prototype.getBBox=function(){var r=this,n=r.shape,i=r.labelShape,a={x:0,y:0,minX:0,minY:0,maxX:0,maxY:0,width:0,height:0};return n&&(a=n.getCanvasBBox()),i&&i.forEach(function(o){var s=o.getCanvasBBox();a.x=Math.min(s.x,a.x),a.y=Math.min(s.y,a.y),a.minX=Math.min(s.minX,a.minX),a.minY=Math.min(s.minY,a.minY),a.maxX=Math.max(s.maxX,a.maxX),a.maxY=Math.max(s.maxY,a.maxY)}),a.width=a.maxX-a.minX,a.height=a.maxY-a.minY,a},t.prototype.getStatesStyle=function(){if(!this.statesStyle){var r=this,n=r.shapeType,i=r.geometry,a=r.shapeFactory,o=i.stateOption,s=a.defaultShapeType,l=a.theme[n]||a.theme[s];this.statesStyle=Tr({},l,o)}return this.statesStyle},t.prototype.getStateStyle=function(r,n){var i=this.getStatesStyle(),a=xt(i,[r,"style"],{}),o=a[n]||a;return $r(o)?o(this):o},t.prototype.getAnimateCfg=function(r){var n=this,i=this.animate;if(i){var a=i[r];return a&&U(U({},a),{callback:function(){var o;$r(a.callback)&&a.callback(),(o=n.geometry)===null||o===void 0||o.emit(zm.AFTER_DRAW_ANIMATE)}})}return null},t.prototype.drawShape=function(r,n){var i;n===void 0&&(n=!1);var a=this,o=a.shapeFactory,s=a.container,l=a.shapeType;if(this.shape=o.drawShape(l,r,s),this.shape){this.setShapeInfo(this.shape,r);var u=this.shape.cfg.name;u?nn(u)&&(this.shape.cfg.name=["element",u]):this.shape.cfg.name=["element",this.shapeFactory.geometryType];var c=n?"enter":"appear",f=this.getAnimateCfg(c);f&&((i=this.geometry)===null||i===void 0||i.emit(zm.BEFORE_DRAW_ANIMATE),Cx(this.shape,f,{coordinate:o.coordinate,toAttrs:U({},this.shape.attr())}))}},t.prototype.getOffscreenGroup=function(){if(!this.offscreenGroup){var r=this.container.getGroupBase();this.offscreenGroup=new r({})}return this.offscreenGroup},t.prototype.setShapeInfo=function(r,n){var i=this;if(r.cfg.origin=n,r.cfg.element=this,r.isGroup()){var a=r.get("children");a.forEach(function(o){i.setShapeInfo(o,n)})}},t.prototype.syncShapeStyle=function(r,n,i,a,o){var s=this,l;if(i===void 0&&(i=[]),o===void 0&&(o=0),!(!r||!n)){var u=r.get("clipShape"),c=n.get("clipShape");if(this.syncShapeStyle(u,c,i,a),r.isGroup())for(var f=r.get("children"),d=n.get("children"),v=0;v<f.length;v++)this.syncShapeStyle(f[v],d[v],i,a,o+v);else{if(!Kc(i)&&!zi(i,["reset"])){var g=r.get("name");ze(g)&&(g=g[1]),ft(i,function(w){if(n.get("name")!==b6){var S=s.getStateStyle(w,g||o);n.attr(S)}})}var x=rlt(r,n);this.animate?a?((l=this.geometry)===null||l===void 0||l.emit(zm.BEFORE_DRAW_ANIMATE),Cx(r,a,{coordinate:this.shapeFactory.coordinate,toAttrs:x,shapeModel:this.model})):Kc(i)?r.attr(x):(r.stopAnimate(),r.animate(x,{duration:300})):r.attr(x)}}},t.prototype.getShapeType=function(r){var n=xt(r,"shape");return ze(n)?n[0]:n},t}(t6),Plt={},Dlt={};function O_e(e){return Plt[e.toLowerCase()]}function JS(e,t){Plt[e.toLowerCase()]=t}function P_e(e){return Dlt[e.toLowerCase()]}function ih(e,t){Dlt[e.toLowerCase()]=t}var D_e={coordinate:null,defaultShapeType:null,theme:null,getShapePoints:function(e,t){var r=this.getShape(e);return r.getPoints?r.getPoints(t):this.getDefaultPoints(t)},getShape:function(e){var t=this[e]||this[this.defaultShapeType];return t.coordinate=this.coordinate,t},getDefaultPoints:function(){return[]},getDefaultStyle:function(e){return xt(e,[this.defaultShapeType,"default","style"],{})},getMarker:function(e,t){var r=this.getShape(e);if(!r.getMarker){var n=this.defaultShapeType;r=this.getShape(n)}var i=this.theme,a=xt(i,[e,"default"],{}),o=r.getMarker(t);return Tr({},a,o)},drawShape:function(e,t,r){var n=this.getShape(e);return n.draw(t,r)}},F_e={coordinate:null,parsePath:function(e){var t=this.coordinate,r=zye(e);return t.isPolar?r=Bye(t,r):r=Fye(t,r),r},parsePoint:function(e){var t=this.coordinate;return t.convert(e)},parsePoints:function(e){var t=this.coordinate;return e.map(function(r){return t.convert(r)})},draw:function(e,t){}},E6={};function b0(e,t){var r=C_(e),n=U(U(U({},D_e),t),{geometryType:e});return E6[r]=n,n}function ca(e,t,r){var n=C_(e),i=E6[n],a=U(U({},F_e),r);return i[t]=a,a}function Bj(e){var t=C_(e);return E6[t]}function B_e(e,t,r){var n,i;if(r===void 0&&(r={}),!t)return[e];var a=gtt(e,t),o=[];if(t.length===1&&r[t[0]]){var s=r[t[0]];try{for(var l=mi(s),u=l.next();!u.done;u=l.next()){var c=u.value,f=a["_".concat(c)];f&&o.push(f)}}catch(g){n={error:g}}finally{try{u&&!u.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}}else for(var d in a)if(a.hasOwnProperty(d)){var v=a[d];o.push(v)}return o}function Flt(e,t){return xI(["color","shape","size","x","y","isInCircle","data","style","defaultStyle","points","mappingData"],function(r){return!zi(e[r],t[r])})}function tw(e){return ze(e)?e:e.split("*")}function Blt(e,t){for(var r=[],n=[],i=[],a=new Map,o=0;o<t.length;o++){var s=t[o];e[s]?n.push(s):r.push(s),a.set(s,!0)}return Object.keys(e).forEach(function(l){a.has(l)||i.push(l)}),{added:r,updated:n,removed:i}}var E0=function(e){Ut(t,e);function t(r){var n=e.call(this,r)||this;n.type="base",n.attributes={},n.elements=[],n.elementsMap={},n.animateOption=!0,n.attributeOption={},n.lastElementsMap={},n.generatePoints=!1,n.beforeMappingData=null,n.adjusts={},n.idFields=[],n.hasSorted=!1,n.isCoordinateChanged=!1;var i=r.container,a=r.labelsContainer,o=r.coordinate,s=r.data,l=r.sortable,u=l===void 0?!1:l,c=r.visible,f=c===void 0?!0:c,d=r.theme,v=r.scales,g=v===void 0?{}:v,x=r.scaleDefs,w=x===void 0?{}:x,S=r.intervalPadding,A=r.dodgePadding,M=r.maxColumnWidth,R=r.minColumnWidth,O=r.columnWidthRatio,N=r.roseWidthRatio,k=r.multiplePieWidthRatio,V=r.zIndexReversed,Q=r.sortZIndex,Y=r.useDeferredLabel;return n.container=i,n.labelsContainer=a,n.coordinate=o,n.data=s,n.sortable=u,n.visible=f,n.userTheme=d,n.scales=g,n.scaleDefs=w,n.intervalPadding=S,n.dodgePadding=A,n.maxColumnWidth=M,n.minColumnWidth=R,n.columnWidthRatio=O,n.roseWidthRatio=N,n.multiplePieWidthRatio=k,n.zIndexReversed=V,n.sortZIndex=Q,n.useDeferredLabel=Y?typeof Y=="number"?Y:1/0:null,n}return t.prototype.position=function(r){var n=r;zp(r)||(n={fields:tw(r)});var i=xt(n,"fields");return i.length===1&&(i.unshift("1"),Hs(n,"fields",i)),Hs(this.attributeOption,"position",n),this},t.prototype.color=function(r,n){return this.createAttrOption("color",r,n),this},t.prototype.shape=function(r,n){return this.createAttrOption("shape",r,n),this},t.prototype.size=function(r,n){return this.createAttrOption("size",r,n),this},t.prototype.adjust=function(r){var n=r;return(nn(r)||zp(r))&&(n=[r]),ft(n,function(i,a){qi(i)||(n[a]={type:i})}),this.adjustOption=n,this},t.prototype.style=function(r,n){if(nn(r)){var i=tw(r);this.styleOption={fields:i,callback:n}}else{var a=r,i=a.fields,o=a.callback,s=a.cfg;i||o||s?this.styleOption=r:this.styleOption={cfg:r}}return this},t.prototype.tooltip=function(r,n){if(nn(r)){var i=tw(r);this.tooltipOption={fields:i,callback:n}}else this.tooltipOption=r;return this},t.prototype.animate=function(r){return this.animateOption=r,this},t.prototype.label=function(r,n,i){if(nn(r)){var a={},o=tw(r);a.fields=o,$r(n)?a.callback=n:zp(n)&&(a.cfg=n),i&&(a.cfg=i),this.labelOption=a}else this.labelOption=r;return this},t.prototype.state=function(r){return this.stateOption=r,this},t.prototype.customInfo=function(r){return this.customOption=r,this},t.prototype.init=function(r){r===void 0&&(r={}),this.setCfg(r),this.initAttributes(),this.processData(this.data),this.adjustScale()},t.prototype.update=function(r){r===void 0&&(r={});var n=r.data,i=r.isDataChanged,a=r.isCoordinateChanged,o=this,s=o.attributeOption,l=o.lastAttributeOption;zi(s,l)?n&&(i||!zi(n,this.data))?(this.setCfg(r),this.initAttributes(),this.processData(n)):this.setCfg(r):this.init(r),this.adjustScale(),this.isCoordinateChanged=a},t.prototype.paint=function(r){var n=this;r===void 0&&(r=!1),this.animateOption&&(this.animateOption=Tr({},Llt(this.type,this.coordinate),this.animateOption)),this.defaultSize=void 0,this.elementsMap={},this.elements=[];var i=this.getOffscreenGroup();i.clear();var a=this.beforeMappingData,o=this.beforeMapping(a);this.dataArray=new Array(o.length);for(var s=0;s<o.length;s++){var l=o[s];this.dataArray[s]=this.mapping(l)}if(this.updateElements(this.dataArray,r),this.lastElementsMap=this.elementsMap,this.canDoGroupAnimation(r)){var u=this.container,c=this.type,f=this.coordinate,d=xt(this.animateOption,"appear"),v=this.getYScale(),g=f.convert({x:0,y:v.scale(this.getYMinValue())});L_e(u,d,c,f,g)}if(this.labelOption){var x=this.useDeferredLabel,w=(function(){return n.renderLabels(Nh(n.dataArray),r)}).bind(this);if(typeof x=="number"){var S=typeof x=="number"&&x!==1/0?x:0;if(!window.requestIdleCallback)setTimeout(w,S);else{var A=S&&S!==1/0?{timeout:S}:void 0;window.requestIdleCallback(w,A)}}else w()}this.lastAttributeOption=U({},this.attributeOption),this.visible===!1&&this.changeVisible(!1)},t.prototype.clear=function(){var r=this,n=r.container,i=r.geometryLabel,a=r.offscreenGroup;n&&n.clear(),i&&i.clear(),a&&a.clear(),this.scaleDefs=void 0,this.attributes={},this.scales={},this.elementsMap={},this.lastElementsMap={},this.elements=[],this.adjusts={},this.dataArray=null,this.beforeMappingData=null,this.lastAttributeOption=void 0,this.defaultSize=void 0,this.idFields=[],this.groupScales=void 0,this.hasSorted=!1,this.isCoordinateChanged=!1},t.prototype.destroy=function(){this.clear();var r=this.container;r.remove(!0),this.offscreenGroup&&(this.offscreenGroup.remove(!0),this.offscreenGroup=null),this.geometryLabel&&(this.geometryLabel.destroy(),this.geometryLabel=null),this.theme=void 0,this.shapeFactory=void 0,e.prototype.destroy.call(this)},t.prototype.getGroupScales=function(){return this.groupScales},t.prototype.getAttribute=function(r){return this.attributes[r]},t.prototype.getXScale=function(){return this.getAttribute("position").scales[0]},t.prototype.getYScale=function(){return this.getAttribute("position").scales[1]},t.prototype.getGroupAttributes=function(){var r=[];return ft(this.attributes,function(n){nx.includes(n.type)&&r.push(n)}),r},t.prototype.getDefaultValue=function(r){var n,i=this.getAttribute(r);return i&&Kc(i.scales)&&(n=i.values[0]),n},t.prototype.getAttributeValues=function(r,n){for(var i=[],a=r.scales,o=0,s=a.length;o<s;o++){var l=a[o],u=l.field;l.isIdentity?i.push(l.values):i.push(n[u])}return r.mapping.apply(r,an([],Lr(i),!1))},t.prototype.getAdjust=function(r){return this.adjusts[r]},t.prototype.getCoordinate=function(){return this.coordinate},t.prototype.getData=function(){return this.data},t.prototype.getShapeMarker=function(r,n){var i=this.getShapeFactory();return i.getMarker(r,n)},t.prototype.getElementsBy=function(r){return this.elements.filter(function(n){return r(n)})},t.prototype.getElements=function(){return this.elements},t.prototype.getElementId=function(r){r=ze(r)?r[0]:r;var n=r[Oa];if(this.idFields.length){for(var i=n[this.idFields[0]],a=1;a<this.idFields.length;a++)i+="-"+n[this.idFields[a]];return i}var o=this.type,s=this.getXScale(),l=this.getYScale(),u=s.field||"x",c=l.field||"y",f=n[c],d;s.type==="identity"?d=s.values[0]:d=n[u];var v;o==="interval"||o==="schema"?v="".concat(d):o==="line"||o==="area"||o==="path"?v=o:v="".concat(d,"-").concat(f);for(var g=this.groupScales,a=0,x=g.length;a<x;a++){var w=g[a],S=w.field;v="".concat(v,"-").concat(n[S])}var A=this.getAdjust("dodge");if(A){var M=A.dodgeBy;M&&(v="".concat(v,"-").concat(n[M]))}return this.getAdjust("jitter")&&(v="".concat(v,"-").concat(r.x,"-").concat(r.y)),v},t.prototype.getScaleFields=function(){var r=[],n=new Map,i=this,a=i.attributeOption,o=i.labelOption,s=i.tooltipOption;for(var l in a)if(a.hasOwnProperty(l)){var u=a[l];u.fields?wm(u.fields,r,n):u.values&&wm(u.values,r,n)}return o&&o.fields&&wm(o.fields,r,n),qi(s)&&s.fields&&wm(s.fields,r,n),r},t.prototype.changeVisible=function(r){e.prototype.changeVisible.call(this,r);for(var n=this.elements,i=0,a=n.length;i<a;i++){var o=n[i];o.changeVisible(r)}r?(this.container&&this.container.show(),this.labelsContainer&&this.labelsContainer.show()):(this.container&&this.container.hide(),this.labelsContainer&&this.labelsContainer.hide())},t.prototype.getFields=function(){var r=new Map,n=[];return Object.values(this.attributeOption).forEach(function(i){var a=(i==null?void 0:i.fields)||[];a.forEach(function(o){r.has(o)||n.push(o),r.set(o,!0)})},[]),n},t.prototype.getGroupFields=function(){for(var r=[],n=new Map,i=0,a=nx.length;i<a;i++){var o=nx[i],s=this.attributeOption[o];s&&s.fields&&wm(s.fields,r,n)}return r},t.prototype.getXYFields=function(){var r=Lr(this.attributeOption.position.fields,2),n=r[0],i=r[1];return[n,i]},t.prototype.getXField=function(){return xt(this.getXYFields(),[0])},t.prototype.getYField=function(){return xt(this.getXYFields(),[1])},t.prototype.getShapes=function(){return this.elements.map(function(r){return r.shape})},t.prototype.getOffscreenGroup=function(){if(!this.offscreenGroup){var r=this.container.getGroupBase();this.offscreenGroup=new r({})}return this.offscreenGroup},t.prototype.sort=function(r){if(!this.hasSorted)for(var n=this.getXScale(),i=n.field,a=0;a<r.length;a++){var o=r[a];o.sort(function(s,l){return n.translate(s[Oa][i])-n.translate(l[Oa][i])})}this.hasSorted=!0},t.prototype.adjustScale=function(){var r=this.getYScale();r&&this.getAdjust("stack")&&this.updateStackRange(r,this.beforeMappingData)},t.prototype.getShapeFactory=function(){var r=this.shapeType;if(Bj(r))return this.shapeFactory||(this.shapeFactory=$l(Bj(r))),this.shapeFactory.coordinate=this.coordinate,this.shapeFactory.theme=this.theme.geometries[r]||{},this.shapeFactory},t.prototype.createShapePointsCfg=function(r){var n=this.getXScale(),i=this.getYScale(),a=this.normalizeValues(r[n.field],n),o;return i?o=this.normalizeValues(r[i.field],i):o=r.y?r.y:.1,{x:a,y:o,y0:i?i.scale(this.getYMinValue()):void 0}},t.prototype.createElement=function(r,n,i){i===void 0&&(i=!1);var a=this.container,o=this.getDrawCfg(r),s=this.getShapeFactory(),l=new Olt({shapeFactory:s,container:a,offscreenGroup:this.getOffscreenGroup(),elementIndex:n});return l.animate=this.animateOption,l.geometry=this,l.draw(o,i),l},t.prototype.getDrawCfg=function(r){var n=r[Oa],i={mappingData:r,data:n,x:r.x,y:r.y,color:r.color,size:r.size,isInCircle:this.coordinate.isPolar,customInfo:this.customOption},a=r.shape;!a&&this.getShapeFactory()&&(a=this.getShapeFactory().defaultShapeType),i.shape=a;var o=this.theme.geometries[this.shapeType];i.defaultStyle=xt(o,[a,"default"],{}).style,!i.defaultStyle&&this.getShapeFactory()&&(i.defaultStyle=this.getShapeFactory().getDefaultStyle(o));var s=this.styleOption;return s&&(i.style=this.getStyleCfg(s,n)),this.generatePoints&&(i.points=r.points,i.nextPoints=r.nextPoints),i},t.prototype.updateElements=function(r,n){var i,a,o,s,l,u;n===void 0&&(n=!1);for(var c=new Map,f=[],d=new Map,v=0,g=0;g<r.length;g++)for(var x=r[g],w=0;w<x.length;w++){var S=x[w],A=this.getElementId(S),M=c.has(A)?"".concat(A,"-").concat(g,"-").concat(w):A;f.push(M),c.set(M,S),d.set(M,v),v++}this.elements=new Array(v);var R=Blt(this.lastElementsMap,f),O=R.added,N=R.updated,k=R.removed;try{for(var V=mi(O),Q=V.next();!Q.done;Q=V.next()){var A=Q.value,S=c.get(A),g=d.get(A),Y=this.createElement(S,g,n);this.elements[g]=Y,this.elementsMap[A]=Y,Y.shape&&Y.shape.set("zIndex",this.zIndexReversed?this.elements.length-g:g)}}catch(kt){i={error:kt}}finally{try{Q&&!Q.done&&(a=V.return)&&a.call(V)}finally{if(i)throw i.error}}try{for(var X=mi(N),tt=X.next();!tt.done;tt=X.next()){var A=tt.value,Y=this.lastElementsMap[A],S=c.get(A),it=this.getDrawCfg(S),Et=Y.getModel(),g=d.get(A);(this.isCoordinateChanged||Flt(it,Et))&&(Y.animate=this.animateOption,Y.update(it)),this.elements[g]=Y,this.elementsMap[A]=Y,Y.shape&&Y.shape.set("zIndex",this.zIndexReversed?this.elements.length-g:g)}}catch(kt){o={error:kt}}finally{try{tt&&!tt.done&&(s=X.return)&&s.call(X)}finally{if(o)throw o.error}}this.container&&this.container.sort();try{for(var Tt=mi(k),pt=Tt.next();!pt.done;pt=Tt.next()){var A=pt.value,Y=this.lastElementsMap[A];Y.animate=this.animateOption,Y.destroy()}}catch(kt){l={error:kt}}finally{try{pt&&!pt.done&&(u=Tt.return)&&u.call(Tt)}finally{if(l)throw l.error}}},t.prototype.getLabelType=function(){var r=this,n=r.labelOption,i=r.coordinate,a=r.type,o=i.type,s=i.isTransposed,l=xt(n,["cfg","type"]);return l||(o==="polar"?l=s?"pie":"polar":o==="theta"?l="pie":a==="interval"||a==="polygon"?l="interval":l="base"),l},t.prototype.getYMinValue=function(){var r=this.getYScale(),n=r.min,i=r.max,a;return n>=0?a=n:i<=0?a=i:a=0,a},t.prototype.createAttrOption=function(r,n,i){if(ke(n)||qi(n))qi(n)&&zi(Object.keys(n),["values"])?Hs(this.attributeOption,r,{fields:n.values}):Hs(this.attributeOption,r,n);else{var a={};Gn(n)?a.values=[n]:a.fields=tw(n),i&&($r(i)?a.callback=i:a.values=i),Hs(this.attributeOption,r,a)}},t.prototype.initAttributes=function(){var r=this,n=this,i=n.attributes,a=n.attributeOption,o=n.theme,s=n.shapeType;this.groupScales=[];var l={},u=function(d){if(a.hasOwnProperty(d)){var v=a[d];if(!v)return{value:void 0};var g=U({},v),x=g.callback,w=g.values,S=g.fields,A=S===void 0?[]:S,M=A.map(function(O){var N=r.scales[O];if(!l[O]&&nx.includes(d)){var k=nlt(N,xt(r.scaleDefs,O),d,r.type);k==="cat"&&(r.groupScales.push(N),l[O]=!0)}return N});g.scales=M,d!=="position"&&M.length===1&&M[0].type==="identity"?g.values=M[0].values:!x&&!w&&(d==="size"?g.values=o.sizes:d==="shape"?g.values=o.shapes[s]||[]:d==="color"&&(M.length?g.values=M[0].values.length<=10?o.colors10:o.colors20:g.values=o.colors10));var R=Ost(d);i[d]=new R(g)}};for(var c in a){var f=u(c);if(typeof f=="object")return f.value}},t.prototype.processData=function(r){var n,i;this.hasSorted=!1;for(var a=this.getAttribute("position").scales,o=a.filter(function(k){return k.isCategory}),s=this.groupData(r),l=[],u=0,c=s.length;u<c;u++){for(var f=s[u],d=[],v=0,g=f.length;v<g;v++){var x=f[v],w={};for(var S in x)w[S]=x[S];w[Oa]=x;try{for(var A=(n=void 0,mi(o)),M=A.next();!M.done;M=A.next()){var R=M.value,O=R.field;w[O]=R.translate(w[O])}}catch(k){n={error:k}}finally{try{M&&!M.done&&(i=A.return)&&i.call(A)}finally{if(n)throw n.error}}d.push(w)}l.push(d)}var N=this.adjustData(l);return this.beforeMappingData=N,N},t.prototype.adjustData=function(r){var n=this.adjustOption,i=this,a=i.intervalPadding,o=i.dodgePadding,s=i.theme,l=this.maxColumnWidth||s.maxColumnWidth,u=this.minColumnWidth||s.minColumnWidth,c=this.columnWidthRatio||s.columnWidthRatio,f=r;if(n){var d=this.getXScale(),v=this.getYScale(),g=d.field,x=v?v.field:null,w=KS(this.coordinate),S=d.values.length,A=this.getAttribute("size"),M=void 0;A&&(M=A.values[0]);for(var R=0,O=n.length;R<O;R++){var N=n[R],k=U({xField:g,yField:x,intervalPadding:a,dodgePadding:o,xDimensionLength:w,groupNum:S,defaultSize:M,maxColumnWidth:l,minColumnWidth:u,columnWidthRatio:c},N),V=N.type;if(V==="dodge"){var Q=[];if(d.isCategory||d.type==="identity")Q.push("x");else if(!v)Q.push("y");else throw new Error("dodge is not support linear attribute, please use category attribute!");k.adjustNames=Q,k.dodgeRatio=c}else if(V==="stack"){var Y=this.coordinate;if(!v){k.height=Y.getHeight();var X=this.getDefaultValue("size")||3;k.size=X}!Y.isTransposed&&ke(k.reverseOrder)&&(k.reverseOrder=!0)}var tt=cst(V);k.dimValuesMap={},d&&d.values&&(k.dimValuesMap[d.field]=d.values.map(function(Et){return d.translate(Et)}));var it=new tt(k);f=it.process(f),this.adjusts[V]=it}}return f},t.prototype.groupData=function(r){for(var n=this.getGroupScales(),i=this.scaleDefs,a={},o=[],s=0;s<n.length;s++){var l=n[s],u=l.field;o.push(u),xt(i,[u,"values"])&&(a[u]=i[u].values)}return B_e(r,o,a)},t.prototype.updateStackRange=function(r,n){for(var i=Nh(n),a=r.field,o=r.min,s=r.max,l=0;l<i.length;l++){var u=i[l],c=Math.min.apply(null,u[a]),f=Math.max.apply(null,u[a]);c<o&&(o=c),f>s&&(s=f)}var d=this.scaleDefs,v={};o<r.min&&!xt(d,[a,"min"])&&(v.min=o),s>r.max&&!xt(d,[a,"max"])&&(v.max=s),r.change(v)},t.prototype.beforeMapping=function(r){var n=r;if(this.sortable&&this.sort(n),this.generatePoints)for(var i=0,a=n.length;i<a;i++){var o=n[i];this.generateShapePoints(o);var s=n[i+1];s&&(this.generateShapePoints(s),o[0].nextPoints=s[0].points)}return n},t.prototype.generateShapePoints=function(r){for(var n=this.getShapeFactory(),i=this.getAttribute("shape"),a=0;a<r.length;a++){var o=r[a],s=this.createShapePointsCfg(o),l=i?this.getAttributeValues(i,o):null,u=n.getShapePoints(l,s);o.points=u}},t.prototype.normalizeValues=function(r,n){var i=[];if(ze(r))for(var a=0;a<r.length;a++){var o=r[a];i.push(n.scale(o))}else i=n.scale(r);return i},t.prototype.mapping=function(r){for(var n=this.attributes,i=[],a=0;a<r.length;a++){var o=r[a],s={_origin:o[Oa],points:o.points,nextPoints:o.nextPoints};for(var l in n)if(n.hasOwnProperty(l)){var u=n[l],c=u.names,f=this.getAttributeValues(u,o);if(c.length>1)for(var d=0;d<f.length;d+=1){var v=f[d],g=c[d];s[g]=ze(v)&&v.length===1?v[0]:v}else s[c[0]]=f.length===1?f[0]:f}this.convertPoint(s),i.push(s)}return i},t.prototype.convertPoint=function(r){var n=r.x,i=r.y,a,o,s,l=this.coordinate;if(ze(n)&&ze(i)){a=[],o=[];for(var u=0,c=0,f=n.length,d=i.length;u<f&&c<d;u+=1,c+=1)s=l.convert({x:n[u],y:i[c]}),a.push(s.x),o.push(s.y)}else if(ze(i)){o=[];for(var v=0;v<i.length;v++){var g=i[v];s=l.convert({x:n,y:g}),a&&a!==s.x?(ze(a)||(a=[a]),a.push(s.x)):a=s.x,o.push(s.y)}}else if(ze(n)){a=[];for(var v=0;v<n.length;v++){var x=n[v];s=l.convert({x,y:i}),o&&o!==s.y?(ze(o)||(o=[o]),o.push(s.y)):o=s.y,a.push(s.x)}}else{var w=l.convert({x:n,y:i});a=w.x,o=w.y}r.x=a,r.y=o},t.prototype.getStyleCfg=function(r,n){var i=r.fields,a=i===void 0?[]:i,o=r.callback,s=r.cfg;if(s)return s;var l=a.map(function(u){return n[u]});return o.apply(void 0,an([],Lr(l),!1))},t.prototype.setCfg=function(r){var n=this,i=r.coordinate,a=r.data,o=r.theme,s=r.scaleDefs;i&&(this.coordinate=i),a&&(this.data=a),s&&(this.scaleDefs=s,this.idFields=[],ft(s,function(l,u){l&&l.key&&n.idFields.push(u)})),o&&(this.theme=this.userTheme?Tr({},o,this.userTheme):o)},t.prototype.renderLabels=function(r,n){return n===void 0&&(n=!1),au(this,void 0,void 0,function(){var i,a,o,s,l,u,c,f,d,v,g,x,w=this;return Lh(this,function(S){switch(S.label){case 0:return i=this.geometryLabel,this.emit(zm.BEFORE_RENDER_LABEL),i||(a=this.getLabelType(),o=O_e(a),i=new o(this),this.geometryLabel=i),[4,i.render(r,n)];case 1:S.sent(),s=i.labelsRenderer.shapesMap,l=new Map,ft(s,function(A,M){for(var R=A.getChildren()||[],O=0;O<R.length;O++){var N=R[O],k=w.elementsMap[N.get("elementId")||M.split(" ")[0]];if(k){N.cfg.name=["element","label"],N.cfg.element=k;var V=l.get(k)||new Set;V.add(A),l.set(k,V)}}});try{for(u=mi(l.entries()),c=u.next();!c.done;c=u.next())f=Lr(c.value,2),d=f[0],v=f[1],d.labelShape=an([],Lr(v),!1)}catch(A){g={error:A}}finally{try{c&&!c.done&&(x=u.return)&&x.call(u)}finally{if(g)throw g.error}}return this.emit(zm.AFTER_RENDER_LABEL),[2]}})})},t.prototype.canDoGroupAnimation=function(r){return!r&&this.animateOption&&(xt(this.animateOption,"appear")===void 0||xt(this.animateOption,"appear")&&xt(this.animateOption,["appear","animation"])===void 0)},t}(t6),V3=Vs;function t2(e,t,r){var n=V3(e.getMatrix(),[["t",t,r]]);e.setMatrix(n)}function N_e(e,t){var r=e.attr(),n=r.x,i=r.y,a=V3(e.getMatrix(),[["t",-n,-i],["r",t],["t",n,i]]);return a}function w6(e,t){var r=N_e(e,t);e.setMatrix(r)}function k_e(e,t){var r=e.getBBox(),n=(r.minX+r.maxX)/2,i=(r.minY+r.maxY)/2;e.applyToMatrix([n,i,1]);var a=V3(e.getMatrix(),[["t",-n,-i],["s",t,t],["t",n,i]]);e.setMatrix(a)}function o0(e){return e.find(function(t){return t.get("type")==="text"})}function Nlt(e,t,r){r===void 0&&(r=[0,0,0,0]);var n=e&&e.getChildren()[0];if(n){var i=n.clone();t!=null&&t.rotate&&w6(i,-t.rotate);var a=i.getCanvasBBox(),o=a.x,s=a.y,l=a.width,u=a.height;i.destroy();var c=r;return ke(c)?c=[2,2,2,2]:Gn(c)&&(c=new Array(4).fill(c)),{x:o-c[3],y:s-c[0],width:l+c[1]+c[3],height:u+c[0]+c[2],rotation:(t==null?void 0:t.rotate)||0}}return{x:0,y:0,width:0,height:0,rotation:0}}function z_e(e,t,r){r===void 0&&(r=0);var n=Math.max(0,Math.min(e.x+e.width+r,t.x+t.width+r)-Math.max(e.x-r,t.x-r)),i=Math.max(0,Math.min(e.y+e.height+r,t.y+t.height+r)-Math.max(e.y-r,t.y-r));return n*i}function U_e(e,t){var r=e.getBBox();return xI(t,function(n){var i=n.getBBox();return z_e(r,i,2)>0})}function klt(e,t,r){var n=r.data,i=r.origin,a=r.animateCfg,o=r.coordinate,s=xt(a,"update");e.set("data",n),e.set("origin",i),e.set("animateCfg",a),e.set("coordinate",o),e.set("visible",t.get("visible")),(e.getChildren()||[]).forEach(function(l,u){var c=t.getChildByIndex(u);if(!c)e.removeChild(l),l.remove(!0);else{l.set("data",n),l.set("origin",i),l.set("animateCfg",a),l.set("coordinate",o);var f=rlt(l,c);s?Cx(l,s,{toAttrs:f,coordinate:o}):l.attr(f),c.isGroup()&&klt(l,c,r)}}),ft(t.getChildren(),function(l,u){ze(e.getChildren())&&u>=e.getCount()&&(l.destroyed||e.add(l))})}var $_e=function(){function e(t){this.shapesMap={};var r=t.layout,n=t.container;this.layout=r,this.container=n}return e.prototype.render=function(t,r,n){return n===void 0&&(n=!1),au(this,void 0,void 0,function(){var i,a,o,s,l,u,c,f,d=this;return Lh(this,function(v){switch(v.label){case 0:if(i={},a=this.createOffscreenGroup(),!t.length)return[3,2];try{for(o=mi(t),s=o.next();!s.done;s=o.next())l=s.value,l&&(i[l.id]=this.renderLabel(l,a))}catch(g){c={error:g}}finally{try{s&&!s.done&&(f=o.return)&&f.call(o)}finally{if(c)throw c.error}}return[4,this.doLayout(t,r,i)];case 1:v.sent(),this.renderLabelLine(t,i),this.renderLabelBackground(t,i),this.adjustLabel(t,i),v.label=2;case 2:return u=this.shapesMap,ft(i,function(g,x){if(g.destroyed)delete i[x];else{if(u[x]){var w=g.get("data"),S=g.get("origin"),A=g.get("coordinate"),M=g.get("animateCfg"),R=u[x];klt(R,i[x],{data:w,origin:S,animateCfg:M,coordinate:A}),i[x]=R}else{if(d.container.destroyed)return;d.container.add(g);var O=xt(g.get("animateCfg"),n?"enter":"appear");O&&Cx(g,O,{toAttrs:U({},g.attr()),coordinate:g.get("coordinate")})}delete u[x]}}),ft(u,function(g){var x=xt(g.get("animateCfg"),"leave");x?Cx(g,x,{toAttrs:null,coordinate:g.get("coordinate")}):g.remove(!0)}),this.shapesMap=i,a.destroy(),[2]}})})},e.prototype.clear=function(){this.container.clear(),this.shapesMap={}},e.prototype.destroy=function(){this.container.destroy(),this.shapesMap=null},e.prototype.renderLabel=function(t,r){var n=t.id,i=t.elementId,a=t.data,o=t.mappingData,s=t.coordinate,l=t.animate,u=t.content,c=t.capture,f={id:n,elementId:i,capture:c,data:a,origin:U(U({},o),{data:o[Oa]}),coordinate:s},d=r.addGroup(U({name:"label",animateCfg:this.animate===!1||l===null||l===!1?!1:Tr({},this.animate,l)},f)),v;if(u.isGroup&&u.isGroup()||u.isShape&&u.isShape()){var g=u.getCanvasBBox(),x=g.width,w=g.height,S=xt(t,"textAlign","left"),A=t.x,M=t.y-w/2;S==="center"?A=A-x/2:(S==="right"||S==="end")&&(A=A-x),t2(u,A,M),v=u,d.add(u)}else{var R=xt(t,["style","fill"]);v=d.addShape("text",U({attrs:U(U({x:t.x,y:t.y,textAlign:t.textAlign,textBaseline:xt(t,"textBaseline","middle"),text:t.content},t.style),{fill:xUt(R)?t.color:R})},f))}return t.rotate&&w6(v,t.rotate),d},e.prototype.doLayout=function(t,r,n){return au(this,void 0,void 0,function(){var i,a=this;return Lh(this,function(o){switch(o.label){case 0:return this.layout?(i=ze(this.layout)?this.layout:[this.layout],[4,Promise.all(i.map(function(s){var l=P_e(xt(s,"type",""));if(l){var u=[],c=[];return ft(n,function(f,d){u.push(f),c.push(r[f.get("elementId")])}),l(t,u,c,a.region,s.cfg)}}))]):[3,2];case 1:o.sent(),o.label=2;case 2:return[2]}})})},e.prototype.renderLabelLine=function(t,r){ft(t,function(n){var i=xt(n,"coordinate");if(!(!n||!i)){var a=i.getCenter(),o=i.getRadius();if(n.labelLine){var s=xt(n,"labelLine",{}),l=n.id,u=s.path;if(!u){var c=Ls(a.x,a.y,o,n.angle);u=[["M",c.x,c.y],["L",n.x,n.y]]}var f=r[l];f.destroyed||f.addShape("path",{capture:!1,attrs:U({path:u,stroke:n.color?n.color:xt(n,["style","fill"],"#000"),fill:null},s.style),id:l,origin:n.mappingData,data:n.data,coordinate:n.coordinate})}}})},e.prototype.renderLabelBackground=function(t,r){ft(t,function(n){var i=xt(n,"coordinate"),a=xt(n,"background");if(!(!a||!i)){var o=n.id,s=r[o];if(!s.destroyed){var l=s.getChildren()[0];if(l){var u=Nlt(s,n,a.padding),c=u.rotation,f=hi(u,["rotation"]),d=s.addShape("rect",{attrs:U(U({},f),a.style||{}),id:o,origin:n.mappingData,data:n.data,coordinate:n.coordinate});if(d.setZIndex(-1),c){var v=l.getMatrix();d.setMatrix(v)}}}}})},e.prototype.createOffscreenGroup=function(){var t=this.container,r=t.getGroupBase(),n=new r({});return n},e.prototype.adjustLabel=function(t,r){ft(t,function(n){if(n){var i=n.id,a=r[i];if(!a.destroyed){var o=a.findAll(function(s){return s.get("type")!=="path"});ft(o,function(s){s&&(n.offsetX&&s.attr("x",s.attr("x")+n.offsetX),n.offsetY&&s.attr("y",s.attr("y")+n.offsetY))})}}})},e}();function Nj(e){var t=0;return ft(e,function(r){t+=r}),t/e.length}var G3=function(){function e(t){this.geometry=t}return e.prototype.getLabelItems=function(t){var r=this,n=[],i=this.getLabelCfgs(t);return ft(t,function(a,o){var s=i[o];if(!s||ke(a.x)||ke(a.y)){n.push(null);return}var l=ze(s.content)?s.content:[s.content];s.content=l;var u=l.length;ft(l,function(c,f){if(ke(c)||c===""){n.push(null);return}var d=U(U({},s),r.getLabelPoint(s,a,f));d.textAlign||(d.textAlign=r.getLabelAlign(d,f,u)),d.offset<=0&&(d.labelLine=null),n.push(d)})}),n},e.prototype.render=function(t,r){return r===void 0&&(r=!1),au(this,void 0,void 0,function(){var n,i,a;return Lh(this,function(o){switch(o.label){case 0:return n=this.getLabelItems(t),i=this.getLabelsRenderer(),a=this.getGeometryShapes(),[4,i.render(n,a,r)];case 1:return o.sent(),[2]}})})},e.prototype.clear=function(){var t=this.labelsRenderer;t&&t.clear()},e.prototype.destroy=function(){var t=this.labelsRenderer;t&&t.destroy(),this.labelsRenderer=null},e.prototype.getCoordinate=function(){return this.geometry.coordinate},e.prototype.getDefaultLabelCfg=function(t,r){var n=this.geometry,i=n.type,a=n.theme;return i==="polygon"||i==="interval"&&r==="middle"||t<0&&!["line","point","path"].includes(i)?xt(a,"innerLabels",{}):xt(a,"labels",{})},e.prototype.getThemedLabelCfg=function(t){var r=this.geometry,n=this.getDefaultLabelCfg(),i=r.type,a=r.theme,o;return i==="polygon"||t.offset<0&&!["line","point","path"].includes(i)?o=Tr({},n,a.innerLabels,t):o=Tr({},n,a.labels,t),o},e.prototype.setLabelPosition=function(t,r,n,i){},e.prototype.getLabelOffset=function(t){var r=this.getCoordinate(),n=this.getOffsetVector(t);return r.isTransposed?n[0]:n[1]},e.prototype.getLabelOffsetPoint=function(t,r,n){var i=t.offset,a=this.getCoordinate(),o=a.isTransposed,s=o?"x":"y",l=o?1:-1,u={x:0,y:0};return r>0||n===1?u[s]=i*l:u[s]=i*l*-1,u},e.prototype.getLabelPoint=function(t,r,n){var i=this.getCoordinate(),a=t.content.length;function o(w,S,A){A===void 0&&(A=!1);var M=w;return ze(M)&&(t.content.length===1?A?M=Nj(M):M.length<=2?M=M[w.length-1]:M=Nj(M):M=M[S]),M}var s={content:t.content[n],x:0,y:0,start:{x:0,y:0},color:"#fff"},l=ze(r.shape)?r.shape[0]:r.shape,u=l==="funnel"||l==="pyramid";if(this.geometry.type==="polygon"){var c=pye(r.x,r.y);s.x=c[0],s.y=c[1]}else this.geometry.type==="interval"&&!u?(s.x=o(r.x,n,!0),s.y=o(r.y,n)):(s.x=o(r.x,n),s.y=o(r.y,n));if(u){var f=xt(r,"nextPoints"),d=xt(r,"points");if(f){var v=i.convert(d[1]),g=i.convert(f[1]);s.x=(v.x+g.x)/2,s.y=(v.y+g.y)/2}else if(l==="pyramid"){var v=i.convert(d[1]),g=i.convert(d[2]);s.x=(v.x+g.x)/2,s.y=(v.y+g.y)/2}}t.position&&this.setLabelPosition(s,r,n,t.position);var x=this.getLabelOffsetPoint(t,n,a);return s.start={x:s.x,y:s.y},s.x+=x.x,s.y+=x.y,s.color=r.color,s},e.prototype.getLabelAlign=function(t,r,n){var i="center",a=this.getCoordinate();if(a.isTransposed){var o=t.offset;o<0?i="right":o===0?i="center":i="left",n>1&&r===0&&(i==="right"?i="left":i==="left"&&(i="right"))}return i},e.prototype.getLabelId=function(t){var r=this.geometry,n=r.type,i=r.getXScale(),a=r.getYScale(),o=t[Oa],s=r.getElementId(t);return n==="line"||n==="area"?s+=" ".concat(o[i.field]):n==="path"&&(s+=" ".concat(o[i.field],"-").concat(o[a.field])),s},e.prototype.getLabelsRenderer=function(){var t=this.geometry,r=t.labelsContainer,n=t.labelOption,i=t.canvasRegion,a=t.animateOption,o=this.geometry.coordinate,s=this.labelsRenderer;return s||(s=new $_e({container:r,layout:xt(n,["cfg","layout"],{type:this.defaultLayout})}),this.labelsRenderer=s),s.region=i,s.animate=a?Llt("label",o):!1,s},e.prototype.getLabelCfgs=function(t){var r=this,n=this.geometry,i=n.labelOption,a=n.scales,o=n.coordinate,s=i,l=s.fields,u=s.callback,c=s.cfg,f=l.map(function(v){return a[v]}),d=[];return ft(t,function(v,g){var x=v[Oa],w=r.getLabelText(x,f),S;if(u){var A=l.map(function(k){return x[k]});if(S=u.apply(void 0,an([],Lr(A),!1)),ke(S)){d.push(null);return}}var M=U(U({id:r.getLabelId(v),elementId:r.geometry.getElementId(v),data:x,mappingData:v,coordinate:o},c),S);$r(M.position)&&(M.position=M.position(x,v,g));var R=r.getLabelOffset(M.offset||0),O=r.getDefaultLabelCfg(R,M.position);M=Tr({},O,M),M.offset=r.getLabelOffset(M.offset||0);var N=M.content;$r(N)?M.content=N(x,v,g):iu(N)&&(M.content=w[0]),d.push(M)}),d},e.prototype.getLabelText=function(t,r){var n=[];return ft(r,function(i){var a=t[i.field];ze(a)?a=a.map(function(o){return i.getText(o)}):a=i.getText(a),ke(a)||a===""?n.push(null):n.push(a)}),n},e.prototype.getOffsetVector=function(t){t===void 0&&(t=0);var r=this.getCoordinate(),n=0;return Gn(t)&&(n=t),r.isTransposed?r.applyMatrix(n,0):r.applyMatrix(0,n)},e.prototype.getGeometryShapes=function(){var t=this.geometry,r={};return ft(t.elementsMap,function(n,i){r[i]=n.shape}),ft(t.getOffscreenGroup().getChildren(),function(n){var i=t.getElementId(n.get("origin").mappingData);r[i]=n}),r},e}();function ZB(e,t,r){if(!e)return r;var n;if(e.callback&&e.callback.length>1){var i=Array(e.callback.length-1).fill("");n=e.mapping.apply(e,an([t],Lr(i),!1)).join("")}else n=e.mapping(t).join("");return n||r}var p_={hexagon:function(e,t,r){var n=r/2*Math.sqrt(3);return[["M",e,t-r],["L",e+n,t-r/2],["L",e+n,t+r/2],["L",e,t+r],["L",e-n,t+r/2],["L",e-n,t-r/2],["Z"]]},bowtie:function(e,t,r){var n=r-1.5;return[["M",e-r,t-n],["L",e+r,t+n],["L",e+r,t-n],["L",e-r,t+n],["Z"]]},cross:function(e,t,r){return[["M",e-r,t-r],["L",e+r,t+r],["M",e+r,t-r],["L",e-r,t+r]]},tick:function(e,t,r){return[["M",e-r/2,t-r],["L",e+r/2,t-r],["M",e,t-r],["L",e,t+r],["M",e-r/2,t+r],["L",e+r/2,t+r]]},plus:function(e,t,r){return[["M",e-r,t],["L",e+r,t],["M",e,t-r],["L",e,t+r]]},hyphen:function(e,t,r){return[["M",e-r,t],["L",e+r,t]]},line:function(e,t,r){return[["M",e,t-r],["L",e,t+r]]}},H_e=["line","cross","tick","plus","hyphen"];function V_e(e,t){return $r(t)?t(e):Tr({},e,t)}function G_e(e,t){var r=e.symbol;if(nn(r)&&H_e.indexOf(r)!==-1){var n=xt(e,"style",{}),i=xt(n,"lineWidth",1),a=n.stroke||n.fill||t;e.style=Tr({},e.style,{lineWidth:i,stroke:a,fill:null})}}function zlt(e){var t=e.symbol;nn(t)&&p_[t]&&(e.symbol=p_[t])}function EP(e){return e.startsWith(xr.LEFT)||e.startsWith(xr.RIGHT)?"vertical":"horizontal"}function Ult(e,t,r,n,i){var a=r.getScale(r.type);if(a.isCategory){var o=a.field,s=t.getAttribute("color"),l=t.getAttribute("shape"),u=e.getTheme().defaultColor,c=t.coordinate.isPolar;return a.getTicks().map(function(f,d){var v,g=f.text,x=f.value,w=g,S=a.invert(x),A=e.filterFieldData(o,[(v={},v[o]=S,v)]).length===0;ft(e.views,function(k){var V;k.filterFieldData(o,[(V={},V[o]=S,V)]).length||(A=!0)});var M=ZB(s,S,u),R=ZB(l,S,"point"),O=t.getShapeMarker(R,{color:M,isInPolar:c}),N=i;return $r(N)&&(N=N(w,d,U({name:w,value:S},Tr({},n,O)))),O=Tr({},n,O,$c(U({},N),["style"])),G_e(O,M),N&&N.style&&(O.style=V_e(O.style,N.style)),zlt(O),{id:S,name:w,value:S,marker:O,unchecked:A}})}return[]}function W_e(e,t,r){return r.map(function(n,i){var a=t;$r(a)&&(a=a(n.name,i,Tr({},e,n)));var o=$r(n.marker)?n.marker(n.name,i,Tr({},e,n)):n.marker,s=Tr({},e,a,o);return zlt(s),n.marker=s,n})}function kj(e,t){var r=xt(e,["components","legend"],{});return Tr({},xt(r,["common"],{}),Tr({},xt(r,[t],{})))}function wP(e){return e?!1:e==null||isNaN(e)}function zj(e){if(ze(e))return wP(e[1].y);var t=e.y;return ze(t)?wP(t[0]):wP(t)}function W3(e,t,r){if(t===void 0&&(t=!1),r===void 0&&(r=!0),!e.length||e.length===1&&!r)return[];if(t){for(var n=[],i=0,a=e.length;i<a;i++){var o=e[i];zj(o)||n.push(o)}return[n]}for(var s=[],l=[],i=0,a=e.length;i<a;i++){var o=e[i];zj(o)?l.length&&(l.length===1&&!r||s.push(l),l=[]):l.push(o)}return l.length&&s.push(l),s}function $lt(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];if(n){var i=r===0?"M":"L";t.push([i,n.x,n.y])}}var a=e[0];return a&&(t.push(["L",a.x,a.y]),t.push(["z"])),t}function Hlt(e){for(var t=e.length/2,r=[],n=[],i=0;i<e.length;i++)i<t?r.push(e[i]):n.push(e[i]);var a=NR(r,!1),o=NR(n,!1);n.length&&a.push(["L",n[0].x,n[0].y]),o.shift();var s=a.concat(o);return r.length&&s.push(["L",r[0].x,r[0].y]),s.push(["z"]),s}function bs(e,t,r,n){n===void 0&&(n="");var i=e.style,a=i===void 0?{}:i,o=e.defaultStyle,s=e.color,l=e.size,u=U(U({},o),a);return s&&(t&&(a.stroke||(u.stroke=s)),r&&(a.fill||(u.fill=s))),n&&ke(a[n])&&!ke(l)&&(u[n]=l),u}function Vlt(e){return Tr({},{fill:"#CCD6EC",fillOpacity:.3},xt(e,["background","style"]))}function C6(e){var t=e.x,r=ze(e.y)?e.y:[e.y];return r.map(function(n,i){return{x:ze(t)?t[i]:t,y:n}})}var X_e={line:function(e,t,r){return[["M",e-r,t],["L",e+r,t]]},dot:function(e,t,r){return[["M",e-r,t],["L",e+r,t]]},dash:function(e,t,r){return[["M",e-r,t],["L",e+r,t]]},smooth:function(e,t,r){return[["M",e-r,t],["A",r/2,r/2,0,1,1,e,t],["A",r/2,r/2,0,1,0,e+r,t]]},hv:function(e,t,r){return[["M",e-r-1,t-2.5],["L",e,t-2.5],["L",e,t+2.5],["L",e+r+1,t+2.5]]},vh:function(e,t,r){return[["M",e-r-1,t+2.5],["L",e,t+2.5],["L",e,t-2.5],["L",e+r+1,t-2.5]]},hvh:function(e,t,r){return[["M",e-(r+1),t+2.5],["L",e-r/2,t+2.5],["L",e-r/2,t-2.5],["L",e+r/2,t-2.5],["L",e+r/2,t+2.5],["L",e+r+1,t+2.5]]},vhv:function(e,t){return[["M",e-5,t+2.5],["L",e-5,t],["L",e,t],["L",e,t-3],["L",e,t+3],["L",e+6.5,t+3]]}};function Glt(e,t){var r=e.color;return{symbol:X_e[t],style:{lineWidth:2,r:6,stroke:r}}}function j_e(e,t,r){for(var n=e.isStack,i=e.connectNulls,a=e.isInCircle,o=e.showSinglePoint,s=bs(e,!0,!1,"lineWidth"),l=W3(e.points,i,o),u=[],c=0,f=l.length;c<f;c++){var d=l[c];u=u.concat(Wlt(d,a,n,t,r,s))}return s.path=u,s}function qB(e,t,r,n,i){if(e.length===1)return[["M",e[0].x,e[0].y-i.lineWidth/2],["L",e[0].x,e[0].y],["L",e[0].x,e[0].y+i.lineWidth/2]];var a;return r?(t&&e.length&&e.push({x:e[0].x,y:e[0].y}),a=NR(e,!1,n)):(a=QS(e,!1),t&&a.push(["Z"])),a}function Y_e(e,t,r,n,i,a){var o=[],s=[];ft(e,function(c){var f=C6(c);o.push(f[1]),s.push(f[0])});var l=qB(o,t,n,i,a),u=qB(s,t,n,i,a);return r?l:l.concat(u)}function Wlt(e,t,r,n,i,a){if(e.length){var o=e[0];return ze(o.y)?Y_e(e,t,r,n,i,a):qB(e,t,n,i,a)}return[]}b0("line",{defaultShapeType:"line"});ft(["line","dot","dash","smooth"],function(e){ca("line",e,{draw:function(t,r){var n=e==="smooth",i;if(n){var a=this.coordinate,o=a.start,s=a.end;i=[[o.x,s.y],[s.x,o.y]]}var l=j_e(t,n,i),u=r.addShape({type:"path",attrs:l,name:"line",capture:!n});return u},getMarker:function(t){return Glt(t,e)}})});var eh={getLegendItems:Ult,translate:t2,rotate:w6,zoom:k_e,transform:V3,getAngle:tS,getSectorPath:$m,polarToCartesian:Ls,getDelegationObject:d_,getTooltipItems:y6,getMappingValue:ZB,getPath:Wlt,getPathPoints:W3},cm={100:"#000",95:"#0D0D0D",85:"#262626",65:"#595959",45:"#8C8C8C",25:"#BFBFBF",15:"#D9D9D9",6:"#F0F0F0"},La={100:"#FFFFFF",95:"#F2F2F2",85:"#D9D9D9",65:"#A6A6A6",45:"#737373",25:"#404040",15:"#262626",6:"#0F0F0F"},Ed=["#5B8FF9","#5AD8A6","#5D7092","#F6BD16","#E86452","#6DC8EC","#945FB9","#FF9845","#1E9493","#FF99C3"],Z_e=["#5B8FF9","#CDDDFD","#5AD8A6","#CDF3E4","#5D7092","#CED4DE","#F6BD16","#FCEBB9","#E86452","#F8D0CB","#6DC8EC","#D3EEF9","#945FB9","#DECFEA","#FF9845","#FFE0C7","#1E9493","#BBDEDE","#FF99C3","#FFE0ED"],q_e=["#B8E1FF","#9AC5FF","#7DAAFF","#5B8FF9","#3D76DD","#085EC0","#0047A5","#00318A","#001D70"],K_e=function(e){e===void 0&&(e={});var t=e.paletteQualitative10,r=t===void 0?Ed:t,n=e.paletteQualitative20,i=n===void 0?Z_e:n,a=e.brandColor,o=a===void 0?r[0]:a,s={backgroundColor:"#141414",brandColor:o,subColor:"rgba(255,255,255,0.05)",paletteQualitative10:r,paletteQualitative20:i,paletteSemanticRed:"#F4664A",paletteSemanticGreen:"#30BF78",paletteSemanticYellow:"#FAAD14",paletteSequence:q_e,fontFamily:`"Segoe UI", Roboto, "Helvetica Neue", Arial,
    "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol",
    "Noto Color Emoji"`,axisLineBorderColor:La[25],axisLineBorder:1,axisLineDash:null,axisTitleTextFillColor:La[65],axisTitleTextFontSize:12,axisTitleTextLineHeight:12,axisTitleTextFontWeight:"normal",axisTitleSpacing:12,axisDescriptionIconFillColor:cm[85],axisTickLineBorderColor:La[25],axisTickLineLength:4,axisTickLineBorder:1,axisSubTickLineBorderColor:La[15],axisSubTickLineLength:2,axisSubTickLineBorder:1,axisLabelFillColor:La[45],axisLabelFontSize:12,axisLabelLineHeight:12,axisLabelFontWeight:"normal",axisLabelOffset:8,axisGridBorderColor:La[15],axisGridBorder:1,axisGridLineDash:null,legendTitleTextFillColor:La[45],legendTitleTextFontSize:12,legendTitleTextLineHeight:21,legendTitleTextFontWeight:"normal",legendMarkerColor:Ed[0],legendMarkerSpacing:8,legendMarkerSize:4,legendCircleMarkerSize:4,legendSquareMarkerSize:4,legendLineMarkerSize:5,legendItemNameFillColor:La[65],legendItemNameFontSize:12,legendItemNameLineHeight:12,legendItemNameFontWeight:"normal",legendItemSpacing:24,legendItemMarginBottom:12,legendSpacing:16,legendPadding:[8,8,8,8],legendHorizontalPadding:[8,0,8,0],legendVerticalPadding:[0,8,0,8],legendPageNavigatorMarkerSize:12,legendPageNavigatorMarkerInactiveFillColor:La[45],legendPageNavigatorMarkerInactiveFillOpacity:.45,legendPageNavigatorMarkerFillColor:La[45],legendPageNavigatorMarkerFillOpacity:1,legendPageNavigatorTextFillColor:La[65],legendPageNavigatorTextFontSize:12,sliderRailFillColor:La[15],sliderRailBorder:0,sliderRailBorderColor:null,sliderRailWidth:100,sliderRailHeight:12,sliderLabelTextFillColor:La[45],sliderLabelTextFontSize:12,sliderLabelTextLineHeight:12,sliderLabelTextFontWeight:"normal",sliderHandlerFillColor:cm[6],sliderHandlerWidth:10,sliderHandlerHeight:14,sliderHandlerBorder:1,sliderHandlerBorderColor:cm[25],annotationArcBorderColor:La[15],annotationArcBorder:1,annotationLineBorderColor:La[25],annotationLineBorder:1,annotationLineDash:null,annotationTextFillColor:La[65],annotationTextFontSize:12,annotationTextLineHeight:12,annotationTextFontWeight:"normal",annotationTextBorderColor:null,annotationTextBorder:0,annotationRegionFillColor:La[100],annotationRegionFillOpacity:.06,annotationRegionBorder:0,annotationRegionBorderColor:null,annotationDataMarkerLineLength:16,tooltipCrosshairsBorderColor:La[25],tooltipCrosshairsBorder:1,tooltipCrosshairsLineDash:null,tooltipContainerFillColor:"#1f1f1f",tooltipContainerFillOpacity:.95,tooltipContainerShadow:"0px 2px 4px rgba(0,0,0,.5)",tooltipContainerBorderRadius:3,tooltipTextFillColor:La[65],tooltipTextFontSize:12,tooltipTextLineHeight:12,tooltipTextFontWeight:"bold",labelFillColor:La[65],labelFillColorDark:"#2c3542",labelFillColorLight:"#ffffff",labelFontSize:12,labelLineHeight:12,labelFontWeight:"normal",labelBorderColor:null,labelBorder:0,innerLabelFillColor:cm[100],innerLabelFontSize:12,innerLabelLineHeight:12,innerLabelFontWeight:"normal",innerLabelBorderColor:null,innerLabelBorder:0,overflowLabelFillColor:La[65],overflowLabelFillColorDark:"#2c3542",overflowLabelFillColorLight:"#ffffff",overflowLabelFontSize:12,overflowLabelLineHeight:12,overflowLabelFontWeight:"normal",overflowLabelBorderColor:cm[100],overflowLabelBorder:1,labelLineBorder:1,labelLineBorderColor:La[25],cSliderRailHieght:16,cSliderBackgroundFillColor:"#416180",cSliderBackgroundFillOpacity:.05,cSliderForegroundFillColor:"#5B8FF9",cSliderForegroundFillOpacity:.15,cSliderHandlerHeight:24,cSliderHandlerWidth:10,cSliderHandlerFillColor:"#F7F7F7",cSliderHandlerFillOpacity:1,cSliderHandlerHighlightFillColor:"#FFF",cSliderHandlerBorderColor:"#BFBFBF",cSliderHandlerBorder:1,cSliderHandlerBorderRadius:2,cSliderTextFillColor:"#fff",cSliderTextFillOpacity:.45,cSliderTextFontSize:12,cSliderTextLineHeight:12,cSliderTextFontWeight:"normal",cSliderTextBorderColor:null,cSliderTextBorder:0,scrollbarTrackFillColor:"rgba(255,255,255,0.65)",scrollbarThumbFillColor:"rgba(0,0,0,0.35)",scrollbarThumbHighlightFillColor:"rgba(0,0,0,0.45)",pointFillColor:Ed[0],pointFillOpacity:.95,pointSize:4,pointBorder:1,pointBorderColor:cm[100],pointBorderOpacity:1,pointActiveBorderColor:La[100],pointSelectedBorder:2,pointSelectedBorderColor:La[100],pointInactiveFillOpacity:.3,pointInactiveBorderOpacity:.3,hollowPointSize:4,hollowPointBorder:1,hollowPointBorderColor:Ed[0],hollowPointBorderOpacity:.95,hollowPointFillColor:cm[100],hollowPointActiveBorder:1,hollowPointActiveBorderColor:La[100],hollowPointActiveBorderOpacity:1,hollowPointSelectedBorder:2,hollowPointSelectedBorderColor:La[100],hollowPointSelectedBorderOpacity:1,hollowPointInactiveBorderOpacity:.3,lineBorder:2,lineBorderColor:Ed[0],lineBorderOpacity:1,lineActiveBorder:3,lineSelectedBorder:3,lineInactiveBorderOpacity:.3,areaFillColor:Ed[0],areaFillOpacity:.25,areaActiveFillColor:Ed[0],areaActiveFillOpacity:.5,areaSelectedFillColor:Ed[0],areaSelectedFillOpacity:.5,areaInactiveFillOpacity:.3,hollowAreaBorderColor:Ed[0],hollowAreaBorder:2,hollowAreaBorderOpacity:1,hollowAreaActiveBorder:3,hollowAreaActiveBorderColor:La[100],hollowAreaSelectedBorder:3,hollowAreaSelectedBorderColor:La[100],hollowAreaInactiveBorderOpacity:.3,intervalFillColor:Ed[0],intervalFillOpacity:.95,intervalActiveBorder:1,intervalActiveBorderColor:La[100],intervalActiveBorderOpacity:1,intervalSelectedBorder:2,intervalSelectedBorderColor:La[100],intervalSelectedBorderOpacity:1,intervalInactiveBorderOpacity:.3,intervalInactiveFillOpacity:.3,hollowIntervalBorder:2,hollowIntervalBorderColor:Ed[0],hollowIntervalBorderOpacity:1,hollowIntervalFillColor:cm[100],hollowIntervalActiveBorder:2,hollowIntervalActiveBorderColor:La[100],hollowIntervalSelectedBorder:3,hollowIntervalSelectedBorderColor:La[100],hollowIntervalSelectedBorderOpacity:1,hollowIntervalInactiveBorderOpacity:.3};return U(U({},s),e)},Q_e=K_e(),KB={rect:"path",circle:"circle",line:"line",path:"path",marker:"path",text:"text",polyline:"polyline",polygon:"polygon",image:"image",ellipse:"ellipse",dom:"foreignObject"},na={opacity:"opacity",fillStyle:"fill",fill:"fill",fillOpacity:"fill-opacity",strokeStyle:"stroke",strokeOpacity:"stroke-opacity",stroke:"stroke",x:"x",y:"y",r:"r",rx:"rx",ry:"ry",width:"width",height:"height",x1:"x1",x2:"x2",y1:"y1",y2:"y2",lineCap:"stroke-linecap",lineJoin:"stroke-linejoin",lineWidth:"stroke-width",lineDash:"stroke-dasharray",lineDashOffset:"stroke-dashoffset",miterLimit:"stroke-miterlimit",font:"font",fontSize:"font-size",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",fontFamily:"font-family",startArrow:"marker-start",endArrow:"marker-end",path:"d",class:"class",id:"id",style:"style",preserveAspectRatio:"preserveAspectRatio"};function Zf(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function Xlt(e){var t=KB[e.type],r=e.getParent();if(!t)throw new Error("the type "+e.type+" is not supported by svg");var n=Zf(t);if(e.get("id")&&(n.id=e.get("id")),e.set("el",n),e.set("attrs",{}),r){var i=r.get("el");i||(i=r.createDom(),r.set("el",i)),i.appendChild(n)}return n}function jlt(e,t){var r=e.get("el"),n=IUt(r.children).sort(t),i=document.createDocumentFragment();n.forEach(function(a){i.appendChild(a)}),r.appendChild(i)}function J_e(e,t){var r=e.parentNode,n=Array.from(r.childNodes).filter(function(s){return s.nodeType===1&&s.nodeName.toLowerCase()!=="defs"}),i=n[t],a=n.indexOf(e);if(i){if(a>t)r.insertBefore(e,i);else if(a<t){var o=n[t+1];o?r.insertBefore(e,o):r.appendChild(e)}}else r.appendChild(e)}function t1e(e,t){var r=e.cfg.el,n=e.attr(),i={dx:n.shadowOffsetX,dy:n.shadowOffsetY,blur:n.shadowBlur,color:n.shadowColor};if(!i.dx&&!i.dy&&!i.blur&&!i.color)r.removeAttribute("filter");else{var a=t.find("filter",i);a||(a=t.addShadow(i)),r.setAttribute("filter","url(#"+a+")")}}function e2(e){var t=e.attr().matrix;if(t){for(var r=e.cfg.el,n=[],i=0;i<9;i+=3)n.push(t[i]+","+t[i+1]);n=n.join(","),n.indexOf("NaN")===-1?r.setAttribute("transform","matrix("+n+")"):console.warn("invalid matrix:",t)}}function iS(e,t){var r=e.getClip(),n=e.get("el");if(!r)n.removeAttribute("clip-path");else if(r&&!n.hasAttribute("clip-path")){Xlt(r),r.createPath(t);var i=t.addClip(r);n.setAttribute("clip-path","url(#"+i+")")}}function Ylt(e,t){t.forEach(function(r){r.draw(e)})}function Zlt(e,t){var r=e.get("canvas");if(r&&r.get("autoDraw")){var n=r.get("context"),i=e.getParent(),a=i?i.getChildren():[r],o=e.get("el");if(t==="remove"){var s=e.get("isClipShape");if(s){var l=o&&o.parentNode,u=l&&l.parentNode;l&&u&&u.removeChild(l)}else o&&o.parentNode&&o.parentNode.removeChild(o)}else if(t==="show")o.setAttribute("visibility","visible");else if(t==="hide")o.setAttribute("visibility","hidden");else if(t==="zIndex")J_e(o,a.indexOf(e));else if(t==="sort"){var c=e.get("children");c&&c.length&&jlt(e,function(f,d){return c.indexOf(f)-c.indexOf(d)?1:0})}else t==="clear"?o&&(o.innerHTML=""):t==="matrix"?e2(e):t==="clip"?iS(e,n):t==="attr"||t==="add"&&e.draw(n)}}var S6=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.isEntityGroup=function(){return!0},t.prototype.createDom=function(){var r=Zf("g");this.set("el",r);var n=this.getParent();if(n){var i=n.get("el");i||(i=n.createDom(),n.set("el",i)),i.appendChild(r)}return r},t.prototype.afterAttrsChange=function(r){e.prototype.afterAttrsChange.call(this,r);var n=this.get("canvas");if(n&&n.get("autoDraw")){var i=n.get("context");this.createPath(i,r)}},t.prototype.onCanvasChange=function(r){Zlt(this,r)},t.prototype.getShapeBase=function(){return XR},t.prototype.getGroupBase=function(){return t},t.prototype.draw=function(r){var n=this.getChildren(),i=this.get("el");this.get("destroyed")?i&&i.parentNode.removeChild(i):(i||this.createDom(),iS(this,r),this.createPath(r),n.length&&Ylt(r,n))},t.prototype.createPath=function(r,n){var i=this.attr(),a=this.get("el");ft(n||i,function(o,s){na[s]&&a.setAttribute(na[s],o)}),e2(this)},t}(RI),ed=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="svg",r.canFill=!1,r.canStroke=!1,r}return t.prototype.getDefaultAttrs=function(){var r=e.prototype.getDefaultAttrs.call(this);return U(U({},r),{lineWidth:1,lineAppendWidth:0,strokeOpacity:1,fillOpacity:1})},t.prototype.afterAttrsChange=function(r){e.prototype.afterAttrsChange.call(this,r);var n=this.get("canvas");if(n&&n.get("autoDraw")){var i=n.get("context");this.draw(i,r)}},t.prototype.getShapeBase=function(){return XR},t.prototype.getGroupBase=function(){return S6},t.prototype.onCanvasChange=function(r){Zlt(this,r)},t.prototype.calculateBBox=function(){var r=this.get("el"),n=null;if(r)n=r.getBBox();else{var i=LI(this.get("type"));i&&(n=i(this))}if(n){var a=n.x,o=n.y,s=n.width,l=n.height,u=this.getHitLineWidth(),c=u/2,f=a-c,d=o-c,v=a+s+c,g=o+l+c;return{x:f,y:d,minX:f,minY:d,maxX:v,maxY:g,width:s+u,height:l+u}}return{x:0,y:0,minX:0,minY:0,maxX:0,maxY:0,width:0,height:0}},t.prototype.isFill=function(){var r=this.attr(),n=r.fill,i=r.fillStyle;return(n||i||this.isClipShape())&&this.canFill},t.prototype.isStroke=function(){var r=this.attr(),n=r.stroke,i=r.strokeStyle;return(n||i)&&this.canStroke},t.prototype.draw=function(r,n){var i=this.get("el");this.get("destroyed")?i&&i.parentNode.removeChild(i):(i||Xlt(this),iS(this,r),this.createPath(r,n),this.shadow(r,n),this.strokeAndFill(r,n),this.transform(n))},t.prototype.createPath=function(r,n){},t.prototype.strokeAndFill=function(r,n){var i=n||this.attr(),a=i.fill,o=i.fillStyle,s=i.stroke,l=i.strokeStyle,u=i.fillOpacity,c=i.strokeOpacity,f=i.lineWidth,d=this.get("el");this.canFill&&(n?"fill"in i?this._setColor(r,"fill",a):"fillStyle"in i&&this._setColor(r,"fill",o):this._setColor(r,"fill",a||o),u&&d.setAttribute(na.fillOpacity,u)),this.canStroke&&f>0&&(n?"stroke"in i?this._setColor(r,"stroke",s):"strokeStyle"in i&&this._setColor(r,"stroke",l):this._setColor(r,"stroke",s||l),c&&d.setAttribute(na.strokeOpacity,c),f&&d.setAttribute(na.lineWidth,f))},t.prototype._setColor=function(r,n,i){var a=this.get("el");if(!i){a.setAttribute(na[n],"none");return}if(i=i.trim(),/^[r,R,L,l]{1}[\s]*\(/.test(i)){var o=r.find("gradient",i);o||(o=r.addGradient(i)),a.setAttribute(na[n],"url(#"+o+")")}else if(/^[p,P]{1}[\s]*\(/.test(i)){var o=r.find("pattern",i);o||(o=r.addPattern(i)),a.setAttribute(na[n],"url(#"+o+")")}else a.setAttribute(na[n],i)},t.prototype.shadow=function(r,n){var i=this.attr(),a=n||i,o=a.shadowOffsetX,s=a.shadowOffsetY,l=a.shadowBlur,u=a.shadowColor;(o||s||l||u)&&t1e(this,r)},t.prototype.transform=function(r){var n=this.attr(),i=(r||n).matrix;i&&e2(this)},t.prototype.isInShape=function(r,n){return this.isPointInPath(r,n)},t.prototype.isPointInPath=function(r,n){var i=this.get("el"),a=this.get("canvas"),o=a.get("el").getBoundingClientRect(),s=r+o.left,l=n+o.top,u=document.elementFromPoint(s,l);return!!(u&&u.isEqualNode(i))},t.prototype.getHitLineWidth=function(){var r=this.attrs,n=r.lineWidth,i=r.lineAppendWidth;return this.isStroke()?n+i:0},t}(II),e1e=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="circle",r.canFill=!0,r.canStroke=!0,r}return t.prototype.getDefaultAttrs=function(){var r=e.prototype.getDefaultAttrs.call(this);return U(U({},r),{x:0,y:0,r:0})},t.prototype.createPath=function(r,n){var i=this.attr(),a=this.get("el");ft(n||i,function(o,s){s==="x"||s==="y"?a.setAttribute("c"+s,o):na[s]&&a.setAttribute(na[s],o)})},t}(ed),r1e=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="dom",r.canFill=!1,r.canStroke=!1,r}return t.prototype.createPath=function(r,n){var i=this.attr(),a=this.get("el");if(ft(n||i,function(u,c){na[c]&&a.setAttribute(na[c],u)}),typeof i.html=="function"){var o=i.html.call(this,i);if(o instanceof Element||o instanceof HTMLDocument){for(var s=a.childNodes,l=s.length-1;l>=0;l--)a.removeChild(s[l]);a.appendChild(o)}else a.innerHTML=o}else a.innerHTML=i.html},t}(ed),n1e=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="ellipse",r.canFill=!0,r.canStroke=!0,r}return t.prototype.getDefaultAttrs=function(){var r=e.prototype.getDefaultAttrs.call(this);return U(U({},r),{x:0,y:0,rx:0,ry:0})},t.prototype.createPath=function(r,n){var i=this.attr(),a=this.get("el");ft(n||i,function(o,s){s==="x"||s==="y"?a.setAttribute("c"+s,o):na[s]&&a.setAttribute(na[s],o)})},t}(ed),i1e=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="image",r.canFill=!1,r.canStroke=!1,r}return t.prototype.getDefaultAttrs=function(){var r=e.prototype.getDefaultAttrs.call(this);return U(U({},r),{x:0,y:0,width:0,height:0})},t.prototype.createPath=function(r,n){var i=this,a=this.attr(),o=this.get("el");ft(n||a,function(s,l){l==="img"?i._setImage(a.img):na[l]&&o.setAttribute(na[l],s)})},t.prototype.setAttr=function(r,n){this.attrs[r]=n,r==="img"&&this._setImage(n)},t.prototype._setImage=function(r){var n=this.attr(),i=this.get("el");if(nn(r))i.setAttribute("href",r);else if(r instanceof window.Image)n.width||(i.setAttribute("width",r.width),this.attr("width",r.width)),n.height||(i.setAttribute("height",r.height),this.attr("height",r.height)),i.setAttribute("href",r.src);else if(r instanceof HTMLElement&&nn(r.nodeName)&&r.nodeName.toUpperCase()==="CANVAS")i.setAttribute("href",r.toDataURL());else if(r instanceof ImageData){var a=document.createElement("canvas");a.setAttribute("width",""+r.width),a.setAttribute("height",""+r.height),a.getContext("2d").putImageData(r,0,0),n.width||(i.setAttribute("width",""+r.width),this.attr("width",r.width)),n.height||(i.setAttribute("height",""+r.height),this.attr("height",r.height)),i.setAttribute("href",a.toDataURL())}},t}(ed),a1e=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="line",r.canFill=!1,r.canStroke=!0,r}return t.prototype.getDefaultAttrs=function(){var r=e.prototype.getDefaultAttrs.call(this);return U(U({},r),{x1:0,y1:0,x2:0,y2:0,startArrow:!1,endArrow:!1})},t.prototype.createPath=function(r,n){var i=this.attr(),a=this.get("el");ft(n||i,function(o,s){if(s==="startArrow"||s==="endArrow")if(o){var l=qi(o)?r.addArrow(i,na[s]):r.getDefaultArrow(i,na[s]);a.setAttribute(na[s],"url(#"+l+")")}else a.removeAttribute(na[s]);else na[s]&&a.setAttribute(na[s],o)})},t.prototype.getTotalLength=function(){var r=this.attr(),n=r.x1,i=r.y1,a=r.x2,o=r.y2;return Hl.length(n,i,a,o)},t.prototype.getPoint=function(r){var n=this.attr(),i=n.x1,a=n.y1,o=n.x2,s=n.y2;return Hl.pointAt(i,a,o,s,r)},t}(ed),nA={circle:function(e,t,r){return[["M",e,t],["m",-r,0],["a",r,r,0,1,0,r*2,0],["a",r,r,0,1,0,-r*2,0]]},square:function(e,t,r){return[["M",e-r,t-r],["L",e+r,t-r],["L",e+r,t+r],["L",e-r,t+r],["Z"]]},diamond:function(e,t,r){return[["M",e-r,t],["L",e,t-r],["L",e+r,t],["L",e,t+r],["Z"]]},triangle:function(e,t,r){var n=r*Math.sin(.3333333333333333*Math.PI);return[["M",e-r,t+n],["L",e,t-n],["L",e+r,t+n],["z"]]},triangleDown:function(e,t,r){var n=r*Math.sin(.3333333333333333*Math.PI);return[["M",e-r,t-n],["L",e+r,t-n],["L",e,t+n],["Z"]]}};const Uj={get:function(e){return nA[e]},register:function(e,t){nA[e]=t},remove:function(e){delete nA[e]},getAll:function(){return nA}};var o1e=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="marker",r.canFill=!0,r.canStroke=!0,r}return t.prototype.createPath=function(r){var n=this.get("el");n.setAttribute("d",this._assembleMarker())},t.prototype._assembleMarker=function(){var r=this._getPath();return ze(r)?r.map(function(n){return n.join(" ")}).join(""):r},t.prototype._getPath=function(){var r=this.attr(),n=r.x,i=r.y,a=r.r||r.radius,o=r.symbol||"circle",s;return $r(o)?s=o:s=Uj.get(o),s?s(n,i,a):(console.warn(s+" symbol is not exist."),null)},t.symbolsFactory=Uj,t}(ed),s1e=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="path",r.canFill=!0,r.canStroke=!0,r}return t.prototype.getDefaultAttrs=function(){var r=e.prototype.getDefaultAttrs.call(this);return U(U({},r),{startArrow:!1,endArrow:!1})},t.prototype.createPath=function(r,n){var i=this,a=this.attr(),o=this.get("el");ft(n||a,function(s,l){if(l==="path"&&ze(s))o.setAttribute("d",i._formatPath(s));else if(l==="startArrow"||l==="endArrow")if(s){var u=qi(s)?r.addArrow(a,na[l]):r.getDefaultArrow(a,na[l]);o.setAttribute(na[l],"url(#"+u+")")}else o.removeAttribute(na[l]);else na[l]&&o.setAttribute(na[l],s)})},t.prototype._formatPath=function(r){var n=r.map(function(i){return i.join(" ")}).join("");return~n.indexOf("NaN")?"":n},t.prototype.getTotalLength=function(){var r=this.get("el");return r?r.getTotalLength():null},t.prototype.getPoint=function(r){var n=this.get("el"),i=this.getTotalLength();if(i===0)return null;var a=n?n.getPointAtLength(r*i):null;return a?{x:a.x,y:a.y}:null},t}(ed),l1e=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="polygon",r.canFill=!0,r.canStroke=!0,r}return t.prototype.createPath=function(r,n){var i=this.attr(),a=this.get("el");ft(n||i,function(o,s){s==="points"&&ze(o)&&o.length>=2?a.setAttribute("points",o.map(function(l){return l[0]+","+l[1]}).join(" ")):na[s]&&a.setAttribute(na[s],o)})},t}(ed),u1e=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="polyline",r.canFill=!0,r.canStroke=!0,r}return t.prototype.getDefaultAttrs=function(){var r=e.prototype.getDefaultAttrs.call(this);return U(U({},r),{startArrow:!1,endArrow:!1})},t.prototype.onAttrChange=function(r,n,i){e.prototype.onAttrChange.call(this,r,n,i),["points"].indexOf(r)!==-1&&this._resetCache()},t.prototype._resetCache=function(){this.set("totalLength",null),this.set("tCache",null)},t.prototype.createPath=function(r,n){var i=this.attr(),a=this.get("el");ft(n||i,function(o,s){s==="points"&&ze(o)&&o.length>=2?a.setAttribute("points",o.map(function(l){return l[0]+","+l[1]}).join(" ")):na[s]&&a.setAttribute(na[s],o)})},t.prototype.getTotalLength=function(){var r=this.attr().points,n=this.get("totalLength");return ke(n)?(this.set("totalLength",ret.length(r)),this.get("totalLength")):n},t.prototype.getPoint=function(r){var n=this.attr().points,i=this.get("tCache");i||(this._setTcache(),i=this.get("tCache"));var a,o;return ft(i,function(s,l){r>=s[0]&&r<=s[1]&&(a=(r-s[0])/(s[1]-s[0]),o=l)}),Hl.pointAt(n[o][0],n[o][1],n[o+1][0],n[o+1][1],a)},t.prototype._setTcache=function(){var r=this.attr().points;if(!(!r||r.length===0)){var n=this.getTotalLength();if(!(n<=0)){var i=0,a=[],o,s;ft(r,function(l,u){r[u+1]&&(o=[],o[0]=i/n,s=Hl.length(l[0],l[1],r[u+1][0],r[u+1][1]),i+=s,o[1]=i/n,a.push(o))}),this.set("tCache",a)}}},t.prototype.getStartTangent=function(){var r=this.attr().points,n=[];return n.push([r[1][0],r[1][1]]),n.push([r[0][0],r[0][1]]),n},t.prototype.getEndTangent=function(){var r=this.attr().points,n=r.length-1,i=[];return i.push([r[n-1][0],r[n-1][1]]),i.push([r[n][0],r[n][1]]),i},t}(ed);function c1e(e){var t=0,r=0,n=0,i=0;return ze(e)?e.length===1?t=r=n=i=e[0]:e.length===2?(t=n=e[0],r=i=e[1]):e.length===3?(t=e[0],r=i=e[1],n=e[2]):(t=e[0],r=e[1],n=e[2],i=e[3]):t=r=n=i=e,{r1:t,r2:r,r3:n,r4:i}}var h1e=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="rect",r.canFill=!0,r.canStroke=!0,r}return t.prototype.getDefaultAttrs=function(){var r=e.prototype.getDefaultAttrs.call(this);return U(U({},r),{x:0,y:0,width:0,height:0,radius:0})},t.prototype.createPath=function(r,n){var i=this,a=this.attr(),o=this.get("el"),s=!1,l=["x","y","width","height","radius"];ft(n||a,function(u,c){l.indexOf(c)!==-1&&!s?(o.setAttribute("d",i._assembleRect(a)),s=!0):l.indexOf(c)===-1&&na[c]&&o.setAttribute(na[c],u)})},t.prototype._assembleRect=function(r){var n=r.x,i=r.y,a=r.width,o=r.height,s=r.radius;if(!s)return"M "+n+","+i+" l "+a+",0 l 0,"+o+" l"+-a+" 0 z";var l=c1e(s);ze(s)?s.length===1?l.r1=l.r2=l.r3=l.r4=s[0]:s.length===2?(l.r1=l.r3=s[0],l.r2=l.r4=s[1]):s.length===3?(l.r1=s[0],l.r2=l.r4=s[1],l.r3=s[2]):(l.r1=s[0],l.r2=s[1],l.r3=s[2],l.r4=s[3]):l.r1=l.r2=l.r3=l.r4=s;var u=[["M "+(n+l.r1)+","+i],["l "+(a-l.r1-l.r2)+",0"],["a "+l.r2+","+l.r2+",0,0,1,"+l.r2+","+l.r2],["l 0,"+(o-l.r2-l.r3)],["a "+l.r3+","+l.r3+",0,0,1,"+-l.r3+","+l.r3],["l "+(l.r3+l.r4-a)+",0"],["a "+l.r4+","+l.r4+",0,0,1,"+-l.r4+","+-l.r4],["l 0,"+(l.r4+l.r1-o)],["a "+l.r1+","+l.r1+",0,0,1,"+l.r1+","+-l.r1],["z"]];return u.join(" ")},t}(ed),$j=.3,f1e={top:"before-edge",middle:"central",bottom:"after-edge",alphabetic:"baseline",hanging:"hanging"},d1e={top:"text-before-edge",middle:"central",bottom:"text-after-edge",alphabetic:"alphabetic",hanging:"hanging"},p1e={left:"left",start:"left",center:"middle",right:"end",end:"end"},v1e=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="text",r.canFill=!0,r.canStroke=!0,r}return t.prototype.getDefaultAttrs=function(){var r=e.prototype.getDefaultAttrs.call(this);return U(U({},r),{x:0,y:0,text:null,fontSize:12,fontFamily:"sans-serif",fontStyle:"normal",fontWeight:"normal",fontVariant:"normal",textAlign:"start",textBaseline:"bottom"})},t.prototype.createPath=function(r,n){var i=this,a=this.attr(),o=this.get("el");this._setFont(),ft(n||a,function(s,l){l==="text"?i._setText(""+s):l==="matrix"&&s?e2(i):na[l]&&o.setAttribute(na[l],s)}),o.setAttribute("paint-order","stroke"),o.setAttribute("style","stroke-linecap:butt; stroke-linejoin:miter;")},t.prototype._setFont=function(){var r=this.get("el"),n=this.attr(),i=n.textBaseline,a=n.textAlign,o=Itt();o&&o.name==="firefox"?r.setAttribute("dominant-baseline",d1e[i]||"alphabetic"):r.setAttribute("alignment-baseline",f1e[i]||"baseline"),r.setAttribute("text-anchor",p1e[a]||"left")},t.prototype._setText=function(r){var n=this.get("el"),i=this.attr(),a=i.x,o=i.textBaseline,s=o===void 0?"bottom":o;if(!r)n.innerHTML="";else if(~r.indexOf(`
`)){var l=r.split(`
`),u=l.length-1,c="";ft(l,function(f,d){d===0?s==="alphabetic"?c+='<tspan x="'+a+'" dy="'+-u+'em">'+f+"</tspan>":s==="top"?c+='<tspan x="'+a+'" dy="0.9em">'+f+"</tspan>":s==="middle"?c+='<tspan x="'+a+'" dy="'+-(u-1)/2+'em">'+f+"</tspan>":s==="bottom"?c+='<tspan x="'+a+'" dy="-'+(u+$j)+'em">'+f+"</tspan>":s==="hanging"&&(c+='<tspan x="'+a+'" dy="'+(-(u-1)-$j)+'em">'+f+"</tspan>"):c+='<tspan x="'+a+'" dy="1em">'+f+"</tspan>"}),n.innerHTML=c}else n.innerHTML=r},t}(ed),g1e=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,m1e=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,y1e=/[\d.]+:(#[^\s]+|[^)]+\))/gi;function qlt(e){var t=e.match(y1e);if(!t)return"";var r="";return t.sort(function(n,i){return n=n.split(":"),i=i.split(":"),Number(n[0])-Number(i[0])}),ft(t,function(n){n=n.split(":"),r+='<stop offset="'+n[0]+'" stop-color="'+n[1]+'"></stop>'}),r}function _1e(e,t){var r=g1e.exec(e),n=bI(EI(parseFloat(r[1])),Math.PI*2),i=r[2],a,o;n>=0&&n<.5*Math.PI?(a={x:0,y:0},o={x:1,y:1}):.5*Math.PI<=n&&n<Math.PI?(a={x:1,y:0},o={x:0,y:1}):Math.PI<=n&&n<1.5*Math.PI?(a={x:1,y:1},o={x:0,y:0}):(a={x:0,y:1},o={x:1,y:0});var s=Math.tan(n),l=s*s,u=(o.x-a.x+s*(o.y-a.y))/(l+1)+a.x,c=s*(o.x-a.x+s*(o.y-a.y))/(l+1)+a.y;t.setAttribute("x1",a.x),t.setAttribute("y1",a.y),t.setAttribute("x2",u),t.setAttribute("y2",c),t.innerHTML=qlt(i)}function x1e(e,t){var r=m1e.exec(e),n=parseFloat(r[1]),i=parseFloat(r[2]),a=parseFloat(r[3]),o=r[4];t.setAttribute("cx",n),t.setAttribute("cy",i),t.setAttribute("r",a),t.innerHTML=qlt(o)}var b1e=function(){function e(t){this.cfg={};var r=null,n=Gh("gradient_");return t.toLowerCase()[0]==="l"?(r=Zf("linearGradient"),_1e(t,r)):(r=Zf("radialGradient"),x1e(t,r)),r.setAttribute("id",n),this.el=r,this.id=n,this.cfg=t,this}return e.prototype.match=function(t,r){return this.cfg===r},e}(),E1e={shadowColor:"color",shadowOpacity:"opacity",shadowBlur:"blur",shadowOffsetX:"dx",shadowOffsetY:"dy"},w1e={x:"-40%",y:"-40%",width:"200%",height:"200%"},C1e=function(){function e(t){this.type="filter",this.cfg={},this.type="filter";var r=Zf("filter");return ft(w1e,function(n,i){r.setAttribute(i,n)}),this.el=r,this.id=Gh("filter_"),this.el.id=this.id,this.cfg=t,this._parseShadow(t,r),this}return e.prototype.match=function(t,r){if(this.type!==t)return!1;var n=!0,i=this.cfg;return ft(Object.keys(i),function(a){if(i[a]!==r[a])return n=!1,!1}),n},e.prototype.update=function(t,r){var n=this.cfg;return n[E1e[t]]=r,this._parseShadow(n,this.el),this},e.prototype._parseShadow=function(t,r){var n=`<feDropShadow
      dx="`+(t.dx||0)+`"
      dy="`+(t.dy||0)+`"
      stdDeviation="`+(t.blur?t.blur/10:0)+`"
      flood-color="`+(t.color?t.color:"#000")+`"
      flood-opacity="`+(t.opacity?t.opacity:1)+`"
      />`;r.innerHTML=n},e}(),Hj=function(){function e(t,r){this.cfg={};var n=Zf("marker"),i=Gh("marker_");n.setAttribute("id",i);var a=Zf("path");a.setAttribute("stroke",t.stroke||"none"),a.setAttribute("fill",t.fill||"none"),n.appendChild(a),n.setAttribute("overflow","visible"),n.setAttribute("orient","auto-start-reverse"),this.el=n,this.child=a,this.id=i;var o=t[r==="marker-start"?"startArrow":"endArrow"];return this.stroke=t.stroke||"#000",o===!0?this._setDefaultPath(r,a):(this.cfg=o,this._setMarker(t.lineWidth,a)),this}return e.prototype.match=function(){return!1},e.prototype._setDefaultPath=function(t,r){var n=this.el;r.setAttribute("d","M0,0 L"+10*Math.cos(Math.PI/6)+",5 L0,10"),n.setAttribute("refX",""+10*Math.cos(Math.PI/6)),n.setAttribute("refY","5")},e.prototype._setMarker=function(t,r){var n=this.el,i=this.cfg.path,a=this.cfg.d;ze(i)&&(i=i.map(function(o){return o.join(" ")}).join("")),r.setAttribute("d",i),n.appendChild(r),a&&n.setAttribute("refX",""+a/t)},e.prototype.update=function(t){var r=this.child;r.attr?r.attr("fill",t):r.setAttribute("fill",t)},e}(),S1e=function(){function e(t){this.type="clip",this.cfg={};var r=Zf("clipPath");this.el=r,this.id=Gh("clip_"),r.id=this.id;var n=t.cfg.el;return r.appendChild(n),this.cfg=t,this}return e.prototype.match=function(){return!1},e.prototype.remove=function(){var t=this.el;t.parentNode.removeChild(t)},e}(),T1e=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,A1e=function(){function e(t){this.cfg={};var r=Zf("pattern");r.setAttribute("patternUnits","userSpaceOnUse");var n=Zf("image");r.appendChild(n);var i=Gh("pattern_");r.id=i,this.el=r,this.id=i,this.cfg=t;var a=T1e.exec(t),o=a[2];n.setAttribute("href",o);var s=new Image;o.match(/^data:/i)||(s.crossOrigin="Anonymous"),s.src=o;function l(){r.setAttribute("width",""+s.width),r.setAttribute("height",""+s.height)}return s.complete?l():(s.onload=l,s.src=s.src),this}return e.prototype.match=function(t,r){return this.cfg===r},e}(),M1e=function(){function e(t){var r=Zf("defs"),n=Gh("defs_");r.id=n,t.appendChild(r),this.children=[],this.defaultArrow={},this.el=r,this.canvas=t}return e.prototype.find=function(t,r){for(var n=this.children,i=null,a=0;a<n.length;a++)if(n[a].match(t,r)){i=n[a].id;break}return i},e.prototype.findById=function(t){for(var r=this.children,n=null,i=0;i<r.length;i++)if(r[i].id===t){n=r[i];break}return n},e.prototype.add=function(t){this.children.push(t),t.canvas=this.canvas,t.parent=this},e.prototype.getDefaultArrow=function(t,r){var n=t.stroke||t.strokeStyle;if(this.defaultArrow[n])return this.defaultArrow[n].id;var i=new Hj(t,r);return this.defaultArrow[n]=i,this.el.appendChild(i.el),this.add(i),i.id},e.prototype.addGradient=function(t){var r=new b1e(t);return this.el.appendChild(r.el),this.add(r),r.id},e.prototype.addArrow=function(t,r){var n=new Hj(t,r);return this.el.appendChild(n.el),this.add(n),n.id},e.prototype.addShadow=function(t){var r=new C1e(t);return this.el.appendChild(r.el),this.add(r),r.id},e.prototype.addPattern=function(t){var r=new A1e(t);return this.el.appendChild(r.el),this.add(r),r.id},e.prototype.addClip=function(t){var r=new S1e(t);return this.el.appendChild(r.el),this.add(r),r.id},e}(),R1e=function(e){Ut(t,e);function t(r){return e.call(this,U(U({},r),{autoDraw:!0,renderer:"svg"}))||this}return t.prototype.getShapeBase=function(){return XR},t.prototype.getGroupBase=function(){return S6},t.prototype.getShape=function(r,n,i){var a=i.target||i.srcElement;if(!KB[a.tagName]){for(var o=a.parentNode;o&&!KB[o.tagName];)o=o.parentNode;a=o}return this.find(function(s){return s.get("el")===a})},t.prototype.createDom=function(){var r=Zf("svg"),n=new M1e(r);return r.setAttribute("width",""+this.get("width")),r.setAttribute("height",""+this.get("height")),this.set("context",n),r},t.prototype.onCanvasChange=function(r){var n=this.get("context"),i=this.get("el");if(r==="sort"){var a=this.get("children");a&&a.length&&jlt(this,function(s,l){return a.indexOf(s)-a.indexOf(l)?1:0})}else if(r==="clear"){if(i){i.innerHTML="";var o=n.el;o.innerHTML="",i.appendChild(o)}}else r==="matrix"?e2(this):r==="clip"?iS(this,n):r==="changeSize"&&(i.setAttribute("width",""+this.get("width")),i.setAttribute("height",""+this.get("height")))},t.prototype.draw=function(){var r=this.get("context"),n=this.getChildren();iS(this,r),n.length&&Ylt(r,n)},t}(MI),I1e="0.5.6";const L1e=Object.freeze(Object.defineProperty({__proto__:null,AbstractCanvas:MI,AbstractGroup:RI,AbstractShape:II,Base:SI,Canvas:R1e,Event:IS,Group:S6,PathUtil:B4,Shape:XR,assembleFont:FI,getBBoxMethod:LI,getOffScreenContext:PI,getTextHeight:DI,invert:TI,isAllowCapture:bC,multiplyVec2:Zv,registerBBox:Jf,registerEasing:jtt,version:I1e},Symbol.toStringTag,{value:"Module"}));var T6=function(e){Ut(t,e);function t(r){var n=e.call(this,r)||this;n.type="path",n.shapeType="line";var i=r.connectNulls,a=i===void 0?!1:i,o=r.showSinglePoint,s=o===void 0?!0:o;return n.connectNulls=a,n.showSinglePoint=s,n}return t.prototype.updateElements=function(r,n){var i,a,o,s,l,u;n===void 0&&(n=!1);for(var c=new Map,f=new Map,d=[],v=0,g=0;g<r.length;g++){var x=r[g],w=this.getElementId(x);d.push(w),c.set(w,x),f.set(w,v),v++}this.elements=new Array(v);var S=Blt(this.lastElementsMap,d),A=S.added,M=S.updated,R=S.removed;try{for(var O=mi(A),N=O.next();!N.done;N=O.next()){var w=N.value,x=c.get(w),k=this.getShapeFactory(),V=this.getShapeInfo(x),g=f.get(w),Q=new Olt({shapeFactory:k,container:this.container,offscreenGroup:this.getOffscreenGroup(),elementIndex:g});Q.geometry=this,Q.animate=this.animateOption,Q.draw(V,n),this.elementsMap[w]=Q,this.elements[g]=Q}}catch(Tt){i={error:Tt}}finally{try{N&&!N.done&&(a=O.return)&&a.call(O)}finally{if(i)throw i.error}}try{for(var Y=mi(M),X=Y.next();!X.done;X=Y.next()){var w=X.value,x=c.get(w),Q=this.lastElementsMap[w],g=f.get(w),V=this.getShapeInfo(x),tt=Q.getModel();(this.isCoordinateChanged||Flt(tt,V))&&(Q.animate=this.animateOption,Q.update(V)),this.elementsMap[w]=Q,this.elements[g]=Q}}catch(Tt){o={error:Tt}}finally{try{X&&!X.done&&(s=Y.return)&&s.call(Y)}finally{if(o)throw o.error}}try{for(var it=mi(R),Et=it.next();!Et.done;Et=it.next()){var w=Et.value,Q=this.lastElementsMap[w];Q.animate=this.animateOption,Q.destroy()}}catch(Tt){l={error:Tt}}finally{try{Et&&!Et.done&&(u=it.return)&&u.call(it)}finally{if(l)throw l.error}}},t.prototype.getPointsAndData=function(r){for(var n=[],i=[],a=0,o=r.length;a<o;a++){var s=r[a];n.push({x:s.x,y:s.y}),i.push(s[Oa])}return{points:n,data:i}},t.prototype.getShapeInfo=function(r){var n=this.getDrawCfg(r[0]),i=this.getPointsAndData(r),a=i.points,o=i.data;return n.mappingData=r,n.data=o,n.isStack=!!this.getAdjust("stack"),n.points=a,n.connectNulls=this.connectNulls,n.showSinglePoint=this.showSinglePoint,n},t}(E0);function O1e(e,t,r,n,i){var a=[];if(e.length){for(var o=[],s=[],l=0,u=e.length;l<u;l++){var c=e[l];o.push(c[1]),s.push(c[0])}s=s.reverse(),ft([o,s],function(f,d){var v=[],g=n.parsePoints(f),x=g[0];o.length===1&&s.length===1?v=d===0?[["M",x.x-.5,x.y],["L",x.x+.5,x.y]]:[["L",x.x+.5,x.y],["L",x.x-.5,x.y]]:(t&&g.push({x:x.x,y:x.y}),r?v=NR(g,!1,i):v=QS(g,!1),d>0&&(v[0][0]="L")),a=a.concat(v)}),a.push(["Z"])}return a}function X3(e,t,r,n,i){for(var a=bs(e,t,!t,"lineWidth"),o=e.connectNulls,s=e.isInCircle,l=e.points,u=e.showSinglePoint,c=W3(l,o,u),f=[],d=0,v=c.length;d<v;d++){var g=c[d];f=f.concat(O1e(g,s,r,n,i))}return a.path=f,a}function Klt(e){var t=e.start,r=e.end;return[[t.x,r.y],[r.x,t.y]]}b0("area",{defaultShapeType:"area",getDefaultPoints:function(e){var t=e.x,r=e.y0,n=ze(e.y)?e.y:[r,e.y];return n.map(function(i){return{x:t,y:i}})}});ca("area","area",{draw:function(e,t){var r=X3(e,!1,!1,this),n=t.addShape({type:"path",attrs:r,name:"area"});return n},getMarker:function(e){var t=e.color;return{symbol:function(r,n,i){return i===void 0&&(i=5.5),[["M",r-i,n-4],["L",r+i,n-4],["L",r+i,n+4],["L",r-i,n+4],["Z"]]},style:{r:5,fill:t,fillOpacity:1}}}});var P1e=function(e){Ut(t,e);function t(r){var n=e.call(this,r)||this;n.type="area",n.shapeType="area",n.generatePoints=!0,n.startOnZero=!0;var i=r.startOnZero,a=i===void 0?!0:i,o=r.sortable,s=o===void 0?!1:o,l=r.showSinglePoint,u=l===void 0?!1:l;return n.startOnZero=a,n.sortable=s,n.showSinglePoint=u,n}return t.prototype.getPointsAndData=function(r){for(var n=[],i=[],a=0,o=r.length;a<o;a++){var s=r[a];n.push(s.points),i.push(s[Oa])}return{points:n,data:i}},t.prototype.getYMinValue=function(){if(this.startOnZero)return e.prototype.getYMinValue.call(this);var r=this.getYScale();return r.min},t}(T6);b0("edge",{defaultShapeType:"line",getDefaultPoints:function(e){return C6(e)}});ca("edge","line",{draw:function(e,t){var r=bs(e,!0,!1,"lineWidth"),n=QS(this.parsePoints(e.points),this.coordinate.isPolar);return t.addShape("path",{attrs:U(U({},r),{path:n})})},getMarker:function(e){return{symbol:"circle",style:{r:4.5,fill:e.color}}}});var D1e=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="edge",r.shapeType="edge",r.generatePoints=!0,r}return t}(E0),F1e=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="heatmap",r.paletteCache={},r}return t.prototype.updateElements=function(r,n){for(var i=0;i<r.length;i++){var a=r[i],o=this.prepareRange(a),s=this.prepareSize(),l=xt(this.styleOption,["cfg","shadowBlur"]);Gn(l)||(l=s/2),this.prepareGreyScaleBlurredCircle(s,l),this.drawWithRange(a,o,s,l)}},t.prototype.color=function(r,n){return this.createAttrOption("color",r,typeof n!="function"?n:""),this},t.prototype.clear=function(){e.prototype.clear.call(this),this.clearShadowCanvasCtx(),this.paletteCache={}},t.prototype.prepareRange=function(r){var n=this.getAttribute("color"),i=n.getFields()[0],a=1/0,o=-1/0;return r.forEach(function(s){var l=s[Oa][i];l>o&&(o=l),l<a&&(a=l)}),a===o&&(a=o-1),[a,o]},t.prototype.prepareSize=function(){var r=this.getDefaultValue("size");return Gn(r)||(r=this.getDefaultSize()),r},t.prototype.prepareGreyScaleBlurredCircle=function(r,n){var i=this.getGrayScaleBlurredCanvas(),a=r+n,o=i.getContext("2d");i.width=i.height=a*2,o.clearRect(0,0,i.width,i.height),o.shadowOffsetX=o.shadowOffsetY=a*2,o.shadowBlur=n,o.shadowColor="black",o.beginPath(),o.arc(-a,-a,r,0,Math.PI*2,!0),o.closePath(),o.fill()},t.prototype.drawWithRange=function(r,n,i,a){var o,s,l=this.coordinate,u=l.start,c=l.end,f=this.coordinate.getWidth(),d=this.coordinate.getHeight(),v=this.getAttribute("color"),g=v.getFields()[0];this.clearShadowCanvasCtx();var x=this.getShadowCanvasCtx();n&&(r=r.filter(function(Y){return Y[Oa][g]<=n[1]&&Y[Oa][g]>=n[0]}));var w=this.scales[g];try{for(var S=mi(r),A=S.next();!A.done;A=S.next()){var M=A.value,R=this.getDrawCfg(M),O=R.x,N=R.y,k=w.scale(M[Oa][g]);this.drawGrayScaleBlurredCircle(O-u.x,N-c.y,i+a,k,x)}}catch(Y){o={error:Y}}finally{try{A&&!A.done&&(s=S.return)&&s.call(S)}finally{if(o)throw o.error}}var V=x.getImageData(0,0,f,d);this.clearShadowCanvasCtx(),this.colorize(V),x.putImageData(V,0,0);var Q=this.getImageShape();Q.attr("x",u.x),Q.attr("y",c.y),Q.attr("width",f),Q.attr("height",d),Q.attr("img",x.canvas),Q.set("origin",this.getShapeInfo(r))},t.prototype.getDefaultSize=function(){var r=this.getAttribute("position"),n=this.coordinate;return Math.min(n.getWidth()/(r.scales[0].ticks.length*4),n.getHeight()/(r.scales[1].ticks.length*4))},t.prototype.clearShadowCanvasCtx=function(){var r=this.getShadowCanvasCtx();r.clearRect(0,0,r.canvas.width,r.canvas.height)},t.prototype.getShadowCanvasCtx=function(){var r=this.shadowCanvas;return r||(r=document.createElement("canvas"),this.shadowCanvas=r),r.width=this.coordinate.getWidth(),r.height=this.coordinate.getHeight(),r.getContext("2d")},t.prototype.getGrayScaleBlurredCanvas=function(){return this.grayScaleBlurredCanvas||(this.grayScaleBlurredCanvas=document.createElement("canvas")),this.grayScaleBlurredCanvas},t.prototype.drawGrayScaleBlurredCircle=function(r,n,i,a,o){var s=this.getGrayScaleBlurredCanvas();o.globalAlpha=a,o.drawImage(s,r-i,n-i)},t.prototype.colorize=function(r){for(var n=this.getAttribute("color"),i=r.data,a=this.paletteCache,o=3;o<i.length;o+=4){var s=i[o];if(Gn(s)){var l=a[s]?a[s]:Um.rgb2arr(n.gradient(s/256));i[o-3]=l[0],i[o-2]=l[1],i[o-1]=l[2],i[o]=s}}},t.prototype.getImageShape=function(){var r=this.imageShape;if(r)return r;var n=this.container;return r=n.addShape({type:"image",attrs:{}}),this.imageShape=r,r},t.prototype.getShapeInfo=function(r){var n=this.getDrawCfg(r[0]),i=r.map(function(a){return a[Oa]});return U(U({},n),{mappingData:r,data:i})},t}(E0);function A6(e){var t,r,n=e.x,i=e.y,a=e.y0,o=e.size,s,l;ze(i)?(t=Lr(i,2),s=t[0],l=t[1]):(s=a,l=i);var u,c;ze(n)?(r=Lr(n,2),u=r[0],c=r[1]):(u=n-o/2,c=n+o/2);var f=[{x:u,y:s},{x:u,y:l}];return f.push({x:c,y:l},{x:c,y:s}),f}function M6(e,t){t===void 0&&(t=!0);var r=[],n=e[0];r.push(["M",n.x,n.y]);for(var i=1,a=e.length;i<a;i++)r.push(["L",e[i].x,e[i].y]);return t&&(r.push(["L",n.x,n.y]),r.push(["z"])),r}function Qlt(e,t){var r=0,n=0,i=0,a=0;return ze(e)?e.length===1?r=n=i=a=e[0]:e.length===2?(r=i=e[0],n=a=e[1]):e.length===3?(r=e[0],n=a=e[1],i=e[2]):(r=e[0],n=e[1],i=e[2],a=e[3]):r=n=i=a=e,r+n>t&&(r=r?t/(1+n/r):0,n=t-r),i+a>t&&(i=i?t/(1+a/i):0,a=t-i),[r||0,n||0,i||0,a||0]}function Jlt(e,t,r){var n=[];if(r.isRect){var i=r.isTransposed?{x:r.start.x,y:t[0].y}:{x:t[0].x,y:r.start.y},a=r.isTransposed?{x:r.end.x,y:t[2].y}:{x:t[3].x,y:r.end.y},o=xt(e,["background","style","radius"]);if(o){var s=r.isTransposed?Math.abs(t[0].y-t[2].y):t[2].x-t[1].x,l=r.isTransposed?r.getWidth():r.getHeight(),u=Lr(Qlt(o,Math.min(s,l)),4),c=u[0],f=u[1],d=u[2],v=u[3],g=r.isTransposed&&r.isReflect("y"),x=g?0:1,w=function(N){return g?-N:N};n.push(["M",i.x,a.y+w(c)]),c!==0&&n.push(["A",c,c,0,0,x,i.x+c,a.y]),n.push(["L",a.x-f,a.y]),f!==0&&n.push(["A",f,f,0,0,x,a.x,a.y+w(f)]),n.push(["L",a.x,i.y-w(d)]),d!==0&&n.push(["A",d,d,0,0,x,a.x-d,i.y]),n.push(["L",i.x+v,i.y]),v!==0&&n.push(["A",v,v,0,0,x,i.x,i.y-w(v)])}else n.push(["M",i.x,i.y]),n.push(["L",a.x,i.y]),n.push(["L",a.x,a.y]),n.push(["L",i.x,a.y]),n.push(["L",i.x,i.y]);n.push(["z"])}if(r.isPolar){var S=r.getCenter(),A=tS(e,r),M=A.startAngle,R=A.endAngle;if(r.type!=="theta"&&!r.isTransposed)n=$m(S.x,S.y,r.getRadius(),M,R);else{var O=function(V){return Math.pow(V,2)},c=Math.sqrt(O(S.x-t[0].x)+O(S.y-t[0].y)),f=Math.sqrt(O(S.x-t[2].x)+O(S.y-t[2].y));n=$m(S.x,S.y,c,r.startAngle,r.endAngle,f)}}return n}function B1e(e,t,r){var n=r.getWidth(),i=r.getHeight(),a=r.type==="rect",o=[],s=(e[2].x-e[1].x)/2,l=r.isTransposed?s*i/n:s*n/i;return t==="round"?(a?(o.push(["M",e[0].x,e[0].y+l]),o.push(["L",e[1].x,e[1].y-l]),o.push(["A",s,s,0,0,1,e[2].x,e[2].y-l]),o.push(["L",e[3].x,e[3].y+l]),o.push(["A",s,s,0,0,1,e[0].x,e[0].y+l])):(o.push(["M",e[0].x,e[0].y]),o.push(["L",e[1].x,e[1].y]),o.push(["A",s,s,0,0,1,e[2].x,e[2].y]),o.push(["L",e[3].x,e[3].y]),o.push(["A",s,s,0,0,1,e[0].x,e[0].y])),o.push(["z"])):o=M6(e),o}function tut(e,t,r){var n=[];return ke(t)?r?n.push(["M",e[0].x,e[0].y],["L",e[1].x,e[1].y],["L",(e[2].x+e[3].x)/2,(e[2].y+e[3].y)/2],["Z"]):n.push(["M",e[0].x,e[0].y],["L",e[1].x,e[1].y],["L",e[2].x,e[2].y],["L",e[3].x,e[3].y],["Z"]):n.push(["M",e[0].x,e[0].y],["L",e[1].x,e[1].y],["L",t[1].x,t[1].y],["L",t[0].x,t[0].y],["Z"]),n}function ew(e,t){return[t,e]}function N1e(e,t,r){var n,i,a,o,s,l,u,c=Lr(an([],Lr(e),!1),4),f=c[0],d=c[1],v=c[2],g=c[3],x=Lr(typeof r=="number"?Array(4).fill(r):r,4),w=x[0],S=x[1],A=x[2],M=x[3];t.isTransposed&&(n=Lr(ew(d,g),2),d=n[0],g=n[1]),t.isReflect("y")&&(i=Lr(ew(f,d),2),f=i[0],d=i[1],a=Lr(ew(v,g),2),v=a[0],g=a[1]),t.isReflect("x")&&(o=Lr(ew(f,g),2),f=o[0],g=o[1],s=Lr(ew(d,v),2),d=s[0],v=s[1]);var R=[],O=function(N){return Math.abs(N)};return l=Lr(Qlt([w,S,A,M],Math.min(O(g.x-f.x),O(d.y-f.y))).map(function(N){return O(N)}),4),w=l[0],S=l[1],A=l[2],M=l[3],t.isTransposed&&(u=Lr([M,w,S,A],4),w=u[0],S=u[1],A=u[2],M=u[3]),f.y<d.y?(R.push(["M",g.x,g.y+A]),A!==0&&R.push(["A",A,A,0,0,0,g.x-A,g.y]),R.push(["L",f.x+M,f.y]),M!==0&&R.push(["A",M,M,0,0,0,f.x,f.y+M]),R.push(["L",d.x,d.y-w]),w!==0&&R.push(["A",w,w,0,0,0,d.x+w,d.y]),R.push(["L",v.x-S,v.y]),S!==0&&R.push(["A",S,S,0,0,0,v.x,v.y-S]),R.push(["L",g.x,g.y+A]),R.push(["z"])):g.x<f.x?(R.push(["M",v.x+S,v.y]),S!==0&&R.push(["A",S,S,0,0,0,v.x,v.y+S]),R.push(["L",g.x,g.y-A]),A!==0&&R.push(["A",A,A,0,0,0,g.x+A,g.y]),R.push(["L",f.x-M,f.y]),M!==0&&R.push(["A",M,M,0,0,0,f.x,f.y-M]),R.push(["L",d.x,d.y+w]),w!==0&&R.push(["A",w,w,0,0,0,d.x-w,d.y]),R.push(["L",v.x+S,v.y]),R.push(["z"])):(R.push(["M",d.x,d.y+w]),w!==0&&R.push(["A",w,w,0,0,1,d.x+w,d.y]),R.push(["L",v.x-S,v.y]),S!==0&&R.push(["A",S,S,0,0,1,v.x,v.y+S]),R.push(["L",g.x,g.y-A]),A!==0&&R.push(["A",A,A,0,0,1,g.x-A,g.y]),R.push(["L",f.x+M,f.y]),M!==0&&R.push(["A",M,M,0,0,1,f.x,f.y-M]),R.push(["L",d.x,d.y+w]),R.push(["z"])),R}b0("interval",{defaultShapeType:"rect",getDefaultPoints:function(e){return A6(e)}});ca("interval","rect",{draw:function(e,t){var r=bs(e,!1,!0),n=t,i=e==null?void 0:e.background;if(i){n=t.addGroup({name:"interval-group"});var a=Vlt(e),o=Jlt(e,this.parsePoints(e.points),this.coordinate);n.addShape("path",{attrs:U(U({},a),{path:o}),capture:!1,zIndex:-1,name:b6})}var s;r.radius&&this.coordinate.isRect?s=N1e(this.parsePoints(e.points),this.coordinate,r.radius):s=this.parsePath(B1e(e.points,r.lineCap,this.coordinate));var l=n.addShape("path",{attrs:U(U({},r),{path:s}),name:"interval"});return i?n:l},getMarker:function(e){var t=e.color,r=e.isInPolar;return r?{symbol:"circle",style:{r:4.5,fill:t}}:{symbol:"square",style:{r:4,fill:t}}}});function k1e(e,t){var r=e.length,n=e;nn(n[0])&&(n=e.map(function(s){return t.translate(s)}));for(var i=n[1]-n[0],a=2;a<r;a++){var o=n[a]-n[a-1];i>o&&(i=o)}return i}function z1e(e,t){if(t){var r=Nh(e),n=$d(r,t);return n.length}return e.length}function R6(e){var t=e.theme,r=e.coordinate,n=e.getXScale(),i=n.values,a=e.beforeMappingData,o=i.length,s=KS(e.coordinate),l=e.intervalPadding,u=e.dodgePadding,c=e.maxColumnWidth||t.maxColumnWidth,f=e.minColumnWidth||t.minColumnWidth,d=e.columnWidthRatio||t.columnWidthRatio,v=e.multiplePieWidthRatio||t.multiplePieWidthRatio,g=e.roseWidthRatio||t.roseWidthRatio;if(n.isLinear&&i.length>1){i.sort();var x=k1e(i,n);o=(n.max-n.min)/x,i.length>o&&(o=i.length)}var w=n.range,S=1/o,A=1;if(r.isPolar?r.isTransposed&&o>1?A=v:A=g:(n.isLinear&&(S*=w[1]-w[0]),A=d),!ke(l)&&l>=0){var M=l/s;S=(1-(o-1)*M)/o}else S*=A;if(e.getAdjust("dodge")){var R=e.getAdjust("dodge"),O=R.dodgeBy,N=z1e(a,O);if(!ke(u)&&u>=0){var k=u/s;S=(S-k*(N-1))/N}else!ke(l)&&l>=0&&(S*=A),S=S/N;S=S>=0?S:0}if(!ke(c)&&c>=0){var V=c/s;S>V&&(S=V)}if(!ke(f)&&f>=0){var Q=f/s;S<Q&&(S=Q)}return S}var U1e=function(e){Ut(t,e);function t(r){var n=e.call(this,r)||this;n.type="interval",n.shapeType="interval",n.generatePoints=!0;var i=r.background;return n.background=i,n}return t.prototype.createShapePointsCfg=function(r){var n=e.prototype.createShapePointsCfg.call(this,r),i,a=this.getAttribute("size");if(a){i=this.getAttributeValues(a,r)[0];var o=this.coordinate,s=KS(o);i=i/s}else this.defaultSize||(this.defaultSize=R6(this)),i=this.defaultSize;return n.size=i,n},t.prototype.adjustScale=function(){e.prototype.adjustScale.call(this);var r=this.getYScale();if(this.coordinate.type==="theta")r.change({nice:!1,min:0,max:Cye(r)});else{var n=this.scaleDefs,i=r.field,a=r.min,o=r.max,s=r.type;s!=="time"&&(a>0&&!xt(n,[i,"min"])&&r.change({min:0}),o<=0&&!xt(n,[i,"max"])&&r.change({max:0}))}},t.prototype.getDrawCfg=function(r){var n=e.prototype.getDrawCfg.call(this,r);return n.background=this.background,n},t}(E0),$1e=function(e){Ut(t,e);function t(r){var n=e.call(this,r)||this;n.type="line";var i=r.sortable,a=i===void 0?!1:i;return n.sortable=a,n}return t}(T6),eut=["circle","square","bowtie","diamond","hexagon","triangle","triangle-down"],H1e=["cross","tick","plus","hyphen","line"];function I6(e,t,r,n,i){var a,o,s=bs(t,i,!i,"r"),l=e.parsePoints(t.points),u=l[0];if(t.isStack)u=l[1];else if(l.length>1){var c=r.addGroup();try{for(var f=mi(l),d=f.next();!d.done;d=f.next()){var v=d.value;c.addShape({type:"marker",attrs:U(U(U({},s),{symbol:p_[n]||n}),v)})}}catch(g){a={error:g}}finally{try{d&&!d.done&&(o=f.return)&&o.call(f)}finally{if(a)throw a.error}}return c}return r.addShape({type:"marker",attrs:U(U(U({},s),{symbol:p_[n]||n}),u)})}b0("point",{defaultShapeType:"hollow-circle",getDefaultPoints:function(e){return C6(e)}});ft(eut,function(e){ca("point","hollow-".concat(e),{draw:function(t,r){return I6(this,t,r,e,!0)},getMarker:function(t){var r=t.color;return{symbol:p_[e]||e,style:{r:4.5,stroke:r,fill:null}}}})});var V1e=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="point",r.shapeType="point",r.generatePoints=!0,r}return t.prototype.getDrawCfg=function(r){var n=e.prototype.getDrawCfg.call(this,r);return U(U({},n),{isStack:!!this.getAdjust("stack")})},t}(E0);function G1e(e){for(var t=e[0],r=1,n=[["M",t.x,t.y]];r<e.length;){var i=e[r];(i.x!==e[r-1].x||i.y!==e[r-1].y)&&(n.push(["L",i.x,i.y]),i.x===t.x&&i.y===t.y&&r<e.length-1&&(t=e[r+1],n.push(["Z"]),n.push(["M",t.x,t.y]),r++)),r++}return zi(Gs(n),t)||n.push(["L",t.x,t.y]),n.push(["Z"]),n}b0("polygon",{defaultShapeType:"polygon",getDefaultPoints:function(e){var t=[];return ft(e.x,function(r,n){var i=e.y[n];t.push({x:r,y:i})}),t}});ca("polygon","polygon",{draw:function(e,t){if(!Kc(e.points)){var r=bs(e,!0,!0),n=this.parsePath(G1e(e.points));return t.addShape("path",{attrs:U(U({},r),{path:n}),name:"polygon"})}},getMarker:function(e){var t=e.color;return{symbol:"square",style:{r:4,fill:t}}}});var W1e=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="polygon",r.shapeType="polygon",r.generatePoints=!0,r}return t.prototype.createShapePointsCfg=function(r){var n=e.prototype.createShapePointsCfg.call(this,r),i=n.x,a=n.y,o;if(!(ze(i)&&ze(a))){var s=this.getXScale(),l=this.getYScale(),u=s.values.length,c=l.values.length,f=.5*1/u,d=.5*1/c;s.isCategory&&l.isCategory?(i=[i-f,i-f,i+f,i+f],a=[a-d,a+d,a+d,a-d]):ze(i)?(o=i,i=[o[0],o[0],o[1],o[1]],a=[a-d/2,a+d/2,a+d/2,a-d/2]):ze(a)&&(o=a,a=[o[0],o[1],o[1],o[0]],i=[i-f/2,i-f/2,i+f/2,i+f/2]),n.x=i,n.y=a}return n},t}(E0);b0("schema",{defaultShapeType:""});var X1e=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="schema",r.shapeType="schema",r.generatePoints=!0,r}return t.prototype.createShapePointsCfg=function(r){var n=e.prototype.createShapePointsCfg.call(this,r),i,a=this.getAttribute("size");if(a){i=this.getAttributeValues(a,r)[0];var o=this.coordinate,s=KS(o);i=i/s}else this.defaultSize||(this.defaultSize=R6(this)),i=this.defaultSize;return n.size=i,n},t}(E0);function j1e(e){if(!ze(e))return[];var t=kh(e);return mo(e,function(r){return r/t})}b0("violin",{defaultShapeType:"violin",getDefaultPoints:function(e){var t=e.size/2,r=[],n=j1e(e._size);return ft(e.y,function(i,a){var o=n[a]*t,s=a===0,l=a===e.y.length-1;r.push({isMin:s,isMax:l,x:e.x-o,y:i}),r.unshift({isMin:s,isMax:l,x:e.x+o,y:i})}),r}});ca("violin","violin",{draw:function(e,t){var r=bs(e,!0,!0),n=this.parsePath($lt(e.points));return t.addShape("path",{attrs:U(U({},r),{path:n}),name:"violin"})},getMarker:function(e){var t=e.color;return{symbol:"circle",style:{r:4,fill:t}}}});var Y1e=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="violin",r.shapeType="violin",r.generatePoints=!0,r}return t.prototype.createShapePointsCfg=function(r){var n=e.prototype.createShapePointsCfg.call(this,r),i,a=this.getAttribute("size");if(a){i=this.getAttributeValues(a,r)[0];var o=this.coordinate,s=KS(o);i=i/s}else this.defaultSize||(this.defaultSize=R6(this)),i=this.defaultSize;return n.size=i,n._size=xt(r[Oa],[this._sizeField]),n},t.prototype.initAttributes=function(){var r=this.attributeOption,n=r.size?r.size.fields[0]:this._sizeField?this._sizeField:"size";this._sizeField=n,delete r.size,e.prototype.initAttributes.call(this)},t}(E0);ca("area","line",{draw:function(e,t){var r=X3(e,!0,!1,this),n=t.addShape({type:"path",attrs:r,name:"area"});return n},getMarker:function(e){var t=e.color;return{symbol:function(r,n,i){return i===void 0&&(i=5.5),[["M",r-i,n-4],["L",r+i,n-4],["L",r+i,n+4],["L",r-i,n+4],["Z"]]},style:{r:5,stroke:t,fill:null}}}});ca("area","smooth",{draw:function(e,t){var r=this.coordinate,n=X3(e,!1,!0,this,Klt(r)),i=t.addShape({type:"path",attrs:n,name:"area"});return i},getMarker:function(e){var t=e.color;return{symbol:function(r,n,i){return i===void 0&&(i=5.5),[["M",r-i,n-4],["L",r+i,n-4],["L",r+i,n+4],["L",r-i,n+4],["Z"]]},style:{r:5,fill:t,fillOpacity:1}}}});ca("area","smooth-line",{draw:function(e,t){var r=this.coordinate,n=X3(e,!0,!0,this,Klt(r)),i=t.addShape({type:"path",attrs:n,name:"area"});return i},getMarker:function(e){var t=e.color;return{symbol:function(r,n,i){return i===void 0&&(i=5.5),[["M",r-i,n-4],["L",r+i,n-4],["L",r+i,n+4],["L",r-i,n+4],["Z"]]},style:{r:5,stroke:t,fill:null}}}});function QB(e,t){return["C",e.x*1/2+t.x*1/2,e.y,e.x*1/2+t.x*1/2,t.y,t.x,t.y]}function JB(e,t){var r=[];r.push({x:t.x,y:t.y}),r.push(e);var n=["Q"];return ft(r,function(i){n.push(i.x,i.y)}),n}function Z1e(e,t,r){var n=JB(t,r),i=[["M",e.x,e.y]];return i.push(n),i}function q1e(e,t){var r=JB(e[1],t),n=JB(e[3],t),i=[["M",e[0].x,e[0].y]];return i.push(n),i.push(["L",e[3].x,e[3].y]),i.push(["L",e[2].x,e[2].y]),i.push(r),i.push(["L",e[1].x,e[1].y]),i.push(["L",e[0].x,e[0].y]),i.push(["Z"]),i}ca("edge","arc",{draw:function(e,t){var r=bs(e,!0,!1,"lineWidth"),n=e.points,i=n.length>2?"weight":"normal",a;if(e.isInCircle){var o={x:0,y:1};return i==="normal"?a=Z1e(n[0],n[1],o):(r.fill=r.stroke,a=q1e(n,o)),a=this.parsePath(a),t.addShape("path",{attrs:U(U({},r),{path:a})})}else{if(i==="normal")return n=this.parsePoints(n),a=elt((n[1].x+n[0].x)/2,n[0].y,Math.abs(n[1].x-n[0].x)/2,Math.PI,Math.PI*2),t.addShape("path",{attrs:U(U({},r),{path:a})});var s=QB(n[1],n[3]),l=QB(n[2],n[0]);return a=[["M",n[0].x,n[0].y],["L",n[1].x,n[1].y],s,["L",n[3].x,n[3].y],["L",n[2].x,n[2].y],l,["Z"]],a=this.parsePath(a),r.fill=r.stroke,t.addShape("path",{attrs:U(U({},r),{path:a})})}},getMarker:function(e){return{symbol:"circle",style:{r:4.5,fill:e.color}}}});function K1e(e,t){var r=QB(e,t),n=[["M",e.x,e.y]];return n.push(r),n}ca("edge","smooth",{draw:function(e,t){var r=bs(e,!0,!1,"lineWidth"),n=e.points,i=this.parsePath(K1e(n[0],n[1]));return t.addShape("path",{attrs:U(U({},r),{path:i})})},getMarker:function(e){return{symbol:"circle",style:{r:4.5,fill:e.color}}}});var iA=1/3;function Q1e(e,t){var r=[];r.push({x:e.x,y:e.y*(1-iA)+t.y*iA}),r.push({x:t.x,y:e.y*(1-iA)+t.y*iA}),r.push(t);var n=[["M",e.x,e.y]];return ft(r,function(i){n.push(["L",i.x,i.y])}),n}ca("edge","vhv",{draw:function(e,t){var r=bs(e,!0,!1,"lineWidth"),n=e.points,i=this.parsePath(Q1e(n[0],n[1]));return t.addShape("path",{attrs:U(U({},r),{path:i})})},getMarker:function(e){return{symbol:"circle",style:{r:4.5,fill:e.color}}}});ca("interval","funnel",{getPoints:function(e){return e.size=e.size*2,A6(e)},draw:function(e,t){var r=bs(e,!1,!0),n=this.parsePath(tut(e.points,e.nextPoints,!1)),i=t.addShape("path",{attrs:U(U({},r),{path:n}),name:"interval"});return i},getMarker:function(e){var t=e.color;return{symbol:"square",style:{r:4,fill:t}}}});ca("interval","hollow-rect",{draw:function(e,t){var r=bs(e,!0,!1),n=t,i=e==null?void 0:e.background;if(i){n=t.addGroup();var a=Vlt(e),o=Jlt(e,this.parsePoints(e.points),this.coordinate);n.addShape("path",{attrs:U(U({},a),{path:o}),capture:!1,zIndex:-1,name:b6})}var s=this.parsePath(M6(e.points)),l=n.addShape("path",{attrs:U(U({},r),{path:s}),name:"interval"});return i?n:l},getMarker:function(e){var t=e.color,r=e.isInPolar;return r?{symbol:"circle",style:{r:4.5,stroke:t,fill:null}}:{symbol:"square",style:{r:4,stroke:t,fill:null}}}});function J1e(e){var t=e.x,r=e.y,n=e.y0;return ze(r)?r.map(function(i,a){return{x:ze(t)?t[a]:t,y:i}}):[{x:t,y:n},{x:t,y:r}]}ca("interval","line",{getPoints:function(e){return J1e(e)},draw:function(e,t){var r=bs(e,!0,!1,"lineWidth"),n=$c(U({},r),["fill"]),i=this.parsePath(M6(e.points,!1)),a=t.addShape("path",{attrs:U(U({},n),{path:i}),name:"interval"});return a},getMarker:function(e){var t=e.color;return{symbol:function(r,n,i){return[["M",r,n-i],["L",r,n+i]]},style:{r:5,stroke:t}}}});ca("interval","pyramid",{getPoints:function(e){return e.size=e.size*2,A6(e)},draw:function(e,t){var r=bs(e,!1,!0),n=this.parsePath(tut(e.points,e.nextPoints,!0)),i=t.addShape("path",{attrs:U(U({},r),{path:n}),name:"interval"});return i},getMarker:function(e){var t=e.color;return{symbol:"square",style:{r:4,fill:t}}}});function txe(e){var t,r=e.x,n=e.y,i=e.y0,a=e.size,o,s;ze(n)?(t=Lr(n,2),o=t[0],s=t[1]):(o=i,s=n);var l=r+a/2,u=r-a/2;return[{x:r,y:o},{x:r,y:s},{x:u,y:o},{x:l,y:o},{x:u,y:s},{x:l,y:s}]}function exe(e){return[["M",e[0].x,e[0].y],["L",e[1].x,e[1].y],["M",e[2].x,e[2].y],["L",e[3].x,e[3].y],["M",e[4].x,e[4].y],["L",e[5].x,e[5].y]]}ca("interval","tick",{getPoints:function(e){return txe(e)},draw:function(e,t){var r=bs(e,!0,!1),n=this.parsePath(exe(e.points)),i=t.addShape("path",{attrs:U(U({},r),{path:n}),name:"interval"});return i},getMarker:function(e){var t=e.color;return{symbol:function(r,n,i){return[["M",r-i/2,n-i],["L",r+i/2,n-i],["M",r,n-i],["L",r,n+i],["M",r-i/2,n+i],["L",r+i/2,n+i]]},style:{r:5,stroke:t}}}});var rxe=function(e,t,r){var n=e.x,i=e.y,a=t.x,o=t.y,s;switch(r){case"hv":s=[{x:a,y:i}];break;case"vh":s=[{x:n,y:o}];break;case"hvh":var l=(a+n)/2;s=[{x:l,y:i},{x:l,y:o}];break;case"vhv":var u=(i+o)/2;s=[{x:n,y:u},{x:a,y:u}];break}return s};function nxe(e,t){var r=[];return ft(e,function(n,i){var a=e[i+1];if(r.push(n),a){var o=rxe(n,a,t);r=r.concat(o)}}),r}function ixe(e){return e.map(function(t,r){return r===0?["M",t.x,t.y]:["L",t.x,t.y]})}function axe(e,t){var r=W3(e.points,e.connectNulls,e.showSinglePoint),n=[];return ft(r,function(i){var a=nxe(i,t);n=n.concat(ixe(a))}),U(U({},bs(e,!0,!1,"lineWidth")),{path:n})}ft(["hv","vh","hvh","vhv"],function(e){ca("line",e,{draw:function(t,r){var n=axe(t,e),i=r.addShape({type:"path",attrs:n,name:"line"});return i},getMarker:function(t){return Glt(t,e)}})});ft(H1e,function(e){ca("point",e,{draw:function(t,r){return I6(this,t,r,e,!0)},getMarker:function(t){var r=t.color;return{symbol:p_[e],style:{r:4.5,stroke:r,fill:null}}}})});ca("point","image",{draw:function(e,t){var r,n,i=bs(e,!1,!1,"r").r,a=this.parsePoints(e.points),o=a[0];if(e.isStack)o=a[1];else if(a.length>1){var s=t.addGroup();try{for(var l=mi(a),u=l.next();!u.done;u=l.next()){var c=u.value;s.addShape("image",{attrs:{x:c.x-i/2,y:c.y-i,width:i,height:i,img:e.shape[1]}})}}catch(f){r={error:f}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}return s}return t.addShape("image",{attrs:{x:o.x-i/2,y:o.y-i,width:i,height:i,img:e.shape[1]}})},getMarker:function(e){var t=e.color;return{symbol:"circle",style:{r:4.5,fill:t}}}});ft(eut,function(e){ca("point",e,{draw:function(t,r){return I6(this,t,r,e,!1)},getMarker:function(t){var r=t.color;return{symbol:p_[e]||e,style:{r:4.5,fill:r}}}})});function Vj(e){var t=ze(e)?e:[e],r=t[0],n=t[t.length-1],i=t.length>1?t[1]:r,a=t.length>3?t[3]:n,o=t.length>2?t[2]:i;return{min:r,max:n,min1:i,max1:a,median:o}}function Gj(e,t,r){var n=r/2,i;if(ze(t)){var a=Vj(t),o=a.min,s=a.max,l=a.median,u=a.min1,c=a.max1,f=e-n,d=e+n;i=[[f,s],[d,s],[e,s],[e,c],[f,u],[f,c],[d,c],[d,u],[e,u],[e,o],[f,o],[d,o],[f,l],[d,l]]}else{t=ke(t)?.5:t;var v=Vj(e),o=v.min,s=v.max,l=v.median,u=v.min1,c=v.max1,g=t-n,x=t+n;i=[[o,g],[o,x],[o,t],[u,t],[u,g],[u,x],[c,x],[c,g],[c,t],[s,t],[s,g],[s,x],[l,g],[l,x]]}return i.map(function(w){return{x:w[0],y:w[1]}})}function oxe(e){return[["M",e[0].x,e[0].y],["L",e[1].x,e[1].y],["M",e[2].x,e[2].y],["L",e[3].x,e[3].y],["M",e[4].x,e[4].y],["L",e[5].x,e[5].y],["L",e[6].x,e[6].y],["L",e[7].x,e[7].y],["L",e[4].x,e[4].y],["Z"],["M",e[8].x,e[8].y],["L",e[9].x,e[9].y],["M",e[10].x,e[10].y],["L",e[11].x,e[11].y],["M",e[12].x,e[12].y],["L",e[13].x,e[13].y]]}ca("schema","box",{getPoints:function(e){var t=e.x,r=e.y,n=e.size;return Gj(t,r,n)},draw:function(e,t){var r=bs(e,!0,!1),n=this.parsePath(oxe(e.points)),i=t.addShape("path",{attrs:U(U({},r),{path:n,name:"schema"})});return i},getMarker:function(e){var t=e.color;return{symbol:function(r,n,i){var a=[n-6,n-3,n,n+3,n+6],o=Gj(r,a,i);return[["M",o[0].x+1,o[0].y],["L",o[1].x-1,o[1].y],["M",o[2].x,o[2].y],["L",o[3].x,o[3].y],["M",o[4].x,o[4].y],["L",o[5].x,o[5].y],["L",o[6].x,o[6].y],["L",o[7].x,o[7].y],["L",o[4].x,o[4].y],["Z"],["M",o[8].x,o[8].y],["L",o[9].x,o[9].y],["M",o[10].x+1,o[10].y],["L",o[11].x-1,o[11].y],["M",o[12].x,o[12].y],["L",o[13].x,o[13].y]]},style:{r:6,lineWidth:1,stroke:t}}}});function sxe(e){var t=ze(e)?e:[e],r=t.sort(function(n,i){return i-n});return vye(r,4,r[r.length-1])}function Wj(e,t,r){var n=sxe(t);return[{x:e,y:n[0]},{x:e,y:n[1]},{x:e-r/2,y:n[2]},{x:e-r/2,y:n[1]},{x:e+r/2,y:n[1]},{x:e+r/2,y:n[2]},{x:e,y:n[2]},{x:e,y:n[3]}]}function lxe(e){return[["M",e[0].x,e[0].y],["L",e[1].x,e[1].y],["M",e[2].x,e[2].y],["L",e[3].x,e[3].y],["L",e[4].x,e[4].y],["L",e[5].x,e[5].y],["Z"],["M",e[6].x,e[6].y],["L",e[7].x,e[7].y]]}ca("schema","candle",{getPoints:function(e){var t=e.x,r=e.y,n=e.size;return Wj(t,r,n)},draw:function(e,t){var r=bs(e,!0,!0),n=this.parsePath(lxe(e.points)),i=t.addShape("path",{attrs:U(U({},r),{path:n,name:"schema"})});return i},getMarker:function(e){var t=e.color;return{symbol:function(r,n,i){var a=[n+7.5,n+3,n-3,n-7.5],o=Wj(r,a,i);return[["M",o[0].x,o[0].y],["L",o[1].x,o[1].y],["M",o[2].x,o[2].y],["L",o[3].x,o[3].y],["L",o[4].x,o[4].y],["L",o[5].x,o[5].y],["Z"],["M",o[6].x,o[6].y],["L",o[7].x,o[7].y]]},style:{lineWidth:1,stroke:t,fill:t,r:6}}}});function uxe(e,t){var r=Math.abs(e[0].x-e[2].x),n=Math.abs(e[0].y-e[2].y),i=Math.min(r,n);t&&(i=lo(t,0,Math.min(r,n))),i=i/2;var a=(e[0].x+e[2].x)/2,o=(e[0].y+e[2].y)/2;return{x:a-i,y:o-i,width:i*2,height:i*2}}ca("polygon","square",{draw:function(e,t){if(!Kc(e.points)){var r=bs(e,!0,!0),n=this.parsePoints(e.points);return t.addShape("rect",{attrs:U(U({},r),uxe(n,e.size)),name:"polygon"})}},getMarker:function(e){var t=e.color;return{symbol:"square",style:{r:4,fill:t}}}});ca("violin","smooth",{draw:function(e,t){var r=bs(e,!0,!0),n=this.parsePath(Hlt(e.points));return t.addShape("path",{attrs:U(U({},r),{path:n})})},getMarker:function(e){var t=e.color;return{symbol:"circle",style:{stroke:null,r:4,fill:t}}}});ca("violin","hollow",{draw:function(e,t){var r=bs(e,!0,!1),n=this.parsePath($lt(e.points));return t.addShape("path",{attrs:U(U({},r),{path:n})})},getMarker:function(e){var t=e.color;return{symbol:"circle",style:{r:4,fill:null,stroke:t}}}});ca("violin","hollow-smooth",{draw:function(e,t){var r=bs(e,!0,!1),n=this.parsePath(Hlt(e.points));return t.addShape("path",{attrs:U(U({},r),{path:n})})},getMarker:function(e){var t=e.color;return{symbol:"circle",style:{r:4,fill:null,stroke:t}}}});var cxe=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getLabelValueDir=function(r){var n="y",i=r.points;return i[0][n]<=i[2][n]?1:-1},t.prototype.getLabelOffsetPoint=function(r,n,i,a){var o,s=e.prototype.getLabelOffsetPoint.call(this,r,n,i),l=this.getCoordinate(),u=l.isTransposed,c=u?"x":"y",f=this.getLabelValueDir(r.mappingData);return s=U(U({},s),(o={},o[c]=s[c]*f,o)),l.isReflect("x")&&(s=U(U({},s),{x:s.x*-1})),l.isReflect("y")&&(s=U(U({},s),{y:s.y*-1})),s},t.prototype.getThemedLabelCfg=function(r){var n=this.geometry,i=this.getDefaultLabelCfg(),a=n.theme;return Tr({},i,a.labels,r.position==="middle"?{offset:0}:{},r)},t.prototype.setLabelPosition=function(r,n,i,a){var o=this.getCoordinate(),s=o.isTransposed,l=n.points,u=o.convert(l[0]),c=o.convert(l[2]),f=this.getLabelValueDir(n),d,v,g,x,w=ze(n.shape)?n.shape[0]:n.shape;if(w==="funnel"||w==="pyramid"){var S=xt(n,"nextPoints"),A=xt(n,"points");if(S){var M=o.convert(A[0]),R=o.convert(A[1]),O=o.convert(S[0]),N=o.convert(S[1]);s?(d=Math.min(O.y,M.y),g=Math.max(O.y,M.y),v=(R.x+N.x)/2,x=(M.x+O.x)/2):(d=Math.min((R.y+N.y)/2,(M.y+O.y)/2),g=Math.max((R.y+N.y)/2,(M.y+O.y)/2),v=N.x,x=M.x)}else d=Math.min(c.y,u.y),g=Math.max(c.y,u.y),v=c.x,x=u.x}else d=Math.min(c.y,u.y),g=Math.max(c.y,u.y),v=c.x,x=u.x;switch(a){case"right":r.x=v,r.y=(d+g)/2,r.textAlign=xt(r,"textAlign",f>0?"left":"right");break;case"left":r.x=x,r.y=(d+g)/2,r.textAlign=xt(r,"textAlign",f>0?"left":"right");break;case"bottom":s&&(r.x=(v+x)/2),r.y=g,r.textAlign=xt(r,"textAlign","center"),r.textBaseline=xt(r,"textBaseline",f>0?"bottom":"top");break;case"middle":s&&(r.x=(v+x)/2),r.y=(d+g)/2,r.textAlign=xt(r,"textAlign","center"),r.textBaseline=xt(r,"textBaseline","middle");break;case"top":s&&(r.x=(v+x)/2),r.y=d,r.textAlign=xt(r,"textAlign","center"),r.textBaseline=xt(r,"textBaseline",f>0?"bottom":"top");break}},t}(G3),aA=Math.PI/2,rut=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getLabelOffset=function(r){var n=this.getCoordinate(),i=0;if(Gn(r))i=r;else if(nn(r)&&r.indexOf("%")!==-1){var a=n.getRadius();n.innerRadius>0&&(a=a*(1-n.innerRadius)),i=parseFloat(r)*.01*a}return i},t.prototype.getLabelItems=function(r){var n=e.prototype.getLabelItems.call(this,r),i=this.geometry.getYScale();return mo(n,function(a){if(a&&i){var o=i.scale(xt(a.data,i.field));return U(U({},a),{percent:o})}return a})},t.prototype.getLabelAlign=function(r){var n=this.getCoordinate(),i;if(r.labelEmit)i=r.angle<=Math.PI/2&&r.angle>=-Math.PI/2?"left":"right";else if(!n.isTransposed)i="center";else{var a=n.getCenter(),o=r.offset;Math.abs(r.x-a.x)<1?i="center":r.angle>Math.PI||r.angle<=0?i=o>0?"left":"right":i=o>0?"right":"left"}return i},t.prototype.getLabelPoint=function(r,n,i){var a=1,o,s=r.content[i];this.isToMiddle(n)?o=this.getMiddlePoint(n.points):(r.content.length===1&&i===0?i=1:i===0&&(a=-1),o=this.getArcPoint(n,i));var l=r.offset*a,u=this.getPointAngle(o),c=r.labelEmit,f=this.getCirclePoint(u,l,o,c);return f.r===0?f.content="":(f.content=s,f.angle=u,f.color=n.color),f.rotate=r.autoRotate?this.getLabelRotate(u,l,c):r.rotate,f.start={x:o.x,y:o.y},f},t.prototype.getArcPoint=function(r,n){return n===void 0&&(n=0),!ze(r.x)&&!ze(r.y)?{x:r.x,y:r.y}:{x:ze(r.x)?r.x[n]:r.x,y:ze(r.y)?r.y[n]:r.y}},t.prototype.getPointAngle=function(r){return ab(this.getCoordinate(),r)},t.prototype.getCirclePoint=function(r,n,i,a){var o=this.getCoordinate(),s=o.getCenter(),l=z3(o,i);if(l===0)return U(U({},s),{r:l});var u=r;if(o.isTransposed&&l>n&&!a){var c=Math.asin(n/(2*l));u=r+c*2}else l=l+n;return{x:s.x+l*Math.cos(u),y:s.y+l*Math.sin(u),r:l}},t.prototype.getLabelRotate=function(r,n,i){var a=r+aA;return i&&(a-=aA),a&&(a>aA?a=a-Math.PI:a<-aA&&(a=a+Math.PI)),a},t.prototype.getMiddlePoint=function(r){var n=this.getCoordinate(),i=r.length,a={x:0,y:0};return ft(r,function(o){a.x+=o.x,a.y+=o.y}),a.x/=i,a.y/=i,a=n.convert(a),a},t.prototype.isToMiddle=function(r){return r.x.length>2},t}(G3),hxe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.defaultLayout="distribute",r}return t.prototype.getDefaultLabelCfg=function(r,n){var i=e.prototype.getDefaultLabelCfg.call(this,r,n);return Tr({},i,xt(this.geometry.theme,"pieLabels",{}))},t.prototype.getLabelOffset=function(r){return e.prototype.getLabelOffset.call(this,r)||0},t.prototype.getLabelRotate=function(r,n,i){var a;return n<0&&(a=r,a>Math.PI/2&&(a=a-Math.PI),a<-Math.PI/2&&(a=a+Math.PI)),a},t.prototype.getLabelAlign=function(r){var n=this.getCoordinate(),i=n.getCenter(),a;return r.angle<=Math.PI/2&&r.x>=i.x?a="left":a="right",r.offset<=0&&(a==="right"?a="left":a="right"),a},t.prototype.getArcPoint=function(r){return r},t.prototype.getPointAngle=function(r){var n=this.getCoordinate(),i={x:ze(r.x)?r.x[0]:r.x,y:r.y[0]},a={x:ze(r.x)?r.x[1]:r.x,y:r.y[1]},o,s=ab(n,i);if(r.points&&r.points[0].y===r.points[1].y)o=s;else{var l=ab(n,a);s>=l&&(l=l+Math.PI*2),o=s+(l-s)/2}return o},t.prototype.getCirclePoint=function(r,n){var i=this.getCoordinate(),a=i.getCenter(),o=i.getRadius()+n;return U(U({},Ls(a.x,a.y,o,r)),{angle:r,r:o})},t}(rut),Xj=4;function fxe(e,t,r,n,i,a){var o,s,l=!0,u=n.start,c=n.end,f=Math.min(u.y,c.y),d=Math.abs(u.y-c.y),v,g=0,x=Number.MIN_VALUE,w=t.map(function(k){return k.y>g&&(g=k.y),k.y<x&&(x=k.y),{size:r,targets:[k.y-f]}});for(x-=f,g-f>d&&(d=g-f);l;)for(w.forEach(function(k){var V=(Math.min.apply(x,k.targets)+Math.max.apply(x,k.targets))/2;k.pos=Math.min(Math.max(x,V-k.size/2),d-k.size)}),l=!1,v=w.length;v--;)if(v>0){var S=w[v-1],A=w[v];S.pos+S.size>A.pos&&(S.size+=A.size,S.targets=S.targets.concat(A.targets),S.pos+S.size>d&&(S.pos=d-S.size),w.splice(v,1),l=!0)}v=0,w.forEach(function(k){var V=f+r/2;k.targets.forEach(function(){t[v].y=k.pos+V,V+=r,v++})});var M={};try{for(var R=mi(e),O=R.next();!O.done;O=R.next()){var N=O.value;M[N.get("id")]=N}}catch(k){o={error:k}}finally{try{O&&!O.done&&(s=R.return)&&s.call(R)}finally{if(o)throw o.error}}t.forEach(function(k){var V=k.r*k.r,Q=Math.pow(Math.abs(k.y-i.y),2);if(V<Q)k.x=i.x;else{var Y=Math.sqrt(V-Q);a?k.x=i.x+Y:k.x=i.x-Y}var X=M[k.id];X.attr("x",k.x),X.attr("y",k.y);var tt=Bd(X.getChildren(),function(it){return it.get("type")==="text"});tt&&(tt.attr("y",k.y),tt.attr("x",k.x))})}function dxe(e,t,r,n){if(!(!e.length||!t.length)){var i=e[0]?e[0].offset:0,a=t[0].get("coordinate"),o=a.getRadius(),s=a.getCenter();if(i>0){var l=14,u=o+i,c=u*2+l*2,f={start:a.start,end:a.end},d=[[],[]];e.forEach(function(v){v&&(v.textAlign==="right"?d[0].push(v):d[1].push(v))}),d.forEach(function(v,g){var x=c/l;v.length>x&&(v.sort(function(w,S){return S["..percent"]-w["..percent"]}),v.splice(x,v.length-x)),v.sort(function(w,S){return w.y-S.y}),fxe(t,v,l,f,s,g)})}ft(e,function(v){if(v&&v.labelLine){var g=v.offset,x=v.angle,w=Ls(s.x,s.y,o,x),S=Ls(s.x,s.y,o+g/2,x),A=v.x+xt(v,"offsetX",0),M=v.y+xt(v,"offsetY",0),R={x:A-Math.cos(x)*Xj,y:M-Math.sin(x)*Xj};qi(v.labelLine)||(v.labelLine={}),v.labelLine.path=["M ".concat(w.x),"".concat(w.y," Q").concat(S.x),"".concat(S.y," ").concat(R.x),R.y].join(",")}})}}function nut(e,t,r){var n=e.filter(function(g){return!g.invisible});n.sort(function(g,x){return g.y-x.y});var i=!0,a=r.minY,o=r.maxY,s=Math.abs(a-o),l,u=0,c=Number.MIN_VALUE,f=n.map(function(g){return g.y>u&&(u=g.y),g.y<c&&(c=g.y),{content:g.content,size:t,targets:[g.y-a],pos:null}});for(c-=a,u-a>s&&(s=u-a);i;)for(f.forEach(function(g){var x=(Math.min.apply(c,g.targets)+Math.max.apply(c,g.targets))/2;g.pos=Math.min(Math.max(c,x-g.size/2),s-g.size),g.pos=Math.max(0,g.pos)}),i=!1,l=f.length;l--;)if(l>0){var d=f[l-1],v=f[l];d.pos+d.size>v.pos&&(d.size+=v.size,d.targets=d.targets.concat(v.targets),d.pos+d.size>s&&(d.pos=s-d.size),f.splice(l,1),i=!0)}l=0,f.forEach(function(g){var x=a+t/2;g.targets.forEach(function(){n[l].y=g.pos+x,x+=t,l++})})}var jj=4;function pxe(e,t){var r=t.getCenter(),n=t.getRadius();if(e&&e.labelLine){var i=e.angle,a=e.offset,o=Ls(r.x,r.y,n,i),s=e.x+xt(e,"offsetX",0)*(Math.cos(i)>0?1:-1),l=e.y+xt(e,"offsetY",0)*(Math.sin(i)>0?1:-1),u={x:s-Math.cos(i)*jj,y:l-Math.sin(i)*jj},c=e.labelLine.smooth,f=[],d=u.x-r.x,v=u.y-r.y,g=Math.atan(v/d);if(d<0&&(g+=Math.PI),c===!1){qi(e.labelLine)||(e.labelLine={});var x=0;(i<0&&i>-Math.PI/2||i>Math.PI*1.5)&&u.y>o.y&&(x=1),i>=0&&i<Math.PI/2&&u.y>o.y&&(x=1),i>=Math.PI/2&&i<Math.PI&&o.y>u.y&&(x=1),(i<-Math.PI/2||i>=Math.PI&&i<Math.PI*1.5)&&o.y>u.y&&(x=1);var w=a/2>4?4:Math.max(a/2-1,0),S=Ls(r.x,r.y,n+w,i),A=Ls(r.x,r.y,n+a/2,g),M=0;f.push("M ".concat(o.x," ").concat(o.y)),f.push("L ".concat(S.x," ").concat(S.y)),f.push("A ".concat(r.x," ").concat(r.y," 0 ").concat(M," ").concat(x," ").concat(A.x," ").concat(A.y)),f.push("L ".concat(u.x," ").concat(u.y))}else{var S=Ls(r.x,r.y,n+(a/2>4?4:Math.max(a/2-1,0)),i),R=o.x<r.x?1:-1;f.push("M ".concat(u.x," ").concat(u.y));var O=(o.y-r.y)/(o.x-r.x),N=(u.y-r.y)/(u.x-r.x);Math.abs(O-N)>Math.pow(Math.E,-16)&&f.push.apply(f,["C",u.x+R*4,u.y,2*S.x-o.x,2*S.y-o.y,o.x,o.y]),f.push("L ".concat(o.x," ").concat(o.y))}e.labelLine.path=f.join(" ")}}function vxe(e,t,r,n){var i,a,o=Wl(e,function(V){return!ke(V)}),s=t[0]&&t[0].get("coordinate");if(s){var l=s.getCenter(),u=s.getRadius(),c={};try{for(var f=mi(t),d=f.next();!d.done;d=f.next()){var v=d.value;c[v.get("id")]=v}}catch(V){i={error:V}}finally{try{d&&!d.done&&(a=f.return)&&a.call(f)}finally{if(i)throw i.error}}var g=xt(o[0],"labelHeight",14),x=xt(o[0],"offset",0);if(!(x<=0)){var w="left",S="right",A=Ph(o,function(V){return V.x<l.x?w:S}),M=s.start,R=s.end,O=Math.min((u+x+g)*2,s.getHeight()),N=O/2,k={minX:M.x,maxX:R.x,minY:l.y-N,maxY:l.y+N};ft(A,function(V,Q){var Y=Math.floor(O/g);V.length>Y&&(V.sort(function(X,tt){return tt.percent-X.percent}),ft(V,function(X,tt){tt+1>Y&&(c[X.id].set("visible",!1),X.invisible=!0)})),nut(V,g,k)}),ft(A,function(V,Q){ft(V,function(Y){var X=Q===S,tt=c[Y.id],it=tt.getChildByIndex(0);if(it){var Et=u+x,Tt=Y.y-l.y,pt=Math.pow(Et,2),kt=Math.pow(Tt,2),ae=pt-kt>0?pt-kt:0,Kt=Math.sqrt(ae),re=Math.abs(Math.cos(Y.angle)*Et);X?Y.x=l.x+Math.max(Kt,re):Y.x=l.x-Math.max(Kt,re)}it&&(it.attr("y",Y.y),it.attr("x",Y.x)),pxe(Y,s)})})}}}var t5=4,gxe=4,Yj=4;function mxe(e,t,r){var n=t.getCenter(),i=t.getRadius(),a={x:e.x-(r?Yj:-Yj),y:e.y},o=Ls(n.x,n.y,i+t5,e.angle),s={x:a.x,y:a.y},l={x:o.x,y:o.y},u=Ls(n.x,n.y,i,e.angle),c="";if(a.y!==o.y){var f=r?4:-4;s.y=a.y,e.angle<0&&e.angle>=-Math.PI/2&&(s.x=Math.max(o.x,a.x-f),a.y<o.y?l.y=s.y:(l.y=o.y,l.x=Math.max(l.x,s.x-f))),e.angle>0&&e.angle<Math.PI/2&&(s.x=Math.max(o.x,a.x-f),a.y>o.y?l.y=s.y:(l.y=o.y,l.x=Math.max(l.x,s.x-f))),e.angle>Math.PI/2&&(s.x=Math.min(o.x,a.x-f),a.y>o.y?l.y=s.y:(l.y=o.y,l.x=Math.min(l.x,s.x-f))),e.angle<-Math.PI/2&&(s.x=Math.min(o.x,a.x-f),a.y<o.y?l.y=s.y:(l.y=o.y,l.x=Math.min(l.x,s.x-f)))}c=["M ".concat(a.x,",").concat(a.y),"L ".concat(s.x,",").concat(s.y),"L ".concat(l.x,",").concat(l.y),"L ".concat(o.x,",").concat(o.y),"L ".concat(u.x,",").concat(u.y)].join(" "),e.labelLine=Tr({},e.labelLine,{path:c})}function yxe(e,t,r,n){var i,a,o=t[0]&&t[0].get("coordinate");if(o){var s=o.getCenter(),l=o.getRadius(),u={};try{for(var c=mi(t),f=c.next();!f.done;f=c.next()){var d=f.value;u[d.get("id")]=d}}catch(V){i={error:V}}finally{try{f&&!f.done&&(a=c.return)&&a.call(c)}finally{if(i)throw i.error}}var v=xt(e[0],"labelHeight",14),g=Math.max(xt(e[0],"offset",0),t5);ft(e,function(V){if(V){var Q=xt(u,[V.id]);if(Q){var Y=V.x>s.x||V.x===s.x&&V.y>s.y,X=ke(V.offsetX)?gxe:V.offsetX,tt=Ls(s.x,s.y,l+t5,V.angle),it=g+X;V.x=s.x+(Y?1:-1)*(l+it),V.y=tt.y}}});var x=o.start,w=o.end,S="left",A="right",M=Ph(e,function(V){return V.x<s.x?S:A}),R=(l+g)*2+v;ft(M,function(V){var Q=V.length*v;Q>R&&(R=Math.min(Q,Math.abs(x.y-w.y)))});var O={minX:x.x,maxX:w.x,minY:s.y-R/2,maxY:s.y+R/2};ft(M,function(V,Q){var Y=R/v;V.length>Y&&(V.sort(function(X,tt){return tt.percent-X.percent}),ft(V,function(X,tt){tt>Y&&(u[X.id].set("visible",!1),X.invisible=!0)})),nut(V,v,O)});var N=O.minY,k=O.maxY;ft(M,function(V,Q){var Y=Q===A;ft(V,function(X){var tt=xt(u,X&&[X.id]);if(tt){if(X.y<N||X.y>k){tt.set("visible",!1);return}var it=tt.getChildByIndex(0),Et=it.getCanvasBBox(),Tt={x:Y?Et.x:Et.maxX,y:Et.y+Et.height/2};t2(it,X.x-Tt.x,X.y-Tt.y),X.labelLine&&mxe(X,o,Y)}})})}}function _xe(e,t,r,n){ft(t,function(i){var a=n.minX,o=n.minY,s=n.maxX,l=n.maxY,u=i.getCanvasBBox(),c=u.minX,f=u.minY,d=u.maxX,v=u.maxY,g=u.x,x=u.y,w=u.width,S=u.height,A=g,M=x;(c<a||d<a)&&(A=a),(f<o||v<o)&&(M=o),c>s?A=s-w:d>s&&(A=A-(d-s)),f>l?M=l-S:v>l&&(M=M-(v-l)),(A!==g||M!==x)&&t2(i,A-g,M-x)})}function xxe(e,t,r,n){ft(t,function(i,a){var o=i.getCanvasBBox(),s=r[a].getBBox();(o.minX<s.minX||o.minY<s.minY||o.maxX>s.maxX||o.maxY>s.maxY)&&i.remove(!0)})}var bxe=100,iut=function(){function e(t){t===void 0&&(t={}),this.bitmap={};var r=t.xGap,n=r===void 0?1:r,i=t.yGap,a=i===void 0?8:i;this.xGap=n,this.yGap=a}return e.prototype.hasGap=function(t){for(var r=!0,n=this.bitmap,i=Math.round(t.minX),a=Math.round(t.maxX),o=Math.round(t.minY),s=Math.round(t.maxY),l=i;l<=a;l+=1){if(!n[l]){n[l]={};continue}if(l===i||l===a){for(var u=o;u<=s;u++)if(n[l][u]){r=!1;break}}else if(n[l][o]||n[l][s]){r=!1;break}}return r},e.prototype.fillGap=function(t){for(var r=this.bitmap,n=Math.round(t.minX),i=Math.round(t.maxX),a=Math.round(t.minY),o=Math.round(t.maxY),s=n;s<=i;s+=1)r[s]||(r[s]={});for(var s=n;s<=i;s+=this.xGap){for(var l=a;l<=o;l+=this.yGap)r[s][l]=!0;r[s][o]=!0}if(this.yGap!==1)for(var s=a;s<=o;s+=1)r[n][s]=!0,r[i][s]=!0;if(this.xGap!==1)for(var s=n;s<=i;s+=1)r[s][a]=!0,r[s][o]=!0},e.prototype.destroy=function(){this.bitmap={}},e}();function Exe(e,t,r){r===void 0&&(r=bxe);var n=-1,i=e.attr(),a=i.x,o=i.y,s=e.getCanvasBBox(),l=Math.sqrt(s.width*s.width+s.height*s.height),u,c=-n,f=0,d=0,v=function(S){var A=S*.1;return[A*Math.cos(A),A*Math.sin(A)]};if(t.hasGap(s))return t.fillGap(s),!0;for(var g=!1,x=0,w={};Math.min(Math.abs(f),Math.abs(d))<l&&x<r;)if(u=v(c+=n),f=~~u[0],d=~~u[1],!(!f&&!d||w["".concat(f,"-").concat(d)])&&(e.attr({x:a+f,y:o+d}),f+d<0&&e.attr("textAlign","right"),x++,t.hasGap(e.getCanvasBBox()))){t.fillGap(e.getCanvasBBox()),g=!0,w["".concat(f,"-").concat(d)]=!0;break}return g}function wxe(e,t,r,n){var i=e.getCanvasBBox(),a=i.width,o=i.height,s={x:t,y:r,textAlign:"center"};switch(n){case 0:s.y-=o+1,s.x+=1,s.textAlign="left";break;case 1:s.y-=o+1,s.x-=1,s.textAlign="right";break;case 2:s.y+=o+1,s.x-=1,s.textAlign="right";break;case 3:s.y+=o+1,s.x+=1,s.textAlign="left";break;case 5:s.y-=o*2+2;break;case 6:s.y+=o*2+2;break;case 7:s.x+=a+1,s.textAlign="left";break;case 8:s.x-=a+1,s.textAlign="right";break}return e.attr(s),e.getCanvasBBox()}function Cxe(e,t,r,n){var i=new iut;ft(t,function(a){var o=a.find(function(s){return s.get("type")==="text"});Exe(o,i)||a.remove(!0)}),i.destroy()}function Sxe(e,t,r,n){var i=new iut;ft(t,function(a){for(var o=a.find(function(v){return v.get("type")==="text"}),s=o.attr(),l=s.x,u=s.y,c=!1,f=0;f<=8;f++){var d=wxe(o,l,u,f);if(i.hasGap(d)){i.fillGap(d),c=!0;break}}c||a.remove(!0)}),i.destroy()}function Txe(e,t){return(e[0]||0)*(t[0]||0)+(e[1]||0)*(t[1]||0)+(e[2]||0)*(t[2]||0)}function Zj(e){if(e.length>4)return[];var t=function(i,a){return[a.x-i.x,a.y-i.y]},r=t(e[0],e[1]),n=t(e[1],e[2]);return[r,n]}function oA(e,t,r){t===void 0&&(t=0),r===void 0&&(r={x:0,y:0});var n=e.x,i=e.y;return{x:(n-r.x)*Math.cos(-t)+(i-r.y)*Math.sin(-t)+r.x,y:(r.x-n)*Math.sin(-t)+(i-r.y)*Math.cos(-t)+r.y}}function qj(e){var t=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}],r=e.rotation;return r?[oA(t[0],r,t[0]),oA(t[1],r,t[0]),oA(t[2],r,t[0]),oA(t[3],r,t[0])]:t}function Kj(e,t){if(e.length>4)return{min:0,max:0};var r=[];return e.forEach(function(n){r.push(Txe([n.x,n.y],t))}),{min:Math.min.apply(Math,an([],Lr(r),!1)),max:Math.max.apply(Math,an([],Lr(r),!1))}}function Axe(e,t){return e.max>t.min&&e.min<t.max}function Mxe(e){return typeof e=="number"&&!Number.isNaN(e)&&e!==1/0&&e!==-1/0}function Qj(e){return["x","y","width","height"].every(function(t){return Mxe(e[t])})}function Rxe(e,t,r){return r===void 0&&(r=0),!(t.x>e.x+e.width+r||t.x+t.width<e.x-r||t.y>e.y+e.height+r||t.y+t.height<e.y-r)}function Ixe(e,t,r){if(r===void 0&&(r=0),!Qj(e)||!Qj(t))return!1;if(!e.rotation&&!t.rotation)return Rxe(e,t,r);for(var n=qj(e),i=qj(t),a=Zj(n).concat(Zj(i)),o=0;o<a.length;o++){var s=a[o],l=Kj(n,s),u=Kj(i,s);if(!Axe(l,u))return!1}return!0}var Lxe=function(){function e(t){var r=this;this.queue=[],this.worker=new Worker(t),this.worker.onmessage=function(n){var i;(i=r.queue.shift())===null||i===void 0||i.resolve(n)},this.worker.onmessageerror=function(n){var i;console.warn("[AntV G2] Web worker is not available"),(i=r.queue.shift())===null||i===void 0||i.reject(n)}}return e.prototype.post=function(t,r){var n=this;return new Promise(function(i,a){n.queue.push({resolve:i,reject:a});try{n.worker.postMessage(t)}catch{console.warn("[AntV G2] Web worker is not available"),$r(r)&&r()}})},e.prototype.destroy=function(){this.worker.terminate()},e}();function Oxe(e){if(!(typeof window>"u")){var t;try{t=new Blob([e.toString()],{type:"application/javascript"})}catch{t=new window.BlobBuilder,t.append(e.toString()),t=t.getBlob()}return new Lxe(URL.createObjectURL(t))}}var Pxe=function(e){function t(){function u(M,R){return(M[0]||0)*(R[0]||0)+(M[1]||0)*(R[1]||0)+(M[2]||0)*(R[2]||0)}function c(M){if(M.length>4)return[];var R=function(k,V){return[V.x-k.x,V.y-k.y]},O=R(M[0],M[1]),N=R(M[1],M[2]);return[O,N]}function f(M,R,O){R===void 0&&(R=0),O===void 0&&(O={x:0,y:0});var N=M.x,k=M.y;return{x:(N-O.x)*Math.cos(-R)+(k-O.y)*Math.sin(-R)+O.x,y:(O.x-N)*Math.sin(-R)+(k-O.y)*Math.cos(-R)+O.y}}function d(M){var R=[{x:M.x,y:M.y},{x:M.x+M.width,y:M.y},{x:M.x+M.width,y:M.y+M.height},{x:M.x,y:M.y+M.height}],O=M.rotation;return O?[f(R[0],O,R[0]),f(R[1],O,R[0]),f(R[2],O,R[0]),f(R[3],O,R[0])]:R}function v(M,R){if(M.length>4)return{min:0,max:0};var O=[];return M.forEach(function(N){O.push(u([N.x,N.y],R))}),{min:Math.min.apply(null,O),max:Math.max.apply(null,O)}}function g(M,R){return M.max>R.min&&M.min<R.max}function x(M){return typeof M=="number"&&!Number.isNaN(M)&&M!==1/0&&M!==-1/0}function w(M){return["x","y","width","height"].every(function(R){return x(M[R])})}function S(M,R,O){return O===void 0&&(O=0),!(R.x>M.x+M.width+O||R.x+R.width<M.x-O||R.y>M.y+M.height+O||R.y+R.height<M.y-O)}function A(M,R,O){if(O===void 0&&(O=0),!w(M)||!w(R))return!1;if(!M.rotation&&!R.rotation)return S(M,R,O);for(var N=d(M),k=d(R),V=c(N).concat(c(k)),Q=0;Q<V.length;Q++){var Y=V[Q],X=v(N,Y),tt=v(k,Y);if(!g(X,tt))return!1}return!0}return{intersect:A}}var r=t().intersect;function n(u){for(var c=u.slice(),f=0;f<c.length;f++){var d=c[f];if(d.visible)for(var v=f+1;v<c.length;v++){var g=c[v];d!==g&&g.visible&&r(d,g)&&(g.visible=!1)}}return c}var i={"hide-overlap":n};try{var a=JSON.parse(e.data);if(!a||!a.type||!i[a.type])return;var o=a.type,s=a.items,l=i[o](s);self.postMessage(l)}catch(u){throw u}},Dxe=`
   self.onmessage = `.concat(Pxe.toString(),`
`),CP=function(e){for(var t=e.slice(),r=0;r<t.length;r++){var n=t[r];if(n.visible)for(var i=r+1;i<t.length;i++){var a=t[i];n!==a&&a.visible&&Ixe(n,a)&&(a.visible=!1)}}return t},SP=new Map,Jj=Oxe(Dxe);function Fxe(e,t,r,n){return au(this,void 0,void 0,function(){var i,a,o,s,l,u;return Lh(this,function(c){switch(c.label){case 0:return i=t.map(function(f,d){return U(U({},Nlt(f,e[d],xt(e[d],"background.padding"))),{visible:!0})}),a=JSON.stringify(i),o=function(f){return SP.set(a,f),ft(f,function(d,v){var g=d.visible,x=t[v];g?x==null||x.show():x==null||x.hide()}),f},SP.get(a)?(o(SP.get(a)),[3,7]):[3,1];case 1:if(!Jj)return[3,6];c.label=2;case 2:return c.trys.push([2,4,,5]),s=JSON.stringify({type:"hide-overlap",items:i}),[4,Jj.post(s,function(){return o(CP(i))})];case 3:return l=c.sent(),o(Array.isArray(l.data)?l.data:[]),[3,5];case 4:return u=c.sent(),console.error(u),o(CP(i)),[3,5];case 5:return[3,7];case 6:o(CP(i)),c.label=7;case 7:return[2]}})})}var tY={"#5B8FF9":!0},Bxe=function(e){var t=Um.toRGB(e).toUpperCase();if(tY[t])return tY[t];var r=Lr(Um.rgb2arr(t),3),n=r[0],i=r[1],a=r[2],o=(n*299+i*587+a*114)/1e3<128;return o};function Nxe(e,t,r){if(r.length!==0){var n=r[0].get("element"),i=n.geometry.theme,a=i.labels||{},o=a.fillColorLight,s=a.fillColorDark;r.forEach(function(l,u){var c=t[u],f=c.find(function(S){return S.get("type")==="text"}),d=lc.fromObject(l.getBBox()),v=lc.fromObject(f.getCanvasBBox()),g=!d.contains(v),x=l.attr("fill"),w=Bxe(x);g?f.attr(i.overflowLabels.style):w?o&&f.attr("fill",o):s&&f.attr("fill",s)})}}function kxe(e,t,r){var n=e.coordinate,i=o0(t),a=lc.fromObject(i.getCanvasBBox()),o=lc.fromObject(r.getBBox());return n.isTransposed?o.height>=a.height:o.width>=a.width}function zxe(e,t,r){var n=!!e.getAdjust("stack");return n||t.every(function(i,a){var o=r[a];return kxe(e,i,o)})}function Uxe(e,t,r){var n=e.coordinate,i=lc.fromObject(r.getBBox()),a=o0(t);n.isTransposed?a.attr({x:i.minX+i.width/2,textAlign:"center"}):a.attr({y:i.minY+i.height/2,textBaseline:"middle"})}function $xe(e,t,r){var n;if(r.length!==0){var i=(n=r[0])===null||n===void 0?void 0:n.get("element"),a=i==null?void 0:i.geometry;if(!(!a||a.type!=="interval")){var o=zxe(a,t,r);o&&r.forEach(function(s,l){var u=t[l];Uxe(a,u,s)})}}}function Hxe(e){var t=500,r=[],n=Math.max(Math.floor(e.length/t),1);return ft(e,function(i,a){a%n===0?r.push(i):i.set("visible",!1)}),r}function Vxe(e,t,r){var n;if(r.length!==0){var i=(n=r[0])===null||n===void 0?void 0:n.get("element"),a=i==null?void 0:i.geometry;if(!(!a||a.type!=="interval")){var o=Hxe(t),s=Lr(a.getXYFields(),1),l=s[0],u=[],c=[],f=Ph(o,function(w){return w.get("data")[l]}),d=Jy(mo(o,function(w){return w.get("data")[l]})),v;o.forEach(function(w){w.set("visible",!0)});var g=function(w){w&&(w.length&&c.push(w.pop()),c.push.apply(c,an([],Lr(w),!1)))};for(_l(d)>0&&(v=d.shift(),g(f[v])),_l(d)>0&&(v=d.pop(),g(f[v])),ft(d.reverse(),function(w){g(f[w])});c.length>0;){var x=c.shift();x.get("visible")&&(U_e(x,u)?x.set("visible",!1):u.push(x))}}}}function Gxe(e,t){var r=e.getXYFields()[1],n=[],i=t.sort(function(a,o){return a.get("data")[r]-a.get("data")[r]});return i.length>0&&n.push(i.shift()),i.length>0&&n.push(i.pop()),n.push.apply(n,an([],Lr(i),!1)),n}function aut(e,t,r){return e.some(function(n){return r(n,t)})}function Wxe(e,t,r){r===void 0&&(r=0);var n=Math.max(0,Math.min(e.x+e.width+r,t.x+t.width+r)-Math.max(e.x-r,t.x-r)),i=Math.max(0,Math.min(e.y+e.height+r,t.y+t.height+r)-Math.max(e.y-r,t.y-r));return n*i}function eY(e,t){return aut(e,t,function(r,n){var i=o0(r),a=o0(n);return Wxe(i.getCanvasBBox(),a.getCanvasBBox(),2)>0})}function Xxe(e,t,r,n,i){var a,o;if(r.length!==0){var s=(a=r[0])===null||a===void 0?void 0:a.get("element"),l=s==null?void 0:s.geometry;if(!(!l||l.type!=="point")){var u=Lr(l.getXYFields(),2),c=u[0],f=u[1],d=Ph(t,function(x){return x.get("data")[c]}),v=[],g=i&&i.offset||((o=e[0])===null||o===void 0?void 0:o.offset)||12;mo(Eb(d).reverse(),function(x){for(var w=Gxe(l,d[x]);w.length;){var S=w.shift(),A=o0(S);if(aut(v,S,function(O,N){return O.get("data")[c]===N.get("data")[c]&&O.get("data")[f]===N.get("data")[f]})){A.set("visible",!1);continue}var M=eY(v,S),R=!1;if(M&&(A.attr("y",A.attr("y")+2*g),R=eY(v,S)),R){A.set("visible",!1);continue}v.push(S)}})}}}function jxe(e,t){var r=e.getXYFields()[1],n=[],i=t.sort(function(a,o){return a.get("data")[r]-a.get("data")[r]});return i.length>0&&n.push(i.shift()),i.length>0&&n.push(i.pop()),n.push.apply(n,an([],Lr(i),!1)),n}function out(e,t,r){return e.some(function(n){return r(n,t)})}function Yxe(e,t,r){r===void 0&&(r=0);var n=Math.max(0,Math.min(e.x+e.width+r,t.x+t.width+r)-Math.max(e.x-r,t.x-r)),i=Math.max(0,Math.min(e.y+e.height+r,t.y+t.height+r)-Math.max(e.y-r,t.y-r));return n*i}function rY(e,t){return out(e,t,function(r,n){var i=o0(r),a=o0(n);return Yxe(i.getCanvasBBox(),a.getCanvasBBox(),2)>0})}function Zxe(e,t,r,n,i){var a,o;if(r.length!==0){var s=(a=r[0])===null||a===void 0?void 0:a.get("element"),l=s==null?void 0:s.geometry;if(!(!l||["path","line","area"].indexOf(l.type)<0)){var u=Lr(l.getXYFields(),2),c=u[0],f=u[1],d=Ph(t,function(x){return x.get("data")[c]}),v=[],g=i&&i.offset||((o=e[0])===null||o===void 0?void 0:o.offset)||12;mo(Eb(d).reverse(),function(x){for(var w=jxe(l,d[x]);w.length;){var S=w.shift(),A=o0(S);if(out(v,S,function(O,N){return O.get("data")[c]===N.get("data")[c]&&O.get("data")[f]===N.get("data")[f]})){A.set("visible",!1);continue}var M=rY(v,S),R=!1;if(M&&(A.attr("y",A.attr("y")+2*g),R=rY(v,S)),R){A.set("visible",!1);continue}v.push(S)}})}}}var TP;function qxe(){return TP||(TP=document.createElement("canvas").getContext("2d")),TP}var sA=wb(function(e,t){t===void 0&&(t={});var r=t.fontSize,n=t.fontFamily,i=t.fontWeight,a=t.fontStyle,o=t.fontVariant,s=qxe();return s.font=[a,o,i,"".concat(r,"px"),n].join(" "),s.measureText(nn(e)?e:"").width},function(e,t){return t===void 0&&(t={}),an([e],Lr(wI(t)),!1).join("")}),Kxe=function(e,t,r){var n=16,i=sA("...",r),a;nn(e)?a=e:a=RS(e);var o=t,s=[],l,u;if(sA(e,r)<=t)return e;for(;l=a.substr(0,n),u=sA(l,r),!(u+i>o&&u>o);)if(s.push(l),o-=u,a=a.substr(n),!a)return s.join("");for(;l=a.substr(0,1),u=sA(l,r),!(u+i>o);)if(s.push(l),o-=u,a=a.substr(1),!a)return s.join("");return"".concat(s.join(""),"...")};function Qxe(e,t,r,n,i){if(!(t.length<=0)){var a=(i==null?void 0:i.direction)||["top","right","bottom","left"],o=(i==null?void 0:i.action)||"translate",s=(i==null?void 0:i.margin)||0,l=t[0].get("coordinate");if(l){var u=_ye(l,s),c=u.minX,f=u.minY,d=u.maxX,v=u.maxY;ft(t,function(g){var x=g.getCanvasBBox(),w=x.minX,S=x.minY,A=x.maxX,M=x.maxY,R=x.x,O=x.y,N=x.width,k=x.height,V=R,Q=O;if(a.indexOf("left")>=0&&(w<c||A<c)&&(V=c),a.indexOf("top")>=0&&(S<f||M<f)&&(Q=f),a.indexOf("right")>=0&&(w>d?V=d-N:A>d&&(V=V-(A-d))),a.indexOf("bottom")>=0&&(S>v?Q=v-k:M>v&&(Q=Q-(M-v))),V!==R||Q!==O){var Y=V-R;if(o==="translate")t2(g,Y,Q-O);else if(o==="ellipsis"){var X=g.findAll(function(tt){return tt.get("type")==="text"});X.forEach(function(tt){var it=Up(tt.attr(),["fontSize","fontFamily","fontWeight","fontStyle","fontVariant"]),Et=tt.getCanvasBBox(),Tt=Kxe(tt.attr("text"),Et.width-Math.abs(Y),it);tt.attr("text",Tt)})}else g.hide()}})}}}function Jxe(e,t,r){var n={fillOpacity:ke(e.attr("fillOpacity"))?1:e.attr("fillOpacity"),strokeOpacity:ke(e.attr("strokeOpacity"))?1:e.attr("strokeOpacity"),opacity:ke(e.attr("opacity"))?1:e.attr("opacity")};e.attr({fillOpacity:0,strokeOpacity:0,opacity:0}),e.animate(n,t)}function tbe(e,t,r){var n={fillOpacity:0,strokeOpacity:0,opacity:0},i=t.easing,a=t.duration,o=t.delay;e.animate(n,a,i,function(){e.remove(!0)},o)}function ebe(e,t,r){var n,i=Lr(t,2),a=i[0],o=i[1];return e.applyToMatrix([a,o,1]),r==="x"?(e.setMatrix(Vs(e.getMatrix(),[["t",-a,-o],["s",.01,1],["t",a,o]])),n=Vs(e.getMatrix(),[["t",-a,-o],["s",100,1],["t",a,o]])):r==="y"?(e.setMatrix(Vs(e.getMatrix(),[["t",-a,-o],["s",1,.01],["t",a,o]])),n=Vs(e.getMatrix(),[["t",-a,-o],["s",1,100],["t",a,o]])):r==="xy"&&(e.setMatrix(Vs(e.getMatrix(),[["t",-a,-o],["s",.01,.01],["t",a,o]])),n=Vs(e.getMatrix(),[["t",-a,-o],["s",100,100],["t",a,o]])),n}function L6(e,t,r,n,i){var a=r.start,o=r.end,s=r.getWidth(),l=r.getHeight(),u,c;i==="y"?(u=a.x+s/2,c=n.y<a.y?n.y:a.y):i==="x"?(u=n.x>a.x?n.x:a.x,c=a.y+l/2):i==="xy"&&(r.isPolar?(u=r.getCenter().x,c=r.getCenter().y):(u=(a.x+o.x)/2,c=(a.y+o.y)/2));var f=ebe(e,[u,c],i);e.animate({matrix:f},t)}function rbe(e,t,r){var n=r.coordinate,i=r.minYPoint;L6(e,t,n,i,"x")}function nbe(e,t,r){var n=r.coordinate,i=r.minYPoint;L6(e,t,n,i,"y")}function ibe(e,t,r){var n=r.coordinate,i=r.minYPoint;L6(e,t,n,i,"xy")}function abe(e,t,r){var n=e.getTotalLength();e.attr("lineDash",[n]),e.animate(function(i){return{lineDashOffset:(1-i)*n}},t)}function obe(e,t,r){var n=r.toAttrs,i=n.x,a=n.y;delete n.x,delete n.y,e.attr(n),e.animate({x:i,y:a},t)}function sbe(e,t,r){var n=e.getBBox(),i=e.get("origin").mappingData,a=i.points,o=a[0].y-a[1].y>0?n.maxX:n.minX,s=(n.minY+n.maxY)/2;e.applyToMatrix([o,s,1]);var l=Vs(e.getMatrix(),[["t",-o,-s],["s",.01,1],["t",o,s]]);e.setMatrix(l),e.animate({matrix:Vs(e.getMatrix(),[["t",-o,-s],["s",100,1],["t",o,s]])},t)}function lbe(e,t,r){var n=e.getBBox(),i=e.get("origin").mappingData,a=(n.minX+n.maxX)/2,o=i.points,s=o[0].y-o[1].y<=0?n.maxY:n.minY;e.applyToMatrix([a,s,1]);var l=Vs(e.getMatrix(),[["t",-a,-s],["s",1,.01],["t",a,s]]);e.setMatrix(l),e.animate({matrix:Vs(e.getMatrix(),[["t",-a,-s],["s",1,100],["t",a,s]])},t)}function nY(e,t){var r,n=YM(e,t),i=n.startAngle,a=n.endAngle;return!Ul(i,-Math.PI*.5)&&i<-Math.PI*.5&&(i+=Math.PI*2),!Ul(a,-Math.PI*.5)&&a<-Math.PI*.5&&(a+=Math.PI*2),t[5]===0&&(r=Lr([a,i],2),i=r[0],a=r[1]),Ul(i,Math.PI*1.5)&&(i=Math.PI*-.5),Ul(a,Math.PI*-.5)&&!Ul(i,a)&&(a=Math.PI*1.5),{startAngle:i,endAngle:a}}function iY(e){var t;return e[0]==="M"||e[0]==="L"?t=[e[1],e[2]]:(e[0]==="a"||e[0]==="A"||e[0]==="C")&&(t=[e[e.length-2],e[e.length-1]]),t}function aY(e){var t,r,n,i=e.filter(function(M){return M[0]==="A"||M[0]==="a"});if(i.length===0)return{startAngle:0,endAngle:0,radius:0,innerRadius:0};var a=i[0],o=i.length>1?i[1]:i[0],s=e.indexOf(a),l=e.indexOf(o),u=iY(e[s-1]),c=iY(e[l-1]),f=nY(u,a),d=f.startAngle,v=f.endAngle,g=nY(c,o),x=g.startAngle,w=g.endAngle;Ul(d,x)&&Ul(v,w)?(r=d,n=v):(r=Math.min(d,x),n=Math.max(v,w));var S=a[1],A=i[i.length-1][1];return S<A?(t=Lr([A,S],2),S=t[0],A=t[1]):S===A&&(A=0),{startAngle:r,endAngle:n,radius:S,innerRadius:A}}function ube(e,t,r){var n=r.toAttrs,i=r.coordinate,a=n.path||[],o=a.map(function(A){return A[0]});if(!(a.length<1)){var s=aY(a),l=s.startAngle,u=s.endAngle,c=s.radius,f=s.innerRadius,d=aY(e.attr("path")),v=d.startAngle,g=d.endAngle,x=i.getCenter(),w=l-v,S=u-g;if(w===0&&S===0){e.attr(n);return}e.animate(function(A){var M=v+A*w,R=g+A*S;return U(U({},n),{path:zi(o,["M","A","A","Z"])?elt(x.x,x.y,c,M,R):$m(x.x,x.y,c,M,R,f)})},U(U({},t),{callback:function(){e.attr("path",a),$r(t.callback)&&t.callback()}}))}}function cbe(e,t,r){var n=p6(r.coordinate,20),i=n.type,a=n.startState,o=n.endState,s=e.setClip({type:i,attrs:a});r.toAttrs&&e.attr(r.toAttrs),s.animate(o,U(U({},t),{callback:function(){e&&!e.get("destroyed")&&e.set("clipShape",null),s.remove(!0),$r(t.callback)&&t.callback()}}))}function O6(e,t,r){if(e.isGroup())ft(e.getChildren(),function(s){O6(s,t,r)});else{var n=e.getBBox(),i=(n.minX+n.maxX)/2,a=(n.minY+n.maxY)/2;if(e.applyToMatrix([i,a,1]),r==="zoomIn"){var o=Vs(e.getMatrix(),[["t",-i,-a],["s",.01,.01],["t",i,a]]);e.setMatrix(o),e.animate({matrix:Vs(e.getMatrix(),[["t",-i,-a],["s",100,100],["t",i,a]])},t)}else e.animate({matrix:Vs(e.getMatrix(),[["t",-i,-a],["s",.01,.01],["t",i,a]])},U(U({},t),{callback:function(){e.remove(!0),$r(t.callback)&&t.callback()}}))}}function hbe(e,t,r){O6(e,t,"zoomIn")}function fbe(e,t,r){O6(e,t,"zoomOut")}function hg(e){return[xr.TOP,xr.BOTTOM].includes(e)?{offsetX:0,offsetY:e===xr.TOP?-8:8,style:{textAlign:"center",textBaseline:e===xr.TOP?"bottom":"top"}}:[xr.LEFT,xr.RIGHT].includes(e)?{offsetX:e===xr.LEFT?-8:8,offsetY:0,style:{textAlign:e===xr.LEFT?"right":"left",textBaseline:"middle",rotate:Math.PI/2}}:{}}function AP(e,t,r){return{x:e.x+t*Math.cos(r),y:e.y+t*Math.sin(r)}}var dbe=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultCfg=function(){return Tr({},e.prototype.getDefaultCfg.call(this),{type:"circle",showTitle:!0,title:e.prototype.getDefaultTitleCfg.call(this)})},t.prototype.render=function(){e.prototype.render.call(this),this.cfg.showTitle&&this.renderTitle()},t.prototype.getRegion=function(r,n){var i=.5,a={x:.5,y:.5},o=Math.PI*2/r,s=-1*Math.PI/2+o*n,l=i/(1+1/Math.sin(o/2)),u=AP(a,i-l,s),c=Math.PI*5/4,f=Math.PI*1/4;return{start:AP(u,l,c),end:AP(u,l,f)}},t.prototype.afterEachView=function(r,n){this.processAxis(r,n)},t.prototype.beforeEachView=function(r,n){},t.prototype.generateFacets=function(r){var n=this,i=this.cfg,a=i.fields,o=i.type,s=Lr(a,1),l=s[0];if(!l)throw new Error("No `fields` specified!");var u=this.getFieldValues(r,l),c=u.length,f=[];return u.forEach(function(d,v){var g=[{field:l,value:d,values:u}],x=Wl(r,n.getFacetDataFilter(g)),w={type:o,data:x,region:n.getRegion(c,v),columnValue:d,columnField:l,columnIndex:v,columnValuesLength:c,rowValue:null,rowField:null,rowIndex:0,rowValuesLength:1};f.push(w)}),f},t.prototype.getXAxisOption=function(r,n,i,a){return i},t.prototype.getYAxisOption=function(r,n,i,a){return i},t.prototype.renderTitle=function(){var r=this;ft(this.facets,function(n){var i=n.columnValue,a=n.view,o=xt(r.cfg.title,"formatter"),s=Tr({position:["50%","0%"],content:o?o(i):i},hg(xr.TOP),r.cfg.title);a.annotation().text(s)})},t}(kb),pbe=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultCfg=function(){return Tr({},e.prototype.getDefaultCfg.call(this),{type:"list",cols:null,showTitle:!0,title:e.prototype.getDefaultTitleCfg.call(this)})},t.prototype.render=function(){e.prototype.render.call(this),this.cfg.showTitle&&this.renderTitle()},t.prototype.afterEachView=function(r,n){this.processAxis(r,n)},t.prototype.beforeEachView=function(r,n){},t.prototype.generateFacets=function(r){var n=this,i=this.cfg.fields,a=this.cfg.cols,o=Lr(i,1),s=o[0];if(!s)throw new Error("No `fields` specified!");var l=this.getFieldValues(r,s),u=l.length;a=a||u;var c=this.getPageCount(u,a),f=[];return l.forEach(function(d,v){var g=n.getRowCol(v,a),x=g.row,w=g.col,S=[{field:s,value:d,values:l}],A=Wl(r,n.getFacetDataFilter(S)),M={type:n.cfg.type,data:A,region:n.getRegion(c,a,w,x),columnValue:d,rowValue:d,columnField:s,rowField:null,columnIndex:w,rowIndex:x,columnValuesLength:a,rowValuesLength:c,total:u};f.push(M)}),f},t.prototype.getXAxisOption=function(r,n,i,a){return a.rowIndex!==a.rowValuesLength-1&&a.columnValuesLength*a.rowIndex+a.columnIndex+1+a.columnValuesLength<=a.total?U(U({},i),{label:null,title:null}):i},t.prototype.getYAxisOption=function(r,n,i,a){return a.columnIndex!==0?U(U({},i),{title:null,label:null}):i},t.prototype.renderTitle=function(){var r=this;ft(this.facets,function(n){var i=n.columnValue,a=n.view,o=xt(r.cfg.title,"formatter"),s=Tr({position:["50%","0%"],content:o?o(i):i},hg(xr.TOP),r.cfg.title);a.annotation().text(s)})},t.prototype.getPageCount=function(r,n){return Math.floor((r+n-1)/n)},t.prototype.getRowCol=function(r,n){var i=Math.floor(r/n),a=r%n;return{row:i,col:a}},t}(kb),vbe=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultCfg=function(){return Tr({},e.prototype.getDefaultCfg.call(this),{type:"matrix",showTitle:!1,columnTitle:U({},e.prototype.getDefaultTitleCfg.call(this)),rowTitle:U({},e.prototype.getDefaultTitleCfg.call(this))})},t.prototype.render=function(){e.prototype.render.call(this),this.cfg.showTitle&&this.renderTitle()},t.prototype.afterEachView=function(r,n){this.processAxis(r,n)},t.prototype.beforeEachView=function(r,n){},t.prototype.generateFacets=function(r){for(var n=this.cfg,i=n.fields,a=n.type,o=i.length,s=o,l=[],u=0;u<s;u++)for(var c=i[u],f=0;f<o;f++){var d=i[f],v={type:a,data:r,region:this.getRegion(o,s,u,f),columnValue:c,rowValue:d,columnField:c,rowField:d,columnIndex:u,rowIndex:f,columnValuesLength:s,rowValuesLength:o};l.push(v)}return l},t.prototype.getXAxisOption=function(r,n,i,a){return a.rowIndex!==a.rowValuesLength-1?U(U({},i),{label:null,title:null}):i},t.prototype.getYAxisOption=function(r,n,i,a){return a.columnIndex!==0?U(U({},i),{title:null,label:null}):i},t.prototype.renderTitle=function(){var r=this;ft(this.facets,function(n,i){var a=n.columnIndex,o=n.rowIndex,s=n.columnValuesLength;n.rowValuesLength;var l=n.columnValue,u=n.rowValue,c=n.view;if(o===0){var f=xt(r.cfg.columnTitle,"formatter"),d=Tr({position:["50%","0%"],content:f?f(l):l},hg(xr.TOP),r.cfg.columnTitle);c.annotation().text(d)}if(a===s-1){var f=xt(r.cfg.rowTitle,"formatter"),d=Tr({position:["100%","50%"],content:f?f(u):u},hg(xr.RIGHT),r.cfg.rowTitle);c.annotation().text(d)}})},t}(kb),gbe=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getDefaultCfg=function(){return Tr({},e.prototype.getDefaultCfg.call(this),{type:"mirror",showTitle:!0,title:e.prototype.getDefaultTitleCfg.call(this),transpose:!1})},t.prototype.render=function(){e.prototype.render.call(this),this.cfg.showTitle&&this.renderTitle()},t.prototype.beforeEachView=function(r,n){this.cfg.transpose?n.columnIndex%2===0?r.coordinate().transpose().reflect("x"):r.coordinate().transpose():n.rowIndex%2!==0&&r.coordinate().reflect("y")},t.prototype.afterEachView=function(r,n){this.processAxis(r,n)},t.prototype.generateFacets=function(r){var n=this,i=Lr(this.cfg.fields,1),a=i[0],o=[],s=1,l=1,u=[""],c=[""],f,d;return this.cfg.transpose?(f=a,u=this.getFieldValues(r,f).slice(0,2),s=u.length):(d=a,c=this.getFieldValues(r,d).slice(0,2),l=c.length),u.forEach(function(v,g){c.forEach(function(x,w){var S=[{field:f,value:v,values:u},{field:d,value:x,values:c}],A=Wl(r,n.getFacetDataFilter(S)),M={type:n.cfg.type,data:A,region:n.getRegion(l,s,g,w),columnValue:v,rowValue:x,columnField:f,rowField:d,columnIndex:g,rowIndex:w,columnValuesLength:s,rowValuesLength:l};o.push(M)})}),o},t.prototype.getXAxisOption=function(r,n,i,a){return a.columnIndex===1||a.rowIndex===1?U(U({},i),{label:null,title:null}):i},t.prototype.getYAxisOption=function(r,n,i,a){return i},t.prototype.renderTitle=function(){var r=this;ft(this.facets,function(n,i){var a=n.columnValue,o=n.rowValue,s=n.view,l=xt(r.cfg.title,"formatter");if(r.cfg.transpose){var u=Tr({position:["50%","0%"],content:l?l(a):a},hg(xr.TOP),r.cfg.title);s.annotation().text(u)}else{var u=Tr({position:["100%","50%"],content:l?l(o):o},hg(xr.RIGHT),r.cfg.title);s.annotation().text(u)}})},t}(kb),mbe=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.afterEachView=function(r,n){this.processAxis(r,n)},t.prototype.beforeEachView=function(r,n){},t.prototype.getDefaultCfg=function(){return Tr({},e.prototype.getDefaultCfg.call(this),{type:"rect",columnTitle:U({},e.prototype.getDefaultTitleCfg.call(this)),rowTitle:U({},e.prototype.getDefaultTitleCfg.call(this))})},t.prototype.render=function(){e.prototype.render.call(this),this.cfg.showTitle&&this.renderTitle()},t.prototype.generateFacets=function(r){var n=this,i=Lr(this.cfg.fields,2),a=i[0],o=i[1],s=[],l=1,u=1,c=[""],f=[""];return a&&(c=this.getFieldValues(r,a),l=c.length),o&&(f=this.getFieldValues(r,o),u=f.length),c.forEach(function(d,v){f.forEach(function(g,x){var w=[{field:a,value:d,values:c},{field:o,value:g,values:f}],S=Wl(r,n.getFacetDataFilter(w)),A={type:n.cfg.type,data:S,region:n.getRegion(u,l,v,x),columnValue:d,rowValue:g,columnField:a,rowField:o,columnIndex:v,rowIndex:x,columnValuesLength:l,rowValuesLength:u};s.push(A)})}),s},t.prototype.renderTitle=function(){var r=this;ft(this.facets,function(n,i){var a=n.columnIndex,o=n.rowIndex,s=n.columnValuesLength,l=n.columnValue,u=n.rowValue,c=n.view;if(o===0){var f=xt(r.cfg.columnTitle,"formatter"),d=Tr({position:["50%","0%"],content:f?f(l):l},hg(xr.TOP),r.cfg.columnTitle);c.annotation().text(d)}if(a===s-1){var f=xt(r.cfg.rowTitle,"formatter"),d=Tr({position:["100%","50%"],content:f?f(u):u},hg(xr.RIGHT),r.cfg.rowTitle);c.annotation().text(d)}})},t.prototype.getXAxisOption=function(r,n,i,a){return a.rowIndex!==a.rowValuesLength-1?U(U({},i),{title:null,label:null}):a.columnIndex!==Math.floor((a.columnValuesLength-1)/2)?U(U({},i),{title:null}):i},t.prototype.getYAxisOption=function(r,n,i,a){return a.columnIndex!==0?U(U({},i),{title:null,label:null}):a.rowIndex!==Math.floor((a.rowValuesLength-1)/2)?U(U({},i),{title:null}):i},t}(kb),ybe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.afterChartRender=function(){r.facets&&r.cfg.line&&(r.container.clear(),r.drawLines(r.facets))},r}return t.prototype.afterEachView=function(r,n){this.processAxis(r,n)},t.prototype.beforeEachView=function(r,n){},t.prototype.init=function(){e.prototype.init.call(this),this.view.on(di.AFTER_RENDER,this.afterChartRender)},t.prototype.getDefaultCfg=function(){return Tr({},e.prototype.getDefaultCfg.call(this),{type:"tree",line:{style:{lineWidth:1,stroke:"#ddd"},smooth:!1},showTitle:!0,title:e.prototype.getDefaultTitleCfg.call(this)})},t.prototype.generateFacets=function(r){var n=this.cfg.fields;if(!n.length)throw new Error("Please specify for the fields for rootFacet!");var i=[],a={type:this.cfg.type,data:r,region:null,rowValuesLength:this.getRows(),columnValuesLength:1,rowIndex:0,columnIndex:0,rowField:"",columnField:"",rowValue:"",columnValue:""};return i.push(a),a.children=this.getChildFacets(r,1,i),this.setRegion(i),i},t.prototype.setRegion=function(r){var n=this;this.forceColIndex(r),r.forEach(function(i){i.region=n.getRegion(i.rowValuesLength,i.columnValuesLength,i.columnIndex,i.rowIndex)})},t.prototype.getRegion=function(r,n,i,a){var o=1/n,s=1/r,l={x:o*i,y:s*a},u={x:l.x+o,y:l.y+s*2/3};return{start:l,end:u}},t.prototype.forceColIndex=function(r){var n,i,a=this,o=[],s=0;r.forEach(function(g){a.isLeaf(g)&&(o.push(g),g.columnIndex=s,s++)}),o.forEach(function(g){g.columnValuesLength=o.length});for(var l=this.cfg.fields.length,u=l-1;u>=0;u--){var c=this.getFacetsByLevel(r,u);try{for(var f=(n=void 0,mi(c)),d=f.next();!d.done;d=f.next()){var v=d.value;this.isLeaf(v)||(v.originColIndex=v.columnIndex,v.columnIndex=this.getRegionIndex(v.children),v.columnValuesLength=o.length)}}catch(g){n={error:g}}finally{try{d&&!d.done&&(i=f.return)&&i.call(f)}finally{if(n)throw n.error}}}},t.prototype.getFacetsByLevel=function(r,n){var i=[];return r.forEach(function(a){a.rowIndex===n&&i.push(a)}),i},t.prototype.getRegionIndex=function(r){var n=r[0],i=r[r.length-1];return(i.columnIndex-n.columnIndex)/2+n.columnIndex},t.prototype.isLeaf=function(r){return!r.children||!r.children.length},t.prototype.getRows=function(){return this.cfg.fields.length+1},t.prototype.getChildFacets=function(r,n,i){var a=this,o=this.cfg.fields,s=o.length;if(!(s<n)){var l=[],u=o[n-1],c=this.getFieldValues(r,u);return c.forEach(function(f,d){var v=[{field:u,value:f,values:c}],g=r.filter(a.getFacetDataFilter(v));if(g.length){var x={type:a.cfg.type,data:g,region:null,columnValue:f,rowValue:"",columnField:u,rowField:"",columnIndex:d,rowValuesLength:a.getRows(),columnValuesLength:1,rowIndex:n,children:a.getChildFacets(g,n+1,i)};l.push(x),i.push(x)}}),l}},t.prototype.render=function(){e.prototype.render.call(this),this.cfg.showTitle&&this.renderTitle()},t.prototype.renderTitle=function(){var r=this;ft(this.facets,function(n){var i=n.columnValue,a=n.view,o=xt(r.cfg.title,"formatter"),s=Tr({position:["50%","0%"],content:o?o(i):i},hg(xr.TOP),r.cfg.title);a.annotation().text(s)})},t.prototype.drawLines=function(r){var n=this;r.forEach(function(i){if(!n.isLeaf(i)){var a=i.children;n.addFacetLines(i,a)}})},t.prototype.addFacetLines=function(r,n){var i=this,a=r.view,o=a.coordinateBBox,s={x:o.x+o.width/2,y:o.y+o.height};n.forEach(function(l){var u=l.view.coordinateBBox,c={x:u.bl.x+(u.tr.x-u.bl.x)/2,y:u.tr.y},f={x:s.x,y:s.y+(c.y-s.y)/2},d={x:c.x,y:f.y};i.drawLine([s,f,d,c])})},t.prototype.getPath=function(r){var n=[],i=this.cfg.line.smooth;return i?(n.push(["M",r[0].x,r[0].y]),n.push(["C",r[1].x,r[1].y,r[2].x,r[2].y,r[3].x,r[3].y])):r.forEach(function(a,o){o===0?n.push(["M",a.x,a.y]):n.push(["L",a.x,a.y])}),n},t.prototype.drawLine=function(r){var n=this.getPath(r),i=this.cfg.line.style;this.container.addShape("path",{attrs:Sa({path:n},i)})},t.prototype.getXAxisOption=function(r,n,i,a){return a.rowIndex!==a.rowValuesLength-1?U(U({},i),{title:null,label:null}):i},t.prototype.getYAxisOption=function(r,n,i,a){return a.originColIndex!==0&&a.columnIndex!==0?U(U({},i),{title:null,label:null}):i},t}(kb);function oY(e){var t=an([],Lr(e),!1);t.sort(function(n,i){return n-i});var r=t.length;return r===0?0:r%2===1?t[(r-1)/2]:(t[r/2]+t[r/2-1])/2}function _be(e){var t=Fu(e,function(r,n){return r+=isNaN(n)||!Gn(n)?0:n},0);return e.length===0?0:t/e.length}function lA(e,t){if(!t)return null;var r;switch(e){case"start":return 0;case"center":return .5;case"end":return 1;case"median":{r=t.isCategory?oY(t.values.map(function(n,i){return i})):oY(t.values);break}case"mean":{r=t.isCategory?(t.values.length-1)/2:_be(t.values);break}case"min":r=t.isCategory?0:t[e];break;case"max":r=t.isCategory?t.values.length-1:t[e];break;default:r=e;break}return t.scale(r)}var uA=["regionFilter","shape"],xbe=function(e){Ut(t,e);function t(r){var n=e.call(this,r)||this;return n.cache=new Map,n.foregroundContainer=n.view.getLayer(ys.FORE).addGroup(),n.backgroundContainer=n.view.getLayer(ys.BG).addGroup(),n.option=[],n}return Object.defineProperty(t.prototype,"name",{get:function(){return"annotation"},enumerable:!1,configurable:!0}),t.prototype.init=function(){},t.prototype.layout=function(){this.update()},t.prototype.render=function(){},t.prototype.update=function(){var r=this;this.onAfterRender(function(){var i=new Map;ft(r.option,function(a){if(yy(uA,a.type)){var o=r.updateOrCreate(a);o&&i.set(r.getCacheKey(a),o)}}),r.cache=r.syncCache(i)});var n=new Map;ft(this.option,function(i){if(!yy(uA,i.type)){var a=r.updateOrCreate(i);a&&n.set(r.getCacheKey(i),a)}}),this.cache=this.syncCache(n)},t.prototype.clear=function(r){r===void 0&&(r=!1),e.prototype.clear.call(this),this.clearComponents(),this.foregroundContainer.clear(),this.backgroundContainer.clear(),r&&(this.option=[])},t.prototype.destroy=function(){this.clear(!0),this.foregroundContainer.remove(!0),this.backgroundContainer.remove(!0)},t.prototype.getComponents=function(){var r=[];return this.cache.forEach(function(n){r.push(n)}),r},t.prototype.clearComponents=function(){this.getComponents().forEach(function(r){r.component.destroy()}),this.cache.clear()},t.prototype.onAfterRender=function(r){var n=!1;this.view.getOptions().animate&&this.view.geometries.forEach(function(i){i.animateOption&&(i.once(zm.AFTER_DRAW_ANIMATE,function(){r()}),n=!0)}),n||this.view.getRootView().once(di.AFTER_RENDER,function(){r()})},t.prototype.createAnnotation=function(r){var n=r.type,i=u0e[C_(n)];if(i){var a=this.getAnnotationTheme(n),o=this.getAnnotationCfg(n,r,a);if(!o)return null;var s=new i(o);return{component:s,layer:this.isTop(o)?ys.FORE:ys.BG,direction:xr.NONE,type:gl.ANNOTATION,extra:r}}},t.prototype.annotation=function(r){this.option.push(r)},t.prototype.arc=function(r){return this.annotation(U({type:"arc"},r)),this},t.prototype.image=function(r){return this.annotation(U({type:"image"},r)),this},t.prototype.line=function(r){return this.annotation(U({type:"line"},r)),this},t.prototype.region=function(r){return this.annotation(U({type:"region"},r)),this},t.prototype.text=function(r){return this.annotation(U({type:"text"},r)),this},t.prototype.dataMarker=function(r){return this.annotation(U({type:"dataMarker"},r)),this},t.prototype.dataRegion=function(r){this.annotation(U({type:"dataRegion"},r))},t.prototype.regionFilter=function(r){this.annotation(U({type:"regionFilter"},r))},t.prototype.shape=function(r){this.annotation(U({type:"shape"},r))},t.prototype.html=function(r){this.annotation(U({type:"html"},r))},t.prototype.parsePosition=function(r){var n,i,a=this.view.getXScale(),o=this.view.getScalesByDim("y"),s=$r(r)?r.call(null,a,o):r,l=0,u=0;if(ze(s)){var c=Lr(s,2),f=c[0],d=c[1];if(nn(f)&&f.indexOf("%")!==-1&&!isNaN(f.slice(0,-1)))return this.parsePercentPosition(s);l=lA(f,a),u=lA(d,Object.values(o)[0])}else if(!ke(s))try{for(var v=mi(Eb(s)),g=v.next();!g.done;g=v.next()){var x=g.value,w=s[x];x===a.field&&(l=lA(w,a)),o[x]&&(u=lA(w,o[x]))}}catch(S){n={error:S}}finally{try{g&&!g.done&&(i=v.return)&&i.call(v)}finally{if(n)throw n.error}}return isNaN(l)||isNaN(u)?null:this.view.getCoordinate().convert({x:l,y:u})},t.prototype.getRegionPoints=function(r,n){var i=this,a=this.view.getXScale(),o=this.view.getScalesByDim("y"),s=Object.values(o)[0],l=a.field,u=this.view.getData(),c=ze(r)?r[0]:r[l],f=ze(n)?n[0]:n[l],d=[],v;return ft(u,function(g,x){if(g[l]===c&&(v=x),x>=v){var w=i.parsePosition([g[l],g[s.field]]);w&&d.push(w)}if(g[l]===f)return!1}),d},t.prototype.parsePercentPosition=function(r){var n=parseFloat(r[0])/100,i=parseFloat(r[1])/100,a=this.view.getCoordinate(),o=a.start,s=a.end,l={x:Math.min(o.x,s.x),y:Math.min(o.y,s.y)},u=a.getWidth()*n+l.x,c=a.getHeight()*i+l.y;return{x:u,y:c}},t.prototype.getCoordinateBBox=function(){var r=this.view.getCoordinate(),n=r.start,i=r.end,a=r.getWidth(),o=r.getHeight(),s={x:Math.min(n.x,i.x),y:Math.min(n.y,i.y)};return{x:s.x,y:s.y,minX:s.x,minY:s.y,maxX:s.x+a,maxY:s.y+o,width:a,height:o}},t.prototype.getAnnotationCfg=function(r,n,i){var a=this,o=this.view.getCoordinate(),s=this.view.getCanvas(),l={};if(ke(n))return null;var u=n.start,c=n.end,f=n.position,d=this.parsePosition(u),v=this.parsePosition(c),g=this.parsePosition(f);if(["arc","image","line","region","regionFilter"].includes(r)&&(!d||!v))return null;if(["text","dataMarker","html"].includes(r)&&!g)return null;if(r==="arc"){var x=n;x.start,x.end;var w=hi(x,["start","end"]),S=ab(o,d),A=ab(o,v);S>A&&(A=Math.PI*2+A),l=U(U({},w),{center:o.getCenter(),radius:z3(o,d),startAngle:S,endAngle:A})}else if(r==="image"){var M=n;M.start,M.end;var w=hi(M,["start","end"]);l=U(U({},w),{start:d,end:v,src:n.src})}else if(r==="line"){var R=n;R.start,R.end;var w=hi(R,["start","end"]);l=U(U({},w),{start:d,end:v,text:xt(n,"text",null)})}else if(r==="region"){var O=n;O.start,O.end;var w=hi(O,["start","end"]);l=U(U({},w),{start:d,end:v})}else if(r==="text"){var N=this.view.getData(),k=n;k.position;var V=k.content,w=hi(k,["position","content"]),Q=V;$r(V)&&(Q=V(N)),l=U(U(U({},g),w),{content:Q})}else if(r==="dataMarker"){var Y=n;Y.position;var X=Y.point,tt=Y.line,it=Y.text,Et=Y.autoAdjust,Tt=Y.direction,w=hi(Y,["position","point","line","text","autoAdjust","direction"]);l=U(U(U({},w),g),{coordinateBBox:this.getCoordinateBBox(),point:X,line:tt,text:it,autoAdjust:Et,direction:Tt})}else if(r==="dataRegion"){var pt=n,kt=pt.start,ae=pt.end,Kt=pt.region,it=pt.text,re=pt.lineLength,w=hi(pt,["start","end","region","text","lineLength"]);l=U(U({},w),{points:this.getRegionPoints(kt,ae),region:Kt,text:it,lineLength:re})}else if(r==="regionFilter"){var fe=n;fe.start,fe.end;var Oe=fe.apply,Ye=fe.color,w=hi(fe,["start","end","apply","color"]),Be=this.view.geometries,De=[],Yr=function(vn){vn&&(vn.isGroup()?vn.getChildren().forEach(function(xn){return Yr(xn)}):De.push(vn))};ft(Be,function(vn){Oe?yy(Oe,vn.type)&&ft(vn.elements,function(xn){Yr(xn.shape)}):ft(vn.elements,function(xn){Yr(xn.shape)})}),l=U(U({},w),{color:Ye,shapes:De,start:d,end:v})}else if(r==="shape"){var Gr=n,Mn=Gr.render,ee=hi(Gr,["render"]),rr=function(Kn){if($r(n.render))return Mn(Kn,a.view,{parsePosition:a.parsePosition.bind(a)})};l=U(U({},ee),{render:rr})}else if(r==="html"){var Nr=n,Fe=Nr.html;Nr.position;var ee=hi(Nr,["html","position"]),Hr=function(vn){return $r(Fe)?Fe(vn,a.view):Fe};l=U(U(U({},ee),g),{parent:s.get("el").parentNode,html:Hr})}var _n=Tr({},i,U(U({},l),{top:n.top,style:n.style,offsetX:n.offsetX,offsetY:n.offsetY}));return r!=="html"&&(_n.container=this.getComponentContainer(_n)),_n.animate=this.view.getOptions().animate&&_n.animate&&xt(n,"animate",_n.animate),_n.animateOption=Tr({},sb,_n.animateOption,n.animateOption),_n},t.prototype.isTop=function(r){return xt(r,"top",!0)},t.prototype.getComponentContainer=function(r){return this.isTop(r)?this.foregroundContainer:this.backgroundContainer},t.prototype.getAnnotationTheme=function(r){return xt(this.view.getTheme(),["components","annotation",r],{})},t.prototype.updateOrCreate=function(r){var n=this.cache.get(this.getCacheKey(r));if(n){var i=r.type,a=this.getAnnotationTheme(i),o=this.getAnnotationCfg(i,r,a);o&&$c(o,["container"]),n.component.update(U(U({},o||{}),{visible:!!o})),yy(uA,r.type)&&n.component.render()}else n=this.createAnnotation(r),n&&(n.component.init(),yy(uA,r.type)&&n.component.render());return n},t.prototype.syncCache=function(r){var n=this,i=new Map(this.cache);return r.forEach(function(a,o){i.set(o,a)}),i.forEach(function(a,o){Bd(n.option,function(s){return o===n.getCacheKey(s)})||(a.component.destroy(),i.delete(o))}),i},t.prototype.getCacheKey=function(r){return r},t}(Ub);function sY(e,t){var r=Tr({},xt(e,["components","axis","common"]),xt(e,["components","axis",t]));return xt(r,["grid"],{})}function cA(e,t,r,n){var i=[],a=t.getTicks();return e.isPolar&&a.push({value:1,text:"",tickValue:""}),a.reduce(function(o,s,l){var u=s.value;if(n)i.push({points:[e.convert(r==="y"?{x:0,y:u}:{x:u,y:0}),e.convert(r==="y"?{x:1,y:u}:{x:u,y:1})]});else if(l){var c=o.value,f=(c+u)/2;i.push({points:[e.convert(r==="y"?{x:0,y:f}:{x:f,y:0}),e.convert(r==="y"?{x:1,y:f}:{x:f,y:1})]})}return s},a[0]),i}function MP(e,t,r,n,i){var a=t.values.length,o=[],s=r.getTicks();return s.reduce(function(l,u){var c=l?l.value:u.value,f=u.value,d=(c+f)/2;return i==="x"?o.push({points:[e.convert({x:n?f:d,y:0}),e.convert({x:n?f:d,y:1})]}):o.push({points:mo(Array(a+1),function(v,g){return e.convert({x:g/a,y:n?f:d})})}),u},s[0]),o}function lY(e,t){var r=xt(t,"grid");if(r===null)return!1;var n=xt(e,"grid");return!(r===void 0&&n===null)}var hm=["container"],uY=U(U({},sb),{appear:null}),bbe=function(e){Ut(t,e);function t(r){var n=e.call(this,r)||this;return n.cache=new Map,n.gridContainer=n.view.getLayer(ys.BG).addGroup(),n.gridForeContainer=n.view.getLayer(ys.FORE).addGroup(),n.axisContainer=n.view.getLayer(ys.BG).addGroup(),n.axisForeContainer=n.view.getLayer(ys.FORE).addGroup(),n}return Object.defineProperty(t.prototype,"name",{get:function(){return"axis"},enumerable:!1,configurable:!0}),t.prototype.init=function(){},t.prototype.render=function(){this.update()},t.prototype.layout=function(){var r=this,n=this.view.getCoordinate();ft(this.getComponents(),function(i){var a=i.component,o=i.direction,s=i.type,l=i.extra,u=l.dim,c=l.scale,f=l.alignTick,d;if(s===gl.AXIS)n.isPolar?u==="x"?d=n.isTransposed?eA(n,o):xP(n):u==="y"&&(d=n.isTransposed?xP(n):eA(n,o)):d=eA(n,o);else if(s===gl.GRID)if(n.isPolar){var v=void 0;n.isTransposed?v=u==="x"?MP(n,r.view.getYScales()[0],c,f,u):cA(n,c,u,f):v=u==="x"?cA(n,c,u,f):MP(n,r.view.getXScale(),c,f,u),d={items:v,center:r.view.getCoordinate().getCenter()}}else d={items:cA(n,c,u,f)};a.update(d)})},t.prototype.update=function(){this.option=this.view.getOptions().axes;var r=new Map;this.updateXAxes(r),this.updateYAxes(r);var n=new Map;this.cache.forEach(function(i,a){r.has(a)?n.set(a,i):i.component.destroy()}),this.cache=n},t.prototype.clear=function(){e.prototype.clear.call(this),this.cache.clear(),this.gridContainer.clear(),this.gridForeContainer.clear(),this.axisContainer.clear(),this.axisForeContainer.clear()},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.gridContainer.remove(!0),this.gridForeContainer.remove(!0),this.axisContainer.remove(!0),this.axisForeContainer.remove(!0)},t.prototype.getComponents=function(){var r=[];return this.cache.forEach(function(n){r.push(n)}),r},t.prototype.updateXAxes=function(r){var n=this.view.getXScale();if(!(!n||n.isIdentity)){var i=BR(this.option,n.field);if(i!==!1){var a=bj(i,xr.BOTTOM),o=ys.BG,s="x",l=this.view.getCoordinate(),u=this.getId("axis",n.field),c=this.getId("grid",n.field);if(l.isRect){var f=this.cache.get(u);if(f){var d=this.getLineAxisCfg(n,i,a);$c(d,hm),f.component.update(d),r.set(u,f)}else f=this.createLineAxis(n,i,o,a,s),this.cache.set(u,f),r.set(u,f);var v=this.cache.get(c);if(v){var d=this.getLineGridCfg(n,i,a,s);$c(d,hm),v.component.update(d),r.set(c,v)}else v=this.createLineGrid(n,i,o,a,s),v&&(this.cache.set(c,v),r.set(c,v))}else if(l.isPolar){var f=this.cache.get(u);if(f){var d=l.isTransposed?this.getLineAxisCfg(n,i,xr.RADIUS):this.getCircleAxisCfg(n,i,a);$c(d,hm),f.component.update(d),r.set(u,f)}else{if(l.isTransposed){if(iu(i))return;f=this.createLineAxis(n,i,o,xr.RADIUS,s)}else f=this.createCircleAxis(n,i,o,a,s);this.cache.set(u,f),r.set(u,f)}var v=this.cache.get(c);if(v){var d=l.isTransposed?this.getCircleGridCfg(n,i,xr.RADIUS,s):this.getLineGridCfg(n,i,xr.CIRCLE,s);$c(d,hm),v.component.update(d),r.set(c,v)}else{if(l.isTransposed){if(iu(i))return;v=this.createCircleGrid(n,i,o,xr.RADIUS,s)}else v=this.createLineGrid(n,i,o,xr.CIRCLE,s);v&&(this.cache.set(c,v),r.set(c,v))}}}}},t.prototype.updateYAxes=function(r){var n=this,i=this.view.getYScales();ft(i,function(a,o){if(!(!a||a.isIdentity)){var s=a.field,l=BR(n.option,s);if(l!==!1){var u=ys.BG,c="y",f=n.getId("axis",s),d=n.getId("grid",s),v=n.view.getCoordinate();if(v.isRect){var g=bj(l,o===0?xr.LEFT:xr.RIGHT),x=n.cache.get(f);if(x){var w=n.getLineAxisCfg(a,l,g);$c(w,hm),x.component.update(w),r.set(f,x)}else x=n.createLineAxis(a,l,u,g,c),n.cache.set(f,x),r.set(f,x);var S=n.cache.get(d);if(S){var w=n.getLineGridCfg(a,l,g,c);$c(w,hm),S.component.update(w),r.set(d,S)}else S=n.createLineGrid(a,l,u,g,c),S&&(n.cache.set(d,S),r.set(d,S))}else if(v.isPolar){var x=n.cache.get(f);if(x){var w=v.isTransposed?n.getCircleAxisCfg(a,l,xr.CIRCLE):n.getLineAxisCfg(a,l,xr.RADIUS);$c(w,hm),x.component.update(w),r.set(f,x)}else{if(v.isTransposed){if(iu(l))return;x=n.createCircleAxis(a,l,u,xr.CIRCLE,c)}else x=n.createLineAxis(a,l,u,xr.RADIUS,c);n.cache.set(f,x),r.set(f,x)}var S=n.cache.get(d);if(S){var w=v.isTransposed?n.getLineGridCfg(a,l,xr.CIRCLE,c):n.getCircleGridCfg(a,l,xr.RADIUS,c);$c(w,hm),S.component.update(w),r.set(d,S)}else{if(v.isTransposed){if(iu(l))return;S=n.createLineGrid(a,l,u,xr.CIRCLE,c)}else S=n.createCircleGrid(a,l,u,xr.RADIUS,c);S&&(n.cache.set(d,S),r.set(d,S))}}}}})},t.prototype.createLineAxis=function(r,n,i,a,o){var s={component:new lye(this.getLineAxisCfg(r,n,a)),layer:i,direction:a===xr.RADIUS?xr.NONE:a,type:gl.AXIS,extra:{dim:o,scale:r}};return s.component.set("field",r.field),s.component.init(),s},t.prototype.createLineGrid=function(r,n,i,a,o){var s=this.getLineGridCfg(r,n,a,o);if(s){var l={component:new cye(s),layer:i,direction:xr.NONE,type:gl.GRID,extra:{dim:o,scale:r,alignTick:xt(s,"alignTick",!0)}};return l.component.init(),l}},t.prototype.createCircleAxis=function(r,n,i,a,o){var s={component:new uye(this.getCircleAxisCfg(r,n,a)),layer:i,direction:a,type:gl.AXIS,extra:{dim:o,scale:r}};return s.component.set("field",r.field),s.component.init(),s},t.prototype.createCircleGrid=function(r,n,i,a,o){var s=this.getCircleGridCfg(r,n,a,o);if(s){var l={component:new hye(s),layer:i,direction:xr.NONE,type:gl.GRID,extra:{dim:o,scale:r,alignTick:xt(s,"alignTick",!0)}};return l.component.init(),l}},t.prototype.getLineAxisCfg=function(r,n,i){var a=xt(n,["top"])?this.axisForeContainer:this.axisContainer,o=this.view.getCoordinate(),s=eA(o,i),l=Ej(r,n),u=rA(this.view.getTheme(),i),c=xt(n,["title"])?Tr({title:{style:{text:l}}},{title:xj(this.view.getTheme(),i,n.title)},n):n,f=Tr(U(U({container:a},s),{ticks:r.getTicks().map(function(M){return{id:"".concat(M.tickValue),name:M.text,value:M.value}}),verticalFactor:o.isPolar?_j(s,o.getCenter())*-1:_j(s,o.getCenter()),theme:u}),u,c),d=this.getAnimateCfg(f),v=d.animate,g=d.animateOption;f.animateOption=g,f.animate=v;var x=alt(s),w=xt(f,"verticalLimitLength",x?1/3:1/2);if(w<=1){var S=this.view.getCanvas().get("width"),A=this.view.getCanvas().get("height");f.verticalLimitLength=w*(x?S:A)}return f},t.prototype.getLineGridCfg=function(r,n,i,a){if(lY(rA(this.view.getTheme(),i),n)){var o=sY(this.view.getTheme(),i),s=Tr({container:xt(n,["top"])?this.gridForeContainer:this.gridContainer},o,xt(n,"grid"),this.getAnimateCfg(n));return s.items=cA(this.view.getCoordinate(),r,a,xt(s,"alignTick",!0)),s}},t.prototype.getCircleAxisCfg=function(r,n,i){var a=xt(n,["top"])?this.axisForeContainer:this.axisContainer,o=this.view.getCoordinate(),s=r.getTicks().map(function(x){return{id:"".concat(x.tickValue),name:x.text,value:x.value}});!r.isCategory&&Math.abs(o.endAngle-o.startAngle)===Math.PI*2&&s.length&&(s[s.length-1].name="");var l=Ej(r,n),u=rA(this.view.getTheme(),xr.CIRCLE),c=xt(n,["title"])?Tr({title:{style:{text:l}}},{title:xj(this.view.getTheme(),i,n.title)},n):n,f=Tr(U(U({container:a},xP(this.view.getCoordinate())),{ticks:s,verticalFactor:1,theme:u}),u,c),d=this.getAnimateCfg(f),v=d.animate,g=d.animateOption;return f.animate=v,f.animateOption=g,f},t.prototype.getCircleGridCfg=function(r,n,i,a){if(lY(rA(this.view.getTheme(),i),n)){var o=sY(this.view.getTheme(),xr.RADIUS),s=Tr({container:xt(n,["top"])?this.gridForeContainer:this.gridContainer,center:this.view.getCoordinate().getCenter()},o,xt(n,"grid"),this.getAnimateCfg(n)),l=xt(s,"alignTick",!0),u=a==="x"?this.view.getYScales()[0]:this.view.getXScale();return s.items=MP(this.view.getCoordinate(),u,r,l,a),s}},t.prototype.getId=function(r,n){var i=this.view.getCoordinate();return"".concat(r,"-").concat(n,"-").concat(i.type)},t.prototype.getAnimateCfg=function(r){return{animate:this.view.getOptions().animate&&xt(r,"animate"),animateOption:r&&r.animateOption?Tr({},uY,r.animateOption):uY}},t}(Ub);function Om(e,t,r){return r===xr.TOP?[e.minX+e.width/2-t.width/2,e.minY]:r===xr.BOTTOM?[e.minX+e.width/2-t.width/2,e.maxY-t.height]:r===xr.LEFT?[e.minX,e.minY+e.height/2-t.height/2]:r===xr.RIGHT?[e.maxX-t.width,e.minY+e.height/2-t.height/2]:r===xr.TOP_LEFT||r===xr.LEFT_TOP?[e.tl.x,e.tl.y]:r===xr.TOP_RIGHT||r===xr.RIGHT_TOP?[e.tr.x-t.width,e.tr.y]:r===xr.BOTTOM_LEFT||r===xr.LEFT_BOTTOM?[e.bl.x,e.bl.y-t.height]:r===xr.BOTTOM_RIGHT||r===xr.RIGHT_BOTTOM?[e.br.x-t.width,e.br.y-t.height]:[0,0]}function cY(e,t){return Ym(e)?e===!1?!1:{}:xt(e,[t],e)}function hA(e){return xt(e,"position",xr.BOTTOM)}var Ebe=function(e){Ut(t,e);function t(r){var n=e.call(this,r)||this;return n.container=n.view.getLayer(ys.FORE).addGroup(),n}return Object.defineProperty(t.prototype,"name",{get:function(){return"legend"},enumerable:!1,configurable:!0}),t.prototype.init=function(){},t.prototype.render=function(){this.update()},t.prototype.layout=function(){var r=this;this.layoutBBox=this.view.viewBBox,ft(this.components,function(n){var i=n.component,a=n.direction,o=EP(a),s=i.get("maxWidthRatio"),l=i.get("maxHeightRatio"),u=r.getCategoryLegendSizeCfg(o,s,l),c=i.get("maxWidth"),f=i.get("maxHeight");i.update({maxWidth:Math.min(u.maxWidth,c||0),maxHeight:Math.min(u.maxHeight,f||0)});var d=i.get("padding"),v=i.getLayoutBBox(),g=new lc(v.x,v.y,v.width,v.height).expand(d),x=Lr(Om(r.view.viewBBox,g,a),2),w=x[0],S=x[1],A=Lr(Om(r.layoutBBox,g,a),2),M=A[0],R=A[1],O=0,N=0;a.startsWith("top")||a.startsWith("bottom")?(O=w,N=R):(O=M,N=S),i.setLocation({x:O+d[3],y:N+d[0]}),r.layoutBBox=r.layoutBBox.cut(g,a)})},t.prototype.update=function(){var r=this;this.option=this.view.getOptions().legends;var n={},i=function(d,v,g){var x=r.getId(g.field),w=r.getComponentById(x);if(w){var S=void 0,A=cY(r.option,g.field);A!==!1&&(xt(A,"custom")?S=r.getCategoryCfg(d,v,g,A,!0):g.isLinear?S=r.getContinuousCfg(d,v,g,A):g.isCategory&&(S=r.getCategoryCfg(d,v,g,A))),S&&($c(S,["container"]),w.direction=hA(A),w.component.update(S),n[x]=!0)}else{var M=r.createFieldLegend(d,v,g);M&&(M.component.init(),r.components.push(M),n[x]=!0)}};if(xt(this.option,"custom")){var a="global-custom",o=this.getComponentById(a);if(o){var s=this.getCategoryCfg(void 0,void 0,void 0,this.option,!0);$c(s,["container"]),o.component.update(s),n[a]=!0}else{var l=this.createCustomLegend(void 0,void 0,void 0,this.option);if(l){l.init();var u=ys.FORE,c=hA(this.option);this.components.push({id:a,component:l,layer:u,direction:c,type:gl.LEGEND,extra:void 0}),n[a]=!0}}}else this.loopLegends(i);var f=[];ft(this.getComponents(),function(d){n[d.id]?f.push(d):d.component.destroy()}),this.components=f},t.prototype.clear=function(){e.prototype.clear.call(this),this.container.clear()},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.container.remove(!0)},t.prototype.getGeometries=function(r){var n=this,i=r.geometries;return ft(r.views,function(a){i=i.concat(n.getGeometries(a))}),i},t.prototype.loopLegends=function(r){var n=this.view.getRootView()===this.view;if(n){var i=this.getGeometries(this.view),a={};ft(i,function(o){var s=o.getGroupAttributes();ft(s,function(l){var u=l.getScale(l.type);!u||u.type==="identity"||a[u.field]||(r(o,l,u),a[u.field]=!0)})})}},t.prototype.createFieldLegend=function(r,n,i){var a,o=cY(this.option,i.field),s=ys.FORE,l=hA(o);if(o!==!1&&(xt(o,"custom")?a=this.createCustomLegend(r,n,i,o):i.isLinear?a=this.createContinuousLegend(r,n,i,o):i.isCategory&&(a=this.createCategoryLegend(r,n,i,o))),a)return a.set("field",i.field),{id:this.getId(i.field),component:a,layer:s,direction:l,type:gl.LEGEND,extra:{scale:i}}},t.prototype.createCustomLegend=function(r,n,i,a){var o=this.getCategoryCfg(r,n,i,a,!0);return new gj(o)},t.prototype.createContinuousLegend=function(r,n,i,a){var o=this.getContinuousCfg(r,n,i,$c(a,["value"]));return new fye(o)},t.prototype.createCategoryLegend=function(r,n,i,a){var o=this.getCategoryCfg(r,n,i,a);return new gj(o)},t.prototype.getContinuousCfg=function(r,n,i,a){var o=i.getTicks(),s=Bd(o,function(x){return x.value===0}),l=Bd(o,function(x){return x.value===1}),u=o.map(function(x){var w=x.value,S=x.tickValue,A=n.mapping(i.invert(w)).join("");return{value:S,attrValue:A,color:A,scaleValue:w}});s||u.push({value:i.min,attrValue:n.mapping(i.invert(0)).join(""),color:n.mapping(i.invert(0)).join(""),scaleValue:0}),l||u.push({value:i.max,attrValue:n.mapping(i.invert(1)).join(""),color:n.mapping(i.invert(1)).join(""),scaleValue:1}),u.sort(function(x,w){return x.value-w.value});var c={min:Oh(u).value,max:Gs(u).value,colors:[],rail:{type:n.type},track:{}};n.type==="size"&&(c.track={style:{fill:n.type==="size"?this.view.getTheme().defaultColor:void 0}}),n.type==="color"&&(c.colors=u.map(function(x){return x.attrValue}));var f=this.container,d=hA(a),v=EP(d),g=xt(a,"title");return g&&(g=Tr({text:eS(i)},g)),c.container=f,c.layout=v,c.title=g,c.animateOption=sb,this.mergeLegendCfg(c,a,"continuous")},t.prototype.getCategoryCfg=function(r,n,i,a,o){var s=this.container,l=xt(a,"position",xr.BOTTOM),u=kj(this.view.getTheme(),l),c=xt(u,["marker"]),f=xt(a,"marker"),d=EP(l),v=xt(u,["pageNavigator"]),g=xt(a,"pageNavigator"),x=o?W_e(c,f,a.items):Ult(this.view,r,n,c,f),w=xt(a,"title");w&&(w=Tr({text:i?eS(i):""},w));var S=xt(a,"maxWidthRatio"),A=xt(a,"maxHeightRatio"),M=this.getCategoryLegendSizeCfg(d,S,A);M.container=s,M.layout=d,M.items=x,M.title=w,M.animateOption=sb,M.pageNavigator=Tr({},v,g);var R=this.mergeLegendCfg(M,a,l);R.reversed&&R.items.reverse();var O=xt(R,"maxItemWidth");return O&&O<=1&&(R.maxItemWidth=this.view.viewBBox.width*O),R},t.prototype.mergeLegendCfg=function(r,n,i){var a=i.split("-")[0],o=kj(this.view.getTheme(),a);return Tr({},o,r,n)},t.prototype.getId=function(r){return"".concat(this.name,"-").concat(r)},t.prototype.getComponentById=function(r){return Bd(this.components,function(n){return n.id===r})},t.prototype.getCategoryLegendSizeCfg=function(r,n,i){n===void 0&&(n=jX),i===void 0&&(i=jX);var a=this.view.viewBBox,o=a.width,s=a.height;return r==="vertical"?{maxWidth:o*n,maxHeight:s}:{maxWidth:o,maxHeight:s*i}},t}(Ub),wbe=function(e){Ut(t,e);function t(r){var n=e.call(this,r)||this;return n.onChangeFn=Mm,n.resetMeasure=function(){n.clear()},n.onValueChange=function(i){var a=Lr(i,2),o=a[0],s=a[1];n.start=o,n.end=s,n.changeViewData(o,s)},n.container=n.view.getLayer(ys.FORE).addGroup(),n.onChangeFn=F4(n.onValueChange,20,{leading:!0}),n.width=0,n.view.on(di.BEFORE_CHANGE_DATA,n.resetMeasure),n.view.on(di.BEFORE_CHANGE_SIZE,n.resetMeasure),n}return Object.defineProperty(t.prototype,"name",{get:function(){return"slider"},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){e.prototype.destroy.call(this),this.view.off(di.BEFORE_CHANGE_DATA,this.resetMeasure),this.view.off(di.BEFORE_CHANGE_SIZE,this.resetMeasure)},t.prototype.init=function(){},t.prototype.render=function(){this.option=this.view.getOptions().slider;var r=this.getSliderCfg(),n=r.start,i=r.end;ke(this.start)&&(this.start=n,this.end=i);var a=this.view.getOptions().data;this.option&&!Kc(a)?this.slider?this.slider=this.updateSlider():(this.slider=this.createSlider(),this.slider.component.on("sliderchange",this.onChangeFn)):this.slider&&(this.slider.component.destroy(),this.slider=void 0)},t.prototype.layout=function(){var r=this;if(this.option&&!this.width&&(this.measureSlider(),setTimeout(function(){r.view.destroyed||r.changeViewData(r.start,r.end)},0)),this.slider){var n=this.view.coordinateBBox.width,i=this.slider.component.get("padding"),a=Lr(i,4),o=a[0];a[1],a[2];var s=a[3],l=this.slider.component.getLayoutBBox(),u=new lc(l.x,l.y,Math.min(l.width,n),l.height).expand(i),c=this.getMinMaxText(this.start,this.end),f=c.minText,d=c.maxText,v=Lr(Om(this.view.viewBBox,u,xr.BOTTOM),2);v[0];var g=v[1],x=Lr(Om(this.view.coordinateBBox,u,xr.BOTTOM),2),w=x[0];x[1],this.slider.component.update(U(U({},this.getSliderCfg()),{x:w+s,y:g+o,width:this.width,start:this.start,end:this.end,minText:f,maxText:d})),this.view.viewBBox=this.view.viewBBox.cut(u,xr.BOTTOM)}},t.prototype.update=function(){this.render()},t.prototype.createSlider=function(){var r=this.getSliderCfg(),n=new aye(U({container:this.container},r));return n.init(),{component:n,layer:ys.FORE,direction:xr.BOTTOM,type:gl.SLIDER}},t.prototype.updateSlider=function(){var r=this.getSliderCfg();if(this.width){var n=this.getMinMaxText(this.start,this.end),i=n.minText,a=n.maxText;r=U(U({},r),{width:this.width,start:this.start,end:this.end,minText:i,maxText:a})}return this.slider.component.update(r),this.slider},t.prototype.measureSlider=function(){var r=this.getSliderCfg().width;this.width=r},t.prototype.getSliderCfg=function(){var r={height:16,start:0,end:1,minText:"",maxText:"",x:0,y:0,width:this.view.coordinateBBox.width};if(qi(this.option)){var n=U({data:this.getData()},xt(this.option,"trendCfg",{}));r=Tr({},r,this.getThemeOptions(),this.option),r=U(U({},r),{trendCfg:n})}return r.start=lo(Math.min(ke(r.start)?0:r.start,ke(r.end)?1:r.end),0,1),r.end=lo(Math.max(ke(r.start)?0:r.start,ke(r.end)?1:r.end),0,1),r},t.prototype.getData=function(){var r=this.view.getOptions().data,n=Lr(this.view.getYScales(),1),i=n[0],a=this.view.getGroupScales();if(a.length){var o=a[0],s=o.field,l=o.ticks;return r.reduce(function(u,c){return c[s]===l[0]&&u.push(c[i.field]),u},[])}return r.map(function(u){return u[i.field]||0})},t.prototype.getThemeOptions=function(){var r=this.view.getTheme();return xt(r,["components","slider","common"],{})},t.prototype.getMinMaxText=function(r,n){var i=this.view.getOptions().data,a=this.view.getXScale(),o=$d(i,a.field);a.isLinear&&(o=o.sort());var s=o,l=_l(i);if(!a||!l)return{};var u=_l(s),c=Math.round(r*(u-1)),f=Math.round(n*(u-1)),d=xt(s,[c]),v=xt(s,[f]),g=this.getSliderCfg().formatter;return g&&(d=g(d,i[c],c),v=g(v,i[f],f)),{minText:d,maxText:v}},t.prototype.changeViewData=function(r,n){var i=this.view.getOptions().data,a=this.view.getXScale(),o=_l(i);if(!(!a||!o)){var s=$d(i,a.field),l=this.view.getXScale().isLinear?s.sort(function(v,g){return Number(v)-Number(g)}):s,u=l,c=_l(u),f=Math.round(r*(c-1)),d=Math.round(n*(c-1));this.view.filter(a.field,function(v,g){var x=u.indexOf(v);return x>-1?ix(x,f,d):!0}),this.view.render(!0)}},t.prototype.getComponents=function(){return this.slider?[this.slider]:[]},t.prototype.clear=function(){this.slider&&(this.slider.component.destroy(),this.slider=void 0),this.width=0,this.start=void 0,this.end=void 0},t}(Ub),fA=0,hY=8,Cbe=32,Sbe=20,Tbe=function(e){Ut(t,e);function t(r){var n=e.call(this,r)||this;return n.onChangeFn=Mm,n.resetMeasure=function(){n.clear()},n.onValueChange=function(i){var a=i.ratio,o=n.getValidScrollbarCfg().animate;n.ratio=lo(a,0,1);var s=n.view.getOptions().animate;o||n.view.animate(!1),n.changeViewData(n.getScrollRange(),!0),n.view.animate(s)},n.container=n.view.getLayer(ys.FORE).addGroup(),n.onChangeFn=F4(n.onValueChange,20,{leading:!0}),n.trackLen=0,n.thumbLen=0,n.ratio=0,n.view.on(di.BEFORE_CHANGE_DATA,n.resetMeasure),n.view.on(di.BEFORE_CHANGE_SIZE,n.resetMeasure),n}return Object.defineProperty(t.prototype,"name",{get:function(){return"scrollbar"},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){e.prototype.destroy.call(this),this.view.off(di.BEFORE_CHANGE_DATA,this.resetMeasure),this.view.off(di.BEFORE_CHANGE_SIZE,this.resetMeasure)},t.prototype.init=function(){},t.prototype.render=function(){this.option=this.view.getOptions().scrollbar,this.option?this.scrollbar?this.scrollbar=this.updateScrollbar():(this.scrollbar=this.createScrollbar(),this.scrollbar.component.on("scrollchange",this.onChangeFn)):this.scrollbar&&(this.scrollbar.component.destroy(),this.scrollbar=void 0)},t.prototype.layout=function(){var r=this;if(this.option&&!this.trackLen&&(this.measureScrollbar(),setTimeout(function(){r.view.destroyed||r.changeViewData(r.getScrollRange(),!0)})),this.scrollbar){var n=this.view.coordinateBBox.width,i=this.scrollbar.component.get("padding"),a=this.scrollbar.component.getLayoutBBox(),o=new lc(a.x,a.y,Math.min(a.width,n),a.height).expand(i),s=this.getScrollbarComponentCfg(),l=void 0,u=void 0;if(s.isHorizontal){var c=Lr(Om(this.view.viewBBox,o,xr.BOTTOM),2);c[0];var f=c[1],d=Lr(Om(this.view.coordinateBBox,o,xr.BOTTOM),2),v=d[0];d[1],l=v,u=f}else{var g=Lr(Om(this.view.viewBBox,o,xr.RIGHT),2);g[0];var f=g[1],x=Lr(Om(this.view.viewBBox,o,xr.RIGHT),2),v=x[0];x[1],l=v,u=f}l+=i[3],u+=i[0],this.trackLen?this.scrollbar.component.update(U(U({},s),{x:l,y:u,trackLen:this.trackLen,thumbLen:this.thumbLen,thumbOffset:(this.trackLen-this.thumbLen)*this.ratio})):this.scrollbar.component.update(U(U({},s),{x:l,y:u})),this.view.viewBBox=this.view.viewBBox.cut(o,s.isHorizontal?xr.BOTTOM:xr.RIGHT)}},t.prototype.update=function(){this.render()},t.prototype.getComponents=function(){return this.scrollbar?[this.scrollbar]:[]},t.prototype.clear=function(){this.scrollbar&&(this.scrollbar.component.destroy(),this.scrollbar=void 0),this.trackLen=0,this.thumbLen=0,this.ratio=0,this.cnt=0,this.step=0,this.data=void 0,this.xScaleCfg=void 0,this.yScalesCfg=[]},t.prototype.setValue=function(r){this.onValueChange({ratio:r})},t.prototype.getValue=function(){return this.ratio},t.prototype.getThemeOptions=function(){var r=this.view.getTheme();return xt(r,["components","scrollbar","common"],{})},t.prototype.getScrollbarTheme=function(r){var n=xt(this.view.getTheme(),["components","scrollbar"]),i=r||{},a=i.thumbHighlightColor,o=hi(i,["thumbHighlightColor"]);return{default:Tr({},xt(n,["default","style"],{}),o),hover:Tr({},xt(n,["hover","style"],{}),{thumbColor:a})}},t.prototype.measureScrollbar=function(){var r=this.view.getXScale(),n=this.view.getYScales().slice();this.data=this.getScrollbarData(),this.step=this.getStep(),this.cnt=this.getCnt();var i=this.getScrollbarComponentCfg(),a=i.trackLen,o=i.thumbLen;this.trackLen=a,this.thumbLen=o,this.xScaleCfg={field:r.field,values:r.values||[]},this.yScalesCfg=n},t.prototype.getScrollRange=function(){var r=Math.floor((this.cnt-this.step)*lo(this.ratio,0,1)),n=Math.min(r+this.step-1,this.cnt-1);return[r,n]},t.prototype.changeViewData=function(r,n){var i=this,a=Lr(r,2),o=a[0],s=a[1],l=this.getValidScrollbarCfg().type,u=l!=="vertical",c=$d(this.data,this.xScaleCfg.field),f=this.view.getXScale().isLinear?c.sort(function(v,g){return Number(v)-Number(g)}):c,d=u?f:f.reverse();this.yScalesCfg.forEach(function(v){i.view.scale(v.field,{formatter:v.formatter,type:v.type,min:v.min,max:v.max,tickMethod:v.tickMethod})}),this.view.filter(this.xScaleCfg.field,function(v){var g=d.indexOf(v);return g>-1?ix(g,o,s):!0}),this.view.render(!0)},t.prototype.createScrollbar=function(){var r=this.getValidScrollbarCfg().type,n=r!=="vertical",i=new sye(U(U({container:this.container},this.getScrollbarComponentCfg()),{x:0,y:0}));return i.init(),{component:i,layer:ys.FORE,direction:n?xr.BOTTOM:xr.RIGHT,type:gl.SCROLLBAR}},t.prototype.updateScrollbar=function(){var r=this.getScrollbarComponentCfg(),n=this.trackLen?U(U({},r),{trackLen:this.trackLen,thumbLen:this.thumbLen,thumbOffset:(this.trackLen-this.thumbLen)*this.ratio}):U({},r);return this.scrollbar.component.update(n),this.scrollbar},t.prototype.getStep=function(){if(this.step)return this.step;var r=this.view.coordinateBBox,n=this.getValidScrollbarCfg(),i=n.type,a=n.categorySize,o=i!=="vertical";return Math.floor((o?r.width:r.height)/a)},t.prototype.getCnt=function(){if(this.cnt)return this.cnt;var r=this.view.getXScale(),n=this.getScrollbarData(),i=$d(n,r.field);return _l(i)},t.prototype.getScrollbarComponentCfg=function(){var r=this.view,n=r.coordinateBBox,i=r.viewBBox,a=this.getValidScrollbarCfg(),o=a.type,s=a.padding,l=a.width,u=a.height,c=a.style,f=o!=="vertical",d=Lr(s,4),v=d[0],g=d[1],x=d[2],w=d[3],S=f?{x:n.minX+w,y:i.maxY-u-x}:{x:i.maxX-l-g,y:n.minY+v},A=this.getStep(),M=this.getCnt(),R=f?n.width-w-g:n.height-v-x,O=Math.max(R*lo(A/M,0,1),Sbe);return U(U({},this.getThemeOptions()),{x:S.x,y:S.y,size:f?u:l,isHorizontal:f,trackLen:R,thumbLen:O,thumbOffset:0,theme:this.getScrollbarTheme(c)})},t.prototype.getValidScrollbarCfg=function(){var r={type:"horizontal",categorySize:Cbe,width:hY,height:hY,padding:[0,0,0,0],animate:!0,style:{}};return qi(this.option)&&(r=U(U({},r),this.option)),(!qi(this.option)||!this.option.padding)&&(r.padding=r.type==="horizontal"?[fA,0,fA,0]:[0,fA,0,fA]),r},t.prototype.getScrollbarData=function(){var r=this.view.getCoordinate(),n=this.getValidScrollbarCfg(),i=this.view.getOptions().data||[];return r.isReflect("y")&&n.type==="vertical"&&(i=an([],Lr(i),!1).reverse()),i},t}(Ub),Abe={fill:"#CCD6EC",opacity:.3};function Mbe(e,t,r){var n,i,a,o,s,l,u=y_e(e,t,r);if(u.length){u=Nh(u);try{for(var c=mi(u),f=c.next();!f.done;f=c.next()){var d=f.value;try{for(var v=(a=void 0,mi(d)),g=v.next();!g.done;g=v.next()){var x=g.value,w=x.mappingData,S=w.x,A=w.y;x.x=ze(S)?S[S.length-1]:S,x.y=ze(A)?A[A.length-1]:A}}catch(Y){a={error:Y}}finally{try{g&&!g.done&&(o=v.return)&&o.call(v)}finally{if(a)throw a.error}}}}catch(Y){n={error:Y}}finally{try{f&&!f.done&&(i=c.return)&&i.call(c)}finally{if(n)throw n.error}}var M=r.shared;if(M===!1&&u.length>1){var R=u[0],O=Math.abs(t.y-R[0].y);try{for(var N=mi(u),k=N.next();!k.done;k=N.next()){var V=k.value,Q=Math.abs(t.y-V[0].y);Q<=O&&(R=V,O=Q)}}catch(Y){s={error:Y}}finally{try{k&&!k.done&&(l=N.return)&&l.call(N)}finally{if(s)throw s.error}}u=[R]}return Jy(Nh(u))}return[]}var Rbe=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.show=function(r){var n=this.context.view,i=this.context.event,a=n.getController("tooltip").getTooltipCfg(),o=Mbe(n,{x:i.x,y:i.y},a);if(!zi(o,this.items)&&(this.items=o,o.length)){var s=n.getXScale().field,l=o[0].data[s],u=[],c=n.geometries;if(ft(c,function(ae){if(ae.type==="interval"||ae.type==="schema"){var Kt=ae.getElementsBy(function(re){var fe=re.getData();return fe[s]===l});u=u.concat(Kt)}}),u.length){var f=n.getCoordinate(),d=u[0].shape.getCanvasBBox(),v=u[0].shape.getCanvasBBox(),g=d;ft(u,function(ae){var Kt=ae.shape.getCanvasBBox();f.isTransposed?(Kt.minY<d.minY&&(d=Kt),Kt.maxY>v.maxY&&(v=Kt)):(Kt.minX<d.minX&&(d=Kt),Kt.maxX>v.maxX&&(v=Kt)),g.x=Math.min(Kt.minX,g.minX),g.y=Math.min(Kt.minY,g.minY),g.width=Math.max(Kt.maxX,g.maxX)-g.x,g.height=Math.max(Kt.maxY,g.maxY)-g.y});var x=n.backgroundGroup,w=n.coordinateBBox,S=void 0;if(f.isRect){var A=n.getXScale(),M=r||{},R=M.appendRatio,O=M.appendWidth;ke(O)&&(R=ke(R)?A.isLinear?0:.25:R,O=f.isTransposed?R*v.height:R*d.width);var N=void 0,k=void 0,V=void 0,Q=void 0;f.isTransposed?(N=w.minX,k=Math.min(v.minY,d.minY)-O,V=w.width,Q=g.height+O*2):(N=Math.min(d.minX,v.minX)-O,k=w.minY,V=g.width+O*2,Q=w.height),S=[["M",N,k],["L",N+V,k],["L",N+V,k+Q],["L",N,k+Q],["Z"]]}else{var Y=Oh(u),X=Gs(u),tt=tS(Y.getModel(),f).startAngle,it=tS(X.getModel(),f).endAngle,Et=f.getCenter(),Tt=f.getRadius(),pt=f.innerRadius*Tt;S=$m(Et.x,Et.y,Tt,tt,it,pt)}if(this.regionPath)this.regionPath.attr("path",S),this.regionPath.show();else{var kt=xt(r,"style",Abe);this.regionPath=x.addShape({type:"path",name:"active-region",capture:!1,attrs:U(U({},kt),{path:S})})}}}},t.prototype.hide=function(){this.regionPath&&this.regionPath.hide(),this.items=null},t.prototype.destroy=function(){this.hide(),this.regionPath&&this.regionPath.remove(!0),e.prototype.destroy.call(this)},t}(to),sut=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.timeStamp=0,r}return t.prototype.show=function(){var r=this.context,n=r.event,i=r.view,a=i.isTooltipLocked();if(!a){var o=this.timeStamp,s=+new Date,l=xt(r.view.getOptions(),"tooltip.showDelay",16);if(s-o>l){var u=this.location,c={x:n.x,y:n.y};(!u||!zi(u,c))&&this.showTooltip(i,c),this.timeStamp=s,this.location=c}}},t.prototype.hide=function(){var r=this.context.view,n=r.getController("tooltip"),i=this.context.event,a=i.clientX,o=i.clientY;n.isCursorEntered({x:a,y:o})||r.isTooltipLocked()||(this.hideTooltip(r),this.location=null)},t.prototype.showTooltip=function(r,n){r.showTooltip(n)},t.prototype.hideTooltip=function(r){r.hideTooltip()},t}(to),Ibe=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.showTooltip=function(r,n){var i=Gp(r);ft(i,function(a){var o=XB(r,a,n);a.showTooltip(o)})},t.prototype.hideTooltip=function(r){var n=Gp(r);ft(n,function(i){i.hideTooltip()})},t}(sut),Lbe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.timeStamp=0,r}return t.prototype.destroy=function(){e.prototype.destroy.call(this),this.tooltip&&this.tooltip.destroy()},t.prototype.show=function(){var r=this.context,n=r.event,i=this.timeStamp,a=+new Date;if(a-i>16){var o=this.location,s={x:n.x,y:n.y};(!o||!zi(o,s))&&this.showTooltip(s),this.timeStamp=a,this.location=s}},t.prototype.hide=function(){this.hideTooltip(),this.location=null},t.prototype.showTooltip=function(r){var n=this.context,i=n.event,a=i.target;if(a&&a.get("tip")){if(!this.tooltip)this.renderTooltip();else{var o=n.view,s=o.canvas,l={start:{x:0,y:0},end:{x:s.get("width"),y:s.get("height")}};this.tooltip.set("region",l)}var u=a.get("tip");this.tooltip.update(U({title:u},r)),this.tooltip.show()}},t.prototype.hideTooltip=function(){this.tooltip&&this.tooltip.hide()},t.prototype.renderTooltip=function(){var r,n=this.context.view,i=n.canvas,a={start:{x:0,y:0},end:{x:i.get("width"),y:i.get("height")}},o=n.getTheme(),s=xt(o,["components","tooltip","domStyles"],{}),l=new k3({parent:i.get("el").parentNode,region:a,visible:!1,crosshairs:null,domStyles:U({},Tr({},s,(r={},r[ug]={"max-width":"50%"},r[cg]={"word-break":"break-all"},r)))});l.init(),l.setCapture(!1),this.tooltip=l},t}(to),P6=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.stateName="",r}return t.prototype.hasState=function(r){return r.hasState(this.stateName)},t.prototype.setElementState=function(r,n){r.setState(this.stateName,n)},t.prototype.setState=function(){this.setStateEnable(!0)},t.prototype.clear=function(){var r=this.context.view;this.clearViewState(r)},t.prototype.clearViewState=function(r){var n=this,i=ylt(r,this.stateName);ft(i,function(a){n.setElementState(a,!1)})},t}(to);function fY(e){return xt(e.get("delegateObject"),"item")}var D6=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.ignoreListItemStates=["unchecked"],r}return t.prototype.isItemIgnore=function(r,n){var i=this.ignoreListItemStates,a=i.filter(function(o){return n.hasState(r,o)});return!!a.length},t.prototype.setStateByComponent=function(r,n,i){var a=this.context.view,o=r.get("field"),s=Vl(a);this.setElementsStateByItem(s,o,n,i)},t.prototype.setStateByElement=function(r,n){this.setElementState(r,n)},t.prototype.isMathItem=function(r,n,i){var a=this.context.view,o=ob(a,n),s=Wd(r,n);return!ke(s)&&i.name===o.getText(s)},t.prototype.setElementsStateByItem=function(r,n,i,a){var o=this;ft(r,function(s){o.isMathItem(s,n,i)&&s.setState(o.stateName,a)})},t.prototype.setStateEnable=function(r){var n=a0(this.context);if(n)plt(this.context)&&this.setStateByElement(n,r);else{var i=d_(this.context);if(rS(i)){var a=i.item,o=i.component;if(a&&o&&!this.isItemIgnore(a,o)){var s=this.context.event.gEvent;if(s&&s.fromShape&&s.toShape&&fY(s.fromShape)===fY(s.toShape))return;this.setStateByComponent(o,a,r)}}}},t.prototype.toggle=function(){var r=a0(this.context);if(r){var n=r.hasState(this.stateName);this.setElementState(r,!n)}},t.prototype.reset=function(){this.setStateEnable(!1)},t}(P6),Obe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.stateName="active",r}return t.prototype.active=function(){this.setState()},t}(D6),Pbe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.cache={},r}return t.prototype.getColorScale=function(r,n){var i=n.geometry.getAttribute("color");if(!i)return null;var a=r.getScaleByField(i.getFields()[0]);return a},t.prototype.getLinkPath=function(r,n){var i=this.context.view,a=i.getCoordinate().isTransposed,o=r.shape.getCanvasBBox(),s=n.shape.getCanvasBBox(),l=a?[["M",o.minX,o.minY],["L",s.minX,s.maxY],["L",s.maxX,s.maxY],["L",o.maxX,o.minY],["Z"]]:[["M",o.maxX,o.minY],["L",s.minX,s.minY],["L",s.minX,s.maxY],["L",o.maxX,o.maxY],["Z"]];return l},t.prototype.addLinkShape=function(r,n,i,a){var o={opacity:.4,fill:n.shape.attr("fill")};r.addShape({type:"path",attrs:U(U({},Tr({},o,$r(a)?a(o,n):a)),{path:this.getLinkPath(n,i)})})},t.prototype.linkByElement=function(r,n){var i=this,a=this.context.view,o=this.getColorScale(a,r);if(o){var s=Wd(r,o.field);if(!this.cache[s]){var l=qye(a,o.field,s),u=this.linkGroup,c=u.addGroup();this.cache[s]=c;var f=l.length;ft(l,function(d,v){if(v<f-1){var g=l[v+1];i.addLinkShape(c,d,g,n)}})}}},t.prototype.removeLink=function(r){var n=this.getColorScale(this.context.view,r);if(n){var i=Wd(r,n.field);this.cache[i]&&(this.cache[i].remove(),this.cache[i]=null)}},t.prototype.link=function(r){var n=this.context;this.linkGroup||(this.linkGroup=n.view.foregroundGroup.addGroup({id:"link-by-color-group",capture:!1}));var i=a0(n);i&&this.linkByElement(i,r==null?void 0:r.style)},t.prototype.unlink=function(){var r=a0(this.context);r&&this.removeLink(r)},t.prototype.clear=function(){this.linkGroup&&this.linkGroup.clear(),this.cache={}},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.linkGroup&&this.linkGroup.remove()},t}(to),F6=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.startPoint=null,r.endPoint=null,r.isStarted=!1,r.effectSiblings=!1,r.effectByRecord=!1,r}return t.prototype.getCurrentPoint=function(){var r=this.context.event;return{x:r.x,y:r.y}},t.prototype.start=function(){this.clear(),this.startPoint=this.getCurrentPoint(),this.isStarted=!0},t.prototype.getIntersectElements=function(){var r=null;if(nS(this.context))r=g6(this.context,10);else{var n=this.startPoint,i=this.isStarted?this.getCurrentPoint():this.endPoint;if(!n||!i)return;var a={minX:Math.min(n.x,i.x),minY:Math.min(n.y,i.y),maxX:Math.max(n.x,i.x),maxY:Math.max(n.y,i.y)},o=this.context.view;r=H3(o,a)}return r},t.prototype.setStateEnable=function(r){if(this.effectSiblings&&!this.effectByRecord)this.setSiblingsState(r);else{var n=Vl(this.context.view),i=this.getIntersectElements();i&&i.length?this.effectByRecord?this.setSiblingsStateByRecord(i,r):this.setElementsState(i,r,n):this.clear()}},t.prototype.setSiblingsStateByRecord=function(r,n){var i=this,a=this.context.view,o=Gp(a),s=r.map(function(c){return c.getModel().data}),l=a.getXScale().field,u=a.getYScales()[0].field;ft(o,function(c){var f=Vl(c),d=f.filter(function(v){var g=v.getModel().data;return blt(s,g,l,u)});i.setElementsState(d,n,f)})},t.prototype.setSiblingsState=function(r){var n=this,i=this.context.view,a=Gp(i);nS(this.context)&&ft(a,function(o){var s=Vl(o),l=glt(n.context,o,10);l&&l.length?n.setElementsState(l,r,s):n.clearViewState(o)})},t.prototype.setElementsState=function(r,n,i){var a=this;ft(i,function(o){r.includes(o)?a.setElementState(o,n):a.setElementState(o,!1)})},t.prototype.end=function(){this.isStarted=!1,this.endPoint=this.getCurrentPoint()},t.prototype.clear=function(){var r=this,n=this.context.view;if(this.effectSiblings){var i=Gp(n);ft(i,function(a){r.clearViewState(a)})}else this.clearViewState(n)},t}(P6),Dbe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.stateName="active",r}return t.prototype.active=function(){this.setState()},t}(F6),B6=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.setStateEnable=function(r){var n=a0(this.context);if(n){if(!plt(this.context))return;r?(this.clear(),this.setElementState(n,!0)):this.hasState(n)&&this.setElementState(n,!1)}},t.prototype.toggle=function(){var r=a0(this.context);if(r){var n=this.hasState(r);n||this.clear(),this.setElementState(r,!n)}},t.prototype.reset=function(){this.setStateEnable(!1)},t}(P6),Fbe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.stateName="active",r}return t.prototype.active=function(){this.setState()},t}(B6),Qw="inactive",Jw="active";function N6(e){var t=Vl(e);ft(t,function(r){r.hasState(Jw)&&r.setState(Jw,!1),r.hasState(Qw)&&r.setState(Qw,!1)})}function lut(e,t,r){ft(e,function(n){t(n)?(n.hasState(Qw)&&n.setState(Qw,!1),n.setState(Jw,r)):(n.hasState(Jw)&&n.setState(Jw,!1),n.setState(Qw,r))})}var Ry=RR.INACTIVE,Wv=RR.ACTIVE,k6=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.stateName=Wv,r}return t.prototype.setElementsStateByItem=function(r,n,i,a){var o=this,s=function(l){return o.isMathItem(l,n,i)};this.setHighlightBy(r,s,a)},t.prototype.setElementHighlight=function(r,n){n(r)?(r.hasState(Ry)&&r.setState(Ry,!1),r.setState(Wv,!0)):r.hasState(Wv)||r.setState(Ry,!0)},t.prototype.setHighlightBy=function(r,n,i){var a=this;if(i)ft(r,function(l){a.setElementHighlight(l,n)});else{var o=ylt(this.context.view,Wv),s=!0;ft(o,function(l){if(!n(l))return s=!1,!1}),s?this.clear():ft(r,function(l){n(l)&&(l.hasState(Wv)&&l.setState(Wv,!1),l.setState(Ry,!0))})}},t.prototype.setElementState=function(r,n){var i=this.context.view,a=Vl(i);this.setHighlightBy(a,function(o){return r===o},n)},t.prototype.highlight=function(){this.setState()},t.prototype.clear=function(){var r=this.context.view;N6(r)},t}(D6),Bbe=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.setStateByElement=function(r,n){var i=this.context.view,a=r.geometry.getAttribute("color");if(a){var o=i.getScaleByField(a.getFields()[0]),s=Wd(r,o.field),l=Vl(i),u=l.filter(function(c){return Wd(c,o.field)===s});this.setHighlightBy(l,function(c){return u.includes(c)},n)}},t}(k6),Nbe=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.setElementHighlight=function(r,n){n(r)?(r.hasState(Ry)&&r.setState(Ry,!1),r.setState(Wv,!0)):(r.setState(Ry,!0),r.hasState(Wv)&&r.setState(Wv,!1))},t.prototype.setStateByElement=function(r,n){var i=this.context.view,a=i.getXScale(),o=Wd(r,a.field),s=Vl(i),l=s.filter(function(u){return Wd(u,a.field)===o});this.setHighlightBy(s,function(u){return l.includes(u)},n)},t.prototype.toggle=function(){var r=a0(this.context);if(r){var n=r.hasState(this.stateName);this.setStateByElement(r,!n)}},t}(k6),Ap;(function(e){e.BEFORE_HIGHLIGHT="element-range-highlight:beforehighlight",e.AFTER_HIGHLIGHT="element-range-highlight:afterhighlight",e.BEFORE_CLEAR="element-range-highlight:beforeclear",e.AFTER_CLEAR="element-range-highlight:afterclear"})(Ap||(Ap={}));var uut=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.stateName="active",r}return t.prototype.clearViewState=function(r){N6(r)},t.prototype.highlight=function(){var r=this.context,n=r.view,i=r.event,a=this.getIntersectElements(),o={view:n,event:i,highlightElements:a};n.emit(Ap.BEFORE_HIGHLIGHT,So.fromData(n,Ap.BEFORE_HIGHLIGHT,o)),this.setState(),n.emit(Ap.AFTER_HIGHLIGHT,So.fromData(n,Ap.AFTER_HIGHLIGHT,o))},t.prototype.clear=function(){var r=this.context.view;r.emit(Ap.BEFORE_CLEAR,So.fromData(r,Ap.BEFORE_CLEAR,{})),e.prototype.clear.call(this),r.emit(Ap.AFTER_CLEAR,So.fromData(r,Ap.AFTER_CLEAR,{}))},t.prototype.setElementsState=function(r,n,i){lut(i,function(a){return r.indexOf(a)>=0},n)},t}(F6),kbe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.stateName="active",r}return t.prototype.highlight=function(){this.setState()},t.prototype.setElementState=function(r,n){var i=this.context.view,a=Vl(i);lut(a,function(o){return r===o},n)},t.prototype.clear=function(){var r=this.context.view;N6(r)},t}(B6),zbe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.stateName="selected",r}return t.prototype.selected=function(){this.setState()},t}(F6),Ube=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.stateName="selected",r}return t.prototype.selected=function(){this.setState()},t}(D6),$be=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.stateName="selected",r}return t.prototype.selected=function(){this.setState()},t}(B6),D_=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.stateName="",r.ignoreItemStates=[],r}return t.prototype.getTriggerListInfo=function(){var r=d_(this.context),n=null;return rS(r)&&(n={item:r.item,list:r.component}),n},t.prototype.getAllowComponents=function(){var r=this,n=this.context.view,i=xlt(n),a=[];return ft(i,function(o){o.isList()&&r.allowSetStateByElement(o)&&a.push(o)}),a},t.prototype.hasState=function(r,n){return r.hasState(n,this.stateName)},t.prototype.clearAllComponentsState=function(){var r=this,n=this.getAllowComponents();ft(n,function(i){i.clearItemsState(r.stateName)})},t.prototype.allowSetStateByElement=function(r){var n=r.get("field");if(!n)return!1;if(this.cfg&&this.cfg.componentNames){var i=r.get("name");if(this.cfg.componentNames.indexOf(i)===-1)return!1}var a=this.context.view,o=ob(a,n);return o&&o.isCategory},t.prototype.allowSetStateByItem=function(r,n){var i=this.ignoreItemStates;if(i.length){var a=i.filter(function(o){return n.hasState(r,o)});return a.length===0}return!0},t.prototype.setStateByElement=function(r,n,i){var a=r.get("field"),o=this.context.view,s=ob(o,a),l=Wd(n,a),u=s.getText(l);this.setItemsState(r,u,i)},t.prototype.setStateEnable=function(r){var n=this,i=a0(this.context);if(i){var a=this.getAllowComponents();ft(a,function(u){n.setStateByElement(u,i,r)})}else{var o=d_(this.context);if(rS(o)){var s=o.item,l=o.component;this.allowSetStateByElement(l)&&this.allowSetStateByItem(s,l)&&this.setItemState(l,s,r)}}},t.prototype.setItemsState=function(r,n,i){var a=this,o=r.getItems();ft(o,function(s){s.name===n&&a.setItemState(r,s,i)})},t.prototype.setItemState=function(r,n,i){r.setItemState(n,this.stateName,i)},t.prototype.setState=function(){this.setStateEnable(!0)},t.prototype.reset=function(){this.setStateEnable(!1)},t.prototype.toggle=function(){var r=this.getTriggerListInfo();if(r&&r.item){var n=r.list,i=r.item,a=this.hasState(n,i);this.setItemState(n,i,!a)}},t.prototype.clear=function(){var r=this.getTriggerListInfo();r?r.list.clearItemsState(this.stateName):this.clearAllComponentsState()},t}(to),Hbe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.stateName="active",r}return t.prototype.active=function(){this.setState()},t}(D_),dY="inactive",pY="active";function Vbe(e){var t=e.getItems();ft(t,function(r){e.hasState(r,pY)&&e.setItemState(r,pY,!1),e.hasState(r,dY)&&e.setItemState(r,dY,!1)})}var rw="inactive",uy="active",z6=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.stateName=uy,r.ignoreItemStates=["unchecked"],r}return t.prototype.setItemsState=function(r,n,i){this.setHighlightBy(r,function(a){return a.name===n},i)},t.prototype.setItemState=function(r,n,i){r.getItems(),this.setHighlightBy(r,function(a){return a===n},i)},t.prototype.setHighlightBy=function(r,n,i){var a=r.getItems();if(i)ft(a,function(l){n(l)?(r.hasState(l,rw)&&r.setItemState(l,rw,!1),r.setItemState(l,uy,!0)):r.hasState(l,uy)||r.setItemState(l,rw,!0)});else{var o=r.getItemsByState(uy),s=!0;ft(o,function(l){if(!n(l))return s=!1,!1}),s?this.clear():ft(a,function(l){n(l)&&(r.hasState(l,uy)&&r.setItemState(l,uy,!1),r.setItemState(l,rw,!0))})}},t.prototype.highlight=function(){this.setState()},t.prototype.clear=function(){var r=this.getTriggerListInfo();if(r)Vbe(r.list);else{var n=this.getAllowComponents();ft(n,function(i){i.clearItemsState(uy),i.clearItemsState(rw)})}},t}(D_),Gbe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.stateName="selected",r}return t.prototype.selected=function(){this.setState()},t}(D_),Wbe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.stateName="unchecked",r}return t.prototype.unchecked=function(){this.setState()},t}(D_),F1="unchecked",dA="checked",Xbe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.stateName=dA,r}return t.prototype.setItemState=function(r,n,i){this.setCheckedBy(r,function(a){return a===n},i)},t.prototype.setCheckedBy=function(r,n,i){var a=r.getItems();i&&ft(a,function(o){n(o)?(r.hasState(o,F1)&&r.setItemState(o,F1,!1),r.setItemState(o,dA,!0)):r.hasState(o,dA)||r.setItemState(o,F1,!0)})},t.prototype.toggle=function(){var r=this.getTriggerListInfo();if(r&&r.item){var n=r.list,i=r.item,a=!xI(n.getItems(),function(o){return n.hasState(o,F1)});a||n.hasState(i,F1)?this.setItemState(n,i,!0):this.reset()}},t.prototype.checked=function(){this.setState()},t.prototype.reset=function(){var r=this.getAllowComponents();ft(r,function(n){n.clearItemsState(dA),n.clearItemsState(F1)})},t}(D_),B1="unchecked",jbe=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.toggle=function(){var r,n,i,a,o,s,l,u,c=this.getTriggerListInfo();if(c!=null&&c.item){var f=c.list,d=c.item,v=f.getItems(),g=v.filter(function(Y){return!f.hasState(Y,B1)}),x=v.filter(function(Y){return f.hasState(Y,B1)}),w=g[0];if(v.length===g.length)try{for(var S=mi(v),A=S.next();!A.done;A=S.next()){var M=A.value;f.setItemState(M,B1,M.id!==d.id)}}catch(Y){r={error:Y}}finally{try{A&&!A.done&&(n=S.return)&&n.call(S)}finally{if(r)throw r.error}}else if(v.length-x.length===1)if(w.id===d.id)try{for(var R=mi(v),O=R.next();!O.done;O=R.next()){var M=O.value;f.setItemState(M,B1,!1)}}catch(Y){i={error:Y}}finally{try{O&&!O.done&&(a=R.return)&&a.call(R)}finally{if(i)throw i.error}}else try{for(var N=mi(v),k=N.next();!k.done;k=N.next()){var M=k.value;f.setItemState(M,B1,M.id!==d.id)}}catch(Y){o={error:Y}}finally{try{k&&!k.done&&(s=N.return)&&s.call(N)}finally{if(o)throw o.error}}else try{for(var V=mi(v),Q=V.next();!Q.done;Q=V.next()){var M=Q.value;f.setItemState(M,B1,M.id!==d.id)}}catch(Y){l={error:Y}}finally{try{Q&&!Q.done&&(u=V.return)&&u.call(V)}finally{if(l)throw l.error}}}},t}(D_),vY="showRadio",RP="legend-radio-tip",Ybe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.timeStamp=0,r}return t.prototype.show=function(){var r=this.getTriggerListInfo();if(r!=null&&r.item){var n=r.list,i=r.item;n.setItemState(i,vY,!0)}},t.prototype.hide=function(){var r=this.getTriggerListInfo();if(r!=null&&r.item){var n=r.list,i=r.item;n.setItemState(i,vY,!1)}},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.tooltip&&this.tooltip.destroy()},t.prototype.showTip=function(){var r=this.context,n=r.event,i=this.timeStamp,a=+new Date,o=this.context.event.target;if(a-i>16&&o.get("name")==="legend-item-radio"){var s=this.location,l={x:n.x,y:n.y};this.timeStamp=a,this.location=l,(!s||!zi(s,l))&&this.showTooltip(l)}},t.prototype.hideTip=function(){this.hideTooltip(),this.location=null},t.prototype.showTooltip=function(r){var n=this.context,i=n.event,a=i.target;if(a&&a.get("tip")){this.tooltip||this.renderTooltip();var o=n.view.getCanvas().get("el").getBoundingClientRect(),s=o.x,l=o.y;this.tooltip.update(U(U({title:a.get("tip")},r),{x:r.x+s,y:r.y+l})),this.tooltip.show()}},t.prototype.hideTooltip=function(){this.tooltip&&this.tooltip.hide()},t.prototype.renderTooltip=function(){var r,n=(r={},r[ug]={padding:"6px 8px",transform:"translate(-50%, -80%)",background:"rgba(0,0,0,0.75)",color:"#fff","border-radius":"2px","z-index":100},r[cg]={"font-size":"12px","line-height":"14px","margin-bottom":0,"word-break":"break-all"},r);document.getElementById(RP)&&document.body.removeChild(document.getElementById(RP));var i=new k3({parent:document.body,region:null,visible:!1,crosshairs:null,domStyles:n,containerId:RP});i.init(),i.setCapture(!1),this.tooltip=i},t}(D_),U6=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.maskShape=null,r.points=[],r.starting=!1,r.moving=!1,r.preMovePoint=null,r.shapeType="path",r}return t.prototype.getCurrentPoint=function(){var r=this.context.event;return{x:r.x,y:r.y}},t.prototype.emitEvent=function(r){var n="mask:".concat(r),i=this.context.view,a=this.context.event;i.emit(n,{target:this.maskShape,shape:this.maskShape,points:this.points,x:a.x,y:a.y})},t.prototype.createMask=function(){var r=this.context.view,n=this.getMaskAttrs(),i=r.foregroundGroup.addShape({type:this.shapeType,name:"mask",draggable:!0,attrs:U({fill:"#C5D4EB",opacity:.3},n)});return i},t.prototype.getMaskPath=function(){return[]},t.prototype.show=function(){this.maskShape&&(this.maskShape.show(),this.emitEvent("show"))},t.prototype.start=function(r){this.starting=!0,this.moving=!1,this.points=[this.getCurrentPoint()],this.maskShape||(this.maskShape=this.createMask(),this.maskShape.set("capture",!1)),this.updateMask(r==null?void 0:r.maskStyle),this.emitEvent("start")},t.prototype.moveStart=function(){this.moving=!0,this.preMovePoint=this.getCurrentPoint()},t.prototype.move=function(){if(!(!this.moving||!this.maskShape)){var r=this.getCurrentPoint(),n=this.preMovePoint,i=r.x-n.x,a=r.y-n.y,o=this.points;ft(o,function(s){s.x+=i,s.y+=a}),this.updateMask(),this.emitEvent("change"),this.preMovePoint=r}},t.prototype.updateMask=function(r){var n=Tr({},this.getMaskAttrs(),r);this.maskShape.attr(n)},t.prototype.moveEnd=function(){this.moving=!1,this.preMovePoint=null},t.prototype.end=function(){this.starting=!1,this.emitEvent("end"),this.maskShape&&this.maskShape.set("capture",!0)},t.prototype.hide=function(){this.maskShape&&(this.maskShape.hide(),this.emitEvent("hide"))},t.prototype.resize=function(){this.starting&&this.maskShape&&(this.points.push(this.getCurrentPoint()),this.updateMask(),this.emitEvent("change"))},t.prototype.destroy=function(){this.points=[],this.maskShape&&this.maskShape.remove(),this.maskShape=null,this.preMovePoint=null,e.prototype.destroy.call(this)},t}(to);function cut(e){var t=Gs(e),r=0,n=0,i=0;if(e.length){var a=e[0];r=m6(a,t)/2,n=(t.x+a.x)/2,i=(t.y+a.y)/2}return{x:n,y:i,r}}var Zbe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.shapeType="circle",r}return t.prototype.getMaskAttrs=function(){return cut(this.points)},t}(U6);function hut(e){return{start:Oh(e),end:Gs(e)}}function fut(e,t){var r=Math.min(e.x,t.x),n=Math.min(e.y,t.y),i=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y);return{x:r,y:n,width:i,height:a}}var dut=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.shapeType="rect",r}return t.prototype.getRegion=function(){return hut(this.points)},t.prototype.getMaskAttrs=function(){var r=this.getRegion(),n=r.start,i=r.end;return fut(n,i)},t}(U6);function gY(e){e.x=lo(e.x,0,1),e.y=lo(e.y,0,1)}function put(e,t,r,n){var i=null,a=null,o=n.invert(Oh(e)),s=n.invert(Gs(e));return r&&(gY(o),gY(s)),t==="x"?(i=n.convert({x:o.x,y:0}),a=n.convert({x:s.x,y:1})):(i=n.convert({x:0,y:o.y}),a=n.convert({x:1,y:s.y})),{start:i,end:a}}var vut=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.dim="x",r.inPlot=!0,r}return t.prototype.getRegion=function(){var r=this.context.view.getCoordinate();return put(this.points,this.dim,this.inPlot,r)},t}(dut);function $6(e){var t=[];return e.length&&(ft(e,function(r,n){n===0?t.push(["M",r.x,r.y]):t.push(["L",r.x,r.y])}),t.push(["L",e[0].x,e[0].y])),t}function gut(e){return{path:$6(e)}}var mut=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getMaskPath=function(){return $6(this.points)},t.prototype.getMaskAttrs=function(){return gut(this.points)},t.prototype.addPoint=function(){this.resize()},t}(U6);function H6(e){return Qye(e,!0)}function yut(e){return{path:H6(e)}}var qbe=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getMaskPath=function(){return H6(this.points)},t.prototype.getMaskAttrs=function(){return yut(this.points)},t}(mut),V6=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.maskShapes=[],r.starting=!1,r.moving=!1,r.recordPoints=null,r.preMovePoint=null,r.shapeType="path",r.maskType="multi-mask",r}return t.prototype.getCurrentPoint=function(){var r=this.context.event;return{x:r.x,y:r.y}},t.prototype.emitEvent=function(r){var n="".concat(this.maskType,":").concat(r),i=this.context.view,a=this.context.event,o={type:this.shapeType,name:this.maskType,get:function(s){return o.hasOwnProperty(s)?o[s]:void 0}};i.emit(n,{target:o,maskShapes:this.maskShapes,multiPoints:this.recordPoints,x:a.x,y:a.y})},t.prototype.createMask=function(r){var n=this.context.view,i=this.recordPoints[r],a=this.getMaskAttrs(i),o=n.foregroundGroup.addShape({type:this.shapeType,name:"mask",draggable:!0,attrs:U({fill:"#C5D4EB",opacity:.3},a)});this.maskShapes.push(o)},t.prototype.getMaskPath=function(r){return[]},t.prototype.show=function(){this.maskShapes.length>0&&(this.maskShapes.forEach(function(r){return r.show()}),this.emitEvent("show"))},t.prototype.start=function(r){this.recordPointStart(),this.starting=!0,this.moving=!1;var n=this.recordPoints.length-1;this.createMask(n),this.updateShapesCapture(!1),this.updateMask(r==null?void 0:r.maskStyle),this.emitEvent("start")},t.prototype.moveStart=function(){this.moving=!0,this.preMovePoint=this.getCurrentPoint(),this.updateShapesCapture(!1)},t.prototype.move=function(){if(!(!this.moving||this.maskShapes.length===0)){var r=this.getCurrentPoint(),n=this.preMovePoint,i=r.x-n.x,a=r.y-n.y,o=this.getCurMaskShapeIndex();o>-1&&(this.recordPoints[o].forEach(function(s){s.x+=i,s.y+=a}),this.updateMask(),this.emitEvent("change"),this.preMovePoint=r)}},t.prototype.updateMask=function(r){var n=this;this.recordPoints.forEach(function(i,a){var o=Tr({},n.getMaskAttrs(i),r);n.maskShapes[a].attr(o)})},t.prototype.resize=function(){this.starting&&this.maskShapes.length>0&&(this.recordPointContinue(),this.updateMask(),this.emitEvent("change"))},t.prototype.moveEnd=function(){this.moving=!1,this.preMovePoint=null,this.updateShapesCapture(!0)},t.prototype.end=function(){this.starting=!1,this.emitEvent("end"),this.updateShapesCapture(!0)},t.prototype.hide=function(){this.maskShapes.length>0&&(this.maskShapes.forEach(function(r){return r.hide()}),this.emitEvent("hide"))},t.prototype.remove=function(){var r=this.getCurMaskShapeIndex();r>-1&&(this.recordPoints.splice(r,1),this.maskShapes[r].remove(),this.maskShapes.splice(r,1),this.preMovePoint=null,this.updateShapesCapture(!0),this.emitEvent("change"))},t.prototype.clearAll=function(){this.recordPointClear(),this.maskShapes.forEach(function(r){return r.remove()}),this.maskShapes=[],this.preMovePoint=null},t.prototype.clear=function(){var r=this.getCurMaskShapeIndex();r===-1?(this.recordPointClear(),this.maskShapes.forEach(function(n){return n.remove()}),this.maskShapes=[],this.emitEvent("clearAll")):(this.recordPoints.splice(r,1),this.maskShapes[r].remove(),this.maskShapes.splice(r,1),this.preMovePoint=null,this.emitEvent("clearSingle")),this.preMovePoint=null},t.prototype.destroy=function(){this.clear(),e.prototype.destroy.call(this)},t.prototype.getRecordPoints=function(){var r;return an([],Lr((r=this.recordPoints)!==null&&r!==void 0?r:[]),!1)},t.prototype.recordPointStart=function(){var r=this.getRecordPoints(),n=this.getCurrentPoint();this.recordPoints=an(an([],Lr(r),!1),[[n]],!1)},t.prototype.recordPointContinue=function(){var r=this.getRecordPoints(),n=this.getCurrentPoint(),i=r.splice(-1,1)[0]||[];i.push(n),this.recordPoints=an(an([],Lr(r),!1),[i],!1)},t.prototype.recordPointClear=function(){this.recordPoints=[]},t.prototype.updateShapesCapture=function(r){this.maskShapes.forEach(function(n){return n.set("capture",r)})},t.prototype.getCurMaskShapeIndex=function(){var r=this.getCurrentPoint();return this.maskShapes.findIndex(function(n){var i=n.attrs,a=i.width,o=i.height,s=i.r,l=a===0||o===0||s===0;return!l&&n.isHit(r.x,r.y)})},t}(to),_ut=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.shapeType="rect",r}return t.prototype.getRegion=function(r){return hut(r)},t.prototype.getMaskAttrs=function(r){var n=this.getRegion(r),i=n.start,a=n.end;return fut(i,a)},t}(V6),xut=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.dim="x",r.inPlot=!0,r}return t.prototype.getRegion=function(r){var n=this.context.view.getCoordinate();return put(r,this.dim,this.inPlot,n)},t}(_ut),Kbe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.shapeType="circle",r.getMaskAttrs=cut,r}return t}(V6),but=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.getMaskPath=$6,r.getMaskAttrs=gut,r}return t.prototype.addPoint=function(){this.resize()},t}(V6),Qbe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.getMaskPath=H6,r.getMaskAttrs=yut,r}return t}(but),Jbe=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.setCursor=function(r){var n=this.context.view;n.getCanvas().setCursor(r)},t.prototype.default=function(){this.setCursor("default")},t.prototype.pointer=function(){this.setCursor("pointer")},t.prototype.move=function(){this.setCursor("move")},t.prototype.crosshair=function(){this.setCursor("crosshair")},t.prototype.wait=function(){this.setCursor("wait")},t.prototype.help=function(){this.setCursor("help")},t.prototype.text=function(){this.setCursor("text")},t.prototype.eResize=function(){this.setCursor("e-resize")},t.prototype.wResize=function(){this.setCursor("w-resize")},t.prototype.nResize=function(){this.setCursor("n-resize")},t.prototype.sResize=function(){this.setCursor("s-resize")},t.prototype.neResize=function(){this.setCursor("ne-resize")},t.prototype.nwResize=function(){this.setCursor("nw-resize")},t.prototype.seResize=function(){this.setCursor("se-resize")},t.prototype.swResize=function(){this.setCursor("sw-resize")},t.prototype.nsResize=function(){this.setCursor("ns-resize")},t.prototype.ewResize=function(){this.setCursor("ew-resize")},t.prototype.zoomIn=function(){this.setCursor("zoom-in")},t.prototype.zoomOut=function(){this.setCursor("zoom-out")},t}(to),tEe=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.filterView=function(r,n,i){var a=this;r.getScaleByField(n)&&r.filter(n,i),r.views&&r.views.length&&ft(r.views,function(o){a.filterView(o,n,i)})},t.prototype.filter=function(){var r=d_(this.context);if(r){var n=this.context.view,i=r.component,a=i.get("field");if(rS(r)){if(a){var o=i.getItemsByState("unchecked"),s=ob(n,a),l=o.map(function(v){return v.name});l.length?this.filterView(n,a,function(v){var g=s.getText(v);return!l.includes(g)}):this.filterView(n,a,null),n.render(!0)}}else if(vlt(r)){var u=i.getValue(),c=Lr(u,2),f=c[0],d=c[1];this.filterView(n,a,function(v){return v>=f&&v<=d}),n.render(!0)}}},t}(to);function mY(e,t,r,n){var i=Math.min(r[t],n[t]),a=Math.max(r[t],n[t]),o=Lr(e.range,2),s=o[0],l=o[1];if(i<s&&(i=s),a>l&&(a=l),i===l&&a===l)return null;var u=e.invert(i),c=e.invert(a);if(e.isCategory){var f=e.values.indexOf(u),d=e.values.indexOf(c),v=e.values.slice(f,d+1);return function(g){return v.includes(g)}}else return function(g){return g>=u&&g<=c}}var Dc;(function(e){e.FILTER="brush-filter-processing",e.RESET="brush-filter-reset",e.BEFORE_FILTER="brush-filter:beforefilter",e.AFTER_FILTER="brush-filter:afterfilter",e.BEFORE_RESET="brush-filter:beforereset",e.AFTER_RESET="brush-filter:afterreset"})(Dc||(Dc={}));var j3=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.dims=["x","y"],r.startPoint=null,r.isStarted=!1,r}return t.prototype.hasDim=function(r){return this.dims.includes(r)},t.prototype.start=function(){var r=this.context;this.isStarted=!0,this.startPoint=r.getCurrentPoint()},t.prototype.filter=function(){var r,n;if(nS(this.context)){var i=this.context.event.target,a=i.getCanvasBBox();r={x:a.x,y:a.y},n={x:a.maxX,y:a.maxY}}else{if(!this.isStarted)return;r=this.startPoint,n=this.context.getCurrentPoint()}if(!(Math.abs(r.x-n.x)<5||Math.abs(r.x-n.y)<5)){var o=this.context,s=o.view,l=o.event,u={view:s,event:l,dims:this.dims};s.emit(Dc.BEFORE_FILTER,So.fromData(s,Dc.BEFORE_FILTER,u));var c=s.getCoordinate(),f=c.invert(n),d=c.invert(r);if(this.hasDim("x")){var v=s.getXScale(),g=mY(v,"x",f,d);this.filterView(s,v.field,g)}if(this.hasDim("y")){var x=s.getYScales()[0],g=mY(x,"y",f,d);this.filterView(s,x.field,g)}this.reRender(s,{source:Dc.FILTER}),s.emit(Dc.AFTER_FILTER,So.fromData(s,Dc.AFTER_FILTER,u))}},t.prototype.end=function(){this.isStarted=!1},t.prototype.reset=function(){var r=this.context.view;if(r.emit(Dc.BEFORE_RESET,So.fromData(r,Dc.BEFORE_RESET,{})),this.isStarted=!1,this.hasDim("x")){var n=r.getXScale();this.filterView(r,n.field,null)}if(this.hasDim("y")){var i=r.getYScales()[0];this.filterView(r,i.field,null)}this.reRender(r,{source:Dc.RESET}),r.emit(Dc.AFTER_RESET,So.fromData(r,Dc.AFTER_RESET,{}))},t.prototype.filterView=function(r,n,i){r.filter(n,i)},t.prototype.reRender=function(r,n){r.render(!0,n)},t}(to),G6=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.filterView=function(r,n,i){var a=Gp(r);ft(a,function(o){o.filter(n,i)})},t.prototype.reRender=function(r){var n=Gp(r);ft(n,function(i){i.render(!0)})},t}(j3),eEe=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.filter=function(){var r=d_(this.context),n=this.context.view,i=Vl(n);if(nS(this.context)){var a=g6(this.context,10);a&&ft(i,function(x){a.includes(x)?x.show():x.hide()})}else if(r){var o=r.component,s=o.get("field");if(rS(r)){if(s){var l=o.getItemsByState("unchecked"),u=ob(n,s),c=l.map(function(x){return x.name});ft(i,function(x){var w=Wd(x,s),S=u.getText(w);c.indexOf(S)>=0?x.hide():x.show()})}}else if(vlt(r)){var f=o.getValue(),d=Lr(f,2),v=d[0],g=d[1];ft(i,function(x){var w=Wd(x,s);w>=v&&w<=g?x.show():x.hide()})}}},t.prototype.clear=function(){var r=Vl(this.context.view);ft(r,function(n){n.show()})},t.prototype.reset=function(){this.clear()},t}(to),Eut=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.byRecord=!1,r}return t.prototype.filter=function(){nS(this.context)&&(this.byRecord?this.filterByRecord():this.filterByBBox())},t.prototype.filterByRecord=function(){var r=this.context.view,n=g6(this.context,10);if(n){var i=r.getXScale().field,a=r.getYScales()[0].field,o=n.map(function(l){return l.getModel().data}),s=Gp(r);ft(s,function(l){var u=Vl(l);ft(u,function(c){var f=c.getModel().data;blt(o,f,i,a)?c.show():c.hide()})})}},t.prototype.filterByBBox=function(){var r=this,n=this.context.view,i=Gp(n);ft(i,function(a){var o=glt(r.context,a,10),s=Vl(a);o&&ft(s,function(l){o.includes(l)?l.show():l.hide()})})},t.prototype.reset=function(){var r=Gp(this.context.view);ft(r,function(n){var i=Vl(n);ft(i,function(a){a.show()})})},t}(to),rEe=10,nEe=5,iEe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.buttonGroup=null,r.buttonCfg={name:"button",text:"button",textStyle:{x:0,y:0,fontSize:12,fill:"#333333",cursor:"pointer"},padding:[8,10],style:{fill:"#f7f7f7",stroke:"#cccccc",cursor:"pointer"},activeStyle:{fill:"#e6e6e6"}},r}return t.prototype.getButtonCfg=function(){return Tr(this.buttonCfg,this.cfg)},t.prototype.drawButton=function(){var r=this.getButtonCfg(),n=this.context.view.foregroundGroup.addGroup({name:r.name}),i=n.addShape({type:"text",name:"button-text",attrs:U({text:r.text},r.textStyle)}),a=i.getBBox(),o=_6(r.padding),s=n.addShape({type:"rect",name:"button-rect",attrs:U({x:a.x-o[3],y:a.y-o[0],width:a.width+o[1]+o[3],height:a.height+o[0]+o[2]},r.style)});s.toBack(),n.on("mouseenter",function(){s.attr(r.activeStyle)}),n.on("mouseleave",function(){s.attr(r.style)}),this.buttonGroup=n},t.prototype.resetPosition=function(){var r=this.context.view,n=r.getCoordinate(),i=n.convert({x:1,y:1}),a=this.buttonGroup,o=a.getBBox(),s=Vs(null,[["t",i.x-o.width-rEe,i.y+o.height+nEe]]);a.setMatrix(s)},t.prototype.show=function(){this.buttonGroup||this.drawButton(),this.resetPosition(),this.buttonGroup.show()},t.prototype.hide=function(){this.buttonGroup&&this.buttonGroup.hide()},t.prototype.destroy=function(){var r=this.buttonGroup;r&&r.remove(),e.prototype.destroy.call(this)},t}(to),aEe=4,oEe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.starting=!1,r.dragStart=!1,r}return t.prototype.start=function(){this.starting=!0,this.startPoint=this.context.getCurrentPoint()},t.prototype.drag=function(){if(this.startPoint){var r=this.context.getCurrentPoint(),n=this.context.view,i=this.context.event;this.dragStart?n.emit("drag",{target:i.target,x:i.x,y:i.y}):m6(r,this.startPoint)>aEe&&(n.emit("dragstart",{target:i.target,x:i.x,y:i.y}),this.dragStart=!0)}},t.prototype.end=function(){if(this.dragStart){var r=this.context.view,n=this.context.event;r.emit("dragend",{target:n.target,x:n.x,y:n.y})}this.starting=!1,this.dragStart=!1},t}(to),sEe=5,lEe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.starting=!1,r.isMoving=!1,r.startPoint=null,r.startMatrix=null,r}return t.prototype.start=function(){this.starting=!0,this.startPoint=this.context.getCurrentPoint(),this.startMatrix=this.context.view.middleGroup.getMatrix()},t.prototype.move=function(){if(this.starting){var r=this.startPoint,n=this.context.getCurrentPoint(),i=m6(r,n);if(i>sEe&&!this.isMoving&&(this.isMoving=!0),this.isMoving){var a=this.context.view,o=Vs(this.startMatrix,[["t",n.x-r.x,n.y-r.y]]);a.backgroundGroup.setMatrix(o),a.foregroundGroup.setMatrix(o),a.middleGroup.setMatrix(o)}}},t.prototype.end=function(){this.isMoving&&(this.isMoving=!1),this.startMatrix=null,this.starting=!1,this.startPoint=null},t.prototype.reset=function(){this.starting=!1,this.startPoint=null,this.isMoving=!1;var r=this.context.view;r.backgroundGroup.resetMatrix(),r.foregroundGroup.resetMatrix(),r.middleGroup.resetMatrix(),this.isMoving=!1},t}(to),yY="x",_Y="y",wut=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.dims=[yY,_Y],r.cfgFields=["dims"],r.cacheScaleDefs={},r}return t.prototype.hasDim=function(r){return this.dims.includes(r)},t.prototype.getScale=function(r){var n=this.context.view;return r==="x"?n.getXScale():n.getYScales()[0]},t.prototype.resetDim=function(r){var n=this.context.view;if(this.hasDim(r)&&this.cacheScaleDefs[r]){var i=this.getScale(r);n.scale(i.field,this.cacheScaleDefs[r]),this.cacheScaleDefs[r]=null}},t.prototype.reset=function(){this.resetDim(yY),this.resetDim(_Y);var r=this.context.view;r.render(!0)},t}(to),uEe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.startPoint=null,r.starting=!1,r.startCache={},r}return t.prototype.start=function(){var r=this;this.startPoint=this.context.getCurrentPoint(),this.starting=!0;var n=this.dims;ft(n,function(i){var a=r.getScale(i),o=a.min,s=a.max,l=a.values;r.startCache[i]={min:o,max:s,values:l}})},t.prototype.end=function(){this.startPoint=null,this.starting=!1,this.startCache={}},t.prototype.translate=function(){var r=this;if(this.starting){var n=this.startPoint,i=this.context.view.getCoordinate(),a=this.context.getCurrentPoint(),o=i.invert(n),s=i.invert(a),l=s.x-o.x,u=s.y-o.y,c=this.context.view,f=this.dims;ft(f,function(d){r.translateDim(d,{x:l*-1,y:u*-1})}),c.render(!0)}},t.prototype.translateDim=function(r,n){if(this.hasDim(r)){var i=this.getScale(r);i.isLinear&&this.translateLinear(r,i,n)}},t.prototype.translateLinear=function(r,n,i){var a=this.context.view,o=this.startCache[r],s=o.min,l=o.max,u=l-s,c=i[r]*u;this.cacheScaleDefs[r]||(this.cacheScaleDefs[r]={nice:n.nice,min:s,max:l}),a.scale(n.field,{nice:!1,min:s+c,max:l+c})},t.prototype.reset=function(){e.prototype.reset.call(this),this.startPoint=null,this.starting=!1},t}(wut),cEe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.zoomRatio=.05,r}return t.prototype.zoomIn=function(){this.zoom(this.zoomRatio)},t.prototype.zoom=function(r){var n=this,i=this.dims;ft(i,function(a){n.zoomDim(a,r)}),this.context.view.render(!0)},t.prototype.zoomOut=function(){this.zoom(-1*this.zoomRatio)},t.prototype.zoomDim=function(r,n){if(this.hasDim(r)){var i=this.getScale(r);i.isLinear&&this.zoomLinear(r,i,n)}},t.prototype.zoomLinear=function(r,n,i){var a=this.context.view;this.cacheScaleDefs[r]||(this.cacheScaleDefs[r]={nice:n.nice,min:n.min,max:n.max});var o=this.cacheScaleDefs[r],s=o.max-o.min,l=n.min,u=n.max,c=i*s,f=l-c,d=u+c,v=d-f,g=v/s;d>f&&g<100&&g>.01&&a.scale(n.field,{nice:!1,min:l-c,max:u+c})},t}(wut);function hEe(e){var t=e.gEvent.originalEvent;return t.deltaY>0}var fEe=1,dEe=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.scroll=function(r){var n=this.context,i=n.view,a=n.event;if(i.getOptions().scrollbar){var o=(r==null?void 0:r.wheelDelta)||fEe,s=i.getController("scrollbar"),l=i.getXScale(),u=i.getOptions().data,c=_l($d(u,l.field)),f=_l(l.values),d=s.getValue(),v=Math.floor((c-f)*d),g=v+(hEe(a)?o:-o),x=o/(c-f)/1e4,w=lo(g/(c-f)+x,0,1);s.setValue(w)}},t}(to),pEe="aixs-description-tooltip",vEe=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.show=function(){var r=this.context,n=d_(r).axis,i=n.cfg.title,a=i.description,o=i.text,s=i.descriptionTooltipStyle,l=r.event,u=l.x,c=l.y;this.tooltip||this.renderTooltip(),this.tooltip.update({title:o||"",customContent:function(){return`
          <div class="`.concat(ug,'" style={').concat(s,`}>
            <div class="`).concat(cg,`">
              字段说明：`).concat(a,`
            </div>
          </div>
        `)},x:u,y:c}),this.tooltip.show()},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.tooltip&&this.tooltip.destroy()},t.prototype.hide=function(){this.tooltip&&this.tooltip.hide()},t.prototype.renderTooltip=function(){var r,n=this.context.view,i=n.canvas,a={start:{x:0,y:0},end:{x:i.get("width"),y:i.get("height")}},o=new k3({parent:i.get("el").parentNode,region:a,visible:!1,containerId:pEe,domStyles:U({},Tr({},(r={},r[ug]={"max-width":"50%",padding:"10px","line-height":"15px","font-size":"12px",color:"rgba(0, 0, 0, .65)"},r[cg]={"word-break":"break-all","margin-bottom":"3px"},r)))});o.init(),o.setCapture(!1),this.tooltip=o},t}(to);h_e("dark",wlt(Q_e));lst("canvas",FHt);lst("svg",L1e);lv("Polygon",W1e);lv("Interval",U1e);lv("Schema",X1e);lv("Path",T6);lv("Point",V1e);lv("Line",$1e);lv("Area",P1e);lv("Edge",D1e);lv("Heatmap",F1e);lv("Violin",Y1e);JS("base",G3);JS("interval",cxe);JS("pie",hxe);JS("polar",rut);ih("overlap",Sxe);ih("distribute",dxe);ih("fixed-overlap",Cxe);ih("hide-overlap",Fxe);ih("limit-in-shape",xxe);ih("limit-in-canvas",_xe);ih("limit-in-plot",Qxe);ih("pie-outer",vxe);ih("adjust-color",Nxe);ih("interval-adjust-position",$xe);ih("interval-hide-overlap",Vxe);ih("point-adjust-position",Xxe);ih("pie-spider",yxe);ih("path-adjust-position",Zxe);Wh("fade-in",Jxe);Wh("fade-out",tbe);Wh("grow-in-x",rbe);Wh("grow-in-xy",ibe);Wh("grow-in-y",nbe);Wh("scale-in-x",sbe);Wh("scale-in-y",lbe);Wh("wave-in",cbe);Wh("zoom-in",hbe);Wh("zoom-out",fbe);Wh("position-update",obe);Wh("sector-path-update",ube);Wh("path-in",abe);zb("rect",mbe);zb("mirror",gbe);zb("list",pbe);zb("matrix",vbe);zb("circle",dbe);zb("tree",ybe);P_("axis",bbe);P_("legend",Ebe);P_("tooltip",Mlt);P_("annotation",xbe);P_("slider",wbe);P_("scrollbar",Tbe);mn("tooltip",sut);mn("sibling-tooltip",Ibe);mn("ellipsis-text",Lbe);mn("element-active",Obe);mn("element-single-active",Fbe);mn("element-range-active",Dbe);mn("element-highlight",k6);mn("element-highlight-by-x",Nbe);mn("element-highlight-by-color",Bbe);mn("element-single-highlight",kbe);mn("element-range-highlight",uut);mn("element-sibling-highlight",uut,{effectSiblings:!0,effectByRecord:!0});mn("element-selected",Ube);mn("element-single-selected",$be);mn("element-range-selected",zbe);mn("element-link-by-color",Pbe);mn("active-region",Rbe);mn("list-active",Hbe);mn("list-selected",Gbe);mn("list-highlight",z6);mn("list-unchecked",Wbe);mn("list-checked",Xbe);mn("list-focus",jbe);mn("list-radio",Ybe);mn("legend-item-highlight",z6,{componentNames:["legend"]});mn("axis-label-highlight",z6,{componentNames:["axis"]});mn("axis-description",vEe);mn("rect-mask",dut);mn("x-rect-mask",vut,{dim:"x"});mn("y-rect-mask",vut,{dim:"y"});mn("circle-mask",Zbe);mn("path-mask",mut);mn("smooth-path-mask",qbe);mn("rect-multi-mask",_ut);mn("x-rect-multi-mask",xut,{dim:"x"});mn("y-rect-multi-mask",xut,{dim:"y"});mn("circle-multi-mask",Kbe);mn("path-multi-mask",but);mn("smooth-path-multi-mask",Qbe);mn("cursor",Jbe);mn("data-filter",tEe);mn("brush",j3);mn("brush-x",j3,{dims:["x"]});mn("brush-y",j3,{dims:["y"]});mn("sibling-filter",G6);mn("sibling-x-filter",G6,{dims:"x"});mn("sibling-y-filter",G6,{dims:"y"});mn("element-filter",eEe);mn("element-sibling-filter",Eut);mn("element-sibling-filter-record",Eut,{byRecord:!0});mn("view-drag",oEe);mn("view-move",lEe);mn("scale-translate",uEe);mn("scale-zoom",cEe);mn("reset-button",iEe,{name:"reset-button",text:"reset"});mn("mousewheel-scroll",dEe);function og(e){return e.isInPlot()}Yn("tooltip",{start:[{trigger:"plot:mousemove",action:"tooltip:show",throttle:{wait:50,leading:!0,trailing:!1}},{trigger:"plot:touchmove",action:"tooltip:show",throttle:{wait:50,leading:!0,trailing:!1}}],end:[{trigger:"plot:mouseleave",action:"tooltip:hide"},{trigger:"plot:leave",action:"tooltip:hide"},{trigger:"plot:touchend",action:"tooltip:hide"}]});Yn("ellipsis-text",{start:[{trigger:"legend-item-name:mousemove",action:"ellipsis-text:show",throttle:{wait:50,leading:!0,trailing:!1}},{trigger:"legend-item-name:touchstart",action:"ellipsis-text:show",throttle:{wait:50,leading:!0,trailing:!1}},{trigger:"axis-label:mousemove",action:"ellipsis-text:show",throttle:{wait:50,leading:!0,trailing:!1}},{trigger:"axis-label:touchstart",action:"ellipsis-text:show",throttle:{wait:50,leading:!0,trailing:!1}}],end:[{trigger:"legend-item-name:mouseleave",action:"ellipsis-text:hide"},{trigger:"legend-item-name:touchend",action:"ellipsis-text:hide"},{trigger:"axis-label:mouseleave",action:"ellipsis-text:hide"},{trigger:"axis-label:mouseout",action:"ellipsis-text:hide"},{trigger:"axis-label:touchend",action:"ellipsis-text:hide"}]});Yn("element-active",{start:[{trigger:"element:mouseenter",action:"element-active:active"}],end:[{trigger:"element:mouseleave",action:"element-active:reset"}]});Yn("element-selected",{start:[{trigger:"element:click",action:"element-selected:toggle"}]});Yn("element-highlight",{start:[{trigger:"element:mouseenter",action:"element-highlight:highlight"}],end:[{trigger:"element:mouseleave",action:"element-highlight:reset"}]});Yn("element-highlight-by-x",{start:[{trigger:"element:mouseenter",action:"element-highlight-by-x:highlight"}],end:[{trigger:"element:mouseleave",action:"element-highlight-by-x:reset"}]});Yn("element-highlight-by-color",{start:[{trigger:"element:mouseenter",action:"element-highlight-by-color:highlight"}],end:[{trigger:"element:mouseleave",action:"element-highlight-by-color:reset"}]});Yn("legend-active",{start:[{trigger:"legend-item:mouseenter",action:["list-active:active","element-active:active"]}],end:[{trigger:"legend-item:mouseleave",action:["list-active:reset","element-active:reset"]}]});Yn("legend-highlight",{start:[{trigger:"legend-item:mouseenter",action:["legend-item-highlight:highlight","element-highlight:highlight"]}],end:[{trigger:"legend-item:mouseleave",action:["legend-item-highlight:reset","element-highlight:reset"]}]});Yn("axis-label-highlight",{start:[{trigger:"axis-label:mouseenter",action:["axis-label-highlight:highlight","element-highlight:highlight"]}],end:[{trigger:"axis-label:mouseleave",action:["axis-label-highlight:reset","element-highlight:reset"]}]});Yn("element-list-highlight",{start:[{trigger:"element:mouseenter",action:["list-highlight:highlight","element-highlight:highlight"]}],end:[{trigger:"element:mouseleave",action:["list-highlight:reset","element-highlight:reset"]}]});Yn("element-range-highlight",{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"mask:mouseenter",action:"cursor:move"},{trigger:"plot:mouseleave",action:"cursor:default"},{trigger:"mask:mouseleave",action:"cursor:crosshair"}],start:[{trigger:"plot:mousedown",isEnable:function(e){return!e.isInShape("mask")},action:["rect-mask:start","rect-mask:show"]},{trigger:"mask:dragstart",action:["rect-mask:moveStart"]}],processing:[{trigger:"plot:mousemove",action:["rect-mask:resize"]},{trigger:"mask:drag",action:["rect-mask:move"]},{trigger:"mask:change",action:["element-range-highlight:highlight"]}],end:[{trigger:"plot:mouseup",action:["rect-mask:end"]},{trigger:"mask:dragend",action:["rect-mask:moveEnd"]},{trigger:"document:mouseup",isEnable:function(e){return!e.isInPlot()},action:["element-range-highlight:clear","rect-mask:end","rect-mask:hide"]}],rollback:[{trigger:"dblclick",action:["element-range-highlight:clear","rect-mask:hide"]}]});Yn("brush",{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"mousedown",isEnable:og,action:["brush:start","rect-mask:start","rect-mask:show"]}],processing:[{trigger:"mousemove",isEnable:og,action:["rect-mask:resize"]}],end:[{trigger:"mouseup",isEnable:og,action:["brush:filter","brush:end","rect-mask:end","rect-mask:hide","reset-button:show"]}],rollback:[{trigger:"reset-button:click",action:["brush:reset","reset-button:hide","cursor:crosshair"]}]});Yn("brush-visible",{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"plot:mousedown",action:["rect-mask:start","rect-mask:show"]}],processing:[{trigger:"plot:mousemove",action:["rect-mask:resize"]},{trigger:"mask:change",action:["element-range-highlight:highlight"]}],end:[{trigger:"plot:mouseup",action:["rect-mask:end","rect-mask:hide","element-filter:filter","element-range-highlight:clear"]}],rollback:[{trigger:"dblclick",action:["element-filter:clear"]}]});Yn("brush-x",{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"mousedown",isEnable:og,action:["brush-x:start","x-rect-mask:start","x-rect-mask:show"]}],processing:[{trigger:"mousemove",isEnable:og,action:["x-rect-mask:resize"]}],end:[{trigger:"mouseup",isEnable:og,action:["brush-x:filter","brush-x:end","x-rect-mask:end","x-rect-mask:hide"]}],rollback:[{trigger:"dblclick",action:["brush-x:reset"]}]});Yn("element-path-highlight",{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"mousedown",isEnable:og,action:"path-mask:start"},{trigger:"mousedown",isEnable:og,action:"path-mask:show"}],processing:[{trigger:"mousemove",action:"path-mask:addPoint"}],end:[{trigger:"mouseup",action:"path-mask:end"}],rollback:[{trigger:"dblclick",action:"path-mask:hide"}]});Yn("brush-x-multi",{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"mask:mouseenter",action:"cursor:move"},{trigger:"plot:mouseleave",action:"cursor:default"},{trigger:"mask:mouseleave",action:"cursor:crosshair"}],start:[{trigger:"mousedown",isEnable:og,action:["x-rect-multi-mask:start","x-rect-multi-mask:show"]},{trigger:"mask:dragstart",action:["x-rect-multi-mask:moveStart"]}],processing:[{trigger:"mousemove",isEnable:function(e){return!$3(e)},action:["x-rect-multi-mask:resize"]},{trigger:"multi-mask:change",action:"element-range-highlight:highlight"},{trigger:"mask:drag",action:["x-rect-multi-mask:move"]}],end:[{trigger:"mouseup",action:["x-rect-multi-mask:end"]},{trigger:"mask:dragend",action:["x-rect-multi-mask:moveEnd"]}],rollback:[{trigger:"dblclick",action:["x-rect-multi-mask:clear","cursor:crosshair"]},{trigger:"multi-mask:clearAll",action:["element-range-highlight:clear"]},{trigger:"multi-mask:clearSingle",action:["element-range-highlight:highlight"]}]});Yn("element-single-selected",{start:[{trigger:"element:click",action:"element-single-selected:toggle"}]});Yn("legend-filter",{showEnable:[{trigger:"legend-item:mouseenter",action:["cursor:pointer","list-radio:show"]},{trigger:"legend-item:mouseleave",action:["cursor:default","list-radio:hide"]}],start:[{trigger:"legend-item:click",isEnable:function(e){return!e.isInShape("legend-item-radio")},action:["legend-item-highlight:reset","element-highlight:reset","list-unchecked:toggle","data-filter:filter","list-radio:show"]},{trigger:"legend-item-radio:mouseenter",action:["list-radio:showTip"]},{trigger:"legend-item-radio:mouseleave",action:["list-radio:hideTip"]},{trigger:"legend-item-radio:click",action:["list-focus:toggle","data-filter:filter","list-radio:show"]}]});Yn("continuous-filter",{start:[{trigger:"legend:valuechanged",action:"data-filter:filter"}]});Yn("continuous-visible-filter",{start:[{trigger:"legend:valuechanged",action:"element-filter:filter"}]});Yn("legend-visible-filter",{showEnable:[{trigger:"legend-item:mouseenter",action:"cursor:pointer"},{trigger:"legend-item:mouseleave",action:"cursor:default"}],start:[{trigger:"legend-item:click",action:["legend-item-highlight:reset","element-highlight:reset","list-unchecked:toggle","element-filter:filter"]}]});Yn("active-region",{start:[{trigger:"plot:mousemove",action:"active-region:show"}],end:[{trigger:"plot:mouseleave",action:"active-region:hide"}]});Yn("axis-description",{start:[{trigger:"axis-description:mousemove",action:"axis-description:show"}],end:[{trigger:"axis-description:mouseleave",action:"axis-description:hide"}]});function xY(e){return e.gEvent.preventDefault(),e.gEvent.originalEvent.deltaY>0}Yn("view-zoom",{start:[{trigger:"plot:mousewheel",isEnable:function(e){return xY(e.event)},action:"scale-zoom:zoomOut",throttle:{wait:100,leading:!0,trailing:!1}},{trigger:"plot:mousewheel",isEnable:function(e){return!xY(e.event)},action:"scale-zoom:zoomIn",throttle:{wait:100,leading:!0,trailing:!1}}]});Yn("sibling-tooltip",{start:[{trigger:"plot:mousemove",action:"sibling-tooltip:show"}],end:[{trigger:"plot:mouseleave",action:"sibling-tooltip:hide"}]});Yn("plot-mousewheel-scroll",{start:[{trigger:"plot:mousewheel",action:"mousewheel-scroll:scroll"}]});var Wc=["type","alias","tickCount","tickInterval","min","max","nice","minLimit","maxLimit","range","tickMethod","base","exponent","mask","sync"],Xd;(function(e){e.ERROR="error",e.WARN="warn",e.INFO="log"})(Xd||(Xd={}));var gEe="AntV/G2Plot";function mEe(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=0;return"".concat(gEe,": ").concat(e.replace(/%s/g,function(){return"".concat(t[n++])}))}function fg(e,t,r){for(var n=[],i=3;i<arguments.length;i++)n[i-3]=arguments[i];t||console[e](mEe.apply(void 0,an([r],n,!1)))}function xa(e,t){var r={};return e!==null&&typeof e=="object"&&t.forEach(function(n){var i=e[n];i!==void 0&&(r[n]=i)}),r}function W6(e,t){if(!e)return{};var r=e.filter(function(a){var o=xt(a,[t]);return Gn(o)&&!isNaN(o)}),n=r.every(function(a){return xt(a,[t])>=0}),i=r.every(function(a){return xt(a,[t])<=0});return n?{min:0}:i?{max:0}:{}}function Cut(e,t,r,n,i){if(i===void 0&&(i=[]),!Array.isArray(e))return{nodes:[],links:[]};var a=[],o={},s=-1;return e.forEach(function(l){var u=l[t],c=l[r],f=l[n],d=xa(l,i);o[u]||(o[u]=U({id:++s,name:u},d)),o[c]||(o[c]=U({id:++s,name:c},d)),a.push(U({source:o[u].id,target:o[c].id,value:f},d))}),{nodes:Object.values(o).sort(function(l,u){return l.id-u.id}),links:a}}function lb(e,t){var r=Wl(e,function(n){var i=n[t];return i===null||typeof i=="number"&&!isNaN(i)});return fg(Xd.WARN,r.length===e.length,"illegal data existed in chart data."),r}var yEe=5,_Ee={}.toString,Sut=function(e,t){return _Ee.call(e)==="[object "+t+"]"},xEe=function(e){return Sut(e,"Array")},bEe=function(e){return typeof e=="object"&&e!==null},bY=function(e){if(!bEe(e)||!Sut(e,"Object"))return!1;for(var t=e;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t},Tut=function(e,t,r,n){r=r||0,n=n||yEe;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var a=t[i];a?bY(a)?(bY(e[i])||(e[i]={}),r<n?Tut(e[i],a,r+1,n):e[i]=t[i]):xEe(a)?(e[i]=[],e[i]=e[i].concat(a)):e[i]=a:e[i]=a}},ge=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n=0;n<t.length;n+=1)Tut(e,t[n]);return e};function e5(e){if(!e)return{width:0,height:0};var t=getComputedStyle(e);return{width:(e.clientWidth||parseInt(t.width,10))-parseInt(t.paddingLeft,10)-parseInt(t.paddingRight,10),height:(e.clientHeight||parseInt(t.height,10))-parseInt(t.paddingTop,10)-parseInt(t.paddingBottom,10)}}function Nn(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(r){return e.reduce(function(n,i){return i(n)},r)}}function fu(e,t){return e.geometries.find(function(r){return r.type===t})}function zR(e){return Fu(e.geometries,function(t,r){return t.concat(r.elements)},[])}function aS(e){return xt(e,["views","length"],0)<=0?zR(e):Fu(e.views,function(t,r){return t.concat(aS(r))},zR(e))}function EEe(e){return xt(e,["views","length"],0)<=0?e.geometries:Fu(e.views,function(t,r){return t.concat(r.geometries)},e.geometries)}function EY(e){if(!e)return e;var t=e.match(/(([A-Z]{0,1}[a-z]*[^A-Z])|([A-Z]{1}))/g);return t.map(function(r){return r.toLowerCase()}).join("-")}function wl(e){if(!d0(e,"Object"))return e;var t=U({},e);return t.formatter&&!t.content&&(t.content=t.formatter),t}var IP;function wEe(){return IP||(IP=document.createElement("canvas").getContext("2d")),IP}wb(function(e,t){t===void 0&&(t={});var r=t.fontSize,n=t.fontFamily,i=n===void 0?"sans-serif":n,a=t.fontWeight,o=t.fontStyle,s=t.fontVariant,l=wEe();l.font=[o,a,s,"".concat(r,"px"),i].join(" ");var u=l.measureText(nn(e)?e:"");return u.width},function(e,t){return t===void 0&&(t={}),an([e],wI(t),!0).join("")});function v_(e){return typeof e=="number"&&!isNaN(e)}function CEe(e,t,r){var n=Math.min(t,r),i=Math.max(t,r);return e>=n&&e<=i}function s0(e){if(Gn(e))return[e,e,e,e];if(ze(e)){var t=e.length;if(t===1)return[e[0],e[0],e[0],e[0]];if(t===2)return[e[0],e[1],e[0],e[1]];if(t===3)return[e[0],e[1],e[2],e[1]];if(t===4)return e}return[0,0,0,0]}function Y3(e,t,r){t===void 0&&(t="bottom"),r===void 0&&(r=25);var n=s0(e),i=[t.startsWith("top")?r:0,t.startsWith("right")?r:0,t.startsWith("bottom")?r:0,t.startsWith("left")?r:0];return[n[0]+i[0],n[1]+i[1],n[2]+i[2],n[3]+i[3]]}function X6(e){var t=e.map(function(n){return s0(n)}),r=[0,0,0,0];return t.length>0&&(r=r.map(function(n,i){return t.forEach(function(a,o){n+=t[o][i]}),n})),r}function SEe(e,t){var r=[];if(e.length){r.push(["M",e[0].x,e[0].y]);for(var n=1,i=e.length;n<i;n+=1){var a=e[n];r.push(["L",a.x,a.y])}t&&r.push(["Z"])}return r}var TEe=function(e,t,r,n){var i=[],a,o,s=!!n,l,u;if(s){l=[1/0,1/0],u=[-1/0,-1/0];for(var c=0,f=e.length;c<f;c++){var d=e[c];l=Nl([0,0],l,d),u=kl([0,0],u,d)}l=Nl([0,0],l,n[0]),u=kl([0,0],u,n[1])}for(var c=0,v=e.length;c<v;c++){var d=e[c];if(r)a=e[c?c-1:v-1],o=e[(c+1)%v];else if(c===0||c===v-1){i.push(d);continue}else a=e[c-1],o=e[c+1];var g=[0,0];g=rg(g,o,a),g=ic(g,g,t);var x=Px(d,a),w=Px(d,o),S=x+w;S!==0&&(x/=S,w/=S);var A=ic([0,0],g,-x),M=ic([0,0],g,w),R=zl([0,0],d,A),O=zl([0,0],d,M);s&&(R=kl([0,0],R,l),R=Nl([0,0],R,u),O=kl([0,0],O,l),O=Nl([0,0],O,u)),i.push(R),i.push(O)}return r&&i.push(i.shift()),i};function AEe(e,t,r){for(var n=!!t,i=[],a=0,o=e.length;a<o;a+=2)i.push([e[a],e[a+1]]);for(var s=TEe(i,.4,n,r),l=i.length,u=[],c,f,d,a=0;a<l-1;a++)c=s[a*2],f=s[a*2+1],d=i[a+1],u.push(["C",c[0],c[1],f[0],f[1],d[0],d[1]]);return n&&(c=s[l],f=s[l+1],d=i[0],u.push(["C",c[0],c[1],f[0],f[1],d[0],d[1]])),u}function MEe(e,t,r){var n=[],i=e[0],a=null;if(e.length<=2)return SEe(e,t);for(var o=0,s=e.length;o<s;o++){var l=e[o];(!a||!(a.x===l.x&&a.y===l.y))&&(n.push(l.x),n.push(l.y),a=l)}var u=r||[[0,0],[1,1]],c=AEe(n,t,u);return c.unshift(["M",i.x,i.y]),c}function Aut(e){var t={overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis",display:"flex",justifyContent:"center",alignItems:"center"},r=["stroke","lineWidth","shadowColor","strokeOpacity","shadowBlur","shadowOffsetX","shadowOffsetY","fill"];xt(e,"fill")&&(t.color=e.fill);var n=xa(e,r),i=n.shadowColor,a=n.shadowBlur,o=a===void 0?0:a,s=n.shadowOffsetX,l=s===void 0?0:s,u=n.shadowOffsetY,c=u===void 0?0:u;t["text-shadow"]="".concat([i,"".concat(l,"px"),"".concat(c,"px"),"".concat(o,"px")].join(" "));var f=xa(e,r),d=f.stroke,v=f.lineWidth,g=v===void 0?0:v;return t["-webkit-text-stroke"]="".concat(["".concat(g,"px"),d].join(" ")),ft(e,function(x,w){["fontSize"].includes(w)&&Gn(x)?t[EY(w)]="".concat(x,"px"):w&&!r.includes(w)&&(t[EY(w)]="".concat(x))}),t}function Mut(e,t){e.style["pointer-events"]="none",ft(t,function(r,n){n&&r&&(e.style[n]=r)})}var Z3=function(e,t,r){var n=t.statistic,i=t.plotType,a=n.title,o=n.content;[a,o].forEach(function(s,l){if(s){var u="";l===0?u=o?"translate(-50%, -100%)":"translate(-50%, -50%)":u=a?"translate(-50%, 0)":"translate(-50%, -50%)";var c=$r(s.style)?s.style(r):s.style;e.annotation().html(U({position:["50%","50%"],html:function(f,d){var v=d.getCoordinate(),g=0;if(i==="pie"||i==="ring-progress")g=v.getRadius()*v.innerRadius*2;else if(i==="liquid"){var x=xt(d.geometries,[0,"elements",0,"shape"]);if(x){var w=x.find(function(R){return R.get("name")==="wrap"}),S=w.getCanvasBBox().width;g=S}}else g||(g=v.getWidth());Mut(f,U({width:"".concat(g,"px"),transform:u},Aut(c)));var A=d.getData();if(s.customHtml)return s.customHtml(f,d,r,A);var M=s.content;return s.formatter&&(M=s.formatter(r,A)),M?nn(M)?M:"".concat(M):"<div></div>"},key:"".concat(l===0?"top":"bottom","-statistic")},xa(s,["offsetX","offsetY","rotate","style","formatter"])))}})},REe=function(e,t,r){var n=t.statistic,i=n.title,a=n.content;[i,a].forEach(function(o){if(o){var s=$r(o.style)?o.style(r):o.style;e.annotation().html(U({position:["50%","100%"],html:function(l,u){var c=u.getCoordinate(),f=u.views[0].getCoordinate(),d=f.getCenter(),v=f.getRadius(),g=Math.max(Math.sin(f.startAngle),Math.sin(f.endAngle))*v,x=d.y+g-c.y.start-parseFloat(xt(s,"fontSize",0)),w=c.getRadius()*c.innerRadius*2;Mut(l,U({width:"".concat(w,"px"),transform:"translate(-50%, ".concat(x,"px)")},Aut(s)));var S=u.getData();if(o.customHtml)return o.customHtml(l,u,r,S);var A=o.content;return o.formatter&&(A=o.formatter(r,S)),A?nn(A)?A:"".concat(A):"<div></div>"}},xa(o,["offsetX","offsetY","rotate","style","formatter"])))}})};function Rut(e,t){return t?Fu(t,function(r,n,i){return r.replace(new RegExp("{\\s*".concat(i,"\\s*}"),"g"),n)},e):e}function yi(e,t){return e.views.find(function(r){return r.id===t})}function Aw(e){var t=e.parent;return t?t.views:[]}function wY(e){return Aw(e).filter(function(t){return t!==e})}function r2(e,t,r){r===void 0&&(r=e.geometries),typeof t=="boolean"?e.animate(t):e.animate(!0),ft(r,function(n){var i;$r(t)?i=t(n.type||n.shapeType,n)||!0:i=t,n.animate(i)})}function q3(){return typeof window=="object"?window==null?void 0:window.devicePixelRatio:2}function j6(e,t){t===void 0&&(t=e);var r=document.createElement("canvas"),n=q3();r.width=e*n,r.height=t*n,r.style.width="".concat(e,"px"),r.style.height="".concat(t,"px");var i=r.getContext("2d");return i.scale(n,n),r}function Y6(e,t,r,n){n===void 0&&(n=r);var i=t.backgroundColor,a=t.opacity;e.globalAlpha=a,e.fillStyle=i,e.beginPath(),e.fillRect(0,0,r,n),e.closePath()}function Iut(e,t,r){var n=e+t;return r?n*2:n}function Lut(e,t){var r=t?[[e*.25,e*.25],[e*.75,e*.75]]:[[e*.5,e*.5]];return r}function Z6(e,t){var r=t*Math.PI/180,n={a:Math.cos(r)*(1/e),b:Math.sin(r)*(1/e),c:-Math.sin(r)*(1/e),d:Math.cos(r)*(1/e),e:0,f:0};return n}var IEe={size:6,padding:2,backgroundColor:"transparent",opacity:1,rotation:0,fill:"#fff",fillOpacity:.5,stroke:"transparent",lineWidth:0,isStagger:!0};function LEe(e,t,r,n){var i=t.size,a=t.fill,o=t.lineWidth,s=t.stroke,l=t.fillOpacity;e.beginPath(),e.globalAlpha=l,e.fillStyle=a,e.strokeStyle=s,e.lineWidth=o,e.arc(r,n,i/2,0,2*Math.PI,!1),e.fill(),o&&e.stroke(),e.closePath()}function OEe(e){var t=ge({},IEe,e),r=t.size,n=t.padding,i=t.isStagger,a=t.rotation,o=Iut(r,n,i),s=Lut(o,i),l=j6(o,o),u=l.getContext("2d");Y6(u,t,o);for(var c=0,f=s;c<f.length;c++){var d=f[c],v=d[0],g=d[1];LEe(u,t,v,g)}var x=u.createPattern(l,"repeat");if(x){var w=q3(),S=Z6(w,a);x.setTransform(S)}return x}var PEe={rotation:45,spacing:5,opacity:1,backgroundColor:"transparent",strokeOpacity:.5,stroke:"#fff",lineWidth:2};function DEe(e,t,r){var n=t.stroke,i=t.lineWidth,a=t.strokeOpacity,o=new Path2D(r);e.globalAlpha=a,e.lineCap="square",e.strokeStyle=i?n:"transparent",e.lineWidth=i,e.stroke(o)}function FEe(e){var t=ge({},PEe,e),r=t.spacing,n=t.rotation,i=t.lineWidth,a=r+i||1,o=r+i||1,s=`
            M 0 0 L `.concat(a,` 0
            M 0 `).concat(o," L ").concat(a," ").concat(o,`
            `),l=j6(a,o),u=l.getContext("2d");Y6(u,t,a,o),DEe(u,t,s);var c=u.createPattern(l,"repeat");if(c){var f=q3(),d=Z6(f,n);c.setTransform(d)}return c}var BEe={size:6,padding:1,isStagger:!0,backgroundColor:"transparent",opacity:1,rotation:0,fill:"#fff",fillOpacity:.5,stroke:"transparent",lineWidth:0};function NEe(e,t,r,n){var i=t.stroke,a=t.size,o=t.fill,s=t.lineWidth,l=t.fillOpacity;e.globalAlpha=l,e.strokeStyle=i,e.lineWidth=s,e.fillStyle=o,e.strokeRect(r-a/2,n-a/2,a,a),e.fillRect(r-a/2,n-a/2,a,a)}function kEe(e){var t=ge({},BEe,e),r=t.size,n=t.padding,i=t.isStagger,a=t.rotation,o=Iut(r,n,i),s=Lut(o,i),l=j6(o,o),u=l.getContext("2d");Y6(u,t,o);for(var c=0,f=s;c<f.length;c++){var d=f[c],v=d[0],g=d[1];NEe(u,t,v,g)}var x=u.createPattern(l,"repeat");if(x){var w=q3(),S=Z6(w,a);x.setTransform(S)}return x}function zEe(e){var t=e.type,r=e.cfg,n;switch(t){case"dot":n=OEe(r);break;case"line":n=FEe(r);break;case"square":n=kEe(r);break}return n}function Xh(e){var t=this;return function(r){var n,i=r.options,a=r.chart,o=i.pattern;if(!o)return r;var s=function(l){for(var u,c,f,d=[],v=1;v<arguments.length;v++)d[v-1]=arguments[v];var g=a.getTheme().defaultColor,x=g,w=(c=(u=a.geometries)===null||u===void 0?void 0:u[0])===null||c===void 0?void 0:c.getAttribute("color");if(w){var S=w.getFields()[0],A=xt(l,S);x=eh.getMappingValue(w,A,((f=w.values)===null||f===void 0?void 0:f[0])||g)}var M=o;typeof o=="function"&&(M=o.call(t,l,x)),M instanceof CanvasPattern||(M=zEe(ge({},{cfg:{backgroundColor:x}},M)));var R=i[e];return U(U({},typeof R=="function"?R.call.apply(R,an([t,l],d,!1)):R||{}),{fill:M||x})};return ge({},r,{options:(n={},n[e]=s,n)})}}function $b(e){var t=e.chart,r=e.options,n=r.legend,i=r.colorField,a=r.seriesField;return n===!1?t.legend(!1):(i||a)&&t.legend(i||a,n),e}function nl(e){var t=e.chart,r=e.options,n=r.tooltip;return n!==void 0&&t.tooltip(n),e}function _o(e){var t=e.chart,r=e.options,n=r.interactions;return ft(n,function(i){i.enable===!1?t.removeInteraction(i.type):t.interaction(i.type,i.cfg||{})}),e}function Aa(e){var t=e.chart,r=e.options,n=r.animation;return r2(t,n),e}function Ji(e){var t=e.chart,r=e.options,n=r.theme;return n&&t.theme(n),e}function w0(e){var t=e.chart,r=e.options,n=r.state;return n&&ft(t.geometries,function(i){i.state(n)}),e}function n2(e){var t=e.chart,r=e.options,n=r.slider;return t.option("slider",n),e}function q6(e){var t=e.chart,r=e.options,n=r.scrollbar;return t.option("scrollbar",n),e}function ns(e,t){return function(r){var n=r.chart,i=r.options,a={};return ft(e,function(o,s){a[s]=xa(o,Wc)}),a=ge({},t,i.meta,a),n.scale(a),r}}function To(e){return function(t){var r=t.chart,n=t.options,i=r.getController("annotation");return ft(an(an([],n.annotations||[],!0),e||[],!0),function(a){i.annotation(a)}),t}}function g_(e){var t=e.chart,r=e.options,n=r.yAxis,i=r.limitInPlot,a=i;return qi(n)&&ke(i)&&(Object.values(xa(n,["min","max","minLimit","maxLimit"])).some(function(o){return!ke(o)})?a=!0:a=!1),t.limitInPlot=a,e}function Out(e){return e===void 0&&(e="rect"),function(t){var r=t.chart,n=t.options,i=n.coordinate,a=Array.from(i||[]).map(function(o){return o.type==="reflectX"?["reflect","x"]:o.type==="reflectY"?["reflect","y"]:o.type==="transpose"?["transpose"]:null}).filter(function(o){return!!o});return a.length!==0&&r.coordinate({type:e,actions:a}),t}}var UEe={locale:"en-US"},qA={};function Put(e,t){qA[e]=t}function K3(e){return{get:function(t,r){return Rut(xt(qA[e],t)||xt(qA[UEe.locale],t)||xt(qA["en-US"],t)||t,r)}}}var $Ee={locale:"en-US",general:{increase:"Increase",decrease:"Decrease",root:"Root"},statistic:{total:"Total"},conversionTag:{label:"Rate"},legend:{},tooltip:{},slider:{},scrollbar:{},waterfall:{total:"Total"}},HEe={locale:"zh-CN",general:{increase:"增加",decrease:"减少",root:"初始"},statistic:{total:"总计"},conversionTag:{label:"转化率"},legend:{},tooltip:{},slider:{},scrollbar:{},waterfall:{total:"总计"}};function rd(e,t){if(e===!1)return{fields:!1};var r=xt(e,"fields"),n=xt(e,"formatter");return n&&!r&&(r=t),{fields:r,formatter:n}}function pA(e,t){var r=e.type,n=e.xField,i=e.yField,a=e.colorField,o=e.shapeField,s=e.sizeField,l=e.styleField,u=e.rawFields,c=[];if(u=($r(u)?u(r,t):u)||[],t==="color")c=an([a||n],u,!0);else if(t==="shape")c=an([o||n],u,!0);else if(t==="size")c=an([s||n],u,!0);else{c=an([n,i,a,o,s,l],u,!0);var f=["x","y","color","shape","size","style"].indexOf(t),d=c[f];c.splice(f,1),c.unshift(d)}var v=Jy(c.filter(function(x){return!!x})),g=r==="line"&&[n,i].includes(v.join("*"))?"":v.join("*");return{mappingFields:v,tileMappingField:g}}function V1(e,t){if(t)return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i={};return e.forEach(function(a,o){i[a]=r[o]}),delete i.undefined,t(i)}}function ah(e){var t=e.chart,r=e.options,n=r.type,i=r.args,a=r.mapping,o=r.xField,s=r.yField,l=r.colorField,u=r.shapeField,c=r.sizeField,f=r.tooltipFields,d=r.label,v=r.state,g=r.customInfo;if(!a)return e;var x=a.color,w=a.shape,S=a.size,A=a.style,M=a.tooltip,R=t[n](i).position("".concat(o,"*").concat(s));if(nn(x))l?R.color(l,x):R.color(x);else if($r(x)){var O=pA(r,"color"),N=O.mappingFields,k=O.tileMappingField;R.color(k,V1(N,x))}else l&&R.color(l,x);if(nn(w))u?R.shape(u,[w]):R.shape(w);else if($r(w)){var V=pA(r,"shape"),N=V.mappingFields,k=V.tileMappingField;R.shape(k,V1(N,w))}else u&&R.shape(u,w);if(Gn(S))c?R.size(c,S):R.size(S);else if($r(S)){var Q=pA(r,"size"),N=Q.mappingFields,k=Q.tileMappingField;R.size(k,V1(N,S))}else c&&R.size(c,S);if($r(A)){var Y=pA(r,"style"),N=Y.mappingFields,k=Y.tileMappingField;R.style(k,V1(N,A))}else qi(A)&&R.style(A);if(f===!1?R.tooltip(!1):Kc(f)||R.tooltip(f.join("*"),V1(f,M)),d===!1)R.label(!1);else if(d){var X=d.callback,tt=d.fields,it=hi(d,["callback","fields"]);R.label({fields:tt||[s],callback:X,cfg:wl(it)})}return v&&R.state(v),g&&R.customInfo(g),[o,s].filter(function(Et){return Et!==l}).forEach(function(Et){t.legend(Et,!1)}),U(U({},e),{ext:{geometry:R}})}function Q3(e){var t=e.options,r=t.area,n=t.xField,i=t.yField,a=t.seriesField,o=t.smooth,s=t.tooltip,l=t.useDeferredLabel,u=rd(s,[n,i,a]),c=u.fields,f=u.formatter;return r?ah(ge({},e,{options:{type:"area",colorField:a,tooltipFields:c,mapping:Tr({shape:o?"smooth":"area",tooltip:f},r),args:{useDeferredLabel:l}}})):e}function Dut(e){var t=e.options,r=t.edge,n=t.xField,i=t.yField,a=t.seriesField,o=t.tooltip,s=t.useDeferredLabel,l=rd(o,[n,i,a]),u=l.fields,c=l.formatter;return r?ah(ge({},e,{options:{type:"edge",colorField:a,tooltipFields:u,mapping:U({tooltip:c},r),args:{useDeferredLabel:s}}})):e}function VEe(e){var t=e.chart,r=e.options,n=e.ext,i=r.seriesField,a=r.isGroup,o=r.isStack,s=r.marginRatio,l=r.widthRatio,u=r.groupField,c=r.theme,f=[];if(i&&(a&&f.push({type:"dodge",dodgeBy:u||i,marginRatio:s}),o&&f.push({type:"stack",marginRatio:s})),f.length&&(n!=null&&n.geometry)){var d=n==null?void 0:n.geometry;d.adjust(f)}return ke(l)||t.theme(ge({},qi(c)?c:Kw(c),{columnWidthRatio:l})),e}function du(e){var t=e.options,r=t.xField,n=t.yField,i=t.interval,a=t.seriesField,o=t.tooltip,s=t.minColumnWidth,l=t.maxColumnWidth,u=t.columnBackground,c=t.dodgePadding,f=t.intervalPadding,d=t.useDeferredLabel,v=rd(o,[r,n,a]),g=v.fields,x=v.formatter,w=(i?ah(ge({},e,{options:{type:"interval",colorField:a,tooltipFields:g,mapping:U({tooltip:x},i),args:{dodgePadding:c,intervalPadding:f,minColumnWidth:s,maxColumnWidth:l,background:u,useDeferredLabel:d}}})):e).ext;return VEe(U(U({},e),{ext:w}))}function Hb(e){var t=e.options,r=t.line,n=t.stepType,i=t.xField,a=t.yField,o=t.seriesField,s=t.smooth,l=t.connectNulls,u=t.tooltip,c=t.useDeferredLabel,f=rd(u,[i,a,o]),d=f.fields,v=f.formatter;return r?ah(ge({},e,{options:{type:"line",colorField:o,tooltipFields:d,mapping:Tr({shape:n||(s?"smooth":"line"),tooltip:v},r),args:{connectNulls:l,useDeferredLabel:c}}})):e}function jh(e){var t=e.options,r=t.point,n=t.xField,i=t.yField,a=t.seriesField,o=t.sizeField,s=t.shapeField,l=t.tooltip,u=t.useDeferredLabel,c=rd(l,[n,i,a,o,s]),f=c.fields,d=c.formatter;return r?ah(ge({},e,{options:{type:"point",colorField:a,shapeField:s,tooltipFields:f,mapping:U({tooltip:d},r),args:{useDeferredLabel:u}}})):e}function J3(e){var t=e.options,r=t.polygon,n=t.xField,i=t.yField,a=t.seriesField,o=t.tooltip,s=t.useDeferredLabel,l=rd(o,[n,i,a]),u=l.fields,c=l.formatter;return r?ah(ge({},e,{options:{type:"polygon",colorField:a,tooltipFields:u,mapping:U({tooltip:c},r),args:{useDeferredLabel:s}}})):e}function K6(e){var t=e.options,r=t.schema,n=t.xField,i=t.yField,a=t.seriesField,o=t.tooltip,s=t.useDeferredLabel,l=rd(o,[n,i,a]),u=l.fields,c=l.formatter;return r?ah(ge({},e,{options:{type:"schema",colorField:a,tooltipFields:u,mapping:U({tooltip:c},r),args:{useDeferredLabel:s}}})):e}function GEe(e){var t=e.options,r=t.violin,n=t.xField,i=t.yField,a=t.seriesField,o=t.sizeField,s=t.tooltip,l=rd(s,[n,i,a,o]),u=l.fields,c=l.formatter;return r?ah(ge({},e,{options:{type:"violin",colorField:a,tooltipFields:u,mapping:U({tooltip:c},r)}})):e}var Vy={},Hm={},Fut={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=1,r=function(){return"".concat(t++)};e.default=r})(Fut);var tL={},eL={},Q6={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:60,a=null;return function(){for(var o=this,s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];clearTimeout(a),a=setTimeout(function(){n.apply(o,l)},i)}};e.default=t})(Q6);var Wp={};Object.defineProperty(Wp,"__esModule",{value:!0});Wp.SizeSensorId=Wp.SensorTabIndex=Wp.SensorClassName=void 0;var WEe="size-sensor-id";Wp.SizeSensorId=WEe;var XEe="size-sensor-object";Wp.SensorClassName=XEe;var jEe="-1";Wp.SensorTabIndex=jEe;Object.defineProperty(eL,"__esModule",{value:!0});eL.createSensor=void 0;var YEe=ZEe(Q6),LP=Wp;function ZEe(e){return e&&e.__esModule?e:{default:e}}var qEe=function(t,r){var n=void 0,i=[],a=function(){getComputedStyle(t).position==="static"&&(t.style.position="relative");var f=document.createElement("object");return f.onload=function(){f.contentDocument.defaultView.addEventListener("resize",o),o()},f.style.display="block",f.style.position="absolute",f.style.top="0",f.style.left="0",f.style.height="100%",f.style.width="100%",f.style.overflow="hidden",f.style.pointerEvents="none",f.style.zIndex="-1",f.style.opacity="0",f.setAttribute("class",LP.SensorClassName),f.setAttribute("tabindex",LP.SensorTabIndex),f.type="text/html",t.appendChild(f),f.data="about:blank",f},o=(0,YEe.default)(function(){i.forEach(function(c){c(t)})}),s=function(f){n||(n=a()),i.indexOf(f)===-1&&i.push(f)},l=function(){n&&n.parentNode&&(n.contentDocument&&n.contentDocument.defaultView.removeEventListener("resize",o),n.parentNode.removeChild(n),t.removeAttribute(LP.SizeSensorId),n=void 0,i=[],r&&r())},u=function(f){var d=i.indexOf(f);d!==-1&&i.splice(d,1),i.length===0&&n&&l()};return{element:t,bind:s,destroy:l,unbind:u}};eL.createSensor=qEe;var rL={};Object.defineProperty(rL,"__esModule",{value:!0});rL.createSensor=void 0;var KEe=Wp,QEe=JEe(Q6);function JEe(e){return e&&e.__esModule?e:{default:e}}var twe=function(t,r){var n=void 0,i=[],a=(0,QEe.default)(function(){i.forEach(function(c){c(t)})}),o=function(){var f=new ResizeObserver(a);return f.observe(t),a(),f},s=function(f){n||(n=o()),i.indexOf(f)===-1&&i.push(f)},l=function(){n.disconnect(),i=[],n=void 0,t.removeAttribute(KEe.SizeSensorId),r&&r()},u=function(f){var d=i.indexOf(f);d!==-1&&i.splice(d,1),i.length===0&&n&&l()};return{element:t,bind:s,destroy:l,unbind:u}};rL.createSensor=twe;Object.defineProperty(tL,"__esModule",{value:!0});tL.createSensor=void 0;var ewe=eL,rwe=rL,nwe=typeof ResizeObserver<"u"?rwe.createSensor:ewe.createSensor;tL.createSensor=nwe;Object.defineProperty(Hm,"__esModule",{value:!0});Hm.removeSensor=Hm.getSensor=Hm.Sensors=void 0;var iwe=owe(Fut),awe=tL,r5=Wp;function owe(e){return e&&e.__esModule?e:{default:e}}var Sx={};Hm.Sensors=Sx;function But(e){e&&Sx[e]&&delete Sx[e]}var swe=function(t){var r=t.getAttribute(r5.SizeSensorId);if(r&&Sx[r])return Sx[r];var n=(0,iwe.default)();t.setAttribute(r5.SizeSensorId,n);var i=(0,awe.createSensor)(t,function(){return But(n)});return Sx[n]=i,i};Hm.getSensor=swe;var lwe=function(t){var r=t.element.getAttribute(r5.SizeSensorId);t.destroy(),But(r)};Hm.removeSensor=lwe;Object.defineProperty(Vy,"__esModule",{value:!0});Vy.ver=Vy.clear=Nut=Vy.bind=void 0;var n5=Hm,uwe=function(t,r){var n=(0,n5.getSensor)(t);return n.bind(r),function(){n.unbind(r)}},Nut=Vy.bind=uwe,cwe=function(t){var r=(0,n5.getSensor)(t);(0,n5.removeSensor)(r)};Vy.clear=cwe;var hwe="1.0.2";Vy.ver=hwe;var CY="data-chart-source-type",kut=["padding","appendPadding","renderer","pixelRatio","syncViewPadding","supportCSSTransform","limitInPlot"],Jn=function(e){Ut(t,e);function t(r,n){var i=e.call(this)||this;return i.container=typeof r=="string"?document.getElementById(r):r,i.options=ge({},i.getDefaultOptions(),n),i.createG2(),i.bindEvents(),i}return t.getDefaultOptions=function(){return{renderer:"canvas",xAxis:{nice:!0,label:{autoRotate:!1,autoHide:{type:"equidistance",cfg:{minGap:6}}}},yAxis:{nice:!0,label:{autoHide:!0,autoRotate:!1}},animation:!0}},t.prototype.createG2=function(){var r=this.options,n=r.width,i=r.height,a=r.defaultInteractions;this.chart=new A_e(U(U(U(U({container:this.container,autoFit:!1},this.getChartSize(n,i)),{localRefresh:!1}),xa(this.options,kut)),{defaultInteractions:a})),this.container.setAttribute(CY,"G2Plot")},t.prototype.getChartSize=function(r,n){var i=e5(this.container);return{width:r||i.width||400,height:n||i.height||400}},t.prototype.bindEvents=function(){var r=this;this.chart&&this.chart.on("*",function(n){n!=null&&n.type&&r.emit(n.type,n)})},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.render=function(){this.chart.clear(),this.chart.options={data:[],animate:!0},this.chart.views=[],this.execAdaptor(),this.chart.render(),this.bindSizeSensor()},t.prototype.update=function(r){this.updateOption(r),this.render()},t.prototype.updateOption=function(r){this.options=ge({},this.options,r)},t.prototype.setState=function(r,n,i){i===void 0&&(i=!0);var a=aS(this.chart);ft(a,function(o){n(o.getData())&&o.setState(r,i)})},t.prototype.getStates=function(){var r=aS(this.chart),n=[];return ft(r,function(i){var a=i.getData(),o=i.getStates();ft(o,function(s){n.push({data:a,state:s,geometry:i.geometry,element:i})})}),n},t.prototype.changeData=function(r){this.update({data:r})},t.prototype.changeSize=function(r,n){this.chart.changeSize(r,n)},t.prototype.addAnnotations=function(r,n){n=n||this.chart;var i=an([],r,!0),a=n.getController("annotation"),o=a.getComponents().map(function(u){return u.extra});a.clear(!0);for(var s=function(u){var c=o[u],f=i.findIndex(function(d){return d.id&&d.id===c.id});f!==-1&&(c=ge({},c,i[f]),i.splice(f,1)),a.annotation(c)},l=0;l<o.length;l++)s(l);i.forEach(function(u){return a.annotation(u)}),n.render(!0)},t.prototype.removeAnnotations=function(r){var n=this.chart.getController("annotation"),i=n.getComponents().map(function(s){return s.extra});n.clear(!0);for(var a=function(s){var l=i[s];r.find(function(u){return u.id&&u.id===l.id})||n.annotation(l)},o=0;o<i.length;o++)a(o);this.chart.render(!0)},t.prototype.destroy=function(){this.unbindSizeSensor(),this.chart.destroy(),this.off(),this.container.removeAttribute(CY)},t.prototype.execAdaptor=function(){var r=this.getSchemaAdaptor(),n=this.options,i=n.padding,a=n.appendPadding;this.chart.padding=i,this.chart.appendPadding=a,r({chart:this.chart,options:this.options})},t.prototype.triggerResize=function(){this.chart.forceFit()},t.prototype.bindSizeSensor=function(){var r=this;if(!this.unbind){var n=this.options.autoFit,i=n===void 0?!0:n;i&&(this.unbind=Nut(this.container,function(){var a=e5(r.container),o=a.width,s=a.height;(o!==r.chart.width||s!==r.chart.height)&&r.triggerResize()}))}},t.prototype.unbindSizeSensor=function(){this.unbind&&(this.unbind(),this.unbind=void 0)},t}(S_);function zut(e,t,r,n){var i=Fu(e,function(a,o){var s=o[r],l=a.has(s)?a.get(s):0,u=o[t];return l=v_(u)?l+u:l,a.set(s,l),a},new Map);return mo(e,function(a){var o,s=a[t],l=a[r],u=v_(s)&&i.get(l)!==0?s/i.get(l):0;return U(U({},a),(o={},o[n]=u,o))})}function fwe(e,t,r,n){var i=Fu(e,function(a,o){var s=Fu(r,function(c,f){return"".concat(c).concat(o[f])},""),l=a.has(s)?a.get(s):0,u=o[t];return l=v_(u)?l+u:l,a.set(s,l),a},new Map);return mo(e,function(a){var o,s=a[t],l=Fu(r,function(c,f){return"".concat(c).concat(a[f])},""),u=v_(s)&&i.get(l)!==0?s/i.get(l):0;return U(U({},a),(o={},o[n]=u,o))})}function i2(e,t,r,n,i){return i?zut(e,t,r,n):e}function dwe(e){var t=e.chart,r=e.options,n=r.data,i=r.color,a=r.lineStyle,o=r.lineShape,s=r.point,l=r.area,u=r.seriesField,c=s==null?void 0:s.state,f=l==null?void 0:l.state;t.data(n);var d=ge({},e,{options:{shapeField:u,line:{color:i,style:a,shape:o},point:s&&U({color:i,shape:"circle"},s),area:l&&U({color:i},l),label:void 0}}),v=ge({},d,{options:{tooltip:!1,state:c}}),g=ge({},d,{options:{tooltip:!1,state:f}});return Hb(d),jh(v),Q3(g),e}function nL(e){var t,r,n=e.options,i=n.xAxis,a=n.yAxis,o=n.xField,s=n.yField,l=n.data;return Nn(ns((t={},t[o]=i,t[s]=a,t),(r={},r[o]={type:"cat"},r[s]=W6(l,s),r)))(e)}function pwe(e){var t=e.chart,r=e.options,n=r.reflect;if(n){var i=n;ze(i)||(i=[i]);var a=i.map(function(o){return["reflect",o]});t.coordinate({type:"rect",actions:a})}return e}function Uut(e){var t=e.chart,r=e.options,n=r.xAxis,i=r.yAxis,a=r.xField,o=r.yField;return n===!1?t.axis(a,!1):t.axis(a,n),i===!1?t.axis(o,!1):t.axis(o,i),e}function $ut(e){var t=e.chart,r=e.options,n=r.legend,i=r.seriesField;return n&&i?t.legend(i,n):n===!1&&t.legend(!1),e}function vwe(e){var t=e.chart,r=e.options,n=r.label,i=r.yField,a=fu(t,"line");if(!n)a.label(!1);else{var o=n.fields,s=n.callback,l=hi(n,["fields","callback"]);a.label({fields:o||[i],callback:s,cfg:U({layout:[{type:"limit-in-plot"},{type:"path-adjust-position"},{type:"point-adjust-position"},{type:"limit-in-plot",cfg:{action:"hide"}}]},wl(l))})}return e}function gwe(e){var t=e.chart,r=e.options,n=r.isStack;return n&&ft(t.geometries,function(i){i.adjust("stack")}),e}function Hut(e){return Nn(dwe,nL,gwe,Ji,pwe,Uut,$ut,nl,vwe,n2,q6,_o,Aa,To(),g_)(e)}function mwe(e){var t=e.chart,r=e.options,n=r.data,i=r.areaStyle,a=r.areaShape,o=r.color,s=r.point,l=r.line,u=r.isPercent,c=r.xField,f=r.yField,d=r.tooltip,v=r.seriesField,g=r.startOnZero,x=s==null?void 0:s.state,w=i2(n,f,c,f,u);t.data(w);var S=u?U({formatter:function(O){return{name:O[v]||O[c],value:(Number(O[f])*100).toFixed(2)+"%"}}},d):d,A=ge({},e,{options:{area:{color:o,style:i,shape:a},point:s&&U({color:o},s),tooltip:S,label:void 0,args:{startOnZero:g}}}),M={chart:t,options:ge({line:{size:2}},CI(r,["state"]),{line:l&&U({color:o},l),sizeField:v,state:l==null?void 0:l.state,tooltip:!1,label:void 0,args:{startOnZero:g}})},R=ge({},A,{options:{tooltip:!1,state:x}});return Q3(A),Hb(M),jh(R),e}function ywe(e){var t=e.chart,r=e.options,n=r.label,i=r.yField,a=fu(t,"area");if(!n)a.label(!1);else{var o=n.fields,s=n.callback,l=hi(n,["fields","callback"]);a.label({fields:o||[i],callback:s,cfg:U({layout:[{type:"limit-in-plot"},{type:"path-adjust-position"},{type:"point-adjust-position"},{type:"limit-in-plot",cfg:{action:"hide"}}]},wl(l))})}return e}function _we(e){var t=e.chart,r=e.options,n=r.isStack,i=r.isPercent,a=r.seriesField;return(i||n)&&a&&ft(t.geometries,function(o){o.adjust("stack")}),e}function Vut(e){return Nn(Ji,Xh("areaStyle"),Out("rect"),mwe,nL,_we,Uut,$ut,nl,ywe,n2,To(),_o,Aa,g_)(e)}var xwe=ge({},Jn.getDefaultOptions(),{tooltip:{shared:!0,showMarkers:!0,showCrosshairs:!0,crosshairs:{type:"x"}},isStack:!0,line:{},legend:{position:"top-left",radio:{}}}),Gut=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="area",r}return t.getDefaultOptions=function(){return xwe},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.changeData=function(r){this.updateOption({data:r});var n=this.options,i=n.isPercent,a=n.xField,o=n.yField,s=this,l=s.chart,u=s.options;nL({chart:l,options:u}),this.chart.changeData(i2(r,o,a,o,i))},t.prototype.getSchemaAdaptor=function(){return Vut},t}(Jn);const j3e=Object.freeze(Object.defineProperty({__proto__:null,Area:Gut},Symbol.toStringTag,{value:"Module"}));var bwe=10,Ewe=5,wwe={padding:[8,10],text:"reset",textStyle:{default:{x:0,y:0,fontSize:12,fill:"#333333",cursor:"pointer"}},buttonStyle:{default:{fill:"#f7f7f7",stroke:"#cccccc",cursor:"pointer"},active:{fill:"#e6e6e6"}}},Cwe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.buttonGroup=null,r.buttonCfg=U({name:"button"},wwe),r}return t.prototype.getButtonCfg=function(){var r=this.context.view,n=xt(r,["interactions","filter-action","cfg","buttonConfig"]);return ge(this.buttonCfg,n,this.cfg)},t.prototype.drawButton=function(){var r=this.getButtonCfg(),n=this.context.view.foregroundGroup.addGroup({name:r.name}),i=this.drawText(n);this.drawBackground(n,i.getBBox()),this.buttonGroup=n},t.prototype.drawText=function(r){var n,i=this.getButtonCfg();return r.addShape({type:"text",name:"button-text",attrs:U({text:i.text},(n=i.textStyle)===null||n===void 0?void 0:n.default)})},t.prototype.drawBackground=function(r,n){var i,a=this.getButtonCfg(),o=s0(a.padding),s=r.addShape({type:"rect",name:"button-rect",attrs:U({x:n.x-o[3],y:n.y-o[0],width:n.width+o[1]+o[3],height:n.height+o[0]+o[2]},(i=a.buttonStyle)===null||i===void 0?void 0:i.default)});return s.toBack(),r.on("mouseenter",function(){var l;s.attr((l=a.buttonStyle)===null||l===void 0?void 0:l.active)}),r.on("mouseleave",function(){var l;s.attr((l=a.buttonStyle)===null||l===void 0?void 0:l.default)}),s},t.prototype.resetPosition=function(){var r=this.context.view,n=r.getCoordinate(),i=n.convert({x:1,y:1}),a=this.buttonGroup,o=a.getBBox(),s=eh.transform(null,[["t",i.x-o.width-bwe,i.y+o.height+Ewe]]);a.setMatrix(s)},t.prototype.show=function(){this.buttonGroup||this.drawButton(),this.resetPosition(),this.buttonGroup.show()},t.prototype.hide=function(){this.buttonGroup&&this.buttonGroup.hide()},t.prototype.destroy=function(){var r=this.buttonGroup;r&&r.remove(),e.prototype.destroy.call(this)},t}(to);mn("brush-reset-button",Cwe,{name:"brush-reset-button"});Yn("filter-action",{});function Hv(e){return e.isInPlot()}function F_(e,t,r){var n=r||{},i=n.mask,a=n.isStartEnable,o=t||"rect";switch(e){case"brush":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair",isEnable:a||function(){return!0}},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"mousedown",isEnable:a||Hv,action:["brush:start","".concat(o,"-mask:start"),"".concat(o,"-mask:show")],arg:[null,{maskStyle:i==null?void 0:i.style}]}],processing:[{trigger:"mousemove",isEnable:Hv,action:["".concat(o,"-mask:resize")]}],end:[{trigger:"mouseup",isEnable:Hv,action:["brush:filter","brush:end","".concat(o,"-mask:end"),"".concat(o,"-mask:hide"),"brush-reset-button:show"]}],rollback:[{trigger:"brush-reset-button:click",action:["brush:reset","brush-reset-button:hide","cursor:crosshair"]}]};case"brush-highlight":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair",isEnable:a||function(){return!0}},{trigger:"plot:mousemove",action:"cursor:crosshair",isEnable:a||function(){return!0}},{trigger:"plot:mousemove",action:"cursor:default",isEnable:function(s){return a?!a(s):!1}},{trigger:"mask:mouseenter",action:"cursor:move",isEnable:a||function(){return!0}},{trigger:"plot:mouseleave",action:"cursor:default"},{trigger:"mask:mouseleave",action:"cursor:crosshair"}],start:[{trigger:"plot:mousedown",isEnable:a||function(s){return!s.isInShape("mask")},action:["".concat(o,"-mask:start"),"".concat(o,"-mask:show")],arg:[{maskStyle:i==null?void 0:i.style}]},{trigger:"mask:dragstart",action:["".concat(o,"-mask:moveStart")]}],processing:[{trigger:"plot:mousemove",action:["".concat(o,"-mask:resize")]},{trigger:"mask:drag",action:["".concat(o,"-mask:move")]},{trigger:"mask:change",action:["element-range-highlight:highlight"]}],end:[{trigger:"plot:mouseup",action:["".concat(o,"-mask:end")]},{trigger:"mask:dragend",action:["".concat(o,"-mask:moveEnd")]},{trigger:"document:mouseup",isEnable:function(s){return!s.isInPlot()},action:["element-range-highlight:clear","".concat(o,"-mask:end"),"".concat(o,"-mask:hide")]}],rollback:[{trigger:"dblclick",action:["element-range-highlight:clear","".concat(o,"-mask:hide")]}]};case"brush-x":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair",isEnable:a||function(){return!0}},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"mousedown",isEnable:a||Hv,action:["brush-x:start","".concat(o,"-mask:start"),"".concat(o,"-mask:show")],arg:[null,{maskStyle:i==null?void 0:i.style}]}],processing:[{trigger:"mousemove",isEnable:Hv,action:["".concat(o,"-mask:resize")]}],end:[{trigger:"mouseup",isEnable:Hv,action:["brush-x:filter","brush-x:end","".concat(o,"-mask:end"),"".concat(o,"-mask:hide")]}],rollback:[{trigger:"dblclick",action:["brush-x:reset"]}]};case"brush-x-highlight":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair",isEnable:a||function(){return!0}},{trigger:"mask:mouseenter",action:"cursor:move",isEnable:a||function(){return!0}},{trigger:"plot:mouseleave",action:"cursor:default"},{trigger:"mask:mouseleave",action:"cursor:crosshair"}],start:[{trigger:"plot:mousedown",isEnable:a||function(s){return!s.isInShape("mask")},action:["".concat(o,"-mask:start"),"".concat(o,"-mask:show")],arg:[{maskStyle:i==null?void 0:i.style}]},{trigger:"mask:dragstart",action:["".concat(o,"-mask:moveStart")]}],processing:[{trigger:"plot:mousemove",action:["".concat(o,"-mask:resize")]},{trigger:"mask:drag",action:["".concat(o,"-mask:move")]},{trigger:"mask:change",action:["element-range-highlight:highlight"]}],end:[{trigger:"plot:mouseup",action:["".concat(o,"-mask:end")]},{trigger:"mask:dragend",action:["".concat(o,"-mask:moveEnd")]},{trigger:"document:mouseup",isEnable:function(s){return!s.isInPlot()},action:["element-range-highlight:clear","".concat(o,"-mask:end"),"".concat(o,"-mask:hide")]}],rollback:[{trigger:"dblclick",action:["element-range-highlight:clear","".concat(o,"-mask:hide")]}]};case"brush-y":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair",isEnable:a||function(){return!0}},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"mousedown",isEnable:a||Hv,action:["brush-y:start","".concat(o,"-mask:start"),"".concat(o,"-mask:show")],arg:[null,{maskStyle:i==null?void 0:i.style}]}],processing:[{trigger:"mousemove",isEnable:Hv,action:["".concat(o,"-mask:resize")]}],end:[{trigger:"mouseup",isEnable:Hv,action:["brush-y:filter","brush-y:end","".concat(o,"-mask:end"),"".concat(o,"-mask:hide")]}],rollback:[{trigger:"dblclick",action:["brush-y:reset"]}]};case"brush-y-highlight":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair",isEnable:a||function(){return!0}},{trigger:"mask:mouseenter",action:"cursor:move",isEnable:a||function(){return!0}},{trigger:"plot:mouseleave",action:"cursor:default"},{trigger:"mask:mouseleave",action:"cursor:crosshair"}],start:[{trigger:"plot:mousedown",isEnable:a||function(s){return!s.isInShape("mask")},action:["".concat(o,"-mask:start"),"".concat(o,"-mask:show")],arg:[{maskStyle:i==null?void 0:i.style}]},{trigger:"mask:dragstart",action:["".concat(o,"-mask:moveStart")]}],processing:[{trigger:"plot:mousemove",action:["".concat(o,"-mask:resize")]},{trigger:"mask:drag",action:["".concat(o,"-mask:move")]},{trigger:"mask:change",action:["element-range-highlight:highlight"]}],end:[{trigger:"plot:mouseup",action:["".concat(o,"-mask:end")]},{trigger:"mask:dragend",action:["".concat(o,"-mask:moveEnd")]},{trigger:"document:mouseup",isEnable:function(s){return!s.isInPlot()},action:["element-range-highlight:clear","".concat(o,"-mask:end"),"".concat(o,"-mask:hide")]}],rollback:[{trigger:"dblclick",action:["element-range-highlight:clear","".concat(o,"-mask:hide")]}]};default:return{}}}Yn("brush",F_("brush"));Yn("brush-highlight",F_("brush-highlight"));Yn("brush-x",F_("brush-x","x-rect"));Yn("brush-y",F_("brush-y","y-rect"));Yn("brush-x-highlight",F_("brush-x-highlight","x-rect"));Yn("brush-y-highlight",F_("brush-y-highlight","y-rect"));var SY=["brush","brush-x","brush-y","brush-highlight","brush-x-highlight","brush-y-highlight"];function Wut(e){var t=e.options,r=t.brush,n=Wl(t.interactions||[],function(i){return SY.indexOf(i.type)===-1});return r!=null&&r.enabled&&(SY.forEach(function(i){var a=!1;switch(r.type){case"x-rect":a=i===(r.action==="highlight"?"brush-x-highlight":"brush-x");break;case"y-rect":a=i===(r.action==="highlight"?"brush-y-highlight":"brush-y");break;default:a=i===(r.action==="highlight"?"brush-highlight":"brush");break}var o={type:i,enable:a};r&&(o.cfg=F_(i,r.type,r)),n.push(o)}),(r==null?void 0:r.action)!=="highlight"&&n.push({type:"filter-action",cfg:{buttonConfig:r.button}})),ge({},e,{options:{interactions:n}})}var Gy={hover:"__interval-connected-area-hover__",click:"__interval-connected-area-click__"},J6=function(e,t){return e==="hover"?[{trigger:"interval:mouseenter",action:["element-highlight-by-color:highlight","element-link-by-color:link"],arg:[null,{style:t}]}]:[{trigger:"interval:click",action:["element-highlight-by-color:clear","element-highlight-by-color:highlight","element-link-by-color:clear","element-link-by-color:unlink","element-link-by-color:link"],arg:[null,null,null,null,{style:t}]}]};Yn(Gy.hover,{start:J6(Gy.hover),end:[{trigger:"interval:mouseleave",action:["element-highlight-by-color:reset","element-link-by-color:unlink"]}]});Yn(Gy.click,{start:J6(Gy.click),end:[{trigger:"document:mousedown",action:["element-highlight-by-color:clear","element-link-by-color:clear"]}]});function Swe(e){return e===void 0&&(e=!1),function(t){var r=t.chart,n=t.options,i=n.connectedArea,a=function(){r.removeInteraction(Gy.hover),r.removeInteraction(Gy.click)};if(!e&&i){var o=i.trigger||"hover";a(),r.interaction(Gy[o],{start:J6(o,i.style)})}else a();return t}}function Xut(e,t){return!Gn(e)||!Gn(t)||e===0&&t===0?"-":e===t?"100%":e===0?"∞":"".concat((100*t/e).toFixed(2),"%")}function Twe(e,t){return ge({size:t?32:80,spacing:t?8:12,offset:t?32:0,arrow:e.arrow!==!1&&{headSize:12,style:{fill:"rgba(0, 0, 0, 0.05)"}},text:e.text!==!1&&{style:{fontSize:12,fill:"rgba(0, 0, 0, 0.85)",textAlign:"center",textBaseline:"middle"},formatter:Xut}},e)}function UR(e,t){return mo(t.getModel().points,function(r){return e.convertPoint(r)})}function Awe(e,t,r){var n=e.view,i=e.geometry,a=e.group,o=e.options,s=e.horizontal,l=o.offset,u=o.size,c=o.arrow,f=n.getCoordinate(),d=UR(f,t)[3],v=UR(f,r)[0],g=v.y-d.y,x=v.x-d.x;if(typeof c!="boolean"){var w=c.headSize,S=o.spacing,A;s?(x-w)/2<S?(S=Math.max(1,(x-w)/2),A=[[d.x+S,d.y-l],[d.x+S,d.y-l-u],[v.x-S,v.y-l-u/2]]):A=[[d.x+S,d.y-l],[d.x+S,d.y-l-u],[v.x-S-w,v.y-l-u],[v.x-S,v.y-l-u/2],[v.x-S-w,v.y-l]]:(g-w)/2<S?(S=Math.max(1,(g-w)/2),A=[[d.x+l,d.y+S],[d.x+l+u,d.y+S],[v.x+l+u/2,v.y-S]]):A=[[d.x+l,d.y+S],[d.x+l+u,d.y+S],[v.x+l+u,v.y-S-w],[v.x+l+u/2,v.y-S],[v.x+l,v.y-S-w]],a.addShape("polygon",{id:"".concat(n.id,"-conversion-tag-arrow-").concat(i.getElementId(t.getModel().mappingData)),name:"conversion-tag-arrow",origin:{element:t,nextElement:r},attrs:U(U({},c.style||{}),{points:A})})}}function Mwe(e,t,r){var n,i,a,o=e.view,s=e.geometry,l=e.group,u=e.options,c=e.field,f=e.horizontal,d=u.offset,v=u.size;if(typeof u.text!="boolean"){var g=o.getCoordinate(),x=((n=u.text)===null||n===void 0?void 0:n.formatter)&&((i=u.text)===null||i===void 0?void 0:i.formatter(t.getData()[c],r.getData()[c])),w=UR(g,t)[f?3:0],S=UR(g,r)[f?0:3],A=l.addShape("text",{id:"".concat(o.id,"-conversion-tag-text-").concat(s.getElementId(t.getModel().mappingData)),name:"conversion-tag-text",origin:{element:t,nextElement:r},attrs:U(U({},((a=u.text)===null||a===void 0?void 0:a.style)||{}),{text:x,x:f?(w.x+S.x)/2:w.x+d+v/2,y:f?w.y-d-v/2:(w.y+S.y)/2})});if(f){var M=S.x-w.x,R=A.getBBox().width;if(R>M){var O=R/x.length,N=Math.max(1,Math.ceil(M/O)-1),k="".concat(x.slice(0,N),"...");A.attr("text",k)}}}}function Rwe(e,t,r){Awe(e,t,r),Mwe(e,t,r)}function Iwe(e,t,r){return t===void 0&&(t=!0),r===void 0&&(r=!1),function(n){var i=n.options,a=n.chart,o=i.conversionTag,s=i.theme;return o&&!r&&(a.theme(ge({},qi(s)?s:Kw(s),{columnWidthRatio:1/3})),a.annotation().shape({render:function(l,u){var c=l.addGroup({id:"".concat(a.id,"-conversion-tag-group"),name:"conversion-tag-group"}),f=Bd(a.geometries,function(g){return g.type==="interval"}),d={view:u,geometry:f,group:c,field:e,horizontal:t,options:Twe(o,t)},v=f.elements;ft(v,function(g,x){x>0&&Rwe(d,v[x-1],g)})}})),n}}function Lwe(e){var t=e.options,r=t.legend,n=t.seriesField,i=t.isStack;return n?r!==!1&&(r=U({position:i?"right-top":"top-left"},r)):r=!1,e.options.legend=r,e}function Owe(e){var t=e.chart,r=e.options,n=r.data,i=r.columnStyle,a=r.color,o=r.columnWidthRatio,s=r.isPercent,l=r.isGroup,u=r.isStack,c=r.xField,f=r.yField,d=r.seriesField,v=r.groupField,g=r.tooltip,x=r.shape,w=s&&l&&u?fwe(n,f,[c,v],f):i2(n,f,c,f,s),S=[];u&&d&&!l?w.forEach(function(R){var O=S.find(function(N){return N[c]===R[c]&&N[d]===R[d]});O?O[f]+=R[f]||0:S.push(U({},R))}):S=w,t.data(S);var A=s?U({formatter:function(R){var O;return{name:l&&u?"".concat(R[d]," - ").concat(R[v]):(O=R[d])!==null&&O!==void 0?O:R[c],value:(Number(R[f])*100).toFixed(2)+"%"}}},g):g,M=ge({},e,{options:{data:S,widthRatio:o,tooltip:A,interval:{shape:x,style:i,color:a}}});return du(M),M}function t8(e){var t,r,n=e.options,i=n.xAxis,a=n.yAxis,o=n.xField,s=n.yField,l=n.data,u=n.isPercent,c=u?{max:1,min:0,minLimit:0,maxLimit:1}:{};return Nn(ns((t={},t[o]=i,t[s]=a,t),(r={},r[o]={type:"cat"},r[s]=U(U({},W6(l,s)),c),r)))(e)}function Pwe(e){var t=e.chart,r=e.options,n=r.xAxis,i=r.yAxis,a=r.xField,o=r.yField;return n===!1?t.axis(a,!1):t.axis(a,n),i===!1?t.axis(o,!1):t.axis(o,i),e}function Dwe(e){var t=e.chart,r=e.options,n=r.legend,i=r.seriesField;return n&&i?t.legend(i,n):n===!1&&t.legend(!1),e}function Fwe(e){var t=e.chart,r=e.options,n=r.label,i=r.yField,a=r.isRange,o=fu(t,"interval");if(!n)o.label(!1);else{var s=n.callback,l=hi(n,["callback"]);o.label({fields:[i],callback:s,cfg:U({layout:l!=null&&l.position?void 0:[{type:"interval-adjust-position"},{type:"interval-hide-overlap"},{type:"adjust-color"},{type:"limit-in-plot",cfg:{action:"hide"}}]},wl(a?U({content:function(u){var c;return(c=u[i])===null||c===void 0?void 0:c.join("-")}},l):l))})}return e}function Bwe(e){var t=e.chart,r=e.options,n=r.tooltip,i=r.isGroup,a=r.isStack,o=r.groupField,s=r.data,l=r.xField,u=r.yField,c=r.seriesField;if(n===!1)t.tooltip(!1);else{var f=n;if(i&&a){var d=f.customItems,v=(f==null?void 0:f.formatter)||function(g){return{name:"".concat(g[c]," - ").concat(g[o]),value:g[u]}};f=U(U({},f),{customItems:function(g){var x=[];return ft(g,function(w){var S=Wl(s,function(A){return dtt(A,xa(w.data,[l,c]))});S.forEach(function(A){x.push(U(U(U({},w),{value:A[u],data:A,mappingData:{_origin:A}}),v(A)))})}),d?d(x):x}})}t.tooltip(f)}return e}function iL(e,t){t===void 0&&(t=!1);var r=e.options,n=r.seriesField;return Nn(Lwe,Ji,Xh("columnStyle"),w0,Out("rect"),Owe,t8,Pwe,Dwe,Bwe,n2,q6,Fwe,Wut,_o,Aa,To(),Iwe(r.yField,!t,!!n),Swe(!r.isStack),g_)(e)}function Nwe(e){var t=e.options,r=t.xField,n=t.yField,i=t.xAxis,a=t.yAxis,o={left:"bottom",right:"top",top:"left",bottom:"right"},s=a!==!1?U({position:o[(a==null?void 0:a.position)||"left"]},a):!1,l=i!==!1?U({position:o[(i==null?void 0:i.position)||"bottom"]},i):!1;return U(U({},e),{options:U(U({},t),{xField:n,yField:r,xAxis:s,yAxis:l})})}function kwe(e){var t=e.options,r=t.label;return r&&!r.position&&(r.position="left",r.layout||(r.layout=[{type:"interval-adjust-position"},{type:"interval-hide-overlap"},{type:"adjust-color"},{type:"limit-in-plot",cfg:{action:"hide"}}])),ge({},e,{options:{label:r}})}function zwe(e){var t=e.options,r=t.seriesField,n=t.isStack,i=t.legend;return r?i!==!1&&(i=U({position:n?"top-left":"right-top"},i||{})):i=!1,ge({},e,{options:{legend:i}})}function Uwe(e){var t=e.options,r=[{type:"transpose"},{type:"reflectY"}].concat(t.coordinate||[]);return ge({},e,{options:{coordinate:r}})}function $we(e){var t=e.chart,r=e.options,n=r.barStyle,i=r.barWidthRatio,a=r.minBarWidth,o=r.maxBarWidth,s=r.barBackground;return iL({chart:t,options:U(U({},r),{columnStyle:n,columnWidthRatio:i,minColumnWidth:a,maxColumnWidth:o,columnBackground:s})},!0)}function jut(e){return Nn(Nwe,kwe,zwe,nl,Uwe,$we)(e)}var Hwe=ge({},Jn.getDefaultOptions(),{barWidthRatio:.6,marginRatio:1/32,tooltip:{shared:!0,showMarkers:!1,offset:20},legend:{radio:{}},interactions:[{type:"active-region"}]}),Yut=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="bar",r}return t.getDefaultOptions=function(){return Hwe},t.prototype.changeData=function(r){var n,i;this.updateOption({data:r});var a=this,o=a.chart,s=a.options,l=s.isPercent,u=s.xField,c=s.yField,f=s.xAxis,d=s.yAxis;n=[c,u],u=n[0],c=n[1],i=[d,f],f=i[0],d=i[1];var v=U(U({},s),{xField:u,yField:c,yAxis:d,xAxis:f});t8({chart:o,options:v}),o.changeData(i2(r,u,c,u,l))},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return jut},t}(Jn);const Y3e=Object.freeze(Object.defineProperty({__proto__:null,Bar:Yut},Symbol.toStringTag,{value:"Module"}));var Vwe=ge({},Jn.getDefaultOptions(),{columnWidthRatio:.6,marginRatio:1/32,tooltip:{shared:!0,showMarkers:!1,offset:20},legend:{radio:{}},interactions:[{type:"active-region"}]}),Zut=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="column",r}return t.getDefaultOptions=function(){return Vwe},t.prototype.changeData=function(r){this.updateOption({data:r});var n=this.options,i=n.yField,a=n.xField,o=n.isPercent,s=this,l=s.chart,u=s.options;t8({chart:l,options:u}),this.chart.changeData(i2(r,i,a,i,o))},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return iL},t}(Jn);const Z3e=Object.freeze(Object.defineProperty({__proto__:null,Column:Zut},Symbol.toStringTag,{value:"Module"}));var OP,l0="$$percentage$$",u0="$$mappingValue$$",Xp="$$conversion$$",i5="$$totalPercentage$$",oS="$$x$$",sS="$$y$$",Gwe={appendPadding:[0,80],minSize:0,maxSize:1,meta:(OP={},OP[u0]={min:0,max:1,nice:!1},OP),label:{style:{fill:"#fff",fontSize:12}},tooltip:{showTitle:!1,showMarkers:!1,shared:!1},conversionTag:{offsetX:10,offsetY:0,style:{fontSize:12,fill:"rgba(0,0,0,0.45)"}}},qut="CONVERSION_TAG_NAME";function e8(e,t,r){var n=[],i=r.yField,a=r.maxSize,o=r.minSize,s=xt(mtt(t,i),[i]),l=Gn(a)?a:1,u=Gn(o)?o:0;return n=mo(e,function(c,f){var d=(c[i]||0)/s;return c[l0]=d,c[u0]=(l-u)*d+u,c[Xp]=[xt(e,[f-1,i]),c[i]],c}),n}function r8(e){return function(t){var r=t.chart,n=t.options,i=n.conversionTag,a=n.filteredData,o=a||r.getOptions().data;if(i){var s=i.formatter;o.forEach(function(l,u){if(!(u<=0||Number.isNaN(l[u0]))){var c=e(l,u,o,{top:!0,name:qut,text:{content:$r(s)?s(l,o):s,offsetX:i.offsetX,offsetY:i.offsetY,position:"end",autoRotate:!1,style:U({textAlign:"start",textBaseline:"middle"},i.style)}});r.annotation().line(c)}})}return t}}function Wwe(e){var t=e.chart,r=e.options,n=r.data,i=n===void 0?[]:n,a=r.yField,o=r.maxSize,s=r.minSize,l=e8(i,i,{yField:a,maxSize:o,minSize:s});return t.data(l),e}function Xwe(e){var t=e.chart,r=e.options,n=r.xField,i=r.yField,a=r.color,o=r.tooltip,s=r.label,l=r.shape,u=l===void 0?"funnel":l,c=r.funnelStyle,f=r.state,d=rd(o,[n,i]),v=d.fields,g=d.formatter;ah({chart:t,options:{type:"interval",xField:n,yField:u0,colorField:n,tooltipFields:ze(v)&&v.concat([l0,Xp]),mapping:{shape:u,tooltip:g,color:a,style:c},label:s,state:f}});var x=fu(e.chart,"interval");return x.adjust("symmetric"),e}function jwe(e){var t=e.chart,r=e.options,n=r.isTransposed;return t.coordinate({type:"rect",actions:n?[]:[["transpose"],["scale",1,-1]]}),e}function Kut(e){var t=e.options,r=e.chart,n=t.maxSize,i=xt(r,["geometries","0","dataArray"],[]),a=xt(r,["options","data","length"]),o=mo(i,function(l){return xt(l,["0","nextPoints","0","x"])*a-.5}),s=function(l,u,c,f){var d=n-(n-l[u0])/2;return U(U({},f),{start:[o[u-1]||u-.5,d],end:[o[u-1]||u-.5,d+.05]})};return r8(s)(e),e}function Qut(e){return Nn(Wwe,Xwe,jwe,Kut)(e)}function Ywe(e){var t,r=e.chart,n=e.options,i=n.data,a=i===void 0?[]:i,o=n.yField;return r.data(a),r.scale((t={},t[o]={sync:!0},t)),e}function Zwe(e){var t=e.chart,r=e.options,n=r.data,i=r.xField,a=r.yField,o=r.color,s=r.compareField,l=r.isTransposed,u=r.tooltip,c=r.maxSize,f=r.minSize,d=r.label,v=r.funnelStyle,g=r.state,x=r.showFacetTitle;return t.facet("mirror",{fields:[s],transpose:!l,padding:l?0:[32,0,0,0],showTitle:x,eachView:function(w,S){var A=l?S.rowIndex:S.columnIndex;l||w.coordinate({type:"rect",actions:[["transpose"],["scale",A===0?-1:1,-1]]});var M=e8(S.data,n,{yField:a,maxSize:c,minSize:f});w.data(M);var R=rd(u,[i,a,s]),O=R.fields,N=R.formatter,k=l?{offset:A===0?10:-23,position:A===0?"bottom":"top"}:{offset:10,position:"left",style:{textAlign:A===0?"end":"start"}};ah({chart:w,options:{type:"interval",xField:i,yField:u0,colorField:i,tooltipFields:ze(O)&&O.concat([l0,Xp]),mapping:{shape:"funnel",tooltip:N,color:o,style:v},label:d===!1?!1:ge({},k,d),state:g}})}}),e}function Jut(e){var t=e.chart,r=e.index,n=e.options,i=n.conversionTag,a=n.isTransposed;(Gn(r)?[t]:t.views).forEach(function(o,s){var l=xt(o,["geometries","0","dataArray"],[]),u=xt(o,["options","data","length"]),c=mo(l,function(d){return xt(d,["0","nextPoints","0","x"])*u-.5}),f=function(d,v,g,x){var w=(r||s)===0?-1:1;return ge({},x,{start:[c[v-1]||v-.5,d[u0]],end:[c[v-1]||v-.5,d[u0]+.05],text:a?{style:{textAlign:"start"}}:{offsetX:i!==!1?w*i.offsetX:0,style:{textAlign:(r||s)===0?"end":"start"}}})};r8(f)(ge({},{chart:o,options:n}))})}function qwe(e){var t=e.chart;return t.once("beforepaint",function(){return Jut(e)}),e}function Kwe(e){return Nn(Ywe,Zwe,qwe)(e)}function Qwe(e){var t=e.chart,r=e.options,n=r.data,i=n===void 0?[]:n,a=r.yField,o=Fu(i,function(u,c){return u+(c[a]||0)},0),s=mtt(i,a)[a],l=mo(i,function(u,c){var f=[],d=[];if(u[i5]=(u[a]||0)/o,c){var v=i[c-1][oS],g=i[c-1][sS];f[0]=v[3],d[0]=g[3],f[1]=v[2],d[1]=g[2]}else f[0]=-.5,d[0]=1,f[1]=.5,d[1]=1;return d[2]=d[1]-u[i5],f[2]=(d[2]+1)/4,d[3]=d[2],f[3]=-f[2],u[oS]=f,u[sS]=d,u[l0]=(u[a]||0)/s,u[Xp]=[xt(i,[c-1,a]),u[a]],u});return t.data(l),e}function Jwe(e){var t=e.chart,r=e.options,n=r.xField,i=r.yField,a=r.color,o=r.tooltip,s=r.label,l=r.funnelStyle,u=r.state,c=rd(o,[n,i]),f=c.fields,d=c.formatter;return ah({chart:t,options:{type:"polygon",xField:oS,yField:sS,colorField:n,tooltipFields:ze(f)&&f.concat([l0,Xp]),label:s,state:u,mapping:{tooltip:d,color:a,style:l}}}),e}function tCe(e){var t=e.chart,r=e.options,n=r.isTransposed;return t.coordinate({type:"rect",actions:n?[["transpose"],["reflect","x"]]:[]}),e}function eCe(e){var t=function(r,n,i,a){return U(U({},a),{start:[r[oS][1],r[sS][1]],end:[r[oS][1]+.05,r[sS][1]]})};return r8(t)(e),e}function rCe(e){return Nn(Qwe,Jwe,tCe,eCe)(e)}function nCe(e){var t,r=e.chart,n=e.options,i=n.data,a=i===void 0?[]:i,o=n.yField;return r.data(a),r.scale((t={},t[o]={sync:!0},t)),e}function iCe(e){var t=e.chart,r=e.options,n=r.seriesField,i=r.isTransposed,a=r.showFacetTitle;return t.facet("rect",{fields:[n],padding:[i?0:32,10,0,10],showTitle:a,eachView:function(o,s){Qut(ge({},e,{chart:o,options:{data:s.data}}))}}),e}function aCe(e){return Nn(nCe,iCe)(e)}var oCe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.rendering=!1,r}return t.prototype.change=function(r){var n=this;if(!this.rendering){var i=r.seriesField,a=r.compareField,o=a?Jut:Kut,s=this.context.view,l=i||a?s.views:[s];mo(l,function(u,c){var f=u.getController("annotation"),d=Wl(xt(f,["option"],[]),function(g){var x=g.name;return x!==qut});f.clear(!0),ft(d,function(g){typeof g=="object"&&u.annotation()[g.type](g)});var v=xt(u,["filteredData"],u.getOptions().data);o({chart:u,index:c,options:U(U({},r),{filteredData:e8(v,v,r)})}),u.filterData(v),n.rendering=!0,u.render(!0)})}this.rendering=!1},t}(to),tct="funnel-conversion-tag",a5="funnel-afterrender",ect={trigger:"afterrender",action:"".concat(tct,":change")};mn(tct,oCe);Yn(a5,{start:[ect]});function sCe(e){var t=e.options,r=t.compareField,n=t.xField,i=t.yField,a=t.locale,o=t.funnelStyle,s=t.data,l=K3(a),u={label:r?{fields:[n,i,r,l0,Xp],formatter:function(f){return"".concat(f[i])}}:{fields:[n,i,l0,Xp],offset:0,position:"middle",formatter:function(f){return"".concat(f[n]," ").concat(f[i])}},tooltip:{title:n,formatter:function(f){return{name:f[n],value:f[i]}}},conversionTag:{formatter:function(f){return"".concat(l.get(["conversionTag","label"]),": ").concat(Xut.apply(void 0,f[Xp]))}}},c;return(r||o)&&(c=function(f){return ge({},r&&{lineWidth:1,stroke:"#fff"},$r(o)?o(f):o)}),ge({options:u},e,{options:{funnelStyle:c,data:$l(s)}})}function lCe(e){var t=e.options,r=t.compareField,n=t.dynamicHeight,i=t.seriesField;return i?aCe(e):r?Kwe(e):n?rCe(e):Qut(e)}function uCe(e){var t,r=e.options,n=r.xAxis,i=r.yAxis,a=r.xField,o=r.yField;return Nn(ns((t={},t[a]=n,t[o]=i,t)))(e)}function cCe(e){var t=e.chart;return t.axis(!1),e}function hCe(e){var t=e.chart,r=e.options,n=r.legend;return n===!1?t.legend(!1):t.legend(n),e}function fCe(e){var t=e.chart,r=e.options,n=r.interactions,i=r.dynamicHeight;return ft(n,function(a){a.enable===!1?t.removeInteraction(a.type):t.interaction(a.type,a.cfg||{})}),i?t.removeInteraction(a5):t.interaction(a5,{start:[U(U({},ect),{arg:r})]}),e}function rct(e){return Nn(sCe,lCe,uCe,cCe,nl,fCe,hCe,Aa,Ji,To())(e)}var nct=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="funnel",r}return t.getDefaultOptions=function(){return Gwe},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return rct},t.prototype.setState=function(r,n,i){i===void 0&&(i=!0);var a=aS(this.chart);ft(a,function(o){n(o.getData())&&o.setState(r,i)})},t.prototype.getStates=function(){var r=aS(this.chart),n=[];return ft(r,function(i){var a=i.getData(),o=i.getStates();ft(o,function(s){n.push({data:a,state:s,geometry:i.geometry,element:i})})}),n},t.CONVERSATION_FIELD=Xp,t.PERCENT_FIELD=l0,t.TOTAL_PERCENT_FIELD=i5,t}(Jn);const q3e=Object.freeze(Object.defineProperty({__proto__:null,FUNNEL_CONVERSATION_FIELD:Xp,Funnel:nct},Symbol.toStringTag,{value:"Module"}));var vA,n8="range",ict="type",Jv="percent",dCe="#f0f0f0",act="indicator-view",oct="range-view",pCe={percent:0,range:{ticks:[]},innerRadius:.9,radius:.95,startAngle:-7/6*Math.PI,endAngle:1/6*Math.PI,syncViewPadding:!0,axis:{line:null,label:{offset:-24,style:{textAlign:"center",textBaseline:"middle"}},subTickLine:{length:-8},tickLine:{length:-12},grid:null},indicator:{pointer:{style:{lineWidth:5,lineCap:"round"}},pin:{style:{r:9.75,lineWidth:4.5,fill:"#fff"}}},statistic:{title:!1},meta:(vA={},vA[n8]={sync:"v"},vA[Jv]={sync:"v",tickCount:5,tickInterval:.2},vA),animation:!1};function vCe(e,t){return e.map(function(r,n){var i;return i={},i[n8]=r-(e[n-1]||0),i[ict]="".concat(n),i[Jv]=t,i})}function sct(e){var t;return[(t={},t[Jv]=lo(e,0,1),t)]}function lct(e,t){var r=xt(t,["ticks"],[]),n=_l(r)?Jy(r):[0,lo(e,0,1),1];return n[0]||n.shift(),vCe(n,e)}function gCe(e){var t=e.chart,r=e.options,n=r.percent,i=r.range,a=r.radius,o=r.innerRadius,s=r.startAngle,l=r.endAngle,u=r.axis,c=r.indicator,f=r.gaugeStyle,d=r.type,v=r.meter,g=i.color,x=i.width;if(c){var w=sct(n),S=t.createView({id:act});S.data(w),S.point().position("".concat(Jv,"*1")).shape(c.shape||"gauge-indicator").customInfo({defaultColor:t.getTheme().defaultColor,indicator:c}),S.coordinate("polar",{startAngle:s,endAngle:l,radius:o*a}),S.axis(Jv,u),S.scale(Jv,xa(u,Wc))}var A=lct(n,r.range),M=t.createView({id:oct});M.data(A);var R=nn(g)?[g,dCe]:g,O=du({chart:M,options:{xField:"1",yField:n8,seriesField:ict,rawFields:[Jv],isStack:!0,interval:{color:R,style:f,shape:d==="meter"?"meter-gauge":null},args:{zIndexReversed:!0,sortZIndex:!0},minColumnWidth:x,maxColumnWidth:x}}).ext,N=O.geometry;return N.customInfo({meter:v}),M.coordinate("polar",{innerRadius:o,radius:a,startAngle:s,endAngle:l}).transpose(),e}function mCe(e){var t;return Nn(ns((t={range:{min:0,max:1,maxLimit:1,minLimit:0}},t[Jv]={},t)))(e)}function uct(e,t){var r=e.chart,n=e.options,i=n.statistic,a=n.percent;if(r.getController("annotation").clear(!0),i){var o=i.content,s=void 0;o&&(s=ge({},{content:"".concat((a*100).toFixed(2),"%"),style:{opacity:.75,fontSize:"30px",lineHeight:1,textAlign:"center",color:"rgba(44,53,66,0.85)"}},o)),REe(r,{statistic:U(U({},i),{content:s})},{percent:a})}return t&&r.render(!0),e}function yCe(e){var t=e.chart,r=e.options,n=r.tooltip;return n?t.tooltip(ge({showTitle:!1,showMarkers:!1,containerTpl:'<div class="g2-tooltip"><div class="g2-tooltip-list"></div></div>',domStyles:{"g2-tooltip":{padding:"4px 8px",fontSize:"10px"}},customContent:function(i,a){var o=xt(a,[0,"data",Jv],0);return"".concat((o*100).toFixed(2),"%")}},n)):t.tooltip(!1),e}function _Ce(e){var t=e.chart;return t.legend(!1),e}function cct(e){return Nn(Ji,Aa,gCe,mCe,yCe,uct,_o,To(),_Ce)(e)}ca("point","gauge-indicator",{draw:function(e,t){var r=e.customInfo,n=r.indicator,i=r.defaultColor,a=n,o=a.pointer,s=a.pin,l=t.addGroup(),u=this.parsePoint({x:0,y:0});return o&&l.addShape("line",{name:"pointer",attrs:U({x1:u.x,y1:u.y,x2:e.x,y2:e.y,stroke:i},o.style)}),s&&l.addShape("circle",{name:"pin",attrs:U({x:u.x,y:u.y,stroke:i},s.style)}),l}});ca("interval","meter-gauge",{draw:function(e,t){var r=e.customInfo.meter,n=r===void 0?{}:r,i=n.steps,a=i===void 0?50:i,o=n.stepRatio,s=o===void 0?.5:o;a=a<1?1:a,s=lo(s,0,1);var l=this.coordinate,u=l.startAngle,c=l.endAngle,f=0;if(s>0&&s<1){var d=c-u;f=d/a/(s/(1-s)+1-1/a)}for(var v=f/(1-s)*s,g=t.addGroup(),x=this.coordinate.getCenter(),w=this.coordinate.getRadius(),S=eh.getAngle(e,this.coordinate),A=S.startAngle,M=S.endAngle,R=A;R<M;){var O=void 0,N=(R-u)%(v+f);N<v?O=R+(v-N):(R+=v+f-N,O=R+v);var k=eh.getSectorPath(x.x,x.y,w,R,Math.min(O,M),w*this.coordinate.innerRadius);g.addShape("path",{name:"meter-gauge",attrs:{path:k,fill:e.color,stroke:e.color,lineWidth:.5}}),R=O+f}return g}});var hct=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="gauge",r}return t.getDefaultOptions=function(){return pCe},t.prototype.changeData=function(r){this.chart.emit(di.BEFORE_CHANGE_DATA,So.fromData(this.chart,di.BEFORE_CHANGE_DATA,null)),this.updateOption({percent:r});var n=this.chart.views.find(function(a){return a.id===act});n&&n.data(sct(r));var i=this.chart.views.find(function(a){return a.id===oct});i&&i.data(lct(r,this.options.range)),uct({chart:this.chart,options:this.options},!0),this.chart.emit(di.AFTER_CHANGE_DATA,So.fromData(this.chart,di.AFTER_CHANGE_DATA,null))},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return cct},t}(Jn);const K3e=Object.freeze(Object.defineProperty({__proto__:null,Gauge:hct},Symbol.toStringTag,{value:"Module"}));function TY(e,t,r){if(r===1)return[0,t];var n=Math.floor(e/t);return[t*n,t*(n+1)]}function xCe(e){return Math.ceil(Math.log(e.length)/Math.LN2)+1}function fct(e,t,r,n,i){var a=$l(e);fUt(a,t);var o=$d(a,t),s=vtt(o),l=s.max-s.min,u=r;if(!r&&n&&(u=n>1?l/(n-1):s.max),!r&&!n){var c=xCe(o);u=l/c}var f={},d=Ph(a,i);Kc(d)?ft(a,function(g){var x=g[t],w=TY(x,u,n),S="".concat(w[0],"-").concat(w[1]);jm(f,S)||(f[S]={range:w,count:0}),f[S].count+=1}):Object.keys(d).forEach(function(g){ft(d[g],function(x){var w=x[t],S=TY(w,u,n),A="".concat(S[0],"-").concat(S[1]),M="".concat(A,"-").concat(g);jm(f,M)||(f[M]={range:S,count:0},f[M][i]=g),f[M].count+=1})});var v=[];return ft(f,function(g){v.push(g)}),v}var $R="range",lS="count",bCe=ge({},Jn.getDefaultOptions(),{columnStyle:{stroke:"#FFFFFF"},tooltip:{shared:!0,showMarkers:!1},interactions:[{type:"active-region"}]});function ECe(e){var t=e.chart,r=e.options,n=r.data,i=r.binField,a=r.binNumber,o=r.binWidth,s=r.color,l=r.stackField,u=r.legend,c=r.columnStyle,f=fct(n,i,o,a,l);t.data(f);var d=ge({},e,{options:{xField:$R,yField:lS,seriesField:l,isStack:!0,interval:{color:s,style:c}}});return du(d),u&&l?t.legend(l,u):t.legend(!1),e}function wCe(e){var t,r=e.options,n=r.xAxis,i=r.yAxis;return Nn(ns((t={},t[$R]=n,t[lS]=i,t)))(e)}function CCe(e){var t=e.chart,r=e.options,n=r.xAxis,i=r.yAxis;return n===!1?t.axis($R,!1):t.axis($R,n),i===!1?t.axis(lS,!1):t.axis(lS,i),e}function SCe(e){var t=e.chart,r=e.options,n=r.label,i=fu(t,"interval");if(!n)i.label(!1);else{var a=n.callback,o=hi(n,["callback"]);i.label({fields:[lS],callback:a,cfg:wl(o)})}return e}function dct(e){return Nn(Ji,Xh("columnStyle"),ECe,wCe,CCe,w0,SCe,nl,_o,Aa)(e)}var TCe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="histogram",r}return t.getDefaultOptions=function(){return bCe},t.prototype.changeData=function(r){this.updateOption({data:r});var n=this.options,i=n.binField,a=n.binNumber,o=n.binWidth,s=n.stackField;this.chart.changeData(fct(r,i,o,a,s))},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return dct},t}(Jn),ACe=ge({},Jn.getDefaultOptions(),{tooltip:{shared:!0,showMarkers:!0,showCrosshairs:!0,crosshairs:{type:"x"}},legend:{position:"top-left",radio:{}},isStack:!1}),MCe=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.active=function(){var r=this.getView(),n=this.context.event;if(n.data){var i=n.data.items,a=r.geometries.filter(function(o){return o.type==="point"});ft(a,function(o){ft(o.elements,function(s){var l=ptt(i,function(u){return u.data===s.data})!==-1;s.setState("active",l)})})}},t.prototype.reset=function(){var r=this.getView(),n=r.geometries.filter(function(i){return i.type==="point"});ft(n,function(i){ft(i.elements,function(a){a.setState("active",!1)})})},t.prototype.getView=function(){return this.context.view},t}(to);mn("marker-active",MCe);Yn("marker-active",{start:[{trigger:"tooltip:show",action:"marker-active:active"}],end:[{trigger:"tooltip:hide",action:"marker-active:reset"}]});var pct=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="line",r}return t.getDefaultOptions=function(){return ACe},t.prototype.changeData=function(r){this.updateOption({data:r});var n=this,i=n.chart,a=n.options;nL({chart:i,options:a}),this.chart.changeData(r)},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return Hut},t}(Jn);const Q3e=Object.freeze(Object.defineProperty({__proto__:null,Line:pct},Symbol.toStringTag,{value:"Module"}));var vct=ge({},Jn.getDefaultOptions(),{legend:{position:"right",radio:{}},tooltip:{shared:!1,showTitle:!1,showMarkers:!1},label:{layout:{type:"limit-in-plot",cfg:{action:"ellipsis"}}},pieStyle:{stroke:"white",lineWidth:1},statistic:{title:{style:{fontWeight:300,color:"#4B535E",textAlign:"center",fontSize:"20px",lineHeight:1}},content:{style:{fontWeight:"bold",color:"rgba(44,53,66,0.85)",textAlign:"center",fontSize:"32px",lineHeight:1}}},theme:{components:{annotation:{text:{animate:!1}}}}}),RCe=[1,0,0,0,1,0,0,0,1];function o5(e,t){var r=t?an([],t,!0):an([],RCe,!0);return eh.transform(r,e)}var ICe=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getActiveElements=function(){var r=eh.getDelegationObject(this.context);if(r){var n=this.context.view,i=r.component,a=r.item,o=i.get("field");if(o){var s=n.geometries[0].elements;return s.filter(function(l){return l.getModel().data[o]===a.value})}}return[]},t.prototype.getActiveElementLabels=function(){var r=this.context.view,n=this.getActiveElements(),i=r.geometries[0].labelsContainer.getChildren();return i.filter(function(a){return n.find(function(o){return zi(o.getData(),a.get("data"))})})},t.prototype.transfrom=function(r){r===void 0&&(r=7.5);var n=this.getActiveElements(),i=this.getActiveElementLabels();n.forEach(function(a,o){var s=i[o],l=a.geometry.coordinate;if(l.isPolar&&l.isTransposed){var u=eh.getAngle(a.getModel(),l),c=u.startAngle,f=u.endAngle,d=(c+f)/2,v=r,g=v*Math.cos(d),x=v*Math.sin(d);a.shape.setMatrix(o5([["t",g,x]])),s.setMatrix(o5([["t",g,x]]))}})},t.prototype.active=function(){this.transfrom()},t.prototype.reset=function(){this.transfrom(0)},t}(to);function LCe(e){var t=e.event,r,n=t.target;return n&&(r=n.get("element")),r}var OCe=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getAnnotations=function(r){var n=r||this.context.view;return n.getController("annotation").option},t.prototype.getInitialAnnotation=function(){return this.initialAnnotation},t.prototype.init=function(){var r=this,n=this.context.view;n.removeInteraction("tooltip"),n.on("afterchangesize",function(){var i=r.getAnnotations(n);r.initialAnnotation=i})},t.prototype.change=function(r){var n=this.context,i=n.view,a=n.event;this.initialAnnotation||(this.initialAnnotation=this.getAnnotations());var o=xt(a,["data","data"]);if(a.type.match("legend-item")){var s=eh.getDelegationObject(this.context),l=i.getGroupedFields()[0];if(s&&l){var u=s.item;o=i.getData().find(function(v){return v[l]===u.value})}}if(o){var c=xt(r,"annotations",[]),f=xt(r,"statistic",{});i.getController("annotation").clear(!0),ft(c,function(v){typeof v=="object"&&i.annotation()[v.type](v)}),Z3(i,{statistic:f,plotType:"pie"},o),i.render(!0)}var d=LCe(this.context);d&&d.shape.toFront()},t.prototype.reset=function(){var r=this.context.view,n=r.getController("annotation");n.clear(!0);var i=this.getInitialAnnotation();ft(i,function(a){r.annotation()[a.type](a)}),r.render(!0)},t}(to),gct="pie-statistic";mn(gct,OCe);Yn("pie-statistic-active",{start:[{trigger:"element:mouseenter",action:"pie-statistic:change"}],end:[{trigger:"element:mouseleave",action:"pie-statistic:reset"}]});mn("pie-legend",ICe);Yn("pie-legend-active",{start:[{trigger:"legend-item:mouseenter",action:"pie-legend:active"}],end:[{trigger:"legend-item:mouseleave",action:"pie-legend:reset"}]});function PCe(e,t){var r=null;return ft(e,function(n){typeof n[t]=="number"&&(r+=n[t])}),r}function DCe(e,t){var r;switch(e){case"inner":return r="-30%",nn(t)&&t.endsWith("%")?parseFloat(t)*.01>0?r:t:t<0?t:r;case"outer":return r=12,nn(t)&&t.endsWith("%")?parseFloat(t)*.01<0?r:t:t>0?t:r;default:return t}}function HR(e,t){return D4(lb(e,t),function(r){return r[t]===0})}function FCe(e){var t=e.chart,r=e.options,n=r.data,i=r.angleField,a=r.colorField,o=r.color,s=r.pieStyle,l=r.shape,u=lb(n,i);if(HR(u,i)){var c="$$percentage$$";u=u.map(function(d){var v;return U(U({},d),(v={},v[c]=1/u.length,v))}),t.data(u);var f=ge({},e,{options:{xField:"1",yField:c,seriesField:a,isStack:!0,interval:{color:o,shape:l,style:s},args:{zIndexReversed:!0,sortZIndex:!0}}});du(f)}else{t.data(u);var f=ge({},e,{options:{xField:"1",yField:i,seriesField:a,isStack:!0,interval:{color:o,shape:l,style:s},args:{zIndexReversed:!0,sortZIndex:!0}}});du(f)}return e}function BCe(e){var t,r=e.chart,n=e.options,i=n.meta,a=n.colorField,o=ge({},i);return r.scale(o,(t={},t[a]={type:"cat"},t)),e}function NCe(e){var t=e.chart,r=e.options,n=r.radius,i=r.innerRadius,a=r.startAngle,o=r.endAngle;return t.coordinate({type:"theta",cfg:{radius:n,innerRadius:i,startAngle:a,endAngle:o}}),e}function kCe(e){var t=e.chart,r=e.options,n=r.label,i=r.colorField,a=r.angleField,o=t.geometries[0];if(!n)o.label(!1);else{var s=n.callback,l=hi(n,["callback"]),u=wl(l);if(u.content){var c=u.content;u.content=function(g,x,w){var S=g[i],A=g[a],M=t.getScaleByField(a),R=M==null?void 0:M.scale(A);return $r(c)?c(U(U({},g),{percent:R}),x,w):nn(c)?Rut(c,{value:A,name:S,percentage:Gn(R)&&!ke(A)?"".concat((R*100).toFixed(2),"%"):null}):c}}var f={inner:"",outer:"pie-outer",spider:"pie-spider"},d=u.type?f[u.type]:"pie-outer",v=u.layout?ze(u.layout)?u.layout:[u.layout]:[];u.layout=(d?[{type:d}]:[]).concat(v),o.label({fields:i?[a,i]:[a],callback:s,cfg:U(U({},u),{offset:DCe(u.type,u.offset),type:"pie"})})}return e}function mct(e){var t=e.innerRadius,r=e.statistic,n=e.angleField,i=e.colorField,a=e.meta,o=e.locale,s=K3(o);if(t&&r){var l=ge({},vct.statistic,r),u=l.title,c=l.content;return u!==!1&&(u=ge({},{formatter:function(f){var d=f?f[i]:ke(u.content)?s.get(["statistic","total"]):u.content,v=xt(a,[i,"formatter"])||function(g){return g};return v(d)}},u)),c!==!1&&(c=ge({},{formatter:function(f,d){var v=f?f[n]:PCe(d,n),g=xt(a,[n,"formatter"])||function(x){return x};return f||ke(c.content)?g(v):c.content}},c)),ge({},{statistic:{title:u,content:c}},e)}return e}function yct(e){var t=e.chart,r=e.options,n=mct(r),i=n.innerRadius,a=n.statistic;return t.getController("annotation").clear(!0),Nn(To())(e),i&&a&&Z3(t,{statistic:a,plotType:"pie"}),e}function zCe(e){var t=e.chart,r=e.options,n=r.tooltip,i=r.colorField,a=r.angleField,o=r.data;if(n===!1)t.tooltip(n);else if(t.tooltip(ge({},n,{shared:!1})),HR(o,a)){var s=xt(n,"fields"),l=xt(n,"formatter");Kc(xt(n,"fields"))&&(s=[i,a],l=l||function(u){return{name:u[i],value:RS(u[a])}}),t.geometries[0].tooltip(s.join("*"),V1(s,l))}return e}function UCe(e){var t=e.chart,r=e.options,n=mct(r),i=n.interactions,a=n.statistic,o=n.annotations;return ft(i,function(s){var l,u;if(s.enable===!1)t.removeInteraction(s.type);else if(s.type==="pie-statistic-active"){var c=[];!((l=s.cfg)===null||l===void 0)&&l.start||(c=[{trigger:"element:mouseenter",action:"".concat(gct,":change"),arg:{statistic:a,annotations:o}}]),ft((u=s.cfg)===null||u===void 0?void 0:u.start,function(f){c.push(U(U({},f),{arg:{statistic:a,annotations:o}}))}),t.interaction(s.type,ge({},s.cfg,{start:c}))}else t.interaction(s.type,s.cfg||{})}),e}function _ct(e){return Nn(Xh("pieStyle"),FCe,BCe,Ji,NCe,$b,zCe,kCe,w0,yct,UCe,Aa)(e)}var xct=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="pie",r}return t.getDefaultOptions=function(){return vct},t.prototype.changeData=function(r){this.chart.emit(di.BEFORE_CHANGE_DATA,So.fromData(this.chart,di.BEFORE_CHANGE_DATA,null));var n=this.options,i=this.options.angleField,a=lb(n.data,i),o=lb(r,i);HR(a,i)||HR(o,i)?this.update({data:r}):(this.updateOption({data:r}),this.chart.data(o),yct({chart:this.chart,options:this.options}),this.chart.render(!0)),this.chart.emit(di.AFTER_CHANGE_DATA,So.fromData(this.chart,di.AFTER_CHANGE_DATA,null))},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return _ct},t}(Jn);const J3e=Object.freeze(Object.defineProperty({__proto__:null,Pie:xct},Symbol.toStringTag,{value:"Module"}));var bct=["#FAAD14","#E8EDF3"],$Ce={percent:.2,color:bct,animation:{}};function i8(e){var t=lo(v_(e)?e:0,0,1);return[{current:"".concat(t),type:"current",percent:t},{current:"".concat(t),type:"target",percent:1}]}function Ect(e){var t=e.chart,r=e.options,n=r.percent,i=r.progressStyle,a=r.color,o=r.barWidthRatio;t.data(i8(n));var s=ge({},e,{options:{xField:"current",yField:"percent",seriesField:"type",widthRatio:o,interval:{style:i,color:nn(a)?[a,bct[1]]:a},args:{zIndexReversed:!0,sortZIndex:!0}}});return du(s),t.tooltip(!1),t.axis(!1),t.legend(!1),e}function HCe(e){var t=e.chart;return t.coordinate("rect").transpose(),e}function wct(e){return Nn(Ect,ns({}),HCe,Aa,Ji,To())(e)}var VCe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="process",r}return t.getDefaultOptions=function(){return $Ce},t.prototype.changeData=function(r){this.updateOption({percent:r}),this.chart.changeData(i8(r))},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return wct},t}(Jn);function GCe(e){var t=e.chart,r=e.options,n=r.innerRadius,i=r.radius;return t.coordinate("theta",{innerRadius:n,radius:i}),e}function Cct(e,t){var r=e.chart,n=e.options,i=n.innerRadius,a=n.statistic,o=n.percent,s=n.meta;if(r.getController("annotation").clear(!0),i&&a){var l=xt(s,["percent","formatter"])||function(c){return"".concat((c*100).toFixed(2),"%")},u=a.content;u&&(u=ge({},u,{content:ke(u.content)?l(o):u.content})),Z3(r,{statistic:U(U({},a),{content:u}),plotType:"ring-progress"},{percent:o})}return t&&r.render(!0),e}function Sct(e){return Nn(Ect,ns({}),GCe,Cct,Aa,Ji,To())(e)}var WCe={percent:.2,innerRadius:.8,radius:.98,color:["#FAAD14","#E8EDF3"],statistic:{title:!1,content:{style:{fontSize:"14px",fontWeight:300,fill:"#4D4D4D",textAlign:"center",textBaseline:"middle"}}},animation:{}},XCe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="ring-process",r}return t.getDefaultOptions=function(){return WCe},t.prototype.changeData=function(r){this.chart.emit(di.BEFORE_CHANGE_DATA,So.fromData(this.chart,di.BEFORE_CHANGE_DATA,null)),this.updateOption({percent:r}),this.chart.data(i8(r)),Cct({chart:this.chart,options:this.options},!0),this.chart.emit(di.AFTER_CHANGE_DATA,So.fromData(this.chart,di.AFTER_CHANGE_DATA,null))},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return Sct},t}(Jn);function c0(e,t){return jCe(e)||YCe(e,t)||ZCe()}function jCe(e){if(Array.isArray(e))return e}function YCe(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o=e[Symbol.iterator](),s;!(n=(s=o.next()).done)&&(r.push(s.value),!(t&&r.length===t));n=!0);}catch(l){i=!0,a=l}finally{try{!n&&o.return!=null&&o.return()}finally{if(i)throw a}}return r}function ZCe(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function a8(e,t,r,n){e=e.filter(function(g,x){var w=t(g,x),S=r(g,x);return w!=null&&isFinite(w)&&S!=null&&isFinite(S)}),n&&e.sort(function(g,x){return t(g)-t(x)});for(var i=e.length,a=new Float64Array(i),o=new Float64Array(i),s=0,l=0,u,c,f,d=0;d<i;)f=e[d],a[d]=u=+t(f,d,e),o[d]=c=+r(f,d,e),++d,s+=(u-s)/d,l+=(c-l)/d;for(var v=0;v<i;++v)a[v]-=s,o[v]-=l;return[a,o,s,l]}function B_(e,t,r,n){for(var i=0,a=0,o=e.length;a<o;a++){var s=e[a],l=+t(s,a,e),u=+r(s,a,e);l!=null&&isFinite(l)&&u!=null&&isFinite(u)&&n(l,u,i++)}}function Vb(e,t,r,n,i){var a=0,o=0;return B_(e,t,r,function(s,l){var u=l-i(s),c=l-n;a+=u*u,o+=c*c}),1-a/o}function AY(e){return Math.atan2(e[1][1]-e[0][1],e[1][0]-e[0][0])*180/Math.PI}function qCe(e){return[(e[0][0]+e[1][0])/2,(e[0][1]+e[1][1])/2]}function a2(e,t,r){for(var n=Math.log(t-e)*Math.LOG10E+1|0,i=1*Math.pow(10,-n/2-1),a=1e4,o=[l(e),l(t)],s=0;u(o)&&s<a;);return o;function l(c){return[c,r(c)]}function u(c){s++;for(var f=c.length,d=!1,v=0;v<f-1;v++){var g=c[v],x=c[v+1],w=qCe([g,x]),S=l(w[0]),A=AY([g,w]),M=AY([g,S]),R=Math.abs(A-M);R>i&&(c.splice(v+1,0,S),d=!0)}return d}}function o2(e,t,r,n){var i=n-e*e,a=Math.abs(i)<1e-24?0:(r-e*t)/i,o=t-a*e;return[o,a]}function KCe(){var e=function(a){return a[0]},t=function(a){return a[1]},r;function n(i){var a=0,o=0,s=0,l=0,u=0,c=0,f=r?+r[0]:1/0,d=r?+r[1]:-1/0;B_(i,e,t,function(M,R){var O=Math.log(R),N=M*R;++a,o+=(R-o)/a,l+=(N-l)/a,c+=(M*N-c)/a,s+=(R*O-s)/a,u+=(N*O-u)/a,r||(M<f&&(f=M),M>d&&(d=M))});var v=o2(l/o,s/o,u/o,c/o),g=c0(v,2),x=g[0],w=g[1];x=Math.exp(x);var S=function(R){return x*Math.exp(w*R)},A=a2(f,d,S);return A.a=x,A.b=w,A.predict=S,A.rSquared=Vb(i,e,t,o,S),A}return n.domain=function(i){return arguments.length?(r=i,n):r},n.x=function(i){return arguments.length?(e=i,n):e},n.y=function(i){return arguments.length?(t=i,n):t},n}function Tct(){var e=function(a){return a[0]},t=function(a){return a[1]},r;function n(i){var a=0,o=0,s=0,l=0,u=0,c=r?+r[0]:1/0,f=r?+r[1]:-1/0;B_(i,e,t,function(A,M){++a,o+=(A-o)/a,s+=(M-s)/a,l+=(A*M-l)/a,u+=(A*A-u)/a,r||(A<c&&(c=A),A>f&&(f=A))});var d=o2(o,s,l,u),v=c0(d,2),g=v[0],x=v[1],w=function(M){return x*M+g},S=[[c,w(c)],[f,w(f)]];return S.a=x,S.b=g,S.predict=w,S.rSquared=Vb(i,e,t,s,w),S}return n.domain=function(i){return arguments.length?(r=i,n):r},n.x=function(i){return arguments.length?(e=i,n):e},n.y=function(i){return arguments.length?(t=i,n):t},n}function QCe(e){e.sort(function(r,n){return r-n});var t=e.length/2;return t%1===0?(e[t-1]+e[t])/2:e[Math.floor(t)]}var MY=2,RY=1e-12;function JCe(){var e=function(a){return a[0]},t=function(a){return a[1]},r=.3;function n(i){for(var a=a8(i,e,t,!0),o=c0(a,4),s=o[0],l=o[1],u=o[2],c=o[3],f=s.length,d=Math.max(2,~~(r*f)),v=new Float64Array(f),g=new Float64Array(f),x=new Float64Array(f).fill(1),w=-1;++w<=MY;){for(var S=[0,d-1],A=0;A<f;++A){for(var M=s[A],R=S[0],O=S[1],N=M-s[R]>s[O]-M?R:O,k=0,V=0,Q=0,Y=0,X=0,tt=1/Math.abs(s[N]-M||1),it=R;it<=O;++it){var Et=s[it],Tt=l[it],pt=tSe(Math.abs(M-Et)*tt)*x[it],kt=Et*pt;k+=pt,V+=kt,Q+=Tt*pt,Y+=Tt*kt,X+=Et*kt}var ae=o2(V/k,Q/k,Y/k,X/k),Kt=c0(ae,2),re=Kt[0],fe=Kt[1];v[A]=re+fe*M,g[A]=Math.abs(l[A]-v[A]),eSe(s,A+1,S)}if(w===MY)break;var Oe=QCe(g);if(Math.abs(Oe)<RY)break;for(var Ye=0,Be,De;Ye<f;++Ye)Be=g[Ye]/(6*Oe),x[Ye]=Be>=1?RY:(De=1-Be*Be)*De}return rSe(s,v,u,c)}return n.bandwidth=function(i){return arguments.length?(r=i,n):r},n.x=function(i){return arguments.length?(e=i,n):e},n.y=function(i){return arguments.length?(t=i,n):t},n}function tSe(e){return(e=1-e*e*e)*e*e}function eSe(e,t,r){var n=e[t],i=r[0],a=r[1]+1;if(!(a>=e.length))for(;t>i&&e[a]-n<=n-e[i];)r[0]=++i,r[1]=a,++a}function rSe(e,t,r,n){for(var i=e.length,a=[],o=0,s=0,l=[],u;o<i;++o)u=e[o]+r,l[0]===u?l[1]+=(t[o]-l[1])/++s:(s=0,l[1]+=n,l=[u,t[o]],a.push(l));return l[1]+=n,a}function nSe(){var e=function(o){return o[0]},t=function(o){return o[1]},r=Math.E,n;function i(a){var o=0,s=0,l=0,u=0,c=0,f=n?+n[0]:1/0,d=n?+n[1]:-1/0,v=Math.log(r);B_(a,e,t,function(R,O){var N=Math.log(R)/v;++o,s+=(N-s)/o,l+=(O-l)/o,u+=(N*O-u)/o,c+=(N*N-c)/o,n||(R<f&&(f=R),R>d&&(d=R))});var g=o2(s,l,u,c),x=c0(g,2),w=x[0],S=x[1],A=function(O){return S*Math.log(O)/v+w},M=a2(f,d,A);return M.a=S,M.b=w,M.predict=A,M.rSquared=Vb(a,e,t,l,A),M}return i.domain=function(a){return arguments.length?(n=a,i):n},i.x=function(a){return arguments.length?(e=a,i):e},i.y=function(a){return arguments.length?(t=a,i):t},i.base=function(a){return arguments.length?(r=a,i):r},i}function Act(){var e=function(a){return a[0]},t=function(a){return a[1]},r;function n(i){var a=a8(i,e,t),o=c0(a,4),s=o[0],l=o[1],u=o[2],c=o[3],f=s.length,d=0,v=0,g=0,x=0,w=0,S,A,M,R;for(S=0;S<f;)A=s[S],M=l[S++],R=A*A,d+=(R-d)/S,v+=(R*A-v)/S,g+=(R*R-g)/S,x+=(A*M-x)/S,w+=(R*M-w)/S;var O=0,N=0,k=r?+r[0]:1/0,V=r?+r[1]:-1/0;B_(i,e,t,function(pt,kt){N++,O+=(kt-O)/N,r||(pt<k&&(k=pt),pt>V&&(V=pt))});var Q=g-d*d,Y=d*Q-v*v,X=(w*d-x*v)/Y,tt=(x*Q-w*v)/Y,it=-X*d,Et=function(kt){return kt=kt-u,X*kt*kt+tt*kt+it+c},Tt=a2(k,V,Et);return Tt.a=X,Tt.b=tt-2*X*u,Tt.c=it-tt*u+X*u*u+c,Tt.predict=Et,Tt.rSquared=Vb(i,e,t,O,Et),Tt}return n.domain=function(i){return arguments.length?(r=i,n):r},n.x=function(i){return arguments.length?(e=i,n):e},n.y=function(i){return arguments.length?(t=i,n):t},n}function iSe(){var e=function(o){return o[0]},t=function(o){return o[1]},r=3,n;function i(a){if(r===1){var o=Tct().x(e).y(t).domain(n)(a);return o.coefficients=[o.b,o.a],delete o.a,delete o.b,o}if(r===2){var s=Act().x(e).y(t).domain(n)(a);return s.coefficients=[s.c,s.b,s.a],delete s.a,delete s.b,delete s.c,s}var l=a8(a,e,t),u=c0(l,4),c=u[0],f=u[1],d=u[2],v=u[3],g=c.length,x=[],w=[],S=r+1,A=0,M=0,R=n?+n[0]:1/0,O=n?+n[1]:-1/0;B_(a,e,t,function(Et,Tt){++M,A+=(Tt-A)/M,n||(Et<R&&(R=Et),Et>O&&(O=Et))});var N,k,V,Q,Y;for(N=0;N<S;++N){for(V=0,Q=0;V<g;++V)Q+=Math.pow(c[V],N)*f[V];for(x.push(Q),Y=new Float64Array(S),k=0;k<S;++k){for(V=0,Q=0;V<g;++V)Q+=Math.pow(c[V],N+k);Y[k]=Q}w.push(Y)}w.push(x);var X=oSe(w),tt=function(Tt){Tt-=d;var pt=v+X[0]+X[1]*Tt+X[2]*Tt*Tt;for(N=3;N<S;++N)pt+=X[N]*Math.pow(Tt,N);return pt},it=a2(R,O,tt);return it.coefficients=aSe(S,X,-d,v),it.predict=tt,it.rSquared=Vb(a,e,t,A,tt),it}return i.domain=function(a){return arguments.length?(n=a,i):n},i.x=function(a){return arguments.length?(e=a,i):e},i.y=function(a){return arguments.length?(t=a,i):t},i.order=function(a){return arguments.length?(r=a,i):r},i}function aSe(e,t,r,n){var i=Array(e),a,o,s,l;for(a=0;a<e;++a)i[a]=0;for(a=e-1;a>=0;--a)for(s=t[a],l=1,i[a]+=s,o=1;o<=a;++o)l*=(a+1-o)/o,i[a-o]+=s*Math.pow(r,o)*l;return i[0]+=n,i}function oSe(e){var t=e.length-1,r=[],n,i,a,o,s;for(n=0;n<t;++n){for(o=n,i=n+1;i<t;++i)Math.abs(e[n][i])>Math.abs(e[n][o])&&(o=i);for(a=n;a<t+1;++a)s=e[a][n],e[a][n]=e[a][o],e[a][o]=s;for(i=n+1;i<t;++i)for(a=t;a>=n;a--)e[a][i]-=e[a][n]*e[n][i]/e[n][n]}for(i=t-1;i>=0;--i){for(s=0,a=i+1;a<t;++a)s+=e[a][i]*r[a];r[i]=(e[t][i]-s)/e[i][i]}return r}function sSe(){var e=function(a){return a[0]},t=function(a){return a[1]},r;function n(i){var a=0,o=0,s=0,l=0,u=0,c=0,f=r?+r[0]:1/0,d=r?+r[1]:-1/0;B_(i,e,t,function(M,R){var O=Math.log(M),N=Math.log(R);++a,o+=(O-o)/a,s+=(N-s)/a,l+=(O*N-l)/a,u+=(O*O-u)/a,c+=(R-c)/a,r||(M<f&&(f=M),M>d&&(d=M))});var v=o2(o,s,l,u),g=c0(v,2),x=g[0],w=g[1];x=Math.exp(x);var S=function(R){return x*Math.pow(R,w)},A=a2(f,d,S);return A.a=x,A.b=w,A.predict=S,A.rSquared=Vb(i,e,t,c,S),A}return n.domain=function(i){return arguments.length?(r=i,n):r},n.x=function(i){return arguments.length?(e=i,n):e},n.y=function(i){return arguments.length?(t=i,n):t},n}var lSe={exp:KCe,linear:Tct,loess:JCe,log:nSe,poly:iSe,pow:sSe,quad:Act};function uSe(e,t){var r=10,n={regionStyle:[{position:{start:[e,"max"],end:["max",t]},style:{fill:"#d8d0c0",opacity:.4}},{position:{start:["min","max"],end:[e,t]},style:{fill:"#a3dda1",opacity:.4}},{position:{start:["min",t],end:[e,"min"]},style:{fill:"#d8d0c0",opacity:.4}},{position:{start:[e,t],end:["max","min"]},style:{fill:"#a3dda1",opacity:.4}}],lineStyle:{stroke:"#9ba29a",lineWidth:1},labelStyle:[{position:["max",t],offsetX:-r,offsetY:-r,style:{textAlign:"right",textBaseline:"bottom",fontSize:14,fill:"#ccc"}},{position:["min",t],offsetX:r,offsetY:-r,style:{textAlign:"left",textBaseline:"bottom",fontSize:14,fill:"#ccc"}},{position:["min",t],offsetX:r,offsetY:r,style:{textAlign:"left",textBaseline:"top",fontSize:14,fill:"#ccc"}},{position:["max",t],offsetX:-r,offsetY:r,style:{textAlign:"right",textBaseline:"top",fontSize:14,fill:"#ccc"}}]};return n}var cSe=function(e,t){var r=t.view,n=t.options,i=n.xField,a=n.yField,o=r.getScaleByField(i),s=r.getScaleByField(a),l=e.map(function(u){return r.getCoordinate().convert({x:o.scale(u[0]),y:s.scale(u[1])})});return MEe(l,!1)},hSe=function(e){var t=e.options,r=t.xField,n=t.yField,i=t.data,a=t.regressionLine,o=a.type,s=o===void 0?"linear":o,l=a.algorithm,u=a.equation,c,f=null;if(l)c=ze(l)?l:l(i),f=u;else{var d=lSe[s]().x(function(v){return v[r]}).y(function(v){return v[n]});c=d(i),f=dSe(s,c)}return[cSe(c,e),f]},fSe=function(e){var t,r=e.meta,n=r===void 0?{}:r,i=e.xField,a=e.yField,o=e.data,s=o[0][i],l=o[0][a],u=s>0,c=l>0;function f(d,v){var g=xt(n,[d]);function x(S){return xt(g,S)}var w={};return v==="x"?(Gn(s)&&(Gn(x("min"))||(w.min=u?0:s*2),Gn(x("max"))||(w.max=u?s*2:0)),w):(Gn(l)&&(Gn(x("min"))||(w.min=c?0:l*2),Gn(x("max"))||(w.max=c?l*2:0)),w)}return U(U({},n),(t={},t[i]=U(U({},n[i]),f(i,"x")),t[a]=U(U({},n[a]),f(a,"y")),t))};function dSe(e,t){var r,n,i,a=function(u,c){return c===void 0&&(c=4),Math.round(u*Math.pow(10,c))/Math.pow(10,c)},o=function(u){return Number.isFinite(u)?a(u):"?"};switch(e){case"linear":return"y = ".concat(o(t.a),"x + ").concat(o(t.b),", R^2 = ").concat(o(t.rSquared));case"exp":return"y = ".concat(o(t.a),"e^(").concat(o(t.b),"x), R^2 = ").concat(o(t.rSquared));case"log":return"y = ".concat(o(t.a),"ln(x) + ").concat(o(t.b),", R^2 = ").concat(o(t.rSquared));case"quad":return"y = ".concat(o(t.a),"x^2 + ").concat(o(t.b),"x + ").concat(o(t.c),", R^2 = ").concat(o(t.rSquared));case"poly":for(var s="y = ".concat(o((r=t.coefficients)===null||r===void 0?void 0:r[0])," + ").concat(o((n=t.coefficients)===null||n===void 0?void 0:n[1]),"x + ").concat(o((i=t.coefficients)===null||i===void 0?void 0:i[2]),"x^2"),l=3;l<t.coefficients.length;++l)s+=" + ".concat(o(t.coefficients[l]),"x^").concat(l);return"".concat(s,", R^2 = ").concat(o(t.rSquared));case"pow":return"y = ".concat(o(t.a),"x^").concat(o(t.b),", R^2 = ").concat(o(t.rSquared))}return null}function Mct(e){var t=e.data,r=t===void 0?[]:t,n=e.xField,i=e.yField;if(r.length){for(var a=!0,o=!0,s=r[0],l=void 0,u=1;u<r.length&&(l=r[u],s[n]!==l[n]&&(a=!1),s[i]!==l[i]&&(o=!1),!(!a&&!o));u++)s=l;var c=[];a&&c.push(n),o&&c.push(i);var f=xa(fSe(e),c);return ge({},e,{meta:f})}return e}function pSe(e){var t=e.chart,r=e.options,n=r.data,i=r.type,a=r.color,o=r.shape,s=r.pointStyle,l=r.shapeField,u=r.colorField,c=r.xField,f=r.yField,d=r.sizeField,v=r.size,g=r.tooltip;d&&(v||(v=[2,8]),Gn(v)&&(v=[v,v])),g&&!g.fields&&(g=U(U({},g),{fields:[c,f,u,d,l]})),t.data(n),jh(ge({},e,{options:{seriesField:u,point:{color:a,shape:o,size:v,style:s},tooltip:g}}));var x=fu(t,"point");return i&&x.adjust(i),e}function KA(e){var t,r=e.options,n=r.xAxis,i=r.yAxis,a=r.xField,o=r.yField,s=Mct(r);return Nn(ns((t={},t[a]=n,t[o]=i,t)))(ge({},e,{options:s}))}function vSe(e){var t=e.chart,r=e.options,n=r.xAxis,i=r.yAxis,a=r.xField,o=r.yField;return t.axis(a,n),t.axis(o,i),e}function gSe(e){var t=e.chart,r=e.options,n=r.legend,i=r.colorField,a=r.shapeField,o=r.sizeField,s=r.shapeLegend,l=r.sizeLegend,u=n!==!1;return i&&t.legend(i,u?n:!1),a&&(s?t.legend(a,s):t.legend(a,s===!1?!1:n)),o&&t.legend(o,l||!1),!u&&!s&&!l&&t.legend(!1),e}function mSe(e){var t=e.chart,r=e.options,n=r.label,i=r.yField,a=fu(t,"point");if(!n)a.label(!1);else{var o=n.callback,s=hi(n,["callback"]);a.label({fields:[i],callback:o,cfg:wl(s)})}return e}function ySe(e){var t=e.options,r=t.quadrant,n=[];if(r){var i=r.xBaseline,a=i===void 0?0:i,o=r.yBaseline,s=o===void 0?0:o,l=r.labels,u=r.regionStyle,c=r.lineStyle,f=uSe(a,s),d=new Array(4).join(",").split(",");d.forEach(function(v,g){n.push(U(U({type:"region",top:!1},f.regionStyle[g].position),{style:ge({},f.regionStyle[g].style,u==null?void 0:u[g])}),U({type:"text",top:!0},ge({},f.labelStyle[g],l==null?void 0:l[g])))}),n.push({type:"line",top:!1,start:["min",s],end:["max",s],style:ge({},f.lineStyle,c)},{type:"line",top:!1,start:[a,"min"],end:[a,"max"],style:ge({},f.lineStyle,c)})}return Nn(To(n))(e)}function _Se(e){var t=e.options,r=e.chart,n=t.regressionLine;if(n){var i=n.style,a=n.equationStyle,o=a===void 0?{}:a,s=n.top,l=s===void 0?!1:s,u=n.showEquation,c=u===void 0?!1:u,f={stroke:"#9ba29a",lineWidth:2,opacity:.5},d={x:20,y:20,textAlign:"left",textBaseline:"middle",fontSize:14,fillOpacity:.5};r.annotation().shape({top:l,render:function(v,g){var x=v.addGroup({id:"".concat(r.id,"-regression-line"),name:"regression-line-group"}),w=hSe({view:g,options:t}),S=w[0],A=w[1];x.addShape("path",{name:"regression-line",attrs:U(U({path:S},f),i)}),c&&x.addShape("text",{name:"regression-equation",attrs:U(U(U({},d),o),{text:A})})}})}return e}function xSe(e){var t=e.chart,r=e.options,n=r.tooltip;return n?t.tooltip(n):n===!1&&t.tooltip(!1),e}function Rct(e){return Nn(pSe,KA,vSe,gSe,xSe,mSe,Wut,n2,q6,_o,ySe,Aa,Ji,_Se)(e)}var bSe=ge({},Jn.getDefaultOptions(),{size:4,tooltip:{showTitle:!1,showMarkers:!1,showCrosshairs:!0,crosshairs:{type:"xy"}}});Yn("drag-move",{start:[{trigger:"plot:mousedown",action:"scale-translate:start"}],processing:[{trigger:"plot:mousemove",action:"scale-translate:translate",throttle:{wait:100,leading:!0,trailing:!1}}],end:[{trigger:"plot:mouseup",action:"scale-translate:end"}]});var Ict=function(e){Ut(t,e);function t(r,n){var i=e.call(this,r,n)||this;return i.type="scatter",i.on(di.BEFORE_RENDER,function(a){var o,s,l=i,u=l.options,c=l.chart;if(((o=a.data)===null||o===void 0?void 0:o.source)===Dc.FILTER){var f=i.chart.filterData(i.chart.getData());KA({chart:c,options:U(U({},u),{data:f})})}((s=a.data)===null||s===void 0?void 0:s.source)===Dc.RESET&&KA({chart:c,options:u})}),i}return t.getDefaultOptions=function(){return bSe},t.prototype.changeData=function(r){this.updateOption(Mct(ge({},this.options,{data:r})));var n=this,i=n.options,a=n.chart;KA({chart:a,options:i}),this.chart.changeData(r)},t.prototype.getSchemaAdaptor=function(){return Rct},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t}(Jn);const tLe=Object.freeze(Object.defineProperty({__proto__:null,Scatter:Ict},Symbol.toStringTag,{value:"Module"}));var uS="$$stock-range$$",aL="trend",Lct="up",Oct="down",ESe={showMarkers:!1,showCrosshairs:!0,shared:!0,crosshairs:{type:"xy",follow:!0,text:function(e,t,r){var n;if(e==="x"){var i=r[0];n=i?i.title:t}else n=t;return{position:e==="y"?"start":"end",content:n,style:{fill:"#dfdfdf"}}},textBackground:{padding:[2,4],style:{fill:"#666"}}}},wSe=ge({},Jn.getDefaultOptions(),{tooltip:ESe,interactions:[{type:"tooltip"}],legend:{position:"top-left"},risingFill:"#ef5350",fallingFill:"#26a69a"});function Pct(e,t){return mo(e,function(r){var n=r&&U({},r);if(ze(t)&&n){var i=t[0],a=t[1],o=t[2],s=t[3];n[aL]=n[i]<=n[a]?Lct:Oct,n[uS]=[n[i],n[a],n[o],n[s]]}return n})}function CSe(e){var t=e.chart,r=e.options,n=r.yField,i=r.data,a=r.risingFill,o=r.fallingFill,s=r.tooltip,l=r.stockStyle;t.data(Pct(i,n));var u=s;return u!==!1&&(u=ge({},{fields:n},u)),K6(ge({},e,{options:{schema:{shape:"candle",color:[a,o],style:l},yField:uS,seriesField:aL,rawFields:n,tooltip:u}})),e}function SSe(e){var t,r,n=e.chart,i=e.options,a=i.meta,o=i.xAxis,s=i.yAxis,l=i.xField,u=(t={},t[l]={type:"timeCat",tickCount:6},t[aL]={values:[Lct,Oct]},t),c=ge(u,a,(r={},r[l]=xa(o,Wc),r[uS]=xa(s,Wc),r));return n.scale(c),e}function TSe(e){var t=e.chart,r=e.options,n=r.xAxis,i=r.yAxis,a=r.xField;return n===!1?t.axis(a,!1):t.axis(a,n),i===!1?t.axis(uS,!1):t.axis(uS,i),e}function ASe(e){var t=e.chart,r=e.options,n=r.tooltip;return n!==!1?t.tooltip(n):t.tooltip(!1),e}function MSe(e){var t=e.chart,r=e.options,n=r.legend;return n?t.legend(aL,n):n===!1&&t.legend(!1),e}function Dct(e){Nn(Ji,CSe,SSe,TSe,ASe,MSe,_o,Aa,To(),n2)(e)}var RSe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="stock",r}return t.getDefaultOptions=function(){return wSe},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return Dct},t.prototype.changeData=function(r){this.updateOption({data:r});var n=this.options.yField;this.chart.changeData(Pct(r,n))},t}(Jn);function N_(e){return mo(e||[],function(t,r){return{x:"".concat(r),y:t}})}var cS="x",Tx="y",Fct={showTitle:!1,shared:!0,showMarkers:!1,customContent:function(e,t){return"".concat(xt(t,[0,"data","y"],0))},containerTpl:'<div class="g2-tooltip"><div class="g2-tooltip-list"></div></div>',itemTpl:"<span>{value}</span>",domStyles:{"g2-tooltip":{padding:"2px 4px",fontSize:"10px"}},showCrosshairs:!0,crosshairs:{type:"x"}},ISe={appendPadding:2,tooltip:U({},Fct),animation:{}};function LSe(e){var t=e.chart,r=e.options,n=r.data,i=r.color,a=r.areaStyle,o=r.point,s=r.line,l=o==null?void 0:o.state,u=N_(n);t.data(u);var c=ge({},e,{options:{xField:cS,yField:Tx,area:{color:i,style:a},line:s,point:o}}),f=ge({},c,{options:{tooltip:!1}}),d=ge({},c,{options:{tooltip:!1,state:l}});return Q3(c),Hb(f),jh(d),t.axis(!1),t.legend(!1),e}function Gb(e){var t,r,n=e.options,i=n.xAxis,a=n.yAxis,o=n.data,s=N_(o);return Nn(ns((t={},t[cS]=i,t[Tx]=a,t),(r={},r[cS]={type:"cat"},r[Tx]=W6(s,Tx),r)))(e)}function Bct(e){return Nn(Xh("areaStyle"),LSe,Gb,nl,Ji,Aa,To())(e)}var OSe={appendPadding:2,tooltip:U({},Fct),color:"l(90) 0:#E5EDFE 1:#ffffff",areaStyle:{fillOpacity:.6},line:{size:1,color:"#5B8FF9"},animation:{}},PSe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="tiny-area",r}return t.getDefaultOptions=function(){return OSe},t.prototype.changeData=function(r){this.updateOption({data:r});var n=this,i=n.chart,a=n.options;Gb({chart:i,options:a}),i.changeData(N_(r))},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return Bct},t}(Jn);function DSe(e){var t=e.chart,r=e.options,n=r.data,i=r.color,a=r.columnStyle,o=r.columnWidthRatio,s=N_(n);t.data(s);var l=ge({},e,{options:{xField:cS,yField:Tx,widthRatio:o,interval:{style:a,color:i}}});return du(l),t.axis(!1),t.legend(!1),t.interaction("element-active"),e}function Nct(e){return Nn(Ji,Xh("columnStyle"),DSe,Gb,nl,Aa,To())(e)}var FSe={showTitle:!1,shared:!0,showMarkers:!1,customContent:function(e,t){return"".concat(xt(t,[0,"data","y"],0))},containerTpl:'<div class="g2-tooltip"><div class="g2-tooltip-list"></div></div>',itemTpl:"<span>{value}</span>",domStyles:{"g2-tooltip":{padding:"2px 4px",fontSize:"10px"}}},BSe={appendPadding:2,tooltip:U({},FSe),animation:{}},NSe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="tiny-column",r}return t.getDefaultOptions=function(){return BSe},t.prototype.changeData=function(r){this.updateOption({data:r});var n=this,i=n.chart,a=n.options;Gb({chart:i,options:a}),i.changeData(N_(r))},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return Nct},t}(Jn);function kSe(e){var t=e.chart,r=e.options,n=r.data,i=r.color,a=r.lineStyle,o=r.point,s=o==null?void 0:o.state,l=N_(n);t.data(l);var u=ge({},e,{options:{xField:cS,yField:Tx,line:{color:i,style:a},point:o}}),c=ge({},u,{options:{tooltip:!1,state:s}});return Hb(u),jh(c),t.axis(!1),t.legend(!1),e}function kct(e){return Nn(kSe,Gb,Ji,nl,Aa,To())(e)}var zSe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="tiny-line",r}return t.getDefaultOptions=function(){return ISe},t.prototype.changeData=function(r){this.updateOption({data:r});var n=this,i=n.chart,a=n.options;Gb({chart:i,options:a}),i.changeData(N_(r))},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return kct},t}(Jn),USe={line:Hut,pie:_ct,column:iL,bar:jut,area:Vut,gauge:cct,"tiny-line":kct,"tiny-column":Nct,"tiny-area":Bct,"ring-progress":Sct,progress:wct,scatter:Rct,histogram:dct,funnel:rct,stock:Dct},$Se={line:pct,pie:xct,column:Zut,bar:Yut,area:Gut,gauge:hct,"tiny-line":zSe,"tiny-column":NSe,"tiny-area":PSe,"ring-progress":XCe,progress:VCe,scatter:Ict,histogram:TCe,funnel:nct,stock:RSe},HSe={pie:{label:!1},column:{tooltip:{showMarkers:!1}},bar:{tooltip:{showMarkers:!1}}};function s5(e,t,r){var n=$Se[e];if(!n){console.error("could not find ".concat(e," plot"));return}var i=USe[e];i({chart:t,options:ge({},n.getDefaultOptions(),xt(HSe,e,{}),r)})}function VSe(e){var t=e.chart,r=e.options,n=r.views,i=r.legend;return ft(n,function(a){var o=a.region,s=a.data,l=a.meta,u=a.axes,c=a.coordinate,f=a.interactions,d=a.annotations,v=a.tooltip,g=a.geometries,x=t.createView({region:o});x.data(s);var w={};u&&ft(u,function(S,A){w[A]=xa(S,Wc)}),w=ge({},l,w),x.scale(w),u?ft(u,function(S,A){x.axis(A,S)}):x.axis(!1),x.coordinate(c),ft(g,function(S){var A=ah({chart:x,options:S}).ext,M=S.adjust;M&&A.geometry.adjust(M)}),ft(f,function(S){S.enable===!1?x.removeInteraction(S.type):x.interaction(S.type,S.cfg)}),ft(d,function(S){x.annotation()[S.type](U({},S))}),typeof a.animation=="boolean"?x.animate(!1):(x.animate(!0),ft(x.geometries,function(S){S.animate(a.animation)})),v&&(x.interaction("tooltip"),x.tooltip(v))}),i?ft(i,function(a,o){t.legend(o,a)}):t.legend(!1),t.tooltip(r.tooltip),e}function GSe(e){var t=e.chart,r=e.options,n=r.plots,i=r.data,a=i===void 0?[]:i;return ft(n,function(o){var s=o.type,l=o.region,u=o.options,c=u===void 0?{}:u,f=o.top,d=c.tooltip;if(f){s5(s,t,U(U({},c),{data:a}));return}var v=t.createView(U({region:l},xa(c,kut)));d&&v.interaction("tooltip"),s5(s,v,U({data:a},c))}),e}function WSe(e){var t=e.chart,r=e.options;return t.option("slider",r.slider),e}function XSe(e){return Nn(Aa,VSe,GSe,_o,Aa,Ji,nl,WSe,To())(e)}function jSe(e,t){var r=e.getModel(),n=r.data,i;return ze(n)?i=n[0][t]:i=n[t],i}function YSe(e){var t=zR(e);ft(t,function(r){r.hasState("active")&&r.setState("active",!1),r.hasState("selected")&&r.setState("selected",!1),r.hasState("inactive")&&r.setState("inactive",!1)})}var ZSe=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getAssociationItems=function(r,n){var i,a=this.context.event,o=n||{},s=o.linkField,l=o.dim,u=[];if(!((i=a.data)===null||i===void 0)&&i.data){var c=a.data.data;ft(r,function(f){var d,v,g=s;if(l==="x"?g=f.getXScale().field:l==="y"?g=(d=f.getYScales().find(function(w){return w.field===g}))===null||d===void 0?void 0:d.field:g||(g=(v=f.getGroupScales()[0])===null||v===void 0?void 0:v.field),!!g){var x=mo(zR(f),function(w){var S=!1,A=!1,M=ze(c)?xt(c[0],g):xt(c,g);return jSe(w,g)===M?S=!0:A=!0,{element:w,view:f,active:S,inactive:A}});u.push.apply(u,x)}})}return u},t.prototype.showTooltip=function(r){var n=wY(this.context.view),i=this.getAssociationItems(n,r);ft(i,function(a){if(a.active){var o=a.element.shape.getCanvasBBox();a.view.showTooltip({x:o.minX+o.width/2,y:o.minY+o.height/2})}})},t.prototype.hideTooltip=function(){var r=wY(this.context.view);ft(r,function(n){n.hideTooltip()})},t.prototype.active=function(r){var n=Aw(this.context.view),i=this.getAssociationItems(n,r);ft(i,function(a){var o=a.active,s=a.element;o&&s.setState("active",!0)})},t.prototype.selected=function(r){var n=Aw(this.context.view),i=this.getAssociationItems(n,r);ft(i,function(a){var o=a.active,s=a.element;o&&s.setState("selected",!0)})},t.prototype.highlight=function(r){var n=Aw(this.context.view),i=this.getAssociationItems(n,r);ft(i,function(a){var o=a.inactive,s=a.element;o&&s.setState("inactive",!0)})},t.prototype.reset=function(){var r=Aw(this.context.view);ft(r,function(n){YSe(n)})},t}(to);mn("association",ZSe);Yn("association-active",{start:[{trigger:"element:mouseenter",action:"association:active"}],end:[{trigger:"element:mouseleave",action:"association:reset"}]});Yn("association-selected",{start:[{trigger:"element:mouseenter",action:"association:selected"}],end:[{trigger:"element:mouseleave",action:"association:reset"}]});Yn("association-highlight",{start:[{trigger:"element:mouseenter",action:"association:highlight"}],end:[{trigger:"element:mouseleave",action:"association:reset"}]});Yn("association-tooltip",{start:[{trigger:"element:mousemove",action:"association:showTooltip"}],end:[{trigger:"element:mouseleave",action:"association:hideTooltip"}]});var qSe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="mix",r}return t.prototype.getSchemaAdaptor=function(){return XSe},t}(Jn);const eLe=Object.freeze(Object.defineProperty({__proto__:null,Mix:qSe},Symbol.toStringTag,{value:"Module"}));var IY;(function(e){e.DEV="DEV",e.BETA="BETA",e.STABLE="STABLE"})(IY||(IY={}));var qp="first-axes-view",Kp="second-axes-view",Iy="series-field-key";function zct(e,t,r,n,i){var a=[];t.forEach(function(f){n.forEach(function(d){var v,g=(v={},v[e]=d[e],v[r]=f,v[f]=d[f],v);a.push(g)})});var o=Object.values(Ph(a,r)),s=o[0],l=s===void 0?[]:s,u=o[1],c=u===void 0?[]:u;return i?[l.reverse(),c.reverse()]:[l,c]}function tg(e){return e!=="vertical"}function KSe(e,t,r){var n=t[0],i=t[1],a=n.autoPadding,o=i.autoPadding,s=e.__axisPosition,l=s.layout,u=s.position;if(tg(l)&&u==="top"&&(n.autoPadding=r.instance(a.top,0,a.bottom,a.left),i.autoPadding=r.instance(o.top,a.left,o.bottom,0)),tg(l)&&u==="bottom"&&(n.autoPadding=r.instance(a.top,a.right/2+5,a.bottom,a.left),i.autoPadding=r.instance(o.top,o.right,o.bottom,a.right/2+5)),!tg(l)&&u==="bottom"){var c=a.left>=o.left?a.left:o.left;n.autoPadding=r.instance(a.top,a.right,a.bottom/2+5,c),i.autoPadding=r.instance(a.bottom/2+5,o.right,o.bottom,c)}if(!tg(l)&&u==="top"){var c=a.left>=o.left?a.left:o.left;n.autoPadding=r.instance(a.top,a.right,0,c),i.autoPadding=r.instance(0,o.right,a.top,c)}}function QSe(e){var t=e.chart,r=e.options,n=r.data,i=r.xField,a=r.yField,o=r.color,s=r.barStyle,l=r.widthRatio,u=r.legend,c=r.layout,f=zct(i,a,Iy,n,tg(c));u?t.legend(Iy,u):u===!1&&t.legend(!1);var d,v,g=f[0],x=f[1];tg(c)?(d=t.createView({region:{start:{x:0,y:0},end:{x:.5,y:1}},id:qp}),d.coordinate().transpose().reflect("x"),v=t.createView({region:{start:{x:.5,y:0},end:{x:1,y:1}},id:Kp}),v.coordinate().transpose(),d.data(g),v.data(x)):(d=t.createView({region:{start:{x:0,y:0},end:{x:1,y:.5}},id:qp}),v=t.createView({region:{start:{x:0,y:.5},end:{x:1,y:1}},id:Kp}),v.coordinate().reflect("y"),d.data(g),v.data(x));var w=ge({},e,{chart:d,options:{widthRatio:l,xField:i,yField:a[0],seriesField:Iy,interval:{color:o,style:s}}});du(w);var S=ge({},e,{chart:v,options:{xField:i,yField:a[1],seriesField:Iy,widthRatio:l,interval:{color:o,style:s}}});return du(S),e}function JSe(e){var t,r,n,i=e.options,a=e.chart,o=i.xAxis,s=i.yAxis,l=i.xField,u=i.yField,c=yi(a,qp),f=yi(a,Kp),d={};return Eb((i==null?void 0:i.meta)||{}).map(function(v){xt(i==null?void 0:i.meta,[v,"alias"])&&(d[v]=i.meta[v].alias)}),a.scale((t={},t[Iy]={sync:!0,formatter:function(v){return xt(d,v,v)}},t)),ns((r={},r[l]=o,r[u[0]]=s[u[0]],r))(ge({},e,{chart:c})),ns((n={},n[l]=o,n[u[1]]=s[u[1]],n))(ge({},e,{chart:f})),e}function t2e(e){var t=e.chart,r=e.options,n=r.xAxis,i=r.yAxis,a=r.xField,o=r.yField,s=r.layout,l=yi(t,qp),u=yi(t,Kp);return(n==null?void 0:n.position)==="bottom"?u.axis(a,U(U({},n),{label:{formatter:function(){return""}}})):u.axis(a,!1),n===!1?l.axis(a,!1):l.axis(a,U({position:tg(s)?"top":"bottom"},n)),i===!1?(l.axis(o[0],!1),u.axis(o[1],!1)):(l.axis(o[0],i[o[0]]),u.axis(o[1],i[o[1]])),t.__axisPosition={position:l.getOptions().axes[a].position,layout:s},e}function e2e(e){var t=e.chart;return _o(ge({},e,{chart:yi(t,qp)})),_o(ge({},e,{chart:yi(t,Kp)})),e}function r2e(e){var t=e.chart,r=e.options,n=r.yField,i=r.yAxis;return g_(ge({},e,{chart:yi(t,qp),options:{yAxis:i[n[0]]}})),g_(ge({},e,{chart:yi(t,Kp),options:{yAxis:i[n[1]]}})),e}function n2e(e){var t=e.chart;return Ji(ge({},e,{chart:yi(t,qp)})),Ji(ge({},e,{chart:yi(t,Kp)})),Ji(e),e}function i2e(e){var t=e.chart;return Aa(ge({},e,{chart:yi(t,qp)})),Aa(ge({},e,{chart:yi(t,Kp)})),e}function a2e(e){var t=this,r,n,i=e.chart,a=e.options,o=a.label,s=a.yField,l=a.layout,u=yi(i,qp),c=yi(i,Kp),f=fu(u,"interval"),d=fu(c,"interval");if(!o)f.label(!1),d.label(!1);else{var v=o.callback,g=hi(o,["callback"]);g.position||(g.position="middle"),g.offset===void 0&&(g.offset=2);var x=U({},g);if(tg(l)){var w=((r=x.style)===null||r===void 0?void 0:r.textAlign)||(g.position==="middle"?"center":"left");g.style=ge({},g.style,{textAlign:w});var S={left:"right",right:"left",center:"center"};x.style=ge({},x.style,{textAlign:S[w]})}else{var A={top:"bottom",bottom:"top",middle:"middle"};typeof g.position=="string"?g.position=A[g.position]:typeof g.position=="function"&&(g.position=function(){for(var O=[],N=0;N<arguments.length;N++)O[N]=arguments[N];return A[g.position.apply(t,O)]});var M=((n=x.style)===null||n===void 0?void 0:n.textBaseline)||"bottom";x.style=ge({},x.style,{textBaseline:M});var R={top:"bottom",bottom:"top",middle:"middle"};g.style=ge({},g.style,{textBaseline:R[M]})}f.label({fields:[s[0]],callback:v,cfg:wl(x)}),d.label({fields:[s[1]],callback:v,cfg:wl(g)})}return e}function o2e(e){return Nn(QSe,JSe,t2e,r2e,n2e,a2e,nl,e2e,i2e)(e)}var s2e=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="bidirectional-bar",r}return t.getDefaultOptions=function(){return ge({},e.getDefaultOptions.call(this),{syncViewPadding:KSe})},t.prototype.changeData=function(r){r===void 0&&(r=[]),this.chart.emit(di.BEFORE_CHANGE_DATA,So.fromData(this.chart,di.BEFORE_CHANGE_DATA,null)),this.updateOption({data:r});var n=this.options,i=n.xField,a=n.yField,o=n.layout,s=zct(i,a,Iy,r,tg(o)),l=s[0],u=s[1],c=yi(this.chart,qp),f=yi(this.chart,Kp);c.data(l),f.data(u),this.chart.render(!0),this.chart.emit(di.AFTER_CHANGE_DATA,So.fromData(this.chart,di.AFTER_CHANGE_DATA,null))},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return o2e},t.SERIES_FIELD_KEY=Iy,t}(Jn);const rLe=Object.freeze(Object.defineProperty({__proto__:null,BidirectionalBar:s2e},Symbol.toStringTag,{value:"Module"}));var PP,ub="$$range$$",l2e="low-q1-median-q3-high",u2e="$$y_outliers$$",Uct="outliers_view",c2e=ge({},Jn.getDefaultOptions(),{meta:(PP={},PP[ub]={min:0,alias:l2e},PP),interactions:[{type:"active-region"}],tooltip:{showMarkers:!1,shared:!0},boxStyle:{lineWidth:1}}),$ct=function(e,t){var r=e;if(Array.isArray(t)){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4];r=mo(e,function(l){return l[ub]=[l[n],l[i],l[a],l[o],l[s]],l})}return r};function h2e(e){var t=e.chart,r=e.options,n=r.xField,i=r.yField,a=r.groupField,o=r.color,s=r.tooltip,l=r.boxStyle;t.data($ct(r.data,i));var u=ze(i)?ub:i,c=i?ze(i)?i:[i]:[],f=s;f!==!1&&(f=ge({},{fields:ze(i)?i:[]},f));var d=K6(ge({},e,{options:{xField:n,yField:u,seriesField:a,tooltip:f,rawFields:c,label:!1,schema:{shape:"box",color:o,style:l}}})).ext;return a&&d.geometry.adjust("dodge"),e}function f2e(e){var t=e.chart,r=e.options,n=r.xField,i=r.data,a=r.outliersField,o=r.outliersStyle,s=r.padding,l=r.label;if(!a)return e;var u=t.createView({padding:s,id:Uct}),c=i.reduce(function(f,d){var v=d[a];return v.forEach(function(g){var x;return f.push(U(U({},d),(x={},x[a]=g,x)))}),f},[]);return u.data(c),jh({chart:u,options:{xField:n,yField:a,point:{shape:"circle",style:o},label:l}}),u.axis(!1),e}function d2e(e){var t,r,n=e.chart,i=e.options,a=i.meta,o=i.xAxis,s=i.yAxis,l=i.xField,u=i.yField,c=i.outliersField,f=Array.isArray(u)?ub:u,d={};if(c){var v=u2e;d=(t={},t[c]={sync:v,nice:!0},t[f]={sync:v,nice:!0},t)}var g=ge(d,a,(r={},r[l]=xa(o,Wc),r[f]=xa(s,Wc),r));return n.scale(g),e}function p2e(e){var t=e.chart,r=e.options,n=r.xAxis,i=r.yAxis,a=r.xField,o=r.yField,s=Array.isArray(o)?ub:o;return n===!1?t.axis(a,!1):t.axis(a,n),i===!1?t.axis(ub,!1):t.axis(s,i),e}function v2e(e){var t=e.chart,r=e.options,n=r.legend,i=r.groupField;return i?n?t.legend(i,n):t.legend(i,{position:"bottom"}):t.legend(!1),e}function g2e(e){return Nn(h2e,f2e,d2e,p2e,v2e,nl,To(),_o,Aa,Ji)(e)}(function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="box",r}return t.getDefaultOptions=function(){return c2e},t.prototype.changeData=function(r){this.updateOption({data:r});var n=this.options.yField,i=this.chart.views.find(function(a){return a.id===Uct});i&&i.data(r),this.chart.changeData($ct(r,n))},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return g2e},t})(Jn);function LY(e,t,r){return e.length>1?"".concat(t,"_").concat(r):"".concat(t)}function Hct(e){var t=e.data,r=e.xField,n=e.measureField,i=e.rangeField,a=e.targetField,o=e.layout,s=[],l=[];t.forEach(function(f,d){var v=[f[i]].flat();v.sort(function(w,S){return w-S}),v.forEach(function(w,S){var A,M=S===0?w:v[S]-v[S-1];s.push((A={rKey:"".concat(i,"_").concat(S)},A[r]=r?f[r]:String(d),A[i]=M,A))});var g=[f[n]].flat();g.forEach(function(w,S){var A;s.push((A={mKey:LY(g,n,S)},A[r]=r?f[r]:String(d),A[n]=w,A))});var x=[f[a]].flat();x.forEach(function(w,S){var A;s.push((A={tKey:LY(x,a,S)},A[r]=r?f[r]:String(d),A[a]=w,A))}),l.push(f[i],f[n],f[a])});var u=Math.min.apply(Math,l.flat(1/0)),c=Math.max.apply(Math,l.flat(1/0));return u=u>0?0:u,o==="vertical"&&s.reverse(),{min:u,max:c,ds:s}}function m2e(e){var t=e.chart,r=e.options,n=r.bulletStyle,i=r.targetField,a=r.rangeField,o=r.measureField,s=r.xField,l=r.color,u=r.layout,c=r.size,f=r.label,d=Hct(r),v=d.min,g=d.max,x=d.ds;t.data(x);var w=ge({},e,{options:{xField:s,yField:a,seriesField:"rKey",isStack:!0,label:xt(f,"range"),interval:{color:xt(l,"range"),style:xt(n,"range"),size:xt(c,"range")}}});du(w),t.geometries[0].tooltip(!1);var S=ge({},e,{options:{xField:s,yField:o,seriesField:"mKey",isStack:!0,label:xt(f,"measure"),interval:{color:xt(l,"measure"),style:xt(n,"measure"),size:xt(c,"measure")}}});du(S);var A=ge({},e,{options:{xField:s,yField:i,seriesField:"tKey",label:xt(f,"target"),point:{color:xt(l,"target"),style:xt(n,"target"),size:$r(xt(c,"target"))?function(M){return xt(c,"target")(M)/2}:xt(c,"target")/2,shape:u==="horizontal"?"line":"hyphen"}}});return jh(A),u==="horizontal"&&t.coordinate().transpose(),U(U({},e),{ext:{data:{min:v,max:g}}})}function Vct(e){var t,r,n=e.options,i=e.ext,a=n.xAxis,o=n.yAxis,s=n.targetField,l=n.rangeField,u=n.measureField,c=n.xField,f=i.data;return Nn(ns((t={},t[c]=a,t[u]=o,t),(r={},r[u]={min:f==null?void 0:f.min,max:f==null?void 0:f.max,sync:!0},r[s]={sync:"".concat(u)},r[l]={sync:"".concat(u)},r)))(e)}function y2e(e){var t=e.chart,r=e.options,n=r.xAxis,i=r.yAxis,a=r.xField,o=r.measureField,s=r.rangeField,l=r.targetField;return t.axis("".concat(s),!1),t.axis("".concat(l),!1),n===!1?t.axis("".concat(a),!1):t.axis("".concat(a),n),i===!1?t.axis("".concat(o),!1):t.axis("".concat(o),i),e}function _2e(e){var t=e.chart,r=e.options,n=r.legend;return t.removeInteraction("legend-filter"),t.legend(n),t.legend("rKey",!1),t.legend("mKey",!1),t.legend("tKey",!1),e}function x2e(e){var t=e.chart,r=e.options,n=r.label,i=r.measureField,a=r.targetField,o=r.rangeField,s=t.geometries,l=s[0],u=s[1],c=s[2];return xt(n,"range")?l.label("".concat(o),U({layout:[{type:"limit-in-plot"}]},wl(n.range))):l.label(!1),xt(n,"measure")?u.label("".concat(i),U({layout:[{type:"limit-in-plot"}]},wl(n.measure))):u.label(!1),xt(n,"target")?c.label("".concat(a),U({layout:[{type:"limit-in-plot"}]},wl(n.target))):c.label(!1),e}function b2e(e){Nn(m2e,Vct,y2e,_2e,Ji,x2e,nl,_o,Aa)(e)}var E2e=ge({},Jn.getDefaultOptions(),{layout:"horizontal",size:{range:30,measure:20,target:20},xAxis:{tickLine:!1,line:null},bulletStyle:{range:{fillOpacity:.5}},label:{measure:{position:"right"}},tooltip:{showMarkers:!1}});(function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="bullet",r}return t.getDefaultOptions=function(){return E2e},t.prototype.changeData=function(r){this.updateOption({data:r});var n=Hct(this.options),i=n.min,a=n.max,o=n.ds;Vct({options:this.options,ext:{data:{min:i,max:a}},chart:this.chart}),this.chart.changeData(o)},t.prototype.getSchemaAdaptor=function(){return b2e},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t})(Jn);var w2e={y:0,nodeWidthRatio:.05,weight:!1,nodePaddingRatio:.1,id:function(e){return e.id},source:function(e){return e.source},target:function(e){return e.target},sourceWeight:function(e){return e.value||1},targetWeight:function(e){return e.value||1},sortBy:null};function C2e(e,t,r){ft(e,function(n,i){n.inEdges=t.filter(function(a){return"".concat(r.target(a))==="".concat(i)}),n.outEdges=t.filter(function(a){return"".concat(r.source(a))==="".concat(i)}),n.edges=n.outEdges.concat(n.inEdges),n.frequency=n.edges.length,n.value=0,n.inEdges.forEach(function(a){n.value+=r.targetWeight(a)}),n.outEdges.forEach(function(a){n.value+=r.sourceWeight(a)})})}function S2e(e,t){var r={weight:function(i,a){return a.value-i.value},frequency:function(i,a){return a.frequency-i.frequency},id:function(i,a){return"".concat(t.id(i)).localeCompare("".concat(t.id(a)))}},n=r[t.sortBy];!n&&$r(t.sortBy)&&(n=t.sortBy),n&&e.sort(n)}function T2e(e,t){var r=e.length;if(!r)throw new TypeError("Invalid nodes: it's empty!");if(t.weight){var n=t.nodePaddingRatio;if(n<0||n>=1)throw new TypeError("Invalid nodePaddingRatio: it must be in range [0, 1)!");var i=n/(2*r),a=t.nodeWidthRatio;if(a<=0||a>=1)throw new TypeError("Invalid nodeWidthRatio: it must be in range (0, 1)!");var o=0;e.forEach(function(l){o+=l.value}),e.forEach(function(l){l.weight=l.value/o,l.width=l.weight*(1-n),l.height=a}),e.forEach(function(l,u){for(var c=0,f=u-1;f>=0;f--)c+=e[f].width+2*i;var d=l.minX=i+c,v=l.maxX=l.minX+l.width,g=l.minY=t.y-a/2,x=l.maxY=g+a;l.x=[d,v,v,d],l.y=[g,g,x,x]})}else{var s=1/r;e.forEach(function(l,u){l.x=(u+.5)*s,l.y=t.y})}return e}function A2e(e,t,r){if(r.weight){var n={};ft(e,function(i,a){n[a]=i.value}),t.forEach(function(i){var a=r.source(i),o=r.target(i),s=e[a],l=e[o];if(s&&l){var u=n[a],c=r.sourceWeight(i),f=s.minX+(s.value-u)/s.value*s.width,d=f+c/s.value*s.width;n[a]-=c;var v=n[o],g=r.targetWeight(i),x=l.minX+(l.value-v)/l.value*l.width,w=x+g/l.value*l.width;n[o]-=g;var S=r.y;i.x=[f,d,x,w],i.y=[S,S,S,S],i.source=s,i.target=l}})}else t.forEach(function(i){var a=e[r.source(i)],o=e[r.target(i)];a&&o&&(i.x=[a.x,o.x],i.y=[a.y,o.y],i.source=a,i.target=o)});return t}function M2e(e){return Sa({},w2e,e)}function R2e(e,t){var r=M2e(e),n={},i=t.nodes,a=t.links;i.forEach(function(l){var u=r.id(l);n[u]=l}),C2e(n,a,r),S2e(i,r);var o=T2e(i,r),s=A2e(n,a,r);return{nodes:o,links:s}}var Gct="x",Wct="y",Xct="name",jct="source",I2e={nodeStyle:{opacity:1,fillOpacity:1,lineWidth:1},edgeStyle:{opacity:.5,lineWidth:2},label:{fields:["x","name"],callback:function(e,t){var r=(e[0]+e[1])/2,n=r>.5?-4:4;return{offsetX:n,content:t}},labelEmit:!0,style:{fill:"#8c8c8c"}},tooltip:{showTitle:!1,showMarkers:!1,fields:["source","target","value","isNode"],showContent:function(e){return!xt(e,[0,"data","isNode"])},formatter:function(e){var t=e.source,r=e.target,n=e.value;return{name:"".concat(t," -> ").concat(r),value:n}}},interactions:[{type:"element-active"}],weight:!0,nodePaddingRatio:.1,nodeWidthRatio:.05};function L2e(e){var t=e.options,r=t.data,n=t.sourceField,i=t.targetField,a=t.weightField,o=t.nodePaddingRatio,s=t.nodeWidthRatio,l=t.rawFields,u=l===void 0?[]:l,c=Cut(r,n,i,a),f=R2e({weight:!0,nodePaddingRatio:o,nodeWidthRatio:s},c),d=f.nodes,v=f.links,g=d.map(function(w){return U(U({},xa(w,an(["id","x","y","name"],u,!0))),{isNode:!0})}),x=v.map(function(w){return U(U({source:w.source.name,target:w.target.name,name:w.source.name||w.target.name},xa(w,an(["x","y","value"],u,!0))),{isNode:!1})});return U(U({},e),{ext:U(U({},e.ext),{chordData:{nodesData:g,edgesData:x}})})}function O2e(e){var t,r=e.chart;return r.scale((t={x:{sync:!0,nice:!0},y:{sync:!0,nice:!0,max:1}},t[Xct]={sync:"color"},t[jct]={sync:"color"},t)),e}function P2e(e){var t=e.chart;return t.axis(!1),e}function D2e(e){var t=e.chart;return t.legend(!1),e}function F2e(e){var t=e.chart,r=e.options,n=r.tooltip;return t.tooltip(n),e}function B2e(e){var t=e.chart;return t.coordinate("polar").reflect("y"),e}function N2e(e){var t=e.chart,r=e.options,n=e.ext.chordData.nodesData,i=r.nodeStyle,a=r.label,o=r.tooltip,s=t.createView();return s.data(n),J3({chart:s,options:{xField:Gct,yField:Wct,seriesField:Xct,polygon:{style:i},label:a,tooltip:o}}),e}function k2e(e){var t=e.chart,r=e.options,n=e.ext.chordData.edgesData,i=r.edgeStyle,a=r.tooltip,o=t.createView();o.data(n);var s={xField:Gct,yField:Wct,seriesField:jct,edge:{style:i,shape:"arc"},tooltip:a};return Dut({chart:o,options:s}),e}function z2e(e){var t=e.chart,r=e.options,n=r.animation;return r2(t,n,EEe(t)),e}function U2e(e){return Nn(Ji,L2e,B2e,O2e,P2e,D2e,F2e,k2e,N2e,_o,w0,z2e)(e)}(function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="chord",r}return t.getDefaultOptions=function(){return I2e},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return U2e},t})(Jn);var $2e=["x","y","r","name","value","path","depth"],H2e={colorField:"name",autoFit:!0,pointStyle:{lineWidth:0,stroke:"#fff"},legend:!1,hierarchyConfig:{size:[1,1],padding:0},label:{fields:["name"],layout:{type:"limit-in-shape"}},tooltip:{showMarkers:!1,showTitle:!1},drilldown:{enabled:!1}},OY=4,V2e=0,PY=5,DY="drilldown-bread-crumb",G2e={position:"top-left",dividerText:"/",textStyle:{fontSize:12,fill:"rgba(0, 0, 0, 0.65)",cursor:"pointer"},activeTextStyle:{fill:"#87B5FF"}},hS="hierarchy-data-transform-params",W2e=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.name="drill-down",r.historyCache=[],r.breadCrumbGroup=null,r.breadCrumbCfg=G2e,r}return t.prototype.click=function(){var r=xt(this.context,["event","data","data"]);if(!r)return!1;this.drill(r),this.drawBreadCrumb()},t.prototype.resetPosition=function(){if(this.breadCrumbGroup){var r=this.context.view.getCoordinate(),n=this.breadCrumbGroup,i=n.getBBox(),a=this.getButtonCfg().position,o={x:r.start.x,y:r.end.y-(i.height+PY*2)};r.isPolar&&(o={x:0,y:0}),a==="bottom-left"&&(o={x:r.start.x,y:r.start.y});var s=eh.transform(null,[["t",o.x+V2e,o.y+i.height+PY]]);n.setMatrix(s)}},t.prototype.back=function(){_l(this.historyCache)&&this.backTo(this.historyCache.slice(0,-1))},t.prototype.reset=function(){this.historyCache[0]&&this.backTo(this.historyCache.slice(0,1)),this.historyCache=[],this.hideCrumbGroup()},t.prototype.drill=function(r){var n=this.context.view,i=xt(n,["interactions","drill-down","cfg","transformData"],function(u){return u}),a=i(U({data:r.data},r[hS]));n.changeData(a);for(var o=[],s=r;s;){var l=s.data;o.unshift({id:"".concat(l.name,"_").concat(s.height,"_").concat(s.depth),name:l.name,children:i(U({data:l},r[hS]))}),s=s.parent}this.historyCache=(this.historyCache||[]).slice(0,-1).concat(o)},t.prototype.backTo=function(r){if(!(!r||r.length<=0)){var n=this.context.view,i=Gs(r).children;n.changeData(i),r.length>1?(this.historyCache=r,this.drawBreadCrumb()):(this.historyCache=[],this.hideCrumbGroup())}},t.prototype.getButtonCfg=function(){var r=this.context.view,n=xt(r,["interactions","drill-down","cfg","drillDownConfig"]);return ge(this.breadCrumbCfg,n==null?void 0:n.breadCrumb,this.cfg)},t.prototype.drawBreadCrumb=function(){this.drawBreadCrumbGroup(),this.resetPosition(),this.breadCrumbGroup.show()},t.prototype.drawBreadCrumbGroup=function(){var r=this,n=this.getButtonCfg(),i=this.historyCache;this.breadCrumbGroup?this.breadCrumbGroup.clear():this.breadCrumbGroup=this.context.view.foregroundGroup.addGroup({name:DY});var a=0;i.forEach(function(o,s){var l=r.breadCrumbGroup.addShape({type:"text",id:o.id,name:"".concat(DY,"_").concat(o.name,"_text"),attrs:U(U({text:s===0&&!ke(n.rootText)?n.rootText:o.name},n.textStyle),{x:a,y:0})}),u=l.getBBox();if(a+=u.width+OY,l.on("click",function(d){var v,g=d.target.get("id");if(g!==((v=Gs(i))===null||v===void 0?void 0:v.id)){var x=i.slice(0,i.findIndex(function(w){return w.id===g})+1);r.backTo(x)}}),l.on("mouseenter",function(d){var v,g=d.target.get("id");g!==((v=Gs(i))===null||v===void 0?void 0:v.id)?l.attr(n.activeTextStyle):l.attr({cursor:"default"})}),l.on("mouseleave",function(){l.attr(n.textStyle)}),s<i.length-1){var c=r.breadCrumbGroup.addShape({type:"text",name:"".concat(n.name,"_").concat(o.name,"_divider"),attrs:U(U({text:n.dividerText},n.textStyle),{x:a,y:0})}),f=c.getBBox();a+=f.width+OY}})},t.prototype.hideCrumbGroup=function(){this.breadCrumbGroup&&this.breadCrumbGroup.hide()},t.prototype.destroy=function(){this.breadCrumbGroup&&this.breadCrumbGroup.remove(),e.prototype.destroy.call(this)},t}(to);function X2e(e,t){return e.parent===t.parent?1:2}function j2e(e){return e.reduce(Y2e,0)/e.length}function Y2e(e,t){return e+t.x}function Z2e(e){return 1+e.reduce(q2e,0)}function q2e(e,t){return Math.max(e,t.y)}function K2e(e){for(var t;t=e.children;)e=t[0];return e}function Q2e(e){for(var t;t=e.children;)e=t[t.length-1];return e}function J2e(){var e=X2e,t=1,r=1,n=!1;function i(a){var o,s=0;a.eachAfter(function(d){var v=d.children;v?(d.x=j2e(v),d.y=Z2e(v)):(d.x=o?s+=e(d,o):0,d.y=0,o=d)});var l=K2e(a),u=Q2e(a),c=l.x-e(l,u)/2,f=u.x+e(u,l)/2;return a.eachAfter(n?function(d){d.x=(d.x-a.x)*t,d.y=(a.y-d.y)*r}:function(d){d.x=(d.x-c)/(f-c)*t,d.y=(1-(a.y?d.y/a.y:1))*r})}return i.separation=function(a){return arguments.length?(e=a,i):e},i.size=function(a){return arguments.length?(n=!1,t=+a[0],r=+a[1],i):n?null:[t,r]},i.nodeSize=function(a){return arguments.length?(n=!0,t=+a[0],r=+a[1],i):n?[t,r]:null},i}function tTe(e){var t=0,r=e.children,n=r&&r.length;if(!n)t=1;else for(;--n>=0;)t+=r[n].value;e.value=t}function eTe(){return this.eachAfter(tTe)}function rTe(e,t){let r=-1;for(const n of this)e.call(t,n,++r,this);return this}function nTe(e,t){for(var r=this,n=[r],i,a,o=-1;r=n.pop();)if(e.call(t,r,++o,this),i=r.children)for(a=i.length-1;a>=0;--a)n.push(i[a]);return this}function iTe(e,t){for(var r=this,n=[r],i=[],a,o,s,l=-1;r=n.pop();)if(i.push(r),a=r.children)for(o=0,s=a.length;o<s;++o)n.push(a[o]);for(;r=i.pop();)e.call(t,r,++l,this);return this}function aTe(e,t){let r=-1;for(const n of this)if(e.call(t,n,++r,this))return n}function oTe(e){return this.eachAfter(function(t){for(var r=+e(t.data)||0,n=t.children,i=n&&n.length;--i>=0;)r+=n[i].value;t.value=r})}function sTe(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function lTe(e){for(var t=this,r=uTe(t,e),n=[t];t!==r;)t=t.parent,n.push(t);for(var i=n.length;e!==r;)n.splice(i,0,e),e=e.parent;return n}function uTe(e,t){if(e===t)return e;var r=e.ancestors(),n=t.ancestors(),i=null;for(e=r.pop(),t=n.pop();e===t;)i=e,e=r.pop(),t=n.pop();return i}function cTe(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function hTe(){return Array.from(this)}function fTe(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function dTe(){var e=this,t=[];return e.each(function(r){r!==e&&t.push({source:r.parent,target:r})}),t}function*pTe(){var e=this,t,r=[e],n,i,a;do for(t=r.reverse(),r=[];e=t.pop();)if(yield e,n=e.children)for(i=0,a=n.length;i<a;++i)r.push(n[i]);while(r.length)}function Wb(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=mTe)):t===void 0&&(t=gTe);for(var r=new cb(e),n,i=[r],a,o,s,l;n=i.pop();)if((o=t(n.data))&&(l=(o=Array.from(o)).length))for(n.children=o,s=l-1;s>=0;--s)i.push(a=o[s]=new cb(o[s])),a.parent=n,a.depth=n.depth+1;return r.eachBefore(Yct)}function vTe(){return Wb(this).eachBefore(yTe)}function gTe(e){return e.children}function mTe(e){return Array.isArray(e)?e[1]:null}function yTe(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function Yct(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function cb(e){this.data=e,this.depth=this.height=0,this.parent=null}cb.prototype=Wb.prototype={constructor:cb,count:eTe,each:rTe,eachAfter:iTe,eachBefore:nTe,find:aTe,sum:oTe,sort:sTe,path:lTe,ancestors:cTe,descendants:hTe,leaves:fTe,links:dTe,copy:vTe,[Symbol.iterator]:pTe};function _Te(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function xTe(e){for(var t=e.length,r,n;t;)n=Math.random()*t--|0,r=e[t],e[t]=e[n],e[n]=r;return e}function Zct(e){for(var t=0,r=(e=xTe(Array.from(e))).length,n=[],i,a;t<r;)i=e[t],a&&qct(a,i)?++t:(a=ETe(n=bTe(n,i)),t=0);return a}function bTe(e,t){var r,n;if(DP(t,e))return[t];for(r=0;r<e.length;++r)if(gA(t,e[r])&&DP(Mw(e[r],t),e))return[e[r],t];for(r=0;r<e.length-1;++r)for(n=r+1;n<e.length;++n)if(gA(Mw(e[r],e[n]),t)&&gA(Mw(e[r],t),e[n])&&gA(Mw(e[n],t),e[r])&&DP(Kct(e[r],e[n],t),e))return[e[r],e[n],t];throw new Error}function gA(e,t){var r=e.r-t.r,n=t.x-e.x,i=t.y-e.y;return r<0||r*r<n*n+i*i}function qct(e,t){var r=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,n=t.x-e.x,i=t.y-e.y;return r>0&&r*r>n*n+i*i}function DP(e,t){for(var r=0;r<t.length;++r)if(!qct(e,t[r]))return!1;return!0}function ETe(e){switch(e.length){case 1:return wTe(e[0]);case 2:return Mw(e[0],e[1]);case 3:return Kct(e[0],e[1],e[2])}}function wTe(e){return{x:e.x,y:e.y,r:e.r}}function Mw(e,t){var r=e.x,n=e.y,i=e.r,a=t.x,o=t.y,s=t.r,l=a-r,u=o-n,c=s-i,f=Math.sqrt(l*l+u*u);return{x:(r+a+l/f*c)/2,y:(n+o+u/f*c)/2,r:(f+i+s)/2}}function Kct(e,t,r){var n=e.x,i=e.y,a=e.r,o=t.x,s=t.y,l=t.r,u=r.x,c=r.y,f=r.r,d=n-o,v=n-u,g=i-s,x=i-c,w=l-a,S=f-a,A=n*n+i*i-a*a,M=A-o*o-s*s+l*l,R=A-u*u-c*c+f*f,O=v*g-d*x,N=(g*R-x*M)/(O*2)-n,k=(x*w-g*S)/O,V=(v*M-d*R)/(O*2)-i,Q=(d*S-v*w)/O,Y=k*k+Q*Q-1,X=2*(a+N*k+V*Q),tt=N*N+V*V-a*a,it=-(Y?(X+Math.sqrt(X*X-4*Y*tt))/(2*Y):tt/X);return{x:n+N+k*it,y:i+V+Q*it,r:it}}function FY(e,t,r){var n=e.x-t.x,i,a,o=e.y-t.y,s,l,u=n*n+o*o;u?(a=t.r+r.r,a*=a,l=e.r+r.r,l*=l,a>l?(i=(u+l-a)/(2*u),s=Math.sqrt(Math.max(0,l/u-i*i)),r.x=e.x-i*n-s*o,r.y=e.y-i*o+s*n):(i=(u+a-l)/(2*u),s=Math.sqrt(Math.max(0,a/u-i*i)),r.x=t.x+i*n-s*o,r.y=t.y+i*o+s*n)):(r.x=t.x+r.r,r.y=t.y)}function BY(e,t){var r=e.r+t.r-1e-6,n=t.x-e.x,i=t.y-e.y;return r>0&&r*r>n*n+i*i}function NY(e){var t=e._,r=e.next._,n=t.r+r.r,i=(t.x*r.r+r.x*t.r)/n,a=(t.y*r.r+r.y*t.r)/n;return i*i+a*a}function mA(e){this._=e,this.next=null,this.previous=null}function Qct(e){if(!(i=(e=_Te(e)).length))return 0;var t,r,n,i,a,o,s,l,u,c,f;if(t=e[0],t.x=0,t.y=0,!(i>1))return t.r;if(r=e[1],t.x=-r.r,r.x=t.r,r.y=0,!(i>2))return t.r+r.r;FY(r,t,n=e[2]),t=new mA(t),r=new mA(r),n=new mA(n),t.next=n.previous=r,r.next=t.previous=n,n.next=r.previous=t;t:for(s=3;s<i;++s){FY(t._,r._,n=e[s]),n=new mA(n),l=r.next,u=t.previous,c=r._.r,f=t._.r;do if(c<=f){if(BY(l._,n._)){r=l,t.next=r,r.previous=t,--s;continue t}c+=l._.r,l=l.next}else{if(BY(u._,n._)){t=u,t.next=r,r.previous=t,--s;continue t}f+=u._.r,u=u.previous}while(l!==u.next);for(n.previous=t,n.next=r,t.next=r.previous=r=n,a=NY(t);(n=n.next)!==r;)(o=NY(n))<a&&(t=n,a=o);r=t.next}for(t=[r._],n=r;(n=n.next)!==r;)t.push(n._);for(n=Zct(t),s=0;s<i;++s)t=e[s],t.x-=n.x,t.y-=n.y;return n.r}function CTe(e){return Qct(e),e}function STe(e){return e==null?null:VR(e)}function VR(e){if(typeof e!="function")throw new Error;return e}function xy(){return 0}function G1(e){return function(){return e}}function TTe(e){return Math.sqrt(e.value)}function Jct(){var e=null,t=1,r=1,n=xy;function i(a){return a.x=t/2,a.y=r/2,e?a.eachBefore(kY(e)).eachAfter(FP(n,.5)).eachBefore(zY(1)):a.eachBefore(kY(TTe)).eachAfter(FP(xy,1)).eachAfter(FP(n,a.r/Math.min(t,r))).eachBefore(zY(Math.min(t,r)/(2*a.r))),a}return i.radius=function(a){return arguments.length?(e=STe(a),i):e},i.size=function(a){return arguments.length?(t=+a[0],r=+a[1],i):[t,r]},i.padding=function(a){return arguments.length?(n=typeof a=="function"?a:G1(+a),i):n},i}function kY(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function FP(e,t){return function(r){if(n=r.children){var n,i,a=n.length,o=e(r)*t||0,s;if(o)for(i=0;i<a;++i)n[i].r+=o;if(s=Qct(n),o)for(i=0;i<a;++i)n[i].r-=o;r.r=s+o}}}function zY(e){return function(t){var r=t.parent;t.r*=e,r&&(t.x=r.x+e*t.x,t.y=r.y+e*t.y)}}function tht(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function s2(e,t,r,n,i){for(var a=e.children,o,s=-1,l=a.length,u=e.value&&(n-t)/e.value;++s<l;)o=a[s],o.y0=r,o.y1=i,o.x0=t,o.x1=t+=o.value*u}function eht(){var e=1,t=1,r=0,n=!1;function i(o){var s=o.height+1;return o.x0=o.y0=r,o.x1=e,o.y1=t/s,o.eachBefore(a(t,s)),n&&o.eachBefore(tht),o}function a(o,s){return function(l){l.children&&s2(l,l.x0,o*(l.depth+1)/s,l.x1,o*(l.depth+2)/s);var u=l.x0,c=l.y0,f=l.x1-r,d=l.y1-r;f<u&&(u=f=(u+f)/2),d<c&&(c=d=(c+d)/2),l.x0=u,l.y0=c,l.x1=f,l.y1=d}}return i.round=function(o){return arguments.length?(n=!!o,i):n},i.size=function(o){return arguments.length?(e=+o[0],t=+o[1],i):[e,t]},i.padding=function(o){return arguments.length?(r=+o,i):r},i}var ATe={depth:-1},UY={};function MTe(e){return e.id}function RTe(e){return e.parentId}function ITe(){var e=MTe,t=RTe;function r(n){var i=Array.from(n),a=i.length,o,s,l,u,c,f,d,v=new Map;for(s=0;s<a;++s)o=i[s],c=i[s]=new cb(o),(f=e(o,s,n))!=null&&(f+="")&&(d=c.id=f,v.set(d,v.has(d)?UY:c)),(f=t(o,s,n))!=null&&(f+="")&&(c.parent=f);for(s=0;s<a;++s)if(c=i[s],f=c.parent){if(u=v.get(f),!u)throw new Error("missing: "+f);if(u===UY)throw new Error("ambiguous: "+f);u.children?u.children.push(c):u.children=[c],c.parent=u}else{if(l)throw new Error("multiple roots");l=c}if(!l)throw new Error("no root");if(l.parent=ATe,l.eachBefore(function(g){g.depth=g.parent.depth+1,--a}).eachBefore(Yct),l.parent=null,a>0)throw new Error("cycle");return l}return r.id=function(n){return arguments.length?(e=VR(n),r):e},r.parentId=function(n){return arguments.length?(t=VR(n),r):t},r}function LTe(e,t){return e.parent===t.parent?1:2}function BP(e){var t=e.children;return t?t[0]:e.t}function NP(e){var t=e.children;return t?t[t.length-1]:e.t}function OTe(e,t,r){var n=r/(t.i-e.i);t.c-=n,t.s+=r,e.c+=n,t.z+=r,t.m+=r}function PTe(e){for(var t=0,r=0,n=e.children,i=n.length,a;--i>=0;)a=n[i],a.z+=t,a.m+=t,t+=a.s+(r+=a.c)}function DTe(e,t,r){return e.a.parent===t.parent?e.a:r}function QA(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}QA.prototype=Object.create(cb.prototype);function FTe(e){for(var t=new QA(e,0),r,n=[t],i,a,o,s;r=n.pop();)if(a=r._.children)for(r.children=new Array(s=a.length),o=s-1;o>=0;--o)n.push(i=r.children[o]=new QA(a[o],o)),i.parent=r;return(t.parent=new QA(null,0)).children=[t],t}function BTe(){var e=LTe,t=1,r=1,n=null;function i(u){var c=FTe(u);if(c.eachAfter(a),c.parent.m=-c.z,c.eachBefore(o),n)u.eachBefore(l);else{var f=u,d=u,v=u;u.eachBefore(function(A){A.x<f.x&&(f=A),A.x>d.x&&(d=A),A.depth>v.depth&&(v=A)});var g=f===d?1:e(f,d)/2,x=g-f.x,w=t/(d.x+g+x),S=r/(v.depth||1);u.eachBefore(function(A){A.x=(A.x+x)*w,A.y=A.depth*S})}return u}function a(u){var c=u.children,f=u.parent.children,d=u.i?f[u.i-1]:null;if(c){PTe(u);var v=(c[0].z+c[c.length-1].z)/2;d?(u.z=d.z+e(u._,d._),u.m=u.z-v):u.z=v}else d&&(u.z=d.z+e(u._,d._));u.parent.A=s(u,d,u.parent.A||f[0])}function o(u){u._.x=u.z+u.parent.m,u.m+=u.parent.m}function s(u,c,f){if(c){for(var d=u,v=u,g=c,x=d.parent.children[0],w=d.m,S=v.m,A=g.m,M=x.m,R;g=NP(g),d=BP(d),g&&d;)x=BP(x),v=NP(v),v.a=u,R=g.z+A-d.z-w+e(g._,d._),R>0&&(OTe(DTe(g,u,f),u,R),w+=R,S+=R),A+=g.m,w+=d.m,M+=x.m,S+=v.m;g&&!NP(v)&&(v.t=g,v.m+=A-S),d&&!BP(x)&&(x.t=d,x.m+=w-M,f=u)}return f}function l(u){u.x*=t,u.y=u.depth*r}return i.separation=function(u){return arguments.length?(e=u,i):e},i.size=function(u){return arguments.length?(n=!1,t=+u[0],r=+u[1],i):n?null:[t,r]},i.nodeSize=function(u){return arguments.length?(n=!0,t=+u[0],r=+u[1],i):n?[t,r]:null},i}function oL(e,t,r,n,i){for(var a=e.children,o,s=-1,l=a.length,u=e.value&&(i-r)/e.value;++s<l;)o=a[s],o.x0=t,o.x1=n,o.y0=r,o.y1=r+=o.value*u}var rht=(1+Math.sqrt(5))/2;function nht(e,t,r,n,i,a){for(var o=[],s=t.children,l,u,c=0,f=0,d=s.length,v,g,x=t.value,w,S,A,M,R,O,N;c<d;){v=i-r,g=a-n;do w=s[f++].value;while(!w&&f<d);for(S=A=w,O=Math.max(g/v,v/g)/(x*e),N=w*w*O,R=Math.max(A/N,N/S);f<d;++f){if(w+=u=s[f].value,u<S&&(S=u),u>A&&(A=u),N=w*w*O,M=Math.max(A/N,N/S),M>R){w-=u;break}R=M}o.push(l={value:w,dice:v<g,children:s.slice(c,f)}),l.dice?s2(l,r,n,i,x?n+=g*w/x:a):oL(l,r,n,x?r+=v*w/x:i,a),x-=w,c=f}return o}const iht=function e(t){function r(n,i,a,o,s){nht(t,n,i,a,o,s)}return r.ratio=function(n){return e((n=+n)>1?n:1)},r}(rht);function aht(){var e=iht,t=!1,r=1,n=1,i=[0],a=xy,o=xy,s=xy,l=xy,u=xy;function c(d){return d.x0=d.y0=0,d.x1=r,d.y1=n,d.eachBefore(f),i=[0],t&&d.eachBefore(tht),d}function f(d){var v=i[d.depth],g=d.x0+v,x=d.y0+v,w=d.x1-v,S=d.y1-v;w<g&&(g=w=(g+w)/2),S<x&&(x=S=(x+S)/2),d.x0=g,d.y0=x,d.x1=w,d.y1=S,d.children&&(v=i[d.depth+1]=a(d)/2,g+=u(d)-v,x+=o(d)-v,w-=s(d)-v,S-=l(d)-v,w<g&&(g=w=(g+w)/2),S<x&&(x=S=(x+S)/2),e(d,g,x,w,S))}return c.round=function(d){return arguments.length?(t=!!d,c):t},c.size=function(d){return arguments.length?(r=+d[0],n=+d[1],c):[r,n]},c.tile=function(d){return arguments.length?(e=VR(d),c):e},c.padding=function(d){return arguments.length?c.paddingInner(d).paddingOuter(d):c.paddingInner()},c.paddingInner=function(d){return arguments.length?(a=typeof d=="function"?d:G1(+d),c):a},c.paddingOuter=function(d){return arguments.length?c.paddingTop(d).paddingRight(d).paddingBottom(d).paddingLeft(d):c.paddingTop()},c.paddingTop=function(d){return arguments.length?(o=typeof d=="function"?d:G1(+d),c):o},c.paddingRight=function(d){return arguments.length?(s=typeof d=="function"?d:G1(+d),c):s},c.paddingBottom=function(d){return arguments.length?(l=typeof d=="function"?d:G1(+d),c):l},c.paddingLeft=function(d){return arguments.length?(u=typeof d=="function"?d:G1(+d),c):u},c}function NTe(e,t,r,n,i){var a=e.children,o,s=a.length,l,u=new Array(s+1);for(u[0]=l=o=0;o<s;++o)u[o+1]=l+=a[o].value;c(0,s,e.value,t,r,n,i);function c(f,d,v,g,x,w,S){if(f>=d-1){var A=a[f];A.x0=g,A.y0=x,A.x1=w,A.y1=S;return}for(var M=u[f],R=v/2+M,O=f+1,N=d-1;O<N;){var k=O+N>>>1;u[k]<R?O=k+1:N=k}R-u[O-1]<u[O]-R&&f+1<O&&--O;var V=u[O]-M,Q=v-V;if(w-g>S-x){var Y=v?(g*Q+w*V)/v:w;c(f,O,V,g,x,Y,S),c(O,d,Q,Y,x,w,S)}else{var X=v?(x*Q+S*V)/v:S;c(f,O,V,g,x,w,X),c(O,d,Q,g,X,w,S)}}}function kTe(e,t,r,n,i){(e.depth&1?oL:s2)(e,t,r,n,i)}const zTe=function e(t){function r(n,i,a,o,s){if((l=n._squarify)&&l.ratio===t)for(var l,u,c,f,d=-1,v,g=l.length,x=n.value;++d<g;){for(u=l[d],c=u.children,f=u.value=0,v=c.length;f<v;++f)u.value+=c[f].value;u.dice?s2(u,i,a,o,x?a+=(s-a)*u.value/x:s):oL(u,i,a,x?i+=(o-i)*u.value/x:o,s),x-=u.value}else n._squarify=l=nht(t,n,i,a,o,s),l.ratio=t}return r.ratio=function(n){return e((n=+n)>1?n:1)},r}(rht),$Y=Object.freeze(Object.defineProperty({__proto__:null,cluster:J2e,hierarchy:Wb,pack:Jct,packEnclose:Zct,packSiblings:CTe,partition:eht,stratify:ITe,tree:BTe,treemap:aht,treemapBinary:NTe,treemapDice:s2,treemapResquarify:zTe,treemapSlice:oL,treemapSliceDice:kTe,treemapSquarify:iht},Symbol.toStringTag,{value:"Module"}));var oht="nodeIndex",sht="childNodeCount",o8="nodeAncestor",kP="Invalid field: it must be a string!";function s8(e,t){var r=e.field,n=e.fields;if(nn(r))return r;if(ze(r))return console.warn(kP),r[0];if(console.warn("".concat(kP," will try to get fields instead.")),nn(n))return n;if(ze(n)&&n.length)return n[0];if(t)return t;throw new TypeError(kP)}function l8(e){var t=[];if(e&&e.each){var r,n;e.each(function(i){var a,o;i.parent!==r?(r=i.parent,n=0):n+=1;var s=Wl((((a=i.ancestors)===null||a===void 0?void 0:a.call(i))||[]).map(function(l){return t.find(function(u){return u.name===l.name})||l}),function(l){var u=l.depth;return u>0&&u<i.depth});i[o8]=s,i[sht]=((o=i.children)===null||o===void 0?void 0:o.length)||0,i[oht]=n,t.push(i)})}else e&&e.eachNode&&e.eachNode(function(i){t.push(i)});return t}var UTe={field:"value",as:["x","y","r"],sort:function(e,t){return t.value-e.value}};function $Te(e,t){t=Sa({},UTe,t);var r=t.as;if(!ze(r)||r.length!==3)throw new TypeError('Invalid as: it must be an array with 3 strings (e.g. [ "x", "y", "r" ])!');var n;try{n=s8(t)}catch(u){console.warn(u)}var i=function(u){return Jct().size(t.size).padding(t.padding)(Wb(u).sum(function(c){return c[n]}).sort(t.sort))},a=i(e),o=r[0],s=r[1],l=r[2];return a.each(function(u){u[o]=u.x,u[s]=u.y,u[l]=u.r}),l8(a)}function lht(e){var t=e.data,r=e.hierarchyConfig,n=e.rawFields,i=n===void 0?[]:n,a=e.enableDrillDown,o=$Te(t,U(U({},r),{field:"value",as:["x","y","r"]})),s=[];return o.forEach(function(l){for(var u,c=l.data.name,f=U({},l);f.depth>1;)c="".concat((u=f.parent.data)===null||u===void 0?void 0:u.name," / ").concat(c),f=f.parent;if(a&&l.depth>2)return null;var d=ge({},l.data,U(U(U({},xa(l.data,i)),{path:c}),l));d.ext=r,d[hS]={hierarchyConfig:r,rawFields:i,enableDrillDown:a},s.push(d)}),s}function uht(e,t,r){var n=X6([e,t]),i=n[0],a=n[1],o=n[2],s=n[3],l=r.width,u=r.height,c=l-(s+a),f=u-(i+o),d=Math.min(c,f),v=(c-d)/2,g=(f-d)/2,x=i+g,w=a+v,S=o+g,A=s+v,M=[x,w,S,A],R=d<0?0:d;return{finalPadding:M,finalSize:R}}function HTe(e){var t=e.chart,r=Math.min(t.viewBBox.width,t.viewBBox.height);return ge({options:{size:function(n){var i=n.r;return i*r}}},e)}function VTe(e){var t=e.options,r=e.chart,n=r.viewBBox,i=t.padding,a=t.appendPadding,o=t.drilldown,s=a;if(o!=null&&o.enabled){var l=Y3(r.appendPadding,xt(o,["breadCrumb","position"]));s=X6([l,a])}var u=uht(i,s,n).finalPadding;return r.padding=u,r.appendPadding=0,e}function GTe(e){var t=e.chart,r=e.options,n=t.padding,i=t.appendPadding,a=r.color,o=r.colorField,s=r.pointStyle,l=r.hierarchyConfig,u=r.sizeField,c=r.rawFields,f=c===void 0?[]:c,d=r.drilldown,v=lht({data:r.data,hierarchyConfig:l,enableDrillDown:d==null?void 0:d.enabled,rawFields:f});t.data(v);var g=t.viewBBox,x=uht(n,i,g).finalSize,w=function(S){var A=S.r;return A*x};return u&&(w=function(S){return S[u]*x}),jh(ge({},e,{options:{xField:"x",yField:"y",seriesField:o,sizeField:u,rawFields:an(an([],$2e,!0),f,!0),point:{color:a,style:s,shape:"circle",size:w}}})),e}function WTe(e){return Nn(ns({},{x:{min:0,max:1,minLimit:0,maxLimit:1,nice:!0},y:{min:0,max:1,minLimit:0,maxLimit:1,nice:!0}}))(e)}function XTe(e){var t=e.chart,r=e.options,n=r.tooltip;if(n===!1)t.tooltip(!1);else{var i=n;xt(n,"fields")||(i=ge({},{customItems:function(a){return a.map(function(o){var s=xt(t.getOptions(),"scales"),l=xt(s,["name","formatter"],function(c){return c}),u=xt(s,["value","formatter"],function(c){return c});return U(U({},o),{name:l(o.data.name),value:u(o.data.value)})})}},i)),t.tooltip(i)}return e}function jTe(e){var t=e.chart;return t.axis(!1),e}function YTe(e){var t=e.drilldown,r=e.interactions,n=r===void 0?[]:r;return t!=null&&t.enabled?ge({},e,{interactions:an(an([],n,!0),[{type:"drill-down",cfg:{drillDownConfig:t,transformData:lht,enableDrillDown:!0}}],!1)}):e}function ZTe(e){var t=e.chart,r=e.options;return _o({chart:t,options:YTe(r)}),e}function qTe(e){return Nn(Xh("pointStyle"),HTe,VTe,Ji,WTe,GTe,jTe,$b,XTe,ZTe,Aa,To())(e)}function HY(e){var t=xt(e,["event","data","data"],{});return ze(t.children)&&t.children.length>0}function VY(e){var t=e.view.getCoordinate(),r=t.innerRadius;if(r){var n=e.event,i=n.x,a=n.y,o=t.center,s=o.x,l=o.y,u=t.getRadius()*r,c=Math.sqrt(Math.pow(s-i,2)+Math.pow(l-a,2));return c<u}return!1}mn("drill-down-action",W2e);Yn("drill-down",{showEnable:[{trigger:"element:mouseenter",action:"cursor:pointer",isEnable:HY},{trigger:"element:mouseleave",action:"cursor:default"},{trigger:"element:mouseleave",action:"cursor:pointer",isEnable:VY}],start:[{trigger:"element:click",isEnable:HY,action:["drill-down-action:click"]},{trigger:"afterchangesize",action:["drill-down-action:resetPosition"]},{trigger:"click",isEnable:VY,action:["drill-down-action:back"]}]});(function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="circle-packing",r}return t.getDefaultOptions=function(){return H2e},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return qTe},t.prototype.triggerResize=function(){this.chart.destroyed||(this.chart.forceFit(),this.chart.clear(),this.execAdaptor(),this.chart.render(!0))},t})(Jn);var Yh="left-axes-view",Zh="right-axes-view",cht={nice:!0,label:{autoHide:!0,autoRotate:!1}},KTe=U(U({},cht),{position:"left"}),QTe=U(U({},cht),{position:"right",grid:null}),hb;(function(e){e.Left="Left",e.Right="Right"})(hb||(hb={}));var m_;(function(e){e.Line="line",e.Column="column"})(m_||(m_={}));function l5(e){return xt(e,"geometry")===m_.Line}function u8(e){return xt(e,"geometry")===m_.Column}function GY(e,t,r){return u8(r)?ge({},{geometry:m_.Column,label:r.label&&r.isRange?{content:function(n){var i;return(i=n[t])===null||i===void 0?void 0:i.join("-")}}:void 0},r):U({geometry:m_.Line},r)}function WY(e,t){var r=e[0],n=e[1];if(ze(t)){var i=t[0],a=t[1];return[i,a]}var o=xt(t,r),s=xt(t,n);return[o,s]}function XY(e,t){return t===hb.Left?e===!1?!1:ge({},KTe,e):t===hb.Right?e===!1?!1:ge({},QTe,e):e}function JTe(e){var t=e.options,r=e.chart,n=t.geometryOption,i=n.isStack,a=n.color,o=n.seriesField,s=n.groupField,l=n.isGroup,u=["xField","yField"];if(l5(n)){Hb(ge({},e,{options:U(U(U({},xa(t,u)),n),{line:{color:n.color,style:n.lineStyle}})})),jh(ge({},e,{options:U(U(U({},xa(t,u)),n),{point:n.point&&U({color:a,shape:"circle"},n.point)})}));var c=[];l&&c.push({type:"dodge",dodgeBy:s||o,customOffset:0}),i&&c.push({type:"stack"}),c.length&&ft(r.geometries,function(f){f.adjust(c)})}return u8(n)&&iL(ge({},e,{options:U(U(U({},xa(t,u)),n),{widthRatio:n.columnWidthRatio,interval:U(U({},xa(n,["color"])),{style:n.columnStyle})})})),e}function jY(e){var t=e.view,r=e.geometryOption,n=e.yField,i=e.legend,a=xt(i,"marker"),o=fu(t,l5(r)?"line":"interval");if(!r.seriesField){var s=xt(t,"options.scales.".concat(n,".alias"))||n,l=o.getAttribute("color"),u=t.getTheme().defaultColor;l&&(u=eh.getMappingValue(l,s,xt(l,["values",0],u)));var c=($r(a)?a:!Kc(a)&&ge({},{style:{stroke:u,fill:u}},a))||(l5(r)?{symbol:function(d,v,g){return[["M",d-g,v],["L",d+g,v]]},style:{lineWidth:2,r:6,stroke:u}}:{symbol:"square",style:{fill:u}});return[{value:n,name:s,marker:c,isGeometry:!0,viewId:t.id}]}var f=o.getGroupAttributes();return Fu(f,function(d,v){var g=eh.getLegendItems(t,o,v,t.getTheme(),a);return d.concat(g)},[])}var YY=function(e,t){var r=t[0],n=t[1],i=e.getOptions().data,a=e.getXScale(),o=_l(i);if(!(!a||!o)){var s=$d(i,a.field),l=s,u=_l(l),c=Math.floor(r*(u-1)),f=Math.floor(n*(u-1));e.filter(a.field,function(d){var v=l.indexOf(d);return v>-1?CEe(v,c,f):!0}),e.getRootView().render(!0)}};function tAe(e){var t,r=e.options,n=r.geometryOptions,i=n===void 0?[]:n,a=r.xField,o=r.yField,s=D4(i,function(l){var u=l.geometry;return u===m_.Line||u===void 0});return ge({},{options:{geometryOptions:[],meta:(t={},t[a]={type:"cat",sync:!0,range:s?[0,1]:void 0},t),tooltip:{showMarkers:s,showCrosshairs:s,shared:!0,crosshairs:{type:"x"}},interactions:s?[{type:"legend-visible-filter"}]:[{type:"legend-visible-filter"},{type:"active-region"}],legend:{position:"top-left"}}},e,{options:{yAxis:WY(o,r.yAxis),geometryOptions:[GY(a,o[0],i[0]),GY(a,o[1],i[1])],annotations:WY(o,r.annotations)}})}function eAe(e){var t,r,n=e.chart,i=e.options,a=i.geometryOptions,o={line:0,column:1},s=[{type:(t=a[0])===null||t===void 0?void 0:t.geometry,id:Yh},{type:(r=a[1])===null||r===void 0?void 0:r.geometry,id:Zh}];return s.sort(function(l,u){return-o[l.type]+o[u.type]}).forEach(function(l){return n.createView({id:l.id})}),e}function rAe(e){var t=e.chart,r=e.options,n=r.xField,i=r.yField,a=r.geometryOptions,o=r.data,s=r.tooltip,l=[U(U({},a[0]),{id:Yh,data:o[0],yField:i[0]}),U(U({},a[1]),{id:Zh,data:o[1],yField:i[1]})];return l.forEach(function(u){var c=u.id,f=u.data,d=u.yField,v=u8(u)&&u.isPercent,g=v?zut(f,d,n,d):f,x=yi(t,c).data(g),w=v?U({formatter:function(S){return{name:S[u.seriesField]||d,value:(Number(S[d])*100).toFixed(2)+"%"}}},s):s;JTe({chart:x,options:{xField:n,yField:d,tooltip:w,geometryOption:u}})}),e}function nAe(e){var t,r=e.chart,n=e.options,i=n.geometryOptions,a=((t=r.getTheme())===null||t===void 0?void 0:t.colors10)||[],o=0;return r.once("beforepaint",function(){ft(i,function(s,l){var u=yi(r,l===0?Yh:Zh);if(!s.color){var c=u.getGroupScales(),f=xt(c,[0,"values","length"],1),d=a.slice(o,o+f).concat(l===0?[]:a);u.geometries.forEach(function(v){s.seriesField?v.color(s.seriesField,d):v.color(d[0])}),o+=f}}),r.render(!0)}),e}function iAe(e){var t,r,n=e.chart,i=e.options,a=i.xAxis,o=i.yAxis,s=i.xField,l=i.yField;return ns((t={},t[s]=a,t[l[0]]=o[0],t))(ge({},e,{chart:yi(n,Yh)})),ns((r={},r[s]=a,r[l[1]]=o[1],r))(ge({},e,{chart:yi(n,Zh)})),e}function aAe(e){var t=e.chart,r=e.options,n=yi(t,Yh),i=yi(t,Zh),a=r.xField,o=r.yField,s=r.xAxis,l=r.yAxis;return t.axis(a,!1),t.axis(o[0],!1),t.axis(o[1],!1),n.axis(a,s),n.axis(o[0],XY(l[0],hb.Left)),i.axis(a,!1),i.axis(o[1],XY(l[1],hb.Right)),e}function oAe(e){var t=e.chart,r=e.options,n=r.tooltip,i=yi(t,Yh),a=yi(t,Zh);return t.tooltip(n),i.tooltip({shared:!0}),a.tooltip({shared:!0}),e}function sAe(e){var t=e.chart;return _o(ge({},e,{chart:yi(t,Yh)})),_o(ge({},e,{chart:yi(t,Zh)})),e}function lAe(e){var t=e.chart,r=e.options,n=r.annotations,i=xt(n,[0]),a=xt(n,[1]);return To(i)(ge({},e,{chart:yi(t,Yh),options:{annotations:i}})),To(a)(ge({},e,{chart:yi(t,Zh),options:{annotations:a}})),e}function uAe(e){var t=e.chart;return Ji(ge({},e,{chart:yi(t,Yh)})),Ji(ge({},e,{chart:yi(t,Zh)})),Ji(e),e}function cAe(e){var t=e.chart;return Aa(ge({},e,{chart:yi(t,Yh)})),Aa(ge({},e,{chart:yi(t,Zh)})),e}function hAe(e){var t=e.chart,r=e.options,n=r.yAxis;return g_(ge({},e,{chart:yi(t,Yh),options:{yAxis:n[0]}})),g_(ge({},e,{chart:yi(t,Zh),options:{yAxis:n[1]}})),e}function fAe(e){var t=e.chart,r=e.options,n=r.legend,i=r.geometryOptions,a=r.yField,o=r.data,s=yi(t,Yh),l=yi(t,Zh);if(n===!1)t.legend(!1);else if(qi(n)&&n.custom===!0)t.legend(n);else{var u=xt(i,[0,"legend"],n),c=xt(i,[1,"legend"],n);t.once("beforepaint",function(){var f=o[0].length?jY({view:s,geometryOption:i[0],yField:a[0],legend:u}):[],d=o[1].length?jY({view:l,geometryOption:i[1],yField:a[1],legend:c}):[];t.legend(ge({},n,{custom:!0,items:f.concat(d)}))}),i[0].seriesField&&s.legend(i[0].seriesField,u),i[1].seriesField&&l.legend(i[1].seriesField,c),t.on("legend-item:click",function(f){var d=xt(f,"gEvent.delegateObject",{});if(d&&d.item){var v=d.item,g=v.value,x=v.isGeometry,w=v.viewId;if(x){var S=ptt(a,function(R){return R===g});if(S>-1){var A=xt(yi(t,w),"geometries");ft(A,function(R){R.changeVisible(!d.item.unchecked)})}}else{var M=xt(t.getController("legend"),"option.items",[]);ft(t.views,function(R){var O=R.getGroupScales();ft(O,function(N){N.values&&N.values.indexOf(g)>-1&&R.filter(N.field,function(k){var V=Bd(M,function(Q){return Q.value===k});return!V.unchecked})}),t.render(!0)})}}})}return e}function dAe(e){var t=e.chart,r=e.options,n=r.slider,i=yi(t,Yh),a=yi(t,Zh);return n&&(i.option("slider",n),i.on("slider:valuechanged",function(o){var s=o.event,l=s.value,u=s.originValue;zi(l,u)||YY(a,l)}),t.once("afterpaint",function(){if(!Ym(n)){var o=n.start,s=n.end;(o||s)&&YY(a,[o,s])}})),e}function pAe(e){return Nn(tAe,eAe,uAe,rAe,iAe,aAe,hAe,oAe,sAe,lAe,cAe,nAe,fAe,dAe)(e)}var vAe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="dual-axes",r}return t.prototype.getDefaultOptions=function(){return ge({},e.prototype.getDefaultOptions.call(this),{yAxis:[],syncViewPadding:!0})},t.prototype.getSchemaAdaptor=function(){return pAe},t}(Jn);const nLe=Object.freeze(Object.defineProperty({__proto__:null,DualAxes:vAe},Symbol.toStringTag,{value:"Module"}));function gAe(e,t){var r=t.data,n=t.coordinate,i=t.interactions,a=t.annotations,o=t.animation,s=t.tooltip,l=t.axes,u=t.meta,c=t.geometries;r&&e.data(r);var f={};l&&ft(l,function(d,v){f[v]=xa(d,Wc)}),f=ge({},u,f),e.scale(f),n&&e.coordinate(n),l===!1?e.axis(!1):ft(l,function(d,v){e.axis(v,d)}),ft(c,function(d){var v=ah({chart:e,options:d}).ext,g=d.adjust;g&&v.geometry.adjust(g)}),ft(i,function(d){d.enable===!1?e.removeInteraction(d.type):e.interaction(d.type,d.cfg)}),ft(a,function(d){e.annotation()[d.type](U({},d))}),r2(e,o),s?(e.interaction("tooltip"),e.tooltip(s)):s===!1&&e.removeInteraction("tooltip")}function mAe(e){var t=e.chart,r=e.options,n=r.type,i=r.data,a=r.fields,o=r.eachView,s=CI(r,["type","data","fields","eachView","axes","meta","tooltip","coordinate","theme","legend","interactions","annotations"]);return t.data(i),t.facet(n,U(U({},s),{fields:a,eachView:function(l,u){var c=o(l,u);if(c.geometries)gAe(l,c);else{var f=c,d=f.options;d.tooltip&&l.interaction("tooltip"),s5(f.type,l,d)}}})),e}function yAe(e){var t=e.chart,r=e.options,n=r.axes,i=r.meta,a=r.tooltip,o=r.coordinate,s=r.theme,l=r.legend,u=r.interactions,c=r.annotations,f={};return n&&ft(n,function(d,v){f[v]=xa(d,Wc)}),f=ge({},i,f),t.scale(f),t.coordinate(o),n?ft(n,function(d,v){t.axis(v,d)}):t.axis(!1),a?(t.interaction("tooltip"),t.tooltip(a)):a===!1&&t.removeInteraction("tooltip"),t.legend(l),s&&t.theme(s),ft(u,function(d){d.enable===!1?t.removeInteraction(d.type):t.interaction(d.type,d.cfg)}),ft(c,function(d){t.annotation()[d.type](U({},d))}),e}function _Ae(e){return Nn(Ji,mAe,yAe)(e)}var xAe={title:{style:{fontSize:12,fill:"rgba(0,0,0,0.65)"}},rowTitle:{style:{fontSize:12,fill:"rgba(0,0,0,0.65)"}},columnTitle:{style:{fontSize:12,fill:"rgba(0,0,0,0.65)"}}};(function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="area",r}return t.getDefaultOptions=function(){return xAe},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return _Ae},t})(Jn);function bAe(e){var t=e.chart,r=e.options,n=r.data,i=r.type,a=r.xField,o=r.yField,s=r.colorField,l=r.sizeField,u=r.sizeRatio,c=r.shape,f=r.color,d=r.tooltip,v=r.heatmapStyle,g=r.meta;t.data(n);var x="polygon";i==="density"&&(x="heatmap");var w=rd(d,[a,o,s]),S=w.fields,A=w.formatter,M=1;return(u||u===0)&&(!c&&!l?console.warn("sizeRatio is not in effect: Must define shape or sizeField first"):u<0||u>1?console.warn("sizeRatio is not in effect: It must be a number in [0,1]"):M=u),ah(ge({},e,{options:{type:x,colorField:s,tooltipFields:S,shapeField:l||"",label:void 0,mapping:{tooltip:A,shape:c&&(l?function(R){var O=n.map(function(Q){return Q[l]}),N=(g==null?void 0:g[l])||{},k=N.min,V=N.max;return k=Gn(k)?k:Math.min.apply(Math,O),V=Gn(V)?V:Math.max.apply(Math,O),[c,(xt(R,l)-k)/(V-k),M]}:function(){return[c,1,M]}),color:f||s&&t.getTheme().sequenceColors.join("-"),style:v}}})),e}function EAe(e){var t,r=e.options,n=r.xAxis,i=r.yAxis,a=r.xField,o=r.yField;return Nn(ns((t={},t[a]=n,t[o]=i,t)))(e)}function wAe(e){var t=e.chart,r=e.options,n=r.xAxis,i=r.yAxis,a=r.xField,o=r.yField;return n===!1?t.axis(a,!1):t.axis(a,n),i===!1?t.axis(o,!1):t.axis(o,i),e}function CAe(e){var t=e.chart,r=e.options,n=r.legend,i=r.colorField,a=r.sizeField,o=r.sizeLegend,s=n!==!1;return i&&t.legend(i,s?n:!1),a&&t.legend(a,o===void 0?n:o),!s&&!o&&t.legend(!1),e}function SAe(e){var t=e.chart,r=e.options,n=r.label,i=r.colorField,a=r.type,o=fu(t,a==="density"?"heatmap":"polygon");if(!n)o.label(!1);else if(i){var s=n.callback,l=hi(n,["callback"]);o.label({fields:[i],callback:s,cfg:wl(l)})}return e}function TAe(e){var t,r,n=e.chart,i=e.options,a=i.coordinate,o=i.reflect,s=ge({actions:[]},a??{type:"rect"});return o&&((r=(t=s.actions)===null||t===void 0?void 0:t.push)===null||r===void 0||r.call(t,["reflect",o])),n.coordinate(s),e}function AAe(e){return Nn(Ji,Xh("heatmapStyle"),EAe,TAe,bAe,wAe,CAe,nl,SAe,To(),_o,Aa,w0)(e)}var MAe=ge({},Jn.getDefaultOptions(),{type:"polygon",legend:!1,coordinate:{type:"rect"},xAxis:{tickLine:null,line:null,grid:{alignTick:!1,line:{style:{lineWidth:1,lineDash:null,stroke:"#f0f0f0"}}}},yAxis:{grid:{alignTick:!1,line:{style:{lineWidth:1,lineDash:null,stroke:"#f0f0f0"}}}}});ca("polygon","circle",{draw:function(e,t){var r,n,i=e.x,a=e.y,o=this.parsePoints(e.points),s=Math.abs(o[2].x-o[1].x),l=Math.abs(o[1].y-o[0].y),u=Math.min(s,l)/2,c=Number(e.shape[1]),f=Number(e.shape[2]),d=Math.sqrt(f),v=u*d*Math.sqrt(c),g=((r=e.style)===null||r===void 0?void 0:r.fill)||e.color||((n=e.defaultStyle)===null||n===void 0?void 0:n.fill),x=t.addShape("circle",{attrs:U(U(U({x:i,y:a,r:v},e.defaultStyle),e.style),{fill:g})});return x}});ca("polygon","square",{draw:function(e,t){var r,n,i=e.x,a=e.y,o=this.parsePoints(e.points),s=Math.abs(o[2].x-o[1].x),l=Math.abs(o[1].y-o[0].y),u=Math.min(s,l),c=Number(e.shape[1]),f=Number(e.shape[2]),d=Math.sqrt(f),v=u*d*Math.sqrt(c),g=((r=e.style)===null||r===void 0?void 0:r.fill)||e.color||((n=e.defaultStyle)===null||n===void 0?void 0:n.fill),x=t.addShape("rect",{attrs:U(U(U({x:i-v/2,y:a-v/2,width:v,height:v},e.defaultStyle),e.style),{fill:g})});return x}});var RAe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="heatmap",r}return t.getDefaultOptions=function(){return MAe},t.prototype.getSchemaAdaptor=function(){return AAe},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t}(Jn);const iLe=Object.freeze(Object.defineProperty({__proto__:null,Heatmap:RAe},Symbol.toStringTag,{value:"Module"}));var IAe="liquid";function hht(e){return[{percent:e,type:IAe}]}function LAe(e){var t=e.chart,r=e.options,n=r.percent,i=r.liquidStyle,a=r.radius,o=r.outline,s=r.wave,l=r.shape,u=r.shapeStyle,c=r.animation;t.scale({percent:{min:0,max:1}}),t.data(hht(n));var f=r.color||t.getTheme().defaultColor,d=ge({},e,{options:{xField:"type",yField:"percent",widthRatio:a,interval:{color:f,style:i,shape:"liquid-fill-gauge"}}}),v=du(d).ext,g=v.geometry,x=t.getTheme().background,w={percent:n,radius:a,outline:o,wave:s,shape:l,shapeStyle:u,background:x,animation:c};return g.customInfo(w),t.legend(!1),t.axis(!1),t.tooltip(!1),e}function fht(e,t){var r=e.chart,n=e.options,i=n.statistic,a=n.percent,o=n.meta;r.getController("annotation").clear(!0);var s=xt(o,["percent","formatter"])||function(u){return"".concat((u*100).toFixed(2),"%")},l=i.content;return l&&(l=ge({},l,{content:ke(l.content)?s(a):l.content})),Z3(r,{statistic:U(U({},i),{content:l}),plotType:"liquid"},{percent:a}),t&&r.render(!0),e}function OAe(e){return Nn(Ji,Xh("liquidStyle"),LAe,fht,ns({}),Aa,_o)(e)}var PAe={radius:.9,statistic:{title:!1,content:{style:{opacity:.75,fontSize:"30px",lineHeight:"30px",textAlign:"center"}}},outline:{border:2,distance:0},wave:{count:3,length:192},shape:"circle"},ZY=5e3;function qY(e,t,r){return e+(t-e)*r}function DAe(e){var t=U({opacity:1},e.style);return e.color&&!t.fill&&(t.fill=e.color),t}function FAe(e){var t={fill:"#fff",fillOpacity:0,lineWidth:4},r=Sa({},t,e.style);return e.color&&!r.stroke&&(r.stroke=e.color),Gn(e.opacity)&&(r.opacity=r.strokeOpacity=e.opacity),r}function BAe(e,t,r,n){return t===0?[[e+1/2*r/Math.PI/2,n/2],[e+1/2*r/Math.PI,n],[e+r/4,n]]:t===1?[[e+1/2*r/Math.PI/2*(Math.PI-2),n],[e+1/2*r/Math.PI/2*(Math.PI-1),n/2],[e+r/4,0]]:t===2?[[e+1/2*r/Math.PI/2,-n/2],[e+1/2*r/Math.PI,-n],[e+r/4,-n]]:[[e+1/2*r/Math.PI/2*(Math.PI-2),-n],[e+1/2*r/Math.PI/2*(Math.PI-1),-n/2],[e+r/4,0]]}function NAe(e,t,r,n,i,a,o){for(var s=Math.ceil(2*e/r*4)*4,l=[],u=n;u<-Math.PI*2;)u+=Math.PI*2;for(;u>0;)u-=Math.PI*2;u=u/Math.PI/2*r;var c=a-e+u-e*2;l.push(["M",c,t]);for(var f=0,d=0;d<s;++d){var v=d%4,g=BAe(d*r/4,v,r,i);l.push(["C",g[0][0]+c,-g[0][1]+t,g[1][0]+c,-g[1][1]+t,g[2][0]+c,-g[2][1]+t]),d===s-1&&(f=g[2][0])}return l.push(["L",f+c,o+e]),l.push(["L",c,o+e]),l.push(["Z"]),l}function dht(e,t,r,n,i,a,o,s,l,u){for(var c=i.fill,f=i.opacity,d=o.getBBox(),v=d.maxX-d.minX,g=d.maxY-d.minY,x=0;x<n;x++){var w=n<=1?1:x/(n-1),S=a.addShape("path",{name:"waterwave-path",attrs:{path:NAe(s,d.minY+g*r,l,0,v/32,e,t),fill:c,opacity:qY(.2,.9,w)*f}});try{if(u===!1)return;var A=o5([["t",l,0]]);S.stopAnimate(),S.animate({matrix:A},{duration:qY(.5*ZY,ZY,w),repeat:!0})}catch{console.warn("off-screen group animate error!")}}}function kAe(e,t,r,n){var i=r*2/3,a=Math.max(i,n),o=i/2,s=e,l=o+t-a/2,u=Math.asin(o/((a-o)*.85)),c=Math.sin(u)*o,f=Math.cos(u)*o,d=s-f,v=l+c,g=e,x=l+o/Math.sin(u);return`
      M `.concat(d," ").concat(v,`
      A `).concat(o," ").concat(o," 0 1 1 ").concat(d+f*2," ").concat(v,`
      Q `).concat(g," ").concat(x," ").concat(e," ").concat(t+a/2,`
      Q `).concat(g," ").concat(x," ").concat(d," ").concat(v,`
      Z 
    `)}function zAe(e,t,r,n){var i=r/2,a=n/2;return`
      M `.concat(e," ").concat(t-a,` 
      a `).concat(i," ").concat(a," 0 1 0 0 ").concat(a*2,`
      a `).concat(i," ").concat(a," 0 1 0 0 ").concat(-a*2,`
      Z
    `)}function UAe(e,t,r,n){var i=n/2,a=r/2;return`
      M `.concat(e," ").concat(t-i,`
      L `).concat(e+a," ").concat(t,`
      L `).concat(e," ").concat(t+i,`
      L `).concat(e-a," ").concat(t,`
      Z
    `)}function $Ae(e,t,r,n){var i=n/2,a=r/2;return`
      M `.concat(e," ").concat(t-i,`
      L `).concat(e+a," ").concat(t+i,`
      L `).concat(e-a," ").concat(t+i,`
      Z
    `)}function HAe(e,t,r,n){var i=.618,a=n/2,o=r/2*i;return`
      M `.concat(e-o," ").concat(t-a,`
      L `).concat(e+o," ").concat(t-a,`
      L `).concat(e+o," ").concat(t+a,`
      L `).concat(e-o," ").concat(t+a,`
      Z
    `)}var KY={pin:kAe,circle:zAe,diamond:UAe,triangle:$Ae,rect:HAe};ca("interval","liquid-fill-gauge",{draw:function(e,t){var r=.5,n=.5,i=e.customInfo,a=i,o=a.percent,s=a.radius,l=a.shape,u=a.shapeStyle,c=a.background,f=a.animation,d=i.outline,v=i.wave,g=d.border,x=d.distance,w=v.count,S=v.length,A=Fu(e.points,function(Et,Tt){return Math.min(Et,Tt.x)},1/0),M=this.parsePoint({x:r,y:n}),R=this.parsePoint({x:A,y:n}),O=M.x-R.x,N=Math.min(O,R.y*s),k=DAe(e),V=FAe(Sa({},e,d)),Q=N-g/2,Y=typeof l=="function"?l:KY[l]||KY.circle,X=Y(M.x,M.y,Q*2,Q*2);if(u&&t.addShape("path",{name:"shape",attrs:U({path:X},u)}),o>0){var tt=t.addGroup({name:"waves"}),it=tt.setClip({type:"path",attrs:{path:X}});dht(M.x,M.y,1-e.points[1].y,w,k,tt,it,N*2,S,f)}return t.addShape("path",{name:"distance",attrs:{path:X,fill:"transparent",lineWidth:g+x*2,stroke:c==="transparent"?"#fff":c}}),t.addShape("path",{name:"wrap",attrs:Sa(V,{path:X,fill:"transparent",lineWidth:g})}),t}});var VAe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="liquid",r}return t.getDefaultOptions=function(){return PAe},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.changeData=function(r){this.chart.emit(di.BEFORE_CHANGE_DATA,So.fromData(this.chart,di.BEFORE_CHANGE_DATA,null)),this.updateOption({percent:r}),this.chart.data(hht(r)),fht({chart:this.chart,options:this.options},!0),this.chart.emit(di.AFTER_CHANGE_DATA,So.fromData(this.chart,di.AFTER_CHANGE_DATA,null))},t.prototype.getSchemaAdaptor=function(){return OAe},t}(Jn);const aLe=Object.freeze(Object.defineProperty({__proto__:null,Liquid:VAe,addWaterWave:dht},Symbol.toStringTag,{value:"Module"}));function GAe(e){var t=e.chart,r=e.options,n=r.data,i=r.lineStyle,a=r.color,o=r.point,s=r.area;t.data(n);var l=ge({},e,{options:{line:{style:i,color:a},point:o&&U({color:a},o),area:s&&U({color:a},s),label:void 0}}),u=ge({},l,{options:{tooltip:!1}}),c=(o==null?void 0:o.state)||r.state,f=ge({},l,{options:{tooltip:!1,state:c}});return Hb(l),jh(f),Q3(u),e}function WAe(e){var t,r=e.options,n=r.xAxis,i=r.yAxis,a=r.xField,o=r.yField;return Nn(ns((t={},t[a]=n,t[o]=i,t)))(e)}function XAe(e){var t=e.chart,r=e.options,n=r.radius,i=r.startAngle,a=r.endAngle;return t.coordinate("polar",{radius:n,startAngle:i,endAngle:a}),e}function jAe(e){var t=e.chart,r=e.options,n=r.xField,i=r.xAxis,a=r.yField,o=r.yAxis;return t.axis(n,i),t.axis(a,o),e}function YAe(e){var t=e.chart,r=e.options,n=r.label,i=r.yField,a=fu(t,"line");if(!n)a.label(!1);else{var o=n.fields,s=n.callback,l=hi(n,["fields","callback"]);a.label({fields:o||[i],callback:s,cfg:wl(l)})}return e}function ZAe(e){return Nn(GAe,WAe,Ji,XAe,jAe,$b,nl,YAe,_o,Aa,To())(e)}var qAe=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return Object.defineProperty(t.prototype,"name",{get:function(){return"radar-tooltip"},enumerable:!1,configurable:!0}),t.prototype.getTooltipItems=function(r){var n=this.getTooltipCfg(),i=n.shared,a=n.title,o=e.prototype.getTooltipItems.call(this,r);if(o.length>0){var s=this.view.geometries[0],l=s.dataArray,u=o[0].name,c=[];return l.forEach(function(f){f.forEach(function(d){var v=eh.getTooltipItems(d,s),g=v[0];if(!i&&g&&g.name===u){var x=ke(a)?u:a;c.push(U(U({},g),{name:g.title,title:x}))}else if(i&&g){var x=ke(a)?g.name||u:a;c.push(U(U({},g),{name:g.title,title:x}))}})}),c}return[]},t}(Mlt);P_("radar-tooltip",qAe);var KAe=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.init=function(){var r=this.context.view;r.removeInteraction("tooltip")},t.prototype.show=function(){var r=this.context.event,n=this.getTooltipController();n.showTooltip({x:r.x,y:r.y})},t.prototype.hide=function(){var r=this.getTooltipController();r.hideTooltip()},t.prototype.getTooltipController=function(){var r=this.context.view;return r.getController("radar-tooltip")},t}(to);mn("radar-tooltip",KAe);Yn("radar-tooltip",{start:[{trigger:"plot:mousemove",action:"radar-tooltip:show"}],end:[{trigger:"plot:mouseleave",action:"radar-tooltip:hide"}]});var QAe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="radar",r}return t.prototype.changeData=function(r){this.updateOption({data:r}),this.chart.changeData(r)},t.prototype.getDefaultOptions=function(){return ge({},e.prototype.getDefaultOptions.call(this),{xAxis:{label:{offset:15},grid:{line:{type:"line"}}},yAxis:{grid:{line:{type:"circle"}}},legend:{position:"top"},tooltip:{shared:!0,showCrosshairs:!0,showMarkers:!0,crosshairs:{type:"xy",line:{style:{stroke:"#565656",lineDash:[4]}},follow:!0}}})},t.prototype.getSchemaAdaptor=function(){return ZAe},t}(Jn);const oLe=Object.freeze(Object.defineProperty({__proto__:null,Radar:QAe},Symbol.toStringTag,{value:"Module"}));function JAe(e,t,r){var n=r.map(function(o){return o[t]}).filter(function(o){return o!==void 0}),i=n.length>0?Math.max.apply(Math,n):0,a=Math.abs(e)%360;return a?i*360/a:i}function tMe(e,t,r){var n=[];return e.forEach(function(i){var a=n.find(function(o){return o[t]===i[t]});a?a[r]+=i[r]||null:n.push(U({},i))}),n}function eMe(e){var t=e.chart,r=e.options,n=r.barStyle,i=r.color,a=r.tooltip,o=r.colorField,s=r.type,l=r.xField,u=r.yField,c=r.data,f=r.shape,d=lb(c,u);t.data(d);var v=ge({},e,{options:{tooltip:a,seriesField:o,interval:{style:n,color:i,shape:f||(s==="line"?"line":"intervel")},minColumnWidth:r.minBarWidth,maxColumnWidth:r.maxBarWidth,columnBackground:r.barBackground}});return du(v),s==="line"&&jh({chart:t,options:{xField:l,yField:u,seriesField:o,point:{shape:"circle",color:i}}}),e}function pht(e){var t,r=e.options,n=r.yField,i=r.xField,a=r.data,o=r.isStack,s=r.isGroup,l=r.colorField,u=r.maxAngle,c=o&&!s&&l?tMe(a,i,n):a,f=lb(c,n);return Nn(ns((t={},t[n]={min:0,max:JAe(u,n,f)},t)))(e)}function rMe(e){var t=e.chart,r=e.options,n=r.radius,i=r.innerRadius,a=r.startAngle,o=r.endAngle;return t.coordinate({type:"polar",cfg:{radius:n,innerRadius:i,startAngle:a,endAngle:o}}).transpose(),e}function nMe(e){var t=e.chart,r=e.options,n=r.xField,i=r.xAxis;return t.axis(n,i),e}function iMe(e){var t=e.chart,r=e.options,n=r.label,i=r.yField,a=fu(t,"interval");if(!n)a.label(!1);else{var o=n.callback,s=hi(n,["callback"]);a.label({fields:[i],callback:o,cfg:U(U({},wl(s)),{type:"polar"})})}return e}function aMe(e){return Nn(Xh("barStyle"),eMe,pht,nMe,rMe,_o,Aa,Ji,nl,$b,To(),iMe)(e)}var oMe=ge({},Jn.getDefaultOptions(),{interactions:[{type:"element-active"}],legend:!1,tooltip:{showMarkers:!1},xAxis:{grid:null,tickLine:null,line:null},maxAngle:240});(function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="radial-bar",r}return t.getDefaultOptions=function(){return oMe},t.prototype.changeData=function(r){this.updateOption({data:r}),pht({chart:this.chart,options:this.options}),this.chart.changeData(r)},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return aMe},t})(Jn);function sMe(e){var t=e.chart,r=e.options,n=r.data,i=r.sectorStyle,a=r.shape,o=r.color;return t.data(n),Nn(du)(ge({},e,{options:{marginRatio:1,interval:{style:i,color:o,shape:a}}})),e}function lMe(e){var t=e.chart,r=e.options,n=r.label,i=r.xField,a=fu(t,"interval");if(n===!1)a.label(!1);else if(qi(n)){var o=n.callback,s=n.fields,l=hi(n,["callback","fields"]),u=l.offset,c=l.layout;(u===void 0||u>=0)&&(c=c?ze(c)?c:[c]:[],l.layout=Wl(c,function(f){return f.type!=="limit-in-shape"}),l.layout.length||delete l.layout),a.label({fields:s||[i],callback:o,cfg:wl(l)})}else fg(Xd.WARN,n===null,"the label option must be an Object."),a.label({fields:[i]});return e}function uMe(e){var t=e.chart,r=e.options,n=r.legend,i=r.seriesField;return n===!1?t.legend(!1):i&&t.legend(i,n),e}function cMe(e){var t=e.chart,r=e.options,n=r.radius,i=r.innerRadius,a=r.startAngle,o=r.endAngle;return t.coordinate({type:"polar",cfg:{radius:n,innerRadius:i,startAngle:a,endAngle:o}}),e}function hMe(e){var t,r=e.options,n=r.xAxis,i=r.yAxis,a=r.xField,o=r.yField;return Nn(ns((t={},t[a]=n,t[o]=i,t)))(e)}function fMe(e){var t=e.chart,r=e.options,n=r.xAxis,i=r.yAxis,a=r.xField,o=r.yField;return n?t.axis(a,n):t.axis(a,!1),i?t.axis(o,i):t.axis(o,!1),e}function dMe(e){Nn(Xh("sectorStyle"),sMe,hMe,lMe,cMe,fMe,uMe,nl,_o,Aa,Ji,To(),w0)(e)}var pMe=ge({},Jn.getDefaultOptions(),{xAxis:!1,yAxis:!1,legend:{position:"right",radio:{}},sectorStyle:{stroke:"#fff",lineWidth:1},label:{layout:{type:"limit-in-shape"}},tooltip:{shared:!0,showMarkers:!1},interactions:[{type:"active-region"}]}),vMe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="rose",r}return t.getDefaultOptions=function(){return pMe},t.prototype.changeData=function(r){this.updateOption({data:r}),this.chart.changeData(r)},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return dMe},t}(Jn);const sLe=Object.freeze(Object.defineProperty({__proto__:null,Rose:vMe},Symbol.toStringTag,{value:"Module"}));var QY="x",JY="y",tZ="name",sL="nodes",lL="edges";function gMe(e,t,r){var n=[];return e.forEach(function(i){var a=i[t],o=i[r];n.includes(a)||n.push(a),n.includes(o)||n.push(o)}),n}function mMe(e,t,r,n){var i={};return t.forEach(function(a){i[a]={},t.forEach(function(o){i[a][o]=0})}),e.forEach(function(a){i[a[r]][a[n]]=1}),i}function yMe(e,t,r){if(!ze(e))return[];var n=[],i=gMe(e,t,r),a=mMe(e,i,t,r),o={};i.forEach(function(l){o[l]=0});function s(l){o[l]=1,i.forEach(function(u){if(a[l][u]!=0)if(o[u]==1)n.push("".concat(l,"_").concat(u));else{if(o[u]==-1)return;s(u)}}),o[l]=-1}return i.forEach(function(l){o[l]!=-1&&s(l)}),n.length!==0&&console.warn("sankey data contains circle, ".concat(n.length," records removed."),n),e.filter(function(l){return n.findIndex(function(u){return u==="".concat(l[t],"_").concat(l[r])})<0})}function _Me(e){return e.target.depth}function xMe(e){return e.depth}function bMe(e,t){return t-1-e.height}function c8(e,t){return e.sourceLinks.length?e.depth:t-1}function EMe(e){return e.targetLinks.length?e.depth:e.sourceLinks.length?gUt(e.sourceLinks,_Me)-1:0}function yA(e){return function(){return e}}function zP(e,t){for(var r=0,n=0;n<e.length;n++)r+=t(e[n]);return r}function UP(e,t){for(var r=-1/0,n=0;n<e.length;n++)r=Math.max(t(e[n]),r);return r}function wMe(e,t){for(var r=1/0,n=0;n<e.length;n++)r=Math.min(t(e[n]),r);return r}function eZ(e,t){return GR(e.source,t.source)||e.index-t.index}function rZ(e,t){return GR(e.target,t.target)||e.index-t.index}function GR(e,t){return e.y0-t.y0}function $P(e){return e.value}function CMe(e){return e.index}function SMe(e){return e.nodes}function TMe(e){return e.links}function nZ(e,t){var r=e.get(t);if(!r)throw new Error("missing: "+t);return r}function iZ(e){for(var t=e.nodes,r=0,n=t;r<n.length;r++){for(var i=n[r],a=i.y0,o=a,s=0,l=i.sourceLinks;s<l.length;s++){var u=l[s];u.y0=a+u.width/2,a+=u.width}for(var c=0,f=i.targetLinks;c<f.length;c++){var u=f[c];u.y1=o+u.width/2,o+=u.width}}}function AMe(){var e=0,t=0,r=1,n=1,i=24,a=8,o,s=CMe,l=c8,u,c,f,d=SMe,v=TMe,g=6;function x(pt){var kt={nodes:d(pt),links:v(pt)};return w(kt),S(kt),A(kt),M(kt),N(kt),iZ(kt),kt}x.update=function(pt){return iZ(pt),pt},x.nodeId=function(pt){return arguments.length?(s=typeof pt=="function"?pt:yA(pt),x):s},x.nodeAlign=function(pt){return arguments.length?(l=typeof pt=="function"?pt:yA(pt),x):l},x.nodeDepth=function(pt){return arguments.length?(u=pt,x):u},x.nodeSort=function(pt){return arguments.length?(c=pt,x):c},x.nodeWidth=function(pt){return arguments.length?(i=+pt,x):i},x.nodePadding=function(pt){return arguments.length?(a=o=+pt,x):a},x.nodes=function(pt){return arguments.length?(d=typeof pt=="function"?pt:yA(pt),x):d},x.links=function(pt){return arguments.length?(v=typeof pt=="function"?pt:yA(pt),x):v},x.linkSort=function(pt){return arguments.length?(f=pt,x):f},x.size=function(pt){return arguments.length?(e=t=0,r=+pt[0],n=+pt[1],x):[r-e,n-t]},x.extent=function(pt){return arguments.length?(e=+pt[0][0],r=+pt[1][0],t=+pt[0][1],n=+pt[1][1],x):[[e,t],[r,n]]},x.iterations=function(pt){return arguments.length?(g=+pt,x):g};function w(pt){var kt=pt.nodes,ae=pt.links;kt.forEach(function(De,Yr){De.index=Yr,De.sourceLinks=[],De.targetLinks=[]});var Kt=new Map(kt.map(function(De){return[s(De),De]}));if(ae.forEach(function(De,Yr){De.index=Yr;var Gr=De.source,Mn=De.target;typeof Gr!="object"&&(Gr=De.source=nZ(Kt,Gr)),typeof Mn!="object"&&(Mn=De.target=nZ(Kt,Mn)),Gr.sourceLinks.push(De),Mn.targetLinks.push(De)}),f!=null)for(var re=0,fe=kt;re<fe.length;re++){var Oe=fe[re],Ye=Oe.sourceLinks,Be=Oe.targetLinks;Ye.sort(f),Be.sort(f)}}function S(pt){for(var kt=pt.nodes,ae=0,Kt=kt;ae<Kt.length;ae++){var re=Kt[ae];re.value=re.fixedValue===void 0?Math.max(zP(re.sourceLinks,$P),zP(re.targetLinks,$P)):re.fixedValue}}function A(pt){for(var kt=pt.nodes,ae=kt.length,Kt=new Set(kt),re=new Set,fe=0;Kt.size;){if(Kt.forEach(function(De){De.depth=fe;for(var Yr=0,Gr=De.sourceLinks;Yr<Gr.length;Yr++){var Mn=Gr[Yr].target;re.add(Mn)}}),++fe>ae)throw new Error("circular link");Kt=re,re=new Set}if(u)for(var Oe=Math.max(UP(kt,function(De){return De.depth})+1,0),Ye=void 0,Be=0;Be<kt.length;Be++)Ye=kt[Be],Ye.depth=u.call(null,Ye,Oe)}function M(pt){for(var kt=pt.nodes,ae=kt.length,Kt=new Set(kt),re=new Set,fe=0;Kt.size;){if(Kt.forEach(function(Oe){Oe.height=fe;for(var Ye=0,Be=Oe.targetLinks;Ye<Be.length;Ye++){var De=Be[Ye].source;re.add(De)}}),++fe>ae)throw new Error("circular link");Kt=re,re=new Set}}function R(pt){for(var kt=pt.nodes,ae=Math.max(UP(kt,function(Mn){return Mn.depth})+1,0),Kt=(r-e-i)/(ae-1),re=new Array(ae).fill(0).map(function(){return[]}),fe=0,Oe=kt;fe<Oe.length;fe++){var Ye=Oe[fe],Be=Math.max(0,Math.min(ae-1,Math.floor(l.call(null,Ye,ae))));Ye.layer=Be,Ye.x0=e+Be*Kt,Ye.x1=Ye.x0+i,re[Be]?re[Be].push(Ye):re[Be]=[Ye]}if(c)for(var De=0,Yr=re;De<Yr.length;De++){var Gr=Yr[De];Gr.sort(c)}return re}function O(pt){for(var kt=wMe(pt,function(ee){return(n-t-(ee.length-1)*o)/zP(ee,$P)}),ae=0,Kt=pt;ae<Kt.length;ae++){for(var re=Kt[ae],fe=t,Oe=0,Ye=re;Oe<Ye.length;Oe++){var Be=Ye[Oe];Be.y0=fe,Be.y1=fe+Be.value*kt,fe=Be.y1+o;for(var De=0,Yr=Be.sourceLinks;De<Yr.length;De++){var Gr=Yr[De];Gr.width=Gr.value*kt}}fe=(n-fe+o)/(re.length+1);for(var Mn=0;Mn<re.length;++Mn){var Be=re[Mn];Be.y0+=fe*(Mn+1),Be.y1+=fe*(Mn+1)}it(re)}}function N(pt){var kt=R(pt);o=Math.min(a,(n-t)/(UP(kt,function(fe){return fe.length})-1)),O(kt);for(var ae=0;ae<g;++ae){var Kt=Math.pow(.99,ae),re=Math.max(1-Kt,(ae+1)/g);V(kt,Kt,re),k(kt,Kt,re)}}function k(pt,kt,ae){for(var Kt=1,re=pt.length;Kt<re;++Kt){for(var fe=pt[Kt],Oe=0,Ye=fe;Oe<Ye.length;Oe++){for(var Be=Ye[Oe],De=0,Yr=0,Gr=0,Mn=Be.targetLinks;Gr<Mn.length;Gr++){var ee=Mn[Gr],rr=ee.source,Nr=ee.value,Fe=Nr*(Be.layer-rr.layer);De+=Et(rr,Be)*Fe,Yr+=Fe}if(Yr>0){var Hr=(De/Yr-Be.y0)*kt;Be.y0+=Hr,Be.y1+=Hr,tt(Be)}}c===void 0&&fe.sort(GR),fe.length&&Q(fe,ae)}}function V(pt,kt,ae){for(var Kt=pt.length,re=Kt-2;re>=0;--re){for(var fe=pt[re],Oe=0,Ye=fe;Oe<Ye.length;Oe++){for(var Be=Ye[Oe],De=0,Yr=0,Gr=0,Mn=Be.sourceLinks;Gr<Mn.length;Gr++){var ee=Mn[Gr],rr=ee.target,Nr=ee.value,Fe=Nr*(rr.layer-Be.layer);De+=Tt(Be,rr)*Fe,Yr+=Fe}if(Yr>0){var Hr=(De/Yr-Be.y0)*kt;Be.y0+=Hr,Be.y1+=Hr,tt(Be)}}c===void 0&&fe.sort(GR),fe.length&&Q(fe,ae)}}function Q(pt,kt){var ae=pt.length>>1,Kt=pt[ae];X(pt,Kt.y0-o,ae-1,kt),Y(pt,Kt.y1+o,ae+1,kt),X(pt,n,pt.length-1,kt),Y(pt,t,0,kt)}function Y(pt,kt,ae,Kt){for(;ae<pt.length;++ae){var re=pt[ae],fe=(kt-re.y0)*Kt;fe>1e-6&&(re.y0+=fe,re.y1+=fe),kt=re.y1+o}}function X(pt,kt,ae,Kt){for(;ae>=0;--ae){var re=pt[ae],fe=(re.y1-kt)*Kt;fe>1e-6&&(re.y0-=fe,re.y1-=fe),kt=re.y0-o}}function tt(pt){var kt=pt.sourceLinks,ae=pt.targetLinks;if(f===void 0){for(var Kt=0,re=ae;Kt<re.length;Kt++){var fe=re[Kt].source.sourceLinks;fe.sort(rZ)}for(var Oe=0,Ye=kt;Oe<Ye.length;Oe++){var Be=Ye[Oe].target.targetLinks;Be.sort(eZ)}}}function it(pt){if(f===void 0)for(var kt=0,ae=pt;kt<ae.length;kt++){var Kt=ae[kt],re=Kt.sourceLinks,fe=Kt.targetLinks;re.sort(rZ),fe.sort(eZ)}}function Et(pt,kt){for(var ae=pt.y0-(pt.sourceLinks.length-1)*o/2,Kt=0,re=pt.sourceLinks;Kt<re.length;Kt++){var fe=re[Kt],Oe=fe.target,Ye=fe.width;if(Oe===kt)break;ae+=Ye+o}for(var Be=0,De=kt.targetLinks;Be<De.length;Be++){var Yr=De[Be],Oe=Yr.source,Ye=Yr.width;if(Oe===pt)break;ae-=Ye}return ae}function Tt(pt,kt){for(var ae=kt.y0-(kt.targetLinks.length-1)*o/2,Kt=0,re=kt.targetLinks;Kt<re.length;Kt++){var fe=re[Kt],Oe=fe.source,Ye=fe.width;if(Oe===pt)break;ae+=Ye+o}for(var Be=0,De=pt.sourceLinks;Be<De.length;Be++){var Yr=De[Be],Oe=Yr.target,Ye=Yr.width;if(Oe===kt)break;ae-=Ye}return ae}return x}var MMe={left:xMe,right:bMe,center:EMe,justify:c8},RMe={nodeId:function(e){return e.index},nodeAlign:"justify",nodeWidth:.008,nodePadding:.03,nodeSort:void 0};function IMe(e){var t=nn(e)?MMe[e]:$r(e)?e:null;return t||c8}function LMe(e){return Sa({},RMe,e)}function OMe(e,t){var r=LMe(e),n=r.nodeId,i=r.nodeSort,a=r.nodeAlign,o=r.nodeWidth,s=r.nodePadding,l=r.nodeDepth,u=AMe().nodeSort(i).nodeWidth(o).nodePadding(s).nodeDepth(l).nodeAlign(IMe(a)).extent([[0,0],[1,1]]).nodeId(n),c=u(t),f=c.nodes.map(function(v){var g=v.x0,x=v.x1,w=v.y0,S=v.y1;return v.x=[g,x,x,g],v.y=[w,w,S,S],v}).filter(function(v){return v.name!==null}),d=c.links.map(function(v){var g=v.source,x=v.target,w=g.x1,S=x.x0;v.x=[w,w,S,S];var A=v.width/2;return v.y=[v.y0+A,v.y0-A,v.y1+A,v.y1-A],v}).filter(function(v){var g=v.source,x=v.target;return g.name!==null&&x.name!==null});return{nodes:f,links:d}}function PMe(e){return e==="node-link"}function DMe(e,t,r){return v_(e)?e/r:t}function FMe(e,t,r){return v_(e)?e/r:t}function vht(e,t,r){var n=e.dataType,i=e.data,a=e.sourceField,o=e.targetField,s=e.weightField,l=e.nodeAlign,u=e.nodeSort,c=e.nodePadding,f=e.nodePaddingRatio,d=e.nodeWidth,v=e.nodeWidthRatio,g=e.nodeDepth,x=e.rawFields,w=x===void 0?[]:x,S;PMe(n)?S=i:S=Cut(yMe(i,a,o),a,o,s,w);var A=OMe({nodeAlign:l,nodePadding:FMe(c,f,r),nodeWidth:DMe(d,v,t),nodeSort:u,nodeDepth:g},S),M=A.nodes,R=A.links;return{nodes:M.map(function(O){return U(U({},xa(O,an(["x","y","name"],w,!0))),{isNode:!0})}),edges:R.map(function(O){return U(U({source:O.source.name,target:O.target.name,name:O.source.name||O.target.name},xa(O,an(["x","y","value"],w,!0))),{isNode:!1})})}}function BMe(e){var t=e.options,r=t.rawFields,n=r===void 0?[]:r;return ge({},{options:{tooltip:{fields:Jy(an(["name","source","target","value","isNode"],n,!0))},label:{fields:Jy(an(["x","name"],n,!0))}}},e)}function NMe(e){var t=e.chart,r=e.options,n=r.color,i=r.nodeStyle,a=r.edgeStyle,o=r.label,s=r.tooltip,l=r.nodeState,u=r.edgeState,c=r.rawFields,f=c===void 0?[]:c;t.legend(!1),t.tooltip(s),t.axis(!1),t.coordinate().reflect("y");var d=vht(r,t.width,t.height),v=d.nodes,g=d.edges,x=t.createView({id:lL});x.data(g),Dut({chart:x,options:{xField:QY,yField:JY,seriesField:tZ,rawFields:an(["source","target"],f,!0),edge:{color:n,style:a,shape:"arc"},tooltip:s,state:u}});var w=t.createView({id:sL});return w.data(v),J3({chart:w,options:{xField:QY,yField:JY,seriesField:tZ,polygon:{color:n,style:i},label:o,tooltip:s,state:l}}),t.interaction("element-active"),t.scale({x:{sync:!0,nice:!0,min:0,max:1,minLimit:0,maxLimit:1},y:{sync:!0,nice:!0,min:0,max:1,minLimit:0,maxLimit:1},name:{sync:"color",type:"cat"}}),e}function kMe(e){var t=e.chart,r=e.options,n=r.animation,i=an(an([],t.views[0].geometries,!0),t.views[1].geometries,!0);return r2(t,n,i),e}function zMe(e){var t=e.chart,r=e.options,n=r.nodeDraggable,i="sankey-node-draggable";return n?t.interaction(i):t.removeInteraction(i),e}function UMe(e){var t=e.chart,r=e.options,n=r.interactions,i=n===void 0?[]:n,a=[].concat(i,r.nodeInteractions||[]),o=[].concat(i,r.edgeInteractions||[]),s=yi(t,sL),l=yi(t,lL);return a.forEach(function(u){(u==null?void 0:u.enable)===!1?s.removeInteraction(u.type):s.interaction(u.type,u.cfg||{})}),o.forEach(function(u){(u==null?void 0:u.enable)===!1?l.removeInteraction(u.type):l.interaction(u.type,u.cfg||{})}),e}function $Me(e){return Nn(BMe,NMe,UMe,zMe,kMe,Ji)(e)}var HMe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.isDragging=!1,r}return t.prototype.isNodeElement=function(){var r=xt(this.context,"event.target");if(r){var n=r.get("element");return n&&n.getModel().data.isNode}return!1},t.prototype.getNodeView=function(){return yi(this.context.view,sL)},t.prototype.getEdgeView=function(){return yi(this.context.view,lL)},t.prototype.getCurrentDatumIdx=function(r){return this.getNodeView().geometries[0].elements.indexOf(r)},t.prototype.start=function(){if(this.isNodeElement()){this.prevPoint={x:xt(this.context,"event.x"),y:xt(this.context,"event.y")};var r=this.context.event.target.get("element"),n=this.getCurrentDatumIdx(r);if(n===-1)return;this.currentElementIdx=n,this.context.isDragging=!0,this.isDragging=!0,this.prevNodeAnimateCfg=this.getNodeView().getOptions().animate,this.prevEdgeAnimateCfg=this.getEdgeView().getOptions().animate,this.getNodeView().animate(!1),this.getEdgeView().animate(!1)}},t.prototype.translate=function(){if(this.isDragging){var r=this.context.view,n={x:xt(this.context,"event.x"),y:xt(this.context,"event.y")},i=n.x-this.prevPoint.x,a=n.y-this.prevPoint.y,o=this.getNodeView(),s=o.geometries[0].elements[this.currentElementIdx];if(s&&s.getModel()){var l=s.getModel().data,u=o.getOptions().data,c=o.getCoordinate(),f={x:i/c.getWidth(),y:a/c.getHeight()},d=U(U({},l),{x:l.x.map(function(S){return S+=f.x}),y:l.y.map(function(S){return S+=f.y})}),v=an([],u,!0);v[this.currentElementIdx]=d,o.data(v);var g=l.name,x=this.getEdgeView(),w=x.getOptions().data;w.forEach(function(S){S.source===g&&(S.x[0]+=f.x,S.x[1]+=f.x,S.y[0]+=f.y,S.y[1]+=f.y),S.target===g&&(S.x[2]+=f.x,S.x[3]+=f.x,S.y[2]+=f.y,S.y[3]+=f.y)}),x.data(w),this.prevPoint=n,r.render(!0)}}},t.prototype.end=function(){this.isDragging=!1,this.context.isDragging=!1,this.prevPoint=null,this.currentElementIdx=null,this.getNodeView().animate(this.prevNodeAnimateCfg),this.getEdgeView().animate(this.prevEdgeAnimateCfg)},t}(to);mn("sankey-node-drag",HMe);Yn("sankey-node-draggable",{showEnable:[{trigger:"polygon:mouseenter",action:"cursor:pointer"},{trigger:"polygon:mouseleave",action:"cursor:default"}],start:[{trigger:"polygon:mousedown",action:"sankey-node-drag:start"}],processing:[{trigger:"plot:mousemove",action:"sankey-node-drag:translate"},{isEnable:function(e){return e.isDragging},trigger:"plot:mousemove",action:"cursor:move"}],end:[{trigger:"plot:mouseup",action:"sankey-node-drag:end"}]});var VMe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="sankey",r}return t.getDefaultOptions=function(){return{appendPadding:8,syncViewPadding:!0,nodeStyle:{opacity:1,fillOpacity:1,lineWidth:1},edgeStyle:{opacity:.3,lineWidth:0},edgeState:{active:{style:{opacity:.8,lineWidth:0}}},label:{formatter:function(r){var n=r.name;return n},callback:function(r){var n=r[1]===1;return{style:{fill:"#545454",textAlign:n?"end":"start"},offsetX:n?-8:8}},layout:[{type:"hide-overlap"}]},tooltip:{showTitle:!1,showMarkers:!1,shared:!1,showContent:function(r){return!xt(r,[0,"data","isNode"])},formatter:function(r){var n=r.source,i=r.target,a=r.value;return{name:n+" -> "+i,value:a}}},nodeWidthRatio:.008,nodePaddingRatio:.01,animation:{appear:{animation:"wave-in"},enter:{animation:"wave-in"}}}},t.prototype.changeData=function(r){this.updateOption({data:r});var n=vht(this.options,this.chart.width,this.chart.height),i=n.nodes,a=n.edges,o=yi(this.chart,sL),s=yi(this.chart,lL);o.changeData(i),s.changeData(a)},t.prototype.getSchemaAdaptor=function(){return $Me},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t}(Jn);const lLe=Object.freeze(Object.defineProperty({__proto__:null,Sankey:VMe},Symbol.toStringTag,{value:"Module"}));var h8="ancestor-node",ght="value",fS="path",GMe=[fS,oht,o8,sht,"name","depth","height"],WMe=ge({},Jn.getDefaultOptions(),{innerRadius:0,radius:.85,hierarchyConfig:{field:"value"},tooltip:{shared:!0,showMarkers:!1,offset:20,showTitle:!1},legend:!1,sunburstStyle:{lineWidth:.5,stroke:"#FFF"},drilldown:{enabled:!0}}),XMe={field:"value",size:[1,1],round:!1,padding:0,sort:function(e,t){return t.value-e.value},as:["x","y"],ignoreParentValue:!0};function jMe(e,t){t=Sa({},XMe,t);var r=t.as;if(!ze(r)||r.length!==2)throw new TypeError('Invalid as: it must be an array with 2 strings (e.g. [ "x", "y" ])!');var n;try{n=s8(t)}catch(l){console.warn(l)}var i=function(l){return eht().size(t.size).round(t.round).padding(t.padding)(Wb(l).sum(function(u){return _l(u.children)?t.ignoreParentValue?0:u[n]-Fu(u.children,function(c,f){return c+f[n]},0):u[n]}).sort(t.sort))},a=i(e),o=r[0],s=r[1];return a.each(function(l){var u,c;l[o]=[l.x0,l.x1,l.x1,l.x0],l[s]=[l.y1,l.y1,l.y0,l.y0],l.name=l.name||((u=l.data)===null||u===void 0?void 0:u.name)||((c=l.data)===null||c===void 0?void 0:c.label),l.data.name=l.name,["x0","x1","y0","y1"].forEach(function(f){r.indexOf(f)===-1&&delete l[f]})}),l8(a)}var YMe={field:"value",tile:"treemapSquarify",size:[1,1],round:!1,ignoreParentValue:!0,padding:0,paddingInner:0,paddingOuter:0,paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0,as:["x","y"],sort:function(e,t){return t.value-e.value},ratio:.5*(1+Math.sqrt(5))};function ZMe(e,t){return e==="treemapSquarify"?$Y[e].ratio(t):$Y[e]}function mht(e,t){t=Sa({},YMe,t);var r=t.as;if(!ze(r)||r.length!==2)throw new TypeError('Invalid as: it must be an array with 2 strings (e.g. [ "x", "y" ])!');var n;try{n=s8(t)}catch(u){console.warn(u)}var i=ZMe(t.tile,t.ratio),a=function(u){return aht().tile(i).size(t.size).round(t.round).padding(t.padding).paddingInner(t.paddingInner).paddingOuter(t.paddingOuter).paddingTop(t.paddingTop).paddingRight(t.paddingRight).paddingBottom(t.paddingBottom).paddingLeft(t.paddingLeft)(Wb(u).sum(function(c){return t.ignoreParentValue&&c.children?0:c[n]}).sort(t.sort))},o=a(e),s=r[0],l=r[1];return o.each(function(u){u[s]=[u.x0,u.x1,u.x1,u.x0],u[l]=[u.y1,u.y1,u.y0,u.y0],["x0","x1","y0","y1"].forEach(function(c){r.indexOf(c)===-1&&delete u[c]})}),l8(o)}function yht(e){var t=e.data,r=e.colorField,n=e.rawFields,i=e.hierarchyConfig,a=i===void 0?{}:i,o=a.activeDepth,s={partition:jMe,treemap:mht},l=e.seriesField,u=e.type||"partition",c=s[u](t,U(U({field:l||"value"},CI(a,["activeDepth"])),{type:"hierarchy.".concat(u),as:["x","y"]})),f=[];return c.forEach(function(d){var v,g,x,w,S,A;if(d.depth===0||o>0&&d.depth>o)return null;for(var M=d.data.name,R=U({},d);R.depth>1;)M="".concat((g=R.parent.data)===null||g===void 0?void 0:g.name," / ").concat(M),R=R.parent;var O=U(U(U({},xa(d.data,an(an([],n||[],!0),[a.field],!1))),(v={},v[fS]=M,v[h8]=R.data.name,v)),d);l&&(O[l]=d.data[l]||((w=(x=d.parent)===null||x===void 0?void 0:x.data)===null||w===void 0?void 0:w[l])),r&&(O[r]=d.data[r]||((A=(S=d.parent)===null||S===void 0?void 0:S.data)===null||A===void 0?void 0:A[r])),O.ext=a,O[hS]={hierarchyConfig:a,colorField:r,rawFields:n},f.push(O)}),f}function qMe(e){var t=e.chart,r=e.options,n=r.color,i=r.colorField,a=i===void 0?h8:i,o=r.sunburstStyle,s=r.rawFields,l=s===void 0?[]:s,u=r.shape,c=yht(r);t.data(c);var f;return o&&(f=function(d){return ge({},{fillOpacity:Math.pow(.85,d.depth)},$r(o)?o(d):o)}),J3(ge({},e,{options:{xField:"x",yField:"y",seriesField:a,rawFields:Jy(an(an([],GMe,!0),l,!0)),polygon:{color:n,style:f,shape:u}}})),e}function KMe(e){var t=e.chart;return t.axis(!1),e}function QMe(e){var t=e.chart,r=e.options,n=r.label,i=fu(t,"polygon");if(!n)i.label(!1);else{var a=n.fields,o=a===void 0?["name"]:a,s=n.callback,l=hi(n,["fields","callback"]);i.label({fields:o,callback:s,cfg:wl(l)})}return e}function JMe(e){var t=e.chart,r=e.options,n=r.innerRadius,i=r.radius,a=r.reflect,o=t.coordinate({type:"polar",cfg:{innerRadius:n,radius:i}});return a&&o.reflect(a),e}function tRe(e){var t,r=e.options,n=r.hierarchyConfig,i=r.meta;return Nn(ns({},(t={},t[ght]=xt(i,xt(n,["field"],"value")),t)))(e)}function eRe(e){var t=e.chart,r=e.options,n=r.tooltip;if(n===!1)t.tooltip(!1);else{var i=n;xt(n,"fields")||(i=ge({},{customItems:function(a){return a.map(function(o){var s=xt(t.getOptions(),"scales"),l=xt(s,[fS,"formatter"],function(c){return c}),u=xt(s,[ght,"formatter"],function(c){return c});return U(U({},o),{name:l(o.data[fS]),value:u(o.data.value)})})}},i)),t.tooltip(i)}return e}function rRe(e){var t=e.drilldown,r=e.interactions,n=r===void 0?[]:r;return t!=null&&t.enabled?ge({},e,{interactions:an(an([],n,!0),[{type:"drill-down",cfg:{drillDownConfig:t,transformData:yht}}],!1)}):e}function nRe(e){var t=e.chart,r=e.options,n=r.drilldown;return _o({chart:t,options:rRe(r)}),n!=null&&n.enabled&&(t.appendPadding=Y3(t.appendPadding,xt(n,["breadCrumb","position"]))),e}function iRe(e){return Nn(Ji,Xh("sunburstStyle"),qMe,KMe,tRe,$b,JMe,eRe,QMe,nRe,Aa,To())(e)}(function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="sunburst",r}return t.getDefaultOptions=function(){return WMe},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return iRe},t.SUNBURST_ANCESTOR_FIELD=h8,t.SUNBURST_PATH_FIELD=fS,t.NODE_ANCESTORS_FIELD=o8,t})(Jn);function _ht(e,t){if(ze(e))return e.find(function(r){return r.type===t})}function xht(e,t){var r=_ht(e,t);return r&&r.enable!==!1}function f8(e){var t=e.interactions,r=e.drilldown;return xt(r,"enabled")||xht(t,"treemap-drill-down")}function aRe(e){var t=e.interactions["drill-down"];if(t){var r=t.context.actions.find(function(n){return n.name==="drill-down-action"});r.reset()}}function d8(e){var t=e.data,r=e.colorField,n=e.enableDrillDown,i=e.hierarchyConfig,a=mht(t,U(U({},i),{type:"hierarchy.treemap",field:"value",as:["x","y"]})),o=[];return a.forEach(function(s){if(s.depth===0||n&&s.depth!==1||!n&&s.children)return null;var l=s.ancestors().map(function(d){return{data:d.data,height:d.height,value:d.value}}),u=n&&ze(t.path)?l.concat(t.path.slice(1)):l,c=Object.assign({},s.data,U({x:s.x,y:s.y,depth:s.depth,value:s.value,path:u},s));if(!s.data[r]&&s.parent){var f=s.ancestors().find(function(d){return d.data[r]});c[r]=f==null?void 0:f.data[r]}else c[r]=s.data[r];c[hS]={hierarchyConfig:i,colorField:r,enableDrillDown:n},o.push(c)}),o}function oRe(e){var t=e.options,r=t.colorField;return ge({options:{rawFields:["value"],tooltip:{fields:["name","value",r,"path"],formatter:function(n){return{name:n.name,value:n.value}}}}},e)}function sRe(e){var t=e.chart,r=e.options,n=r.color,i=r.colorField,a=r.rectStyle,o=r.hierarchyConfig,s=r.rawFields,l=d8({data:r.data,colorField:r.colorField,enableDrillDown:f8(r),hierarchyConfig:o});return t.data(l),J3(ge({},e,{options:{xField:"x",yField:"y",seriesField:i,rawFields:s,polygon:{color:n,style:a}}})),t.coordinate().reflect("y"),e}function lRe(e){var t=e.chart;return t.axis(!1),e}function uRe(e){var t=e.drilldown,r=e.interactions,n=r===void 0?[]:r,i=f8(e);return i?ge({},e,{interactions:an(an([],n,!0),[{type:"drill-down",cfg:{drillDownConfig:t,transformData:d8}}],!1)}):e}function cRe(e){var t=e.chart,r=e.options,n=r.interactions,i=r.drilldown;_o({chart:t,options:uRe(r)});var a=_ht(n,"view-zoom");a&&(a.enable!==!1?t.getCanvas().on("mousewheel",function(s){s.preventDefault()}):t.getCanvas().off("mousewheel"));var o=f8(r);return o&&(t.appendPadding=Y3(t.appendPadding,xt(i,["breadCrumb","position"]))),e}function hRe(e){return Nn(oRe,Ji,Xh("rectStyle"),sRe,lRe,$b,nl,cRe,Aa,To())(e)}var fRe={colorField:"name",rectStyle:{lineWidth:1,stroke:"#fff"},hierarchyConfig:{tile:"treemapSquarify"},label:{fields:["name"],layout:{type:"limit-in-shape"}},tooltip:{showMarkers:!1,showTitle:!1},drilldown:{enabled:!1,breadCrumb:{position:"bottom-left",rootText:"初始",dividerText:"/",textStyle:{fontSize:12,fill:"rgba(0, 0, 0, 0.65)",cursor:"pointer"},activeTextStyle:{fill:"#87B5FF"}}}},dRe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="treemap",r}return t.getDefaultOptions=function(){return fRe},t.prototype.changeData=function(r){var n=this.options,i=n.colorField,a=n.interactions,o=n.hierarchyConfig;this.updateOption({data:r});var s=d8({data:r,colorField:i,enableDrillDown:xht(a,"treemap-drill-down"),hierarchyConfig:o});this.chart.changeData(s),aRe(this.chart)},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return hRe},t}(Jn);const uLe=Object.freeze(Object.defineProperty({__proto__:null,Treemap:dRe},Symbol.toStringTag,{value:"Module"}));var sg="id",u5="path",pRe={appendPadding:[10,0,20,0],blendMode:"multiply",tooltip:{showTitle:!1,showMarkers:!1,fields:["id","size"],formatter:function(e){return{name:e.id,value:e.size}}},legend:{position:"top-left"},label:{style:{textAlign:"center",fill:"#fff"}},interactions:[{type:"legend-filter",enable:!1}],state:{active:{style:{stroke:"#000"}},selected:{style:{stroke:"#000",lineWidth:2}},inactive:{style:{fillOpacity:.3,strokeOpacity:.3}}},defaultInteractions:["tooltip","venn-legend-active"]};function uL(e){if(e){var t=e.geometries[0].elements;t.forEach(function(r){r.shape.toFront()})}}var vRe=U3("element-active"),gRe=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.syncElementsPos=function(){uL(this.context.view)},t.prototype.active=function(){e.prototype.active.call(this),this.syncElementsPos()},t.prototype.toggle=function(){e.prototype.toggle.call(this),this.syncElementsPos()},t.prototype.reset=function(){e.prototype.reset.call(this),this.syncElementsPos()},t}(vRe),mRe=U3("element-highlight"),yRe=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.syncElementsPos=function(){uL(this.context.view)},t.prototype.highlight=function(){e.prototype.highlight.call(this),this.syncElementsPos()},t.prototype.toggle=function(){e.prototype.toggle.call(this),this.syncElementsPos()},t.prototype.clear=function(){e.prototype.clear.call(this),this.syncElementsPos()},t.prototype.reset=function(){e.prototype.reset.call(this),this.syncElementsPos()},t}(mRe),_Re=U3("element-selected"),xRe=U3("element-single-selected"),bRe=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.syncElementsPos=function(){uL(this.context.view)},t.prototype.selected=function(){e.prototype.selected.call(this),this.syncElementsPos()},t.prototype.toggle=function(){e.prototype.toggle.call(this),this.syncElementsPos()},t.prototype.reset=function(){e.prototype.reset.call(this),this.syncElementsPos()},t}(_Re),ERe=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.syncElementsPos=function(){uL(this.context.view)},t.prototype.selected=function(){e.prototype.selected.call(this),this.syncElementsPos()},t.prototype.toggle=function(){e.prototype.toggle.call(this),this.syncElementsPos()},t.prototype.reset=function(){e.prototype.reset.call(this),this.syncElementsPos()},t}(xRe);mn("venn-element-active",gRe);mn("venn-element-highlight",yRe);mn("venn-element-selected",bRe);mn("venn-element-single-selected",ERe);Yn("venn-element-active",{start:[{trigger:"element:mouseenter",action:"venn-element-active:active"}],end:[{trigger:"element:mouseleave",action:"venn-element-active:reset"}]});Yn("venn-element-highlight",{start:[{trigger:"element:mouseenter",action:"venn-element-highlight:highlight"}],end:[{trigger:"element:mouseleave",action:"venn-element-highlight:reset"}]});Yn("venn-element-selected",{start:[{trigger:"element:click",action:"venn-element-selected:toggle"}],rollback:[{trigger:"dblclick",action:["venn-element-selected:reset"]}]});Yn("venn-element-single-selected",{start:[{trigger:"element:click",action:"venn-element-single-selected:toggle"}],rollback:[{trigger:"dblclick",action:["venn-element-single-selected:reset"]}]});Yn("venn-legend-active",{start:[{trigger:"legend-item:mouseenter",action:["list-active:active","venn-element-active:active"]}],end:[{trigger:"legend-item:mouseleave",action:["list-active:reset","venn-element-active:reset"]}]});Yn("venn-legend-highlight",{start:[{trigger:"legend-item:mouseenter",action:["legend-item-highlight:highlight","venn-element-highlight:highlight"]}],end:[{trigger:"legend-item:mouseleave",action:["legend-item-highlight:reset","venn-element-highlight:reset"]}]});var wRe=function(e){Ut(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getLabelPoint=function(r,n,i){var a=r.data,o=a.x,s=a.y,l=r.customLabelInfo,u=l.offsetX,c=l.offsetY;return{content:r.content[i],x:o+u,y:s+c}},t}(G3);JS("venn",wRe);var tC=`	
\v\f\r   ᠎             　\u2028\u2029`,CRe=new RegExp("([a-z])["+tC+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+tC+"]*,?["+tC+"]*)+)","ig"),SRe=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+tC+"]*,?["+tC+"]*","ig");function TRe(e){if(!e)return null;if(Jht(e))return e;var t={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},r=[];return String(e).replace(CRe,function(n,i,a){var o=[],s=i.toLowerCase();if(a.replace(SRe,function(l,u){u&&o.push(+u)}),s==="m"&&o.length>2&&(r.push([i].concat(o.splice(0,2))),s="l",i=i==="m"?"l":"L"),s==="o"&&o.length===1&&r.push([i,o[0]]),s==="r")r.push([i].concat(o));else for(;o.length>=t[s]&&(r.push([i].concat(o.splice(0,t[s]))),!!t[s]););return""}),r}function ARe(e){return ge({},e.defaultStyle,{fill:e.color},e.style)}ca("schema","venn",{draw:function(e,t){var r=e.data,n=TRe(r[u5]),i=ARe(e),a=t.addGroup({name:"venn-shape"});a.addShape("path",{attrs:U(U({},i),{path:n}),name:"venn-path"});var o=e.customInfo,s=o.offsetX,l=o.offsetY,u=eh.transform(null,[["t",s,l]]);return a.setMatrix(u),a},getMarker:function(e){var t=e.color;return{symbol:"circle",style:{lineWidth:0,stroke:t,fill:t,r:4}}}});var MRe=function(e){return function(t,r){var n=[];return n[0]=e(t[0],r[0]),n[1]=e(t[1],r[1]),n[2]=e(t[2],r[2]),n}},aZ={normal:function(e){return e},multiply:function(e,t){return e*t/255},screen:function(e,t){return 255*(1-(1-e/255)*(1-t/255))},overlay:function(e,t){return t<128?2*e*t/255:255*(1-2*(1-e/255)*(1-t/255))},darken:function(e,t){return e>t?t:e},lighten:function(e,t){return e>t?e:t},dodge:function(e,t){return e===255?255:(e=255*(t/255)/(1-e/255),e>255?255:e)},burn:function(e,t){return t===255?255:e===0?0:255*(1-Math.min(1,(1-t/255)/(e/255)))}},RRe=function(e){if(!aZ[e])throw new Error("unknown blend mode "+e);return aZ[e]};function IRe(e,t,r){r===void 0&&(r="normal");var n=MRe(RRe(r))(_A(e),_A(t)),i=_A(e),a=i[0],o=i[1],s=i[2],l=i[3],u=_A(t),c=u[0],f=u[1],d=u[2],v=u[3],g=Number((l+v*(1-l)).toFixed(2)),x=Math.round((l*(1-v)*(a/255)+l*v*(n[0]/255)+(1-l)*v*(c/255))/g*255),w=Math.round((l*(1-v)*(o/255)+l*v*(n[1]/255)+(1-l)*v*(f/255))/g*255),S=Math.round((l*(1-v)*(s/255)+l*v*(n[2]/255)+(1-l)*v*(d/255))/g*255);return"rgba(".concat(x,", ").concat(w,", ").concat(S,", ").concat(g,")")}function _A(e){var t=e.replace("/s+/g",""),r;return typeof t=="string"&&!t.startsWith("rgba")&&!t.startsWith("#")?r=Um.rgb2arr(Um.toRGB(t)).concat([1]):(t.startsWith("rgba")&&(r=t.replace("rgba(","").replace(")","").split(",")),t.startsWith("#")&&(r=Um.rgb2arr(t).concat([1])),r.map(function(n,i){return i===3?Number(n):n|0}))}function LRe(e,t,r,n){n=n||{};var i=n.maxIterations||100,a=n.tolerance||1e-10,o=e(t),s=e(r),l=r-t;if(o*s>0)throw"Initial bisect points must have opposite signs";if(o===0)return t;if(s===0)return r;for(var u=0;u<i;++u){l/=2;var c=t+l,f=e(c);if(f*o>=0&&(t=c),Math.abs(l)<a||f===0)return c}return t+l}function c5(e){for(var t=new Array(e),r=0;r<e;++r)t[r]=0;return t}function oZ(e,t){return c5(e).map(function(){return c5(t)})}function Ax(e,t){for(var r=0,n=0;n<e.length;++n)r+=e[n]*t[n];return r}function h5(e){return Math.sqrt(Ax(e,e))}function f5(e,t,r){for(var n=0;n<t.length;++n)e[n]=t[n]*r}function Yv(e,t,r,n,i){for(var a=0;a<e.length;++a)e[a]=t*r[a]+n*i[a]}function bht(e,t,r){r=r||{};var n=r.maxIterations||t.length*200,i=r.nonZeroDelta||1.05,a=r.zeroDelta||.001,o=r.minErrorDelta||1e-6,s=r.minErrorDelta||1e-5,l=r.rho!==void 0?r.rho:1,u=r.chi!==void 0?r.chi:2,c=r.psi!==void 0?r.psi:-.5,f=r.sigma!==void 0?r.sigma:.5,d,v=t.length,g=new Array(v+1);g[0]=t,g[0].fx=e(t),g[0].id=0;for(var x=0;x<v;++x){var w=t.slice();w[x]=w[x]?w[x]*i:a,g[x+1]=w,g[x+1].fx=e(w),g[x+1].id=x+1}function S(tt){for(var it=0;it<tt.length;it++)g[v][it]=tt[it];g[v].fx=tt.fx}for(var A=function(tt,it){return tt.fx-it.fx},M=t.slice(),R=t.slice(),O=t.slice(),N=t.slice(),k=0;k<n;++k){if(g.sort(A),r.history){var V=g.map(function(tt){var it=tt.slice();return it.fx=tt.fx,it.id=tt.id,it});V.sort(function(tt,it){return tt.id-it.id}),r.history.push({x:g[0].slice(),fx:g[0].fx,simplex:V})}for(d=0,x=0;x<v;++x)d=Math.max(d,Math.abs(g[0][x]-g[1][x]));if(Math.abs(g[0].fx-g[v].fx)<o&&d<s)break;for(x=0;x<v;++x){M[x]=0;for(var Q=0;Q<v;++Q)M[x]+=g[Q][x];M[x]/=v}var Y=g[v];if(Yv(R,1+l,M,-l,Y),R.fx=e(R),R.fx<g[0].fx)Yv(N,1+u,M,-u,Y),N.fx=e(N),N.fx<R.fx?S(N):S(R);else if(R.fx>=g[v-1].fx){var X=!1;if(R.fx>Y.fx?(Yv(O,1+c,M,-c,Y),O.fx=e(O),O.fx<Y.fx?S(O):X=!0):(Yv(O,1-c*l,M,c*l,Y),O.fx=e(O),O.fx<R.fx?S(O):X=!0),X){if(f>=1)break;for(x=1;x<g.length;++x)Yv(g[x],1-f,g[0],f,g[x]),g[x].fx=e(g[x])}}else S(R)}return g.sort(A),{fx:g[0].fx,x:g[0]}}function ORe(e,t,r,n,i,a,o){var s=r.fx,l=Ax(r.fxprime,t),u=s,c=s,f=l,d=0;i=i||1,a=a||1e-6,o=o||.1;function v(x,w,S){for(var A=0;A<16;++A)if(i=(x+w)/2,Yv(n.x,1,r.x,i,t),u=n.fx=e(n.x,n.fxprime),f=Ax(n.fxprime,t),u>s+a*i*l||u>=S)w=i;else{if(Math.abs(f)<=-o*l)return i;f*(w-x)>=0&&(w=x),x=i,S=u}return 0}for(var g=0;g<10;++g){if(Yv(n.x,1,r.x,i,t),u=n.fx=e(n.x,n.fxprime),f=Ax(n.fxprime,t),u>s+a*i*l||g&&u>=c)return v(d,i,c);if(Math.abs(f)<=-o*l)return i;if(f>=0)return v(i,d,u);c=u,d=i,i*=2}return i}function PRe(e,t,r){var n={x:t.slice(),fx:0,fxprime:t.slice()},i={x:t.slice(),fx:0,fxprime:t.slice()},a=t.slice(),o,s,l=1,u;r=r||{},u=r.maxIterations||t.length*20,n.fx=e(n.x,n.fxprime),o=n.fxprime.slice(),f5(o,n.fxprime,-1);for(var c=0;c<u;++c){if(l=ORe(e,o,n,i,l),r.history&&r.history.push({x:n.x.slice(),fx:n.fx,fxprime:n.fxprime.slice(),alpha:l}),!l)f5(o,n.fxprime,-1);else{Yv(a,1,i.fxprime,-1,n.fxprime);var f=Ax(n.fxprime,n.fxprime),d=Math.max(0,Ax(a,i.fxprime)/f);Yv(o,d,o,-1,i.fxprime),s=n,n=i,i=s}if(h5(n.fxprime)<=1e-5)break}return r.history&&r.history.push({x:n.x.slice(),fx:n.fx,fxprime:n.fxprime.slice(),alpha:l}),n}var Eht=1e-10;function p8(e,t){var r=FRe(e),n=r.filter(function(k){return DRe(k,e)}),i=0,a=0,o,s=[];if(n.length>1){var l=Sht(n);for(o=0;o<n.length;++o){var u=n[o];u.angle=Math.atan2(u.x-l.x,u.y-l.y)}n.sort(function(k,V){return V.angle-k.angle});var c=n[n.length-1];for(o=0;o<n.length;++o){var f=n[o];a+=(c.x+f.x)*(f.y-c.y);for(var d={x:(f.x+c.x)/2,y:(f.y+c.y)/2},v=null,g=0;g<f.parentIndex.length;++g)if(c.parentIndex.indexOf(f.parentIndex[g])>-1){var x=e[f.parentIndex[g]],w=Math.atan2(f.x-x.x,f.y-x.y),S=Math.atan2(c.x-x.x,c.y-x.y),A=S-w;A<0&&(A+=2*Math.PI);var M=S-A/2,R=Ud(d,{x:x.x+x.radius*Math.sin(M),y:x.y+x.radius*Math.cos(M)});R>x.radius*2&&(R=x.radius*2),(v===null||v.width>R)&&(v={circle:x,width:R,p1:f,p2:c})}v!==null&&(s.push(v),i+=d5(v.circle.radius,v.width),c=f)}}else{var O=e[0];for(o=1;o<e.length;++o)e[o].radius<O.radius&&(O=e[o]);var N=!1;for(o=0;o<e.length;++o)if(Ud(e[o],O)>Math.abs(O.radius-e[o].radius)){N=!0;break}N?i=a=0:(i=O.radius*O.radius*Math.PI,s.push({circle:O,p1:{x:O.x,y:O.y+O.radius},p2:{x:O.x-Eht,y:O.y+O.radius},width:O.radius*2}))}return a/=2,t&&(t.area=i+a,t.arcArea=i,t.polygonArea=a,t.arcs=s,t.innerPoints=n,t.intersectionPoints=r),i+a}function DRe(e,t){for(var r=0;r<t.length;++r)if(Ud(e,t[r])>t[r].radius+Eht)return!1;return!0}function FRe(e){for(var t=[],r=0;r<e.length;++r)for(var n=r+1;n<e.length;++n)for(var i=Cht(e[r],e[n]),a=0;a<i.length;++a){var o=i[a];o.parentIndex=[r,n],t.push(o)}return t}function d5(e,t){return e*e*Math.acos(1-t/e)-(e-t)*Math.sqrt(t*(2*e-t))}function Ud(e,t){return Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y))}function wht(e,t,r){if(r>=e+t)return 0;if(r<=Math.abs(e-t))return Math.PI*Math.min(e,t)*Math.min(e,t);var n=e-(r*r-t*t+e*e)/(2*r),i=t-(r*r-e*e+t*t)/(2*r);return d5(e,n)+d5(t,i)}function Cht(e,t){var r=Ud(e,t),n=e.radius,i=t.radius;if(r>=n+i||r<=Math.abs(n-i))return[];var a=(n*n-i*i+r*r)/(2*r),o=Math.sqrt(n*n-a*a),s=e.x+a*(t.x-e.x)/r,l=e.y+a*(t.y-e.y)/r,u=-(t.y-e.y)*(o/r),c=-(t.x-e.x)*(o/r);return[{x:s+u,y:l-c},{x:s-u,y:l+c}]}function Sht(e){for(var t={x:0,y:0},r=0;r<e.length;++r)t.x+=e[r].x,t.y+=e[r].y;return t.x/=e.length,t.y/=e.length,t}function HP(e,t,r){var n=t[0].radius-Ud(t[0],e),i,a;for(i=1;i<t.length;++i)a=t[i].radius-Ud(t[i],e),a<=n&&(n=a);for(i=0;i<r.length;++i)a=Ud(r[i],e)-r[i].radius,a<=n&&(n=a);return n}function Tht(e,t){var r=[],n;for(n=0;n<e.length;++n){var i=e[n];r.push({x:i.x,y:i.y}),r.push({x:i.x+i.radius/2,y:i.y}),r.push({x:i.x-i.radius/2,y:i.y}),r.push({x:i.x,y:i.y+i.radius/2}),r.push({x:i.x,y:i.y-i.radius/2})}var a=r[0],o=HP(r[0],e,t);for(n=1;n<r.length;++n){var s=HP(r[n],e,t);s>=o&&(a=r[n],o=s)}var l=bht(function(d){return-1*HP({x:d[0],y:d[1]},e,t)},[a.x,a.y],{maxIterations:500,minErrorDelta:1e-10}).x,u={x:l[0],y:l[1]},c=!0;for(n=0;n<e.length;++n)if(Ud(u,e[n])>e[n].radius){c=!1;break}for(n=0;n<t.length;++n)if(Ud(u,t[n])<t[n].radius){c=!1;break}if(!c)if(e.length==1)u={x:e[0].x,y:e[0].y};else{var f={};p8(e,f),f.arcs.length===0?u={x:0,y:-1e3,disjoint:!0}:f.arcs.length==1?u={x:f.arcs[0].circle.x,y:f.arcs[0].circle.y}:t.length?u=Tht(e,[]):u=Sht(f.arcs.map(function(d){return d.p1}))}return u}function BRe(e){var t={},r=[];for(var n in e)r.push(n),t[n]=[];for(var i=0;i<r.length;i++)for(var a=e[r[i]],o=i+1;o<r.length;++o){var s=e[r[o]],l=Ud(a,s);l+s.radius<=a.radius+1e-10?t[r[o]].push(r[i]):l+a.radius<=s.radius+1e-10&&t[r[i]].push(r[o])}return t}function NRe(e,t){for(var r={},n=BRe(e),i=0;i<t.length;++i){for(var a=t[i].sets,o={},s={},l=0;l<a.length;++l){o[a[l]]=!0;for(var u=n[a[l]],c=0;c<u.length;++c)s[u[c]]=!0}var f=[],d=[];for(var v in e)v in o?f.push(e[v]):v in s||d.push(e[v]);var g=Tht(f,d);r[a]=g,g.disjoint&&t[i].size>0&&console.log("WARNING: area "+a+" not represented on screen")}return r}function kRe(e,t,r){var n=[],i=e-r,a=t;return n.push("M",i,a),n.push("A",r,r,0,1,0,i+2*r,a),n.push("A",r,r,0,1,0,i,a),n.join(" ")}function zRe(e){var t={};p8(e,t);var r=t.arcs;if(r.length===0)return"M 0 0";if(r.length==1){var n=r[0].circle;return kRe(n.x,n.y,n.radius)}else{for(var i=[`
M`,r[0].p2.x,r[0].p2.y],a=0;a<r.length;++a){var o=r[a],s=o.circle.radius,l=o.width>s;i.push(`
A`,s,s,0,l?1:0,1,o.p1.x,o.p1.y)}return i.join(" ")}}function URe(e,t){t=t||{},t.maxIterations=t.maxIterations||500;var r=t.initialLayout||GRe,n=t.lossFunction||v8;e=$Re(e);var i=r(e,t),a=[],o=[],s;for(s in i)i.hasOwnProperty(s)&&(a.push(i[s].x),a.push(i[s].y),o.push(s));for(var l=bht(function(f){for(var d={},v=0;v<o.length;++v){var g=o[v];d[g]={x:f[2*v],y:f[2*v+1],radius:i[g].radius}}return n(d,e)},a,t),u=l.x,c=0;c<o.length;++c)s=o[c],i[s].x=u[2*c],i[s].y=u[2*c+1];return i}var Aht=1e-10;function p5(e,t,r){return Math.min(e,t)*Math.min(e,t)*Math.PI<=r+Aht?Math.abs(e-t):LRe(function(n){return wht(e,t,n)-r},0,e+t)}function $Re(e){e=e.slice();var t=[],r={},n,i,a,o;for(n=0;n<e.length;++n){var s=e[n];s.sets.length==1?t.push(s.sets[0]):s.sets.length==2&&(a=s.sets[0],o=s.sets[1],r[[a,o]]=!0,r[[o,a]]=!0)}for(t.sort(function(l,u){return l>u?1:-1}),n=0;n<t.length;++n)for(a=t[n],i=n+1;i<t.length;++i)o=t[i],[a,o]in r||e.push({sets:[a,o],size:0});return e}function HRe(e,t,r){var n=oZ(t.length,t.length),i=oZ(t.length,t.length);return e.filter(function(a){return a.sets.length==2}).map(function(a){var o=r[a.sets[0]],s=r[a.sets[1]],l=Math.sqrt(t[o].size/Math.PI),u=Math.sqrt(t[s].size/Math.PI),c=p5(l,u,a.size);n[o][s]=n[s][o]=c;var f=0;a.size+1e-10>=Math.min(t[o].size,t[s].size)?f=1:a.size<=1e-10&&(f=-1),i[o][s]=i[s][o]=f}),{distances:n,constraints:i}}function VRe(e,t,r,n){var i=0,a;for(a=0;a<t.length;++a)t[a]=0;for(a=0;a<r.length;++a)for(var o=e[2*a],s=e[2*a+1],l=a+1;l<r.length;++l){var u=e[2*l],c=e[2*l+1],f=r[a][l],d=n[a][l],v=(u-o)*(u-o)+(c-s)*(c-s),g=Math.sqrt(v),x=v-f*f;d>0&&g<=f||d<0&&g>=f||(i+=2*x*x,t[2*a]+=4*x*(o-u),t[2*a+1]+=4*x*(s-c),t[2*l]+=4*x*(u-o),t[2*l+1]+=4*x*(c-s))}return i}function GRe(e,t){var r=XRe(e,t),n=t.lossFunction||v8;if(e.length>=8){var i=WRe(e,t),a=n(i,e),o=n(r,e);a+1e-8<o&&(r=i)}return r}function WRe(e,t){t=t||{};var r=t.restarts||10,n=[],i={},a;for(a=0;a<e.length;++a){var o=e[a];o.sets.length==1&&(i[o.sets[0]]=n.length,n.push(o))}var s=HRe(e,n,i),l=s.distances,u=s.constraints,c=h5(l.map(h5))/l.length;l=l.map(function(A){return A.map(function(M){return M/c})});var f=function(A,M){return VRe(A,M,l,u)},d,v;for(a=0;a<r;++a){var g=c5(l.length*2).map(Math.random);v=PRe(f,g,t),(!d||v.fx<d.fx)&&(d=v)}var x=d.x,w={};for(a=0;a<n.length;++a){var S=n[a];w[S.sets[0]]={x:x[2*a]*c,y:x[2*a+1]*c,radius:Math.sqrt(S.size/Math.PI)}}if(t.history)for(a=0;a<t.history.length;++a)f5(t.history[a].x,c);return w}function XRe(e,t){for(var r=t&&t.lossFunction?t.lossFunction:v8,n={},i={},a,o=0;o<e.length;++o){var s=e[o];s.sets.length==1&&(a=s.sets[0],n[a]={x:1e10,y:1e10,rowid:Object.keys(n).length,size:s.size,radius:Math.sqrt(s.size/Math.PI)},i[a]=[])}e=e.filter(function(pt){return pt.sets.length==2});for(var o=0;o<e.length;++o){var l=e[o],u=l.hasOwnProperty("weight")?l.weight:1,c=l.sets[0],f=l.sets[1];l.size+Aht>=Math.min(n[c].size,n[f].size)&&(u=0),i[c].push({set:f,size:l.size,weight:u}),i[f].push({set:c,size:l.size,weight:u})}var d=[];for(a in i)if(i.hasOwnProperty(a)){for(var v=0,o=0;o<i[a].length;++o)v+=i[a][o].size*i[a][o].weight;d.push({set:a,size:v})}function g(pt,kt){return kt.size-pt.size}d.sort(g);var x={};function w(pt){return pt.set in x}function S(pt,kt){n[kt].x=pt.x,n[kt].y=pt.y,x[kt]=!0}S({x:0,y:0},d[0].set);for(var o=1;o<d.length;++o){var A=d[o].set,M=i[A].filter(w);if(a=n[A],M.sort(g),M.length===0)throw"ERROR: missing pairwise overlap information";for(var R=[],O=0;O<M.length;++O){var N=n[M[O].set],k=p5(a.radius,N.radius,M[O].size);R.push({x:N.x+k,y:N.y}),R.push({x:N.x-k,y:N.y}),R.push({y:N.y+k,x:N.x}),R.push({y:N.y-k,x:N.x});for(var V=O+1;V<M.length;++V)for(var Q=n[M[V].set],Y=p5(a.radius,Q.radius,M[V].size),X=Cht({x:N.x,y:N.y,radius:k},{x:Q.x,y:Q.y,radius:Y}),tt=0;tt<X.length;++tt)R.push(X[tt])}for(var it=1e50,Et=R[0],O=0;O<R.length;++O){n[A].x=R[O].x,n[A].y=R[O].y;var Tt=r(n,e);Tt<it&&(it=Tt,Et=R[O])}S(Et,A)}return n}function v8(e,t){var r=0;function n(c){return c.map(function(f){return e[f]})}for(var i=0;i<t.length;++i){var a=t[i],o=void 0;if(a.sets.length!=1){if(a.sets.length==2){var s=e[a.sets[0]],l=e[a.sets[1]];o=wht(s.radius,l.radius,Ud(s,l))}else o=p8(n(a.sets));var u=a.hasOwnProperty("weight")?a.weight:1;r+=u*(o-a.size)*(o-a.size)}}return r}function jRe(e){var t=function(r){var n=Math.max.apply(null,e.map(function(a){return a[r]+a.radius})),i=Math.min.apply(null,e.map(function(a){return a[r]-a.radius}));return{max:n,min:i}};return{xRange:t("x"),yRange:t("y")}}function YRe(e,t,r,n){var i=[],a=[];for(var o in e)e.hasOwnProperty(o)&&(a.push(o),i.push(e[o]));t-=2*n,r-=2*n;var s=jRe(i),l=s.xRange,u=s.yRange;if(l.max==l.min||u.max==u.min)return console.log("not scaling solution: zero size detected"),e;for(var c=t/(l.max-l.min),f=r/(u.max-u.min),d=Math.min(f,c),v=(t-(l.max-l.min)*d)/2,g=(r-(u.max-u.min)*d)/2,x={},w=0;w<i.length;++w){var S=i[w];x[a[w]]={radius:d*S.radius,x:n+v+(S.x-l.min)*d,y:n+g+(S.y-u.min)*d}}return x}var ZRe=wb(function(e,t,r,n){var i=new Map,a=e.length;return t.forEach(function(o,s){if(o[n].length===1)i.set(o[sg],e[(s+a)%a]);else{var l=o[n].map(function(u){return i.get(u)});i.set(o[sg],l.slice(1).reduce(function(u,c){return IRe(u,c,r)},l[0]))}}),i},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return JSON.stringify(e)});function qRe(e,t,r,n){n===void 0&&(n=0);var i=e.data,a=e.setsField,o=e.sizeField;if(i.length===0)return fg(Xd.WARN,!1,"warn: %s","数据不能为空"),[];var s=i.map(function(f){var d;return U(U({},f),(d={sets:f[a]||[],size:f[o]},d[u5]="",d[sg]="",d))});s.sort(function(f,d){return f.sets.length-d.sets.length});var l=URe(s),u=YRe(l,t,r,n),c=NRe(u,s);return s.forEach(function(f){var d=f.sets,v=d.join(",");f[sg]=v;var g=d.map(function(S){return u[S]}),x=zRe(g);/[zZ]$/.test(x)||(x+=" Z"),f[u5]=x;var w=c[v]||{x:0,y:0};Sa(f,w)}),s}function KRe(e,t){for(var r=0;r<t.length;r++)if(!e.includes(t[r]))return!1;return!0}var QRe=40;function Mht(e,t,r){var n=e.chart,i=e.options,a=i.blendMode,o=i.setsField,s=n.getTheme(),l=s.colors10,u=s.colors20,c=r;ze(c)||(c=t.filter(function(d){return d[o].length===1}).length<=10?l:u);var f=ZRe(c,t,a,o);return function(d){return f.get(d)||c[0]}}function JRe(e,t){var r=e.options,n=r.color;if(typeof n!="function"){var i=typeof n=="string"?[n]:n,a=Mht(e,t,i);return function(o){return a(o[sg])}}return n}function tIe(e){var t=e.chart,r=e.options,n=r.legend,i=r.appendPadding,a=r.padding,o=s0(i);return n!==!1&&(o=Y3(i,xt(n,"position"),QRe)),t.appendPadding=X6([o,a]),e}function eIe(e){var t=e.options,r=t.data;r||(fg(Xd.WARN,!1,"warn: %s","数据不能为空"),r=[]);var n=r.filter(function(a){return a.sets.length===1}).map(function(a){return a.sets[0]}),i=r.filter(function(a){var o=a.sets;return KRe(n,o)});return zi(i,r)||fg(Xd.WARN,!1,"warn: %s","交集中不能出现不存在的集合, 请输入合法数据"),Tr({},e,{options:{data:i}})}function rIe(e){var t=e.chart,r=e.options,n=r.pointStyle,i=r.setsField,a=r.sizeField,o=s0(t.appendPadding),s=o[0],l=o[1],u=o[2],c=o[3],f={offsetX:c,offsetY:s},d=t.viewBBox,v=d.width,g=d.height,x=qRe(r,Math.max(v-(l+c),0),Math.max(g-(s+u),0),0);t.data(x);var w=K6(ge({},e,{options:{xField:"x",yField:"y",sizeField:a,seriesField:sg,rawFields:[i,a],schema:{shape:"venn",style:n}}})).ext,S=w.geometry;S.customInfo(f);var A=JRe(e,x);return typeof A=="function"&&S.color(sg,function(M){var R=x.find(function(N){return N[sg]===M}),O=Mht(e,x)(M);return A(R,O)}),e}function nIe(e){var t=e.chart,r=e.options,n=r.label,i=s0(t.appendPadding),a=i[0],o=i[3],s={offsetX:o,offsetY:a},l=fu(t,"schema");if(!n)l.label(!1);else{var u=n.callback,c=hi(n,["callback"]);l.label({fields:["id"],callback:u,cfg:Tr({},wl(c),{type:"venn",customLabelInfo:s})})}return e}function iIe(e){var t=e.chart,r=e.options,n=r.legend,i=r.sizeField;return t.legend(sg,n),t.legend(i,!1),e}function aIe(e){var t=e.chart;return t.axis(!1),e}function oIe(e){var t=e.options,r=e.chart,n=t.interactions;if(n){var i={"legend-active":"venn-legend-active","legend-highlight":"venn-legend-highlight"};_o(ge({},e,{options:{interactions:n.map(function(a){return U(U({},a),{type:i[a.type]||a.type})})}}))}return r.removeInteraction("legend-active"),r.removeInteraction("legend-highlight"),e}function sIe(e){return Nn(tIe,Ji,eIe,rIe,nIe,ns({}),iIe,aIe,nl,oIe,Aa)(e)}(function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="venn",r}return t.getDefaultOptions=function(){return pRe},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return sIe},t.prototype.triggerResize=function(){this.chart.destroyed||(this.chart.forceFit(),this.chart.clear(),this.execAdaptor(),this.chart.render(!0))},t})(Jn);var Pf="x",Ly="violinY",lIe="violinSize",Rht="minMax",Iht="quantile",Lht="median",g8="violin_view",uIe="min_max_view",cIe="quantile_view",hIe="median_view",fIe=ge({},Jn.getDefaultOptions(),{syncViewPadding:!0,kde:{type:"triangular",sampleSize:32,width:3},violinStyle:{lineWidth:1,fillOpacity:.3,strokeOpacity:.75},xAxis:{grid:{line:null},tickLine:{alignTick:!1}},yAxis:{grid:{line:{style:{lineWidth:.5,lineDash:[4,4]}}}},legend:{position:"top-left"},tooltip:{showMarkers:!1}}),Oht={exports:{}},Pht={exports:{}};(function(e){var t=e.exports;e.exports.isNumber=function(r){return typeof r=="number"},e.exports.findMin=function(r){if(r.length===0)return 1/0;for(var n=r[0],i=1;i<r.length;i++)n=Math.min(n,r[i]);return n},e.exports.findMax=function(r){if(r.length===0)return-1/0;for(var n=r[0],i=1;i<r.length;i++)n=Math.max(n,r[i]);return n},e.exports.findMinMulti=function(r){for(var n=t.findMin(r[0]),i=1;i<r.length;i++)n=Math.min(n,t.findMin(r[i]));return n},e.exports.findMaxMulti=function(r){for(var n=t.findMax(r[0]),i=1;i<r.length;i++)n=Math.max(n,t.findMax(r[i]));return n},e.exports.inside=function(r,n,i){return r<=i&&i<=n}})(Pht);var dIe=Pht.exports;(function(e){var t=50,r=2,n=Math.log(2),i=e.exports,a=dIe;function o(l){return 1-Math.abs(l)}e.exports.getUnifiedMinMax=function(l,u){return i.getUnifiedMinMaxMulti([l],u)},e.exports.getUnifiedMinMaxMulti=function(l,u){u=u||{};var c=!1,f=!1,d=a.isNumber(u.width)?u.width:r,v=a.isNumber(u.size)?u.size:t,g=a.isNumber(u.min)?u.min:(c=!0,a.findMinMulti(l)),x=a.isNumber(u.max)?u.max:(f=!0,a.findMaxMulti(l)),w=x-g,S=w/(v-1);return c&&(g=g-2*d*S),f&&(x=x+2*d*S),{min:g,max:x}},e.exports.create=function(l,u){if(u=u||{},!l||l.length===0)return[];var c=a.isNumber(u.size)?u.size:t,f=a.isNumber(u.width)?u.width:r,d=i.getUnifiedMinMax(l,{size:c,width:f,min:u.min,max:u.max}),v=d.min,g=d.max,x=g-v,w=x/(c-1);if(x===0)return[{x:v,y:1}];for(var S=[],A=0;A<c;A++)S.push({x:v+A*w,y:0});var M=function(X){return Math.floor((X-v)/w)},R=s(o,f),O=R[f],N=R[f-1]-R[f-2],k=0;l.forEach(function(X){var tt=M(X);if(!(tt+f<0||tt-f>=S.length)){var it=Math.max(tt-f,0),Et=tt,Tt=Math.min(tt+f,S.length-1),pt=it-(tt-f),kt=tt+f-Tt,ae=R[-f-1+pt]||0,Kt=R[-f-1+kt]||0,re=O/(O-ae-Kt);pt>0&&(k+=re*(pt-1)*N);var fe=Math.max(0,tt-f+1);a.inside(0,S.length-1,fe)&&(S[fe].y+=re*1*N),a.inside(0,S.length-1,Et+1)&&(S[Et+1].y-=re*2*N),a.inside(0,S.length-1,Tt+1)&&(S[Tt+1].y+=re*1*N)}});var V=k,Q=0,Y=0;return S.forEach(function(X){Q+=X.y,V+=Q,X.y=V,Y+=V}),Y>0&&S.forEach(function(X){X.y/=Y}),S};function s(l,u){for(var c={},f=0,d=-u;d<=u;d++)f+=l(d/u),c[d]=f;return c}e.exports.getExpectedValueFromPdf=function(l){if(!(!l||l.length===0)){var u=0;return l.forEach(function(c){u+=c.x*c.y}),u}},e.exports.getXWithLeftTailArea=function(l,u){if(!(!l||l.length===0)){for(var c=0,f=0,d=0;d<l.length&&(f=d,c+=l[d].y,!(c>=u));d++);return l[f].x}},e.exports.getPerplexity=function(l){if(!(!l||l.length===0)){var u=0;return l.forEach(function(c){var f=Math.log(c.y);isFinite(f)&&(u+=c.y*f)}),u=-u/n,Math.pow(2,u)}}})(Oht);var pIe=Oht.exports;const vIe=aa(pIe);function sZ(e,t){var r=e.length*t;if(e.length===0)throw new Error("quantile requires at least one data point.");if(t<0||t>1)throw new Error("quantiles must be between 0 and 1");return t===1?e[e.length-1]:t===0?e[0]:r%1!==0?e[Math.ceil(r)-1]:e.length%2===0?(e[r-1]+e[r])/2:e[r]}function nw(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function JA(e,t,r,n){for(r=r||0,n=n||e.length-1;n>r;){if(n-r>600){var i=n-r+1,a=t-r+1,o=Math.log(i),s=.5*Math.exp(2*o/3),l=.5*Math.sqrt(o*s*(i-s)/i);a-i/2<0&&(l*=-1);var u=Math.max(r,Math.floor(t-a*s/i+l)),c=Math.min(n,Math.floor(t+(i-a)*s/i+l));JA(e,t,u,c)}var f=e[t],d=r,v=n;for(nw(e,r,t),e[n]>f&&nw(e,r,n);d<v;){for(nw(e,d,v),d++,v--;e[d]<f;)d++;for(;e[v]>f;)v--}e[r]===f?nw(e,r,v):(v++,nw(e,v,n)),v<=t&&(r=v+1),t<=v&&(n=v-1)}}function iw(e,t){var r=e.slice();if(Array.isArray(t)){gIe(r,t);for(var n=[],i=0;i<t.length;i++)n[i]=sZ(r,t[i]);return n}else{var a=Fht(r.length,t);return Dht(r,a,0,r.length-1),sZ(r,t)}}function Dht(e,t,r,n){t%1===0?JA(e,t,r,n):(t=Math.floor(t),JA(e,t,r,n),JA(e,t+1,t+1,n))}function gIe(e,t){for(var r=[0],n=0;n<t.length;n++)r.push(Fht(e.length,t[n]));r.push(e.length-1),r.sort(mIe);for(var i=[0,r.length-1];i.length;){var a=Math.ceil(i.pop()),o=Math.floor(i.pop());if(!(a-o<=1)){var s=Math.floor((o+a)/2);Dht(e,r[s],Math.floor(r[o]),Math.ceil(r[a])),i.push(o,s,s,a)}}}function mIe(e,t){return e-t}function Fht(e,t){var r=e*t;return t===1?e-1:t===0?0:r%1!==0?Math.ceil(r)-1:e%2===0?r-.5:r}var lZ=function(e){return{low:Vf(e),high:kh(e),q1:iw(e,.25),q3:iw(e,.75),median:iw(e,[.5]),minMax:[Vf(e),kh(e)],quantile:[iw(e,.25),iw(e,.75)]}},uZ=function(e,t){var r=vIe.create(e,t);return{violinSize:r.map(function(n){return n.y}),violinY:r.map(function(n){return n.x})}},Bht=function(e){var t=e.xField,r=e.yField,n=e.seriesField,i=e.data,a=e.kde,o={min:a.min,max:a.max,size:a.sampleSize,width:a.width};if(!n){var s=Ph(i,t);return Object.keys(s).map(function(c){var f=s[c],d=f.map(function(v){return v[r]});return U(U({x:c},uZ(d,o)),lZ(d))})}var l=[],u=Ph(i,n);return Object.keys(u).forEach(function(c){var f=Ph(u[c],t);return Object.keys(f).forEach(function(d){var v,g=f[d],x=g.map(function(w){return w[r]});l.push(U(U((v={x:d},v[n]=c,v),uZ(x,o)),lZ(x)))})}),l},tM=["low","high","q1","q3","median"],eM=[{type:"dodge",marginRatio:1/32}];function yIe(e){var t=e.chart,r=e.options;return t.data(Bht(r)),e}function _Ie(e){var t=e.chart,r=e.options,n=r.seriesField,i=r.color,a=r.shape,o=a===void 0?"violin":a,s=r.violinStyle,l=r.tooltip,u=r.state,c=t.createView({id:g8});return GEe({chart:c,options:{xField:Pf,yField:Ly,seriesField:n||Pf,sizeField:lIe,tooltip:U({fields:tM},l),violin:{style:s,color:i,shape:o},state:u}}),c.geometries[0].adjust(eM),e}function xIe(e){var t=e.chart,r=e.options,n=r.seriesField,i=r.color,a=r.tooltip,o=r.box;if(o===!1)return e;var s=t.createView({id:uIe});du({chart:s,options:{xField:Pf,yField:Rht,seriesField:n||Pf,tooltip:U({fields:tM},a),state:typeof o=="object"?o.state:{},interval:{color:i,size:1,style:{lineWidth:0}}}}),s.geometries[0].adjust(eM);var l=t.createView({id:cIe});du({chart:l,options:{xField:Pf,yField:Iht,seriesField:n||Pf,tooltip:U({fields:tM},a),state:typeof o=="object"?o.state:{},interval:{color:i,size:8,style:{fillOpacity:1}}}}),l.geometries[0].adjust(eM);var u=t.createView({id:hIe});return jh({chart:u,options:{xField:Pf,yField:Lht,seriesField:n||Pf,tooltip:U({fields:tM},a),state:typeof o=="object"?o.state:{},point:{color:i,size:1,style:{fill:"white",lineWidth:0}}}}),u.geometries[0].adjust(eM),l.axis(!1),s.axis(!1),u.axis(!1),u.legend(!1),s.legend(!1),l.legend(!1),e}function bIe(e){var t,r=e.chart,n=e.options,i=n.meta,a=n.xAxis,o=n.yAxis,s={},l=ge(s,i,(t={},t[Pf]=U(U({sync:!0},xa(a,Wc)),{type:"cat"}),t[Ly]=U({sync:!0},xa(o,Wc)),t[Rht]=U({sync:Ly},xa(o,Wc)),t[Iht]=U({sync:Ly},xa(o,Wc)),t[Lht]=U({sync:Ly},xa(o,Wc)),t));return r.scale(l),e}function EIe(e){var t=e.chart,r=e.options,n=r.xAxis,i=r.yAxis,a=yi(t,g8);return n===!1?a.axis(Pf,!1):a.axis(Pf,n),i===!1?a.axis(Ly,!1):a.axis(Ly,i),t.axis(!1),e}function wIe(e){var t=e.chart,r=e.options,n=r.legend,i=r.seriesField,a=r.shape;if(n===!1)t.legend(!1);else{var o=i||Pf,s=CI(n,["selected"]);(!a||!a.startsWith("hollow"))&&(xt(s,["marker","style","lineWidth"])||Hs(s,["marker","style","lineWidth"],0)),t.legend(o,s),xt(n,"selected")&&ft(t.views,function(l){return l.legend(o,n)})}return e}function CIe(e){var t=e.chart,r=yi(t,g8);return To()(U(U({},e),{chart:r})),e}function SIe(e){var t=e.chart,r=e.options,n=r.animation;return ft(t.views,function(i){r2(i,n)}),e}function TIe(e){return Nn(Ji,yIe,_Ie,xIe,bIe,nl,EIe,wIe,_o,CIe,SIe)(e)}(function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="violin",r}return t.getDefaultOptions=function(){return fIe},t.prototype.changeData=function(r){this.updateOption({data:r}),this.chart.changeData(Bht(this.options))},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.getSchemaAdaptor=function(){return TIe},t})(Jn);var zf="$$yField$$",cL="$$diffField$$",m8="$$absoluteField$$",v5="$$isTotal$$",AIe={label:{},leaderLine:{style:{lineWidth:1,stroke:"#8c8c8c",lineDash:[4,2]}},total:{style:{fill:"rgba(0, 0, 0, 0.25)"}},interactions:[{type:"element-active"}],risingFill:"#f4664a",fallingFill:"#30bf78",waterfallStyle:{fill:"rgba(0, 0, 0, 0.25)"},yAxis:{grid:{line:{style:{lineDash:[4,2]}}}}};function MIe(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];if(n){var i=r===0?"M":"L";t.push([i,n.x,n.y])}}var a=e[0];return t.push(["L",a.x,a.y]),t.push(["z"]),t}function RIe(e){return ge({},e.defaultStyle,e.style,{fill:e.color})}ca("interval","waterfall",{draw:function(e,t){var r=e.customInfo,n=e.points,i=e.nextPoints,a=t.addGroup(),o=this.parsePath(MIe(n)),s=RIe(e);a.addShape("path",{attrs:U(U({},s),{path:o})});var l=xt(r,"leaderLine");if(l&&i){var u=[["M",n[2].x,n[2].y],["L",i[0].x,i[0].y]];n[2].y===i[1].y&&(u[1]=["L",i[1].x,i[1].y]),u=this.parsePath(u),a.addShape("path",{attrs:U({path:u},l.style||{})})}return a}});function IIe(e,t,r,n,i){var a,o=[];if(Fu(e,function(l,u){var c;fg(Xd.WARN,Gn(u[r]),"".concat(u[r]," is not a valid number"));var f=iu(u[r])?null:u[r];return o.push(U(U({},u),(c={},c[n]=[l,l+f],c))),l+f},0),o.length&&i){var s=xt(o,[[e.length-1],n,[1]]);o.push((a={},a[t]=i.label,a[r]=s,a[n]=[0,s],a))}return o}function Nht(e,t,r,n){var i=IIe(e,t,r,zf,n);return i.map(function(a,o){var s;return qi(a)?U(U({},a),(s={},s[m8]=a[zf][1],s[cL]=a[zf][1]-a[zf][0],s[v5]=o===e.length,s)):a})}function LIe(e){var t=e.options,r=t.locale,n=t.total,i=K3(r).get(["waterfall","total"]);return n&&typeof n.label!="string"&&i&&(e.options.total.label=i),e}function OIe(e){var t=e.chart,r=e.options,n=r.data,i=r.xField,a=r.yField,o=r.total,s=r.leaderLine,l=r.columnWidthRatio,u=r.waterfallStyle,c=r.risingFill,f=r.fallingFill,d=r.color,v=r.shape,g=r.customInfo;t.data(Nht(n,i,a,o));var x=d||function(M){return xt(M,[v5])?xt(o,["style","fill"],""):xt(M,[zf,1])-xt(M,[zf,0])>0?c:f},w=ge({},e,{options:{xField:i,yField:zf,seriesField:i,rawFields:[a,cL,v5,zf],widthRatio:l,interval:{style:u,shape:v||"waterfall",color:x}}}),S=du(w).ext,A=S.geometry;return A.customInfo(U(U({},g),{leaderLine:s})),e}function PIe(e){var t,r,n=e.options,i=n.xAxis,a=n.yAxis,o=n.xField,s=n.yField,l=n.meta,u=ge({},{alias:s},xt(l,s));return Nn(ns((t={},t[o]=i,t[s]=a,t[zf]=a,t),ge({},l,(r={},r[zf]=u,r[cL]=u,r[m8]=u,r))))(e)}function DIe(e){var t=e.chart,r=e.options,n=r.xAxis,i=r.yAxis,a=r.xField,o=r.yField;return n===!1?t.axis(a,!1):t.axis(a,n),i===!1?(t.axis(o,!1),t.axis(zf,!1)):(t.axis(o,i),t.axis(zf,i)),e}function FIe(e){var t=e.chart,r=e.options,n=r.legend,i=r.total,a=r.risingFill,o=r.fallingFill,s=r.locale,l=K3(s);if(n===!1)t.legend(!1);else{var u=[{name:l.get(["general","increase"]),value:"increase",marker:{symbol:"square",style:{r:5,fill:a}}},{name:l.get(["general","decrease"]),value:"decrease",marker:{symbol:"square",style:{r:5,fill:o}}}];i&&u.push({name:i.label||"",value:"total",marker:{symbol:"square",style:ge({},{r:5},xt(i,"style"))}}),t.legend(ge({},{custom:!0,position:"top",items:u},n)),t.removeInteraction("legend-filter")}return e}function BIe(e){var t=e.chart,r=e.options,n=r.label,i=r.labelMode,a=r.xField,o=fu(t,"interval");if(!n)o.label(!1);else{var s=n.callback,l=hi(n,["callback"]);o.label({fields:i==="absolute"?[m8,a]:[cL,a],callback:s,cfg:wl(l)})}return e}function NIe(e){var t=e.chart,r=e.options,n=r.tooltip,i=r.xField,a=r.yField;if(n!==!1){t.tooltip(U({showCrosshairs:!1,showMarkers:!1,shared:!0,fields:[a]},n));var o=t.geometries[0];n!=null&&n.formatter?o.tooltip("".concat(i,"*").concat(a),n.formatter):o.tooltip(a)}else t.tooltip(!1);return e}function kIe(e){return Nn(LIe,Ji,OIe,PIe,DIe,FIe,NIe,BIe,w0,_o,Aa,To())(e)}var zIe=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="waterfall",r}return t.getDefaultOptions=function(){return AIe},t.prototype.changeData=function(r){var n=this.options,i=n.xField,a=n.yField,o=n.total;this.updateOption({data:r}),this.chart.changeData(Nht(r,i,a,o))},t.prototype.getSchemaAdaptor=function(){return kIe},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t}(Jn);const cLe=Object.freeze(Object.defineProperty({__proto__:null,Waterfall:zIe},Symbol.toStringTag,{value:"Module"}));var y8="color",UIe=ge({},Jn.getDefaultOptions(),{timeInterval:2e3,legend:!1,tooltip:{showTitle:!1,showMarkers:!1,showCrosshairs:!1,fields:["text","value",y8],formatter:function(e){return{name:e.text,value:e.value}}},wordStyle:{fontFamily:"Verdana",fontWeight:"normal",padding:1,fontSize:[12,60],rotation:[0,90],rotationSteps:2,rotateRatio:.5}}),$Ie={font:function(){return"serif"},padding:1,size:[500,500],spiral:"archimedean",timeInterval:3e3};function HIe(e,t){return t=Sa({},$Ie,t),VIe(e,t)}function VIe(e,t){var r=r3e();["font","fontSize","fontWeight","padding","rotate","size","spiral","timeInterval","random"].forEach(function(l){ke(t[l])||r[l](t[l])}),r.words(e),t.imageMask&&r.createMask(t.imageMask);var n=r.start(),i=n._tags;i.forEach(function(l){l.x+=t.size[0]/2,l.y+=t.size[1]/2});var a=t.size,o=a[0],s=a[1];return i.push({text:"",value:0,x:0,y:0,opacity:0}),i.push({text:"",value:0,x:o,y:s,opacity:0}),i}var VP=Math.PI/180,Rw=64,rM=2048;function GIe(e){return e.text}function WIe(){return"serif"}function cZ(){return"normal"}function XIe(e){return e.value}function jIe(){return~~(Math.random()*2)*90}function YIe(){return 1}function ZIe(e,t,r,n){if(!t.sprite){var i=e.context,a=e.ratio;i.clearRect(0,0,(Rw<<5)/a,rM/a);var o=0,s=0,l=0,u=r.length;for(--n;++n<u;){t=r[n],i.save(),i.font=t.style+" "+t.weight+" "+~~((t.size+1)/a)+"px "+t.font;var c=i.measureText(t.text+"m").width*a,f=t.size<<1;if(t.rotate){var d=Math.sin(t.rotate*VP),v=Math.cos(t.rotate*VP),g=c*v,x=c*d,w=f*v,S=f*d;c=Math.max(Math.abs(g+S),Math.abs(g-S))+31>>5<<5,f=~~Math.max(Math.abs(x+w),Math.abs(x-w))}else c=c+31>>5<<5;if(f>l&&(l=f),o+c>=Rw<<5&&(o=0,s+=l,l=0),s+f>=rM)break;i.translate((o+(c>>1))/a,(s+(f>>1))/a),t.rotate&&i.rotate(t.rotate*VP),i.fillText(t.text,0,0),t.padding&&(i.lineWidth=2*t.padding,i.strokeText(t.text,0,0)),i.restore(),t.width=c,t.height=f,t.xoff=o,t.yoff=s,t.x1=c>>1,t.y1=f>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,o+=c}for(var A=i.getImageData(0,0,(Rw<<5)/a,rM/a).data,M=[];--n>=0;)if(t=r[n],!!t.hasText){for(var c=t.width,R=c>>5,f=t.y1-t.y0,O=0;O<f*R;O++)M[O]=0;if(o=t.xoff,o==null)return;s=t.yoff;for(var N=0,k=-1,V=0;V<f;V++){for(var O=0;O<c;O++){var Q=R*V+(O>>5),Y=A[(s+V)*(Rw<<5)+(o+O)<<2]?1<<31-O%32:0;M[Q]|=Y,N|=Y}N?k=V:(t.y0++,f--,V--,s++)}t.y1=t.y0+k,t.sprite=M.slice(0,(t.y1-t.y0)*R)}}}function qIe(e,t,r){r>>=5;for(var n=e.sprite,i=e.width>>5,a=e.x-(i<<4),o=a&127,s=32-o,l=e.y1-e.y0,u=(e.y+e.y0)*r+(a>>5),c,f=0;f<l;f++){c=0;for(var d=0;d<=i;d++)if((c<<s|(d<i?(c=n[f*i+d])>>>o:0))&t[u+d])return!0;u+=r}return!1}function KIe(e,t){var r=e[0],n=e[1];t.x+t.x0<r.x&&(r.x=t.x+t.x0),t.y+t.y0<r.y&&(r.y=t.y+t.y0),t.x+t.x1>n.x&&(n.x=t.x+t.x1),t.y+t.y1>n.y&&(n.y=t.y+t.y1)}function QIe(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function kht(e){var t=e[0]/e[1];return function(r){return[t*(r*=.1)*Math.cos(r),r*Math.sin(r)]}}function JIe(e){var t=4,r=t*e[0]/e[1],n=0,i=0;return function(a){var o=a<0?-1:1;switch(Math.sqrt(1+4*o*a)-o&3){case 0:n+=r;break;case 1:i+=t;break;case 2:n-=r;break;default:i-=t;break}return[n,i]}}function hZ(e){for(var t=[],r=-1;++r<e;)t[r]=0;return t}function t3e(){return document.createElement("canvas")}function Rp(e){return $r(e)?e:function(){return e}}var e3e={archimedean:kht,rectangular:JIe};function r3e(){var e=[256,256],t=WIe,r=XIe,n=cZ,i=jIe,a=YIe,o=kht,s=Math.random,l=[],u=1/0,c=GIe,f=cZ,d=t3e,v={};v.start=function(){var w=e[0],S=e[1],A=g(d()),M=v.board?v.board:hZ((e[0]>>5)*e[1]),R=l.length,O=[],N=l.map(function(Y,X,tt){return Y.text=c.call(this,Y,X,tt),Y.font=t.call(this,Y,X,tt),Y.style=f.call(this,Y,X,tt),Y.weight=n.call(this,Y,X,tt),Y.rotate=i.call(this,Y,X,tt),Y.size=~~r.call(this,Y,X,tt),Y.padding=a.call(this,Y,X,tt),Y}).sort(function(Y,X){return X.size-Y.size}),k=-1,V=v.board?[{x:0,y:0},{x:w,y:S}]:null;Q();function Q(){for(var Y=Date.now();Date.now()-Y<u&&++k<R;){var X=N[k];X.x=w*(s()+.5)>>1,X.y=S*(s()+.5)>>1,ZIe(A,X,N,k),X.hasText&&x(M,X,V)&&(O.push(X),V?v.hasImage||KIe(V,X):V=[{x:X.x+X.x0,y:X.y+X.y0},{x:X.x+X.x1,y:X.y+X.y1}],X.x-=e[0]>>1,X.y-=e[1]>>1)}v._tags=O,v._bounds=V}return v};function g(w){w.width=w.height=1;var S=Math.sqrt(w.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,1,1).data.length>>2);w.width=(Rw<<5)/S,w.height=rM/S;var A=w.getContext("2d",{willReadFrequently:!0});return A.fillStyle=A.strokeStyle="red",A.textAlign="center",{context:A,ratio:S}}function x(w,S,A){for(var M=S.x,R=S.y,O=Math.sqrt(e[0]*e[0]+e[1]*e[1]),N=o(e),k=s()<.5?1:-1,V,Q=-k,Y,X;(V=N(Q+=k))&&(Y=~~V[0],X=~~V[1],!(Math.min(Math.abs(Y),Math.abs(X))>=O));)if(S.x=M+Y,S.y=R+X,!(S.x+S.x0<0||S.y+S.y0<0||S.x+S.x1>e[0]||S.y+S.y1>e[1])&&(!A||!qIe(S,w,e[0]))&&(!A||QIe(S,A))){for(var tt=S.sprite,it=S.width>>5,Et=e[0]>>5,Tt=S.x-(it<<4),pt=Tt&127,kt=32-pt,ae=S.y1-S.y0,Kt=void 0,re=(S.y+S.y0)*Et+(Tt>>5),fe=0;fe<ae;fe++){Kt=0;for(var Oe=0;Oe<=it;Oe++)w[re+Oe]|=Kt<<kt|(Oe<it?(Kt=tt[fe*it+Oe])>>>pt:0);re+=Et}return delete S.sprite,!0}return!1}return v.createMask=function(w){var S=document.createElement("canvas"),A=e[0],M=e[1];if(!(!A||!M)){var R=A>>5,O=hZ((A>>5)*M);S.width=A,S.height=M;var N=S.getContext("2d");N.drawImage(w,0,0,w.width,w.height,0,0,A,M);for(var k=N.getImageData(0,0,A,M).data,V=0;V<M;V++)for(var Q=0;Q<A;Q++){var Y=R*V+(Q>>5),X=V*A+Q<<2,tt=k[X]>=250&&k[X+1]>=250&&k[X+2]>=250,it=tt?1<<31-Q%32:0;O[Y]|=it}v.board=O,v.hasImage=!0}},v.timeInterval=function(w){u=w??1/0},v.words=function(w){l=w},v.size=function(w){e=[+w[0],+w[1]]},v.font=function(w){t=Rp(w)},v.fontWeight=function(w){n=Rp(w)},v.rotate=function(w){i=Rp(w)},v.spiral=function(w){o=e3e[w]||w},v.fontSize=function(w){r=Rp(w)},v.padding=function(w){a=Rp(w)},v.random=function(w){s=Rp(w)},v}function zht(e){var t=e.options,r=e.chart,n=r,i=n.width,a=n.height,o=n.padding,s=n.appendPadding,l=n.ele,u=t.data,c=t.imageMask,f=t.wordField,d=t.weightField,v=t.colorField,g=t.wordStyle,x=t.timeInterval,w=t.random,S=t.spiral,A=t.autoFit,M=A===void 0?!0:A,R=t.placementStrategy;if(!u||!u.length)return[];var O=g.fontFamily,N=g.fontWeight,k=g.padding,V=g.fontSize,Q=s3e(u,d),Y=[c3e(Q),h3e(Q)],X=u.map(function(Et){return{text:Et[f],value:Et[d],color:Et[v],datum:Et}}),tt={imageMask:c,font:O,fontSize:o3e(V,Y),fontWeight:N,size:n3e({width:i,height:a,padding:o,appendPadding:s,autoFit:M,container:l}),padding:k,timeInterval:x,random:w,spiral:S,rotate:l3e(t)};if($r(R)){var it=X.map(function(Et,Tt,pt){return U(U(U({},Et),{hasText:!!Et.text,font:Rp(tt.font)(Et,Tt,pt),weight:Rp(tt.fontWeight)(Et,Tt,pt),rotate:Rp(tt.rotate)(Et,Tt,pt),size:Rp(tt.fontSize)(Et,Tt,pt),style:"normal"}),R.call(r,Et,Tt,pt))});return it.push({text:"",value:0,x:0,y:0,opacity:0}),it.push({text:"",value:0,x:tt.size[0],y:tt.size[1],opacity:0}),it}return HIe(X,tt)}function n3e(e){var t=e.width,r=e.height,n=e.container,i=e.autoFit,a=e.padding,o=e.appendPadding;if(i){var s=e5(n);t=s.width,r=s.height}t=t||400,r=r||400;var l=i3e({padding:a,appendPadding:o}),u=l[0],c=l[1],f=l[2],d=l[3],v=[t-(d+c),r-(u+f)];return v}function i3e(e){var t=s0(e.padding),r=s0(e.appendPadding),n=t[0]+r[0],i=t[1]+r[1],a=t[2]+r[2],o=t[3]+r[3];return[n,i,a,o]}function a3e(e){return new Promise(function(t,r){if(e instanceof HTMLImageElement){t(e);return}if(nn(e)){var n=new Image;n.crossOrigin="anonymous",n.src=e,n.onload=function(){t(n)},n.onerror=function(){fg(Xd.ERROR,!1,"image %s load failed !!!",e),r()};return}fg(Xd.WARN,e===void 0,"The type of imageMask option must be String or HTMLImageElement."),r()})}function o3e(e,t){if($r(e))return e;if(ze(e)){var r=e[0],n=e[1];if(!t)return function(){return(n+r)/2};var i=t[0],a=t[1];return a===i?function(){return(n+r)/2}:function(s){var l=s.value;return(n-r)/(a-i)*(l-i)+r}}return function(){return e}}function s3e(e,t){return e.map(function(r){return r[t]}).filter(function(r){return typeof r=="number"&&!isNaN(r)})}function l3e(e){var t=u3e(e),r=t.rotation,n=t.rotationSteps;if(!ze(r))return r;var i=r[0],a=r[1],o=n===1?0:(a-i)/(n-1);return function(){return a===i?a:Math.floor(Math.random()*n)*o}}function u3e(e){var t=e.wordStyle.rotationSteps;return t<1&&(fg(Xd.WARN,!1,"The rotationSteps option must be greater than or equal to 1."),t=1),{rotation:e.wordStyle.rotation,rotationSteps:t}}function c3e(e){return Math.min.apply(Math,e)}function h3e(e){return Math.max.apply(Math,e)}function f3e(e){var t=e.chart,r=e.options,n=r.colorField,i=r.color,a=zht(e);t.data(a);var o=ge({},e,{options:{xField:"x",yField:"y",seriesField:n&&y8,rawFields:$r(i)&&an(an([],xt(r,"rawFields",[]),!0),["datum"],!1),point:{color:i,shape:"word-cloud"}}}),s=jh(o).ext;return s.geometry.label(!1),t.coordinate().reflect("y"),t.axis(!1),e}function d3e(e){return Nn(ns({x:{nice:!1},y:{nice:!1}}))(e)}function p3e(e){var t=e.chart,r=e.options,n=r.legend,i=r.colorField;return n===!1?t.legend(!1):i&&t.legend(y8,n),e}function v3e(e){Nn(f3e,d3e,nl,p3e,_o,Aa,Ji,w0)(e)}ca("point","word-cloud",{draw:function(e,t){var r=e.x,n=e.y,i=t.addShape("text",{attrs:U(U({},g3e(e)),{x:r,y:n})}),a=e.data.rotate;return typeof a=="number"&&eh.rotate(i,a*Math.PI/180),i}});function g3e(e){return{fontSize:e.data.size,text:e.data.text,textAlign:"center",fontFamily:e.data.font,fontWeight:e.data.weight,fill:e.color||e.defaultStyle.stroke,textBaseline:"alphabetic"}}var m3e=function(e){Ut(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="word-cloud",r}return t.getDefaultOptions=function(){return UIe},t.prototype.changeData=function(r){this.updateOption({data:r}),this.options.imageMask?this.render():this.chart.changeData(zht({chart:this.chart,options:this.options}))},t.prototype.getDefaultOptions=function(){return t.getDefaultOptions()},t.prototype.render=function(){var r=this;return new Promise(function(n){var i=r.options.imageMask;if(!i){e.prototype.render.call(r),n();return}var a=function(o){r.options=U(U({},r.options),{imageMask:o||null}),e.prototype.render.call(r),n()};a3e(i).then(a).catch(a)})},t.prototype.getSchemaAdaptor=function(){return v3e},t.prototype.triggerResize=function(){var r=this;this.chart.destroyed||(this.execAdaptor(),window.setTimeout(function(){e.prototype.triggerResize.call(r)}))},t}(Jn);const hLe=Object.freeze(Object.defineProperty({__proto__:null,WordCloud:m3e},Symbol.toStringTag,{value:"Module"}));(function(e){Ut(t,e);function t(r,n,i,a){var o=e.call(this,r,ge({},a,n))||this;return o.type="g2-plot",o.defaultOptions=a,o.adaptor=i,o}return t.prototype.getDefaultOptions=function(){return this.defaultOptions},t.prototype.getSchemaAdaptor=function(){return this.adaptor},t})(Jn);Put("en-US",$Ee);Put("zh-CN",HEe);export{j3e as $,Ay as A,GX as B,aft as C,sN as D,Pi as E,PB as F,Z4 as G,T3e as H,i7 as I,Zut as J,pct as K,y5 as L,ide as M,xct as N,pw as O,Lx as P,Bf as Q,HD as R,aUt as S,x3 as T,fkt as U,jc as V,Pe as W,z as X,G3e as Y,nkt as Z,VD as _,_S as a,Y3e as a0,Z3e as a1,q3e as a2,K3e as a3,Q3e as a4,J3e as a5,tLe as a6,eLe as a7,rLe as a8,nLe as a9,iLe as aa,aLe as ab,oLe as ac,sLe as ad,lLe as ae,uLe as af,cLe as ag,hLe as ah,ikt as b,eg as c,Sb as d,E3t as e,K6t as f,hx as g,mC as h,D3e as i,Qpe as j,Kpe as k,qT as l,On as m,Ju as n,n_ as o,lde as p,Mh as q,Hhe as r,dS as s,x3e as t,Tf as u,_ot as v,X3e as w,Me as x,jp as y,W3e as z};
