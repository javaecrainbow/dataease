import{d as be,f as y,M as w,a7 as F,V as g,W as D,N,p as ve,ac as L,R as ze,e as me,k,i as K,r as O,m as I,w as te,j as Oe,a5 as We,am as $t,n as Q,J as he,I as Te,at as Ge,_ as rt,o as Bt,aj as Kt,S as Ye,t as Lt,ab as xe,U as Ee,a0 as x,g as P,Z as Pe,aa as _e,ad as q,q as je,X as Dt,aH as Ht,aI as At}from"./vue-0.0.0-dataease.js";import{b as Rt,c as Ft,E as Ut}from"./index-0.0.0-dataease4.js";import{E as Wt}from"./index-0.0.0-dataease14.js";import{ab as Pt,z as ut,E as jt,a9 as Gt,a2 as qt,ay as Qt,Z as Zt,a0 as dt,aa as ct,e as Jt}from"./index-0.0.0-dataease2.js";import{E as pt}from"./el-checkbox-0.0.0-dataease.js";import{h as Ne,i as ne,U as Xt,x as Yt,a3 as xt,a7 as ft,ae as _t,a6 as el,q as tl}from"./index-0.0.0-dataease.js";import{c as ll,F as nl}from"./fixed-size-list-0.0.0-dataease.js";import{A as et,C as tt,E as ol,h as al,D as sl,m as lt,j as il}from"./el-virtual-list-0.0.0-dataease.js";import{a as H,h as nt,e as rl,k as ot}from"./lodash-0.0.0-dataease.js";import{e as ul}from"./strings-0.0.0-dataease.js";import{C as dl}from"./index-0.0.0-dataease5.js";const le=(e,t,o)=>{const{itemSize:s}=e,{items:u,lastVisitedIndex:f}=o;if(t>f){let d=0;if(f>=0){const n=u[f];d=n.offset+n.size}for(let n=f+1;n<=t;n++){const S=s(n);u[n]={offset:d,size:S},d+=S}o.lastVisitedIndex=t}return u[t]},cl=(e,t,o)=>{const{items:s,lastVisitedIndex:u}=t;return(u>0?s[u].offset:0)>=o?mt(e,t,0,u,o):pl(e,t,Math.max(0,u),o)},mt=(e,t,o,s,u)=>{for(;o<=s;){const f=o+Math.floor((s-o)/2),d=le(e,f,t).offset;if(d===u)return f;d<u?o=f+1:d>u&&(s=f-1)}return Math.max(0,o-1)},pl=(e,t,o,s)=>{const{total:u}=e;let f=1;for(;o<u&&le(e,o,t).offset<s;)o+=f,f*=2;return mt(e,t,Math.floor(o/2),Math.min(o,u-1),s)},at=({total:e},{items:t,estimatedItemSize:o,lastVisitedIndex:s})=>{let u=0;if(s>=e&&(s=e-1),s>=0){const n=t[s];u=n.offset+n.size}const d=(e-s-1)*o;return u+d},fl=ll({name:"ElDynamicSizeList",getItemOffset:(e,t,o)=>le(e,t,o).offset,getItemSize:(e,t,{items:o})=>o[t].size,getEstimatedTotalSize:at,getOffset:(e,t,o,s,u)=>{const{height:f,layout:d,width:n}=e,S=lt(d)?n:f,E=le(e,t,u),b=at(e,u),v=Math.max(0,Math.min(b-S,E.offset)),m=Math.max(0,E.offset-S+E.size);switch(o===il&&(s>=m-S&&s<=v+S?o=et:o=tt),o){case al:return v;case ol:return m;case tt:return Math.round(m+(v-m)/2);case et:default:return s>=m&&s<=v?s:s<m?m:v}},getStartIndexForOffset:(e,t,o)=>cl(e,o,t),getStopIndexForStartIndex:(e,t,o,s)=>{const{height:u,total:f,layout:d,width:n}=e,S=lt(d)?n:u,E=le(e,t,s),b=o+S;let v=E.offset+E.size,m=t;for(;m<f-1&&v<b;)m++,v+=le(e,m,s).size;return m},initCache({estimatedItemSize:e=sl},t){const o={items:{},estimatedItemSize:e,lastVisitedIndex:-1};return o.clearCacheAfterIndex=(s,u=!0)=>{var f,d;o.lastVisitedIndex=Math.min(o.lastVisitedIndex,s-1),(f=t.exposed)==null||f.getItemStyleCache(-1),u&&((d=t.proxy)==null||d.$forceUpdate())},o},clearCache:!1,validateProps:({itemSize:e})=>{}}),ml=be({props:{item:{type:Object,required:!0},style:Object,height:Number},setup(){return{ns:ne("select")}}});function vl(e,t,o,s,u,f){return e.item.isTitle?(y(),w("div",{key:0,class:g(e.ns.be("group","title")),style:D([e.style,{lineHeight:`${e.height}px`}])},F(e.item.label),7)):(y(),w("div",{key:1,class:g(e.ns.be("group","split")),style:D(e.style)},[N("span",{class:g(e.ns.be("group","split-dash")),style:D({top:`${e.height/2}px`})},null,6)],6))}var hl=Ne(ml,[["render",vl],["__file","/Users/st/Desktop/vue/nxx-ui/packages/components/select-v2/src/group-item.vue"]]);function vt(e,{emit:t}){return{hoverItem:()=>{e.disabled||t("hover",e.index)},selectOptionClick:()=>{e.disabled||t("select",e.item,e.index)}}}const bl={allowCreate:Boolean,autocomplete:{type:String,default:"none"},showChecked:Boolean,radio:Boolean,automaticDropdown:Boolean,clearable:Boolean,clearIcon:{type:[String,Object],default:Xt},effect:{type:String,default:"light"},collapseTags:Boolean,collapseTagsTooltip:{type:Boolean,default:!1},defaultFirstOption:Boolean,disabled:Boolean,estimatedOptionHeight:{type:Number,default:void 0},filterable:Boolean,filterMethod:Function,height:{type:Number,default:170},itemHeight:{type:Number,default:34},id:String,loading:Boolean,loadingText:String,label:String,modelValue:[Array,String,Number,Boolean,Object],multiple:Boolean,multipleLimit:{type:Number,default:0},name:String,noDataText:String,noMatchText:String,remoteMethod:Function,reserveKeyword:{type:Boolean,default:!0},options:{type:Array,required:!0},placeholder:{type:String},teleported:Rt.teleported,persistent:{type:Boolean,default:!0},popperClass:{type:String,default:""},popperOptions:{type:Object,default:()=>({})},remote:Boolean,size:{type:String,validator:Pt},valueKey:{type:String,default:"value"},scrollbarAlwaysOn:{type:Boolean,default:!1},validateEvent:{type:Boolean,default:!0},placement:{type:Yt(String),values:Ft,default:"bottom-start"}},ht={data:Array,disabled:Boolean,hovering:Boolean,item:Object,index:Number,style:Object,selected:Boolean,radio:Boolean,created:Boolean},gl=be({props:ht,emits:["select","hover"],setup(e,{emit:t}){const o=ne("select"),{hoverItem:s,selectOptionClick:u}=vt(e,{emit:t});return{ns:o,hoverItem:s,selectOptionClick:u}}}),yl=["aria-selected"];function Sl(e,t,o,s,u,f){return y(),w("li",{"aria-selected":e.selected,style:D(e.style),class:g([e.ns.be("dropdown","option-item"),e.ns.is("selected",e.selected),e.ns.is("disabled",e.disabled),e.ns.is("created",e.created),e.radio&&"radio",{hover:e.hovering}]),onMouseenter:t[0]||(t[0]=(...d)=>e.hoverItem&&e.hoverItem(...d)),onClick:t[1]||(t[1]=L((...d)=>e.selectOptionClick&&e.selectOptionClick(...d),["stop"]))},[ve(e.$slots,"default",{item:e.item,index:e.index,disabled:e.disabled},()=>[N("span",null,F(e.item.label),1)])],46,yl)}var Vl=Ne(gl,[["render",Sl],["__file","/Users/st/Desktop/vue/nxx-ui/packages/components/select-v2/src/option-item.vue"]]);const Il=be({props:ht,components:{ElCheckbox:pt},emits:["select","hover"],setup(e,{emit:t}){const o=ze("displayInputValue"),s=ne("select"),u=S=>{t("select",S)},f=S=>S.replace(o.displayInputValue,`<span style="color: #3370FF;">${o.displayInputValue}</span>`),{hoverItem:d,selectOptionClick:n}=vt(e,{emit:t});return{ns:s,hoverItem:d,replaceFun:f,onSelectCheckbox:u,selectOptionClick:n}}}),Cl=["aria-selected"],kl=["innerHTML"];function wl(e,t,o,s,u,f){const d=me("el-checkbox");return y(),w("li",{"aria-selected":e.selected,style:D(e.style),class:g([e.ns.be("dropdown","option-item"),e.ns.is("selected",e.selected),e.ns.is("disabled",e.disabled),e.ns.is("created",e.created),{hover:e.hovering}]),onMouseenter:t[3]||(t[3]=(...n)=>e.hoverItem&&e.hoverItem(...n)),onClick:t[4]||(t[4]=L(()=>{e.item.checked=!e.item.checked,e.onSelectCheckbox(e.index)},["stop"]))},[ve(e.$slots,"default",{item:e.item,index:e.index,disabled:e.disabled},()=>[k(d,{title:e.item.label,onClick:t[0]||(t[0]=L(()=>{},["stop"])),onChange:t[1]||(t[1]=n=>e.onSelectCheckbox(e.index)),modelValue:e.item.checked,"onUpdate:modelValue":t[2]||(t[2]=n=>e.item.checked=n)},{default:K(()=>[N("span",{innerHTML:e.replaceFun(e.item.label)},null,8,kl)]),_:1},8,["title","modelValue"])])],46,Cl)}var Ol=Ne(Il,[["render",wl],["__file","/Users/st/Desktop/vue/nxx-ui/packages/components/select-v2/src/option-item-checkbox.vue"]]);const bt="ElSelectV2Injection";function El(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!$t(e)}var Tl=be({name:"ElSelectDropdown",props:{data:{type:Array,required:!0},hoveringIndex:Number,width:Number},setup(e,{slots:t,expose:o}){const s=ze(bt),u=ne("select"),f=ze("$custom-style-filter",{}),{t:d}=ut(),n=O([]),S=O(),{props:{modelValue:E,showChecked:b,valueKey:v}}=s,m=O(!1),i=O(!1),R=r=>{m.value=r,e.data.forEach(p=>{p.checked=r}),i.value=!1,Z(0)},T=I(()=>e.data.length);if(te(()=>T.value,()=>{var r,p;b&&C(),(p=(r=s.popper.value).updatePopper)==null||p.call(r)}),te(()=>s.props.modelValue,r=>{var p,V;if(b){e.data.forEach(B=>{B.checked=r.includes(H(B,v))});const M=r.length;m.value=M===T.value,i.value=M>0&&M<T.value}(V=(p=s.popper.value)==null?void 0:p.updatePopper)==null||V.call(p)},{deep:!0}),b){e.data.forEach(p=>{p.checked=E.includes(H(p,v))});const r=E.length;m.value=r===T.value,i.value=r>0&&r<T.value}const Z=r=>{s.onHover(r-1),Q(()=>{s.onHover(r),C()})},C=()=>{const r=e.data.filter(p=>p.checked).length;m.value=r===T.value,i.value=r>0&&r<T.value},_=()=>{s.onSelectMultiple((s.props.options||[]).filter(r=>r.checked)),s.handleClickOutside()},$e=()=>{R(!1)},J=I(()=>xt(s.props.estimatedOptionHeight)),ge=I(()=>J.value?{itemSize:s.props.itemHeight}:{estimatedSize:s.props.estimatedOptionHeight,itemSize:r=>n.value[r]}),ye=(r=[],p)=>{const{props:{valueKey:V}}=s;return he(p)?r&&r.some(M=>H(M,V)===H(p,V)):r.includes(p)},Be=(r,p)=>{if(he(p)){const{valueKey:V}=s.props;return H(r,V)===H(p,V)}else return r===p},oe=(r,p)=>{const{valueKey:V}=s.props;return s.props.multiple?ye(r,H(p,V)):Be(r,H(p,V))},Se=(r,p)=>{const{disabled:V,multiple:M,multipleLimit:B}=s.props;return V||!p&&(M?B>0&&r.length>=B:!1)},ae=r=>e.hoveringIndex===r;o({listRef:S,isSized:J,isItemDisabled:Se,isItemHovering:ae,isItemSelected:oe,scrollToItem:r=>{const p=S.value;p&&p.scrollToItem(r)},resetScrollTop:()=>{const r=S.value;r&&r.resetScrollTop()}});const Ke=r=>{const{index:p,data:V,style:M}=r,B=Oe(J),{itemSize:j,estimatedSize:X}=Oe(ge),{modelValue:G,showChecked:ie,radio:re}=s.props,{onSelect:Ae,onHover:ue}=s,z=V[p];if(z.type==="Group")return k(hl,{item:z,style:M,height:B?j:X},null);const de=oe(G,z),ce=Se(G,de),pe=ae(p);return ie?k(Ol,We(r,{disabled:z.disabled||ce,created:!!z.created,hovering:pe,item:z,onSelect:Z,onHover:ue}),{default:fe=>{var A;return((A=t.default)==null?void 0:A.call(t,fe))||k("span",null,[z.label])}}):k(Vl,We(r,{radio:re,selected:de,disabled:z.disabled||ce,created:!!z.created,hovering:pe,item:z,onSelect:Ae,onHover:ue}),{default:fe=>{var A;return((A=t.default)==null?void 0:A.call(t,fe))||k("span",null,[z.label])}})},{onKeyboardNavigate:se,onKeyboardSelect:Ie}=s,Le=()=>{se("forward")},Ce=()=>{se("backward")},De=()=>{s.expanded=!1},He=r=>{const{code:p}=r,{tab:V,esc:M,down:B,up:j,enter:X}=jt;switch(p!==V&&(r.preventDefault(),r.stopPropagation()),p){case V:case M:{De();break}case B:{Le();break}case j:{Ce();break}case X:{Ie();break}}};return()=>{var r;let p;const{data:V,width:M}=e,{height:B,multiple:j,scrollbarAlwaysOn:X,showChecked:G}=s.props;if(V.length===0)return k("div",{class:u.b("dropdown"),style:{width:`${M}px`}},[(r=t.empty)==null?void 0:r.call(t)]);const ie=Oe(J)?nl:fl;return k("div",{class:[u.b("dropdown"),u.is("multiple",j)]},[G?k("div",{class:u.b("dropdown__option-item")},[k(pt,{modelValue:m.value,indeterminate:i.value,onChange:R},El(p=d("el.colorpicker.selectAll"))?p:{default:()=>[p]})]):null,k(ie,We({ref:S},Oe(ge),{className:u.be("dropdown","list"),scrollbarAlwaysOn:X,data:V,height:B,width:M,total:V.length,onKeydown:He}),{default:re=>k(Ke,re,null)}),G?k("div",{class:[u.b("btn-group")],style:ft(f,["border"])},[k("div",{onClick:$e,class:[u.b("btn")],style:{color:"#000000",background:"#ffffff"}},[d("el.datepicker.clear")]),k("div",{onClick:_,class:[u.b("btn")],style:{color:"#ffffff",background:"#3370FF"}},[d("el.datepicker.confirm")])]):null])}}});function Ml(e,t){const o=O(0),s=O(null),u=I(()=>e.allowCreate&&e.filterable);function f(b){const v=m=>m.value===b;return e.options&&e.options.some(v)||t.createdOptions.some(v)}function d(b){u.value&&(e.multiple&&b.created?o.value++:s.value=b)}function n(b){if(u.value)if(b&&b.length>0&&!f(b)){const v={value:b,label:b,created:!0,disabled:!1};t.createdOptions.length>=o.value?t.createdOptions[o.value]=v:t.createdOptions.push(v)}else if(e.multiple)t.createdOptions.length=o.value;else{const v=s.value;t.createdOptions.length=0,v&&v.created&&t.createdOptions.push(v)}}function S(b){if(!u.value||!b||!b.created||b.created&&e.reserveKeyword&&t.inputValue===b.label)return;const v=t.createdOptions.findIndex(m=>m.value===b.value);~v&&(t.createdOptions.splice(v,1),o.value--)}function E(){u.value&&(t.createdOptions.length=0,o.value=0)}return{createNewOption:n,removeNewOption:S,selectNewOption:d,clearAllNewOption:E}}const zl=e=>{const t=[];return e.forEach(o=>{Te(o.options)?(t.push({label:o.label,isTitle:!0,type:"Group"}),o.options.forEach(s=>{t.push(s)}),t.push({type:"Group"})):t.push(o)}),t};function Nl(e){const t=O(!1);return{handleCompositionStart:()=>{t.value=!0},handleCompositionUpdate:f=>{const d=f.target.value,n=d[d.length-1]||"";t.value=!Gt(n)},handleCompositionEnd:f=>{t.value&&(t.value=!1,Ge(e)&&e(f))}}}const st="",it=11,$l={larget:51,default:42,small:33},Bl=(e,t)=>{const{t:o}=ut(),s=ne("select-v2"),u=ne("input"),{form:f,formItem:d}=qt(),n=rt({inputValue:st,displayInputValue:st,calculatedWidth:0,cachedPlaceholder:"",cachedOptions:[],createdOptions:[],createdLabel:"",createdSelected:!1,currentPlaceholder:"",hoveringIndex:-1,comboBoxHovering:!1,isOnComposition:!1,isSilentBlur:!1,isComposing:!1,inputLength:20,selectWidth:200,initialInputHeight:0,previousQuery:null,previousValue:void 0,query:"",selectedLabel:"",softFocus:!1,tagInMultiLine:!1}),S=O(-1),E=O(-1),b=O(null),v=O(null),m=O(null),i=O(null),R=O(null),T=O(null),Z=O(null),C=O(!1),_=I(()=>e.disabled||(f==null?void 0:f.disabled)),$e=I(()=>{const l=$.value.length*34;return l>e.height?e.height:l}),J=I(()=>!nt(e.modelValue)),ge=I(()=>{const l=e.multiple?Array.isArray(e.modelValue)&&e.modelValue.length>0:J.value;return e.clearable&&!_.value&&n.comboBoxHovering&&l}),ye=I(()=>e.remote&&e.filterable?"":_t),Be=I(()=>ye.value&&s.is("reverse",C.value)),oe=I(()=>(d==null?void 0:d.validateState)||""),Se=I(()=>Qt[oe.value]),ae=I(()=>e.remote?300:0),Ve=I(()=>{const l=$.value;return e.loading?e.loadingText||o("el.select.loading"):e.remote&&n.inputValue===""&&l.length===0?!1:e.filterable&&n.inputValue&&l.length>0?e.noMatchText||o("el.select.noMatch"):l.length===0?e.noDataText||o("el.select.noData"):null}),$=I(()=>{const l=a=>{const c=n.inputValue,h=new RegExp(ul(c),"i");return c?h.test(a.label||""):!0};return e.loading?[]:zl(e.options.concat(n.createdOptions).map(a=>{if(Te(a.options)){const c=a.options.filter(l);if(c.length>0)return{...a,options:c}}else if(e.remote||l(a))return a;return null}).filter(a=>a!==null))}),Ke=I(()=>$.value.every(l=>l.disabled)),se=Zt(),Ie=I(()=>se.value==="small"?"small":"default"),Le=I(()=>{const l=T.value,a=Ie.value||"default",c=l?Number.parseInt(getComputedStyle(l).paddingLeft):0,h=l?Number.parseInt(getComputedStyle(l).paddingRight):0;return n.selectWidth-h-c-$l[a]}),Ce=()=>{var l;E.value=((l=R.value)==null?void 0:l.offsetWidth)||200},De=I(()=>({width:`${n.calculatedWidth===0?it:Math.ceil(n.calculatedWidth)+it}px`})),He=I(()=>Te(e.modelValue)?e.modelValue.length===0&&!n.displayInputValue:e.filterable?n.displayInputValue.length===0:!0),r=I(()=>{const l=e.placeholder||o("el.select.placeholder");return e.multiple||nt(e.modelValue)?l:n.selectedLabel}),p=I(()=>{var l,a;return(a=(l=i.value)==null?void 0:l.popperRef)==null?void 0:a.contentRef}),V=I(()=>{if(e.multiple){const l=e.modelValue.length;if(e.modelValue.length>0)return $.value.findIndex(a=>a.value===e.modelValue[l-1])}else if(e.modelValue)return $.value.findIndex(l=>l.value===e.modelValue);return-1}),M=I({get(){return C.value&&Ve.value!==!1},set(l){C.value=l}}),{createNewOption:B,removeNewOption:j,selectNewOption:X,clearAllNewOption:G}=Ml(e,n),{handleCompositionStart:ie,handleCompositionUpdate:re,handleCompositionEnd:Ae}=Nl(l=>Xe(l)),ue=()=>{var l,a,c;(a=(l=v.value).focus)==null||a.call(l),(c=i.value)==null||c.updatePopper()},z=()=>{if(!e.automaticDropdown&&!_.value)return n.isComposing&&(n.softFocus=!0),Q(()=>{var l,a;C.value=!C.value,(a=(l=v.value)==null?void 0:l.focus)==null||a.call(l)})},de=()=>(e.filterable&&n.inputValue!==n.selectedLabel&&(n.query=n.selectedLabel),pe(n.inputValue),Q(()=>{B(n.inputValue)})),ce=rl(de,ae.value),pe=l=>{n.previousQuery!==l&&(n.previousQuery=l,e.filterable&&Ge(e.filterMethod)?e.filterMethod(l):e.filterable&&e.remote&&Ge(e.remoteMethod)&&e.remoteMethod(l))},fe=l=>{ot(e.modelValue,l)||t(ct,l)},A=l=>{t(dt,l),fe(l),n.previousValue=l==null?void 0:l.toString()},gt=(l=[],a)=>{if(!he(a))return l.indexOf(a);const c=e.valueKey;let h=-1;return l.some((U,W)=>H(U,c)===H(a,c)?(h=W,!0):!1),h},ee=l=>he(l)?H(l,e.valueKey):l,yt=l=>he(l)?l.label:l,Re=()=>{if(!(e.collapseTags&&!e.filterable))return Q(()=>{var l,a;if(!v.value)return;const c=T.value;R.value.height=c.offsetHeight,C.value&&Ve.value!==!1&&((a=(l=i.value)==null?void 0:l.updatePopper)==null||a.call(l))})},qe=()=>{var l,a;if(St(),Ce(),(a=(l=i.value)==null?void 0:l.updatePopper)==null||a.call(l),e.multiple)return Re()},St=()=>{const l=T.value;l&&(n.selectWidth=l.getBoundingClientRect().width)},Qe=(l,a,c=!0)=>{var h,U;if(e.multiple){let W=e.modelValue.slice();const we=gt(W,ee(l));we>-1?(W=[...W.slice(0,we),...W.slice(we+1)],n.cachedOptions.splice(we,1),j(l)):(e.multipleLimit<=0||W.length<e.multipleLimit)&&(W=[...W,ee(l)],n.cachedOptions.push(l),X(l),Y(a)),A(W),l.created&&(n.query="",pe(""),n.inputLength=20),e.filterable&&!e.reserveKeyword&&((U=(h=v.value).focus)==null||U.call(h),ke("")),e.filterable&&(n.calculatedWidth=Z.value.getBoundingClientRect().width),Re(),Mt()}else S.value=a,n.selectedLabel=l.label,A(ee(l)),C.value=!1,n.isComposing=!1,n.isSilentBlur=c,X(l),l.created||G(),Y(a)},Vt=l=>{const{valueKey:a}=e;let c=[...l.map(h=>H(h,a))];n.cachedOptions=[...l],Y(0),A(c)},It=(l,a)=>{const{valueKey:c}=e,h=e.modelValue.indexOf(H(a,c));if(h>-1&&!_.value){const U=[...e.modelValue.slice(0,h),...e.modelValue.slice(h+1)];return n.cachedOptions.splice(h,1),A(U),t("remove-tag",H(a,c)),n.softFocus=!0,j(a),Q(ue)}l.stopPropagation()},Ct=l=>{const a=n.isComposing;n.isComposing=!0,n.softFocus?n.softFocus=!1:a||t("focus",l)},Ze=l=>(n.softFocus=!1,Q(()=>{var a,c;(c=(a=v.value)==null?void 0:a.blur)==null||c.call(a),Z.value&&(n.calculatedWidth=Z.value.getBoundingClientRect().width),n.isSilentBlur?n.isSilentBlur=!1:n.isComposing&&t("blur",l),n.isComposing=!1})),kt=()=>{n.displayInputValue.length>0?ke(""):C.value=!1},wt=l=>{if(!e.showChecked&&n.displayInputValue.length===0){l.preventDefault();const a=e.modelValue.slice();a.pop(),j(n.cachedOptions.pop()),A(a)}},Ot=()=>{let l;return Te(e.modelValue)?l=[]:l=void 0,n.softFocus=!0,e.multiple?n.cachedOptions=[]:n.selectedLabel="",C.value=!1,A(l),t("clear"),G(),Q(ue)},ke=l=>{n.displayInputValue=l,n.inputValue=l},Je=(l,a=void 0)=>{const c=$.value;if(!["forward","backward"].includes(l)||_.value||c.length<=0||Ke.value)return;if(!C.value)return z();a===void 0&&(a=n.hoveringIndex);let h=-1;l==="forward"?(h=a+1,h>=c.length&&(h=0)):l==="backward"&&(h=a-1,(h<0||h>=c.length)&&(h=c.length-1));const U=c[h];if(U.disabled||U.type==="Group")return Je(l,h);Y(h),Fe(h)},Et=()=>{const{showChecked:l}=e;if(!l)if(C.value)~n.hoveringIndex&&$.value[n.hoveringIndex]&&Qe($.value[n.hoveringIndex],n.hoveringIndex,!1);else return z()},Y=l=>{n.hoveringIndex=l},Tt=()=>{n.hoveringIndex=-1},Mt=()=>{var l;const a=v.value;a&&((l=a.focus)==null||l.call(a))},Xe=l=>{const a=l.target.value;if(ke(a),n.displayInputValue.length>0&&!C.value&&(C.value=!0),n.calculatedWidth=Z.value.getBoundingClientRect().width,e.multiple&&Re(),e.remote)ce();else return de()},zt=()=>(C.value=!1,Ze()),Nt=()=>(n.inputValue=n.displayInputValue,Q(()=>{~V.value&&(Y(V.value),Fe(n.hoveringIndex))})),Fe=l=>{m.value.scrollToItem(l)},Ue=()=>{if(Tt(),e.multiple)if(e.modelValue.length>0){let l=!1;n.cachedOptions.length=0,n.previousValue=e.modelValue.toString(),e.modelValue.forEach(a=>{const c=$.value.findIndex(h=>ee(h)===a);~c&&(n.cachedOptions.push($.value[c]),l||Y(c),l=!0)})}else n.cachedOptions=[],n.previousValue=void 0;else if(J.value){n.previousValue=e.modelValue;const l=$.value,a=l.findIndex(c=>ee(c)===ee(e.modelValue));~a?(n.selectedLabel=l[a].label,Y(a)):n.selectedLabel=`${e.modelValue}`}else n.selectedLabel="",n.previousValue=void 0;G(),Ce()};return te(C,l=>{var a,c;t("visible-change",l),l?(c=(a=i.value).update)==null||c.call(a):(n.displayInputValue="",n.previousQuery=null,B(""))}),te(()=>e.modelValue,(l,a)=>{var c;(!l||l.toString()!==n.previousValue)&&Ue(),!ot(l,a)&&e.validateEvent&&((c=d==null?void 0:d.validate)==null||c.call(d,"change").catch(h=>el()))},{deep:!0}),te(()=>e.options,()=>{const l=v.value;(!l||l&&document.activeElement!==l)&&Ue()},{deep:!0}),te($,()=>Q(m.value.resetScrollTop)),Bt(()=>{Ue()}),tl(R,qe),{collapseTagSize:Ie,currentPlaceholder:r,expanded:C,emptyText:Ve,popupHeight:$e,debounce:ae,filteredOptions:$,iconComponent:ye,iconReverse:Be,inputWrapperStyle:De,popperSize:E,dropdownMenuVisible:M,hasModelValue:J,shouldShowPlaceholder:He,selectDisabled:_,selectSize:se,showClearBtn:ge,states:n,tagMaxWidth:Le,nsSelectV2:s,nsInput:u,calculatorRef:Z,controlRef:b,inputRef:v,menuRef:m,popper:i,selectRef:R,selectionRef:T,popperRef:p,validateState:oe,validateIcon:Se,debouncedOnInputChange:ce,deleteTag:It,getLabel:yt,getValueKey:ee,handleBlur:Ze,handleClear:Ot,handleClickOutside:zt,handleDel:wt,handleEsc:kt,handleFocus:Ct,handleMenuEnter:Nt,handleResize:qe,toggleMenu:z,scrollTo:Fe,onInput:Xe,onKeyboardNavigate:Je,onKeyboardSelect:Et,onSelect:Qe,onSelectMultiple:Vt,onHover:Y,onUpdateInputValue:ke,handleCompositionStart:ie,handleCompositionEnd:Ae,handleCompositionUpdate:re}},Kl=be({name:"ElSelectV2",components:{ElSelectMenu:Tl,ElTag:Wt,ElTooltip:Ut,ElIcon:Jt},directives:{ClickOutside:dl,ModelText:Kt},props:bl,emits:[dt,ct,"remove-tag","clear","visible-change","focus","blur"],setup(e,{emit:t}){const o=Bl(e,t);Ye(bt,{props:rt({...Lt(e),height:o.popupHeight}),displayInputValue:o.states,popper:o.popper,onSelect:o.onSelect,onSelectMultiple:o.onSelectMultiple,onHover:o.onHover,handleClickOutside:o.handleClickOutside,onKeyboardNavigate:o.onKeyboardNavigate,onKeyboardSelect:o.onKeyboardSelect}),Ye("displayInputValue",o.states);const s=ze("$custom-style-filter",{});return{...o,customStyle:s,formatterStyle:ft}}}),Ll={key:0},Dl=["id","autocomplete","aria-expanded","aria-labelledby","disabled","readonly","name","unselectable"],Hl=["textContent"],Al=["id","aria-labelledby","aria-expanded","autocomplete","disabled","name","readonly","unselectable"],Rl=["textContent"];function Fl(e,t,o,s,u,f){const d=me("el-tag"),n=me("el-tooltip"),S=me("el-icon"),E=me("el-select-menu"),b=xe("model-text"),v=xe("click-outside");return Ee((y(),w("div",{ref:"selectRef",class:g([e.nsSelectV2.b(),e.nsSelectV2.m(e.selectSize)]),onClick:t[25]||(t[25]=L((...m)=>e.toggleMenu&&e.toggleMenu(...m),["stop"])),onMouseenter:t[26]||(t[26]=m=>e.states.comboBoxHovering=!0),onMouseleave:t[27]||(t[27]=m=>e.states.comboBoxHovering=!1)},[k(n,{ref:"popper",visible:e.dropdownMenuVisible,teleported:e.teleported,"popper-class":[e.nsSelectV2.e("popper"),e.popperClass],"gpu-acceleration":!1,"stop-popper-mouse-event":!1,"popper-options":e.popperOptions,"fallback-placements":["bottom-start","top-start","right","left"],effect:e.effect,placement:e.placement,"show-arrow":!1,pure:"",transition:`${e.nsSelectV2.namespace.value}-zoom-in-top`,trigger:"click",persistent:e.persistent,onBeforeShow:e.handleMenuEnter,onHide:t[24]||(t[24]=m=>e.states.inputValue=e.states.displayInputValue)},{default:K(()=>{var m;return[N("div",{ref:"selectionRef",class:g([e.nsSelectV2.e("wrapper"),e.nsSelectV2.is("focused",e.states.isComposing||e.expanded),e.nsSelectV2.is("hovering",e.states.comboBoxHovering),e.nsSelectV2.is("filterable",e.filterable),e.nsSelectV2.is("disabled",e.selectDisabled)]),style:D(e.formatterStyle(e.customStyle,["background","border"]))},[e.$slots.prefix?(y(),w("div",Ll,[ve(e.$slots,"prefix")])):x("v-if",!0),e.multiple?(y(),w("div",{key:1,class:g(e.nsSelectV2.e("selection"))},[e.collapseTags&&e.modelValue.length>0?(y(),w("div",{key:0,class:g(e.nsSelectV2.e("selected-item"))},[k(d,{closable:!e.selectDisabled&&!((m=e.states.cachedOptions[0])!=null&&m.disable)&&!e.showChecked,size:e.collapseTagSize,type:"info","disable-transitions":"",onClose:t[0]||(t[0]=i=>e.deleteTag(i,e.states.cachedOptions[0]))},{default:K(()=>{var i;return[N("span",{class:g(e.nsSelectV2.e("tags-text")),style:D({maxWidth:`${e.tagMaxWidth}px`})},F((i=e.states.cachedOptions[0])==null?void 0:i.label),7)]}),_:1},8,["closable","size"]),e.modelValue.length>1?(y(),P(d,{key:0,closable:!1,size:e.collapseTagSize,type:"info","disable-transitions":""},{default:K(()=>[e.collapseTagsTooltip?(y(),P(n,{key:0,disabled:e.dropdownMenuVisible,"fallback-placements":["bottom","top","right","left"],effect:e.effect,"show-arrow":!1,placement:"bottom",teleported:!1},{default:K(()=>[N("span",{class:g(e.nsSelectV2.e("tags-text")),style:D({maxWidth:`${e.tagMaxWidth}px`})},"+ "+F(e.modelValue.length-1),7)]),content:K(()=>[N("div",{class:g(e.nsSelectV2.e("selection"))},[(y(!0),w(Pe,null,_e(e.states.cachedOptions.slice(1),(i,R)=>(y(),w("div",{key:R,class:g(e.nsSelectV2.e("selected-item"))},[(y(),P(d,{key:e.getValueKey(i),closable:!e.selectDisabled&&!i.disabled&&!e.showChecked,size:e.collapseTagSize,class:"in-tooltip",type:"info","disable-transitions":"",onClose:T=>e.deleteTag(T,i)},{default:K(()=>[N("span",{class:g(e.nsSelectV2.e("tags-text")),style:D({maxWidth:`${e.tagMaxWidth}px`})},F(e.getLabel(i)),7)]),_:2},1032,["closable","size","onClose"]))],2))),128))],2)]),_:1},8,["disabled","effect"])):(y(),w("span",{key:1,class:g(e.nsSelectV2.e("tags-text")),style:D({maxWidth:`${e.tagMaxWidth}px`})},"+ "+F(e.modelValue.length-1),7))]),_:1},8,["size"])):x("v-if",!0)],2)):(y(!0),w(Pe,{key:1},_e(e.states.cachedOptions,(i,R)=>(y(),w("div",{key:R,class:g(e.nsSelectV2.e("selected-item"))},[(y(),P(d,{key:e.getValueKey(i),closable:!e.selectDisabled&&!i.disabled&&!e.showChecked,size:e.collapseTagSize,type:"info","disable-transitions":"",onClose:T=>e.deleteTag(T,i)},{default:K(()=>[N("span",{class:g(e.nsSelectV2.e("tags-text")),style:D({maxWidth:`${e.tagMaxWidth}px`})},F(e.getLabel(i)),7)]),_:2},1032,["closable","size","onClose"]))],2))),128)),N("div",{class:g([e.nsSelectV2.e("selected-item"),e.nsSelectV2.e("input-wrapper")]),style:D(e.inputWrapperStyle)},[Ee(N("input",{id:e.id,ref:"inputRef",autocomplete:e.autocomplete,"aria-autocomplete":"list","aria-haspopup":"listbox",autocapitalize:"off","aria-expanded":e.expanded,"aria-labelledby":e.label,class:g([e.nsSelectV2.is(e.selectSize),e.nsSelectV2.e("combobox-input")]),disabled:e.disabled,role:"combobox",readonly:!e.filterable,spellcheck:"false",type:"text",name:e.name,unselectable:e.expanded?"on":void 0,"onUpdate:modelValue":t[1]||(t[1]=(...i)=>e.onUpdateInputValue&&e.onUpdateInputValue(...i)),onFocus:t[2]||(t[2]=(...i)=>e.handleFocus&&e.handleFocus(...i)),onBlur:t[3]||(t[3]=(...i)=>e.handleBlur&&e.handleBlur(...i)),onInput:t[4]||(t[4]=(...i)=>e.onInput&&e.onInput(...i)),onCompositionstart:t[5]||(t[5]=(...i)=>e.handleCompositionStart&&e.handleCompositionStart(...i)),onCompositionupdate:t[6]||(t[6]=(...i)=>e.handleCompositionUpdate&&e.handleCompositionUpdate(...i)),onCompositionend:t[7]||(t[7]=(...i)=>e.handleCompositionEnd&&e.handleCompositionEnd(...i)),onKeydown:[t[8]||(t[8]=q(L(i=>e.onKeyboardNavigate("backward"),["stop","prevent"]),["up"])),t[9]||(t[9]=q(L(i=>e.onKeyboardNavigate("forward"),["stop","prevent"]),["down"])),t[10]||(t[10]=q(L((...i)=>e.onKeyboardSelect&&e.onKeyboardSelect(...i),["stop","prevent"]),["enter"])),t[11]||(t[11]=q(L((...i)=>e.handleEsc&&e.handleEsc(...i),["stop","prevent"]),["esc"])),t[12]||(t[12]=q(L((...i)=>e.handleDel&&e.handleDel(...i),["stop"]),["delete"]))]},null,42,Dl),[[b,e.states.displayInputValue]]),e.filterable?(y(),w("span",{key:0,ref:"calculatorRef","aria-hidden":"true",class:g(e.nsSelectV2.e("input-calculator")),textContent:F(e.states.displayInputValue)},null,10,Hl)):x("v-if",!0)],6)],2)):(y(),w(Pe,{key:2},[N("div",{class:g([e.nsSelectV2.e("selected-item"),e.nsSelectV2.e("input-wrapper")])},[Ee(N("input",{id:e.id,ref:"inputRef","aria-autocomplete":"list","aria-haspopup":"listbox","aria-labelledby":e.label,"aria-expanded":e.expanded,autocapitalize:"off",autocomplete:e.autocomplete,class:g(e.nsSelectV2.e("combobox-input")),disabled:e.disabled,name:e.name,role:"combobox",readonly:!e.filterable,spellcheck:"false",type:"text",style:D(e.formatterStyle(e.customStyle,["text"])),unselectable:e.expanded?"on":void 0,onCompositionstart:t[13]||(t[13]=(...i)=>e.handleCompositionStart&&e.handleCompositionStart(...i)),onCompositionupdate:t[14]||(t[14]=(...i)=>e.handleCompositionUpdate&&e.handleCompositionUpdate(...i)),onCompositionend:t[15]||(t[15]=(...i)=>e.handleCompositionEnd&&e.handleCompositionEnd(...i)),onFocus:t[16]||(t[16]=(...i)=>e.handleFocus&&e.handleFocus(...i)),onBlur:t[17]||(t[17]=(...i)=>e.handleBlur&&e.handleBlur(...i)),onInput:t[18]||(t[18]=(...i)=>e.onInput&&e.onInput(...i)),onKeydown:[t[19]||(t[19]=q(L(i=>e.onKeyboardNavigate("backward"),["stop","prevent"]),["up"])),t[20]||(t[20]=q(L(i=>e.onKeyboardNavigate("forward"),["stop","prevent"]),["down"])),t[21]||(t[21]=q(L((...i)=>e.onKeyboardSelect&&e.onKeyboardSelect(...i),["stop","prevent"]),["enter"])),t[22]||(t[22]=q(L((...i)=>e.handleEsc&&e.handleEsc(...i),["stop","prevent"]),["esc"]))],"onUpdate:modelValue":t[23]||(t[23]=(...i)=>e.onUpdateInputValue&&e.onUpdateInputValue(...i))},null,46,Al),[[b,e.states.displayInputValue]])],2),e.filterable?(y(),w("span",{key:0,ref:"calculatorRef","aria-hidden":"true",class:g([e.nsSelectV2.e("selected-item"),e.nsSelectV2.e("input-calculator")]),textContent:F(e.states.displayInputValue)},null,10,Rl)):x("v-if",!0)],64)),e.shouldShowPlaceholder?(y(),w("span",{key:3,class:g([e.nsSelectV2.e("placeholder"),e.nsSelectV2.is("transparent",e.multiple?e.modelValue.length===0:!e.hasModelValue)]),style:D(e.formatterStyle(e.customStyle,["text"]))},F(e.currentPlaceholder),7)):x("v-if",!0),N("span",{class:g(e.nsSelectV2.e("suffix"))},[e.iconComponent?Ee((y(),P(S,{key:0,class:g([e.nsSelectV2.e("caret"),e.nsInput.e("icon"),e.iconReverse])},{default:K(()=>[(y(),P(je(e.iconComponent)))]),_:1},8,["class"])),[[Dt,!e.showClearBtn]]):x("v-if",!0),e.showClearBtn&&e.clearIcon?(y(),P(S,{key:1,class:g([e.nsSelectV2.e("caret"),e.nsInput.e("icon")]),onClick:L(e.handleClear,["prevent","stop"])},{default:K(()=>[(y(),P(je(e.clearIcon)))]),_:1},8,["class","onClick"])):x("v-if",!0),e.validateState&&e.validateIcon?(y(),P(S,{key:2,class:g([e.nsInput.e("icon"),e.nsInput.e("validateIcon")])},{default:K(()=>[(y(),P(je(e.validateIcon)))]),_:1},8,["class"])):x("v-if",!0)],2)],6)]}),content:K(()=>[k(E,{ref:"menuRef",data:e.filteredOptions,width:e.popperSize,"hovering-index":e.states.hoveringIndex,"scrollbar-always-on":e.scrollbarAlwaysOn},{default:K(m=>[ve(e.$slots,"default",Ht(At(m)))]),empty:K(()=>[ve(e.$slots,"empty",{},()=>[N("p",{class:g(e.nsSelectV2.e("empty"))},F(e.emptyText?e.emptyText:""),3)])]),_:3},8,["data","width","hovering-index","scrollbar-always-on"])]),_:3},8,["visible","teleported","popper-class","popper-options","effect","placement","transition","persistent","onBeforeShow"])],34)),[[v,e.handleClickOutside,e.popperRef]])}var Me=Ne(Kl,[["render",Fl],["__file","/Users/st/Desktop/vue/nxx-ui/packages/components/select-v2/src/select.vue"]]);Me.install=e=>{e.component(Me.name,Me)};const Ul=Me,_l=Ul;export{_l as E};
