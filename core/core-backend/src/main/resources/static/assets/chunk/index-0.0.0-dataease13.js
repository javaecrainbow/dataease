import{a as fe,b as we}from"./index-0.0.0-dataease.js";import{E as ke}from"./el-row-0.0.0-dataease.js";import{E as be}from"./el-divider-0.0.0-dataease.js";import"./el-tooltip-0.0.0-dataease.js";import"./el-popper-0.0.0-dataease.js";import{u as Ce,v as ye,j as ge,e as Se,w as Fe,_ as Te}from"./index-0.0.0-dataease2.js";import{f as l,M as _,a8 as xe,d as Ee,m as f,r as w,s as Ae,_ as Me,w as Ne,ab as Ue,U as k,j as s,N as a,k as n,i as p,a7 as m,a0 as x,Z as b,aa as E,V as A,g as M,a6 as I,X as N,a9 as B,q as De,W as Pe}from"./vue-0.0.0-dataease.js";import{i as Re,a as qe}from"./ShareGrid-0.0.0-dataease.js";import{i as Le}from"./icon_dashboard_outlined-0.0.0-dataease.js";import{i as Ve}from"./icon_operation-analysis_outlined-0.0.0-dataease.js";import{u as Ie}from"./user-img-0.0.0-dataease.js";import{s as Be,n as Oe}from"./templateMarket-0.0.0-dataease.js";import{i as He}from"./interactive-0.0.0-dataease.js";import $e from"./ShortcutTable-0.0.0-dataease.js";import{useUserStoreWithOut as We}from"./user-0.0.0-dataease.js";import Ze from"./TemplateBranchItem-0.0.0-dataease.js";import{_ as ze}from"./DeResourceCreateOptV2.vue_vue_type_style_index_0_lang-0.0.0-dataease.js";import{g as je}from"./base64-0.0.0-dataease.js";import{useAppStoreWithOut as Je}from"./app-0.0.0-dataease.js";import{u as Xe}from"./share-0.0.0-dataease.js";import{q as Ge}from"./dataVisualization-0.0.0-dataease.js";import{E as Ke}from"./index-0.0.0-dataease4.js";import{_ as Qe}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./library-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./row-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./el-table-column-0.0.0-dataease.js";import"./el-checkbox-0.0.0-dataease.js";import"./index-0.0.0-dataease5.js";import"./el-tag-0.0.0-dataease.js";import"./el-col-0.0.0-dataease.js";import"./el-select-0.0.0-dataease.js";import"./index-0.0.0-dataease14.js";import"./strings-0.0.0-dataease.js";import"./icon_search-outline_outlined-0.0.0-dataease.js";import"./dv-dashboard-spine-mobile-0.0.0-dataease.js";import"./icon_pc_outlined-0.0.0-dataease.js";import"./GridTable-0.0.0-dataease.js";import"./el-pagination-0.0.0-dataease.js";import"./EmptyBackground-0.0.0-dataease.js";import"./el-empty-0.0.0-dataease.js";import"./none-0.0.0-dataease.js";import"./nothing-tree-0.0.0-dataease.js";import"./dayjs.min-0.0.0-dataease.js";import"./ShareHandler-0.0.0-dataease.js";import"./el-dialog-0.0.0-dataease.js";import"./use-dialog-0.0.0-dataease.js";import"./refs-0.0.0-dataease.js";import"./el-date-picker-0.0.0-dataease.js";import"./arrays-0.0.0-dataease.js";import"./index-0.0.0-dataease15.js";import"./el-switch-0.0.0-dataease.js";import"./icon_admin_outlined-0.0.0-dataease.js";import"./ShareTicket-0.0.0-dataease.js";import"./icon_left_outlined-0.0.0-dataease.js";import"./de-copy-0.0.0-dataease.js";import"./icon_refresh_outlined-0.0.0-dataease.js";import"./dv-info-0.0.0-dataease.js";import"./icon_delete-trash_outlined-0.0.0-dataease.js";import"./icon_edit_outlined-0.0.0-dataease.js";import"./icon_add_outlined-0.0.0-dataease.js";import"./index-0.0.0-dataease16.js";import"./dataset-0.0.0-dataease.js";import"./datasource-0.0.0-dataease.js";import"./el-tabs-0.0.0-dataease.js";import"./visual-star-0.0.0-dataease.js";import"./ShortcutOption-0.0.0-dataease.js";import"./imgUtils-0.0.0-dataease.js";import"./dvMain-0.0.0-dataease.js";import"./chart-0.0.0-dataease.js";import"./formatter-0.0.0-dataease.js";import"./dataVisualization-0.0.0-dataease2.js";import"./util-0.0.0-dataease.js";import"./util-0.0.0-dataease2.js";import"./chart-0.0.0-dataease2.js";import"./antv-0.0.0-dataease.js";import"./extends-0.0.0-dataease.js";import"./sysParameter-0.0.0-dataease.js";import"./TableTooltip-0.0.0-dataease.js";import"./_commonjs-dynamic-modules-0.0.0-dataease.js";import"./appearance-0.0.0-dataease.js";import"./font-0.0.0-dataease.js";import"./index-0.0.0-dataease17.js";import"./el-tree-0.0.0-dataease.js";import"./index-0.0.0-dataease12.js";import"./MarketPreviewV2-0.0.0-dataease.js";import"./el-collapse-item-0.0.0-dataease.js";import"./TemplateMarketPreviewItem-0.0.0-dataease.js";import"./CategoryTemplateV2-0.0.0-dataease.js";import"./TemplateMarketV2Item-0.0.0-dataease.js";const Ye={width:"32",height:"32",viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg"};function et(O,C){return l(),_("svg",Ye,C[0]||(C[0]=[xe('<path d="M4 2.66666C4 1.93028 4.59695 1.33333 5.33333 1.33333H21.1477C21.3265 1.33333 21.4979 1.40515 21.6232 1.53267L27.8088 7.82587C27.9313 7.95055 28 8.11838 28 8.2932V29.3333C28 30.0697 27.403 30.6667 26.6667 30.6667H5.33333C4.59695 30.6667 4 30.0697 4 29.3333V2.66666Z" fill="#FF8800"></path><path d="M9.33398 11.3333C9.33398 10.9651 9.63246 10.6667 10.0007 10.6667H22.0007C22.3688 10.6667 22.6673 10.9651 22.6673 11.3333V12.6667C22.6673 13.0349 22.3688 13.3333 22.0007 13.3333H10.0007C9.63246 13.3333 9.33398 13.0349 9.33398 12.6667V11.3333Z" fill="white"></path><path d="M14.6673 16.6667C14.6673 16.2985 14.9658 16 15.334 16H22.0007C22.3688 16 22.6673 16.2985 22.6673 16.6667V23.3333C22.6673 23.7015 22.3688 24 22.0007 24H15.334C14.9658 24 14.6673 23.7015 14.6673 23.3333V16.6667Z" fill="white"></path><path d="M10.0007 16C9.63246 16 9.33398 16.2985 9.33398 16.6667V23.3333C9.33398 23.7015 9.63246 24 10.0007 24H11.334C11.7022 24 12.0007 23.7015 12.0007 23.3333V16.6667C12.0007 16.2985 11.7022 16 11.334 16H10.0007Z" fill="white"></path><path d="M21.334 1.33333C21.4429 1.36489 21.5429 1.424 21.6238 1.50632L27.8094 7.79952C27.8601 7.85104 27.9015 7.90993 27.9327 7.97364H22.8475C22.0116 7.97364 21.334 7.29602 21.334 6.46013V1.33333Z" fill="#D97400"></path>',5)]))}const tt={render:et},at={class:"workbranch"},ot={class:"info-quick-creation"},rt={class:"user-info"},st={class:"info"},nt={class:"name-role flex-align-center"},it={class:"name"},lt={key:0,class:"id"},mt={class:"name"},ct={class:"num"},pt={class:"quick-creation"},ut={class:"label"},dt={class:"item-creation"},_t=["onClick"],vt={class:"name"},ht={class:"name"},ft={class:"template-market-dashboard"},wt={class:"template-market"},kt={class:"label"},bt={class:"expand-all"},Ct={class:"tab-btn"},yt=["onClick"],gt={class:"template-list"},St={style:{"text-align":"center"}},Ft={class:"no-result-tips"},Tt=Ee({__name:"index",setup(O){const C=Xe(),U=We(),H=He(),$=Ce(),W=ye(),{t:i}=ge(),y=f(()=>H.getData),D=w([]),{wsCache:Z}=fe(),{push:z}=B(),j=B(),P=w(null),J=we(),X=Je(),u=Ae([{icon:Le,name:"panel",color:"#3370ff"},{icon:Ve,name:"screen",color:"#00d6b9"},{icon:Re,name:"dataset",color:"#16c0ff"},{icon:qe,name:"datasource",color:"#7f3bf6"}]),h=w("fold"),G=()=>{h.value=h.value==="expand"?"fold":"expand"},K=f(()=>({PANEL:g.value,SCREEN:S.value})),g=f(()=>u.value[0].menuAuth&&u.value[0].anyManage),S=f(()=>u.value[1].menuAuth&&u.value[1].anyManage),Q=e=>{F.value=e},Y=[{name:i("work_branch.recommended_dashboard"),value:"PANEL"},{name:i("auth.screen"),value:"SCREEN"}],F=w("PANEL");u.value.map(e=>e.name).unshift("all_types");const t=Me({templateType:"PANEL",baseUrl:null,marketTemplatePreviewShowList:[],hasResult:!1,networkStatus:!0,loading:!1,dvCreateForm:{resourceName:null,templateId:null,name:null,pid:null,nodeType:"panel",templateUrl:null,newFrom:"new_market_template",panelType:"self",panelStyle:{},panelData:"[]"}});Ne(()=>F.value,()=>{R()});const ee=async()=>{await Be().then(e=>{t.baseUrl=e.data.baseUrl,t.marketTemplatePreviewShowList=e.data.contents,t.hasResult=!0,R()}).catch(()=>{t.networkStatus=!1})},R=()=>{t.hasResult=!1,t.marketTemplatePreviewShowList.forEach(e=>{e.showFlag=te(e),e.showFlag&&(t.hasResult=!0)})},te=e=>{let r=!1;return F.value===e.templateType&&(r=!0),r},ae=()=>{for(const e in y.value)e!=="3"&&D.value.push(y.value[e]),u.value[e]&&(u.value[e].menuAuth=y.value[e].menuAuth,u.value[e].anyManage=y.value[e].anyManage)},oe=(e,r)=>{if(r)switch(e){case 0:re();break;case 1:se();break;case 2:ne();break;case 3:ie();break}},re=()=>{const e="#/dashboard?opt=create";window.open(e,"_blank")},se=()=>{const e="#/dvCanvas?opt=create";window.open(e,"_blank")},ne=()=>{let e=j.resolve({path:"/dataset-form"});window.open(e.href,"_blank")},ie=()=>{const e="#/data/datasource?opt=create";window.open(e,"_blank")},le=e=>{Z.set("template-preview-id",e),q()},me=e=>{t.dvCreateForm.name=e.title,t.dvCreateForm.nodeType=e.templateType,e.source==="market"?(t.dvCreateForm.newFrom="new_market_template",t.dvCreateForm.templateUrl=e.metas.theme_repo,t.dvCreateForm.resourceName=e.id):(t.dvCreateForm.newFrom="new_inner_template",t.dvCreateForm.templateId=e.id),pe()},ce=f(()=>X.getIsDataEaseBi),pe=()=>{if(t.dvCreateForm.newFrom==="new_market_template"&&!t.dvCreateForm.templateUrl)return Fe.warning(i("work_branch.template_market_official")),!1;const e={newFrom:t.dvCreateForm.newFrom,templateUrl:t.dvCreateForm.templateUrl,resourceName:t.dvCreateForm.resourceName,templateId:t.dvCreateForm.templateId},r=(["dataV","SCREEN"].includes(t.dvCreateForm.nodeType)?"#/dvCanvas?opt=create&createType=template":"#/dashboard?opt=create&createType=template")+"&templateParams="+encodeURIComponent(je.encode(JSON.stringify(e)));let c=null,d="";ce.value&&(d=J.baseUrl),t.pid?c=window.open(d+r+`&pid=${t.pid}`,"_blank"):c=window.open(d+r,"_blank"),ue(c)},T=w(null),ue=e=>{if(T!=null&&T.value){const r={methodName:"initOpenHandler",args:e};T.value.invokeMethod(r)}},q=()=>{z("/template-market/index")},de=()=>{if(g.value||S.value){const e={curPosition:"branchCreate",templateType:"all"};P.value.optInit(e)}},_e=()=>{Ge().then(e=>{var c,d;const r={shareDisable:(c=e.data)==null?void 0:c.disable,sharePeRequire:(d=e.data)==null?void 0:d.peRequire};C.setData(r)})};return ae(),ee(),_e(),(e,r)=>{const c=Te,d=Se,L=Ke,ve=be,V=ke,he=Ue("loading");return k((l(),_("div",at,[a("div",ot,[a("div",rt,[n(d,{class:"main-color user-icon-container"},{default:p(()=>[n(c,{name:"user-img"},{default:p(()=>[n(s(Ie),{class:"svg-icon"})]),_:1})]),_:1}),a("div",st,[a("div",nt,[a("span",it,m(s(U).getName),1),r[0]||(r[0]=a("span",{class:"role main-btn"},null,-1))]),s(U).getUid?(l(),_("span",lt,m(`ID: ${s(U).getUid}`),1)):x("",!0)]),(l(!0),_(b,null,E(D.value,(o,v)=>(l(),_("div",{class:A(["item",{"de-item-hidden":!o.menuAuth}]),key:v},[a("span",mt,m(s(i)(`auth.${u.value[v].name}`)),1),a("span",ct,m(o.menuAuth?o.leafNodeCount:"*"),1)],2))),128))]),a("div",pt,[a("span",ut,m(s(i)("work_branch.create_quickly")),1),a("div",dt,[(l(!0),_(b,null,E(u.value,(o,v)=>(l(),_("div",{key:o.name,class:A(["item",{"quick-create-disabled":!o.menuAuth||!o.anyManage}]),onClick:Et=>oe(v,o.menuAuth&&o.anyManage)},[!o.menuAuth||!o.anyManage?(l(),M(L,{key:0,class:"box-item",effect:"dark",content:s(i)("work_branch.template_market_official"),placement:"top"},{default:p(()=>r[1]||(r[1]=[a("div",{class:"empty-tooltip-container"},null,-1)])),_:1},8,["content"])):x("",!0),n(d,{class:"main-color",style:Pe({backgroundColor:o.color})},{default:p(()=>[n(c,null,{default:p(()=>[(l(),M(De(o.icon),{class:"svg-icon"}))]),_:2},1024)]),_:2},1032,["style"]),a("span",vt,m(s(i)(`auth.${o.name}`)),1)],10,_t))),128)),a("div",{class:A(["item item-quick",{"quick-create-disabled":!(g.value||S.value)}]),onClick:de},[g.value||S.value?x("",!0):(l(),M(L,{key:0,class:"box-item",effect:"dark",content:s(i)("work_branch.permission_to_create"),placement:"top"},{default:p(()=>r[2]||(r[2]=[a("div",{class:"empty-tooltip-container-template"},null,-1)])),_:1},8,["content"])),n(d,{class:"main-color-quick template-create"},{default:p(()=>[n(c,{name:"icon_template_colorful"},{default:p(()=>[n(s(tt),{class:"svg-icon"})]),_:1})]),_:1}),a("span",ht,m(s(i)("work_branch.new_using_template")),1)],2)])])]),a("div",ft,[a("div",wt,[a("div",kt,[I(m(s(i)("work_branch.template_center"))+" ",1),a("div",bt,[a("button",{class:"all flex-center",onClick:q},m(s(i)("work_branch.view_all")),1),n(ve,{direction:"vertical"}),a("button",{onClick:G,class:"expand flex-center"},m(s(i)(`visualization.${h.value}`)),1)])]),h.value==="fold"?(l(),_(b,{key:0},[a("div",Ct,[(l(),_(b,null,E(Y,o=>a("div",{key:o.value,class:A([F.value===o.value&&"active","main-btn"]),onClick:v=>Q(o.value)},m(o.name),11,yt)),64))]),k(a("div",gt,[(l(!0),_(b,null,E(t.marketTemplatePreviewShowList,(o,v)=>k((l(),M(Ze,{key:v,template:o,"base-url":t.baseUrl,"create-auth":K.value,onTemplateApply:me,onTemplatePreview:le},null,8,["template","base-url","create-auth"])),[[N,o.showFlag]])),128))],512),[[N,t.networkStatus&&t.hasResult]]),k(n(V,{class:"template-empty"},{default:p(()=>[a("div",St,[n(c,{name:"no_result",class:"no-result"},{default:p(()=>[n(s(Oe),{class:"svg-icon no-result"})]),_:1}),r[3]||(r[3]=a("br",null,null,-1)),a("span",Ft,m(s(i)("work_branch.relevant_templates_found")),1)])]),_:1},512),[[N,t.networkStatus&&!t.hasResult]]),k(n(V,{class:"template-empty"},{default:p(()=>[I(m(s(i)("visualization.market_network_tips")),1)]),_:1},512),[[N,!t.networkStatus]])],64)):x("",!0)]),n($e,{expand:h.value==="expand"},null,8,["expand"])]),n(ze,{ref_key:"resourceCreateOpt",ref:P},null,512)])),[[he,s(W).loadingMap[s($).currentPath]]])}}});const vo=Qe(Tt,[["__scopeId","data-v-f4360042"]]);export{vo as default};
