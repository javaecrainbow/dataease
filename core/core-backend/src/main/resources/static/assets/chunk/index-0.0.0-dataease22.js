import{c as D,a as H,w as L,D as U,d as Y,r as S,m as F,n as G,o as M,b as Z,S as $,k as f,ag as j,Z as V,a5 as g,Y as W,U as X,X as q}from"./vue-0.0.0-dataease.js";import{n as T,t as k,s as J,v as Q,x as ee,p as oe,e as ne,k as b,c as te,i as ae,d as se,I as le,w as ce}from"./index-0.0.0-dataease23.js";import{u as re,a as ie,c as de}from"./use-route-0.0.0-dataease.js";import{u as ue,O as fe}from"./index-0.0.0-dataease25.js";import{P as ve,H as me}from"./index-0.0.0-dataease24.js";const ye={show:Boolean,zIndex:T,overlay:k,duration:T,teleport:[String,Object],lockScroll:k,lazyRender:k,beforeClose:Function,overlayStyle:Object,overlayClass:J,transitionAppear:Boolean,closeOnClickOverlay:k};let y=0;const A="van-overflow-hidden";function Ie(e,o){const a=re(),v="01",t="10",r=s=>{a.move(s);const u=a.deltaY.value>0?t:v,P=ee(s.target,e.value),{scrollHeight:m,offsetHeight:h,scrollTop:O}=P;let l="11";O===0?l=h>=m?"00":"01":O+h>=m&&(l="10"),l!=="11"&&a.isVertical()&&!(parseInt(l,2)&parseInt(u,2))&&oe(s,!0)},d=()=>{document.addEventListener("touchstart",a.start),document.addEventListener("touchmove",r,{passive:!1}),y||document.body.classList.add(A),y++},i=()=>{y&&(document.removeEventListener("touchstart",a.start),document.removeEventListener("touchmove",r),y--,y||document.body.classList.remove(A))},w=()=>o()&&d(),I=()=>o()&&i();Q(w),D(I),H(I),L(o,s=>{s?d():i()})}let he=2e3;const Oe=()=>++he,E=()=>{var e;const{scopeId:o}=((e=U())==null?void 0:e.vnode)||{};return o?{[o]:""}:null},Ce=ne({},ye,{round:Boolean,position:b("center"),closeIcon:b("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:b("top-right"),safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[ke,B]=te("popup");var we=Y({name:ke,inheritAttrs:!1,props:Ce,emits:["open","close","opened","closed","keydown","update:show","clickOverlay","clickCloseIcon"],setup(e,{emit:o,attrs:a,slots:v}){let t,r;const d=S(),i=S(),w=ue(()=>e.show||!e.lazyRender),I=F(()=>{const n={zIndex:d.value};if(ae(e.duration)){const c=e.position==="center"?"animationDuration":"transitionDuration";n[c]=`${e.duration}s`}return n}),s=()=>{t||(t=!0,d.value=e.zIndex!==void 0?+e.zIndex:Oe(),o("open"))},u=()=>{t&&de(e.beforeClose,{done(){t=!1,o("close"),o("update:show",!1)}})},P=n=>{o("clickOverlay",n),e.closeOnClickOverlay&&u()},m=()=>{if(e.overlay)return f(fe,g({show:e.show,class:e.overlayClass,zIndex:d.value,duration:e.duration,customStyle:e.overlayStyle,role:e.closeOnClickOverlay?"button":void 0,tabindex:e.closeOnClickOverlay?0:void 0},E(),{onClick:P}),{default:v["overlay-content"]})},h=n=>{o("clickCloseIcon",n),u()},O=()=>{if(e.closeable)return f(le,{role:"button",tabindex:0,name:e.closeIcon,class:[B("close-icon",e.closeIconPosition),me],classPrefix:e.iconPrefix,onClick:h},null)};let l;const _=()=>{l&&clearTimeout(l),l=setTimeout(()=>{o("opened")})},z=()=>o("closed"),R=n=>o("keydown",n),K=w(()=>{var n;const{round:c,position:C,safeAreaInsetTop:x,safeAreaInsetBottom:N}=e;return X(f("div",g({ref:i,style:I.value,role:"dialog",tabindex:0,class:[B({round:c,[C]:C}),{"van-safe-area-top":x,"van-safe-area-bottom":N}],onKeydown:R},a,E()),[(n=v.default)==null?void 0:n.call(v),O()]),[[q,e.show]])}),p=()=>{const{position:n,transition:c,transitionAppear:C}=e,x=n==="center"?"van-fade":`van-popup-slide-${n}`;return f(W,{name:c||x,appear:C,onAfterEnter:_,onAfterLeave:z},{default:K})};return L(()=>e.show,n=>{n&&!t&&(s(),a.tabindex===0&&G(()=>{var c;(c=i.value)==null||c.focus()})),!n&&t&&(t=!1,o("close"))}),ie({popupRef:i}),Ie(i,()=>e.show&&e.lockScroll),se("popstate",()=>{e.closeOnPopstate&&(u(),r=!1)}),M(()=>{e.show&&s()}),Z(()=>{r&&(o("update:show",!0),r=!1)}),D(()=>{e.show&&e.teleport&&(u(),r=!0)}),$(ve,()=>e.show),()=>e.teleport?f(j,{to:e.teleport},{default:()=>[m(),p()]}):f(V,null,[m(),p()])}});const Pe=ce(we);var Te=Pe;export{Pe as P,Te as s,E as u};
