import"./index-0.0.0-dataease.js";import{j,w as L,x as q,_ as A,e as O,y as U,n as H}from"./index-0.0.0-dataease2.js";import{i as K}from"./icon_search-outline_outlined-0.0.0-dataease.js";import{i as W}from"./icon_add_outlined-0.0.0-dataease.js";import{_ as Z}from"./UploadDetail.vue_vue_type_style_index_0_lang-0.0.0-dataease.js";import{useAppearanceStoreWithOut as z}from"./appearance-0.0.0-dataease.js";import{a as G,e as J,d as Q}from"./font-0.0.0-dataease.js";import{d as N}from"./lodash-0.0.0-dataease.js";import{d as R,r as h,m as X,o as Y,ab as ee,f as l,M as f,U as te,N as u,a6 as r,a7 as a,j as s,k as d,i,Z as E,aa as oe,a0 as p,g}from"./vue-0.0.0-dataease.js";import{_ as se}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./library-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./user-0.0.0-dataease.js";import"./el-dialog-0.0.0-dataease.js";import"./use-dialog-0.0.0-dataease.js";import"./refs-0.0.0-dataease.js";import"./el-form-0.0.0-dataease.js";import"./el-upload-0.0.0-dataease.js";import"./el-progress-0.0.0-dataease.js";import"./el-form-item-0.0.0-dataease.js";import"./icon_upload_outlined-0.0.0-dataease.js";import"./FontInfo-0.0.0-dataease.js";import"./icon_delete-trash_outlined-0.0.0-dataease.js";import"./antv-0.0.0-dataease.js";const ne={class:"font-management_system"},ae={class:"route-title"},le={class:"search-font"},ie={class:"font-content_overflow"},ce={class:"font-content_list"},re={key:0,class:"font-default"},ue={class:"font-name"},de={key:0,class:"font-type"},me=["title"],_e={class:"font-upload_btn"},fe=R({__name:"index",setup(pe){const v=z(),{t}=j(),k=h(""),w=h([]),b="./de2api",$=h(),c=h(!1),C=(n,e,_)=>{$.value.init(n,e,_)},D=async()=>{c.value=!0,await v.setFontList(),w.value=N(v.fontList),c.value=!1},B=X(()=>w.value.filter(n=>{var e;return(e=n.name)==null?void 0:e.toLocaleLowerCase().includes(k.value.trim().toLocaleLowerCase())})),T=n=>{if(n.isDefault){L.warning(t("system.fonts_before_deleting"));return}q.confirm(t("system.sure_to_delete"),{confirmButtonType:"danger",type:"warning",autofocus:!1,showClose:!1}).then(()=>{c.value=!0,G(n.id).then(()=>{L.success(t("common.delete_success")),D(),x()}).finally(()=>{c.value=!1})})},S=n=>{n.isDefault=1,c.value=!0,J(n).then(()=>{L.success(t("system.setting_successful")),x(),D()}).finally(()=>{c.value=!1})},V=(n,e,_)=>{let m=document.querySelector("#de-custom_font");!m&&e&&(m=document.createElement("style"),m.setAttribute("id","de-custom_font"),document.querySelector("head").appendChild(m)),m.innerHTML=e&&_?`@font-face {
              font-family: '${e}';
              src: url(${n});
              font-weight: normal;
              font-style: normal;
              }`:"",document.documentElement.style.setProperty("--de-custom_font",`${e||""}`),document.documentElement.style.setProperty("--van-base-font",`${e||""}`)},x=()=>{Q().then(n=>{const[e]=n||[];V(`${b}/typeface/download/${e==null?void 0:e.fileTransName}`,e==null?void 0:e.name,e==null?void 0:e.fileTransName)})},I=async()=>{c.value=!0,await v.setFontList(),w.value=N(v.fontList),c.value=!1,x()};return Y(()=>{D()}),(n,e)=>{const _=A,m=O,M=U,y=H,P=ee("loading");return l(),f(E,null,[te((l(),f("div",ne,[u("div",ae,[r(a(s(t)("system.font_management"))+" ",1),u("div",le,[d(M,{modelValue:k.value,"onUpdate:modelValue":e[0]||(e[0]=o=>k.value=o),clearable:"",style:{width:"240px"},placeholder:s(t)("system.search_font_name")},{prefix:i(()=>[d(m,null,{default:i(()=>[d(_,{name:"icon_search-outline_outlined"},{default:i(()=>[d(s(K),{class:"svg-icon"})]),_:1})]),_:1})]),_:1},8,["modelValue","placeholder"]),d(y,{type:"primary",onClick:e[1]||(e[1]=o=>C(s(t)("system.a_new_font"),"create",{}))},{icon:i(()=>[d(_,{name:"icon_add_outlined"},{default:i(()=>[d(s(W),{class:"svg-icon"})]),_:1})]),default:i(()=>[r(" "+a(s(t)("system.add_font")),1)]),_:1})])]),u("div",ie,[u("div",ce,[(l(!0),f(E,null,oe(B.value,o=>(l(),f("div",{class:"font-content_item",key:o},[o.isDefault?(l(),f("span",re,a(s(t)("system.default_font")),1)):p("",!0),u("div",ue,[r(a(o.name)+" ",1),o.isBuiltin?(l(),f("span",de,a(s(t)("system.system_built_in")),1)):p("",!0)]),u("div",{title:o.fileName,class:"font-update_time"},[r(a(s(t)("system.update_time"))+" "+a(new Date(o.updateTime).toLocaleString())+" ",1),e[2]||(e[2]=u("span",{class:"line"},null,-1)),r(" "+a(s(t)("system.font_file"))+" "+a(o.fileName),1)],8,me),u("div",_e,[o.fileTransName?p("",!0):(l(),g(y,{key:0,onClick:F=>C(s(t)("system.upload_font_file"),"uploadFile",o),secondary:""},{default:i(()=>[r(a(s(t)("system.upload_font_file")),1)]),_:2},1032,["onClick"])),o.fileTransName?(l(),g(y,{key:1,onClick:F=>C(s(t)("system.replace_font_file"),"uploadFile",o),secondary:""},{default:i(()=>[r(a(s(t)("system.replace_font_file")),1)]),_:2},1032,["onClick"])):p("",!0),o.isDefault?p("",!0):(l(),g(y,{key:2,onClick:F=>S(o),secondary:""},{default:i(()=>[r(a(s(t)("system.as_default_font")),1)]),_:2},1032,["onClick"])),o.id!=="1"?(l(),g(y,{key:3,onClick:F=>T(o),secondary:""},{default:i(()=>[r(a(s(t)("common.delete")),1)]),_:2},1032,["onClick"])):p("",!0)])]))),128))])])])),[[P,c.value]]),d(Z,{onFinish:I,ref_key:"uploadDetail",ref:$},null,512)],64)}}});const Ue=se(fe,[["__scopeId","data-v-458d53f2"]]);export{Ue as default};
