import"./index-0.0.0-dataease.js";import{E as se}from"./el-dialog-0.0.0-dataease.js";import{j as ne,x as k,w as T,n as me,_ as pe,e as de,y as ce}from"./index-0.0.0-dataease2.js";import"./el-form-0.0.0-dataease.js";import{a as ue,E as ge}from"./el-form-item-0.0.0-dataease.js";import{E as he}from"./el-row-0.0.0-dataease.js";import{f as c,M as w,N as s,a8 as fe,d as _e,r as O,_ as ye,m as b,o as Te,n as I,a7 as m,j as r,k as o,i,a6 as d,U as h,X as f,a0 as v,g as C,Z,aa as ve}from"./vue-0.0.0-dataease.js";import{d as z}from"./dv-empty-0.0.0-dataease.js";import{e as Ce,g as we,h as xe,t as be,c as Fe,i as De}from"./template-0.0.0-dataease.js";import{e as Ee}from"./antv-0.0.0-dataease.js";import Le from"./DeTemplateList-0.0.0-dataease.js";import ke from"./DeTemplateImport-0.0.0-dataease.js";import{_ as Ie}from"./DeTemplateItem.vue_vue_type_style_index_0_lang-0.0.0-dataease.js";import Se from"./DeCategoryChange-0.0.0-dataease.js";import{_ as Ve}from"./_plugin-vue_export-helper-0.0.0-dataease.js";import"./library-0.0.0-dataease.js";import"./lodash-0.0.0-dataease.js";import"./use-dialog-0.0.0-dataease.js";import"./refs-0.0.0-dataease.js";import"./axios-0.0.0-dataease.js";import"./echarts-0.0.0-dataease.js";import"./tinymce-0.0.0-dataease.js";import"./user-0.0.0-dataease.js";import"./row-0.0.0-dataease.js";import"./el-dropdown-menu-0.0.0-dataease.js";import"./index-0.0.0-dataease4.js";import"./dropdown-0.0.0-dataease.js";import"./el-popper-0.0.0-dataease.js";import"./el-dropdown-item-0.0.0-dataease.js";import"./el-empty-0.0.0-dataease.js";import"./el-tag-0.0.0-dataease.js";import"./el-select-0.0.0-dataease.js";import"./index-0.0.0-dataease14.js";import"./strings-0.0.0-dataease.js";import"./index-0.0.0-dataease5.js";import"./imgUtils-0.0.0-dataease.js";import"./dvMain-0.0.0-dataease.js";import"./chart-0.0.0-dataease.js";import"./formatter-0.0.0-dataease.js";import"./dataVisualization-0.0.0-dataease2.js";import"./util-0.0.0-dataease.js";import"./util-0.0.0-dataease2.js";import"./chart-0.0.0-dataease2.js";import"./app-0.0.0-dataease.js";import"./extends-0.0.0-dataease.js";import"./sysParameter-0.0.0-dataease.js";import"./TableTooltip-0.0.0-dataease.js";import"./el-col-0.0.0-dataease.js";import"./_commonjs-dynamic-modules-0.0.0-dataease.js";import"./appearance-0.0.0-dataease.js";import"./font-0.0.0-dataease.js";import"./el-tooltip-0.0.0-dataease.js";import"./el-checkbox-0.0.0-dataease.js";const Me={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function Be(S,l){return c(),w("svg",Me,l[0]||(l[0]=[s("path",{d:"M10.9823 11.9244C9.89439 12.8051 8.50885 13.3327 7.00008 13.3327C3.50228 13.3327 0.666748 10.4972 0.666748 6.99935C0.666748 3.50155 3.50228 0.666016 7.00008 0.666016C10.4979 0.666016 13.3334 3.50155 13.3334 6.99935C13.3334 8.50811 12.8058 9.89365 11.9251 10.9816L14.6737 13.7301C14.8039 13.8603 14.8039 14.0714 14.6737 14.2015L14.2023 14.673C14.0721 14.8031 13.8611 14.8031 13.7309 14.673L10.9823 11.9244ZM12.0001 6.99935C12.0001 4.23793 9.7615 1.99935 7.00008 1.99935C4.23866 1.99935 2.00008 4.23793 2.00008 6.99935C2.00008 9.76077 4.23866 11.9993 7.00008 11.9993C9.7615 11.9993 12.0001 9.76077 12.0001 6.99935Z",fill:"#646A73"},null,-1)]))}const Ne={render:Be},$e={width:"126",height:"125",viewBox:"0 0 126 125",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function Re(S,l){return c(),w("svg",$e,l[0]||(l[0]=[fe('<path fill-rule="evenodd" clip-rule="evenodd" d="M30.2978 13.9995H102.702C105.904 13.9995 108.5 16.5805 108.5 19.7642V83.9427L83.775 109.467H30.2978C27.0957 109.467 24.5 106.886 24.5 103.702V19.7642C24.5 16.5805 27.0957 13.9995 30.2978 13.9995Z" fill="#D6DAE1"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M83.7749 109.426V85.8234C83.7749 84.7622 84.6401 83.9019 85.7075 83.9019H108.5L83.7749 109.426Z" fill="#B5BEC8"></path><rect x="76.1875" y="21.999" width="25" height="32" rx="2" fill="#F4F5F9"></rect><rect x="32.1001" y="22.0542" width="32.25" height="5" rx="1" fill="#F4F5F9"></rect><rect x="32.1001" y="31.6406" width="32.25" height="5" rx="1" fill="#F4F5F9"></rect><rect x="32.1001" y="41.6406" width="16.125" height="5" rx="1" fill="#F4F5F9"></rect><rect x="32.1001" y="68.9229" width="68.8" height="5" rx="1" fill="#F4F5F9"></rect><rect x="32.1001" y="76.3799" width="68.8" height="5" rx="1" fill="#F4F5F9"></rect><path fill-rule="evenodd" clip-rule="evenodd" d="M50.2158 54.1396C38.7749 54.1396 29.5002 63.4602 29.5002 74.9577C29.5002 86.4552 38.7749 95.7758 50.2158 95.7758C53.0012 95.7758 55.6583 95.2233 58.0843 94.2214L68.8536 110.371L74.4055 106.63L63.7784 90.6942C68.16 86.877 70.9313 81.2426 70.9313 74.9577C70.9313 63.4602 61.6567 54.1396 50.2158 54.1396ZM50.2158 60.8555C57.9661 60.8555 64.2489 67.1694 64.2489 74.9581C64.2489 82.7467 57.9661 89.0606 50.2158 89.0606C42.4655 89.0606 36.1827 82.7467 36.1827 74.9581C36.1827 67.1694 42.4655 60.8555 50.2158 60.8555Z" fill="white"></path><path d="M25.1083 59.9895L24.6889 60.9687L15.4748 57.0168L15.8942 56.0377L25.1083 59.9895Z" fill="#1F2329"></path><path d="M30.1257 56.5756L29.3071 57.2573L21.3806 47.733L22.1992 47.0513L30.1257 56.5756Z" fill="#1F2329"></path><path d="M25.2771 65.653L25.3153 66.719L12.6962 67.1485L12.658 66.0825L25.2771 65.653Z" fill="#1F2329"></path>',12)]))}const Oe={render:Re},Ze={class:"template-head"},ze={class:"router-title"},Ue={class:"sys-setting-p"},We={class:"container-sys-param"},Pe={style:{width:"100%",height:"100%"}},je={class:"de-template"},qe={class:"tabs-container flex-tabs"},He={class:"de-tabs-left"},Ae={class:"de-tabs-right"},Je={key:0,class:"active-template"},Xe={style:{color:"#3370ff"}},Ge={style:{"margin-top":"8px","font-size":"14px"}},Ke={style:{"margin-top":"8px","font-size":"14px"}},Qe={id:"template-box",class:"template-box"},Ye={class:"batch-opt-area"},et={style:{"margin-left":"24px","font-size":"14px"}},tt={class:"container-sys-param"},at={style:{"margin-top":"8px","font-size":"14px"}},lt={class:"dialog-footer"},ot=_e({__name:"index",setup(S){const{t:l}=ne(),V=O(null),F=O(null),e=ye({batchOptDialogShow:!1,batchOptList:[],templateFilterText:"",showShare:!1,currentTemplateShowList:[],noneImg:"@/assets/None.png",currentPid:"",currentTemplateType:"self",templateEditFormRules:{name:[{required:!0,trigger:"blur",validator:(t,a,p)=>{if(q(a)){const{nodeType:u}=e.templateEditForm||{};p(new Error(l(`system_parameter_setting.${u==="folder"?"name_already_exists_type":"the_same_category"}`)))}else p()}},{required:!0,message:l("commons.input_content"),trigger:"blur"},{max:50,message:l("commons.char_can_not_more_50"),trigger:"change"}]},templateEditForm:{},editTemplate:!1,dialogTitle:"",dialogTitleLabel:"",currentTemplateLabel:"",currentTemplateId:"",templateCategories:[],templateMiniWidth:256,templateCurWidth:256,formType:"",originName:"",templateDialog:{title:l("visualization.import_template"),visible:!1,templateId:null,optType:"insert",pid:"",categories:[]}}),U=()=>{e.batchOptDialogShow=!0},W=()=>{k.confirm(l("template_manage.delete_batch_hint",[x.value]),{confirmButtonType:"danger",type:"warning",autofocus:!1,showClose:!1}).then(()=>{const t={templateIds:M.value,categories:[e.currentTemplateId]};Ce(t).then(()=>{T({message:l("commons.delete_success"),type:"success",showClose:!0}),_(e.currentTemplateId,e.currentTemplateLabel)})})},P=()=>{g.value.forEach(t=>{t.checked=!0})},j=()=>{g.value.forEach(t=>{t.checked=!1})},x=b(()=>g.value.filter(t=>t.checked).length),M=b(()=>g.value.filter(t=>t.checked).map(t=>t.id)),g=b(()=>e.templateFilterText?e.currentTemplateShowList.filter(t=>{var a;return(a=t.name)==null?void 0:a.includes(e.templateFilterText)}):[...e.currentTemplateShowList]),B=b(()=>{const{nodeType:t}=e.templateEditForm||{};return t==="template"?e.currentTemplateShowList.map(a=>a.label):t==="folder"?e.templateCategories.map(a=>a.label):[]}),q=t=>!B.value||e.formType==="edit"&&e.originName===t?!1:B.value.some(a=>a===t),H=(t,a)=>{switch(t){case"templateEdit":Q(a);break;case"delete":A(a);break}},A=t=>{G(t.id)},J=t=>{t.optType==="refresh"?F.value.nodeClick({id:t.refreshPid,name:t.refreshPName}):y("new",null)},_=(t,a)=>{e.currentTemplateId=t,e.currentTemplateLabel=a,e.currentTemplateId&&we({categoryId:e.currentTemplateId}).then(p=>{e.currentTemplateShowList=p.data})},X=t=>{t&&xe(t).then(a=>{a.data==="success"?(T({message:l("commons.delete_success"),type:"success",showClose:!0}),D()):k.confirm(l("template_manage.delete_failed_hint"),{tip:l("template_manage.delete_failed_tip"),confirmButtonText:l("template_manage.delete_failed_confirm"),confirmButtonType:"default",showCancelButton:!1,type:"warning",autofocus:!1,showClose:!1})})},G=t=>{t&&k.confirm(l("template_manage.delete_hint"),{tip:"",confirmButtonType:"danger",type:"warning",confirmButtonText:l("common.delete"),autofocus:!1,showClose:!1}).then(()=>{be(t,e.currentTemplateId).then(()=>{T({message:l("commons.delete_success"),type:"success",showClose:!0}),_(e.currentTemplateId,e.currentTemplateLabel)})})},y=(t,a)=>{e.templateEditForm=null,e.formType=t,t==="edit"?(e.templateEditForm=JSON.parse(JSON.stringify(a)),e.dialogTitle=e.templateEditForm.nodeType==="folder"?l("template_manage.rename"):l("template_manage.edit_template"),e.originName=e.templateEditForm.label):(e.dialogTitle=l("visualization.add_category"),e.templateEditForm={name:"",nodeType:"folder",templateType:e.currentTemplateType,level:0}),e.dialogTitleLabel=e.templateEditForm.nodeType==="folder"?l("template_manage.catalog_name"):l("template_manage.template_name"),e.editTemplate=!0},K=t=>{y("edit",t)},Q=t=>{e.templateDialog.visible=!0,e.templateDialog.title=l("template_manage.edit_template"),e.templateDialog.optType="update",e.templateDialog.templateId=t.id},Y=t=>{if(t.name===l("work_branch.recently_used")){T({message:l("template_manage.illegal_name_hint"),type:"error",showClose:!0});return}V.value.validate(a=>{if(a)Fe({...t}).then(()=>{T({message:l("template_manage.add_success"),type:"success",showClose:!0}),e.currentTemplateId=null,D(),N()});else return!1})},N=()=>{e.editTemplate=!1},D=()=>{I(()=>{const t={templateType:e.currentTemplateType,level:"0"};De(t).then(a=>{e.templateCategories=a.data,ee()})})},ee=()=>{if(e.templateCategories&&e.templateCategories.length>0){let t=!0;e.templateCategories.forEach(a=>{a.id===e.currentTemplateId&&(t=!1)}),t?I().then(()=>{const[a={}]=e.templateCategories;F.value.nodeClick(a)}):_(e.currentTemplateId,e.currentTemplateLabel)}else e.currentTemplateShowList=[]},te=()=>{e.batchOptDialogShow=!1},ae=()=>{e.templateDialog.visible=!1},$=t=>{e.templateDialog.visible=!0,e.templateDialog.title=l("template_manage.import_template"),e.templateDialog.templateId=null,e.templateDialog.optType="insert",e.templateDialog.pid=t};return Te(()=>{D();const t=Ee(),a=document.getElementById("template-box");t.listenTo(a,()=>{I(()=>{const p=a.offsetWidth-24,u=Math.trunc(p/e.templateMiniWidth);e.templateCurWidth=Math.trunc(p/u)-24-u})})}),(t,a)=>{const p=me,u=pe,le=de,R=ce,E=he,oe=ue,ie=ge,L=se;return c(),w(Z,null,[s("div",Ze,[s("p",ze,m(r(l)("template_manage.name")),1),o(p,{style:{float:"right"},type:"primary",onClick:a[0]||(a[0]=n=>$(e.currentTemplateId))},{default:i(()=>[d(m(r(l)("visualization.import")),1)]),_:1}),o(p,{style:{float:"right","margin-right":"12px"},onClick:a[1]||(a[1]=n=>y("new",null))},{default:i(()=>[d(m(r(l)("template_manage.add_catalog")),1)]),_:1}),o(R,{modelValue:e.templateFilterText,"onUpdate:modelValue":a[2]||(a[2]=n=>e.templateFilterText=n),placeholder:r(l)("template_manage.keywords"),class:"template-search-class",clearable:""},{prefix:i(()=>[o(le,null,{default:i(()=>[o(u,{name:"de-search"},{default:i(()=>[o(r(Ne),{class:"svg-icon"})]),_:1})]),_:1})]),_:1},8,["modelValue","placeholder"])]),s("div",Ue,[h(s("div",We,[s("div",Pe,[s("div",je,[s("div",qe,[s("div",He,[o(Le,{ref_key:"templateListRef",ref:F,"template-type":e.currentTemplateType,"template-list":e.templateCategories,onCategoryDelete:X,onCategoryEdit:K,onShowCurrentTemplate:_,onShowTemplateEditDialog:y},null,8,["template-type","template-list"])]),s("div",Ae,[e.currentTemplateLabel?(c(),w("div",Je,[h(s("span",null,m(e.currentTemplateLabel)+"  ("+m(e.currentTemplateShowList.length)+")",513),[[f,!e.templateFilterText]]),h(s("span",null,[s("span",Xe,m(e.templateFilterText)+"  ",1),s("span",null,m(r(l)("template_manage.search_result"))+" "+m(g.value.length)+" "+m(r(l)("template_manage.search_result_unit")),1)],512),[[f,e.templateFilterText]])])):v("",!0),!e.currentTemplateShowList.length&&!e.templateFilterText?(c(),C(E,{key:1,style:{height:"100%"},class:"custom-position"},{default:i(()=>[o(u,{name:"dv-empty"},{default:i(()=>[o(r(z),{style:{width:"125px",height:"125px"},class:"svg-icon"})]),_:1}),s("span",Ge,m(r(l)("template_manage.no_template")),1)]),_:1})):v("",!0),!g.value.length&&e.templateFilterText?(c(),C(E,{key:2,style:{height:"100%"},class:"custom-position"},{default:i(()=>[o(u,{name:"dv-nothing"},{default:i(()=>[o(r(Oe),{style:{width:"125px",height:"125px"},class:"svg-icon"})]),_:1}),s("span",Ke,m(r(l)("template_manage.not_found")),1)]),_:1})):v("",!0),h(s("div",Qe,[(c(!0),w(Z,null,ve(g.value,n=>(c(),C(Ie,{key:n.id,width:e.templateCurWidth,"batch-state":x.value>0,model:n,onCommand:re=>H(re,n)},null,8,["width","batch-state","model","onCommand"]))),128))],512),[[f,e.currentTemplateId!==""]]),h(s("div",Ye,[o(p,{onClick:U,type:"danger",plain:"",style:{"margin-left":"24px"}},{default:i(()=>[d(m(r(l)("template_manage.edit_catalog")),1)]),_:1}),o(p,{onClick:W,type:"danger",plain:""},{default:i(()=>[d(m(r(l)("user.batch_del")),1)]),_:1}),s("span",et,m(r(l)("template_manage.selected_count",[x.value])),1),o(p,{onClick:P,style:{"margin-left":"16px"},text:""},{default:i(()=>[d(m(r(l)("template_manage.select_all_count",[g.value.length])),1)]),_:1}),o(p,{onClick:j,text:""},{default:i(()=>[d(m(r(l)("commons.clear")),1)]),_:1})],512),[[f,x.value]])])])])])],512),[[f,e.templateCategories.length]]),h(s("div",tt,[o(E,{style:{height:"100%"},class:"custom-position"},{default:i(()=>[o(u,{name:"dv-empty"},{default:i(()=>[o(r(z),{style:{width:"125px",height:"125px"},class:"svg-icon"})]),_:1}),s("span",at,[o(p,{style:{float:"right"},type:"primary",onClick:a[3]||(a[3]=n=>$(e.currentTemplateId))},{default:i(()=>[d(m(r(l)("visualization.import")),1)]),_:1}),o(p,{style:{float:"right","margin-right":"12px"},onClick:a[4]||(a[4]=n=>y("new",null))},{default:i(()=>[d(m(r(l)("template_manage.add_catalog")),1)]),_:1})])]),_:1})],512),[[f,!e.templateCategories.length]]),o(L,{title:e.dialogTitle,modelValue:e.editTemplate,"onUpdate:modelValue":a[8]||(a[8]=n=>e.editTemplate=n),"append-to-body":"",class:"de-dialog-form create-dialog",width:"420px"},{footer:i(()=>[s("div",lt,[o(p,{secondary:"",onClick:a[6]||(a[6]=n=>N())},{default:i(()=>[d(m(r(l)("commons.cancel")),1)]),_:1}),o(p,{type:"primary",onClick:a[7]||(a[7]=n=>Y(e.templateEditForm))},{default:i(()=>[d(m(r(l)("commons.confirm")),1)]),_:1})])]),default:i(()=>[o(ie,{ref_key:"templateEditFormRef",ref:V,"label-position":"top",class:"de-form-item",model:e.templateEditForm,rules:e.templateEditFormRules},{default:i(()=>[o(oe,{label:e.dialogTitleLabel,prop:"name"},{default:i(()=>[o(R,{placeholder:r(l)("template_manage.catalog_name"),modelValue:e.templateEditForm.name,"onUpdate:modelValue":a[5]||(a[5]=n=>e.templateEditForm.name=n)},null,8,["placeholder","modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"]),o(L,{title:e.templateDialog.title,modelValue:e.templateDialog.visible,"onUpdate:modelValue":a[9]||(a[9]=n=>e.templateDialog.visible=n),"show-close":!0,"destroy-on-close":!0,class:"de-dialog-form create-dialog",width:"600px"},{default:i(()=>[e.templateDialog.visible?(c(),C(ke,{key:0,pid:e.templateDialog.pid,"template-id":e.templateDialog.templateId,"opt-type":e.templateDialog.optType,"template-categories":e.templateCategories,onRefresh:J,onCloseEditTemplateDialog:ae},null,8,["pid","template-id","opt-type","template-categories"])):v("",!0)]),_:1},8,["title","modelValue"]),o(L,{title:r(l)("template_manage.edit_catalog"),modelValue:e.batchOptDialogShow,"onUpdate:modelValue":a[11]||(a[11]=n=>e.batchOptDialogShow=n),"show-close":!0,"destroy-on-close":!0,class:"de-dialog-form",width:"600px"},{default:i(()=>[e.batchOptDialogShow?(c(),C(Se,{key:0,"template-ids":M.value,"template-categories":e.templateCategories,onRefresh:a[10]||(a[10]=n=>_(e.currentTemplateId,e.currentTemplateLabel)),onCloseBatchEditTemplateDialog:te},null,8,["template-ids","template-categories"])):v("",!0)]),_:1},8,["title","modelValue"])])],64)}}});const ia=Ve(ot,[["__scopeId","data-v-fecca4a4"]]);export{ia as default};
