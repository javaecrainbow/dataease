import{u as ht,a as dt,b as xt,s as _t,c as Et,d as St,e as kt}from"../assets/chunk/index-0.0.0-dataease.js";import{d as Ct,u as Ot,r as Tt,e as Nt,f as rt,g as ot,i as jt,j as It,k as At,l as Rt}from"../assets/chunk/vue-0.0.0-dataease.js";import{_ as Lt,u as Pt,g as Ut,a as Wt,s as qt}from"../assets/chunk/common-0.0.0-dataease.js";import{_ as Dt}from"../assets/chunk/ExportExcel.vue_vue_type_style_index_0_lang-0.0.0-dataease.js";import{u as Mt,r as Y,c as Bt,i as Ft,a as Gt,b as Jt,p as it,g as st,s as $t}from"../assets/chunk/index-0.0.0-dataease2.js";import{installDirective as Vt}from"../assets/chunk/index-0.0.0-dataease3.js";import{useUserStoreWithOut as zt}from"../assets/chunk/user-0.0.0-dataease.js";import{useAppStoreWithOut as Ht}from"../assets/chunk/app-0.0.0-dataease.js";import{i as Xt}from"../assets/chunk/interactive-0.0.0-dataease.js";import{useAppearanceStoreWithOut as Qt}from"../assets/chunk/appearance-0.0.0-dataease.js";import{c as I,g as mt}from"../assets/chunk/lodash-0.0.0-dataease.js";import{c as J}from"../assets/chunk/_commonjs-dynamic-modules-0.0.0-dataease.js";import"../assets/chunk/library-0.0.0-dataease.js";import"../assets/chunk/el-dialog-0.0.0-dataease.js";import"../assets/chunk/use-dialog-0.0.0-dataease.js";import"../assets/chunk/refs-0.0.0-dataease.js";import"../assets/chunk/el-drawer-0.0.0-dataease.js";import"../assets/chunk/el-table-column-0.0.0-dataease.js";import"../assets/chunk/index-0.0.0-dataease4.js";import"../assets/chunk/el-checkbox-0.0.0-dataease.js";import"../assets/chunk/index-0.0.0-dataease5.js";import"../assets/chunk/el-tag-0.0.0-dataease.js";import"../assets/chunk/el-tooltip-0.0.0-dataease.js";import"../assets/chunk/el-popper-0.0.0-dataease.js";import"../assets/chunk/el-progress-0.0.0-dataease.js";import"../assets/chunk/dv-preview-download-0.0.0-dataease.js";import"../assets/chunk/de-delete-0.0.0-dataease.js";import"../assets/chunk/icon_refresh_outlined-0.0.0-dataease.js";import"../assets/chunk/EmptyBackground-0.0.0-dataease.js";import"../assets/chunk/el-empty-0.0.0-dataease.js";import"../assets/chunk/none-0.0.0-dataease.js";import"../assets/chunk/nothing-tree-0.0.0-dataease.js";import"../assets/chunk/_plugin-vue_export-helper-0.0.0-dataease.js";import"../assets/chunk/el-tabs-0.0.0-dataease.js";import"../assets/chunk/strings-0.0.0-dataease.js";import"../assets/chunk/dataset-0.0.0-dataease.js";import"../assets/chunk/axios-0.0.0-dataease.js";import"../assets/chunk/echarts-0.0.0-dataease.js";import"../assets/chunk/tinymce-0.0.0-dataease.js";import"../assets/chunk/dataVisualization-0.0.0-dataease.js";import"../assets/chunk/datasource-0.0.0-dataease.js";import"../assets/chunk/font-0.0.0-dataease.js";import"../assets/chunk/antv-0.0.0-dataease.js";const Kt=Ct({__name:"App",setup(C){const R=Ot(),n=Tt();return ht({name:"data-export-center",callback:v=>{n.value.init(v)}}),(v,i)=>{const r=Nt("router-view");return rt(),ot(Lt,null,{default:jt(()=>[(rt(),ot(r,{key:It(R).path})),At(Dt,{ref_key:"exportExcelRef",ref:n},null,512)]),_:1})}}}),z=Qt(),{wsCache:H}=dt(),F=Mt(),Zt=Xt(),at=zt(),X=Ht(),{start:Yt,done:vt}=Pt(),{loadStart:te,loadDone:bt}=Wt(),ee=["/login","/de-link","/chart-view","/notSupport","/admin-login","/401"],ne=["/dvCanvas","/dashboard","/preview","/dataset-embedded-form"],re=["/dataset-embedded","/dataset-form","/dataset-embedded-form"];Y.beforeEach(async(C,R,n)=>{Yt(),te();const l=Bt();let v=H.get("app.desktop");if(v===null&&(await X.setAppModel(),v=X.getDesktop),Ft()&&!["/notSupport","/chart-view"].includes(C.path))if(vt(),bt(),C.name==="link"){let i="";if(Object.keys(C.query)){const r=Object.keys(C.query).map(o=>o+"="+C.query[o]).join("&");r&&(i="?"+r)}window.location.href=window.origin+"/mobile.html#"+C.path+i}else C.path==="/dvCanvas"?n("/notSupport"):(H.get("user.token")||v||!Gt()&&!Jt())&&(window.location.href=window.origin+"/mobile.html#/index");if(await z.setAppearance(),await z.setFontList(),(H.get("user.token")||v)&&!C.path.startsWith("/de-link/"))if(at.getUid||await at.setUser(),C.path==="/login")n({path:"/workbranch/index"});else{if(F.setCurrentPath(C.path),F.getIsAddRouters){let t="";if((R.query.redirect||"?").split("?")[0]===C.path&&(t=(R.query.redirect||"?").split("?")[1]),t&&(C.fullPath+="?"+t,C.query=t.split("&").reduce((a,u)=>{const[c,p]=u.split("=");return a[c]=p,a},{})),!it(C.path)&&C.path!=="/404"&&!C.path.startsWith("/de-link")){const a=st();n({path:a||"/404"});return}n();return}let i=await Ut()||[];v&&(i=i.filter(t=>t.name!=="system"));const r=i;r.forEach(t=>t.top=!0),await F.generateRoutes(r),F.getAddRouters.forEach(t=>{Y.addRoute(t)});const o=R.query.redirect||C.path,s=decodeURIComponent(o),e=C.path===s?{...C,replace:!0}:{path:s};if(F.setIsAddRouters(!0),await Zt.initInteractive(!0),!it(C.path)&&C.path!=="/404"&&!C.path.startsWith("/de-link")){const t=st();n({path:t||"/404"});return}n(e)}else if(xt().getToken&&X.getIsIframe&&re.includes(C.path)){if(C.path.includes("/dataset-form")){n({path:"/dataset-embedded-form",query:C.query});return}F.setCurrentPath(C.path),n()}else!l&&ne.includes(C.path)||ee.includes(C.path)||C.path.startsWith("/de-link/")?(await z.setFontList(),F.setCurrentPath(C.path),n()):n(`/login?redirect=${C.fullPath||C.path}`)});Y.afterEach(()=>{vt(),bt()});var gt={exports:{}};(function(C,R){(function(n){C.exports=n()})(function(){return function n(l,v,i){function r(e,t){if(!v[e]){if(!l[e]){var a=typeof J=="function"&&J;if(!t&&a)return a(e,!0);if(o)return o(e,!0);var u=new Error("Cannot find module '"+e+"'");throw u.code="MODULE_NOT_FOUND",u}var c=v[e]={exports:{}};l[e][0].call(c.exports,function(p){return r(l[e][1][p]||p)},c,c.exports,n,l,v,i)}return v[e].exports}for(var o=typeof J=="function"&&J,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(n,l,v){(function(i){(function(){var r=n("./transport-list");l.exports=n("./main")(r),"_sockjs_onload"in i&&setTimeout(i._sockjs_onload,1)}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{"./main":14,"./transport-list":16}],2:[function(n,l,v){var i=n("inherits"),r=n("./event");function o(){r.call(this),this.initEvent("close",!1,!1),this.wasClean=!1,this.code=0,this.reason=""}i(o,r),l.exports=o},{"./event":4,inherits:54}],3:[function(n,l,v){var i=n("inherits"),r=n("./eventtarget");function o(){r.call(this)}i(o,r),o.prototype.removeAllListeners=function(s){s?delete this._listeners[s]:this._listeners={}},o.prototype.once=function(s,e){var t=this,a=!1;this.on(s,function u(){t.removeListener(s,u),a||(a=!0,e.apply(this,arguments))})},o.prototype.emit=function(){var s=arguments[0],e=this._listeners[s];if(e){for(var t=arguments.length,a=new Array(t-1),u=1;u<t;u++)a[u-1]=arguments[u];for(var c=0;c<e.length;c++)e[c].apply(this,a)}},o.prototype.on=o.prototype.addListener=r.prototype.addEventListener,o.prototype.removeListener=r.prototype.removeEventListener,l.exports.EventEmitter=o},{"./eventtarget":5,inherits:54}],4:[function(n,l,v){function i(r){this.type=r}i.prototype.initEvent=function(r,o,s){return this.type=r,this.bubbles=o,this.cancelable=s,this.timeStamp=+new Date,this},i.prototype.stopPropagation=function(){},i.prototype.preventDefault=function(){},i.CAPTURING_PHASE=1,i.AT_TARGET=2,i.BUBBLING_PHASE=3,l.exports=i},{}],5:[function(n,l,v){function i(){this._listeners={}}i.prototype.addEventListener=function(r,o){r in this._listeners||(this._listeners[r]=[]);var s=this._listeners[r];s.indexOf(o)===-1&&(s=s.concat([o])),this._listeners[r]=s},i.prototype.removeEventListener=function(r,o){var s=this._listeners[r];if(s){var e=s.indexOf(o);e===-1||(1<s.length?this._listeners[r]=s.slice(0,e).concat(s.slice(e+1)):delete this._listeners[r])}},i.prototype.dispatchEvent=function(){var r=arguments[0],o=r.type,s=arguments.length===1?[r]:Array.apply(null,arguments);if(this["on"+o]&&this["on"+o].apply(this,s),o in this._listeners)for(var e=this._listeners[o],t=0;t<e.length;t++)e[t].apply(this,s)},l.exports=i},{}],6:[function(n,l,v){var i=n("inherits"),r=n("./event");function o(s){r.call(this),this.initEvent("message",!1,!1),this.data=s}i(o,r),l.exports=o},{"./event":4,inherits:54}],7:[function(n,l,v){var i=n("./utils/iframe");function r(o){(this._transport=o).on("message",this._transportMessage.bind(this)),o.on("close",this._transportClose.bind(this))}r.prototype._transportClose=function(o,s){i.postMessage("c",JSON.stringify([o,s]))},r.prototype._transportMessage=function(o){i.postMessage("t",o)},r.prototype._send=function(o){this._transport.send(o)},r.prototype._close=function(){this._transport.close(),this._transport.removeAllListeners()},l.exports=r},{"./utils/iframe":47}],8:[function(n,l,v){var i=n("./utils/url"),r=n("./utils/event"),o=n("./facade"),s=n("./info-iframe-receiver"),e=n("./utils/iframe"),t=n("./location"),a=function(){};l.exports=function(u,c){var p,m={};c.forEach(function(f){f.facadeTransport&&(m[f.facadeTransport.transportName]=f.facadeTransport)}),m[s.transportName]=s,u.bootstrap_iframe=function(){var f;e.currentWindowId=t.hash.slice(1),r.attachEvent("message",function(d){if(d.source===parent&&(p===void 0&&(p=d.origin),d.origin===p)){var E;try{E=JSON.parse(d.data)}catch{return void a("bad json",d.data)}if(E.windowId===e.currentWindowId)switch(E.type){case"s":var S;try{S=JSON.parse(E.data)}catch{a("bad json",E.data);break}var j=S[0],w=S[1],b=S[2],_=S[3];if(j!==u.version)throw new Error('Incompatible SockJS! Main site uses: "'+j+'", the iframe: "'+u.version+'".');if(!i.isOriginEqual(b,t.href)||!i.isOriginEqual(_,t.href))throw new Error("Can't connect to different domain from within an iframe. ("+t.href+", "+b+", "+_+")");f=new o(new m[w](b,_));break;case"m":f._send(E.data);break;case"c":f&&f._close(),f=null}}}),e.postMessage("s")}}},{"./facade":7,"./info-iframe-receiver":10,"./location":13,"./utils/event":46,"./utils/iframe":47,"./utils/url":52,debug:void 0}],9:[function(n,l,v){var i=n("events").EventEmitter,r=n("inherits"),o=n("./utils/object");function s(e,t){i.call(this);var a=this,u=+new Date;this.xo=new t("GET",e),this.xo.once("finish",function(c,p){var m,f;if(c===200){if(f=+new Date-u,p)try{m=JSON.parse(p)}catch{}o.isObject(m)||(m={})}a.emit("finish",m,f),a.removeAllListeners()})}r(s,i),s.prototype.close=function(){this.removeAllListeners(),this.xo.close()},l.exports=s},{"./utils/object":49,debug:void 0,events:3,inherits:54}],10:[function(n,l,v){var i=n("inherits"),r=n("events").EventEmitter,o=n("./transport/sender/xhr-local"),s=n("./info-ajax");function e(t){var a=this;r.call(this),this.ir=new s(t,o),this.ir.once("finish",function(u,c){a.ir=null,a.emit("message",JSON.stringify([u,c]))})}i(e,r),e.transportName="iframe-info-receiver",e.prototype.close=function(){this.ir&&(this.ir.close(),this.ir=null),this.removeAllListeners()},l.exports=e},{"./info-ajax":9,"./transport/sender/xhr-local":37,events:3,inherits:54}],11:[function(n,l,v){(function(i){(function(){var r=n("events").EventEmitter,o=n("inherits"),s=n("./utils/event"),e=n("./transport/iframe"),t=n("./info-iframe-receiver");function a(u,c){var p=this;r.call(this);function m(){var f=p.ifr=new e(t.transportName,c,u);f.once("message",function(d){if(d){var E;try{E=JSON.parse(d)}catch{return p.emit("finish"),void p.close()}var S=E[0],j=E[1];p.emit("finish",S,j)}p.close()}),f.once("close",function(){p.emit("finish"),p.close()})}i.document.body?m():s.attachEvent("load",m)}o(a,r),a.enabled=function(){return e.enabled()},a.prototype.close=function(){this.ifr&&this.ifr.close(),this.removeAllListeners(),this.ifr=null},l.exports=a}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{"./info-iframe-receiver":10,"./transport/iframe":22,"./utils/event":46,debug:void 0,events:3,inherits:54}],12:[function(n,l,v){var i=n("events").EventEmitter,r=n("inherits"),o=n("./utils/url"),s=n("./transport/sender/xdr"),e=n("./transport/sender/xhr-cors"),t=n("./transport/sender/xhr-local"),a=n("./transport/sender/xhr-fake"),u=n("./info-iframe"),c=n("./info-ajax");function p(m,f){var d=this;i.call(this),setTimeout(function(){d.doXhr(m,f)},0)}r(p,i),p._getReceiver=function(m,f,d){return d.sameOrigin?new c(f,t):e.enabled?new c(f,e):s.enabled&&d.sameScheme?new c(f,s):u.enabled()?new u(m,f):new c(f,a)},p.prototype.doXhr=function(m,f){var d=this,E=o.addPath(m,"/info");this.xo=p._getReceiver(m,E,f),this.timeoutRef=setTimeout(function(){d._cleanup(!1),d.emit("finish")},p.timeout),this.xo.once("finish",function(S,j){d._cleanup(!0),d.emit("finish",S,j)})},p.prototype._cleanup=function(m){clearTimeout(this.timeoutRef),this.timeoutRef=null,!m&&this.xo&&this.xo.close(),this.xo=null},p.prototype.close=function(){this.removeAllListeners(),this._cleanup(!1)},p.timeout=8e3,l.exports=p},{"./info-ajax":9,"./info-iframe":11,"./transport/sender/xdr":34,"./transport/sender/xhr-cors":35,"./transport/sender/xhr-fake":36,"./transport/sender/xhr-local":37,"./utils/url":52,debug:void 0,events:3,inherits:54}],13:[function(n,l,v){(function(i){(function(){l.exports=i.location||{origin:"http://localhost:80",protocol:"http:",host:"localhost",port:80,href:"http://localhost/",hash:""}}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{}],14:[function(n,l,v){(function(i){(function(){n("./shims");var r,o=n("url-parse"),s=n("inherits"),e=n("./utils/random"),t=n("./utils/escape"),a=n("./utils/url"),u=n("./utils/event"),c=n("./utils/transport"),p=n("./utils/object"),m=n("./utils/browser"),f=n("./utils/log"),d=n("./event/event"),E=n("./event/eventtarget"),S=n("./location"),j=n("./event/close"),w=n("./event/trans-message"),b=n("./info-receiver"),_=function(){};function h(g,T,y){if(!(this instanceof h))return new h(g,T,y);if(arguments.length<1)throw new TypeError("Failed to construct 'SockJS: 1 argument required, but only 0 present");E.call(this),this.readyState=h.CONNECTING,this.extensions="",this.protocol="",(y=y||{}).protocols_whitelist&&f.warn("'protocols_whitelist' is DEPRECATED. Use 'transports' instead."),this._transportsWhitelist=y.transports,this._transportOptions=y.transportOptions||{},this._timeout=y.timeout||0;var O=y.sessionId||8;if(typeof O=="function")this._generateSessionId=O;else{if(typeof O!="number")throw new TypeError("If sessionId is used in the options, it needs to be a number or a function.");this._generateSessionId=function(){return e.string(O)}}this._server=y.server||e.numberString(1e3);var N=new o(g);if(!N.host||!N.protocol)throw new SyntaxError("The URL '"+g+"' is invalid");if(N.hash)throw new SyntaxError("The URL must not contain a fragment");if(N.protocol!=="http:"&&N.protocol!=="https:")throw new SyntaxError("The URL's scheme must be either 'http:' or 'https:'. '"+N.protocol+"' is not allowed.");var L=N.protocol==="https:";if(S.protocol==="https:"&&!L&&!a.isLoopbackAddr(N.hostname))throw new Error("SecurityError: An insecure SockJS connection may not be initiated from a page loaded over HTTPS");T?Array.isArray(T)||(T=[T]):T=[];var x=T.sort();x.forEach(function(P,W){if(!P)throw new SyntaxError("The protocols entry '"+P+"' is invalid.");if(W<x.length-1&&P===x[W+1])throw new SyntaxError("The protocols entry '"+P+"' is duplicated.")});var U=a.getOrigin(S.href);this._origin=U?U.toLowerCase():null,N.set("pathname",N.pathname.replace(/\/+$/,"")),this.url=N.href,_("using url",this.url),this._urlInfo={nullOrigin:!m.hasDomain(),sameOrigin:a.isOriginEqual(this.url,S.href),sameScheme:a.isSchemeEqual(this.url,S.href)},this._ir=new b(this.url,this._urlInfo),this._ir.once("finish",this._receiveInfo.bind(this))}function A(g){return g===1e3||3e3<=g&&g<=4999}s(h,E),h.prototype.close=function(g,T){if(g&&!A(g))throw new Error("InvalidAccessError: Invalid code");if(T&&123<T.length)throw new SyntaxError("reason argument has an invalid length");this.readyState!==h.CLOSING&&this.readyState!==h.CLOSED&&this._close(g||1e3,T||"Normal closure",!0)},h.prototype.send=function(g){if(typeof g!="string"&&(g=""+g),this.readyState===h.CONNECTING)throw new Error("InvalidStateError: The connection has not been established yet");this.readyState===h.OPEN&&this._transport.send(t.quote(g))},h.version=n("./version"),h.CONNECTING=0,h.OPEN=1,h.CLOSING=2,h.CLOSED=3,h.prototype._receiveInfo=function(g,T){if(this._ir=null,g){this._rto=this.countRTO(T),this._transUrl=g.base_url?g.base_url:this.url,g=p.extend(g,this._urlInfo);var y=r.filterToEnabled(this._transportsWhitelist,g);this._transports=y.main,_(this._transports.length+" enabled transports"),this._connect()}else this._close(1002,"Cannot connect to server")},h.prototype._connect=function(){for(var g=this._transports.shift();g;g=this._transports.shift()){if(_("attempt",g.transportName),g.needBody&&(!i.document.body||i.document.readyState!==void 0&&i.document.readyState!=="complete"&&i.document.readyState!=="interactive"))return this._transports.unshift(g),void u.attachEvent("load",this._connect.bind(this));var T=Math.max(this._timeout,this._rto*g.roundTrips||5e3);this._transportTimeoutId=setTimeout(this._transportTimeout.bind(this),T);var y=a.addPath(this._transUrl,"/"+this._server+"/"+this._generateSessionId()),O=this._transportOptions[g.transportName],N=new g(y,this._transUrl,O);return N.on("message",this._transportMessage.bind(this)),N.once("close",this._transportClose.bind(this)),N.transportName=g.transportName,void(this._transport=N)}this._close(2e3,"All transports failed",!1)},h.prototype._transportTimeout=function(){this.readyState===h.CONNECTING&&(this._transport&&this._transport.close(),this._transportClose(2007,"Transport timed out"))},h.prototype._transportMessage=function(g){var T,y=this,O=g.slice(0,1),N=g.slice(1);switch(O){case"o":return void this._open();case"h":return this.dispatchEvent(new d("heartbeat")),void _("heartbeat",this.transport)}if(N)try{T=JSON.parse(N)}catch{}if(T!==void 0)switch(O){case"a":Array.isArray(T)&&T.forEach(function(L){_("message",y.transport),y.dispatchEvent(new w(L))});break;case"m":_("message",this.transport),this.dispatchEvent(new w(T));break;case"c":Array.isArray(T)&&T.length===2&&this._close(T[0],T[1],!0)}},h.prototype._transportClose=function(g,T){_("_transportClose",this.transport),this._transport&&(this._transport.removeAllListeners(),this._transport=null,this.transport=null),A(g)||g===2e3||this.readyState!==h.CONNECTING?this._close(g,T):this._connect()},h.prototype._open=function(){_("_open",this._transport&&this._transport.transportName,this.readyState),this.readyState===h.CONNECTING?(this._transportTimeoutId&&(clearTimeout(this._transportTimeoutId),this._transportTimeoutId=null),this.readyState=h.OPEN,this.transport=this._transport.transportName,this.dispatchEvent(new d("open")),_("connected",this.transport)):this._close(1006,"Server lost session")},h.prototype._close=function(g,T,y){_("_close",this.transport,g,T,y,this.readyState);var O=!1;if(this._ir&&(O=!0,this._ir.close(),this._ir=null),this._transport&&(this._transport.close(),this._transport=null,this.transport=null),this.readyState===h.CLOSED)throw new Error("InvalidStateError: SockJS has already been closed");this.readyState=h.CLOSING,setTimeout((function(){this.readyState=h.CLOSED,O&&this.dispatchEvent(new d("error"));var N=new j("close");N.wasClean=y||!1,N.code=g||1e3,N.reason=T,this.dispatchEvent(N),this.onmessage=this.onclose=this.onerror=null}).bind(this),0)},h.prototype.countRTO=function(g){return 100<g?4*g:300+g},l.exports=function(g){return r=c(g),n("./iframe-bootstrap")(h,g),h}}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{"./event/close":2,"./event/event":4,"./event/eventtarget":5,"./event/trans-message":6,"./iframe-bootstrap":8,"./info-receiver":12,"./location":13,"./shims":15,"./utils/browser":44,"./utils/escape":45,"./utils/event":46,"./utils/log":48,"./utils/object":49,"./utils/random":50,"./utils/transport":51,"./utils/url":52,"./version":53,debug:void 0,inherits:54,"url-parse":57}],15:[function(n,l,v){function i(y){return e.toString.call(y)==="[object Function]"}function r(y){return c.call(y)==="[object String]"}var o,s=Array.prototype,e=Object.prototype,t=Function.prototype,a=String.prototype,u=s.slice,c=e.toString,p=Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),!0}catch{return!1}}();o=p?function(y,O,N,L){!L&&O in y||Object.defineProperty(y,O,{configurable:!0,enumerable:!1,writable:!0,value:N})}:function(y,O,N,L){!L&&O in y||(y[O]=N)};function m(y,O,N){for(var L in O)e.hasOwnProperty.call(O,L)&&o(y,L,O[L],N)}function f(y){if(y==null)throw new TypeError("can't convert "+y+" to object");return Object(y)}function d(){}m(t,{bind:function(y){var O=this;if(!i(O))throw new TypeError("Function.prototype.bind called on incompatible "+O);for(var N=u.call(arguments,1),L=Math.max(0,O.length-N.length),x=[],U=0;U<L;U++)x.push("$"+U);var P=Function("binder","return function ("+x.join(",")+"){ return binder.apply(this, arguments); }")(function(){if(this instanceof P){var W=O.apply(this,N.concat(u.call(arguments)));return Object(W)===W?W:this}return O.apply(y,N.concat(u.call(arguments)))});return O.prototype&&(d.prototype=O.prototype,P.prototype=new d,d.prototype=null),P}}),m(Array,{isArray:function(y){return c.call(y)==="[object Array]"}});var E,S,j,w=Object("a"),b=w[0]!=="a"||!(0 in w);m(s,{forEach:function(y,O){var N=f(this),L=b&&r(this)?this.split(""):N,x=O,U=-1,P=L.length>>>0;if(!i(y))throw new TypeError;for(;++U<P;)U in L&&y.call(x,L[U],U,N)}},(E=s.forEach,j=S=!0,E&&(E.call("foo",function(y,O,N){typeof N!="object"&&(S=!1)}),E.call([1],function(){j=typeof this=="string"},"x")),!(E&&S&&j)));var _=Array.prototype.indexOf&&[0,1].indexOf(1,2)!==-1;m(s,{indexOf:function(y,O){var N=b&&r(this)?this.split(""):f(this),L=N.length>>>0;if(!L)return-1;var x=0;for(1<arguments.length&&(x=function(U){var P=+U;return P!=P?P=0:P!==0&&P!==1/0&&P!==-1/0&&(P=(0<P||-1)*Math.floor(Math.abs(P))),P}(O)),x=0<=x?x:Math.max(0,L+x);x<L;x++)if(x in N&&N[x]===y)return x;return-1}},_);var h,A=a.split;"ab".split(/(?:ab)*/).length!==2||".".split(/(.?)(.?)/).length!==4||"tesst".split(/(s)*/)[1]==="t"||"test".split(/(?:)/,-1).length!==4||"".split(/.?/).length||1<".".split(/()()/).length?(h=/()??/.exec("")[1]===void 0,a.split=function(y,O){var N=this;if(y===void 0&&O===0)return[];if(c.call(y)!=="[object RegExp]")return A.call(this,y,O);var L,x,U,P,W=[],D=(y.ignoreCase?"i":"")+(y.multiline?"m":"")+(y.extended?"x":"")+(y.sticky?"y":""),q=0;for(y=new RegExp(y.source,D+"g"),N+="",h||(L=new RegExp("^"+y.source+"$(?!\\s)",D)),O=O===void 0?-1>>>0:function(B){return B>>>0}(O);(x=y.exec(N))&&!(q<(U=x.index+x[0].length)&&(W.push(N.slice(q,x.index)),!h&&1<x.length&&x[0].replace(L,function(){for(var B=1;B<arguments.length-2;B++)arguments[B]===void 0&&(x[B]=void 0)}),1<x.length&&x.index<N.length&&s.push.apply(W,x.slice(1)),P=x[0].length,q=U,W.length>=O));)y.lastIndex===x.index&&y.lastIndex++;return q===N.length?!P&&y.test("")||W.push(""):W.push(N.slice(q)),W.length>O?W.slice(0,O):W}):"0".split(void 0,0).length&&(a.split=function(y,O){return y===void 0&&O===0?[]:A.call(this,y,O)});var g=a.substr,T="".substr&&"0b".substr(-1)!=="b";m(a,{substr:function(y,O){return g.call(this,y<0&&(y=this.length+y)<0?0:y,O)}},T)},{}],16:[function(n,l,v){l.exports=[n("./transport/websocket"),n("./transport/xhr-streaming"),n("./transport/xdr-streaming"),n("./transport/eventsource"),n("./transport/lib/iframe-wrap")(n("./transport/eventsource")),n("./transport/htmlfile"),n("./transport/lib/iframe-wrap")(n("./transport/htmlfile")),n("./transport/xhr-polling"),n("./transport/xdr-polling"),n("./transport/lib/iframe-wrap")(n("./transport/xhr-polling")),n("./transport/jsonp-polling")]},{"./transport/eventsource":20,"./transport/htmlfile":21,"./transport/jsonp-polling":23,"./transport/lib/iframe-wrap":26,"./transport/websocket":38,"./transport/xdr-polling":39,"./transport/xdr-streaming":40,"./transport/xhr-polling":41,"./transport/xhr-streaming":42}],17:[function(n,l,v){(function(i){(function(){var r=n("events").EventEmitter,o=n("inherits"),s=n("../../utils/event"),e=n("../../utils/url"),t=i.XMLHttpRequest,a=function(){};function u(m,f,d,E){var S=this;r.call(this),setTimeout(function(){S._start(m,f,d,E)},0)}o(u,r),u.prototype._start=function(m,f,d,E){var S=this;try{this.xhr=new t}catch{}if(!this.xhr)return this.emit("finish",0,"no xhr support"),void this._cleanup();f=e.addQuery(f,"t="+ +new Date),this.unloadRef=s.unloadAdd(function(){S._cleanup(!0)});try{this.xhr.open(m,f,!0),this.timeout&&"timeout"in this.xhr&&(this.xhr.timeout=this.timeout,this.xhr.ontimeout=function(){a("xhr timeout"),S.emit("finish",0,""),S._cleanup(!1)})}catch{return this.emit("finish",0,""),void this._cleanup(!1)}if(E&&E.noCredentials||!u.supportsCORS||(this.xhr.withCredentials=!0),E&&E.headers)for(var j in E.headers)this.xhr.setRequestHeader(j,E.headers[j]);this.xhr.onreadystatechange=function(){if(S.xhr){var w,b,_=S.xhr;switch(a("readyState",_.readyState),_.readyState){case 3:try{b=_.status,w=_.responseText}catch{}b===1223&&(b=204),b===200&&w&&0<w.length&&S.emit("chunk",b,w);break;case 4:b=_.status,b===1223&&(b=204),b!==12005&&b!==12029||(b=0),a("finish",b,_.responseText),S.emit("finish",b,_.responseText),S._cleanup(!1)}}};try{S.xhr.send(d)}catch{S.emit("finish",0,""),S._cleanup(!1)}},u.prototype._cleanup=function(m){if(this.xhr){if(this.removeAllListeners(),s.unloadDel(this.unloadRef),this.xhr.onreadystatechange=function(){},this.xhr.ontimeout&&(this.xhr.ontimeout=null),m)try{this.xhr.abort()}catch{}this.unloadRef=this.xhr=null}},u.prototype.close=function(){this._cleanup(!0)},u.enabled=!!t;var c=["Active"].concat("Object").join("X");!u.enabled&&c in i&&(u.enabled=!!new(t=function(){try{return new i[c]("Microsoft.XMLHTTP")}catch{return null}}));var p=!1;try{p="withCredentials"in new t}catch{}u.supportsCORS=p,l.exports=u}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{"../../utils/event":46,"../../utils/url":52,debug:void 0,events:3,inherits:54}],18:[function(n,l,v){(function(i){(function(){l.exports=i.EventSource}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{}],19:[function(n,l,v){(function(i){(function(){var r=i.WebSocket||i.MozWebSocket;l.exports=r?function(o){return new r(o)}:void 0}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{}],20:[function(n,l,v){var i=n("inherits"),r=n("./lib/ajax-based"),o=n("./receiver/eventsource"),s=n("./sender/xhr-cors"),e=n("eventsource");function t(a){if(!t.enabled())throw new Error("Transport created when disabled");r.call(this,a,"/eventsource",o,s)}i(t,r),t.enabled=function(){return!!e},t.transportName="eventsource",t.roundTrips=2,l.exports=t},{"./lib/ajax-based":24,"./receiver/eventsource":29,"./sender/xhr-cors":35,eventsource:18,inherits:54}],21:[function(n,l,v){var i=n("inherits"),r=n("./receiver/htmlfile"),o=n("./sender/xhr-local"),s=n("./lib/ajax-based");function e(t){if(!r.enabled)throw new Error("Transport created when disabled");s.call(this,t,"/htmlfile",r,o)}i(e,s),e.enabled=function(t){return r.enabled&&t.sameOrigin},e.transportName="htmlfile",e.roundTrips=2,l.exports=e},{"./lib/ajax-based":24,"./receiver/htmlfile":30,"./sender/xhr-local":37,inherits:54}],22:[function(n,l,v){var i=n("inherits"),r=n("events").EventEmitter,o=n("../version"),s=n("../utils/url"),e=n("../utils/iframe"),t=n("../utils/event"),a=n("../utils/random"),u=function(){};function c(p,m,f){if(!c.enabled())throw new Error("Transport created when disabled");r.call(this);var d=this;this.origin=s.getOrigin(f),this.baseUrl=f,this.transUrl=m,this.transport=p,this.windowId=a.string(8);var E=s.addPath(f,"/iframe.html")+"#"+this.windowId;this.iframeObj=e.createIframe(E,function(S){d.emit("close",1006,"Unable to load an iframe ("+S+")"),d.close()}),this.onmessageCallback=this._message.bind(this),t.attachEvent("message",this.onmessageCallback)}i(c,r),c.prototype.close=function(){if(this.removeAllListeners(),this.iframeObj){t.detachEvent("message",this.onmessageCallback);try{this.postMessage("c")}catch{}this.iframeObj.cleanup(),this.iframeObj=null,this.onmessageCallback=this.iframeObj=null}},c.prototype._message=function(p){if(u("message",p.data),s.isOriginEqual(p.origin,this.origin)){var m;try{m=JSON.parse(p.data)}catch{return void u("bad json",p.data)}if(m.windowId===this.windowId)switch(m.type){case"s":this.iframeObj.loaded(),this.postMessage("s",JSON.stringify([o,this.transport,this.transUrl,this.baseUrl]));break;case"t":this.emit("message",m.data);break;case"c":var f;try{f=JSON.parse(m.data)}catch{return void u("bad json",m.data)}this.emit("close",f[0],f[1]),this.close()}else u("mismatched window id",m.windowId,this.windowId)}else u("not same origin",p.origin,this.origin)},c.prototype.postMessage=function(p,m){this.iframeObj.post(JSON.stringify({windowId:this.windowId,type:p,data:m||""}),this.origin)},c.prototype.send=function(p){this.postMessage("m",p)},c.enabled=function(){return e.iframeEnabled},c.transportName="iframe",c.roundTrips=2,l.exports=c},{"../utils/event":46,"../utils/iframe":47,"../utils/random":50,"../utils/url":52,"../version":53,debug:void 0,events:3,inherits:54}],23:[function(n,l,v){(function(i){(function(){var r=n("inherits"),o=n("./lib/sender-receiver"),s=n("./receiver/jsonp"),e=n("./sender/jsonp");function t(a){if(!t.enabled())throw new Error("Transport created when disabled");o.call(this,a,"/jsonp",e,s)}r(t,o),t.enabled=function(){return!!i.document},t.transportName="jsonp-polling",t.roundTrips=1,t.needBody=!0,l.exports=t}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{"./lib/sender-receiver":28,"./receiver/jsonp":31,"./sender/jsonp":33,inherits:54}],24:[function(n,l,v){var i=n("inherits"),r=n("../../utils/url"),o=n("./sender-receiver");function s(e,t,a,u){o.call(this,e,t,function(c){return function(p,m,f){var d={};typeof m=="string"&&(d.headers={"Content-type":"text/plain"});var E=r.addPath(p,"/xhr_send"),S=new c("POST",E,m,d);return S.once("finish",function(j){if(S=null,j!==200&&j!==204)return f(new Error("http status "+j));f()}),function(){S.close(),S=null;var j=new Error("Aborted");j.code=1e3,f(j)}}}(u),a,u)}i(s,o),l.exports=s},{"../../utils/url":52,"./sender-receiver":28,debug:void 0,inherits:54}],25:[function(n,l,v){var i=n("inherits"),r=n("events").EventEmitter,o=function(){};function s(e,t){r.call(this),this.sendBuffer=[],this.sender=t,this.url=e}i(s,r),s.prototype.send=function(e){this.sendBuffer.push(e),this.sendStop||this.sendSchedule()},s.prototype.sendScheduleWait=function(){var e,t=this;this.sendStop=function(){t.sendStop=null,clearTimeout(e)},e=setTimeout(function(){t.sendStop=null,t.sendSchedule()},25)},s.prototype.sendSchedule=function(){o("sendSchedule",this.sendBuffer.length);var e=this;if(0<this.sendBuffer.length){var t="["+this.sendBuffer.join(",")+"]";this.sendStop=this.sender(this.url,t,function(a){e.sendStop=null,a?(e.emit("close",a.code||1006,"Sending error: "+a),e.close()):e.sendScheduleWait()}),this.sendBuffer=[]}},s.prototype._cleanup=function(){this.removeAllListeners()},s.prototype.close=function(){this._cleanup(),this.sendStop&&(this.sendStop(),this.sendStop=null)},l.exports=s},{debug:void 0,events:3,inherits:54}],26:[function(n,l,v){(function(i){(function(){var r=n("inherits"),o=n("../iframe"),s=n("../../utils/object");l.exports=function(e){function t(a,u){o.call(this,e.transportName,a,u)}return r(t,o),t.enabled=function(a,u){if(!i.document)return!1;var c=s.extend({},u);return c.sameOrigin=!0,e.enabled(c)&&o.enabled()},t.transportName="iframe-"+e.transportName,t.needBody=!0,t.roundTrips=o.roundTrips+e.roundTrips-1,t.facadeTransport=e,t}}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{"../../utils/object":49,"../iframe":22,inherits:54}],27:[function(n,l,v){var i=n("inherits"),r=n("events").EventEmitter,o=function(){};function s(e,t,a){r.call(this),this.Receiver=e,this.receiveUrl=t,this.AjaxObject=a,this._scheduleReceiver()}i(s,r),s.prototype._scheduleReceiver=function(){var e=this,t=this.poll=new this.Receiver(this.receiveUrl,this.AjaxObject);t.on("message",function(a){e.emit("message",a)}),t.once("close",function(a,u){o("close",a,u,e.pollIsClosing),e.poll=t=null,e.pollIsClosing||(u==="network"?e._scheduleReceiver():(e.emit("close",a||1006,u),e.removeAllListeners()))})},s.prototype.abort=function(){this.removeAllListeners(),this.pollIsClosing=!0,this.poll&&this.poll.abort()},l.exports=s},{debug:void 0,events:3,inherits:54}],28:[function(n,l,v){var i=n("inherits"),r=n("../../utils/url"),o=n("./buffered-sender"),s=n("./polling");function e(t,a,u,c,p){var m=r.addPath(t,a),f=this;o.call(this,t,u),this.poll=new s(c,m,p),this.poll.on("message",function(d){f.emit("message",d)}),this.poll.once("close",function(d,E){f.poll=null,f.emit("close",d,E),f.close()})}i(e,o),e.prototype.close=function(){o.prototype.close.call(this),this.removeAllListeners(),this.poll&&(this.poll.abort(),this.poll=null)},l.exports=e},{"../../utils/url":52,"./buffered-sender":25,"./polling":27,debug:void 0,inherits:54}],29:[function(n,l,v){var i=n("inherits"),r=n("events").EventEmitter,o=n("eventsource"),s=function(){};function e(t){r.call(this);var a=this,u=this.es=new o(t);u.onmessage=function(c){s("message",c.data),a.emit("message",decodeURI(c.data))},u.onerror=function(c){s("error",u.readyState);var p=u.readyState!==2?"network":"permanent";a._cleanup(),a._close(p)}}i(e,r),e.prototype.abort=function(){this._cleanup(),this._close("user")},e.prototype._cleanup=function(){var t=this.es;t&&(t.onmessage=t.onerror=null,t.close(),this.es=null)},e.prototype._close=function(t){var a=this;setTimeout(function(){a.emit("close",null,t),a.removeAllListeners()},200)},l.exports=e},{debug:void 0,events:3,eventsource:18,inherits:54}],30:[function(n,l,v){(function(i){(function(){var r=n("inherits"),o=n("../../utils/iframe"),s=n("../../utils/url"),e=n("events").EventEmitter,t=n("../../utils/random"),a=function(){};function u(p){e.call(this);var m=this;o.polluteGlobalNamespace(),this.id="a"+t.string(6),p=s.addQuery(p,"c="+decodeURIComponent(o.WPrefix+"."+this.id)),a("using htmlfile",u.htmlfileEnabled);var f=u.htmlfileEnabled?o.createHtmlfile:o.createIframe;i[o.WPrefix][this.id]={start:function(){m.iframeObj.loaded()},message:function(d){m.emit("message",d)},stop:function(){m._cleanup(),m._close("network")}},this.iframeObj=f(p,function(){m._cleanup(),m._close("permanent")})}r(u,e),u.prototype.abort=function(){this._cleanup(),this._close("user")},u.prototype._cleanup=function(){this.iframeObj&&(this.iframeObj.cleanup(),this.iframeObj=null),delete i[o.WPrefix][this.id]},u.prototype._close=function(p){this.emit("close",null,p),this.removeAllListeners()},u.htmlfileEnabled=!1;var c=["Active"].concat("Object").join("X");if(c in i)try{u.htmlfileEnabled=!!new i[c]("htmlfile")}catch{}u.enabled=u.htmlfileEnabled||o.iframeEnabled,l.exports=u}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{"../../utils/iframe":47,"../../utils/random":50,"../../utils/url":52,debug:void 0,events:3,inherits:54}],31:[function(n,l,v){(function(i){(function(){var r=n("../../utils/iframe"),o=n("../../utils/random"),s=n("../../utils/browser"),e=n("../../utils/url"),t=n("inherits"),a=n("events").EventEmitter,u=function(){};function c(p){var m=this;a.call(this),r.polluteGlobalNamespace(),this.id="a"+o.string(6);var f=e.addQuery(p,"c="+encodeURIComponent(r.WPrefix+"."+this.id));i[r.WPrefix][this.id]=this._callback.bind(this),this._createScript(f),this.timeoutId=setTimeout(function(){m._abort(new Error("JSONP script loaded abnormally (timeout)"))},c.timeout)}t(c,a),c.prototype.abort=function(){if(i[r.WPrefix][this.id]){var p=new Error("JSONP user aborted read");p.code=1e3,this._abort(p)}},c.timeout=35e3,c.scriptErrorTimeout=1e3,c.prototype._callback=function(p){this._cleanup(),this.aborting||(p&&this.emit("message",p),this.emit("close",null,"network"),this.removeAllListeners())},c.prototype._abort=function(p){this._cleanup(),this.aborting=!0,this.emit("close",p.code,p.message),this.removeAllListeners()},c.prototype._cleanup=function(){if(clearTimeout(this.timeoutId),this.script2&&(this.script2.parentNode.removeChild(this.script2),this.script2=null),this.script){var p=this.script;p.parentNode.removeChild(p),p.onreadystatechange=p.onerror=p.onload=p.onclick=null,this.script=null}delete i[r.WPrefix][this.id]},c.prototype._scriptError=function(){var p=this;this.errorTimer||(this.errorTimer=setTimeout(function(){p.loadedOkay||p._abort(new Error("JSONP script loaded abnormally (onerror)"))},c.scriptErrorTimeout))},c.prototype._createScript=function(p){var m,f=this,d=this.script=i.document.createElement("script");if(d.id="a"+o.string(8),d.src=p,d.type="text/javascript",d.charset="UTF-8",d.onerror=this._scriptError.bind(this),d.onload=function(){f._abort(new Error("JSONP script loaded abnormally (onload)"))},d.onreadystatechange=function(){if(u("onreadystatechange",d.readyState),/loaded|closed/.test(d.readyState)){if(d&&d.htmlFor&&d.onclick){f.loadedOkay=!0;try{d.onclick()}catch{}}d&&f._abort(new Error("JSONP script loaded abnormally (onreadystatechange)"))}},d.async===void 0&&i.document.attachEvent)if(s.isOpera())(m=this.script2=i.document.createElement("script")).text="try{var a = document.getElementById('"+d.id+"'); if(a)a.onerror();}catch(x){};",d.async=m.async=!1;else{try{d.htmlFor=d.id,d.event="onclick"}catch{}d.async=!0}d.async!==void 0&&(d.async=!0);var E=i.document.getElementsByTagName("head")[0];E.insertBefore(d,E.firstChild),m&&E.insertBefore(m,E.firstChild)},l.exports=c}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{"../../utils/browser":44,"../../utils/iframe":47,"../../utils/random":50,"../../utils/url":52,debug:void 0,events:3,inherits:54}],32:[function(n,l,v){var i=n("inherits"),r=n("events").EventEmitter;function o(s,e){r.call(this);var t=this;this.bufferPosition=0,this.xo=new e("POST",s,null),this.xo.on("chunk",this._chunkHandler.bind(this)),this.xo.once("finish",function(a,u){t._chunkHandler(a,u),t.xo=null;var c=a===200?"network":"permanent";t.emit("close",null,c),t._cleanup()})}i(o,r),o.prototype._chunkHandler=function(s,e){if(s===200&&e)for(var t=-1;;this.bufferPosition+=t+1){var a=e.slice(this.bufferPosition);if((t=a.indexOf(`
`))===-1)break;var u=a.slice(0,t);u&&this.emit("message",u)}},o.prototype._cleanup=function(){this.removeAllListeners()},o.prototype.abort=function(){this.xo&&(this.xo.close(),this.emit("close",null,"user"),this.xo=null),this._cleanup()},l.exports=o},{debug:void 0,events:3,inherits:54}],33:[function(n,l,v){(function(i){(function(){var r,o,s=n("../../utils/random"),e=n("../../utils/url"),t=function(){};l.exports=function(a,u,c){r||((r=i.document.createElement("form")).style.display="none",r.style.position="absolute",r.method="POST",r.enctype="application/x-www-form-urlencoded",r.acceptCharset="UTF-8",(o=i.document.createElement("textarea")).name="d",r.appendChild(o),i.document.body.appendChild(r));var p="a"+s.string(8);r.target=p,r.action=e.addQuery(e.addPath(a,"/jsonp_send"),"i="+p);var m=function(d){try{return i.document.createElement('<iframe name="'+d+'">')}catch{var E=i.document.createElement("iframe");return E.name=d,E}}(p);m.id=p,m.style.display="none",r.appendChild(m);try{o.value=u}catch{}r.submit();function f(d){m.onerror&&(m.onreadystatechange=m.onerror=m.onload=null,setTimeout(function(){m.parentNode.removeChild(m),m=null},500),o.value="",c(d))}return m.onerror=function(){f()},m.onload=function(){f()},m.onreadystatechange=function(d){t("onreadystatechange",p,m.readyState),m.readyState==="complete"&&f()},function(){f(new Error("Aborted"))}}}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{"../../utils/random":50,"../../utils/url":52,debug:void 0}],34:[function(n,l,v){(function(i){(function(){var r=n("events").EventEmitter,o=n("inherits"),s=n("../../utils/event"),e=n("../../utils/browser"),t=n("../../utils/url"),a=function(){};function u(c,p,m){var f=this;r.call(this),setTimeout(function(){f._start(c,p,m)},0)}o(u,r),u.prototype._start=function(c,p,m){var f=this,d=new i.XDomainRequest;p=t.addQuery(p,"t="+ +new Date),d.onerror=function(){f._error()},d.ontimeout=function(){f._error()},d.onprogress=function(){a("progress",d.responseText),f.emit("chunk",200,d.responseText)},d.onload=function(){f.emit("finish",200,d.responseText),f._cleanup(!1)},this.xdr=d,this.unloadRef=s.unloadAdd(function(){f._cleanup(!0)});try{this.xdr.open(c,p),this.timeout&&(this.xdr.timeout=this.timeout),this.xdr.send(m)}catch{this._error()}},u.prototype._error=function(){this.emit("finish",0,""),this._cleanup(!1)},u.prototype._cleanup=function(c){if(this.xdr){if(this.removeAllListeners(),s.unloadDel(this.unloadRef),this.xdr.ontimeout=this.xdr.onerror=this.xdr.onprogress=this.xdr.onload=null,c)try{this.xdr.abort()}catch{}this.unloadRef=this.xdr=null}},u.prototype.close=function(){this._cleanup(!0)},u.enabled=!(!i.XDomainRequest||!e.hasDomain()),l.exports=u}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{"../../utils/browser":44,"../../utils/event":46,"../../utils/url":52,debug:void 0,events:3,inherits:54}],35:[function(n,l,v){var i=n("inherits"),r=n("../driver/xhr");function o(s,e,t,a){r.call(this,s,e,t,a)}i(o,r),o.enabled=r.enabled&&r.supportsCORS,l.exports=o},{"../driver/xhr":17,inherits:54}],36:[function(n,l,v){var i=n("events").EventEmitter;function r(){var o=this;i.call(this),this.to=setTimeout(function(){o.emit("finish",200,"{}")},r.timeout)}n("inherits")(r,i),r.prototype.close=function(){clearTimeout(this.to)},r.timeout=2e3,l.exports=r},{events:3,inherits:54}],37:[function(n,l,v){var i=n("inherits"),r=n("../driver/xhr");function o(s,e,t){r.call(this,s,e,t,{noCredentials:!0})}i(o,r),o.enabled=r.enabled,l.exports=o},{"../driver/xhr":17,inherits:54}],38:[function(n,l,v){var i=n("../utils/event"),r=n("../utils/url"),o=n("inherits"),s=n("events").EventEmitter,e=n("./driver/websocket"),t=function(){};function a(u,c,p){if(!a.enabled())throw new Error("Transport created when disabled");s.call(this);var m=this,f=r.addPath(u,"/websocket");f=f.slice(0,5)==="https"?"wss"+f.slice(5):"ws"+f.slice(4),this.url=f,this.ws=new e(this.url,[],p),this.ws.onmessage=function(d){t("message event",d.data),m.emit("message",d.data)},this.unloadRef=i.unloadAdd(function(){m.ws.close()}),this.ws.onclose=function(d){t("close event",d.code,d.reason),m.emit("close",d.code,d.reason),m._cleanup()},this.ws.onerror=function(d){m.emit("close",1006,"WebSocket connection broken"),m._cleanup()}}o(a,s),a.prototype.send=function(u){var c="["+u+"]";this.ws.send(c)},a.prototype.close=function(){var u=this.ws;this._cleanup(),u&&u.close()},a.prototype._cleanup=function(){var u=this.ws;u&&(u.onmessage=u.onclose=u.onerror=null),i.unloadDel(this.unloadRef),this.unloadRef=this.ws=null,this.removeAllListeners()},a.enabled=function(){return!!e},a.transportName="websocket",a.roundTrips=2,l.exports=a},{"../utils/event":46,"../utils/url":52,"./driver/websocket":19,debug:void 0,events:3,inherits:54}],39:[function(n,l,v){var i=n("inherits"),r=n("./lib/ajax-based"),o=n("./xdr-streaming"),s=n("./receiver/xhr"),e=n("./sender/xdr");function t(a){if(!e.enabled)throw new Error("Transport created when disabled");r.call(this,a,"/xhr",s,e)}i(t,r),t.enabled=o.enabled,t.transportName="xdr-polling",t.roundTrips=2,l.exports=t},{"./lib/ajax-based":24,"./receiver/xhr":32,"./sender/xdr":34,"./xdr-streaming":40,inherits:54}],40:[function(n,l,v){var i=n("inherits"),r=n("./lib/ajax-based"),o=n("./receiver/xhr"),s=n("./sender/xdr");function e(t){if(!s.enabled)throw new Error("Transport created when disabled");r.call(this,t,"/xhr_streaming",o,s)}i(e,r),e.enabled=function(t){return!t.cookie_needed&&!t.nullOrigin&&s.enabled&&t.sameScheme},e.transportName="xdr-streaming",e.roundTrips=2,l.exports=e},{"./lib/ajax-based":24,"./receiver/xhr":32,"./sender/xdr":34,inherits:54}],41:[function(n,l,v){var i=n("inherits"),r=n("./lib/ajax-based"),o=n("./receiver/xhr"),s=n("./sender/xhr-cors"),e=n("./sender/xhr-local");function t(a){if(!e.enabled&&!s.enabled)throw new Error("Transport created when disabled");r.call(this,a,"/xhr",o,s)}i(t,r),t.enabled=function(a){return!a.nullOrigin&&(!(!e.enabled||!a.sameOrigin)||s.enabled)},t.transportName="xhr-polling",t.roundTrips=2,l.exports=t},{"./lib/ajax-based":24,"./receiver/xhr":32,"./sender/xhr-cors":35,"./sender/xhr-local":37,inherits:54}],42:[function(n,l,v){(function(i){(function(){var r=n("inherits"),o=n("./lib/ajax-based"),s=n("./receiver/xhr"),e=n("./sender/xhr-cors"),t=n("./sender/xhr-local"),a=n("../utils/browser");function u(c){if(!t.enabled&&!e.enabled)throw new Error("Transport created when disabled");o.call(this,c,"/xhr_streaming",s,e)}r(u,o),u.enabled=function(c){return!c.nullOrigin&&!a.isOpera()&&e.enabled},u.transportName="xhr-streaming",u.roundTrips=2,u.needBody=!!i.document,l.exports=u}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{"../utils/browser":44,"./lib/ajax-based":24,"./receiver/xhr":32,"./sender/xhr-cors":35,"./sender/xhr-local":37,inherits:54}],43:[function(n,l,v){(function(i){(function(){i.crypto&&i.crypto.getRandomValues?l.exports.randomBytes=function(r){var o=new Uint8Array(r);return i.crypto.getRandomValues(o),o}:l.exports.randomBytes=function(r){for(var o=new Array(r),s=0;s<r;s++)o[s]=Math.floor(256*Math.random());return o}}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{}],44:[function(n,l,v){(function(i){(function(){l.exports={isOpera:function(){return i.navigator&&/opera/i.test(i.navigator.userAgent)},isKonqueror:function(){return i.navigator&&/konqueror/i.test(i.navigator.userAgent)},hasDomain:function(){if(!i.document)return!0;try{return!!i.document.domain}catch{return!1}}}}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{}],45:[function(n,l,v){var i,r=/[\x00-\x1f\ud800-\udfff\ufffe\uffff\u0300-\u0333\u033d-\u0346\u034a-\u034c\u0350-\u0352\u0357-\u0358\u035c-\u0362\u0374\u037e\u0387\u0591-\u05af\u05c4\u0610-\u0617\u0653-\u0654\u0657-\u065b\u065d-\u065e\u06df-\u06e2\u06eb-\u06ec\u0730\u0732-\u0733\u0735-\u0736\u073a\u073d\u073f-\u0741\u0743\u0745\u0747\u07eb-\u07f1\u0951\u0958-\u095f\u09dc-\u09dd\u09df\u0a33\u0a36\u0a59-\u0a5b\u0a5e\u0b5c-\u0b5d\u0e38-\u0e39\u0f43\u0f4d\u0f52\u0f57\u0f5c\u0f69\u0f72-\u0f76\u0f78\u0f80-\u0f83\u0f93\u0f9d\u0fa2\u0fa7\u0fac\u0fb9\u1939-\u193a\u1a17\u1b6b\u1cda-\u1cdb\u1dc0-\u1dcf\u1dfc\u1dfe\u1f71\u1f73\u1f75\u1f77\u1f79\u1f7b\u1f7d\u1fbb\u1fbe\u1fc9\u1fcb\u1fd3\u1fdb\u1fe3\u1feb\u1fee-\u1fef\u1ff9\u1ffb\u1ffd\u2000-\u2001\u20d0-\u20d1\u20d4-\u20d7\u20e7-\u20e9\u2126\u212a-\u212b\u2329-\u232a\u2adc\u302b-\u302c\uaab2-\uaab3\uf900-\ufa0d\ufa10\ufa12\ufa15-\ufa1e\ufa20\ufa22\ufa25-\ufa26\ufa2a-\ufa2d\ufa30-\ufa6d\ufa70-\ufad9\ufb1d\ufb1f\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufb4e\ufff0-\uffff]/g;l.exports={quote:function(o){var s=JSON.stringify(o);return r.lastIndex=0,r.test(s)?(i=i||function(e){var t,a={},u=[];for(t=0;t<65536;t++)u.push(String.fromCharCode(t));return e.lastIndex=0,u.join("").replace(e,function(c){return a[c]="\\u"+("0000"+c.charCodeAt(0).toString(16)).slice(-4),""}),e.lastIndex=0,a}(r),s.replace(r,function(e){return i[e]})):s}}},{}],46:[function(n,l,v){(function(i){(function(){var r=n("./random"),o={},s=!1,e=i.chrome&&i.chrome.app&&i.chrome.app.runtime;l.exports={attachEvent:function(t,a){i.addEventListener!==void 0?i.addEventListener(t,a,!1):i.document&&i.attachEvent&&(i.document.attachEvent("on"+t,a),i.attachEvent("on"+t,a))},detachEvent:function(t,a){i.addEventListener!==void 0?i.removeEventListener(t,a,!1):i.document&&i.detachEvent&&(i.document.detachEvent("on"+t,a),i.detachEvent("on"+t,a))},unloadAdd:function(t){if(e)return null;var a=r.string(8);return o[a]=t,s&&setTimeout(this.triggerUnloadCallbacks,0),a},unloadDel:function(t){t in o&&delete o[t]},triggerUnloadCallbacks:function(){for(var t in o)o[t](),delete o[t]}},e||l.exports.attachEvent("unload",function(){s||(s=!0,l.exports.triggerUnloadCallbacks())})}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{"./random":50}],47:[function(n,l,v){(function(i){(function(){var r=n("./event"),o=n("./browser"),s=function(){};l.exports={WPrefix:"_jp",currentWindowId:null,polluteGlobalNamespace:function(){l.exports.WPrefix in i||(i[l.exports.WPrefix]={})},postMessage:function(e,t){i.parent!==i?i.parent.postMessage(JSON.stringify({windowId:l.exports.currentWindowId,type:e,data:t||""}),"*"):s()},createIframe:function(e,t){function a(){clearTimeout(p);try{f.onload=null}catch{}f.onerror=null}function u(){f&&(a(),setTimeout(function(){f&&f.parentNode.removeChild(f),f=null},0),r.unloadDel(m))}function c(d){f&&(u(),t(d))}var p,m,f=i.document.createElement("iframe");return f.src=e,f.style.display="none",f.style.position="absolute",f.onerror=function(){c("onerror")},f.onload=function(){clearTimeout(p),p=setTimeout(function(){c("onload timeout")},2e3)},i.document.body.appendChild(f),p=setTimeout(function(){c("timeout")},15e3),m=r.unloadAdd(u),{post:function(d,E){setTimeout(function(){try{f&&f.contentWindow&&f.contentWindow.postMessage(d,E)}catch{}},0)},cleanup:u,loaded:a}},createHtmlfile:function(e,t){function a(){clearTimeout(p),f.onerror=null}function u(){E&&(a(),r.unloadDel(m),f.parentNode.removeChild(f),f=E=null,CollectGarbage())}function c(j){E&&(u(),t(j))}var p,m,f,d=["Active"].concat("Object").join("X"),E=new i[d]("htmlfile");E.open(),E.write('<html><script>document.domain="'+i.document.domain+'";<\/script></html>'),E.close(),E.parentWindow[l.exports.WPrefix]=i[l.exports.WPrefix];var S=E.createElement("div");return E.body.appendChild(S),f=E.createElement("iframe"),S.appendChild(f),f.src=e,f.onerror=function(){c("onerror")},p=setTimeout(function(){c("timeout")},15e3),m=r.unloadAdd(u),{post:function(j,w){try{setTimeout(function(){f&&f.contentWindow&&f.contentWindow.postMessage(j,w)},0)}catch{}},cleanup:u,loaded:a}}},l.exports.iframeEnabled=!1,i.document&&(l.exports.iframeEnabled=(typeof i.postMessage=="function"||typeof i.postMessage=="object")&&!o.isKonqueror())}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{"./browser":44,"./event":46,debug:void 0}],48:[function(n,l,v){(function(i){(function(){var r={};["log","debug","warn"].forEach(function(o){var s;try{s=i.console&&i.console[o]&&i.console[o].apply}catch{}r[o]=s?function(){return i.console[o].apply(i.console,arguments)}:o==="log"?function(){}:r.log}),l.exports=r}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{}],49:[function(n,l,v){l.exports={isObject:function(i){var r=typeof i;return r=="function"||r=="object"&&!!i},extend:function(i){if(!this.isObject(i))return i;for(var r,o,s=1,e=arguments.length;s<e;s++)for(o in r=arguments[s])Object.prototype.hasOwnProperty.call(r,o)&&(i[o]=r[o]);return i}}},{}],50:[function(n,l,v){var i=n("crypto"),r="abcdefghijklmnopqrstuvwxyz012345";l.exports={string:function(o){for(var s=r.length,e=i.randomBytes(o),t=[],a=0;a<o;a++)t.push(r.substr(e[a]%s,1));return t.join("")},number:function(o){return Math.floor(Math.random()*o)},numberString:function(o){var s=(""+(o-1)).length;return(new Array(s+1).join("0")+this.number(o)).slice(-s)}}},{crypto:43}],51:[function(n,l,v){var i=function(){};l.exports=function(r){return{filterToEnabled:function(o,s){var e={main:[],facade:[]};return o?typeof o=="string"&&(o=[o]):o=[],r.forEach(function(t){t&&(t.transportName!=="websocket"||s.websocket!==!1?o.length&&o.indexOf(t.transportName)===-1?i("not in whitelist",t.transportName):t.enabled(s)?(i("enabled",t.transportName),e.main.push(t),t.facadeTransport&&e.facade.push(t.facadeTransport)):i("disabled",t.transportName):i())}),e}}}},{debug:void 0}],52:[function(n,l,v){var i=n("url-parse");l.exports={getOrigin:function(r){if(!r)return null;var o=new i(r);if(o.protocol==="file:")return null;var s=o.port;return s=s||(o.protocol==="https:"?"443":"80"),o.protocol+"//"+o.hostname+":"+s},isOriginEqual:function(r,o){var s=this.getOrigin(r)===this.getOrigin(o);return s},isSchemeEqual:function(r,o){return r.split(":")[0]===o.split(":")[0]},addPath:function(r,o){var s=r.split("?");return s[0]+o+(s[1]?"?"+s[1]:"")},addQuery:function(r,o){return r+(r.indexOf("?")===-1?"?"+o:"&"+o)},isLoopbackAddr:function(r){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(r)||/^\[::1\]$/.test(r)}}},{debug:void 0,"url-parse":57}],53:[function(n,l,v){l.exports="1.6.1"},{}],54:[function(n,l,v){typeof Object.create=="function"?l.exports=function(i,r){r&&(i.super_=r,i.prototype=Object.create(r.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}))}:l.exports=function(i,r){if(r){let o=function(){};i.super_=r,o.prototype=r.prototype,i.prototype=new o,i.prototype.constructor=i}}},{}],55:[function(n,l,v){var i=Object.prototype.hasOwnProperty;function r(o){try{return decodeURIComponent(o.replace(/\+/g," "))}catch{return null}}v.stringify=function(o,s){s=s||"";var e,t,a=[];for(t in typeof s!="string"&&(s="?"),o)if(i.call(o,t)){if((e=o[t])||e!=null&&!isNaN(e)||(e=""),t=encodeURIComponent(t),e=encodeURIComponent(e),t===null||e===null)continue;a.push(t+"="+e)}return a.length?s+a.join("&"):""},v.parse=function(o){for(var s,e=/([^=?&]+)=?([^&]*)/g,t={};s=e.exec(o);){var a=r(s[1]),u=r(s[2]);a===null||u===null||a in t||(t[a]=u)}return t}},{}],56:[function(n,l,v){l.exports=function(i,r){if(r=r.split(":")[0],!(i=+i))return!1;switch(r){case"http":case"ws":return i!==80;case"https":case"wss":return i!==443;case"ftp":return i!==21;case"gopher":return i!==70;case"file":return!1}return i!==0}},{}],57:[function(n,l,v){(function(i){(function(){var r=n("requires-port"),o=n("querystringify"),s=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,e=/[\n\r\t]/g,t=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,a=/:\d+$/,u=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,c=/^[a-zA-Z]:/;function p(w){return(w||"").toString().replace(s,"")}var m=[["#","hash"],["?","query"],function(w,b){return E(b.protocol)?w.replace(/\\/g,"/"):w},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],f={hash:1,query:1};function d(w){var b,_=(typeof window<"u"?window:i!==void 0?i:typeof self<"u"?self:{}).location||{},h={},A=typeof(w=w||_);if(w.protocol==="blob:")h=new j(unescape(w.pathname),{});else if(A=="string")for(b in h=new j(w,{}),f)delete h[b];else if(A=="object"){for(b in w)b in f||(h[b]=w[b]);h.slashes===void 0&&(h.slashes=t.test(w.href))}return h}function E(w){return w==="file:"||w==="ftp:"||w==="http:"||w==="https:"||w==="ws:"||w==="wss:"}function S(w,b){w=(w=p(w)).replace(e,""),b=b||{};var _,h=u.exec(w),A=h[1]?h[1].toLowerCase():"",g=!!h[2],T=!!h[3],y=0;return g?y=T?(_=h[2]+h[3]+h[4],h[2].length+h[3].length):(_=h[2]+h[4],h[2].length):T?(_=h[3]+h[4],y=h[3].length):_=h[4],A==="file:"?2<=y&&(_=_.slice(2)):E(A)?_=h[4]:A?g&&(_=_.slice(2)):2<=y&&E(b.protocol)&&(_=h[4]),{protocol:A,slashes:g||E(A),slashesCount:y,rest:_}}function j(w,b,_){if(w=(w=p(w)).replace(e,""),!(this instanceof j))return new j(w,b,_);var h,A,g,T,y,O,N=m.slice(),L=typeof b,x=this,U=0;for(L!="object"&&L!="string"&&(_=b,b=null),_&&typeof _!="function"&&(_=o.parse),h=!(A=S(w||"",b=d(b))).protocol&&!A.slashes,x.slashes=A.slashes||h&&b.slashes,x.protocol=A.protocol||b.protocol||"",w=A.rest,(A.protocol==="file:"&&(A.slashesCount!==2||c.test(w))||!A.slashes&&(A.protocol||A.slashesCount<2||!E(x.protocol)))&&(N[3]=[/(.*)/,"pathname"]);U<N.length;U++)typeof(T=N[U])!="function"?(g=T[0],O=T[1],g!=g?x[O]=w:typeof g=="string"?~(y=g==="@"?w.lastIndexOf(g):w.indexOf(g))&&(w=typeof T[2]=="number"?(x[O]=w.slice(0,y),w.slice(y+T[2])):(x[O]=w.slice(y),w.slice(0,y))):(y=g.exec(w))&&(x[O]=y[1],w=w.slice(0,y.index)),x[O]=x[O]||h&&T[3]&&b[O]||"",T[4]&&(x[O]=x[O].toLowerCase())):w=T(w,x);_&&(x.query=_(x.query)),h&&b.slashes&&x.pathname.charAt(0)!=="/"&&(x.pathname!==""||b.pathname!=="")&&(x.pathname=function(P,W){if(P==="")return W;for(var D=(W||"/").split("/").slice(0,-1).concat(P.split("/")),q=D.length,B=D[q-1],nt=!1,V=0;q--;)D[q]==="."?D.splice(q,1):D[q]===".."?(D.splice(q,1),V++):V&&(q===0&&(nt=!0),D.splice(q,1),V--);return nt&&D.unshift(""),B!=="."&&B!==".."||D.push(""),D.join("/")}(x.pathname,b.pathname)),x.pathname.charAt(0)!=="/"&&E(x.protocol)&&(x.pathname="/"+x.pathname),r(x.port,x.protocol)||(x.host=x.hostname,x.port=""),x.username=x.password="",x.auth&&(~(y=x.auth.indexOf(":"))?(x.username=x.auth.slice(0,y),x.username=encodeURIComponent(decodeURIComponent(x.username)),x.password=x.auth.slice(y+1),x.password=encodeURIComponent(decodeURIComponent(x.password))):x.username=encodeURIComponent(decodeURIComponent(x.auth)),x.auth=x.password?x.username+":"+x.password:x.username),x.origin=x.protocol!=="file:"&&E(x.protocol)&&x.host?x.protocol+"//"+x.host:"null",x.href=x.toString()}j.prototype={set:function(w,b,_){var h=this;switch(w){case"query":typeof b=="string"&&b.length&&(b=(_||o.parse)(b)),h[w]=b;break;case"port":h[w]=b,r(b,h.protocol)?b&&(h.host=h.hostname+":"+b):(h.host=h.hostname,h[w]="");break;case"hostname":h[w]=b,h.port&&(b+=":"+h.port),h.host=b;break;case"host":h[w]=b,a.test(b)?(b=b.split(":"),h.port=b.pop(),h.hostname=b.join(":")):(h.hostname=b,h.port="");break;case"protocol":h.protocol=b.toLowerCase(),h.slashes=!_;break;case"pathname":case"hash":if(b){var A=w==="pathname"?"/":"#";h[w]=b.charAt(0)!==A?A+b:b}else h[w]=b;break;case"username":case"password":h[w]=encodeURIComponent(b);break;case"auth":var g=b.indexOf(":");~g?(h.username=b.slice(0,g),h.username=encodeURIComponent(decodeURIComponent(h.username)),h.password=b.slice(g+1),h.password=encodeURIComponent(decodeURIComponent(h.password))):h.username=encodeURIComponent(decodeURIComponent(b))}for(var T=0;T<m.length;T++){var y=m[T];y[4]&&(h[y[1]]=h[y[1]].toLowerCase())}return h.auth=h.password?h.username+":"+h.password:h.username,h.origin=h.protocol!=="file:"&&E(h.protocol)&&h.host?h.protocol+"//"+h.host:"null",h.href=h.toString(),h},toString:function(w){w&&typeof w=="function"||(w=o.stringify);var b,_=this,h=_.host,A=_.protocol;A&&A.charAt(A.length-1)!==":"&&(A+=":");var g=A+(_.protocol&&_.slashes||E(_.protocol)?"//":"");return _.username?(g+=_.username,_.password&&(g+=":"+_.password),g+="@"):_.password?(g+=":"+_.password,g+="@"):_.protocol!=="file:"&&E(_.protocol)&&!h&&_.pathname!=="/"&&(g+="@"),(h[h.length-1]===":"||a.test(_.hostname)&&!_.port)&&(h+=":"),g+=h+_.pathname,(b=typeof _.query=="object"?w(_.query):_.query)&&(g+=b.charAt(0)!=="?"?"?"+b:b),_.hash&&(g+=_.hash),g}},j.extractProtocol=S,j.location=d,j.trimLeft=p,j.qs=o,l.exports=j}).call(this)}).call(this,typeof I<"u"?I:typeof self<"u"?self:typeof window<"u"?window:{})},{querystringify:55,"requires-port":56}]},{},[1])(1)})})(gt);var oe=gt.exports;const ie=mt(oe);var $={exports:{}},et={};(function(C){(function(){var R,n,l,v,i={}.hasOwnProperty,r=[].slice;R={LF:`
`,NULL:"\0"},l=function(){var o;function s(e,t,a){this.command=e,this.headers=t??{},this.body=a??""}return s.prototype.toString=function(){var e,t,a,u,c;e=[this.command],a=this.headers["content-length"]===!1,a&&delete this.headers["content-length"],c=this.headers;for(t in c)i.call(c,t)&&(u=c[t],e.push(""+t+":"+u));return this.body&&!a&&e.push("content-length:"+s.sizeOfUTF8(this.body)),e.push(R.LF+this.body),e.join(R.LF)},s.sizeOfUTF8=function(e){return e?encodeURI(e).match(/%..|./g).length:0},o=function(e){var t,a,u,c,p,m,f,d,E,S,j,w,b,_,h,A,g;for(c=e.search(RegExp(""+R.LF+R.LF)),p=e.substring(0,c).split(R.LF),u=p.shift(),m={},w=function(T){return T.replace(/^\s+|\s+$/g,"")},A=p.reverse(),b=0,h=A.length;b<h;b++)S=A[b],d=S.indexOf(":"),m[w(S.substring(0,d))]=w(S.substring(d+1));if(t="",j=c+2,m["content-length"])E=parseInt(m["content-length"]),t=(""+e).substring(j,j+E);else for(a=null,f=_=j,g=e.length;(j<=g?_<g:_>g)&&(a=e.charAt(f),a!==R.NULL);f=j<=g?++_:--_)t+=a;return new s(u,m,t)},s.unmarshall=function(e){var t;return function(){var a,u,c,p;for(c=e.split(RegExp(""+R.NULL+R.LF+"*")),p=[],a=0,u=c.length;a<u;a++)t=c[a],(t!=null?t.length:void 0)>0&&p.push(o(t));return p}()},s.marshall=function(e,t,a){var u;return u=new s(e,t,a),u.toString()+R.NULL},s}(),n=function(){var o;function s(e){this.ws=e,this.ws.binaryType="arraybuffer",this.counter=0,this.connected=!1,this.heartbeat={outgoing:1e4,incoming:1e4},this.maxWebSocketFrameSize=16*1024,this.subscriptions={}}return s.prototype.debug=function(e){var t;return typeof window<"u"&&window!==null&&(t=window.console)!=null?t.log(e):void 0},o=function(){return Date.now?Date.now():new Date().valueOf},s.prototype._transmit=function(e,t,a){var u;for(u=l.marshall(e,t,a),typeof this.debug=="function"&&this.debug(">>> "+u);;)if(u.length>this.maxWebSocketFrameSize)this.ws.send(u.substring(0,this.maxWebSocketFrameSize)),u=u.substring(this.maxWebSocketFrameSize),typeof this.debug=="function"&&this.debug("remaining = "+u.length);else return this.ws.send(u)},s.prototype._setupHeartbeat=function(e){var t,a,u,c,p,m;if(!((p=e.version)!==v.VERSIONS.V1_1&&p!==v.VERSIONS.V1_2)&&(m=function(){var f,d,E,S;for(E=e["heart-beat"].split(","),S=[],f=0,d=E.length;f<d;f++)c=E[f],S.push(parseInt(c));return S}(),a=m[0],t=m[1],this.heartbeat.outgoing===0||t===0||(u=Math.max(this.heartbeat.outgoing,t),typeof this.debug=="function"&&this.debug("send PING every "+u+"ms"),this.pinger=v.setInterval(u,function(f){return function(){return f.ws.send(R.LF),typeof f.debug=="function"?f.debug(">>> PING"):void 0}}(this))),!(this.heartbeat.incoming===0||a===0)))return u=Math.max(this.heartbeat.incoming,a),typeof this.debug=="function"&&this.debug("check PONG every "+u+"ms"),this.ponger=v.setInterval(u,function(f){return function(){var d;if(d=o()-f.serverActivity,d>u*2)return typeof f.debug=="function"&&f.debug("did not receive server activity for the last "+d+"ms"),f.ws.close()}}(this))},s.prototype._parseConnect=function(){var e,t,a,u;switch(e=1<=arguments.length?r.call(arguments,0):[],u={},e.length){case 2:u=e[0],t=e[1];break;case 3:e[1]instanceof Function?(u=e[0],t=e[1],a=e[2]):(u.login=e[0],u.passcode=e[1],t=e[2]);break;case 4:u.login=e[0],u.passcode=e[1],t=e[2],a=e[3];break;default:u.login=e[0],u.passcode=e[1],t=e[2],a=e[3],u.host=e[4]}return[u,t,a]},s.prototype.connect=function(){var e,t,a,u;return e=1<=arguments.length?r.call(arguments,0):[],u=this._parseConnect.apply(this,e),a=u[0],this.connectCallback=u[1],t=u[2],typeof this.debug=="function"&&this.debug("Opening Web Socket..."),this.ws.onmessage=function(c){return function(p){var m,f,d,E,S,j,w,b,_,h,A,g;if(E=typeof ArrayBuffer<"u"&&p.data instanceof ArrayBuffer?(m=new Uint8Array(p.data),typeof c.debug=="function"&&c.debug("--- got data length: "+m.length),function(){var T,y,O;for(O=[],T=0,y=m.length;T<y;T++)f=m[T],O.push(String.fromCharCode(f));return O}().join("")):p.data,c.serverActivity=o(),E===R.LF){typeof c.debug=="function"&&c.debug("<<< PONG");return}for(typeof c.debug=="function"&&c.debug("<<< "+E),A=l.unmarshall(E),g=[],_=0,h=A.length;_<h;_++)switch(S=A[_],S.command){case"CONNECTED":typeof c.debug=="function"&&c.debug("connected to server "+S.headers.server),c.connected=!0,c._setupHeartbeat(S.headers),g.push(typeof c.connectCallback=="function"?c.connectCallback(S):void 0);break;case"MESSAGE":b=S.headers.subscription,w=c.subscriptions[b]||c.onreceive,w?(d=c,j=S.headers["message-id"],S.ack=function(T){return T==null&&(T={}),d.ack(j,b,T)},S.nack=function(T){return T==null&&(T={}),d.nack(j,b,T)},g.push(w(S))):g.push(typeof c.debug=="function"?c.debug("Unhandled received MESSAGE: "+S):void 0);break;case"RECEIPT":g.push(typeof c.onreceipt=="function"?c.onreceipt(S):void 0);break;case"ERROR":g.push(typeof t=="function"?t(S):void 0);break;default:g.push(typeof c.debug=="function"?c.debug("Unhandled frame: "+S):void 0)}return g}}(this),this.ws.onclose=function(c){return function(){var p;return p="Whoops! Lost connection to "+c.ws.url,typeof c.debug=="function"&&c.debug(p),c._cleanUp(),typeof t=="function"?t(p):void 0}}(this),this.ws.onopen=function(c){return function(){return typeof c.debug=="function"&&c.debug("Web Socket Opened..."),a["accept-version"]=v.VERSIONS.supportedVersions(),a["heart-beat"]=[c.heartbeat.outgoing,c.heartbeat.incoming].join(","),c._transmit("CONNECT",a)}}(this)},s.prototype.disconnect=function(e,t){return t==null&&(t={}),this._transmit("DISCONNECT",t),this.ws.onclose=null,this.ws.close(),this._cleanUp(),typeof e=="function"?e():void 0},s.prototype._cleanUp=function(){if(this.connected=!1,this.pinger&&v.clearInterval(this.pinger),this.ponger)return v.clearInterval(this.ponger)},s.prototype.send=function(e,t,a){return t==null&&(t={}),a==null&&(a=""),t.destination=e,this._transmit("SEND",t,a)},s.prototype.subscribe=function(e,t,a){var u;return a==null&&(a={}),a.id||(a.id="sub-"+this.counter++),a.destination=e,this.subscriptions[a.id]=t,this._transmit("SUBSCRIBE",a),u=this,{id:a.id,unsubscribe:function(){return u.unsubscribe(a.id)}}},s.prototype.unsubscribe=function(e){return delete this.subscriptions[e],this._transmit("UNSUBSCRIBE",{id:e})},s.prototype.begin=function(e){var t,a;return a=e||"tx-"+this.counter++,this._transmit("BEGIN",{transaction:a}),t=this,{id:a,commit:function(){return t.commit(a)},abort:function(){return t.abort(a)}}},s.prototype.commit=function(e){return this._transmit("COMMIT",{transaction:e})},s.prototype.abort=function(e){return this._transmit("ABORT",{transaction:e})},s.prototype.ack=function(e,t,a){return a==null&&(a={}),a["message-id"]=e,a.subscription=t,this._transmit("ACK",a)},s.prototype.nack=function(e,t,a){return a==null&&(a={}),a["message-id"]=e,a.subscription=t,this._transmit("NACK",a)},s}(),v={VERSIONS:{V1_0:"1.0",V1_1:"1.1",V1_2:"1.2",supportedVersions:function(){return"1.1,1.0"}},client:function(o,s){var e,t;return s==null&&(s=["v10.stomp","v11.stomp"]),e=v.WebSocketClass||WebSocket,t=new e(o,s),new n(t)},over:function(o){return new n(o)},Frame:l},C!==null&&(C.Stomp=v),typeof window<"u"&&window!==null?(v.setInterval=function(o,s){return window.setInterval(s,o)},v.clearInterval=function(o){return window.clearInterval(o)},window.Stomp=v):C||(self.Stomp=v)}).call(I)})(et);var tt={},ut={},ct;function yt(){if(ct)return ut;ct=1;var C=yt();for(k in C)I[k]=C[k];return ut}var Q,lt;function se(){if(lt)return Q;lt=1;var C=function(){if(typeof self=="object"&&self)return self;if(typeof window=="object"&&window)return window;throw new Error("Unable to resolve global `this`")};return Q=function(){if(this)return this;if(typeof globalThis=="object"&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch{return C()}try{return __global__||C()}finally{delete Object.prototype.__global__}}(),Q}const ae="websocket",ue="Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.",ce=["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],le="Brian McKelvey <theturtle32@gmail.com> (https://github.com/theturtle32)",fe=["Iñaki Baz Castillo <ibc@aliax.net> (http://dev.sipdoc.net)"],pe="1.0.35",he={type:"git",url:"https://github.com/theturtle32/WebSocket-Node.git"},de="https://github.com/theturtle32/WebSocket-Node",me={node:">=4.0.0"},ve={bufferutil:"^4.0.1",debug:"^2.2.0","es5-ext":"^0.10.63","typedarray-to-buffer":"^3.1.5","utf-8-validate":"^5.0.2",yaeti:"^0.0.6"},be={"buffer-equal":"^1.0.0",gulp:"^4.0.2","gulp-jshint":"^2.0.4","jshint-stylish":"^2.2.1",jshint:"^2.0.0",tape:"^4.9.1"},ge={verbose:!1},ye={test:"tape test/unit/*.js",gulp:"gulp"},we="index",xe={lib:"./lib"},_e="lib/browser.js",Ee="Apache-2.0",Se={name:ae,description:ue,keywords:ce,author:le,contributors:fe,version:pe,repository:he,homepage:de,engines:me,dependencies:ve,devDependencies:be,config:ge,scripts:ye,main:we,directories:xe,browser:_e,license:Ee};var K,ft;function ke(){return ft||(ft=1,K=Se.version),K}var Z,pt;function Ce(){if(pt)return Z;pt=1;var C;if(typeof globalThis=="object")C=globalThis;else try{C=se()}catch{}finally{if(!C&&typeof window<"u"&&(C=window),!C)throw new Error("Could not determine global this")}var R=C.WebSocket||C.MozWebSocket,n=ke();function l(v,i){var r;return i?r=new R(v,i):r=new R(v),r}return R&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach(function(v){Object.defineProperty(l,v,{get:function(){return R[v]}})}),Z={w3cwebsocket:R?l:null,version:n},Z}(function(){var C,R,n,l,v,i;C=et,R=yt(),C.Stomp.setInterval=function(r,o){return setInterval(o,r)},C.Stomp.clearInterval=function(r){return clearInterval(r)},v=function(r,o){var s,e;return s=null,e={url:"tcp:// "+o+":"+r,send:function(t){return s.write(t)},close:function(){return s.end()}},s=R.connect(r,o,function(t){return e.onopen()}),s.on("error",function(t){return typeof e.onclose=="function"?e.onclose(t):void 0}),s.on("close",function(t){return typeof e.onclose=="function"?e.onclose(t):void 0}),s.on("data",function(t){var a;return a={data:t.toString()},e.onmessage(a)}),e},i=function(r){var o,s,e,t;return o=Ce().client,s=null,t={url:r,send:function(a){return s.sendUTF(a)},close:function(){return s.close()}},e=new o,e.on("connect",function(a){return s=a,t.onopen(),s.on("error",function(u){return typeof t.onclose=="function"?t.onclose(u):void 0}),s.on("close",function(){return typeof t.onclose=="function"?t.onclose():void 0}),s.on("message",function(u){var c;if(u.type==="utf8")return c={data:u.utf8Data},t.onmessage(c)})}),e.connect(r),t},n=function(r,o){var s;return s=v(o,r),C.Stomp.over(s)},l=function(r){var o;return o=i(r),C.Stomp.over(o)},tt.overTCP=n,tt.overWS=l}).call(I);var Oe=et,wt=tt;$.exports=Oe.Stomp;$.exports.overTCP=wt.overTCP;$.exports.overWS=wt.overWS;var Te=$.exports;const Ne=mt(Te),{wsCache:G}=dt();let M;const je={install(){const C=[{topic:"/task-export-topic",event:"task-export-topic-call"},{topic:"/report-notice",event:"report-notice-call"}];function R(){return G.get("user.token")&&G.get("user.uid")}function n(){var s;if(!R()||M&&M.connected)return;let i="/";(s=window.DataEaseBi)!=null&&s.baseUrl?i=window.DataEaseBi.baseUrl:i=location.origin+location.pathname,i.endsWith("/")||(i+="/");const r=new ie(i+"websocket?userId="+G.get("user.uid"));M=Ne.over(r);const o={userId:G.get("user.uid")};M.connect(o,()=>{C.forEach(e=>{M.subscribe("/user/"+G.get("user.uid")+e.topic,t=>{t&&t.body&&ht().emitter.emit(e.event,t.body)})})},e=>{console.error("连接失败: "+e)})}function l(){M&&M.connected&&M.disconnect(function(){console.info("断开连接")},function(i){console.info("断开连接失败: "+i)})}function v(){n(),setInterval(()=>{if(!R()){l();return}(!M||!M.connected)&&n()},5e3)}v()}},Ie=async()=>{const C=Rt(Kt);Vt(C),await _t(C),Et(C),$t(C),St(C),qt(C),kt(C),C.use(je),C.mount("#app")};Ie();
