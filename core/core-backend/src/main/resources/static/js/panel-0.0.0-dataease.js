var O=Object.defineProperty;var A=(r,t,e)=>t in r?O(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var i=(r,t,e)=>(A(r,typeof t!="symbol"?t+"":t,e),e);import{p as S,u as b,b as L,s as y,c as V,d as g,e as w}from"../assets/chunk/index-0.0.0-dataease.js";import{a as s}from"../assets/chunk/library-0.0.0-dataease.js";import{d as C,s as x,f as k,g as U,q as B,x as a,y as H,z as N,l as M}from"../assets/chunk/vue-0.0.0-dataease.js";import"../assets/chunk/lodash-0.0.0-dataease.js";const F=C({__name:"App",props:{componentName:S.string.def("Iframe")},setup(r){const t=a(()=>s(()=>import("../assets/chunk/index-0.0.0-dataease6.js"),[],import.meta.url)),e=a(()=>s(()=>import("../assets/chunk/index-0.0.0-dataease7.js"),[],import.meta.url)),u=a(()=>s(()=>import("../assets/chunk/DashboardPreview-0.0.0-dataease.js"),[],import.meta.url)),c=a(()=>s(()=>import("../assets/chunk/ViewWrapper-0.0.0-dataease.js"),[],import.meta.url)),_=a(()=>s(()=>import("../assets/chunk/Iframe-0.0.0-dataease.js"),[],import.meta.url)),h=a(()=>s(()=>import("../assets/chunk/index-0.0.0-dataease8.js"),[],import.meta.url)),l=a(()=>s(()=>import("../assets/chunk/index-0.0.0-dataease9.js"),[],import.meta.url)),m=a(()=>s(()=>import("../assets/chunk/index-0.0.0-dataease10.js"),[],import.meta.url)),f=a(()=>s(()=>import("../assets/chunk/PreviewShow-0.0.0-dataease.js"),[],import.meta.url)),p=a(()=>s(()=>import("../assets/chunk/DashboardPreviewShow-0.0.0-dataease.js"),[],import.meta.url)),o=a(()=>s(()=>import("../assets/chunk/PreviewCanvas-0.0.0-dataease.js"),[],import.meta.url)),n=a(()=>s(()=>import("../assets/chunk/DashboardEmpty-0.0.0-dataease.js"),[],import.meta.url)),P=r,d=x(),E={DashboardEditor:e,VisualizationEditor:t,ViewWrapper:c,Preview:o,Dashboard:u,Dataset:h,Iframe:_,Datasource:m,ScreenPanel:f,DashboardPanel:p,DatasetEditor:l,DashboardEmpty:n};return b({name:"changeCurrentComponent",callback:I=>{d.value=E[I]}}),d.value=E[P.componentName],(I,R)=>(k(),U(B(d.value)))}}),q=[],z=H({history:N(),routes:q}),W=r=>{r.use(z)},v="0.0.0-dataease",D=document.querySelector("head"),K=D.appendChild.bind(D),$=(r,t)=>{if(["SCRIPT","LINK"].includes(r.nodeName)){let e="";if(r instanceof HTMLLinkElement?e=r.href:r instanceof HTMLScriptElement&&(e=r.src),e.includes(v)||e.includes("dataease-private")){const u=new URL(e).origin,c=e.replace(u,t);r instanceof HTMLLinkElement?r.href=c:r instanceof HTMLScriptElement&&(r.src=c)}}return r},j=()=>{let r="";return Array.from(document.querySelector("head").children).some(t=>{if(["SCRIPT","LINK"].includes(t.nodeName)){let e="";if(t instanceof HTMLLinkElement?e=t.href:t instanceof HTMLScriptElement&&(e=t.src),e.includes(v)){r=new URL(e).origin;const u=e.indexOf(`/js/div_import_${v}`);return u>0&&(r=e.substring(0,u)),!0}}}),r};document.querySelector("head").appendChild=r=>{const t=$(r,j());return K(t),t};const G=async(r,t,e,u,c,_,h,l,m,f,p)=>{const o=M(F,{componentName:t});o.provide("embeddedParams",{chartId:f,resourceId:p,dvId:l,pid:m,busiFlag:e,outerParams:u,suffixId:c}),await y(o),V(o),W(o),g(o),w(o);const n=L();return n.setType(t),n.setBusiFlag(e),n.setOuterParams(u),n.setSuffixId(c),n.setToken(_),n.setBaseUrl(h),n.setDvId(l),n.setPid(m),n.setResourceId(p),(await s(()=>import("../assets/chunk/index-0.0.0-dataease3.js"),[],import.meta.url)).installDirective(o),(await s(()=>import("../assets/chunk/user-0.0.0-dataease.js"),[],import.meta.url)).userStore().setUser(),(await s(()=>import("../assets/chunk/app-0.0.0-dataease.js"),[],import.meta.url)).useAppStoreWithOut().setIsDataEaseBi(!0),(await s(()=>import("../assets/chunk/appearance-0.0.0-dataease.js"),[],import.meta.url)).useAppearanceStoreWithOut().setAppearance(!0),o.mount(r),o},J={container:"#designer",lng:"zh",theme:"default"};class Q{constructor(t,e){i(this,"baseUrl");i(this,"token");i(this,"type");i(this,"dvId");i(this,"busiFlag");i(this,"outerParams");i(this,"suffixId");i(this,"resourceId");i(this,"pid");i(this,"chartId");i(this,"deOptions");i(this,"vm");this.type=t,this.token=e.token,this.busiFlag=e.busiFlag,this.outerParams=e.outerParams,this.suffixId=e.suffixId,this.baseUrl=e.baseUrl,this.dvId=e.dvId,this.pid=e.pid,this.chartId=e.chartId,this.resourceId=e.resourceId}async initialize(t){this.deOptions={...J,...t},this.vm=await G(this.deOptions.container,this.type,this.busiFlag,this.outerParams,this.suffixId,this.token,this.baseUrl,this.dvId,this.pid,this.chartId,this.resourceId)}destroy(){const t=L();t.setType(null),t.setBusiFlag(null),t.setOuterParams(null),t.setSuffixId(null),t.setToken(null),t.setBaseUrl(null),t.setChartId(null),t.clearState(),this.vm.unmount(),this.type=null,this.token=null,this.busiFlag=null,this.outerParams=null,this.suffixId=null,this.baseUrl=null,this.dvId=null,this.pid=null,this.chartId=null,this.resourceId=null,this.vm=null}}window.DataEaseBi=Q;
